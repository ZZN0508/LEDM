define.amd=!1,require.config({baseUrl:"/resource",paths:{text:"js/lib/requirejs-plugins/text"}}),$.extend(So.newsFlow,{logMark:"homecard",eventMark:"so.homecard",currNavCookieMark:"currCard",closeOffensoCookieMark:"closeOftenso",hotNewsFlag:"hot-news-card",$newsFlow:null,$realTimeNews:null,$oftenSo:null,$cardSide:null,$cardContainer:null}),So.newsFlow.observerEvent={addHotNewsCard:So.newsFlow.eventMark+".addHotNewsCard",closeHotNewsCard:So.newsFlow.eventMark+".closeHotNewsCard",infoFlowClickTab:So.newsFlow.eventMark+".infoFlowClickTab",infoFlowTabFixed:So.newsFlow.eventMark+".infoFlowTabFixed",searchboxFixed:So.newsFlow.eventMark+".searchboxFixed",cancelSearchboxFixed:So.newsFlow.eventMark+".cancelSearchboxFixed"},require(["js/home/card/main"],function(){}),define("js/home/card/loader",function(){}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.12",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("\ufeff")===0&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!html/news-flow.html!strip",[],function(){return'<% if(tplType == \'tab\'){ %>\n<div class="top-tab">\n    <div class="fixed">\n        <% for(var i = 0, len = data.length; i < len; i++){ %>\n        <a href="javascript:;" class="<%= i==0 ? \'selected\' : \'\' %>" data-log="tab" data-param="<%= data[i].param %>">\n            <%= data[i].txt %>\n            <span class="line"></span>\n        </a>\n        <% } %>\n    </div>\n</div>\n<% }else if(tplType == \'news\'){ %>\n<li data-type="<%= type %>" data-from="news-<%= dataSource %><%= from ? \'-\' + from : \'\' %>"\n    class="respond <%= liClass %> <%= liCoversClass %>" data-ctitle="0" <%= attr %>>\n    <a data-log="link" href="<%= url %>" target="_blank" title="<%= So.lib.escapeHTML(titleFull) %>">\n        <!-- \u591a\u56fe\u6216\u65e0\u56fetitle-start -->\n        <% if(liCoversClass != "single-img"){ %>\n        <p data-log="title" class="sub-title"><%= title %></p>\n        <% } %>\n        <!-- \u591a\u56fe\u6216\u65e0\u56fetitle-end -->\n\n        <!-- \u56fe\u7247-start -->\n        <% if(covers.length > 0){ %>\n        <div class="img">\n            <% for(var i = 0, len = covers.length; i < len; i++){ %>\n            <span class="img-wrap<%= (i != 0 && len - 1 == i) ? \' last\' : \'\' %>">\n                <img onerror="NewsFlow.Tools.checkImg()" data-log="image" <%= covers[i].style %>\n                    width="<%= coversWidth %>px" height="<%= coversHeight %>px" src="<%= covers[i].src %>">\n                <% if(type == "video"){ %>\n                <div class="play"></div>\n                <% } %>\n            </span>\n            <% } %>\n            <% if(corner){ %>\n            <div data-log="image" class="corner"><%= corner %></div>\n            <% } %>\n        </div>\n        <% } %>\n        <!-- \u56fe\u7247-end -->\n\n        <!-- \u5355\u56fetitle-start -->\n        <% if(liCoversClass == "single-img"){ %>\n        <div class="con">\n            <p data-log="title" class="sub-title short"><%= title %></p>\n            <p data-log="title" class="sub-title long"><%= titleLong %></p>\n            <% } %>\n            <!-- \u5355\u56fetitle-end -->\n\n            <p data-log="desc" class="desc">\n                <%= source %><%= followButton %><%= date %><%= playCount %><%= tag %></p>\n\n            <!-- \u5355\u56fetitle-start -->\n            <% if(liCoversClass == "single-img"){ %>\n        </div>\n        <% } %>\n        <!-- \u5355\u56fetitle-end -->\n\n    </a>\n    <div class="close"></div>\n</li>\n<% }else if(tplType == \'sad\'){ %>\n<!-- \u6b63\u5e38\u5e7f\u544a\uff1adata-from="sad" -->\n<!-- qcms\u8fd0\u8425\u4f4d\uff1adata-from="sad-qcms" -->\n<li data-from="<%= from %>" class="sad respond <%= liCoversClass %>" data-imptk="<%= imptk %>" data-clktk="<%= clktk %>"\n    data-clstk="<%= clstk %>" data-title="<%= titleFull %>" data-ctitle="0">\n    <!-- \u5587\u53ed -->\n    <% if(type == "video"){ %>\n    <a href="javascript:;" class="horn"></a>\n    <a href="javascript:;" class="play"><i></i><span class="time"><%= duration %></span></a>\n    <% } %>\n\n    <a data-log="link" href="<%= url %>" data-href="<%= url %>" target="_blank" class="bg-url" rel="noopener"></a>\n\n    <!-- title\u5728\u9876\u90e8start\uff1a\u591a\u56fe \u89c6\u9891 \u5927\u56fe \u65b9\u56fe -->\n    <% if(type == "manyImg" || type == "video" || type == "bigImg"  || type == "squareImg"){ %>\n    <a data-log="title" href="<%= url %>" data-href="<%= url %>" target="_blank" class="sub-title"\n        rel="noopener"><%= title %></a>\n    <% } %>\n    <!-- title\u5728\u9876\u90e8end -->\n\n    <!-- \u56fe\u7247start -->\n    <div class="img">\n        <% for(var i = 0, len = img.length; i < len; i++){ %>\n        <a class="img-wrap <%= (i != 0 && len - 1 == i) ? \'last\' : \'\' %>" href="<%= img[i].url %>"\n            data-href="<%= img[i].url %>" target="_blank" rel="noopener">\n            <% if(type == "video"){ %>\n            <video loop muted src="<%= img[i].src %>" data-log="video" <%= img[i].style %>\n                height="<%= imgHeight %>px">\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 video \u6807\u7b7e\u3002</video>\n            <% }else{ %>\n            <img onerror="NewsFlowSad.Tools.checkImg()" data-log="image" <%= img[i].style %> width="<%= imgWidth %>px"\n                height="<%= imgHeight %>px" src="<%= img[i].src %>">\n            <% } %>\n        </a>\n        <% } %>\n    </div>\n    <!-- \u56fe\u7247end -->\n\n    <a href="<%= url %>" data-href="<%= url %>" target="_blank" class="con" rel="noopener">\n        <!-- title\u5728\u53f3\u4fa7start\uff1a\u5355\u56fe -->\n        <% if(type == "singleImg"){ %>\n        <p data-log="title" class="sub-title"><%= title %></p>\n        <% } %>\n        <!-- title\u5728\u53f3\u4fa7end -->\n\n        <p data-log="desc" class="desc"><span><%= source %></span><%= sadTxt %></p>\n    </a>\n    <div class="close"></div>\n</li>\n<% }else if(tplType == \'sadTest\'){ %>\n<%\n        var imgDom = \'\';\n        if (img) {\n            imgDom = \'<div class="img"><span class="img-wrap"><img class="anim" width="132px" height="84" src="\' + img + \'"/></span></div>\';\n        }\n    %>\n<!-- \u641c\u7d22\u5e7f\u544a -->\n<% if(type == "sd"){ %>\n<li data-from="sad" class="sad respond single-img">\n    <a target="_blank" href="<%= click_url %>" e_href="<%= click_url %>" data-qhp="item-sd"><%= imgDom %>\n        <div class="con">\n            <h3 class="sub-title"><%= title %></h3>\n            <p data-log="desc" class="desc"><%= src %><span class="txt">\u5e7f\u544a</span></p>\n        </div>\n    </a>\n</li>\n<!-- \u8054\u76df\u5e7f\u544a -->\n<% }else if(type == "lm"){ %>\n<li data-from="sad" class="sad respond single-img">\n    <a target="_blank" href="<%= click_url %>" data-busiid="<%= id %>" data-qhp="item-lm"><%=  imgDom %>\n        <div class="con">\n            <h3 class="sub-title"><%= title %></h3>\n            <p data-log="desc" class="desc"><%= src %><span class="txt">\u5e7f\u544a</span></p>\n        </div>\n    </a>\n</li>\n<!-- \u4fe1\u606f\u6d41\u5e7f\u544a -->\n<% }else if(type == "nf"){ %>\n<li data-from="sad" class="sad respond single-img js-i-busi-list-item">\n    <a target="_blank" href="<%= click_url %>" data-busiid="<%= id %>" data-qhp="item-lm"><%=  imgDom %>\n        <div class="con">\n            <h3 class="sub-title"><%= title %></h3>\n            <p data-log="desc" class="desc"><%= src %><span class="txt">\u5e7f\u544a</span></p>\n        </div>\n    </a>\n</li>\n<% } %>\n<% }else if(tplType == \'noData\'){ %>\n<div class="no-more clearfix">\n    <hr size="1">\n    </hr>\n    <p>\u6ca1\u6709\u66f4\u591a\u5185\u5bb9\u4e86\u54e6 ~</p>\n</div>\n<% }else if(tplType == \'loading\'){ %>\n<div class="loading short"><i class="ico"></i>\u52a0\u8f7d\u4e2d...</div>\n<% }else if(tplType == \'gotoTop\'){ %>\n<div id="goto-top"><span></span></div>\n<% }else if(tplType == \'closeList\'){ %>\n<div class="close-list">\n    <div class="wrap">\n        <i></i>\n        <a href="javascript:;" data-val="5">\u4e0d\u611f\u5174\u8da3</a>\n        <a href="javascript:;" data-val="1">\u5185\u5bb9\u4e0d\u5b9c</a>\n        <a href="javascript:;" data-val="4">\u906e\u6321\u5e72\u6270</a>\n        <a href="javascript:;" data-val="2">\u5c4f\u853d\u6b64\u7c7b</a>\n    </div>\n</div>\n<% } %>'}),function(){NewsFlow=function(e){var t=this,n={debugTxt:"",$newsFlow:So.newsFlow.$newsFlow,source:So.newsFlow.source||"papi",query:So.comm.q,type:So.newsFlow.type,from:So.newsFlow.from,logMark:So.newsFlow.logMark,eventMark:So.newsFlow.eventMark,guid:So.lib.getUnMid(So.comm.md)||So.lib.getUnMid(So.lib.cookie.get("__md"))||So.comm.guid,template:"",currPage:1,requestPage:1,newsCount:10,gotoTopDis:700,retryGetDataTimes:1,showGotoTop:!0,alwaysShowFlow:!1,onlyShowSingleImg:!1,preventScrollLoad:!1,preferences:{},isShowTag:!1,isShowAtlas:!0,isShowVideo:!0,manyImg:{count:4,width:132,height:84,isShowCorner:!0},singleImg:{width:132,height:84,titleLength:64},atlasImg:{width:268,height:170},noImg:{titleLength:150},initCb:$.noop,scrollCb:$.noop,noDataCb:$.noop,neverDataCb:$.noop,addNewsCb:$.noop,removeFlowCb:$.noop,renderAfterCb:$.noop};t.options=$.extend(!0,{},n,e),t.noData=!1,t.currRetryGetDataTimes=0,t.$flowInner=t.options.$newsFlow.find("ul"),t.$loading=$(NewsFlow.Tools.template(t.options.template,{tplType:"loading"})),t.$gotoTop=$(NewsFlow.Tools.template(t.options.template,{tplType:"gotoTop"})),t.hasSendFollowButtonSrpLog=!1,t.init()},NewsFlow.Tools={getTxt:function(e){return So.lib.escapeHTML($("<p>"+e+"</p>").text())},cutStr:function(e,t){e=So.lib.unescapeHTML(So.lib.cutStr(e,t)),e=e.replace(/^(.*)(<|<b|<\/|<\/b)\.\.\.$/,"$1...");var n=e.indexOf("<b>"),r=e.indexOf("</b>");return n!=r&&(e=e.replace(/(.*)<b>([^<>]*?)\.\.\.$/,"$1<b>$2</b>...")),So.lib.escapeHTML(e)},checkImg:function(){var e=event.srcElement;$(e).remove(),e.onerror=null},formatSeconds:function(e){var t=[parseInt(e/60/60),parseInt(e/60%60),parseInt(e%60)];return t[0]===0&&t.shift(),t.join(":").replace(/\b(\d)\b/g,"0$1")},log:So.lib.log,observer:So.lib.observer,template:So.lib.template,isVisible:So.lib.isVisible1,getPicUrl:So.lib.getPicUrl,formatTime:So.lib.formatTime,sslReplace:So.lib.sslReplace,escapeHTML:So.lib.escapeHTML,unescapeHTML:So.lib.unescapeHTML,localStorage:So.lib.soLocalStorage},NewsFlow.prototype={Source:{papi:{getData:function(e){var t=this,n=t.options;if(t.noData)return;e=$.extend({noRender:!1,newsCount:n.newsCount,beforeCb:$.noop,afterCb:$.noop,failCb:$.noop},e),$.ajax({url:"//papi.look.360.cn/mlist",data:{q:n.query,from:n.from,so_type:n.type,n:So.lib.checkAbv(1240,"pos_test")&&n.currPage==1?2:e.newsCount,u:n.guid,v:1,sv:1,net:5,scene:1,device:2,f:"json_v1",c:"youlike",callfrom:"so",data_type:"jsonp",refer_scene:"so_7",sign:"360_e39369d1",abv:So.lib.checkAbv(1240,"mlist_test")?"1078-mlist_test":So.lib.checkAbv(1240,"pos_test")&&n.currPage>1?"1078-mlist_test":""},type:"get",timeout:3e3,dataType:"jsonp",success:function(n){if(t.noData)return;if(n&&n.items&&n.items.length){e.beforeCb();var r=t.Source.papi.formatData.call(t,n.items,n.tc_show);r.length&&t.render(r,e.noRender),setTimeout(function(){e.afterCb(t)},0)}else t.setNoData(e),e.failCb(t)},error:function(){t.setNoData(e),e.failCb(t)}}),n.currPage++},formatData:function(e,t){var n=[],r={},i=this.options;for(var s=0,o=e.length;s<o;s++){r=e[s];if(r.from!="news"||r.attr.image_url==""||r.url==""||r.title=="")continue;var u="news",a=r.attr.image_url?r.attr.image_url.split(";"):[],f="",l="";if(r.ntag&&r.ntag.match(/y3:(.*?);/)){var c=r.ntag.match(/y3:(.*?);/)[1].split(":");l=c[c.length-1]}i.isShowAtlas&&r.s=="p"&&a.length>1&&(u="atlas");var h="";i.isShowVideo&&(r.s=="v"||r.s=="y")&&r.duration&&a.length==1&&(u="video",f=NewsFlow.Tools.formatSeconds(r.duration),h=+r.playcnt?"<span>"+r.playcnt+"\u6b21\u89c2\u770b</span>":""),n.push({type:u,playCount:h,liClass:"papi",date:r.showtime*1e3,title:r.title,from:r.from,url:r.url,source:r.attr.sitename,covers:a,corner:f,attr:'" data-tc-show="'+t+'" data-log-extend="'+r.tc_value+'"',tag:l,zmt:r.zmt||""})}return n}},baoDian:{sid:"",timer:null,baodianPage:1,batch:{},delNewsCookie:"delNews",closeLog:function(e,t){var n=e.Source.baoDian,r=t.find("a[title]").attr("title"),i=NewsFlow.Tools.localStorage.getItem(n.delNewsCookie)||JSON.stringify([]);i=JSON.parse(i),i.length==20&&i.shift(),i.push(r),NewsFlow.Tools.localStorage.setItem(n.delNewsCookie,JSON.stringify(i))},clickLog:function(e,t){if(!t.attr("data-a"))return;var n=e.options,r=n.preferences;$.ajax({url:"//papi.look.360.cn/srv/c",data:{uid:n.guid,sqid:r.sqid,url:t.attr("data-callbackUrl"),sign:r.sign,stype:"portal",market:"so-home",device:2,net:5,channel:n.$newsFlow.find(".top-tab a.selected").attr("data-param"),sid:e.sid,a:t.attr("data-a"),c:t.attr("data-c"),source:t.attr("data-src"),s:t.attr("data-s"),style:5,act:"click",refer_scene:0,refer_subscene:0,where:"list",t:parseInt(+(new Date)/1e3)},type:"get",dataType:"jsonp"})},showLog:function(e){var t=e.Source.baoDian,n=e.options,r=n.preferences;clearTimeout(t.timer),t.timer=setTimeout(function(){var e=[];$.each(n.$newsFlow.find("li"),function(t,n){var r=$(n);NewsFlow.Tools.isVisible(n)&&!r.data("isSend")&&r.attr("data-log")&&(e.push(r.attr("data-log")),r.data("isSend",1))});if(!e.length)return;$.ajax({url:"//news.qhstatic.com/srv/c2",data:{uid:n.guid,sign:r.sign,device:2,market:"so-home",func:"pc_news_realshow",net:5,stype:"portal",channel:n.$newsFlow.find(".top-tab a.selected").attr("data-param"),sqid:r.sqid,act:"real_show",refer_scene:0,refer_subscene:0,where:"list",n:e.length,url_pack:"["+e.toString()+"]"},dataType:"jsonp",type:"get"})})},countBatch:function(e){var t=e.Source.baoDian,n=e.options.type;!t.batch[n]&&(t.batch[n]=0),t.batch[n]++},getData:function(){var e=this,t=e.Source.baoDian,n=e.options.preferences;if(n.qid!==""){var r=JSON.parse(NewsFlow.Tools.localStorage.getItem("flow-sqid"));r&&r.guid&&r.guid==n.guid?(n.sqid=r.val,t.getFlowData(e)):t.getSqid(e)}else t.getFlowData(e)},getSqid:function(e){var t=e.Source.baoDian,n=e.options.preferences;$.ajax({url:"//u.api.look.360.cn/user/sqid",data:{u:n.guid,sign:n.sign,f:"jsonp",cq:n.Q,ct:n.T,device:2},type:"get",dataType:"jsonp",timeout:1e3,success:function(r){r&&r.data&&r.data.sqid?(NewsFlow.Tools.localStorage.setItem("flow-sqid",JSON.stringify({val:r.data.sqid,guid:n.guid})),e.sqid=r.data.sqid,t.getFlowData(e)):t.getFlowData(e)},error:function(){t.getFlowData(e)}})},getFlowData:function(e){var t=e.options,n=e.Source.baoDian,r=e.options.preferences;$.ajax({url:"//papi.look.360.cn/mlist",data:{u:t.guid,n:10,sign:r.sign,c:t.type=="mylike"?"youlike":t.type,f:"jsonp",device:2,sv:1,net:5,v:1,sqid:r.sqid,action:n.baodianPage==1?1:2},type:"get",dataType:"jsonp",success:function(t){if(e.noData)return;if(t&&t.data&&t.data.res)if(t.data.res.length){n.countBatch(e),n.sid=t.sid;var r=e.Source.baoDian.formatData(e,t.data.res);r.length&&e.render(r),n.showLog(e),n.baodianPage++}else e.setNoData()}}),t.currPage++},formatData:function(e,t){var n=[],r={},i=e.options.type,s=e.Source.baoDian,o=NewsFlow.Tools.localStorage.getItem(s.delNewsCookie);o=o?JSON.parse(o):[];for(var u=0,a=t.length;u<a;u++){r=t[u];var f="news";if(~$.inArray(r.t,o))continue;if(i!="youlike"&&!~$.inArray(r.s,["t","p","q"])||i=="youlike"&&!~$.inArray(r.s,["t","p","q","y"]))continue;var l=[];l.push(r.gnid||""),l.push(r.a||""),l.push(r.c||""),l.push(r.source||""),l.push(r.s||""),l.push(r.style||""),l.push(2e3),l.push(e.sid||""),l=" data-log='"+JSON.stringify(l)+"'";var c=r.showtime*1e3,h="",p="",d="";if(r.a=="t"&&r.attr&&r.attr[0]&&r.attr[0].isdisplay=="1"&&r.attr[0].content=="\u7f6e\u9876"){var v=r.attr[0];c='<span style="color:#'+v.color+'">'+v.content+"</span>",h="to-front"}var m=r.i&&r.i.split("|")||[];r.s=="y"&&r.duration&&m.length==1&&(f="video",d=NewsFlow.Tools.formatSeconds(r.duration),p=+r.playcnt?"<span>"+r.playcnt+"\u6b21\u89c2\u770b</span>":"");var g={type:f,playCount:p,liClass:h,date:c,title:r.t,from:"",url:r.pcurl,source:r.f,covers:m,corner:d,coversCount:r.s=="p"&&r.pnum>=4?r.pnum:"",attr:'" data-callbackUrl="'+r.u+'" data-a="'+r.a+'" data-c="'+r.c+'" data-src="'+r.source+'" data-s="'+r.s+'"'+l};g.zmt=r.zmt||"",r.zmt&&r.zmt.name&&(g.source=r.zmt.name),n.push(g)}return n}},focus:{getData:function(e){var t=this,n=t.options,r=parseInt((new Date).getTime()/1e3);if(t.noData)return;e=$.extend({noRender:!1,newsCount:n.newsCount,beforeCb:$.noop,afterCb:$.noop,failCb:$.noop},e),$.ajax({url:"//user.360kuai.com/following/getFollowList",data:{sign:"360_fc624efc",uid:n.guid,token:r+"|"+So.lib.md5(n.guid+"fdasof09vni234rk23b498uvo234eo14n123b12v31v23c1y23y1u"+r),f:"jsonp",page:Math.max(n.currPage,n.requestPage)},type:"get",timeout:5e3,dataType:"jsonp",success:function(r){if(t.noData)return;if(r&&r.data&&!r.data.res.length&&n.currPage==1&&n.neverDataCb){n.neverDataCb(t);return}if(r&&r.data&&r.data.res.length){e.beforeCb();var i=t.Source.focus.formatData.call(t,r.data.res);i.length&&t.render(i,e.noRender),setTimeout(function(){e.afterCb(t)},0)}else t.setNoData(e),e.failCb(t);n.currPage++},error:function(){if(n.currPage==1&&n.neverDataCb){n.neverDataCb(t);return}t.setNoData(e),e.failCb(t)}}),n.requestPage++},formatData:function(e){var t=[],n={};for(var r=0,i=e.length;r<i;r++){n=e[r];if(!n.t||!n.f||!n.pcurl||!n.p)continue;t.push({type:"news",liClass:"papi",date:n.p*1e3,title:n.t,from:n.f,url:n.pcurl,source:n.f,covers:n.i?n.i.split("|"):[]})}return t}}},clearUpData:function(e){var t=this,n=[],r={},i;for(var s=0,o=e.length;s<o;s++){i=e[s];var u=i.title,a=t.options,f=i.covers,l="";if(a.guid!=""&&i.zmt&&i.zmt.id&&i.zmt.is_followed&&i.zmt.name&&i.zmt.pic){var c=i.zmt.id,h=i.zmt.is_followed,p=i.zmt.name,d=i.zmt.pic,v=h=="1"?"res-news-flow-button-cancel-follow":"res-news-flow-button-follow",m=h=="1"?"\u5df2\u5173\u6ce8":"+\u5173\u6ce8";l='<span class="'+v+'" data-zmt-id="'+c+'" data-zmt-is-followed="'+h+'" data-zmt-name="'+p+'" data-zmt-pic="'+d+'">'+m+"</span>"}r={dataSource:a.source,from:i.from,type:i.type,playCount:i.playCount,source:i.source,title:"",titleLong:u,titleFull:$.trim(NewsFlow.Tools.getTxt(u)),corner:i.corner,covers:[],coversWidth:0,coversHeight:0,liCoversClass:"",url:i.url,date:i.date,liClass:i.liClass+" "+i.type,attr:i.attr,tag:"",followButton:l},$.isNumeric(r.date)&&(r.date="<span>"+NewsFlow.Tools.formatTime(new Date(r.date),"yyyy-MM-dd hh:mm",1).replace(" 00:00","")+"</span>"),r.source&&(r.source='<span style="margin-right:5px">'+r.source+"</span>"),a.isShowTag&&i.tag&&(r.tag='<span class="vertical-line"></span><span class="tag-weak">'+i.tag+"</span>");if(i.type=="atlas"){r.covers=f.slice(0,2),r.coversWidth=a.atlasImg.width,r.coversHeight=a.atlasImg.height;for(var g=0,y=r.covers.length;g<y;g++){var b=NewsFlow.Tools.sslReplace(NewsFlow.Tools.getPicUrl(r.covers[g],"/dmt/"+r.coversWidth+"_"+r.coversHeight+"_"));r.covers[g]={style:' class="anim"',src:b}}r.title=u}else if(f.length>=a.manyImg.count&&!a.onlyShowSingleImg){a.manyImg.isShowCorner||(r.corner=""),r.covers=f.slice(0,a.manyImg.count),r.coversWidth=a.manyImg.width,r.coversHeight=a.manyImg.height;for(var g=0,y=r.covers.length;g<y;g++){var b=NewsFlow.Tools.sslReplace(NewsFlow.Tools.getPicUrl(r.covers[g],"/dmt/"+r.coversWidth+"_"+r.coversHeight+"_"));r.covers[g]={style:' class="anim"',src:b}}r.title=u}else if(f.length>0){i.type!=="video"&&(r.corner=""),r.liCoversClass="single-img",r.covers=f.slice(0,1),r.coversWidth=a.singleImg.width,r.coversHeight=a.singleImg.height;var b=NewsFlow.Tools.sslReplace(NewsFlow.Tools.getPicUrl(r.covers[0],"/dmt/"+r.coversWidth+"_"+r.coversHeight+"_"));r.covers[0]={style:' class="anim"',src:b},r.title=NewsFlow.Tools.cutStr(u,a.singleImg.titleLength)}else a.onlyShowSingleImg||(r.title=NewsFlow.Tools.cutStr(u,a.noImg.titleLength));r.title=NewsFlow.Tools.unescapeHTML(r.title),n.push(r)}return n},hideLoading:function(){var e=this;e.$loading.hide()},render:function(e,t){var n=this,r=n.options,i=r.eventMark;e=n.clearUpData(e);var s=[];for(var o=0;o<e.length;o++)s.push(NewsFlow.Tools.template(r.template,$.extend(e[o],{tplType:"news"})));n.$flowInner.append(s.join("")),n.activateFollowButton(),setTimeout(function(){r.renderAfterCb(n),!t&&NewsFlow.Tools.observer.publish(i+".rendered")},0),n.sendLog({type:"flow-ajax"})},getData:function(e){var t=this;t.Source[t.options.source].getData.call(this,e)},setNoData:function(e){var t=this,n=t.options,r=n.$newsFlow.find("li").length;if(t.currRetryGetDataTimes<n.retryGetDataTimes){t.currRetryGetDataTimes++,t.getData(e);return}if(t.noData)return;t.noData=!0,n.noDataCb(t,r),t.hideLoading(),r>0?t.$flowInner.after(NewsFlow.Tools.template(n.template,{tplType:"noData"})):t.removeFlow()},removeFlow:function(){var e=this,t=e.options;t.removeFlowCb(e);if(t.alwaysShowFlow==1)return;t.$newsFlow.remove()},gotoTop:function(){var e=this;if(!e.options.showGotoTop)return;$(window).scrollTop()>e.options.gotoTopDis?e.$gotoTop.fadeIn():e.$gotoTop.fadeOut()},scrollLoad:function(e){e=e||this;if(e.noData)return;var t=e.options,n=$(window),r=n.height();$(document).height()-n.scrollTop()-r<r&&(e.getData(),t.$newsFlow.find("li").length&&e.$loading.show())},sendLog:function(e){var t=this.options;NewsFlow.Tools.log(t.logMark,$.extend({p1:t.from,p2:t.source,datatype:t.type,abid:t.$newsFlow.attr("data-abtest-id")},e))},eventBind:function(){var e=this,t=e.options,n=$(window),r=t.eventMark,i=t.eventMark.replace(/\./g,""),s=t.$newsFlow,o,u=0;n.off("."+i+"WinScroll").on("scroll."+i+"WinScroll.haosou",function(i){if(!s.is(":visible")||e.noData)return;t.scrollCb(e),t.preventScrollLoad||(clearTimeout(o),o=setTimeout(function(){e.scrollLoad(e)},500)),t.showGotoTop&&e.gotoTop(),NewsFlow.Tools.observer.publish(r+".scroll",n.scrollTop()>u),u=n.scrollTop()}),e.$gotoTop.on("click",function(){e.sendLog({type:"go-top"}),$("html, body").animate({scrollTop:0},300)}).appendTo($("body"));var a;s.on("click",function(t){var n=$(t.target),i=n.closest('li[data-from^="news"]'),o=e.Source[e.options.source];if(!i.length)return;if(n.is(".close-list a")){var u=o.closeLog;u&&u(e,i),e.sendLog({type:"close-news",value:n.attr("data-val")}),i.slideUp(100,function(){i.remove(),s.find("li").length||e.removeFlow(),NewsFlow.Tools.observer.publish(r+".flowHeightChange")}),e.addNews()}else if(n.closest("a").length){var a=function(t){e.sendLog({type:t,pos:i.index()+1,p3:i.attr("data-log-extend"),value:n.attr("data-log"),urls:i.find("a:eq(0)").attr("data-mdurl")||i.find("a:eq(0)").attr("href"),viewtype:i.find(".sub-title").text(),source:i.find(".tag").text(),template:i.attr("data-type")})},f=o.clickLog;f&&f(e,i);if(n.is(".desc .tag"))return a("flow-click-tag"),location.href="//www.so.com/s?src=soflow_tag&q="+encodeURIComponent(n.text()),!1;a("flow-click")}}).on("mouseenter","div.close",function(e){$(e.target).closest("li").addClass("curr"),s.find("div.close").removeClass("hover"),s.find(".close-list").remove(),clearTimeout(a),$(this).addClass("hover").append(NewsFlow.Tools.template(t.template,{tplType:"closeList"}))}).on("mouseleave","div.close",function(e){var t=$(this);$(e.target).closest("li").removeClass("curr"),clearTimeout(a),a=setTimeout(function(){t.removeClass("hover").find(".close-list").remove()},200)}),$("body").on("click",function(e){$(e.target).closest(".flow-follow-guider-tip-container-home1").length||$(".flow-follow-guider-tip-container-home1").remove()})},addNews:function(){var e=this,t=e.options;if(e.noData)return;t.addNewsCb!=$.noop?t.addNewsCb(e):e.scrollLoad()},subscribe:function(){var e=this,t=e.options.eventMark;NewsFlow.Tools.observer.subscribe(t+".addNews",function(){e.addNews()}),NewsFlow.Tools.observer.subscribe(t+".closeFlow",function(){e.removeFlow()})},activateFollowButton:function(){var e=this,t=this.options,n=function(e){var t="fdasof09vni234rk23b498uvo234eo14n123b12v31v23c1y23y1u",n=(new Date).getTime()/1e3,r=So.lib.md5(e+t+n);return n+"|"+r},r=function(e){var t=e.attr("data-isLoading");return typeof t=="undefined"||t=="0"?!1:!0},i=$("span[class^=res-news-flow-button]");if(i.length&&!e.hasSendFollowButtonSrpLog){var s=So.comm.pid=="www"?"news-flow":"homecard";So.lib.log(s,{type:"button-show"}),this.hasSendFollowButtonSrpLog=!0}i.unbind("mouseenter"),i.on("mouseenter",function(){var e=$(this);if(r(e))return!1;if($(".flow-follow-guider-tip-container").length||$(".flow-follow-guider-tip-container-home").length||$(".flow-follow-guider-tip-container-home1").length)return!1;if($(".flow-follow-error-tip-container").length)return!1;var t=e.closest("a[data-log='link']"),n=t.attr("title");typeof n!="undefined"&&(t.attr("data-title-temp",n),t.removeAttr("title"));var i=e.attr("data-zmt-is-followed"),s=i==1?"\u70b9\u51fb\u53d6\u6d88\u5173\u6ce8":"\u70b9\u51fb\u5173\u6ce8",o=$("<div class='res-news-flow-follow-msg-tip'>"+s+"</div>"),u=e.position().top-15,a=e.position().left+36;o.css({top:u,left:a}),o.insertAfter(e)}),i.unbind("mouseleave"),i.on("mouseleave",function(){var e=$(this);if(r(e))return!1;$(".res-news-flow-follow-msg-tip").remove();var t=e.closest("a[data-log='link']"),n=t.attr("data-title-temp");typeof n!="undefined"&&(t.attr("title",n),t.removeAttr("data-title-temp"))}),i.unbind("click"),i.on("click",function(){function a(r){c(e);var i=function(){h(e,r),f(r,0);var n=r==1?2:1;l(s,n),t.guid==""&&So.lib.log("news-flow",{type:"no-uid"})},a=So.comm.pid=="www"?"360_e39369d1":"360_fc624efc";$.ajax({url:"https://user.360kuai.com/following/add",data:{uid:t.guid,token:n(t.guid),"do":r,id:s,sign:a,device:2,net:5,scene:1,where:"list",name:o,pic:u,f:"jsonp"},method:"get",dataType:"jsonp",crossDomain:!0,timeout:2e4,success:function(t){t.data!=r?i():(f(r,1),l(s,r),r==1&&p(e))},error:function(){i()}})}function f(e,t){var n=t==0?"fail ":"",r=e==1?n+"like":n+"notlike",i=So.comm.pid=="www"?"news-flow":"homecard";So.lib.log(i,{type:r,mid:So.lib.getUnMid(So.comm.md||So.lib.cookie.get("__md"))})}function l(e,t){var n=$("span[class^=res-news-flow-][data-zmt-id='"+e+"']");n.attr("data-isLoading",0),t==1?(n.text("\u5df2\u5173\u6ce8"),n.attr("class","res-news-flow-button-cancel-follow"),n.attr("data-zmt-is-followed",1)):(n.text("+\u5173\u6ce8"),n.attr("class","res-news-flow-button-follow"),n.attr("data-zmt-is-followed",0))}function c(e){var t=$("<div class='follow-button-loading-div'></div>");e.append(t),e.attr("class","res-news-flow-follow-loading"),e.attr("data-isLoading",1)}function h(e,t){$(".flow-follow-error-tip-container").remove(),errorMsg=t==1?"\u5173\u6ce8\u5931\u8d25\uff0c\u8bf7\u518d\u8bd5\u4e00\u6b21":"\u53d6\u6d88\u5173\u6ce8\u5931\u8d25\uff0c\u8bf7\u518d\u8bd5\u4e00\u6b21";var n=e.closest('li[data-from^="news-"]');n.css({overflow:"visible"});var r=$("<div class='flow-follow-error-tip-container'></div>"),i=$("<div class='tip-left-triangle'></div>"),s=$("<div class='error-tip-msg-panel'>"+errorMsg+"</div>");r.append(i),r.append(s);var o=e.position().top-2,u=e.position().left+48;r.css({top:o,left:u}),n.append(r),setTimeout(function(){n.css({overflow:"hidden"}),$(".flow-follow-error-tip-container").remove()},2e3)}function p(e){var t=So.lib.cookie.get("hasUseFollowBtn");if(typeof t=="undefined"){var n=1e3,r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i={expires:r.toGMTString()};So.lib.cookie.set("hasUseFollowBtn",1,i);var s=e.closest('li[data-from^="news-"]');s.css({overflow:"visible"});var o=$("<div class='flow-follow-guider-tip-container'></div>"),u="";if(So.comm.pid=="www"){var a="\u5173\u6ce8\u540e\u53ef\u4ee5\u5728\u5c4f\u5e55\u53f3\u4e0a\u65b9\u201c\u6211\u7684\u5173\u6ce8\u201d\u4e2d\u770b\u5230\u66f4\u65b0\u5185\u5bb9\u5566~",f=$("<div class='tip-left-triangle'></div>"),l=$("<div class='guider-tip-msg-panel'>"+a+"</div>"),c=$("<a href='javascript:;' class='guider-tip-close-button'></a>");o.append(f),o.append(l),o.append(c),u=c}else if(So.comm.pid=="home"){o.attr("class","flow-follow-guider-tip-container-home1");var c=$('<div class="tip-close-btn"></div>');o.append(c),u=c}var h=e.position().top-2,p=e.position().left+48;o.css({top:h,left:p}),s.append(o),c.on("click",function(){s.css({overflow:"hidden"}),o.remove()}),o.show(),setTimeout(function(){s.css({overflow:"hidden"}),o.remove()},1e4)}}$(".flow-follow-guider-tip-container-home1").remove();var e=$(this);if(r(e))return!1;$(".res-news-flow-follow-msg-tip").remove(),$(".flow-follow-guider-tip-container").remove();var i=e.attr("data-zmt-is-followed"),s=e.attr("data-zmt-id"),o=e.attr("data-zmt-name"),u=e.attr("data-zmt-pic");return i==1?a(2):a(1),!1})},init:function(){var e=this,t=e.options;t.initCb(e),e.eventBind(),e.subscribe(),e.sendLog({type:"show"}),e.$flowInner.after(e.$loading),t.showGotoTop&&e.$gotoTop.appendTo($("body")),e.activateFollowButton()}}}(),define("js/news-flow/flow",function(
){}),function(){function e(){return So.lib.checkAbv(1078,"ad_test")&&$.inArray(So.newsFlow.type,["official","weather","famous","video","news"])!=-1}NewsFlowSad=function(e){var t=this,n={$newsFlow:So.newsFlow.$newsFlow,showId:So.newsFlow.showId,eventMark:So.newsFlow.eventMark,logMark:So.newsFlow.logMark,type:So.newsFlow.type,qcmsData:null,showQcmsData:!1,startPos:So.newsFlow.flowQcms.resultAdStart,step:So.newsFlow.flowQcms.resultAdStep,onlyShowSingleImg:!1,onlyShowSingleManyImg:!1,jumpShow:!0,guid:So.comm.guid,template:"",video:{height:201},bigImg:{width:540,height:201},squareImg:{count:4,width:132,height:132},bannerImg:{width:540,height:64},manyImg:{count:4,width:132,height:84},singleImg:{width:132,height:84,titleLength:100},insertCb:$.noop};t.options=$.extend(!0,{},n,e),t.currPos=t.options.startPos,t.html=[],t.page=1,t.timer,t.timerVideo,t.deck=!0,t.delCount=20,t.mouseDownTime=0,t.mouseUpTime=0,t.init()},NewsFlowSad.Tools={checkImg:function(){var e=event.srcElement;$(e).remove(),e.onerror=null},formatSeconds:function(e){var t=[parseInt(e/60/60),parseInt(e/60%60),parseInt(e%60)];return t[0]===0&&t.shift(),t.join(":").replace(/\b(\d)\b/g,"0$1")},log:So.lib.log,cutStr:So.lib.cutStr,template:So.lib.template,observer:So.lib.observer,isVisible:So.lib.isVisible1,soLocalStorage:So.lib.soLocalStorage};var t;NewsFlowSad.prototype={init:function(){var e=this;e.options.showQcmsData&&e.clearUpQcmsData(),e.bindEvent(),e.insert()},bindEvent:function(){var t=this,n=t.options.$newsFlow,r=t.options.eventMark;NewsFlowSad.Tools.observer.subscribe(r+".rendered",function(){t.insert(t)}),NewsFlowSad.Tools.observer.subscribe(r+".scroll",function(e){t.scrollEevent(t,e)}),n.on("mousedown","li[data-from=sad]",function(){t.mouseDownTime=+(new Date)}).on("mouseup","li[data-from=sad]",function(n){t.mouseUpTime=+(new Date);var r=$(this),i=$(n.target),s=i.closest("a");if(s.length&&s.attr("data-href")){var o=Math.abs(parseInt(i.offset().left-r.offset().left+n.offsetX)),u=Math.abs(parseInt(i.offset().top-r.offset().top+n.offsetY));s.attr("href",t.macro(s.attr("data-href"),o,u,r.width(),r.height())),t.sendAdLog(t.macro(r.data("clktk"),o,u,r.width(),r.height())),t.sendLog({type:"sad-click",pos:r.index()+1,value:i.attr("data-log")})}e()&&t.sendLog({type:"test-sad-click",pos:r.index()+1})}).on("click","li[data-from=sad] .close-list a",function(e){var n=$(this).closest("li"),i=$(e.target);n.data("clstk")&&t.sendAdLog(t.macroDel(n.data("clstk"),i.attr("data-val"))),NewsFlowSad.Tools.observer.publish(r+".addNews"),t.sendLog({type:"close-sad",pos:n.index()+1,value:i.attr("data-val")}),t.delAd(n)}).on("click","li[data-from=sad] .horn",function(e){var t=$(this).closest("li").find("video")[0],r=$(e.target);r.hasClass("open")?(r.removeClass("open"),t.muted=!0):(n.find(".horn").removeClass("open"),r.addClass("open"),$.each(n.find("video"),function(e,t){t.muted=!0}),t.muted=!1)}).on("click","li[data-from=sad] .play",function(e){var n=$(this).closest("li"),r=n.find("video")[0],i=$(this);t.videoPlayTime(i,r),r.paused?(r.play(),i.addClass("paused"),n.removeClass("manual-stop")):(r.pause(),i.removeClass("paused"),n.addClass("manual-stop"))}).on("click","li[data-from=sad-qcms]",function(e){var n=$(e.target),r=$(this);n.is(".close-list a")?(t.delAd(r),t.sendLog({type:"close-qcms-sad"})):n.closest("a").length&&t.sendLog({type:"sad-qcms-click",pos:r.index()+1,value:n.attr("data-log")})})},videoPlayTime:function(e,t){t.ontimeupdate=function(){e.find(".time").text(NewsFlowSad.Tools.formatSeconds(Math.floor(t.duration-t.currentTime)))}},calculateAdPos:function(e){var t=this,n=t.options;e?t.currPos=n.startPos:t.currPos=n.$newsFlow.find('li[data-from="sad"]:last').index()+n.step+1},delAd:function(e){var t=this,n=t.options.$newsFlow,r=t.options.eventMark;e.slideUp(100,function(){e.remove(),n.find("li").length||NewsFlowSad.Tools.observer.publish(r+".closeFlow"),NewsFlowSad.Tools.observer.publish(r+".flowHeightChange"),t.calculateAdPos()})},macroDel:function(e,t){return e.replace(/__DISLIKE_RULE_ID__|__DISLIKE_TAG__/g,function(e){return{__DISLIKE_RULE_ID__:t,__DISLIKE_TAG__:"\u4e0d\u611f\u5174\u8da3"}[e]})},macro:function(e,t,n,r,i){var s=this;return e.replace(/__OFFSET_X__|__OFFSET_Y__|__EVENT_TIME_START__|__EVENT_TIME_END__|__ADSPACE_W__|__ADSPACE_H__/g,function(e){return{__OFFSET_X__:t,__OFFSET_Y__:n,__EVENT_TIME_START__:s.mouseDownTime,__EVENT_TIME_END__:s.mouseUpTime,__ADSPACE_W__:r,__ADSPACE_H__:i}[e]})},clearUpQcmsData:function(){var e=this,t=e.options,n=t.qcmsData;if(!n)return;var r=NewsFlowSad.Tools.soLocalStorage.getItem("delAd");r=r?JSON.parse(r):[];if(!n||~$.inArray(n.title,r))return;r.push(n.title),NewsFlowSad.Tools.soLocalStorage.setItem("delAd",JSON.stringify(r));var i={from:"sad-qcms",curl:n.curl,isBanner:parseInt(n.isBanner),isShowAd:parseInt(n.isShowAd),title:n.title||"",desc:n.desc||"",src:n.src||""},s=!1;for(var o=0,u=n.imgs.length;o<u;o++)if(n.imgs[o].img==""||n.imgs[o].curl==""){s=!0;break}i.isBanner||s||t.onlyShowSingleImg?i.img=n.imgs[0].img:i.assets=n.imgs;if(i.img||i.assets)e.currPos=parseInt(n.pos);e.sendLog({type:"show-qcms-sad"}),e.clearUpData([i])},sendLog:function(e){var t=this.options;NewsFlowSad.Tools.log(t.logMark,$.extend({},{abid:t.$newsFlow.attr("data-abtest-id"),datatype:t.type},e))},sendAdLog:function(e){if(!e)return;e=e.split("||"),window.sadLog={};var t;for(var n=0,r=e.length;n<r;n++)t="log_"+ +(new Date),sadLog[t]=new Image,sadLog[t].onload=sadLog[t].onerror=function(){delete sadLog[t]},sadLog[t].src=e[n]},imptkLog:function(e){e=e||this;var t=e.options;$.each(t.$newsFlow.find('li[data-from="sad"]'),function(t,n){var r=$(n);!r.data("imptked")&&NewsFlowSad.Tools.isVisible(r[0])&&(r.data("imptked",1),e.sendLog({type:"sad-show"}),e.sendAdLog(r.data("imptk")))})},scrollEevent:function(e,t){e=e||this;var n=e.options,r=!1;e.imptkLog(e),clearTimeout(e.timerVideo);var i=n.$newsFlow.find('li[data-from="sad"]');i=t?$(i.get().reverse()):i,e.timerVideo=setTimeout(function(){$.each(i,function(t,n){var i=$(n),s=i.find("video"),o=s[0],u=i.find(".play");if(!i.hasClass("manual-stop")&&s.length){var a=n.getBoundingClientRect();!r&&NewsFlowSad.Tools.isVisible(n)&&a.top>30&&$(window).height()-a.bottom>-100?(u.addClass("paused"),o.play(),e.videoPlayTime(u,o),r=!0):(u.removeClass("paused"),o.pause())}})},40)},insert:function(e){e=e||this;var t=e.html,n=e.currPos,r=e.options,i=r.step,s=r.$newsFlow;t.length<2&&(clearTimeout(e.timer),e.timer=setTimeout(function(){e.getData(e)},1e3)),s.find("li:not([class*=to-front])").length-(n+1)>=0&&t.length>0&&(s.find("li:not([class*=to-front]):eq("+n+")").before(t.shift()),e.deck&&r.jumpShow?(e.currPos+=i,e.deck=!1):(e.currPos+=i+1,e.deck=!0),e.insert(),e.scrollEevent(e,!1),r.insertCb())},clearUpData:function(e){var t=this,n=t.options,r={};for(var i=0,s=e.length;i<s;i++){var o=e[i].title;r={img:[],imgWidth:0,imgHeight:0,liCoversClass:"",url:e[i].curl,source:e[i].src,title:o,titleFull:o,imptk:e[i].imptk&&e[i].imptk.join("||"),clktk:e[i].clktk&&e[i].clktk.join("||"),clstk:e[i].clstk&&e[i].clstk.join("||"),from:"sad",sadTxt:'<span class="txt">\u5e7f\u544a</span>',type:"",duration:"00:00"};if(!n.onlyShowSingleImg&&!n.onlyShowSingleManyImg)switch(e[i].type){case 4:/msie (6|7|8|9)/gi.test(navigator.userAgent)?r.type="bigImg":r.type="video";break;case 3:r.type="bigImg";break;case 2:if(e[i].assets){var u=e[i].assets[0];u&&u.imgw&&u.imgh===u.imgw&&(r.type="squareImg")}}e[i].isShowAd===0&&(r.sadTxt=""),e[i].from&&(r.from=e[i].from,r.liCoversClass=r.from);var a=e[i].assets||[],f=e[i].img||"";if(r.type=="video"&&!n.onlyShowSingleManyImg)r.liCoversClass+=" sad-video",r.imgHeight=n.video.height,e[i].duration&&(r.duration=NewsFlowSad.Tools.formatSeconds(e[i].duration)),f=e[i].video,r.img[0]={style:"",url:r.url,src:f};else if(r.type=="bigImg"&&!n.onlyShowSingleManyImg)r.liCoversClass+=" big-img",r.imgWidth=n.bigImg.width,r.imgHeight=n.bigImg.height,f=e[i].img,r.img[0]={style:' class="anim"',url:r.url,src:f};else if(r.type=="squareImg"&&a.length>=n.squareImg.count&&!n.onlyShowSingleManyImg){r.liCoversClass+=" square-img",r.imgWidth=n.squareImg.width,r.imgHeight=n.squareImg.height;for(var l=0,c=n.squareImg.count;l<c;l++)r.img[l]={style:' class="anim"',url:a[l].curl,src:a[l].img}}else if(e[i].isBanner)r.liCoversClass+=" banner-img",r.imgWidth=n.bannerImg.width,r.imgHeight=n.bannerImg.height,r.img[0]={style:' class="anim"',url:r.url,src:f};else if(a.length>=n.manyImg.count&&!n.onlyShowSingleImg){r.type="manyImg",r.imgWidth=n.manyImg.width,r.imgHeight=n.manyImg.height;for(var l=0,c=n.manyImg.count;l<c;l++)r.img[l]={style:' class="anim"',url:a[l].curl,src:a[l].img}}else f&&(r.type="singleImg",r.liCoversClass+=" single-img",r.imgWidth=n.singleImg.width,r.imgHeight=n.singleImg.height,r.img[0]={style:' class="anim"',url:r.url,src:f},r.title=NewsFlowSad.Tools.cutStr(o,n.singleImg.titleLength));if(!r.img.length)continue;t.html.push(NewsFlowSad.Tools.template(n.template,$.extend(r,{tplType:"sad"})))}},getData:function(n){var r=n.options;if(e()){if(t)t.renderList();else{var i="";switch(So.newsFlow.type){case"official":i="soflow_official";break;case"weather":i="soflow_weather";break;case"famous":i="soflow_famous";break;case"video":i="soflow_video";break;case"news":i="soflow_news"}var s={src:"so-pc-flow",from:i,n:6,srcg:So.newsFlow.type,isNeedTemplate:!1,query:So.comm.q,adTypes:"1,3,5",imgSize:[132,84],useLianmengTitle:!0,renderItem:function(e,t,i,s){console.log(e,t,i,s),n.html.push(NewsFlowSad.Tools.template(r.template,$.extend(t,{src:t.src?"<span>"+t.src+"</span>":"",type:e,tplType:"sadTest"}))),n.insert(n)}};t=new qhMultiResourceInnV2(s),t.init()}return}$.ajax({url:location.protocol=="https:"?"//show-g.mediav.com/s?scheme=https":"//show.g.mediav.com/s",type:"get",jsonp:"jsonp",dataType:"jsonp",data:{of:4,type:1,newf:1,impct:8,uid:r.guid,reqtimes:n.page,showid:r.showId,refurl:document.referrer},success:function(e){n.page++,e&&e.ads&&e.ads.length>0&&(n.clearUpData(e.ads),n.insert(n))}})}}}(),define("js/news-flow/sad",function(){}),define("js/home/card/news-flow",["text!html/news-flow.html!strip","js/news-flow/flow","js/news-flow/sad"],function(e){function d(){t.removeClass("limitation").find(".bottom-arrow").remove()}function v(){var e=l.$gotoTop;if(e.is(":hidden"))return;var t=$("body").hasClass("widescreen")?20:10;e.css({left:r.offset().left+r.width()-s.scrollLeft()+t})}function m(){s.on("scroll mousewheel DOMMouseScroll",d),i.on("click",d),So.lib.observer.subscribe(a.infoFlowTabFixed,function(e){o=e.isOk});var e;s.on("resize",function(){clearTimeout(e),e=setTimeout(v,50)});var t;s.on("scroll",function(){clearTimeout(t),e=setTimeout(v,50)})}function g(){t.prepend(So.lib.template(e,{tplType:"tab",data:h})).find(".top-tab a").on("click",function(){var e=$(this),r=t.offset().top-76;f=e.attr("data-param"),t.off("click mouseenter mouseleave"),n.empty(),p==0&&(b(),f=="mylike"?x(f):S(f)),c.options.type=f,d(),e.addClass("selected").siblings().removeClass("selected"),$("#card_container").css({minHeight:s.height()-100}),p==0&&(o?s.scrollTop(r):$("html, body").animate({scrollTop:r},500),So.lib.log("homecard",{type:"click_"+f}))}),$("#res_news_flow .top-tab a.selected").removeClass("selected"),$("#res_news_flow .top-tab a:eq(1)").addClass("selected")}function y(){var e=$(window).height(),n=$("body").scrollTop()||$("html").scrollTop()||0;t.find("li[data-from^=news]").each(function(t,r){var i=$(r),s=i.offset().top,o=i.height();i.attr("data-log-gz")!=="1"&&s<n+e-o&&s-n>90&&(i.find("span[class^='res-news-flow-button-']").length&&So.lib.log("homecard",{type:"has-follow-button",ext:t}),i.attr("data-log-gz","1"))})}function b(){$(".focus-top-txt").remove(),$(".focus-top-title").remove(),$("#goto-top").remove(),$(".no-more").remove(),t.find(".loading").remove()}function w(t){var n={type:t,template:e,manyImg:{width:178,height:113},singleImg:{width:178,height:113}},r;if(So.newsFlow.adsQcmsData.length)for(var i=0;i<So.newsFlow.adsQcmsData.length;i++)if(So.newsFlow.adsQcmsData[i].isHome==1){r=So.newsFlow.adsQcmsData[i];break}c=new NewsFlowSad($.extend({showId:"lDwum1",step:So.newsFlow.flowQcms.step,startPos:u,onlyShowSingleManyImg:!0,jumpShow:!1,showQcmsData:!0,qcmsData:r},n))}function E(){t.find(".card-loading").remove(),t.find(".loading.short").removeClass("short")}function S(t){var n={type:t,template:e,manyImg:{width:178,height:113},singleImg:{width:178,height:113}};l=new NewsFlow($.extend({debugTxt:"home.card",source:"baoDian",preferences:{Q:So.lib.cookie.get("Q"),T:So.lib.cookie.get("T"),guid:So.comm.guid,qid:So.comm.user.qid,sign:"360_fc624efc",sqid:""},initCb:function(e){e.getData(),setTimeout(E,10)},renderAfterCb:function(e){i.show(),E()}},n))}function x(r){var s={type:r,template:e,manyImg:{width:178,height:113},singleImg:{width:178,height:113}};l=new NewsFlow($.extend({debugTxt:"home.card.focus",source:"focus",initCb:function(e){e.getData(),setTimeout(E,10)},renderAfterCb:function(e){i.show(),E(),t.find(".close").hide()},neverDataCb:function(){b(),n.before('<div class="focus-top-txt">\u60a8\u8fd8\u6ca1\u6709\u5173\u6ce8\u4f5c\u8005<br>\u5efa\u8bae\u60a8\u67e5\u770b\u201c\u70ed\u95e8\u8d44\u8baf\u63a8\u8350\u201d\uff0c\u9047\u89c1\u559c\u6b22\u7684\u5185\u5bb9\u53ef\u4ee5\u70b9\u51fb\u5173\u6ce8\uff5e</div>'),n.before('<div class="focus-top-title">\u70ed\u95e8\u8d44\u8baf\u63a8\u8350</div>'),t.off("click mouseenter mouseleave"),S(r)}},s))}function T(){r=So.newsFlow.$cardContainer,t=So.newsFlow.$newsFlow,n=t.find("ul"),i=t.find(".bottom-arrow"),w(f||h[0].param),S(f||h[0].param),g(),m(),setTimeout(function(){y()},3e3,!0),So.lib.observer.subscribe(So.newsFlow.eventMark+".scroll",function(){y()})}var t,n,r,i,s=$(window),o=!1,u=So.newsFlow.flowQcms.homeAdStart,a=So.newsFlow.observerEvent,f,l,c,h=[{txt:"\u5173\u6ce8",param:"mylike"},{txt:"\u70ed\u70b9",param:"youlike"},{txt:"\u5a31\u4e50",param:"fun"},{txt:"\u623f\u4ea7",param:"estate"},{txt:"\u4f53\u80b2",param:"sport"},{txt:"\u56fd\u5185",param:"domestic"},{txt:"\u8f9f\u8c23",param:"refuteRumour"},{txt:"\u6c7d\u8f66",param:"car"},{txt:"\u56fd\u9645",param:"international"}],p=!1;return f="youlike",{init:T}}),define("js/home/card/often-so",[],function(){function c(){$.ajax({url:a,dataType:"jsonp",data:{src:"so_home",ret_type:"jsonp",req:"kw",mid:So.comm.md,guid:u},jsonp:"callback",timeout:2e3,jsonpCallback:"__query_rec",success:function(t){if(t&&t.status&&t.status.data=="stopped"){var n=new Date;n.setDate(n.getDate()+30),So.lib.cookie.set(So.newsFlow.closeOffensoCookieMark,1,{expires:n}),e.remove();return}t&&t.data&&t.data.length&&(r=r.concat(t.data)),p()},error:function(){p()}})}function h(e){var t=[],n,r=So.lib.soLocalStorage.getItem("often-del")||JSON.stringify([]);r=JSON.parse(r);for(var i=0,s=e.length;i<s;i++){n=!1;for(var o=0,u=r.length;o<u;o++)if(e[i].kw==r[o]){n=!0;break}!n&&t.push(e[i])}var a=[];for(var i=0,s=t.length;i<s;i++){n=!1;for(var o=0,u=a.length;o<u;o++)if(t[i].kw==a[o].kw){n=!0;break}!n&&a.push(t[i])}return a}function p(){r=r.concat(s);for(var e=0,o=r.length;e<o;e++)r[e].kw?r[e].from!="hnews"&&i.push({kw:r[e].kw,icon:So.lib.getPicUrl(r[e].icon,"/dmt/13_13_"),type:"user"}):i.push({kw:r[e],type:"qcms"});i=h(i),t.append(l.tools);if(!i.length){t.find(".edit").hide(),n.html(l.noData);return}n.html(So.lib.template(l.list,{data:i}))}function d(){t.on("click",function(t){var n=$(t.target);n.is(".finish")?e.removeClass("edit"):n.is(".edit")?(e.addClass("edit"),So.lib.log(f,{type:"del-edit"})):n.is(".close")&&So.newsFlow.closeMask({title:"\u786e\u8ba4\u5173\u95ed\u5e38\u641c\u670d\u52a1\uff1f",desc:"\u4eb2\uff0c\u5173\u95ed\u5e38\u641c\u670d\u52a1\u5c06\u65e0\u6cd5\u5feb\u6377\u7684\u67e5\u8be2\u611f\u5174\u8da3\u7684\u5185\u5bb9\uff5e",sureTxt:"\u786e\u8ba4\u5173\u95ed",callback:function(){var e=new Date;e.setDate(e.getDate()+30),So.lib.cookie.set(So.newsFlow.closeOffensoCookieMark,1,{expires:e});var t=+(new Date);$.ajax({url:a,dataType:"jsonp",data:{mid:So.comm.md,guid:u,src:"so_home","switch":"off",oa:So.lib.md5(So.comm.md+t+"a%&k*b"),action:"off",_t:t},jsonp:"callback",jsonpCallback:"__query_rec"}),So.lib.log(f,{type:"close-oftenso"})}})}),n.on("click",".del",function(){var e=$(this),r=e.attr("data-kw"),i=So.lib.soLocalStorage.getItem("often-del")||JSON.stringify([]);i=JSON.parse(i),i.length==o&&i.shift(),i.push(r),So.lib.soLocalStorage.setItem("often-del",JSON.stringify(i));if(e.attr("data-type")=="user"){var s=+(new Date);$.ajax({url:a,type:"get",dataType:"jsonp",jsonp:"callback",jsonpCallback:"__query_rec",data:{mid:So.comm.md,guid:u,src:"del",del_kw:r,oa:So.lib.md5(So.comm.md+r+s+"a%&k*b"),action:"del",_t:s}})}e.closest("span").remove(),n.find("span:lt(20)").css({display:"inline-block"}),n.find("span").length||(t.find(".edit").hide(),n.html(l.noData)),So.lib.log(f,{type:"del-oftenSo"})}),n.on("click",".txt",function(){So.lib.log(f,{type:"oftenso"})})}function v(){if(So.lib.cookie.get(So.newsFlow.closeOffensoCookieMark)==1)return;e=$("#often_so"),t=e.find(".title"),n=e.find(".list"),c(),d()}var e,t,n,r=[],i=[],s=So.newsFlow.oftenSoData,o=50,u=So.lib.cookie.get("__huid")||"",a="//query.rec.360.cn/gasucs/query_rec",f=So.newsFlow.logMark,l={list:["<% for(var i = 0, len = data.length; i < len; i++){ %>","<span>",'   <a class="txt g-ellipsis" href="/s?ie=utf-8&q=<%= encodeURIComponent(So.lib.unescapeHTML(data[i].kw)) %>&src=so_isearch" target="_blank" title="<%= So.lib.escapeHTML(data[i].kw) %>"><%= data[i].icon ? "<img class=ico width=13px height=13px src=" + data[i].icon + ">" : "" %><%= So.lib.escapeHTML(data[i].kw) %></a>','   <a class="del g-icon" href="javascript:;" data-kw="<%= So.lib.escapeHTML(data[i].kw) %>" data-type="<%= data[i].type %>" title="\u5220\u9664"></a>',"</span>","<% } %>"].join(""),tools:['<span class="tools">','<span class="g-icon icon"></span>','<span class="finish">\u5b8c\u6210</span>','<span class="g-icon">','<div class="g-menu">','<i class="g-icon"></i>','<a href="javascript:;" class="edit">\u7f16\u8f91</a>','<a href="javascript:;" class="close">\u5173\u95ed</a>',"</div>","</span>","</span>"].join(""),noData:'<div class="no-data">\u60a8\u6682\u65f6\u6ca1\u6709\u5e38\u641c\u8bcd\u54e6~</div>'};return{init:v}}),define("js/home/card/real-news",[],function(){function h(){s.append('<span class="date">'+So.lib.formatTime2(new Date(t[0].updateTime.replace(/-/g,"/")))+"\u66f4\u65b0</span>"),t.length>f&&s.append('<a href="javascript:;" class="change"><span class="g-icon"></span>\u6362\u4e00\u6362</a>'),u=s.find(".change")}function p(){var i;u.on("click",function(){var e=u.find(".g-icon");a++,a==Math.ceil(t.length/f)&&(a=0),d(),e.addClass("re-circle"),clearTimeout(i),i=setTimeout(function(){e.removeClass("re-circle")},500)});var s=0,l;So.lib.observer.subscribe(r.infoFlowClickTab,function(){s=0}),e.on("scroll",function(){l=e.scrollTop(),l-s>2e3&&(u.trigger("click"),s=l)}),o.on("click","a",function(){So.lib.log(n,{type:"hotdot"})})}function d(){f=18,o.html(So.lib.template(c.list,{data:t,page:a,count:f}))}function v(){if(!t.length){o.html(c.noData);return}i=$("#real_time_news"),s=i.find(".title"),o=i.find(".list"),h(),d(),p()}var e=$(window),t=So.newsFlow.realTimeNewsData,n=So.newsFlow.logMark,r=So.newsFlow.observerEvent,i,s,o,u,a=0,f=9,l=Math.floor(t.length/18);t.length=l*18;var c={list:["<% for(var i = page * count, len = (page + 1) * count; i < len; i++){ %>","<% if(!data[i]){ break; } %>",'<%= i % 9 == 0 ? "<div class=wrap>" : "" %>','<div class="item">',"<% if(data[i].url){ %>",'<a class="g-ellipsis" href="<%= data[i].url.replace("http://www.so.com", "https://www.so.com") %>" target="_blank" title="<%= So.lib.escapeHTML(data[i].title) %>"><%= So.lib.escapeHTML(data[i].title) %></a>',"<% }else{ %>",'<a class="g-ellipsis" href="/s?ie=utf-8&q=<%= encodeURIComponent(So.lib.unescapeHTML(data[i].keyword)) %>&src=home_hot" target="_blank" title="<%= So.lib.escapeHTML(data[i].title) %>"><%= So.lib.escapeHTML(data[i].title) %></a>',"<% } %>","<% if(i < 3){ %>","<% if(data[i].rise == 1){ %>",'<span class="hot g-icon"></span>',"<% }else{ %>",'<span class="cold g-icon"></span>',"<% } %>","<% } %>","</div>",'<%= i % 9 == 8 ? "</div>" : "" %>',"<% } %>"].join(""),noData:'<div class="no-data">\u6682\u65e0\u6570\u636e~</div>'};return{init:v}}),define("js/home/card/fixed-top",[],function(){function c(){e.width()<1e3&&t.hasClass(s)?i.css({left:1e3-e.width()-e.scrollLeft()}):i.css({left:""})}function h(){var n=f.find(".top-tab a").first();t.hasClass(l)?n.css({marginLeft:a.offset().left-e.scrollLeft()+21}):n.css({marginLeft:""})}function p(){function m(){t.hasClass(l)&&!v&&(t.removeClass(l),h())}var i,a=0,p,v=!1;So.lib.observer.subscribe(n.infoFlowClickTab,function(){v=!0}),e.on("scroll",function(){p=e.scrollTop(),p>=r.offset().top-21?(t.hasClass(s)||(So.lib.observer.publish(n.searchboxFixed),t.addClass(s),u.fadeIn(500),$("#input").blur()),r.find(".ac_wrap").hide()):t.hasClass(s)&&(u.hide(),t.removeClass(s),So.lib.observer.publish(n.cancelSearchboxFixed)),c();if(!d())return;p>=f.offset().top-o.height()-20?(So.lib.observer.publish(n.infoFlowTabFixed,{isOk:!0}),a>p?t.hasClass(l)||(t.addClass(l),h(),f.find(".fixed").hide().slideDown(200)):m()):(So.lib.observer.publish(n.infoFlowTabFixed,{isOk:!1}),m()),v=!1,setTimeout(function(){a=p},20)}).on("resize",function(){clearTimeout(i),i=setTimeout(function(){c(),d()&&h()},10)})}function d(){return So.newsFlow.isReadyHotNews&&So.newsFlow.$cardContainer.hasClass("curr-"+So.newsFlow.hotNewsFlag)?(f=So.newsFlow.$newsFlow,a=So.newsFlow.$cardContainer,!0):!1}function v(){i.wrap('<div class="fixed" />').prepend('<div class="fixed-logo" />'),setTimeout(function(){$("#input").focus()},0),o=r.find(".fixed"),u=r.find(".fixed-logo"),r.css({height:r.height()}),c(),d()&&h(),p()}if(!So.lib.soLocalStorage)return;var e=$(window),t=$("body"),n=So.newsFlow.observerEvent,r=$("#bd_search"),i=r.find("form"),s="search-input-fixed",o,u,a,f,l="infoflow-tab-fixed";v()}),function(e,t,n,r){var i={$wrapper:null,$container:e("body"),topDist:0,fixedClass:null,preScrollTop:0},s={$elem:null,options:{},currTopDist:0,innerHeight:0,freezeDist:0,$window:e(t),init:function(t,n){var r=this;r.$elem=e(n),r.options=e.extend({},i,t),r.currTopDist=r.options.topDist,r.freezeDist=r.options.$wrapper.offset().top-r.options.topDist,r.position(),r.$window.on("scroll",function(){r.position()}).on("resize",function(){setTimeout(function(){r.position(r)},60)})},reposition:function(){var e=this,t=e.options.$container.height()+e.options.$container.offset().top,n=t-e.$window.scrollTop(),r=e.currTopDist+e.$elem.height()-n;e.$elem.height()>=e.innerHeight&&r>0&&(e.currTopDist-=r,e.position())},position:function(t){var r=t||this,i=r.$window.scrollTop(),s=r.$window.height(),o=r.options.$container.height(),u={position:"",left:"",top:""},a={height:""};if(r.$elem.outerHeight(!0)>=o){r.$elem.css(u),r.options.$wrapper.css(a),r.$elem.removeClass(r.options.fixedClass);return}r.innerHeight=r.$elem.height(),i<r.freezeDist&&(r.freezeDist=r.options.$wrapper.offset().top-r.options.topDist);if(i>r.freezeDist&&o>r.innerHeight){var f=o+r.options.$container.offset().top;if(r.options.topDist+r.innerHeight>s-(e(n).height()-f))if(r.options.preScrollTop>i)r.currTopDist<=r.options.topDist&&(r.currTopDist=r.currTopDist+(r.options.preScrollTop-i));else{var l=r.currTopDist+r.innerHeight-s;l>0&&(r.currTopDist=r.currTopDist-(i-r.options.preScrollTop));var c=r.currTopDist+r.innerHeight,h=Math.min(f-i,s);l=r.currTopDist+r.innerHeight-s,l<=0&&c!=h&&(r.currTopDist=h-r.innerHeight)}else r.options.preScrollTop>i&&(r.currTopDist=r.currTopDist+(r.options.preScrollTop-i));u={position:So.web.feedback?"":"fixed",left:r.options.$wrapper.offset().left-r.$window.scrollLeft(),top:Math.min(r.currTopDist,r.options.topDist)},r.options.fixedClass&&r.$elem.addClass(r.options.fixedClass),a={height:r.$elem.outerHeight(!0)}}else r.options.fixedClass&&r.$elem.removeClass(r.options.fixedClass),r.currTopDist=r.options.topDist;r.$elem.css(u),r.options.$wrapper.css(a),r.options.preScrollTop=i}};e.fn.freezeSidebar=function(e){if(So.lib.browser.isIE()&&So.lib.browser.isIE()<8)return;Object.create||(Object.create=function(){function e(){}return function(t){if(arguments.length!=1)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}());var t=Object.create(s);return t.init(e,this),{reposition:function(){t.reposition()}}}}(jQuery,window,document),define("js/jqueryplus/freeze-sidebar",function(){}),define("js/home/card/main",["js/home/card/news-flow","js/home/card/often-so","js/home/card/real-news","js/home/card/fixed-top","js/jqueryplus/freeze-sidebar"],function(e,t,n){function h(){o.append(So.lib.template(l,{cardSwitch:a})),u=$("#card_container"),So.newsFlow.$cardContainer=u,s.addClass("has-card"),a.hotNews&&(u.addClass("curr-"+r.hotNewsFlag),u.find(".hot-news").css({display:"inline-block"}),d())}function d(){if(p)return;p=!0,So.newsFlow.$newsFlow=$("#res_news_flow"),So.newsFlow.$realTimeNews=$("#real_time_news"),So.newsFlow.$oftenSo=$("#often_so"),So.newsFlow.$cardSide=$("#card_side"),e.init(),t.init(),n.init(),So.newsFlow.isReadyHotNews=!0,$("#card_side_wrap").freezeSidebar({topDist:85,$container:So.newsFlow.$cardContainer,$wrapper:So.newsFlow.$cardSide})}function v(){var e={mid:So.comm.md};So.lib.observer.subscribe(i.addHotNewsCard,function(){var t=new Date;t.setFullYear(t.getFullYear()+1),So.lib.cookie.set(So.newsFlow.hotNewsFlag,1,{expires:t}),So.lib.cookie.set(So.newsFlow.currNavCookieMark,So.newsFlow.hotNewsFlag),So.lib.log("homecard",$.extend({type:"add-hot-news-card"},e)),location.reload()}),So.lib.observer.subscribe(i.closeHotNewsCard,function(){So.newsFlow.closeMask({title:"\u786e\u8ba4\u9690\u85cf\u5361\u7247\uff1f",desc:"\u4eb2\uff0c\u9690\u85cf\u5361\u7247\u540e\uff0c\u60a8\u5c06\u65e0\u6cd5\u7b2c\u4e00\u65f6\u95f4\u4e86\u89e3\u70ed\u70b9\u5566~<br>\u9690\u85cf\u540e\uff0c\u53ef\u5728\u201c\u8bbe\u7f6e\u201d\u4e2d\u5f00\u542f\u3002",sureTxt:"\u786e\u8ba4\u9690\u85cf",callback:function(){var e=new Date;e.setFullYear(e.getFullYear()+1),So.lib.cookie.set(So.newsFlow.hotNewsFlag,0,{expires:e}),So.lib.log(r.logMark,{type:"sure-close-card"})}}),So.lib.log("homecard",$.extend({type:"close-hot-news-card"},e))})}function m(){u.on("click",".card-close",function(e){So.lib.observer.publish(i.closeHotNewsCard)})}function g(){v();if(So.newsFlow.hotNewsStatus==21&&So.lib.cookie.get(So.newsFlow.hotNewsFlag)=="1"||So.newsFlow.hotNewsStatus!=21){if(So.lib.browser.isIE()&&So.lib.browser.isIE()<9||!a.hotNews)return;h(),m()}}if(!So.lib.soLocalStorage)return;var r=So.newsFlow,i=So.newsFlow.observerEvent,s=$("body"),o=$("#main"),u,a={hotNews:~$.inArray(So.newsFlow.hotNewsStatus,[0,20])?!1:!0},f='<div class="card-loading"><p><span class="ico"></span>\u52a0\u8f7d\u4e2d...</p></div>',l=['<div id="card_container">','<div class="card-top-line"></div>','<span class="card-close g-icon"></span>','<div class="hot-news-card clearfix">','<div id="res_news_flow" class="limitation"><ul></ul>'+f+'<a href="javascript:;" class="bottom-arrow g-icon"><i class="g-icon"></i></a></div>','<div id="card_side">','<div id="card_side_wrap">',"<% if(So.lib.cookie.get(So.newsFlow.closeOffensoCookieMark) != 1){ %>",'<div id="often_so">','<p class="title">\u5e38\u7528\u641c\u7d22</p>','<div class="list">'+f+"</div>","</div>","<% } %>",'<div id="real_time_news">','<p class="title">\u5b9e\u65f6\u70ed\u70b9</p>','<div class="list">'+f+"</div>",'<a href="//news.so.com/hotnews?src=hotnews" target="_blank" class="more">\u67e5\u770b\u66f4\u591a>></a>',"</div>","</div>","</div>","</div>","</div>"].join(""),c=['<div id="close-card-mask">','<div class="bubble">','<a href="javascript:;" class="close"></a>',"<h3><%= title %></h3>","<p><%= desc %></p>",'<a href="javascript:;" class="sure-del"><%= sureTxt %></a>','<a href="javascript:;" class="cancel">\u53d6\u6d88</a>',"</div>","</div>"].join(""),p=!1;So.newsFlow.closeMask=function(e){s.append(So.lib.template(c,e)),$("#close-card-mask").on("click",function(t){var n=$(this),r=$(t.target);r.hasClass("close")||r.hasClass("cancel")?n.remove():r.hasClass("sure-del")?(e.callback(),window.location.reload()):!r.is(".bubble")&&!r.closest(".bubble").length&&n.remove()})},g()});