define("indexnew:component/gamebox/like/index.js",["global","module","exports","require","indexnew:static/js/jquery.js","indexnew:static/js/config.js","indexnew:static/js/format.js","indexnew:static/js/browser.js","indexnew:component/gamebox/like/template.js","indexnew:component/gamebox/common/index.js","indexnew:component/gamebox/common/template.js"],function(e,t,a,i,n,g,m,l,s,o,r){var c=n,p=g,d=m,u=p.get("userinfo")&&p.get("userinfo").islanding,x=l,h=s,f=o,k=r,L=c("#feed_news_wrap"),v={likeUrl:"api/gamelike"},b={page:1,total:0,gameLikeText:"换一换",isFlash:x.flashCheck?1:2,perPage:4,gameData:{},getLikeData:function(e){var t={isFlash:this.isFlash,pagesize:this.perPage,pageno:this.page,source:"rightSource"===e?1:0,t:+new Date};return c.getJSON(v.likeUrl,t)},renderHotBtnTpl:function(e,t,a){return d(k.hotBtnTpl,{url:e,text:t,extralStyle:a})},renderLikeTpl:function(e){var t=f.renderHeaderTpl("game"),a="";this.gameData=e,c.each(e.gamelist||[],function(e,t){t&&(a+=d(h.gameItemTpl,{index:e,url:t.jump_url,imgUrl:t.icon,imgDesc:f.limitLen(t.type,6),name:f.limitLen(t.name,8),desc:f.limitLen(t.desc,11),tags:f.limitLen(t.play_count,11)}))}),this.total=e.total;var i="";return e.total>4&&(i=this.renderHotBtnTpl("",this.gameLikeText,"gameBox-item-like")),{gameHeader:t,gameList:a,gameBottom:i}},geBoxData:function(e,t,a){t.t=+new Date,c.getJSON(e,t,function(e){e&&e.result&&a&&a(e.result)})},getPageLikeData:function(e,t){this.geBoxData(v.likeUrl,e,t)},bindEvent:function(){var e=this,t=c("#gameBox",L),a=c(".game",this.$gameBox),i=c(".game-item-left",a),n=c(".game-item-content-title",a),g=c(".gameBox-item-like",t);g.click(function(t){t&&t.preventDefault();var g={isFlash:e.isFlash,pagesize:e.perPage,source:0},m=Math.ceil(e.total/e.perPage);++e.page>m&&(e.page=1),g.pageno=e.page,e.getPageLikeData(g,function(t){var g="";e.gameData=t,c.each(t.gamelist,function(t,a){a&&(g+=d(h.gameItemTpl,{index:(e.page-1)*e.perPage+t,url:a.jump_url,imgUrl:a.icon,imgDesc:f.limitLen(a.type,6),name:f.limitLen(a.name,8),desc:f.limitLen(a.desc,11),tags:f.limitLen(a.play_count,11)}))}),a.empty().prepend(g),u||(i=c(".game-item-left",a),n=c(".game-item-content-title",a),f.bindSaveEvent(i,t.gamelist,f.changeLikeKey.bind(f)),f.bindSaveEvent(n,t.gamelist,f.changeLikeKey.bind(f)))})}),u||(f.bindSaveEvent(i,e.gameData.gamelist,f.changeLikeKey.bind(f)),f.bindSaveEvent(n,e.gameData.gamelist,f.changeLikeKey.bind(f)))}};t.exports=b});