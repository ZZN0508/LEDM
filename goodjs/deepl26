"use strict";(self.webpackChunk_deepl_gatsby=self.webpackChunk_deepl_gatsby||[]).push([[185],{5210:function(e,t,n){var r=n(61606),a=n(98808);r.Z.defineType("/translator/common/detectTargetTextModifications",["/translator/smartEditing/updateTargetSentencesFromText"],e=>{let t=(0,a.f)();return e.onUpdateTargetSentencesChanged.push(function(e){let{remainingText:n,remainingTargetSentences:r}=e;(r.length>1||0===r.length&&""!==n)&&t({remainingText:n,remainingTargetSentences:r})}),{onDetectedTargetTextModifications:t}})},22867:function(e,t,n){var r=n(66442),a=n(61606),o=n(98808);a.Z.defineType("/translator/common/popups",["/translator/core/updateSourceSentences"],e=>{let t=(0,o.f)(),n=()=>{t()};return r.N0&&e.onSourceSentencesChanged.push(n),{onHide:t}})},66519:function(e,t,n){var r=n(61606),a=n(30171),o=n(98808);r.Z.defineType("/translator/core/selectedLanguages",["/translator/core/languageManagement"],e=>{let t=e.getSelectedTargetLangSettings(),n=e.getSelectedSourceLang(),r=(0,a.S3)({language:n,variant:""}),s=(0,a.S3)({language:t.lang,variant:t.variant}),i=(0,o.f)(),l=(0,o.f)();e.onLangChanged.push(e=>{r({language:e,variant:""})}),e.onSelectedTargetLangSettingsChanged.push(e=>{s({language:e.lang,variant:e.variant})}),(0,a.S1)([r],e=>i(e)),(0,a.S1)([s],e=>l(e));let u=(t,n)=>{e.setUserSelectedSourceLang(t,n)};return{sourceLanguage:r,targetLanguage:s,onSourceLanguageChanged:i,onTargetLanguageChanged:l,setPredefinedSelectedSourceLanguage:u}})},54693:function(e,t,n){var r=n(61606),a=n(69748),o=n(22496),s=n(98808),i=n(58462);r.Z.defineType("/translator/smartEditing/detectTargetSentenceClicks",["/translator/core/domElements","/translator/core/languageManagement","/translator/smartEditing/updateTargetSentencesFromText"],(e,t,n)=>{let{targetEdit:r,getTargetEditCursorOffset:l,getTargetEditCursorOffsetEnd:u}=e,{getActiveLangContext:c}=t,g=(0,s.f)(),d=(0,s.f)();return r.addEventListener("click",e=>{let{detail:t,target:s}=e;if(!(r instanceof HTMLTextAreaElement)&&s===r.dTextarea._rootDomNode){d();return}!function(e){let t=c(),s=r.value;n.ensureTargetSentenceAreUpToDate();let f=l(),p=u(),T=s.substring(f,p).trim();if(-1!==T.indexOf(" ")){(o.ZP.isWin||o.ZP.isMac)&&!o.ZP.isMobilePhone&&g({langContext:t,tSentenceWordPos:void 0,tSentenceCursorPos:void 0,trigger:"click",clickNumber:e});return}let m=(0,i.PY)(s,f),x=(0,a.C3)(t,m),C=(0,a.C3)(t,f);if(x){if(0===s.substring(f-1,p+1).trim().length&&x.sentence.getText().trim().length){d();return}let e=(0,i.DO)(r,m);if(e.top<=0&&e.left<=0&&m>0)return}g({langContext:t,tSentenceWordPos:null!=x?x:void 0,tSentenceCursorPos:null!=C?C:void 0,trigger:"click",clickNumber:e})}(t)}),{onTargetSentenceClicked:g,onEmptyAreaClicked:d,triggerTargetSentenceClicked:e=>{g(e)}}})},724:function(e,t,n){n.d(t,{Oc:function(){return o},TL:function(){return l},XJ:function(){return i},pf:function(){return s}});var r=n(10878),a=n(46237);function o(e,t,n){void 0===n&&(n=!1);let r=[];n&&console.log("existingPostfix:",e," got entries: ",t);let a=-1,o=-1,s=0;return t.forEach(t=>{let{postfix:n}=t;if(!n.trim().length)return;let i=e.startsWith(n)?n.length:0;i>o&&i>0&&(a=s,o=i),r.push(t),s+=1}),o>=0&&a>=0&&r.splice(a,1),r}function s(e,t,n){return void 0===n&&(n=!1),!!(t<e.length&&(e.charAt(t).match(r.K$)||n))}function i(e,t){let n=e.getTranslation();if(!n)throw new a.x("smartTargetEditing.helpers no translation");let[r,o]=e.getNormalizedTextAndOffset(t),s=r.substring(0,o),i=s.length,l=r.substr(o);return{normalizedText:r,normalizedSentenceCursorOffset:o,prefix:s,prefixLength:i,existingPostfix:l}}function l(e,t){let n=t.prefix.trim(),r=e.getLastFullTrimmedText(),a=n.substr(n.length-5)===r.substr(r.length-5);return 0===t.existingPostfix.trim().length&&r.length>3&&!!a}},69667:function(e,t,n){var r=n(30171),a=n(61606),o=n(98808);a.Z.defineType("/translator/smartEditing/smartTargetEditing",["/translator/core/domElements","webTranslatorCore","/translator/core/networkStatus","/translator/smartEditing/smartTargetEditingUpdateTarget","/translator/smartEditing/smartTargetEditingDetector"],(e,t,n,a,s)=>{let i=(0,o.f)(),l=(0,o.f)(),u=(0,o.f)(),c=(0,o.f)(),g=(0,o.f)(),d=(0,o.f)(),f=(0,o.f)(),p=(0,o.f)(),T=(0,o.f)(),m=(0,r.S3)(void 0),x=(0,r.G7)([m],e=>void 0!==e),C=(0,r.S3)("source");function h(){x()&&(m(void 0),f())}async function S(r,o,s,i,g){let{targetEdit:d}=e,f="autocompletion"===r,p=i.prefix||"",T=i.displayPostfix,m=t.getActiveLangContext();if(c({index:g,isAutoCompletion:f}),h(),!o)return;let x=o.getNormalizedText();try{await a.applyAlternativeOrAutocomplete(m,o,p,i.postfix,!f);let e=s+i.postfix.length;d.setSelectionRange(e,e),f?u({targetTextBefore:x,targetTextAfter:o.getNormalizedText()}):l({sourceSentence:o.getSourceSentence(),targetPrefix:p,targetTextBefore:x,targetTextAfter:o.getNormalizedText(),targetSentence:o,chosenAlternative:T})}catch(e){console.trace(e),n.onRequestFailed("fillUp",e instanceof Error?e:Error(String(e)))}}return s.onStopSmartEditing.push(()=>{h()}),{onTargetSentenceChangedByAlternative:l,onTargetSentenceChangedByAutocompletion:u,onSuggestionItemActive:p,onSuggestionItemInactive:T,onUserSelectsAlternative:c,onUserEditPerformed:a.onUserEditPerformed,onTextRepaired:i,onTargetPopupOpened:g,onTargetPopupOpening:d,onTargetPopupClosed:f,isPopupOpen:x,targetPopupInfo:m,closePopup:h,openPopup:function(e){m(e),d(e),e.data.isComplete&&g(e)},updatePopupPrimaryData:function(e){let t=m();if(!t)return;let n={...t,data:e};m(n),n.data.isComplete&&g(n)},updatePopupSecondaryData:function(e){let t=m();if(!t)return;let n={...t,dataSecondary:e};m(n)},updatePopupAnchor:function(e,t){let n=m();if(!n)return;let r={...n,globalCursor:e,sentenceCursor:t};m(r)},applyAlternative:S,sentenceAlternativeMode:C}})},52910:function(e,t,n){var r=n(61606),a=n(30171),o=n(10878),s=n(69748),i=n(58425),l=n(724),u=n(46237);r.Z.defineType("/translator/smartEditing/smartTargetEditingAlternatives",["globalState","webTranslatorCore","/translator/smartEditing/smartTargetEditing","/translator/smartEditing/smartTargetEditingCommunication","/translator/smartEditing/smartTargetEditingDetector","/translator/core/requestHandling","/translator/core/config","/translator/core/languageManagement"],(e,t,n,r,c,g,d,f)=>{let p=!d.get("isMobile"),T=d.get("isWriteMode"),m="",x="";async function C(e,a,o){let i="[requestAlternativesForPopup]";if(void 0===a)throw new u.x(`${i} targetSentence is undefined`);if(!t.isActiveLangContext(e))throw new u.x(`${i} state is not active`);let c=(0,l.XJ)(a,o);if((0,l.TL)(a,c))return[];let g=a.getSourceSentence(),d=g&&"source"===n.sentenceAlternativeMode()?(0,s.rU)(g):(0,s.Ci)(a,f.getActiveLangContext().getTargetSentences()),p=a.getTranslation();if(!p)throw new u.x(`${i} no translation`);return r.fetchAlternatives(e,d,p,c,a.getRephraseVariant())}function h(t){return t.isSmartTargetEditingAvailable()&&!e[o.AL]()}function S(e,r){void 0===r&&(r=!0);let{langContext:a,tSentenceWordPos:o,tSentenceCursorPos:s,clickNumber:i}=e,u=!h(a),c=!o&&t.isActiveLangContext(a);if(u||c)return!1;let g=a.areWordsWrittenContinuously()?s:o;if(!g)return!1;let d=n.isPopupOpen(),f=!p&&d,T=g.sentence,C=g.sentenceCursorOffset,S=!(0,l.pf)(T.getText(),C,a.areWordsWrittenContinuously()),v=!1,E="",y="";if(p){var _;let e=T.getTranslation();E=null!==(_=null==e?void 0:e.getSourceText())&&void 0!==_?_:"";let[t,n]=T.getNormalizedTextAndOffset(C);v=x===(y=t.substr(0,n))&&m===E}return(void 0===i||!(i>=3)&&(!f||1!==i))&&((f||S||v&&r)&&2!==i?(r&&(x="",m=""),!1):!!t.isActiveLangContext(a)&&(p&&r&&(x=y,m=E),!0))}return!function(){let e={latestRequestContextId:(0,a.S3)(-1),_tDelay:null};n.onTargetPopupClosed.push(()=>{e.latestRequestContextId(-1),x="",m=""}),c.onAlternatives.push(t=>{if(!S(t)){n.closePopup();return}let{langContext:r,tSentenceWordPos:a,tSentenceCursorPos:o,trigger:s}=t,l=r.areWordsWrittenContinuously()?o:a;if(!l)return;let u=l.sentence,c=l.sentenceCursorOffset,d={targetSentence:u,globalCursor:l.cursorOffset,sentenceCursor:c,trigger:s,data:{type:"alternatives",isComplete:!1,entries:[],error:!1},dataSecondary:void 0,targetLang:f.getSelectedTargetLangSettings()},p=g.startRequestContext(r,i.Xk.TYPE__SMART_EDIT_REQUEST);e.latestRequestContextId(p._id),n.closePopup(),e._tDelay=setTimeout(()=>{n.openPopup(d)},50);let m=C(r,d.targetSentence,d.sentenceCursor);m.then(t=>{e._tDelay&&(clearTimeout(e._tDelay),e._tDelay=null),p.stop(),p._id,e.latestRequestContextId(),0!==t.length||T?function(e,t,r,a){if(!e)return;let o=e.sentence,s=e.sentenceCursorOffset,i={targetSentence:o,globalCursor:e.cursorOffset,sentenceCursor:s,trigger:t,data:{type:"alternatives",isComplete:!0,entries:a||[],error:!1},dataSecondary:void 0,targetLang:f.getSelectedTargetLangSettings()},l=!1;if(r){var u,c;let e=(null===(u=a[0])||void 0===u?void 0:null===(c=u.prefix)||void 0===c?void 0:c.length)||0,t=i.globalCursor-(i.sentenceCursor-e);t!==i.globalCursor&&(i.globalCursor=t,i.sentenceCursor=e,l=!0)}n.isPopupOpen()?(n.updatePopupPrimaryData(i.data),l&&n.updatePopupAnchor(i.globalCursor,i.sentenceCursor)):n.openPopup(i)}(l,s,r.areWordsWrittenContinuously(),t):n.isPopupOpen()&&n.closePopup()}).catch(e=>{p.stop(),n.closePopup(),console.warn("================","\n",e)})})}(),{shouldOpenPopup:S,isSmartTargetEditingSupported:h}})},87543:function(e,t,n){var r=n(61606),a=n(58462),o=n(69748),s=n(10878);r.Z.defineType("/translator/smartEditing/smartTargetEditingAutocompletion",["globalState","/translator/core/domElements","/translator/core/languageManagement","webTranslatorCore","/translator/core/textareas","/translator/smartEditing/smartTargetEditing","/translator/smartEditing/smartTargetEditingCommunication","/translator/smartEditing/updateTargetSentencesFromText"],(e,t,n,r,i,l,u,c)=>{let{getTargetEditCursorOffset:g}=t,d=0;async function f(){let e=r.getActiveLangContext();if(!e.isSmartTargetEditingAvailable()||!e.isAutocompletionAvailable())return;let t=g(),i=(0,o.C3)(e,t);if(!i)return;let c=i.sentence,f=i.sentenceCursorOffset,[p,T]=c.getNormalizedTextAndOffset(f),m=p.substr(0,T),x=c.getTranslation();if(!x||c.getLastFullTrimmedText()&&m.startsWith(c.getLastFullTrimmedText().trim()))return;d+=1;let C=d,h=await u.fetchAutocompletionData(e,c,x,m);if(h&&!(C<d)&&(i=(0,o.C3)(e,t))&&i.sentence===c){if(!i)return;let t="",r=c.getText(),o=i.sentenceCursorOffset;if(o>0)for(o-=1;o>=0&&!r.charAt(o).match(s.hJ);)t=r.charAt(o)+t,o-=1,i.sentenceCursorOffset-=1,i.cursorOffset-=1;let{translations:u}=h,g=((u||[])[0]||[]).beams||[],d=m.trimStart().length,f=[];if(g.length){let n=g[0],r=(0,a.x8)(n),o=r.substr(d),s=t+o;if(""!==o&&s.trim().length){let n=m.substr(0,m.length-t.length),a={displayPostfix:s,postfix:s,cursorOffset:e.areWordsWrittenContinuously()?n.length:0,prefix:n};f.push(a);let o=[m,r,h];c.cachedAutocompletionRequests.some(e=>e[0]===o[0]&&e[1]===o[1])||c.cachedAutocompletionRequests.push(o)}}if(f.length&&f.length>0){let e={targetSentence:c,sentenceCursor:i.sentenceCursorOffset,globalCursor:i.cursorOffset,trigger:"autocompletion",data:{type:"autocompletion",isComplete:!0,entries:f,error:!1},dataSecondary:void 0,targetLang:n.getSelectedTargetLangSettings()};l.openPopup(e)}else l.closePopup()}}t.onTargetEditKeyUp.push(t=>{let{event:n,info:r}=t;if(n.keyCode===a.nG);else if(n.keyCode===a.Fc||n.keyCode===a.rC||n.keyCode===a.FD||n.keyCode===a.Dx||n.keyCode===a.D$||n.keyCode===a.$g);else if(n.keyCode>=15&&n.keyCode<32||224===n.keyCode||n.keyCode===a.iP||n.keyCode===a.$v||n.keyCode===a.ux||n.keyCode===a.V7);else{var o;c.ensureTargetSentenceAreUpToDate(),e[s.AL]()||n.keyCode===a.Im||n.keyCode===a.yM||n.keyCode===a.WF||n.keyCode===a.gK||(n.keyCode===a.kV||n.keyCode===a.sQ)&&" ">i.getTargetText().charAt(g())||null!==(o=r.keyDownEvent)&&void 0!==o&&o.ctrlKey||n.ctrlKey||r.keyDownEvent&&f()}})})},61784:function(e,t,n){var r=n(98808),a=n(77396),o=n(67974),s=n(61606),i=n(41941),l=n(46237),u=n(69748),c=n(58425),g=n(724),d=n(58462),f=n(30171);s.Z.defineType("/translator/smartEditing/smartTargetEditingCommunication",["webTranslatorCore","/translator/core/config","/translator/core/translationBackend","/translator/core/networkStatus","/translator/core/requestHandling"],(e,t,n,s,p)=>{let T=(0,r.f)(),m=t.get("disableCaches"),x=t.get("isWriteMode"),C=(0,r.f)(),h=(0,r.f)();function S(e,t,n){let r={kind:e,sentences:[{text:t,id:0,prefix:"",partial_translation:n}]};return T(r),r}return{fetchAlternatives:function(e,t,r,a,o){let{existingPostfix:l}=a;if(!m){let t=r.getCachedLocalAlternativeEntries(a.prefix);if(t){var u;if(e.areWordsWrittenContinuously()){let e=t[0].cursorOffset;l=a.normalizedText.substring(e)}return u=(0,g.Oc)(l,t),new Promise(e=>{setTimeout(()=>e(u),0)})}}let c=S(i.Z.JOB_KIND__ALTERNATIVES_AT_POSITION,r.getSourceText(),a.prefix);if(x&&(c.rephrase_variant=o,c.rephrase_variant||(c.write_variant_requests=["main"]),c.rephrase_variant),e.areWordsWrittenContinuously()&&(delete c.sentences[0].partial_translation,c.sentences[0].complete_translation=a.normalizedText,c.sentences[0].cursor_offset=a.normalizedSentenceCursorOffset,a.normalizedText.length-1<a.normalizedSentenceCursorOffset&&(c.sentences[0].cursor_offset=a.normalizedText.length-1),c.sentences[0].cursor_offset<0))return Promise.resolve([]);e.isContextEnabled()&&t&&(c.raw_en_context_before=t.prefix,c.raw_en_context_after=t.postfix);let f=e.createJobSettings();return"richtext"===f.commonJobParams.textType&&(f.commonJobParams.textType="plaintext"),n.sendTranslationJobs([c],f,!1).then(t=>{let{translations:n}=t,o=((n||[])[0]||[]).beams||[],s=[];o.forEach(t=>{let n=t.sentences&&t.sentences[0]&&t.sentences[0].prefix_offset||0,r=a.prefixLength,o=a.prefix;e.areWordsWrittenContinuously()&&(a.prefix.trim(),r=n,o=a.prefix.substring(0,r).trim(),l=a.normalizedText.substring(n));let i=(0,d.x8)(t);if(!i)return;let u=null==i?void 0:i.substring(0,r);if(o.trim()!==(null==u?void 0:u.trim())){console.warn("[fetchAlternatives]",`req.Prefix does not match
              received [${u}]
              expected [${o}]`);return}let c=null==i?void 0:i.substring(r),g={displayPostfix:`${c} ...`,postfix:c,prefix:o,rephraseVariant:t.rephrase_variant,cursorOffset:n};s.push(g)}),r.setCachedLocalAlternativeEntries(a.prefix,s);let i=(0,g.Oc)(l,s);return i},e=>{throw s.onRequestFailed("alternatives",e),e})},fetchAutocompletionData:async function(t,r,g,d){let f=(0,a.$)();try{let a=await (0,o.AV)(`fetchAutocompletionData_${t.getId()}`,async()=>{var a,o;let s;if(!e.isActiveLangContext(t))throw new l.x("[autocompletion] lang context not available");let T=p.startRequestContext(t,c.Xk.TYPE__SMART_EDIT_REQUEST);f.push(()=>T.stop());let x=r.cachedAutocompletionRequests.slice(0),C=null===(a=r.getTranslation())||void 0===a?void 0:a.getTranslationResult();if(C){let e={beams:[{sentences:[{text:C.beams[0].sentences[0].text}]}]};x.push(["",null===(o=r.getTranslation())||void 0===o?void 0:o.getTargetText(),{translations:e}])}if(x.some(e=>{let[t,n,r]=e;return!!(d.startsWith(t)&&n.startsWith(d))&&(s=r,!0)}),!m&&s)return s;let h=S(i.Z.JOB_KIND__AUTOCOMPLETION,g.getSourceText(),d);if(h.preferred_num_beams=1,t.isContextEnabled()){let e=r.getSourceSentence();if(e){let t=(0,u.rU)(e);h.raw_en_context_before=t.prefix,h.raw_en_context_after=t.postfix}}return n.sendTranslationJobs([h],t.createJobSettings(),!1)},1e3);return f(),a}catch(e){f(),e===o.AV.FAILURE_REASON__CANCELED||e===o.AV.FAILURE_REASON__TIMEOUT||s.onRequestFailed("autocompletion",e instanceof Error?e:Error(String(e)));return}},fetchFillUpTargetSentence:async function(e,t,r,a){let o=null!=a?a:t.getNormalizedTextAndOffset(0)[0],s=(t.getParts(),t.getTranslation());if(!s)return r?t.getHtml().getOuter():t.getText();let l=(0,f.S3)(r?s.getSourceHtml():s.getSourceText()),g=(0,f.S3)(o);C(t,l,g);let T=S(i.Z.JOB_KIND__DEFAULT,l(),g());if(T.preferred_num_beams=1,e.isContextEnabled()){let e=t.getSourceSentence();if(e){let t=(0,u.rU)(e);T.raw_en_context_before=t.prefix,T.raw_en_context_after=t.postfix}}x&&(T.rephrase_variant=t.getRephraseVariant(),T.rephrase_variant||(T.write_variant_requests=["main"]));let m=p.startRequestContext(e,c.Xk.TYPE__SMART_EDIT_REQUEST);try{let a=await n.sendTranslationJobs([T],e.createJobSettings(),!0);m.stop();let o=a.translations[0].beams,s=(0,f.S3)();if(o.length){let e=(0,d.x8)(o[0]);s(e)}else console.log("request_fillUpTargetSentence: No Result found"),s(r?t.getHtml().getInnerContent():t.getInnerText());return h(t,s),s()}catch(e){throw m.stop(),e}},fetchWriteSentenceAlternatives:async function(e,t){let r=S(i.Z.JOB_KIND__DEFAULT,t.text,"");r.write_variant_requests=["main","variants"];let a=e.createJobSettings();e.isContextEnabled()&&(r.raw_en_context_before=t.prefix,r.raw_en_context_after=t.postfix);try{var o,l;let e=await n.sendTranslationJobs([r],a,!1);if((null!==(o=null==e?void 0:null===(l=e.translations)||void 0===l?void 0:l.length)&&void 0!==o?o:0)===0){console.warn("invalid response when fetching sentence alternatives");return}let t=e.translations[0],s=t.beams.map(e=>{let t=e.sentences[0];return{text:t.text,html:"",rephraseVariant:e.rephrase_variant}});return s}catch(t){let e=t instanceof Error?t:Error(String(t));throw s.onRequestFailed("alternatives",e),e}},onJobPrepared:T,onBeforeFillupRequest:C,onAfterFillupRequest:h}})},82961:function(e,t,n){var r=n(61606),a=n(98808),o=n(10878),s=n(58462),i=n(67974),l=n(69748);r.Z.defineType("/translator/smartEditing/smartTargetEditingDetector",["globalState","/translator/core/domElements","webTranslatorCore","/translator/core/textareas","/translator/smartEditing/detectTargetSentenceClicks","/translator/core/translateSourceSentences","/translator/core/networkStatus","/translator/smartEditing/updateTargetSentencesFromText"],(e,t,n,r,u,c,g,d)=>{let f=(0,a.f)(),p=(0,a.f)(),T=(0,a.f)(),{getTargetEditCursorOffset:m,targetEdit:x,sourceEdit:C,targetEditInnerContainer:h}=t;return C.addEventListener("focus",()=>T()),[h,x].forEach(e=>null==e?void 0:e.addEventListener("scroll",()=>T())),u.onEmptyAreaClicked.push(()=>T()),g.onRequestFailed.push((e,t)=>T()),c.onTargetSentencesHaveChanged.push(e=>T()),u.onTargetSentenceClicked.push(e=>{let{langContext:t,tSentenceWordPos:n,tSentenceCursorPos:r,trigger:a,clickNumber:o}=e;f({langContext:t,tSentenceWordPos:n,tSentenceCursorPos:r,trigger:a,clickNumber:o})}),t.onTargetEditKeyUp.push(a=>{var u,c;let{event:g,info:C}=a;function h(){let e=n.getActiveLangContext(),t=r.getTargetText();d.ensureTargetSentenceAreUpToDate();let a=m(),o=(0,s.PY)(t,a),i=(0,l.C3)(e,o),u=(0,l.C3)(e,a);f({langContext:e,tSentenceWordPos:null!=i?i:void 0,tSentenceCursorPos:null!=u?u:void 0,trigger:"key"})}!(null!==(u=x.dTextarea)&&void 0!==u&&u.isCompositionInProgress())&&(g.keyCode===s.nG?h():g.keyCode===s.Fc||g.keyCode===s.rC||g.keyCode===s.FD||g.keyCode===s.Dx||g.keyCode===s.D$||g.keyCode===s.$g?(T(),(0,i.wx)("triggerOnSuggestions",()=>{(function(){if(t.isSelectionInTargetTextarea()){let e=m(),t=r.getTargetText().charAt(e-1),n=r.getTargetText().charAt(e);if((0===e||"\n"===t||" "===t)&&" "!==n&&"\n"!==n)return!0}return!1})()&&h()},300)):g.keyCode>=15&&g.keyCode<32||224===g.keyCode||g.keyCode===s.iP||g.keyCode===s.$v||g.keyCode===s.ux||g.keyCode===s.V7||(d.ensureTargetSentenceAreUpToDate(),e[o.AL]()||g.keyCode===s.Im||g.keyCode===s.yM||g.keyCode===s.WF||g.keyCode===s.gK||(g.keyCode===s.kV||g.keyCode===s.sQ)&&" ">r.getTargetText().charAt(m())||null!==(c=C.keyDownEvent)&&void 0!==c&&c.ctrlKey||g.ctrlKey||C.keyDownEvent&&p()))}),{onAlternatives:f,onAutocompletion:p,onStopSmartEditing:T}})},44821:function(e,t,n){var r=n(61606),a=n(98808),o=n(94982),s=n(67977),i=n(69496);let l="smartEditing/fill-up-request";r.Z.defineType("/translator/smartEditing/smartTargetEditingUpdateTarget",["/translator/core/languageManagement","/translator/core/textareas","/translator/smartEditing/smartTargetEditingCommunication","/translator/core/config"],(e,t,n,r)=>{let u=(0,a.f)(),c=t.getTargetDTextarea(),g=r.get("isRtfEnabled");function d(n){if(e.isActiveLangContext(n)){if(g){let e=o.Z.getJoinedHtml(n.targetSentences);t.updateTargetHtml(e)}else{let e=o.Z.getJoinedText(n.targetSentences);t.updateTargetText(e)}}}return{applyAlternativeOrAutocomplete:async function(e,t,r,a,o){let f=t.getText().substr(r.length).match(/\s*$/)[0],p=t.getWhitespacesBefore();if(s.W4.countStats("e",e=>e+1,0),o){f||(f=" ",t.postfixWhitespaceIsTemporary=!0),t.updateRawText(p+r+a+f,!1,!0),g&&t.updateHtmlFromText(),d(e),null==c||c.lockUndoStack(l,5e3),t.updateRawText(r+a,!1,!0),g&&t.updateHtmlFromText(),u({state:e,targetSentence:t,type:"EDIT_TYPE__SELECT_ALTERNATIVE_FIRST_STEP"});let o=await n.fetchFillUpTargetSentence(e,t,g),s=f;if(t.postfixWhitespaceIsTemporary&&(s="",t.postfixWhitespaceIsTemporary=!1),g){let e=(0,i.Sl)(o);t.updateRawText(p+e+s,!0,!0),t.getHtml().updateOuter((0,i.p$)(p),o,(0,i.p$)(s))}else t.updateRawText(p+o+s,!0,!0);d(e),null==c||c.unlockUndoStack(l),u({state:e,targetSentence:t,type:"EDIT_TYPE__SELECT_ALTERNATIVE"})}else{let n=r+a+f;t.updateRawText(n,!0,!0),g&&t.updateHtmlFromText(),d(e),u({state:e,targetSentence:t,type:"EDIT_TYPE__AUTOCOMPLETION"})}},onUserEditPerformed:u,updateTargetEditFromState:d}})},46237:function(e,t,n){n.d(t,{x:function(){return a}});var r=n(93219);let a=function(e){function t(t){var n;return(n=e.call(this)||this).msg=void 0,n.msg=t,n}return(0,r.Z)(t,e),t}((0,n(90434).Z)(Error))},36192:function(e,t,n){var r=n(61606),a=n(98808);n(56819);var o=n(69748);r.Z.defineType("/translator/core/observeSentenceSelection",["/translator/core/domElements","webTranslatorCore","/translator/core/config","/translator/smartEditing/updateTargetSentencesFromText"],(e,t,n,r)=>{let s=(0,a.f)(),i=(0,a.f)(),l="NO_SELECTION",u=n.get("isWriteMode"),{getSourceEditCursorOffset:c,getSourceEditCursorOffsetEnd:g,getTargetEditCursorOffset:d,getTargetEditCursorOffsetEnd:f,sourceEdit:p,targetEdit:T}=e;function m(e,t){let n=t,r=e.sourceSentences;for(let e=0;e<r.length;++e){let a=r[e],o=a.getText(),s=o.length;if(n<s||n===s&&(0===s||e===r.length-1||!o.endsWith("\n")))return{sentence:a,sentenceCursorOffset:n,cursorOffset:t,sentenceIndex:e};n-=s}return null}function x(){let e,n;let a=t.getActiveLangContext();r.ensureTargetSentenceAreUpToDate();let i=d(),u=o.ZP.getSentencePosForTargetCursorOffset(a,i);if(u){n=`${u.sentenceIndex}_${u.sentenceCursorOffset}`;let t=f();i!==t&&(e=o.ZP.getSentencePosForTargetCursorOffset(a,t))&&(n+=`:${e.sentenceIndex}_${e.sentenceCursorOffset}`)}else n="NO_SELECTION";l!==n&&(l=n,s(u||null,e||null))}let C="NO_SELECTION";function h(){let e,n;let r=t.getActiveLangContext(),a=c(),o=m(r,a);if(o){n=`${o.sentenceIndex}_${o.sentenceCursorOffset}`;let t=g();a!==t&&(e=m(r,t))&&(n+=`:${e.sentenceIndex}_${e.sentenceCursorOffset}`)}else n="NO_SELECTION";C!==n&&(C=n,i(o||null,e||null))}return document.addEventListener("selectionchange",()=>{let t=e.isSelectionInSourceTextarea(),n=e.isSelectionInTargetTextarea();n?x():t&&h()}),p.addEventListener("keyup",()=>h()),p.addEventListener("click",()=>h()),T.addEventListener("keyup",()=>x()),T.addEventListener("click",()=>x()),p.addEventListener("blur",()=>{C="NO_SELECTION",s(null,null),u&&i(null,null)}),T.addEventListener("blur",()=>{l="NO_SELECTION",i(null,null),u&&s(null,null)}),{onTargetSelectionChanged:s,onSourceSelectionChanged:i}})}}]);