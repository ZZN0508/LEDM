/**
 * @name @tencent/ad-plugin-web
 * @version 3.4.15
 * @time 2023-09-20 17:23:21
 */

var CreativePlayerwebPlugin=function(t,e,o){"use strict";var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},i(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}var n=function(){return n=Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},n.apply(this,arguments)};function a(t,e){var o={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(o[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(o[i[r]]=t[i[r]])}return o}function s(t,e,o,i){return new(o||(o=Promise))((function(r,n){function a(t){try{d(i.next(t))}catch(t){n(t)}}function s(t){try{d(i.throw(t))}catch(t){n(t)}}function d(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,s)}d((i=i.apply(t,e||[])).next())}))}function d(t,e){var o,i,r,n,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){a.label=n[1];break}if(6===n[0]&&a.label<r[1]){a.label=r[1],r=n;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(n);break}r[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}function l(t,e,o){if(o||2===arguments.length)for(var i,r=0,n=e.length;r<n;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var p,c={exports:{}},u="object"==typeof Reflect?Reflect:null,h=u&&"function"==typeof u.apply?u.apply:function(t,e,o){return Function.prototype.apply.call(t,e,o)};p=u&&"function"==typeof u.ownKeys?u.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var f=Number.isNaN||function(t){return t!=t};function v(){v.init.call(this)}c.exports=v,c.exports.once=function(t,e){return new Promise((function(o,i){function r(o){t.removeListener(e,n),i(o)}function n(){"function"==typeof t.removeListener&&t.removeListener("error",r),o([].slice.call(arguments))}D(t,e,n,{once:!0}),"error"!==e&&function(t,e,o){"function"==typeof t.on&&D(t,"error",e,o)}(t,r,{once:!0})}))},v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var m,y,_=10;function g(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function A(t){return void 0===t._maxListeners?v.defaultMaxListeners:t._maxListeners}function E(t,e,o,i){var r,n,a;if(g(o),void 0===(n=t._events)?(n=t._events=Object.create(null),t._eventsCount=0):(void 0!==n.newListener&&(t.emit("newListener",e,o.listener?o.listener:o),n=t._events),a=n[e]),void 0===a)a=n[e]=o,++t._eventsCount;else if("function"==typeof a?a=n[e]=i?[o,a]:[a,o]:i?a.unshift(o):a.push(o),(r=A(t))>0&&a.length>r&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,console&&console.warn}return t}function I(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(t,e,o){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:o},r=I.bind(i);return r.listener=o,i.wrapFn=r,r}function T(t,e,o){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?o?[r.listener||r]:[r]:o?function(t){for(var e=new Array(t.length),o=0;o<e.length;++o)e[o]=t[o].listener||t[o];return e}(r):b(r,r.length)}function x(t){var e=this._events;if(void 0!==e){var o=e[t];if("function"==typeof o)return 1;if(void 0!==o)return o.length}return 0}function b(t,e){for(var o=new Array(e),i=0;i<e;++i)o[i]=t[i];return o}function D(t,e,o,i){if("function"==typeof t.on)i.once?t.once(e,o):t.on(e,o);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(n){i.once&&t.removeEventListener(e,r),o(n)}))}}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(t){if("number"!=typeof t||t<0||f(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");_=t}}),v.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||f(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},v.prototype.getMaxListeners=function(){return A(this)},v.prototype.emit=function(t){for(var e=[],o=1;o<arguments.length;o++)e.push(arguments[o]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var n;if(e.length>0&&(n=e[0]),n instanceof Error)throw n;var a=new Error("Unhandled error."+(n?" ("+n.message+")":""));throw a.context=n,a}var s=r[t];if(void 0===s)return!1;if("function"==typeof s)h(s,this,e);else{var d=s.length,l=b(s,d);for(o=0;o<d;++o)h(l[o],this,e)}return!0},v.prototype.addListener=function(t,e){return E(this,t,e,!1)},v.prototype.on=v.prototype.addListener,v.prototype.prependListener=function(t,e){return E(this,t,e,!0)},v.prototype.once=function(t,e){return g(e),this.on(t,C(this,t,e)),this},v.prototype.prependOnceListener=function(t,e){return g(e),this.prependListener(t,C(this,t,e)),this},v.prototype.removeListener=function(t,e){var o,i,r,n,a;if(g(e),void 0===(i=this._events))return this;if(void 0===(o=i[t]))return this;if(o===e||o.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,o.listener||e));else if("function"!=typeof o){for(r=-1,n=o.length-1;n>=0;n--)if(o[n]===e||o[n].listener===e){a=o[n].listener,r=n;break}if(r<0)return this;0===r?o.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(o,r),1===o.length&&(i[t]=o[0]),void 0!==i.removeListener&&this.emit("removeListener",t,a||e)}return this},v.prototype.off=v.prototype.removeListener,v.prototype.removeAllListeners=function(t){var e,o,i;if(void 0===(o=this._events))return this;if(void 0===o.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==o[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete o[t]),this;if(0===arguments.length){var r,n=Object.keys(o);for(i=0;i<n.length;++i)"removeListener"!==(r=n[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=o[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},v.prototype.listeners=function(t){return T(this,t,!0)},v.prototype.rawListeners=function(t){return T(this,t,!1)},v.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):x.call(t,e)},v.prototype.listenerCount=x,v.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]},function(t){t.LOADSTART="loadstart",t.PROGRESS="progress",t.CANPLAY="canplay",t.PLAYING="playing",t.PLAY="play",t.PAUSE="pause",t.TIMEUPDATE="timeupdate",t.ENDED="ended",t.ERROR="error",t.AUTOPLAY_BLOCKED="autoplayBlocked",t.WATCH_LOAD_PROGRESS="watchLoadProgress",t.ALL_ENDED="allEnded",t.ALL_LOAD_COMPLETE="allLoadComplete",t.AD_AUTOPLAY_BLOCKED="autoplayBlockedAd",t.SET_LOADING="setLoading"}(m||(m={})),function(t){t.IDLE="idle",t.LOAD_START="loadStart",t.CANPLAY="canplay",t.LOADING="loading",t.LOAD_READY="loadReady",t.PLAYING="playing",t.PAUSE="pause",t.SEEKING="seeking",t.SEEKED="seeked",t.BUFFERING="buffering",t.END="end"}(y||(y={}));var P,N=function(){function t(){this.adVideoInfoList=[],this.$container=void 0,this.urls=[],this.hasCallPlay=!1,this.eventEmitter=new c.exports.EventEmitter}return t.prototype.on=function(t,e){this.eventEmitter.on(t,e)},t.prototype.once=function(t,e){this.eventEmitter.once(t,e)},t.prototype.off=function(t,e){this.eventEmitter.off(t,e)},t.prototype.removeAllListeners=function(){this.eventEmitter.removeAllListeners()},t.prototype.emit=function(t,e){this.eventEmitter.emit(t,e)},Object.defineProperty(t.prototype,"container",{get:function(){return this.$container},enumerable:!1,configurable:!0}),t}();var w,S,O,L=function(t){P=t},V=function(t){return{info:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==P||P.info.apply(P,l(["<".concat(t,">")],e,!1))},log:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==P||P.log.apply(P,l(["<".concat(t,">")],e,!1))},warn:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==P||P.warn.apply(P,l(["<".concat(t,">")],e,!1))},error:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==P||P.error.apply(P,l(["<".concat(t,">")],e,!1))}}};function R(t){if(null===t)return"null";var e=typeof t;return"object"!==e?e:t instanceof Array?"array":"object"}function M(t,e){return Object.entries(e).forEach((function(e){var o=e[0],i=e[1],r=R(i);["null","string","number","boolean","function"].includes(r)?t[o]=i:("array"===r&&(t[o]=i),"object"===r&&(t[o]||(t[o]={}),M(t[o],i)))})),t}function k(t,e){if(0===e)return t;var o=t.lastIndexOf(".");return"".concat(t.substr(0,o),".").concat(e).concat(t.substring(o))}function U(t,e,o,i){var r=[];return t.ui.forEach((function(t){if(t.url){var n={};t.url&&-1===t.url.indexOf("".concat(e,".flv"))&&-1===t.url.indexOf("".concat(e,".mp4"))?n.url=t.url+o:n.url=t.url,t.vt&&(n.vt=Math.floor(t.vt));var a=n.url.indexOf("?")>-1?"&":"?";n.url+="".concat(a,"guid=").concat(i.guid,"&sdtfrom=&vkey=").concat(i.vkey),r.push(n.url)}})),r}!function(t){t.bind="on",t.unbind="off"}(w||(w={})),function(t){t[t.LOAD_FREEZE=2201]="LOAD_FREEZE",t[t.LOAD_FAIL=2301]="LOAD_FAIL",t[t.AD_BLOCKED=6]="AD_BLOCKED",t[t.TIMEOUT=10]="TIMEOUT",t[t.PRELOAD_TIMEOUT=20]="PRELOAD_TIMEOUT",t[t.HLS_PLAY_ERROR=30]="HLS_PLAY_ERROR",t[t.FINAL_ERROR=40]="FINAL_ERROR",t[t.EMPTY_URL=50]="EMPTY_URL",t[t.PRELOAD_EMPTY_URL=60]="PRELOAD_EMPTY_URL",t[t.BACKUP_URL_PLAY_ERROR=70]="BACKUP_URL_PLAY_ERROR"}(S||(S={})),t.AD_EVENT=void 0,(O=t.AD_EVENT||(t.AD_EVENT={})).AD_GET_INFO="getAdInfoEvt",O.AD_ORDER_SET="adOrderSetEvt",O.AD_LOAD_START="loadStartEvt",O.AD_LOAD_COMPLETE="loadCompleteEvt",O.AD_SHOW="showAdEvt",O.AD_HIDE="hideAdEvt",O.AD_PAUSE="pauseEvt",O.AD_RESUME="resumeEvt",O.AD_STOP="stopAdEvt",O.AD_DESTROY="destroyAdEvt",O.AD_ERROR="errorAdEvt",O.AD_COUNTDOWN_CHANGE="countdownChangeEvt",O.AD_LOAD_PROGRESS="loadProgressEvt",O.AD_CAN_PLAY="canPlayEvt",O.AD_PLAY_START="playStartEvt",O.AD_PLAY_END="playEndEvt",O.AD_PLAY_ERROR="playErrorEvt",O.AD_AUTOPLAY_BLOCKED="autoplayBlockedAd",O.AD_PLAYING="playingAd",O.AD_TIME_UPDATE="timeUpdateAd",O.AD_VOLUME_CHANGE="volumeChangeAd",O.AD_SET_LOADING="setLoadingAd",O.AD_PLAYER_SESSION_START="adPlayerSessionStart",O.AD_PLAYER_SESSION_END="adPlayerSessionEnd",O.AD_ENTER_COUNTDOWN="enterCountdownEvt",O.AD_ENTER_COUNTDOWN_COMPLETE="enterCountdownCompleteEvt",O.AD_REQUEST_ORDER="requestOrderEvt",O.AD_BLACK_SCREEN="blackScreenEvt",O.AD_EXIT_WINDOW_FULLSCREEN="exitWindowFullscreen",O.AD_EXIT_BROWSER_FULLSCREEN="exitBrowserFullscreen",O.AD_MOVE_IN="moveinAd",O.AD_MOVE_OUT="moveoutAd",O.AD_REPORT="reportAd",O.AD_STOP_ALL="adStopAll",function(){var t,e,o,i,r,n=-8290,a=-496,s=s||function(t,e){var o={},i=o.a={},r=function(){},a=i.b={c:function(t){for(var e="",o=0;o<"ॅूॅक़".length;o++)e+=String.fromCharCode(2348^"ॅूॅक़".charCodeAt(o));r.prototype=this;var i=new r;return t&&i.d(t),i.hasOwnProperty(e)||(i.init=function(){i.$super.init.apply(this,arguments)}),i.init.prototype=i,i.$super=this,i},create:function(){var t=this.c();return t.init.apply(t,arguments),t},init:function(){},d:function(t){for(var e="",o=0;o<";͙ͥ;͸ͣͤͭ".length;o++)e+=String.fromCharCode(778^";͙ͥ;͸ͣͤͭ".charCodeAt(o));for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);t.hasOwnProperty(e)&&(this.toString=t.toString)},e:function(){return this.init.prototype.c(this)}},s=i.f=a.c({init:function(t,e){t=this.g=t||[],this.h=null!=e?e:(-2630+n+10924)*t.length},toString:function(t){return(t||l).i(this)},concat:function(t){var e=this.g,o=t.g,i=this.h;if(t=t.h,this.j(),i%4)for(var r=0;r<t;r++)e[i+r>>>2]|=(o[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<o.length)for(r=0;r<t;r+=4)e[i+r>>>2]=o[r>>>2];else e.push.apply(e,o);return this.h+=t,this},j:function(){var e=this.g,o=this.h;e[o>>>2]&=4294967295<<32-o%4*8,e.length=t.ceil(o/4)},e:function(){var t=a.e.call(this);return t.g=this.g.slice(0),t},random:function(e){for(var o=[],i=0;i<e;i+=4)o.push(4294967296*t.random()|0);return new s.init(o,e)}}),d=o.k={},l=d.l={i:function(t){for(var e="",o=0;o<"".length;o++)e+=String.fromCharCode(368^"".charCodeAt(o));var i=t.g;t=t.h;for(var r=[],n=0;n<t;n++){var a=i[n>>>2]>>>24-n%4*8&255;r.push((a>>>4).toString(16)),r.push((15&a).toString(16))}return r.join(e)},parse:function(t){for(var e=t.length,o=[],i=0;i<e;i+=2)o[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(o,e/2)}},p=d.m={i:function(t){for(var e="",o=0;o<"".length;o++)e+=String.fromCharCode(2238^"".charCodeAt(o));var i=t.g;t=t.h;for(var r=[],n=0;n<t;n++)r.push(String.fromCharCode(i[n>>>2]>>>24-n%4*8&255));return r.join(e)},parse:function(t){for(var e=t.length,o=[],i=0;i<e;i++)o[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(o,e)}},c=d.n={i:function(t){for(var e="",o=0,i="ØôùóúçøðñµÀÁÓ¸­µñôáô";o<i.length;o++)e+=String.fromCharCode(149^i.charCodeAt(o));try{return decodeURIComponent(escape(p.i(t)))}catch(t){throw Error(e)}},parse:function(t){return p.parse(unescape(encodeURIComponent(t)))}},u=i.o=a.c({p:function(){this.q=new s.init,this.r=0},s:function(t){for(var e="",o=0;o<"ྦྷྠྦ྽ྺླ".length;o++)e+=String.fromCharCode(4052^"ྦྷྠྦ྽ྺླ".charCodeAt(o));e==typeof t&&(t=c.parse(t)),this.q.concat(t),this.r+=t.h},t:function(e){var o=this.q,i=o.g,r=o.h,n=this.u,a=r/(4*n);if(e=(a=e?t.ceil(a):t.max((0|a)-this.v,0))*n,r=t.min(4*e,r),e){for(var d=0;d<e;d+=n)this.w(i,d);d=i.splice(0,e),o.h-=r}return new s.init(d,r)},e:function(){var t=a.e.call(this);return t.q=this.q.e(),t},v:0});i.x=u.c({y:a.c(),init:function(t){this.y=this.y.c(t),this.p()},p:function(){u.p.call(this),this.z()},A:function(t){return this.s(t),this.t(),this},B:function(t){return t&&this.s(t),this.C()},u:16,D:function(t){return function(e,o){return new t.init(o).B(e)}},F:function(t){return function(e,o){return new h.HMAC.init(t,o).B(e)}}});var h=o.G={};return o}(Math);function d(t){return l.call(this,2,t)}function l(t){for(var e="",o=0;o<"ऊ".length;o++)String.fromCharCode(2422^"ऊ".charCodeAt(o));for(var i="",r=0;r<"ޭ".length;r++)String.fromCharCode(2001^"ޭ".charCodeAt(r));for(var p="",c=0;c<"Ҡ".length;c++)String.fromCharCode(1244^"Ҡ".charCodeAt(c));for(var u="",h=0;h<"ഇ".length;h++)String.fromCharCode(3451^"ഇ".charCodeAt(h));for(var f="",v=0;v<"׿".length;v++)String.fromCharCode(1411^"׿".charCodeAt(v));for(var m="",y=0;y<"ࢨ".length;y++)String.fromCharCode(2260^"ࢨ".charCodeAt(y));for(var _="",g=0;g<"ଶ".length;g++)String.fromCharCode(2890^"ଶ".charCodeAt(g));for(var A="",E=0;E<"ƨƢǶƦǶƧǵǱƧƤ".length;E++)String.fromCharCode(453^"ƨƢǶƦǶƧǵǱƧƤ".charCodeAt(E));for(var I="",C=0;C<"੸".length;C++)String.fromCharCode(2564^"੸".charCodeAt(C));for(var T="",x=0;x<"ࡌ".length;x++)String.fromCharCode(2096^"ࡌ".charCodeAt(x));for(var b="",D=0;D<"ٶ".length;D++)String.fromCharCode(1546^"ٶ".charCodeAt(D));for(var P="",N=0;N<"ઈ".length;N++)String.fromCharCode(2804^"ઈ".charCodeAt(N));for(var w="",S=0;S<"ȧ".length;S++)String.fromCharCode(603^"ȧ".charCodeAt(S));for(var O="",L=0;L<"о".length;L++)String.fromCharCode(1090^"о".charCodeAt(L));for(var V="",R=0;R<"ߡ".length;R++)String.fromCharCode(1949^"ߡ".charCodeAt(R));for(var M="",k=0;k<"̅".length;k++)String.fromCharCode(889^"̅".charCodeAt(k));for(var U="",B=0;B<"".length;B++)String.fromCharCode(3568^"".charCodeAt(B));for(var z="",H=0;H<"".length;H++)String.fromCharCode(777^"".charCodeAt(H));for(var $="",K=0;K<"".length;K++)String.fromCharCode(2613^"".charCodeAt(K));for(var G="",Y=0;Y<"´¹²¯".length;Y++)String.fromCharCode(214^"´¹²¯".charCodeAt(Y));for(var F="",W=0;W<"ۘە۞ۃ".length;W++)String.fromCharCode(1722^"ۘە۞ۃ".charCodeAt(W));for(var q="",j=0;j<"٨٩٨٣".length;j++)String.fromCharCode(1542^"٨٩٨٣".charCodeAt(j));for(var Q="",J=0;J<"ÁÌ".length;J++)String.fromCharCode(168^"ÁÌ".charCodeAt(J));for(var X="",Z=0;Z<"ۆۋ۔".length;Z++)String.fromCharCode(1698^"ۆۋ۔".charCodeAt(Z));for(var tt="",et=0,ot="ଶଋ୑୞ଈ଍଍୑୙ଶ";et<ot.length;et++)String.fromCharCode(2921^ot.charCodeAt(et));for(var it="",rt=0;rt<"יׇ׀׊ׁי".length;rt++)String.fromCharCode(1454^"יׇ׀׊ׁי".charCodeAt(rt));switch(t){case 0:var nt=[];window[it]===window?nt.push(0):nt.push(1);try{var at=tt+Math.floor(1e7*Math.random()),st=document.createElement(X);st.setAttribute(Q,at),st.style.La=q,(document.body||document.getElementsByTagName(F)[0]).appendChild(st),document.getElementById(at)?nt.push(0):nt.push(1),(document.body||document.getElementsByTagName(G)[0]).removeChild(st)}catch(t){nt.push(1)}return nt.join($);case 1:var dt=arguments[1],lt=new s.a.f.init([1332468387,-1641050960,2136896045,-1629555948],16),pt=new s.a.f.init([22039283,1457920463,776125350,-1941999367],16);return s.Ga.$(dt,lt,{ra:pt,ba:s.ba.la,qa:s.na.ma}).xa.toString().toUpperCase();case 2:return arguments[1]?yt.length>48?yt.substr(0,48):yt:z;case 3:var ct=window.document.URL,ut=window.navigator.userAgent.toLowerCase(),ht=U;window.document.referrer.length>0&&window.document.referrer;try{0==ht.length&&opener.location.href.length>0&&opener.location.href}catch(t){}var ft=window.navigator.appCodeName,vt=window.navigator.appName,mt=window.navigator.platform;return d(ct),d(ht),ct+M+d(ut)+V+ht+O+ft+w+vt+P+mt;case 4:var yt=arguments[1],_t=0;if(0==yt.length)return _t;for(n=0;n<yt.length;n++){var gt=yt.charCodeAt(n);(_t<<5)-_t+gt&_t}return _t;case 5:var At=b+arguments[a+n+8787]+T+arguments[2]+I+A+_+arguments[3]+m+arguments[4]+f+arguments[5]+u+function(){return l.call(this,3)}()+p+function(){return l.call(this,0)}()+i;return function(t){return l.call(this,1,t)}(e+function(t){return l.call(this,4,t)}(At)+At)}}(function(){for(var t="",e=0,o="±²³´µ¶·¸¹º»¼½¾¿ ¡¢£¤¥¦§¨©ªàáâãäåæçèéûÿí";e<o.length;e++)t+=String.fromCharCode(208^o.charCodeAt(e));var i=s,r=i.a.f;i.k.H={i:function(t){for(var e="",o=0;o<"".length;o++)e+=String.fromCharCode(4077^"".charCodeAt(o));var i=t.g,r=t.h,n=this.I;t.j(),t=[];for(var a=0;a<r;a+=3)for(var s=(i[a>>>2]>>>24-a%4*8&255)<<16|(i[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|i[a+2>>>2]>>>24-(a+2)%4*8&255,d=0;4>d&&a+.75*d<r;d++)t.push(n.charAt(s>>>6*(3-d)&63));if(i=n.charAt(64))for(;t.length%4;)t.push(i);return t.join(e)},parse:function(t){var e=t.length,o=this.I;(i=o.charAt(64))&&-1!=(i=t.indexOf(i))&&(e=i);for(var i=[],n=0,a=0;a<e;a++)if(a%4){var s=o.indexOf(t.charAt(a-1))<<a%4*2,d=o.indexOf(t.charAt(a))>>>6-a%4*2;i[n>>>2]|=(s|d)<<24-n%4*8,n++}return r.create(i,n)},I:t}})(),function(t){function e(t,e,o,i,r,n,a){return u.call(this,0,t,e,o,i,r,n,a)}function o(t,e,o,i,r,n,a){return u.call(this,1,t,e,o,i,r,n,a)}function i(t,e,o,i,r,n,a){return u.call(this,2,t,e,o,i,r,n,a)}function r(t,e,o,i,r,n,a){return u.call(this,3,t,e,o,i,r,n,a)}for(var n=s,a=(l=n.a).f,d=l.x,l=n.G,p=[],c=0;64>c;c++)p[c]=4294967296*t.abs(t.sin(c+1))|0;function u(t){switch(t){case 0:var e=arguments[1],o=arguments[2],i=arguments[3],r=arguments[4],n=arguments[5],a=arguments[6];return((e=e+(o&i|~o&r)+n+arguments[7])<<a|e>>>32-a)+o;case 1:return((e=(e=arguments[1])+((o=arguments[2])&(r=arguments[4])|(i=arguments[3])&~r)+(n=arguments[5])+arguments[7])<<(a=arguments[6])|e>>>32-a)+o;case 2:return((e=(e=arguments[1])+((o=arguments[2])^(i=arguments[3])^(r=arguments[4]))+(n=arguments[5])+arguments[7])<<(a=arguments[6])|e>>>32-a)+o;case 3:return((e=(e=arguments[1])+((i=arguments[3])^((o=arguments[2])|~(r=arguments[4])))+(n=arguments[5])+arguments[7])<<(a=arguments[6])|e>>>32-a)+o}}l=l.J=d.c({z:function(){this.K=new a.init([1732584193,4023233417,2562383102,271733878])},w:function(t,n){for(var a=0;16>a;a++){var s=t[c=n+a];t[c]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this.K.g;var d,l,c=t[n+0],u=(s=t[n+1],t[n+2]),h=t[n+3],f=t[n+4],v=t[n+5],m=t[n+6],y=t[n+7],_=t[n+8],g=t[n+9],A=t[n+10],E=t[n+11],I=t[n+12],C=t[n+13],T=t[n+14],x=t[n+15],b=a[0],D=r(D=r(D=r(D=r(D=i(D=i(D=i(D=i(D=o(D=o(D=o(D=o(D=e(D=e(D=e(D=e(D=a[1],l=e(l=a[2],d=e(d=a[3],b=e(b,D,l,d,c,7,p[0]),D,l,s,12,p[1]),b,D,u,17,p[2]),d,b,h,22,p[3]),l=e(l,d=e(d,b=e(b,D,l,d,f,7,p[4]),D,l,v,12,p[5]),b,D,m,17,p[6]),d,b,y,22,p[7]),l=e(l,d=e(d,b=e(b,D,l,d,_,7,p[8]),D,l,g,12,p[9]),b,D,A,17,p[10]),d,b,E,22,p[11]),l=e(l,d=e(d,b=e(b,D,l,d,I,7,p[12]),D,l,C,12,p[13]),b,D,T,17,p[14]),d,b,x,22,p[15]),l=o(l,d=o(d,b=o(b,D,l,d,s,5,p[16]),D,l,m,9,p[17]),b,D,E,14,p[18]),d,b,c,20,p[19]),l=o(l,d=o(d,b=o(b,D,l,d,v,5,p[20]),D,l,A,9,p[21]),b,D,x,14,p[22]),d,b,f,20,p[23]),l=o(l,d=o(d,b=o(b,D,l,d,g,5,p[24]),D,l,T,9,p[25]),b,D,h,14,p[26]),d,b,_,20,p[27]),l=o(l,d=o(d,b=o(b,D,l,d,C,5,p[28]),D,l,u,9,p[29]),b,D,y,14,p[30]),d,b,I,20,p[31]),l=i(l,d=i(d,b=i(b,D,l,d,v,4,p[32]),D,l,_,11,p[33]),b,D,E,16,p[34]),d,b,T,23,p[35]),l=i(l,d=i(d,b=i(b,D,l,d,s,4,p[36]),D,l,f,11,p[37]),b,D,y,16,p[38]),d,b,A,23,p[39]),l=i(l,d=i(d,b=i(b,D,l,d,C,4,p[40]),D,l,c,11,p[41]),b,D,h,16,p[42]),d,b,m,23,p[43]),l=i(l,d=i(d,b=i(b,D,l,d,g,4,p[44]),D,l,I,11,p[45]),b,D,x,16,p[46]),d,b,u,23,p[47]),l=r(l,d=r(d,b=r(b,D,l,d,c,6,p[48]),D,l,y,10,p[49]),b,D,T,15,p[50]),d,b,v,21,p[51]),l=r(l,d=r(d,b=r(b,D,l,d,I,6,p[52]),D,l,h,10,p[53]),b,D,A,15,p[54]),d,b,s,21,p[55]),l=r(l,d=r(d,b=r(b,D,l,d,_,6,p[56]),D,l,x,10,p[57]),b,D,m,15,p[58]),d,b,C,21,p[59]),l=r(l,d=r(d,b=r(b,D,l,d,f,6,p[60]),D,l,E,10,p[61]),b,D,u,15,p[62]),d,b,g,21,p[63]);a[0]=a[0]+b|0,a[1]=a[1]+D|0,a[2]=a[2]+l|0,a[3]=a[3]+d|0},C:function(){var e=this.q,o=e.g,i=8*this.r,r=8*e.h;o[r>>>5]|=128<<24-r%32;var n=t.floor(i/4294967296);for(o[15+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),o[14+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.h=4*(o.length+1),this.t(),o=(e=this.K).g,i=0;4>i;i++)r=o[i],o[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},e:function(){var t=d.e.call(this);return t.K=this.K.e(),t}}),n.J=d.D(l),n.L=d.F(l)}(Math),o=(t=(e=s).a).b,i=t.f,r=(t=e.G).M=o.c({y:o.c({N:4,O:t.J,P:1}),init:function(t){this.y=this.y.c(t)},Q:function(t,e){for(var o=(s=this.y).O.create(),r=i.create(),n=r.g,a=s.N,s=s.P;n.length<a;){d&&o.A(d);var d=o.A(t).B(e);o.p();for(var l=1;l<s;l++)d=o.B(d),o.p();r.concat(d)}return r.h=4*a,r}}),e.M=function(t,e,o){return r.create(o).Q(t,e)},s.a.R||function(t){var e=(f=s).a,o=e.b,i=e.f,r=e.o,n=f.k.H,a=f.G.M,d=e.R=r.c({y:o.c(),S:function(t,e){return this.create(this.T,t,e)},U:function(t,e){return this.create(this.V,t,e)},init:function(t,e,o){this.y=this.y.c(o),this.W=t,this.X=e,this.p()},p:function(){r.p.call(this),this.z()},Y:function(t){return this.s(t),this.t()},B:function(t){return t&&this.s(t),this.C()},N:4,Z:4,T:1,V:2,D:function(t){return{$:function(e,o,i){for(var r="",n=0;n<"ǠǧǡǺǽǴ".length;n++)r+=String.fromCharCode(403^"ǠǧǡǺǽǴ".charCodeAt(n));return(r==typeof o?v:h).$(t,e,o,i)},_:function(e,o,i){for(var r="",n=0;n<"ࣘࣟࣙࣂࣅ࣌".length;n++)r+=String.fromCharCode(2219^"ࣘࣟࣙࣂࣅ࣌".charCodeAt(n));return(r==typeof o?v:h)._(t,e,o,i)}}}});e.aa=d.c({C:function(){return this.t(!0)},u:1});var l=f.ba={},p=function(t,e,o){var i=this.ca;i?this.ca=void 0:i=this.da;for(var r=0;r<o;r++)t[e+r]^=i[r]},c=(e.ea=o.c({S:function(t,e){return this.fa.create(t,e)},U:function(t,e){return this.ga.create(t,e)},init:function(t,e){this.ha=t,this.ca=e}})).c();c.fa=c.c({ia:function(t,e){var o=this.ha,i=o.u;p.call(this,t,e,i),o.ja(t,e),this.da=t.slice(e,e+i)}}),c.ga=c.c({ia:function(t,e){var o=this.ha,i=o.u,r=t.slice(e,e+i);o.ka(t,e),p.call(this,t,e,i),this.da=r}}),l=l.la=c,c=(f.na={}).ma={na:function(t,e){for(var o,r=(o=(o=4*e)-t.h%o)<<24|o<<16|o<<8|o,n=[],a=0;a<o;a+=4)n.push(r);o=i.create(n,o),t.concat(o)},oa:function(t){t.h-=255&t.g[t.h-1>>>2]}},e.pa=d.c({y:d.y.c({ba:l,qa:c}),p:function(){d.p.call(this);var t=(e=this.y).ra,e=e.ba;if(this.W==this.T)var o=e.S;else o=e.U,this.v=1;this.sa=o.call(e,this,t&&t.g)},w:function(t,e){this.sa.ia(t,e)},C:function(){var t=this.y.qa;if(this.W==this.T){t.na(this.q,this.u);var e=this.t(!0)}else e=this.t(!0),t.oa(e);return e},u:4});var u=e.ta=o.c({init:function(t){this.d(t)},toString:function(t){return(t||this.ua).i(this)}}),h=(l=(f.wa={}).va={i:function(t){var e=t.xa;return((t=t.ya)?i.create([1398893684,1701076831]).concat(t).concat(e):e).toString(n)},parse:function(t){var e=(t=n.parse(t)).g;if(1398893684==e[0]&&1701076831==e[1]){var o=i.create(e.slice(2,4));e.splice(0,4),t.h-=16}return u.create({xa:t,ya:o})}},e.za=o.c({y:o.c({wa:l}),$:function(t,e,o,i){i=this.y.c(i);var r=t.S(o,i);return e=r.B(e),r=r.y,u.create({xa:e,Aa:o,ra:r.ra,Ba:t,ba:r.ba,qa:r.qa,u:t.u,ua:i.wa})},_:function(t,e,o,i){return i=this.y.c(i),e=this.Ca(e,i.wa),t.U(o,i).B(e.xa)},Ca:function(t,e){for(var o="",i=0;i<"ࠕࠒࠔࠏࠈࠁ".length;i++)o+=String.fromCharCode(2150^"ࠕࠒࠔࠏࠈࠁ".charCodeAt(i));return o==typeof t?e.parse(t,this):t}})),f=(f.Da={}).va={Ea:function(t,e,o,r){return r||(r=i.random(8)),t=a.create({N:e+o}).Q(t,r),o=i.create(t.g.slice(e),4*o),t.h=4*e,u.create({Aa:t,ra:o,ya:r})}},v=e.Fa=h.c({y:h.y.c({Da:f}),$:function(t,e,o,i){return o=(i=this.y.c(i)).Da.Ea(o,t.N,t.Z),i.ra=o.ra,(t=h.$.call(this,t,e,o.Aa,i)).d(o),t},_:function(t,e,o,i){return i=this.y.c(i),e=this.Ca(e,i.wa),o=i.Da.Ea(o,t.N,t.Z,e.ya),i.ra=o.ra,h._.call(this,t,e,o.Aa,i)}})}(),function(){for(var t=s,e=t.a.pa,o=t.G,i=[],r=[],n=[],a=[],d=[],l=[],p=[],c=[],u=[],h=[],f=[],v=0;256>v;v++)f[v]=128>v?v<<1:v<<1^283;var m=0,y=0;for(v=0;256>v;v++){var _=(_=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&_^99;i[m]=_,r[_]=m;var g=f[m],A=f[g],E=f[A],I=257*f[_]^16843008*_;n[m]=I<<24|I>>>8,a[m]=I<<16|I>>>16,d[m]=I<<8|I>>>24,l[m]=I,I=16843009*E^65537*A^257*g^16843008*m,p[_]=I<<24|I>>>8,c[_]=I<<16|I>>>16,u[_]=I<<8|I>>>24,h[_]=I,m?(m=g^f[f[f[E^g]]],y^=f[f[y]]):m=y=1}var C=[0,1,2,4,8,16,32,64,128,27,54];o=o.Ga=e.c({z:function(){for(var t=(o=this.X).g,e=o.h/4,o=4*((this.Ha=e+6)+1),r=this.Ia=[],n=0;n<o;n++)if(n<e)r[n]=t[n];else{var a=r[n-1];n%e?6<e&&4==n%e&&(a=i[a>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[255&a]):(a=i[(a=a<<8|a>>>24)>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[255&a],a^=C[n/e|0]<<24),r[n]=r[n-e]^a}for(t=this.Ja=[],e=0;e<o;e++)n=o-e,a=e%4?r[n]:r[n-4],t[e]=4>e||4>=n?a:p[i[a>>>24]]^c[i[a>>>16&255]]^u[i[a>>>8&255]]^h[i[255&a]]},ja:function(t,e){this.Ka(t,e,this.Ia,n,a,d,l,i)},ka:function(t,e){var o=t[e+1];t[e+1]=t[e+3],t[e+3]=o,this.Ka(t,e,this.Ja,p,c,u,h,r),o=t[e+1],t[e+1]=t[e+3],t[e+3]=o},Ka:function(t,e,o,i,r,n,a,s){for(var d=this.Ha,l=t[e]^o[0],p=t[e+1]^o[1],c=t[e+2]^o[2],u=t[e+3]^o[3],h=4,f=1;f<d;f++){var v=i[l>>>24]^r[p>>>16&255]^n[c>>>8&255]^a[255&u]^o[h++],m=i[p>>>24]^r[c>>>16&255]^n[u>>>8&255]^a[255&l]^o[h++],y=i[c>>>24]^r[u>>>16&255]^n[l>>>8&255]^a[255&p]^o[h++];u=i[u>>>24]^r[l>>>16&255]^n[p>>>8&255]^a[255&c]^o[h++],l=v,p=m,c=y}v=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^o[h++],m=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^o[h++],y=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^o[h++],u=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^o[h++],t[e]=v,t[e+1]=m,t[e+2]=y,t[e+3]=u},N:8}),t.Ga=e.D(o)}()}();var B,z=function(t,e){var o,i;return t&&"o"===t.s&&t.vl&&t.vl.vi&&(3===t.dltype||8===t.dltype?(o=function(t){var e,o,i,r,n,a=[],s=null===(o=null===(e=null==t?void 0:t.vl)||void 0===e?void 0:e.vi)||void 0===o?void 0:o[0];if(null===(r=null===(i=null==s?void 0:s.ul)||void 0===i?void 0:i.ui)||void 0===r?void 0:r.length)for(var d=void 0,l=0,p=s.ul.ui.length;l<p;l++)(d=s.ul.ui[l]).url&&d.hls&&d.hls.pt?a.push(d.url+d.hls.pt):8===t.dltype&&a.push(d.url);return 8===t.dltype&&s&&s.ul&&(n=s.ul.m3u8),{urls:a,m3u8:n}}(t),i="hls"):1===t.dltype&&(o=function(t,e){var o,i,r,n=[],a=t.vl.vi[0]||null,s=null===(o=a.cl)||void 0===o?void 0:o.fc;if(!(null===(i=null==a?void 0:a.cl)||void 0===i?void 0:i.ci)&&a.fvkey&&a.fn&&a.ul&&a.ul.ui&&a.ul.ui.length)return{urls:n};if(!(null===(r=a.cl)||void 0===r?void 0:r.ci)||s!==a.cl.ci.length)return{urls:n};for(var d={vkey:a.fvkey,guid:e.guid},l=0;l<s;l++){var p=k(a.fn,l+1);n=U(a.ul,a.lnk,p,d);break}return{urls:n}}(t,{guid:e}),i="mp4")),o&&i?Promise.resolve({type:i,urls:o.urls,m3u8:o.m3u8}):Promise.reject()},H=function(t){var e="";try{window.localStorage&&(e=window.localStorage[t])}catch(t){}return e},$=function(t){function i(e){var o=t.call(this)||this;return o.logger=V("ThumbplayerAdapter"),o.currentAdIndex=0,o.options=e,o}return r(i,t),i.prototype.setOptions=function(t){this.options=n(n({},this.options),t)},i.prototype.createPlayer=function(t){var e;this.player||(this.$container="string"==typeof t?document.querySelector(t):t,this.player=o.KernelFactory.create(n({container:null!==(e=this.$container)&&void 0!==e?e:t,originKernelConfig:{maxVideoNodeCount:this.options.playerVideoDom?1:2},opencache:!this.options.isMobile&&this.options.isOpenCache&&this.options.isUseDemuxKernel,videoElements:this.options.playerVideoDom?[this.options.playerVideoDom]:void 0,createVideoNodeWhenLoad:!!this.options.playerVideoDom},this.options.kernelOptions)),this.bindPlayerEvent())},i.prototype.destroy=function(){var t,e;null===(t=this.player)||void 0===t||t.removeAllListeners(),null===(e=this.player)||void 0===e||e.destroy(),this.player=void 0},i.prototype.load=function(t){var e;this.adVideoInfoList=t.map((function(t,e){return n({index:e,status:y.IDLE},t)})),this.urls=t.map((function(t){return n(n({},t),{autoPreloadLeftTime:5})})),this.logger.log("player load",t),this.currentAdIndex=0,null===(e=this.player)||void 0===e||e.load(this.urls,this.getKernelConfig())},i.prototype.pause=function(){var t;null===(t=this.player)||void 0===t||t.pause()},i.prototype.resume=function(){var t;this.hasCallPlay=!0,null===(t=this.player)||void 0===t||t.play()},i.prototype.play=function(){var t;this.hasCallPlay||this.emit(m.WATCH_LOAD_PROGRESS,{index:0,adVideoInfo:this.adVideoInfoList[0]}),this.hasCallPlay=!0,null===(t=this.player)||void 0===t||t.play()},i.prototype.stop=function(){var t;null===(t=this.player)||void 0===t||t.stop(),this.hasCallPlay=!1,this.currentAdIndex=0},Object.defineProperty(i.prototype,"currentVideoElement",{get:function(){var t;return null===(t=this.player)||void 0===t?void 0:t.currentVideoElement},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){var t;return null===(t=this.player)||void 0===t?void 0:t.playtime},set:function(t){t&&this.player&&this.player.seek(t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"volume",{get:function(){var t;return null===(t=this.player)||void 0===t?void 0:t.volume},set:function(t){this.player&&"number"==typeof t&&(this.player.volume=t)},enumerable:!1,configurable:!0}),i.prototype.preloadNext=function(t,e){return!0},i.prototype.playNext=function(t,e){var i,r=this;void 0===e&&(e=!1);var n=this.adVideoInfoList.length,a=this.adVideoInfoList[n-1].index;if(this.logger.log("当前播放",{kernelName:null===(i=this.player)||void 0===i?void 0:i.kernelName,nextPlayVideoIndex:t,len:n}),t&&t>a)return this.logger.log("当前播放的是最后一个, 不再播放下一个"),!1;if(this.urls.shift(),this.urls.length<=0)return!1;this.currentAdIndex=t,this.emit(m.WATCH_LOAD_PROGRESS,{index:t,adVideoInfo:this.adVideoInfoList[t]});var s=this.adVideoInfoList[t-1];return setTimeout((function(){var i,n,a;(e||(null===(i=r.player)||void 0===i?void 0:i.kernelName)===o.KERNEL_NAME.HLS_JS||s.backupUrlData)&&0!==t?(r.logger.log("重新播放",r.urls),null===(n=r.player)||void 0===n||n.play(r.urls,r.getKernelConfig())):null===(a=r.player)||void 0===a||a.play()})),!0},i.prototype.setAdVideoSrcEmpty=function(t){var e=this.adVideoInfoList[t];if(e){var o={config:{uid:"".concat(e.fmt," -").concat(e.vid)}};this.errorVideoInfo=o,e.errorCode="srcEmpty",this.handleVideoError(e,!0)}},i.prototype.tryPlayBackupUrl=function(t){t.tryBackupUrlsPending||(t.backupUrlData?this.playUrl(t):this.getBackupUrl(t))},i.prototype.playUrl=function(t){this.logger.log("播放备用地址");var e=t,o=t.backupUrlData,i=o.urls;if(!i||i.length<=0)this.handleVideoError(t,!1);else if("hls"===o.type){if(this.unbindHlsEvents(),this.bindHlsEvents(e),o.m3u8&&!o.tryM3u8Flag)return this.replacePlay(t,i,!0,o.m3u8),void(o.tryM3u8Flag=!0);this.replacePlay(t,i,!0)}else this.replacePlay(t,i,!1)},i.prototype.getKernelConfig=function(t){return this.options.isMobile?{}:"hls"===t?{kernelName:o.KERNEL_NAME.HLS_JS}:{kernelName:this.options.isUseDemuxKernel?o.KERNEL_NAME.DEMUX_2_FMP4:o.KERNEL_NAME.ORIGIN}},i.prototype.bindPlayerEvent=function(){var t=this;this.player&&(this.player.on(o.PLAY_EVENT.VIDEO_BUFFER_CHANGE,(function(e){t.handleVideoProgress(e)})),this.player.on(o.PLAY_EVENT.STATE_CHANGE,(function(e){e.data.new===o.VIDEO_STATE.LOAD_START&&t.handleVideoLoadStart(e),e.data.new===o.VIDEO_STATE.CANPLAY&&t.handleVideoCanPlay(e),e.data.new===o.VIDEO_STATE.PAUSE&&t.handleVideoPause(e),e.data.new===o.VIDEO_STATE.PLAYING&&(e.data.old===o.VIDEO_STATE.PAUSE&&t.handleVideoResume(e),t.handleVideoPlaying(e)),e.data.new===o.VIDEO_STATE.END&&e.data.videoInfo&&t.handleVideoEnd(e)})),this.player.on(o.PLAY_EVENT.TIME_UPDATE,(function(e){t.handleVideoTimeupdate(e)})),this.player.on(o.PLAY_EVENT.ERROR,(function(e){var o,i,r,a,s,d=e.data.videoInfo;t.errorVideoInfo=d.config?d:null!==(o=t.errorVideoInfo)&&void 0!==o?o:n(n({},d),{config:null!==(i=t.adVideoInfoList[t.currentAdIndex])&&void 0!==i?i:t.urls[0],errorCode:"not has videoInfo"});var l=t.transformAdVideoInfo(t.errorVideoInfo);t.logger.error("播放器错误",d.error),l.errorCode=null!==(a=null===(r=d.error)||void 0===r?void 0:r.code)&&void 0!==a?a:"not has errorCode",l.errorMsg=null===(s=d.error)||void 0===s?void 0:s.message,t.handleVideoError(l,!0)})),this.player.on(o.PLAY_EVENT.AUTOPLAY_BLOCKED,(function(e){t.handleVideoAutoplayBlocked(e)})),this.player.on(o.PLAY_EVENT.SET_LOADING,(function(){t.emit(m.SET_LOADING)})))},i.prototype.handleVideoLoadStart=function(t){var e=this.transformAdVideoInfo(t.data.videoInfo);this.transparentEvent(m.LOADSTART,e)},i.prototype.handleVideoCanPlay=function(t){this.transparentEvent(m.CANPLAY,this.transformAdVideoInfo(t.data.videoInfo),t.target)},i.prototype.handleVideoProgress=function(t){this.transparentEvent(m.PROGRESS,this.transformAdVideoInfo(t.data.videoInfo),t.target)},i.prototype.handleVideoTimeupdate=function(t){this.transparentEvent(m.TIMEUPDATE,this.transformAdVideoInfo(t.data.videoInfo),t.target)},i.prototype.handleVideoPlaying=function(t){var e=this.transformAdVideoInfo(t.data.videoInfo);e.played||(e.played=!0,this.transparentEvent(m.PLAYING,e))},i.prototype.handleVideoPause=function(t){this.transparentEvent(m.PAUSE,this.transformAdVideoInfo(t.data.videoInfo))},i.prototype.handleVideoResume=function(t){this.transparentEvent(m.PLAY,this.transformAdVideoInfo(t.data.videoInfo))},i.prototype.handleVideoEnd=function(t){this.transparentEvent(m.ENDED,this.transformAdVideoInfo(t.data.videoInfo))},i.prototype.handleVideoError=function(t,e){this.transparentEvent(m.ERROR,t,void 0,{canTryBackup:e})},i.prototype.handleVideoAutoplayBlocked=function(t){this.logger.log("自动播放器被阻止");var e=this.transformAdVideoInfo(t.data.videoInfo);this.transparentEvent(m.AD_AUTOPLAY_BLOCKED,e)},i.prototype.transparentEvent=function(t,e,o,i){var r,a,s=e.duration,d=null!==(a=null===(r=null==o?void 0:o.videoBuffered)||void 0===r?void 0:r.reduce((function(t,e){var o=null!=e?e:{},i=o.start,r=void 0===i?0:i,n=o.end;return t+((void 0===n?0:n)-r)}),0))&&void 0!==a?a:0,l=d/s;this.updateOrderInfoStatus(e,t,l);var p=null==o?void 0:o.currentVideoElement;this.emit(t,n({index:Number(e.index),adVideoInfo:M(e,{loadedPercent:l,buffered:d,playTime:null==o?void 0:o.playtime,readyState:null==p?void 0:p.readyState,networkState:null==p?void 0:p.networkState})},i))},i.prototype.updateOrderInfoStatus=function(t,e,o){e!==m.PLAYING&&e!==m.PLAY||(t.status=y.PLAYING),e===m.PAUSE&&(t.status=y.PAUSE),e===m.ENDED&&(t.status=y.END),e!==m.PROGRESS&&e!==m.TIMEUPDATE||o>.99&&(t.status=y.LOAD_READY)},i.prototype.getBackupUrl=function(t){var e=this;this.logger.log("开始请求备用地址",",第 ".concat(t.index," 个, vid: ").concat(t.vid)),t.tryBackupUrlsPending=!0,this.requestVideoUrlsByVid(t.vid).then((function(o){t.tryBackupUrlsPending=!1,e.getBackupUrlSuccess(t,o)})).catch((function(){t.tryBackupUrlsPending=!1,e.getBackupUrlFailed(t)}))},i.prototype.getBackupUrlSuccess=function(t,e){var o;this.logger.log("请求备用地址成功","第".concat(t.index,"个, vid: ").concat(t.vid,",备份地址数：").concat((null==e?void 0:e.urls)?e.urls.length:0)),(null===(o=e.urls)||void 0===o?void 0:o.length)?(t.backupUrlData=e,this.playUrl(t)):(t.errorCode="backupUrlEmpty",this.handleVideoError(t,!1))},i.prototype.getBackupUrlFailed=function(t){this.logger.log("请求备用地址失败","第 ".concat(t.index,"个")),t.errorCode="backupUrlFailed",this.handleVideoError(t,!1)},i.prototype.bindHlsEvents=function(t){var e=this,o=t;this.hlsEvt={hlsError:function(i){var r=i.data;e.logger.error("重试播放 hls error",{index:o.index,vid:o.vid},r),o.detailErrorCode=S.HLS_PLAY_ERROR,t.errorCode+="-hlsError",e.handleVideoError(t,!1)}},Object.keys(this.hlsEvt).forEach((function(t){var o;null===(o=e.player)||void 0===o||o.on(t,e.hlsEvt[t])}))},i.prototype.unbindHlsEvents=function(){var t=this;this.hlsEvt&&(Object.keys(this.hlsEvt).forEach((function(e){var o;null===(o=t.player)||void 0===o||o.off(e,t.hlsEvt[e])})),this.hlsEvt=void 0)},i.prototype.replacePlay=function(t,e,o,i){var r,n,a=this;void 0===i&&(i=""),this.logger.log("替换 url 播放",e,i);var s=e.shift(),d={backupUrls:e,url:s,autoPreloadLeftTime:5};i&&(d.m3u8=((r={})[s]=i,r)),Object.assign(this.urls[0],d);var l=this.getKernelConfig(o?"hls":"");this.hasCallPlay?(this.emit(m.WATCH_LOAD_PROGRESS,{index:t.index,adVideoInfo:M(t,{status:t.status})}),setTimeout((function(){var t;a.logger.log("播放重试 url",a.urls[0],l),null===(t=a.player)||void 0===t||t.play(a.urls[0],l)}))):(this.logger.log("加载重试 url",this.urls[0],l),null===(n=this.player)||void 0===n||n.load(this.urls[0],l))},i.prototype.transformAdVideoInfo=function(t){var e,o=t.config.uid.split("-")[1];return M(null!==(e=this.adVideoInfoList.find((function(t){return t.vid===o})))&&void 0!==e?e:{vid:o},{status:t.status})},i.prototype.requestVideoUrlsByVid=function(t){this.emit("getinfo");var o=this.options.plugin.player;if(!o.getinfoPlugin)return Promise.reject();var i=o.getCommonKv(e.COMMON_DATA_KEY.guid);return o.getinfoPlugin.request(t,{defnpayver:0,defn:"",dtype:3,fhdswitch:0,platform:"10201",sdtfrom:"v1010",spwm:0,unid:H("txp-unid"),vid:t,sphls:2}).then((function(t){return!t||t.error?Promise.reject():z(t.resData,i)}))},i}(N),K="https://mark.l.qq.com/fcgi-bin/get_video_mark_all",G="https://testmark.l.qq.com/fcgi-bin/get_video_mark_all",Y="1"===o.urlTool.getUrlParamByKey(window.location.href,"debugvideomark");!function(t){t.SET_LOADING="SET_LOADING",t.VIDEO_TIMEUPDATE="VIDEO_TIMEUPDATE",t.VIDEO_PLAYING="VIDEO_PLAYING",t.VIDEO_PAUSE="VIDEO_PAUSE",t.CTRL_SHOW="CTRL_SHOW",t.CTRL_HIDE="CTRL_HIDE",t.HOVER_PROGRESS="HOVER_PROGRESS",t.SHOW_LEVELS="SHOW_LEVELS",t.TOGGLE_MINI_PLAYER="TOGGLE_MINI_PLAYER",t.AD_SESSION_ID_CHANGE="AD_SESSION_ID_CHANGE",t.VIDEO_PLAY_SESSION_END="VIDEO_PLAY_SESSION_END",t.VIDEO_SETLEVEL_END="VIDEO_SETLEVEL_END"}(B||(B={}));var F,W,q,j,Q,J,X,Z,tt,et,ot,it,rt,nt,at=function(){function t(t){this.eventEmitter=new c.exports.EventEmitter,this.options=t}return Object.defineProperty(t.prototype,"container",{get:function(){return this.options.container},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playerData",{get:function(){return this.options.playerData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showCloseButton",{get:function(){var t;return null!==(t=this.options.showCloseButton)&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forbidLinkJump",{get:function(){var t;return null!==(t=this.options.forbidLinkJump)&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobile",{get:function(){var t;return null!==(t=this.options.isMobile)&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"phlsPlayType",{get:function(){var t;return null!==(t=this.options.phlsPlayType)&&void 0!==t?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSoloPlayingPhls",{get:function(){var t;return null!==(t=this.options.isSoloPlayingPhls)&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"soloPlayPhlsTimeOffset",{get:function(){var t;return null!==(t=this.options.soloPlayPhlsTimeOffset)&&void 0!==t?t:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMimiPlayer",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.emit=function(t){for(var e,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];(e=this.eventEmitter).emit.apply(e,l([t],o,!1))},t.prototype.on=function(t,e){this.eventEmitter.on(t,e)},t.prototype.off=function(t,e){this.eventEmitter.off(t,e)},t.prototype.renderQrCode=function(t,e,o){var i,r;null===(r=(i=this.options).renderQrCode)||void 0===r||r.call(i,t,e,o)},t.prototype.resetBarrageZindex=function(){var t,e;null===(e=(t=this.options.playerMethod).resetBarrageZindex)||void 0===e||e.call(t)},t.prototype.initEvents=function(){var t=this,e=this.getEvents();Object.entries(e).forEach((function(e){var o=e[0];(0,e[1])((function(e){t.eventEmitter.emit(o,{event:o,data:e})}))}))},t}();!function(t){t[t.PRE=1]="PRE",t[t.TAIL=2]="TAIL",t[t.ANCHOR=3]="ANCHOR",t[t.PAUSE=4]="PAUSE",t[t.PROGRESS_PREVIEW=5]="PROGRESS_PREVIEW",t[t.VIDEO_RESOLUTION=6]="VIDEO_RESOLUTION",t[t.DYNAMIC_MID=7]="DYNAMIC_MID"}(W||(W={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.NOT_LOGIN=0]="NOT_LOGIN",t[t.LOGIN=1]="LOGIN",t[t.HLW_VIP=2]="HLW_VIP",t[t.TV_VIP=9]="TV_VIP",t[t.SPORTS_VIP=10]="SPORTS_VIP",t[t.SPORTS_SVIP=12]="SPORTS_SVIP"}(q||(q={})),function(t){t[t.GUEST=0]="GUEST",t[t.QQ=1]="QQ",t[t.WX=2]="WX"}(j||(j={})),function(t){t[t.OK=0]="OK"}(Q||(Q={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.PRE=1]="PRE",t[t.BROADCAST=2]="BROADCAST",t[t.TAIL=3]="TAIL",t[t.PAUSE=4]="PAUSE",t[t.LOADING=5]="LOADING",t[t.PROGRESS_PREVIEW=6]="PROGRESS_PREVIEW",t[t.VIDEO_RESOLUTION=7]="VIDEO_RESOLUTION",t[t.MID=8]="MID",t[t.CREATIVE_MID=9]="CREATIVE_MID",t[t.HLS_MID=10]="HLS_MID",t[t.CORNER=11]="CORNER",t[t.LIVE_CORNER=12]="LIVE_CORNER",t[t.VIDEO_IN=13]="VIDEO_IN",t[t.WATCH_BUY=14]="WATCH_BUY",t[t.ANCHOR_EMPTY=15]="ANCHOR_EMPTY",t[t.NON_STANDARD=16]="NON_STANDARD",t[t.DYNAMIC_MID=17]="DYNAMIC_MID"}(J||(J={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CLICK=1]="CLICK",t[t.SCAN=2]="SCAN"}(X||(X={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.ORIGIN_EXPOSURE=1]="ORIGIN_EXPOSURE",t[t.EXPOSURE=2]="EXPOSURE",t[t.PLAY_BACK=3]="PLAY_BACK",t[t.EMPTY=4]="EMPTY",t[t.EFFECT=5]="EFFECT",t[t.FEEDBACK=6]="FEEDBACK",t[t.CLICK=7]="CLICK",t[t.RANGE_EXPOSURE=8]="RANGE_EXPOSURE",t[t.RANGE_PLAY=9]="RANGE_PLAY",t[t.PLUGIN=10]="PLUGIN"}(Z||(Z={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.COMMON_EXPOSURE_CLICK=1]="COMMON_EXPOSURE_CLICK",t[t.HEADER_CLICK=2]="HEADER_CLICK",t[t.ACTION_BTN_CLICK=3]="ACTION_BTN_CLICK",t[t.POSTER_CLICK=4]="POSTER_CLICK",t[t.COMMON_PLAY=5]="COMMON_PLAY",t[t.COMMON_DOWNLOAD=6]="COMMON_DOWNLOAD",t[t.COMMON=7]="COMMON",t[t.SKIP_CLICK=9]="SKIP_CLICK"}(tt||(tt={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.PICTURE=1]="PICTURE",t[t.QRCODE=2]="QRCODE"}(et||(et={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.IMAGE=1]="IMAGE",t[t.VIDEO=2]="VIDEO"}(ot||(ot={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VIDEO_TIME=1]="VIDEO_TIME",t[t.TIMESTAMP=2]="TIMESTAMP"}(it||(it={})),function(t){t[t.SPLIT_TYPE_UNKNOWN=0]="SPLIT_TYPE_UNKNOWN",t[t.SPLIT_TYPE_LEFT_TOP=1]="SPLIT_TYPE_LEFT_TOP",t[t.SPLIT_TYPE_LEFT_MIDDLE=2]="SPLIT_TYPE_LEFT_MIDDLE",t[t.SPLIT_TYPE_LEFT_BOTTOM=3]="SPLIT_TYPE_LEFT_BOTTOM",t[t.SPLIT_TYPE_RIGHT_MIDDLE=4]="SPLIT_TYPE_RIGHT_MIDDLE"}(rt||(rt={})),function(t){t.SD="sd",t.HD="hd",t.SHD="shd",t.FHD="fhd",t.UHD="uhd",t.HDR10="hdr10",t.DOLBY_VISION="dolby"}(nt||(nt={}));var st,dt=((F={})[nt.SD]=nt.HD,F[nt.HD]=nt.HD,F[nt.SHD]=nt.SHD,F[nt.FHD]=nt.FHD,F[nt.UHD]=nt.FHD,F[nt.HDR10]=nt.FHD,F[nt.DOLBY_VISION]=nt.FHD,F),lt=((st={})[J.UNKNOWN]="unknown",st[J.PRE]="pre",st[J.BROADCAST]="broadcast",st[J.TAIL]="tail",st[J.LOADING]="loading",st[J.MID]="mid",st[J.HLS_MID]="hls_mid",st[J.CORNER]="corner",st[J.VIDEO_IN]="video_in",st[J.ANCHOR_EMPTY]="anchor_empty",st[J.VIDEO_RESOLUTION]="video_resolution",st[J.PROGRESS_PREVIEW]="progress_preview",st[J.PAUSE]="pause",st[J.CREATIVE_MID]="czc",st[J.WATCH_BUY]="bs",st[J.LIVE_CORNER]="plj",st[J.NON_STANDARD]="non_standard",st[J.DYNAMIC_MID]="mid",st);var pt,ct,ut={getAdScene:function(t){var e;return null!==(e=ut.jsonParse(t).ad_scene)&&void 0!==e?e:"parse error"},jsonParse:function(t){try{return JSON.parse(t)}catch(e){return{data:t,error:"json parse error"}}},parseProxyAdResponse:function(t,e){var o,i;if(!t.ad_scene)return{ad_scene:null!=e?e:-1,strategy_ids:t.strategy_ids};var r={};switch(t.ad_scene){case W.PRE:case W.TAIL:case W.DYNAMIC_MID:r=function(t){var e,o={};return null===(e=t.ads)||void 0===e||e.forEach((function(t){var e,i,r=lt[t.ad_type];if(r){o[r]||(o[r]={ad_type:t.ad_type,empty:null!==(i=null===(e=t.empty)||void 0===e?void 0:e.length)&&void 0!==i?i:0,orders:0});var n=t[r];n&&(o[r].orders=n.length)}})),o}(t);break;case W.ANCHOR:r=function(t){var e,o={};return null===(e=t.anchor_ads)||void 0===e||e.forEach((function(t){var e,i,r=lt[t.ad_type];if(r){o[r]||(o[r]={ad_type:t.ad_type,empty:null!==(i=null===(e=t.empty)||void 0===e?void 0:e.length)&&void 0!==i?i:0,orders:0});var n=t[r];n&&(o[r].orders=n.length)}})),o}(t);break;case W.PROGRESS_PREVIEW:case W.VIDEO_RESOLUTION:case W.PAUSE:r=function(t){var e={},o=t.ad;if(!o)return e;var i=lt[o.ad_type];return i?(e[i]||(e[i]={ad_type:o.ad_type,empty:o.empty?1:0,orders:0}),o[i]&&(e[i].orders=1),e):e}(t)}var n=Object.values(r).some((function(t){return t.orders>0}))?"0":"1";return{ad_scene:null!==(i=null!==(o=t.ad_scene)&&void 0!==o?o:e)&&void 0!==i?i:-1,ad_data:r,is_empty:n,strategy_ids:t.strategy_ids}}};function ht(t,e){var o=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(o>>16)<<16|65535&o}function ft(t,e,o,i,r,n){return ht(function(t,e){return t<<e|t>>>32-e}(ht(ht(e,t),ht(i,n)),r),o)}function vt(t,e,o,i,r,n,a){return ft(e&o|~e&i,t,e,r,n,a)}function mt(t,e,o,i,r,n,a){return ft(e&i|o&~i,t,e,r,n,a)}function yt(t,e,o,i,r,n,a){return ft(e^o^i,t,e,r,n,a)}function _t(t,e,o,i,r,n,a){return ft(o^(e|~i),t,e,r,n,a)}function gt(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var o,i,r,n,a,s=1732584193,d=-271733879,l=-1732584194,p=271733878;for(o=0;o<t.length;o+=16)i=s,r=d,n=l,a=p,s=vt(s,d,l,p,t[o],7,-680876936),p=vt(p,s,d,l,t[o+1],12,-389564586),l=vt(l,p,s,d,t[o+2],17,606105819),d=vt(d,l,p,s,t[o+3],22,-1044525330),s=vt(s,d,l,p,t[o+4],7,-176418897),p=vt(p,s,d,l,t[o+5],12,1200080426),l=vt(l,p,s,d,t[o+6],17,-1473231341),d=vt(d,l,p,s,t[o+7],22,-45705983),s=vt(s,d,l,p,t[o+8],7,1770035416),p=vt(p,s,d,l,t[o+9],12,-1958414417),l=vt(l,p,s,d,t[o+10],17,-42063),d=vt(d,l,p,s,t[o+11],22,-1990404162),s=vt(s,d,l,p,t[o+12],7,1804603682),p=vt(p,s,d,l,t[o+13],12,-40341101),l=vt(l,p,s,d,t[o+14],17,-1502002290),s=mt(s,d=vt(d,l,p,s,t[o+15],22,1236535329),l,p,t[o+1],5,-165796510),p=mt(p,s,d,l,t[o+6],9,-1069501632),l=mt(l,p,s,d,t[o+11],14,643717713),d=mt(d,l,p,s,t[o],20,-373897302),s=mt(s,d,l,p,t[o+5],5,-701558691),p=mt(p,s,d,l,t[o+10],9,38016083),l=mt(l,p,s,d,t[o+15],14,-660478335),d=mt(d,l,p,s,t[o+4],20,-405537848),s=mt(s,d,l,p,t[o+9],5,568446438),p=mt(p,s,d,l,t[o+14],9,-1019803690),l=mt(l,p,s,d,t[o+3],14,-187363961),d=mt(d,l,p,s,t[o+8],20,1163531501),s=mt(s,d,l,p,t[o+13],5,-1444681467),p=mt(p,s,d,l,t[o+2],9,-51403784),l=mt(l,p,s,d,t[o+7],14,1735328473),s=yt(s,d=mt(d,l,p,s,t[o+12],20,-1926607734),l,p,t[o+5],4,-378558),p=yt(p,s,d,l,t[o+8],11,-2022574463),l=yt(l,p,s,d,t[o+11],16,1839030562),d=yt(d,l,p,s,t[o+14],23,-35309556),s=yt(s,d,l,p,t[o+1],4,-1530992060),p=yt(p,s,d,l,t[o+4],11,1272893353),l=yt(l,p,s,d,t[o+7],16,-155497632),d=yt(d,l,p,s,t[o+10],23,-1094730640),s=yt(s,d,l,p,t[o+13],4,681279174),p=yt(p,s,d,l,t[o],11,-358537222),l=yt(l,p,s,d,t[o+3],16,-722521979),d=yt(d,l,p,s,t[o+6],23,76029189),s=yt(s,d,l,p,t[o+9],4,-640364487),p=yt(p,s,d,l,t[o+12],11,-421815835),l=yt(l,p,s,d,t[o+15],16,530742520),s=_t(s,d=yt(d,l,p,s,t[o+2],23,-995338651),l,p,t[o],6,-198630844),p=_t(p,s,d,l,t[o+7],10,1126891415),l=_t(l,p,s,d,t[o+14],15,-1416354905),d=_t(d,l,p,s,t[o+5],21,-57434055),s=_t(s,d,l,p,t[o+12],6,1700485571),p=_t(p,s,d,l,t[o+3],10,-1894986606),l=_t(l,p,s,d,t[o+10],15,-1051523),d=_t(d,l,p,s,t[o+1],21,-2054922799),s=_t(s,d,l,p,t[o+8],6,1873313359),p=_t(p,s,d,l,t[o+15],10,-30611744),l=_t(l,p,s,d,t[o+6],15,-1560198380),d=_t(d,l,p,s,t[o+13],21,1309151649),s=_t(s,d,l,p,t[o+4],6,-145523070),p=_t(p,s,d,l,t[o+11],10,-1120210379),l=_t(l,p,s,d,t[o+2],15,718787259),d=_t(d,l,p,s,t[o+9],21,-343485551),s=ht(s,i),d=ht(d,r),l=ht(l,n),p=ht(p,a);return[s,d,l,p]}function At(t){var e,o="",i=32*t.length;for(e=0;e<i;e+=8)o+=String.fromCharCode(t[e>>5]>>>e%32&255);return o}function Et(t){var e,o=[];for(o[(t.length>>2)-1]=void 0,e=0;e<o.length;e+=1)o[e]=0;var i=8*t.length;for(e=0;e<i;e+=8)o[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return o}function It(t){var e,o,i="0123456789abcdef",r="";for(o=0;o<t.length;o+=1)e=t.charCodeAt(o),r+=i.charAt(e>>>4&15)+i.charAt(15&e);return r}function Ct(t){return unescape(encodeURIComponent(t))}function Tt(t){return function(t){return At(gt(Et(t),8*t.length))}(Ct(t))}function xt(t,e){return function(t,e){var o,i,r=Et(t),n=[],a=[];for(n[15]=a[15]=void 0,r.length>16&&(r=gt(r,8*t.length)),o=0;o<16;o+=1)n[o]=909522486^r[o],a[o]=1549556828^r[o];return i=gt(n.concat(Et(e)),512+8*e.length),At(gt(a.concat(i),640))}(Ct(t),Ct(e))}function bt(t,e,o){return e?o?xt(e,t):function(t,e){return It(xt(t,e))}(e,t):o?Tt(t):function(t){return It(Tt(t))}(t)}!function(t){t.ADVERTISER_LOGO="1002",t.ADVERTISER_NAME="1003",t.AD_TITLE="1011",t.AD_VIEW_AREA="1014",t.AD_DETAIL="1024",t.LD_DOWNLOAD_BANNER="1025",t.AD_ACTION_BUTTON="1021"}(pt||(pt={})),function(t){t.VIDEO_START_PLAY="ad_pc_playbox_player_start_play",t.VIDEO_PAUSE="ad_pc_playbox_player_pause",t.VIDEO_NEAR_END="ad_pc_playbox_player_near_end",t.REQUEST_FIXED_MIDDLE="ad_pc_playbox_sdk_req_fixed_zc",t.REQUEST_DYNAMIC_MIDDLE="ad_pc_playbox_sdk_req_dynamically_zc",t.CALL_GET_AD_PARAMS="ad_pc_playbox_player_call_sdk",t.PROXY_REQUEST="ad_pc_playbox_player_request",t.PROXY_RESPONSE="ad_pc_playbox_player_response",t.SET_AD_ORDER="ad_pc_playbox_plugin_get_order",t.AD_CREATED="ad_pc_playbox_receive_order",t.AD_ENDED="ad_pc_playbox_exposure_close",t.AD_LOADED="ad_pc_playbox_creative_loading",t.AD_SHOW="ad_pc_playbox_plugin_ad_show",t.AD_EXPOSURE="originalexposure",t.AD_CLICK="dt_clck",t.PICTURE="ad_pc_playbox_picture",t.TECH_PARAM="ad_tech_param_report",t.NON_STANDARD_EXPOSURE="ad_exposure_unnormal"}(ct||(ct={}));var Dt,Pt=160,Nt=90,wt="png",St=1;!function(t){t.EMPTY="0",t.AD_ERROR="1",t.CORS_ERROR="2",t.NOT_SUPPORT="3",t.SCRIPT_ERROR="4"}(Dt||(Dt={}));var Ot=function(t){if(!t)return"unknown";var e=t.toLowerCase(),o=-1,i=e.match(/(?:metasr.\d*|qqlive.\d*|qqbrowser.\d*|maxthon.\d*|theworld|lbbrowser|firefox.\d*|opera.\d*|bidubrowser.\d*)/);if(null!==i)return i[0].replace(" ","").replace("/","");if(e.indexOf("android")>-1)return"android";if(e.indexOf("iphone")>-1)return"iphone";if(e.indexOf("ipad")>-1)return"ipad";if((o=e.indexOf("chrome"))>-1)return"chrome".concat(parseInt(e.substr(o+7,4),10));if((o=e.indexOf("safari"))>-1)return"safari";var r=e.indexOf("msie");if(r>-1)return"ie".concat(parseInt(e.substr(r+5,2),10));if(e.indexOf("trident")>-1){var n=e.indexOf("rv:");if(n>-1)return"ie".concat(parseInt(e.substr(n+3,2),10))}return e}(window.navigator.userAgent);function Lt(t){var e=t.video,o=t.adInfo;return new Promise((function(t,i){if(o.isEmpty)i(Dt.EMPTY);else if(!e||(null==e?void 0:e.error)&&e.error.code)i(Dt.AD_ERROR);else{var r=function(){try{var t=window.URL||window.webkitURL||window.mozURL||window.msURL,e=new Blob(["self.onmessage = function(res) {var data = res.data;var imageData = data.imageData;var width = data.width;var height = data.height;var chunkLength = width * height;for (var i = 0; i < chunkLength * 4; i = i + 4) {var gray = parseInt((imageData.data[i] + imageData.data[i + 1] + imageData.data[i + 2]) / 3);imageData.data[i] = imageData.data[i + 1] = imageData.data[i + 2] = gray;}try { postMessage(imageData); } catch(e) {console.log(e)}}"],{type:"application/javascript"}),o=t.createObjectURL(e);return new Worker(o)}catch(t){return null}}();if(r&&"safari"!==Ot){var n=function(){var t=document.createElement("canvas");t.setAttribute("width","".concat(Pt)),t.setAttribute("height","".concat(Nt)),t.style.cssText="width:".concat(Pt,"px;height:").concat(Nt,"px;");var e=t.getContext("2d");return{canvas:t,ctx:e}}(),a=n.ctx,s=n.canvas;if(e&&s&&a){try{a.drawImage(e,0,0,Pt,Nt);var d=a.getImageData(0,0,Pt,Nt);r.postMessage({imageData:d,width:Pt,height:Nt})}catch(t){return void i(Dt.CORS_ERROR)}r.onmessage=function(e){a.putImageData(e.data,0,0);var o=s.toDataURL("image/".concat(wt),St);t({imageData:o})},r.onerror=function(){i(Dt.SCRIPT_ERROR)}}else i(Dt.EMPTY)}else i(Dt.NOT_SUPPORT)}}))}function Vt(t){var e=t.flowid,o=t.platform,i=t.guid,r=t.vid,n=Date.now();return bt("adsafe".concat(n).concat(e).concat(i).concat(o).concat(r))}var Rt=/android|iPod|ipad|iPhone|mobile/i;var Mt=function(t){var e,o,i;t=(t=t||navigator.userAgent).toLowerCase(),this.browser={},this.os={},this.mobile=!1,this.spider=!1,Rt.test(t)&&(this.mobile=!0),/(googlebot|bingbot|yandex|twitterbot|facebookexternalhit|rogerbot|linkedinbot|embedly|quora link preview|showyoubot|outbrain|pinterest\/0\.|pinterestbot|slackbot|vkShare|W3C_Validator|whatsapp|petalbot|applebot|mpcrawler|spider)/i.test(t)&&(this.spider=!0);for(var r,n,a={android_1:/android[\s\/]([\d\.]+)/i,android_2:/android/i,android_3:/MIDP-/i,ipod_1:/iPod\stouch;\sCPU\siPhone\sos\s([\d_]+)/i,ipod_100:/iPod.*os\s?([\d_\.]+)/i,iphone:/iPhone;\sCPU\siPhone\sos\s([\d_]+)/i,iphone_100:/iPhone.*os\s?([\d_\.]+)/i,ipad_1:/ipad;\scpu\sos\s([\d_]+)/i,ipad_2:/ipad([\d]+)?/i,windows:/windows\snt\s([\d\.]+)/i,mac:/Macintosh.*mac\sos\sx\s([\d_\.]+)/i,linux:/Linux/i},s=Object.keys(a),d=0,l=s.length;d<l;d++){var p=s[d];if(r=a[p].exec(t)){n=p.replace(/_\d+/,""),this.os[n]=!0,this.os.osName=n,r[1]&&(this.os.version=r[1].replace(/_/g,"."));break}}(this.os.iphone||this.os.ipad||this.os.ipod)&&(this.os.ios=!0);var c,u,h={wechat:/MicroMessenger\/([\d\.]+)/i,ipadqq:/IPadQQ\/([\d\.]+)/i,mqq:/qq\/([\d\.]+)/i,qzone:/QZONEJSSDK\/([\d\.]+)/i,mqqbrowser:/mqqbrowser\/([\d\.]+)/i,qqbrowser:/[^m]QQBrowser\/([\d\.]+)/i,x5:/tbs\/(\d+)/i,uc:/UCBrowser\/([\d\.]+)/i,safari_1:/Version\/(([\d\.]+))\sSafari\/[\d\.]+/i,safari_2:/Safari\/([\d\.]+)/i,chrome_1:/CriOS\/([\d\.]+)/i,chrome_2:/Chrome\/([\d\.]+)/i,firefox:/Firefox\/([\d\.]+)/i,ie_1:/MSIE\s([\d\.]+)/i,ie_2:/(trident\/\d\.\d)/i,ie_3:/(Edge)\/\d+\.\d+/i,weibo:/weibo__([\d\.]+)/i,qqnews:/qqnews\/([\d\.]+)/i,qqlive_1:/QQLiveBrowser\/([\d\.]+)/i,qqlive_2:/QQLiveHDBrowser\/([\d\.]+)/i,kuaibao:/qnreading\/([\d\.]+)/i,liebao:/LieBaoFast\/([\d\.]+)/i,douban:/com\.douban\.frodo\/([\d\.]+)/i,miuibrowser:/MiuiBrowser/i,baidu:/baiduboxapp/i,browser360:/360browser/i,oppobrowser:/OppoBrowser/i,qqdownloader:/qqdownloader\/([\d\.]+)/i},f=Object.keys(h),v=0;for(l=f.length;v<l;v++){var m=f[v];if(c=h[m].exec(t)){if(u=m.replace(/_\d+/,""),this.browser[u])return this;this.browser[u]={version:c[1]},this.browser.browserName=u,this.browser.version=c[1]}}return this.os.android&&this.browser.safari&&(this.browser.safari=null),this.browser.chrome&&this.browser.safari&&(this.browser.safari=null),(null===(i=null===(o=null===(e=this.browser)||void 0===e?void 0:e.ie)||void 0===o?void 0:o.version)||void 0===i?void 0:i.indexOf("trident"))>-1&&(this.browser.ie.version.indexOf("6.0")>-1?this.browser.ie.version="10":this.browser.ie.version.indexOf("5.0")>-1?this.browser.ie.version="9":this.browser.ie.version.indexOf("4.0")>-1?this.browser.ie.version="8":this.browser.ie.version="11"),this}.call({},navigator.userAgent),kt=function(t){var e=new RegExp("(?:^|;+|\\s+)".concat(t,"=([^;]*)")),o=document.cookie.match(e);return o?o[1]:""};function Ut(t,e,o){var i=document.createElement("script");i.type="text/javascript",i.charset="UTF-8",(null==o?void 0:o.crossOrigin)&&(i.crossOrigin=o.crossOrigin),i.src=t;var r=!1;if(i.onerror=function(t){r=!0,e({src:t.target.src,error:{type:"jserror",code:404}})},i.addEventListener?i.addEventListener("load",(function(){r=!0,e()}),!1):i.attachEvent&&i.attachEvent("onreadystatechange",(function(){"complete"===window.event.srcElement.readyState&&(r=!0,e())})),null==o?void 0:o.doc){var n=document.createElement("base");n.href=i.src.match(/.+\//)[0],o.doc.getElementsByTagName("head")[0].appendChild(n)}(null==o?void 0:o.dom)?o.dom.appendChild(i):document.getElementsByTagName("head")[0].appendChild(i),setTimeout((function(){var o=!1;r||(!o&&e({src:t,error:{type:"js timeout",code:502}}),o=!0)}),5e3)}var Bt=function(){function t(){this.logger=V("VrReporter"),this.pgid="ad_plugin",this.appKey="JS0081LY3JY6J3",this.publicParams={},this.pageParams={},this.businessParams={},this.reportList=[],this.isLoadError=!1,this.strategyIds=[],this.initReport()}return t.prototype.setOuterApi=function(t){this.outerApi=t},t.prototype.setIsVip=function(t){this.publicParams=n(n({},this.publicParams),{is_vip:t})},t.prototype.setStrategyIds=function(t){this.strategyIds=Array.from(new Set(l(l([],this.strategyIds,!0),t,!0)))},t.prototype.updateParams=function(t){var e;this.publicParams=n(n({},this.publicParams),{v_channel_id:t.platform.channel_id,pt:t.player.play_type,app_vr:t.player.plugin,dt_mainlogin:null===(e=t.token)||void 0===e?void 0:e.type,dt_guid:t.platform.guid,guid:t.platform.guid}),this.pageParams=n(n({},this.pageParams),{play_platform:t.platform.play_platform,platform:t.platform.platform,flow_id:t.video.flow_id,live:t.video.is_live?"1":"0",pg_vid:t.video.base.vid,vid:t.video.base.vid,pg_cid:t.video.base.cid,pg_lid:t.video.base.lid,pid:t.video.pid}),this.businessParams=n(n({},this.businessParams),{flow_id:t.video.flow_id})},t.prototype.reportNormalEvent=function(t,e,o){var i;this.report({pgid:this.pgid,eventName:t,eventTime:Date.now(),pageParams:this.getPageParams(),businessParams:n(n(n({},this.getBusinessParams()),{ad_report_params:this.getAdReportParamsFromOrder(e.data,e.orderIdx),adid:null===(i=e.auth)||void 0===i?void 0:i.adid}),o)})},t.prototype.reportEvent=function(t,e){t===ct.TECH_PARAM&&"client"!==this.pageParams.platform||this.report({pgid:this.pgid,eventName:t,eventTime:Date.now(),pageParams:this.getPageParams(),businessParams:n(n({},this.getBusinessParams()),e)})},t.prototype.getAdReportParamsFromOrder=function(t,e){var o,i;void 0===e&&(e=0);var r=null===(i=null===(o=t.order.vr_report_dict)||void 0===o?void 0:o[tt.COMMON])||void 0===i?void 0:i.report_dict;return n({ad_post_idx:e,type:t.order.ad_type},r)},t.prototype.getAdReportParams=function(t){var e=this,o=[];return t.empty.forEach((function(t,e){var i=t.getVrReportData();o.push(n({ad_post_idx:e,type:t.adType},i))})),t.orders.forEach((function(t){o.push(e.getAdReportParamsFromOrder(t.data,t.orderIdx))})),o},t.prototype.getBusinessParams=function(){return n(n({},this.businessParams),{ad_request_id:this.outerApi.playerData.playerFlowid,business:"ad",strategy_ids:this.strategyIds})},t.prototype.getPageParams=function(){var t=this.outerApi,e=t.videoPlayData,o=t.isMobile;return n({is_mobile:o?"1":"0",guid:this.outerApi.playerData.playerGuid,pgid:this.pgid,playtime:e.playtime,host:window.location.host,ua:window.navigator.userAgent},this.pageParams)},t.prototype.getPublicParams=function(){var t=kt("vqq_vuserid");return n(n({lm_experiment_id:"-1",vuserid:t||"-1",ctime:Date.now()},this.publicParams),{is_vip:t?this.publicParams.isVip?1:0:-1})},t.prototype.report=function(t){if(!Mt.spider)if(this.reporter)try{this.reporter.reportEvent(n(n({},t),{publicParams:this.getPublicParams()}))}catch(t){this.logger.error("大同上报出错")}else this.isLoadError||this.reportList.push(t)},t.prototype.initReport=function(){return s(this,void 0,void 0,(function(){var t;return d(this,(function(e){switch(e.label){case 0:return[4,this.loadUniversalReport()];case 1:e.sent();try{this.reporter=new window.UniversalReport({beacon:this.appKey,channel:"beacon",formatMode:1,isDisableInitPage:!0,isDisableObserver:!0})}catch(t){this.logger.error("UniversalReport 初始化失败")}for(;this.reportList.length>0;)t=this.reportList.shift(),this.report(t);return[2]}}))}))},t.prototype.loadUniversalReport=function(){return s(this,void 0,void 0,(function(){var t=this;return d(this,(function(e){return window.UniversalReport?[2,window.UniversalReport]:[2,new Promise((function(e){Ut("https://staticfile.qq.com/datong/universalReportH5/v1.0.3/universal-report-lite.min.js",(function(o){if(null==o?void 0:o.error)return t.logger.warn("加载大同 sdk 失败"),t.isLoadError=!0,void(t.reportList=[]);window.UniversalReport&&e(window.UniversalReport)}),{crossOrigin:"anonymous"})}))]}))}))},t}(),zt=new Bt,Ht={reportVideoStartPlay:function(){zt.reportEvent(ct.VIDEO_START_PLAY,{})},reportVideoPause:function(){zt.reportEvent(ct.VIDEO_PAUSE,{})},reportVideoNearEnd:function(){zt.reportEvent(ct.VIDEO_NEAR_END,{})},reportRequestFixedMiddle:function(){zt.reportEvent(ct.REQUEST_FIXED_MIDDLE,{})},reportRequestDynamicMiddle:function(){zt.reportEvent(ct.REQUEST_DYNAMIC_MIDDLE,{})},reportCallGetAdParams:function(t){zt.reportEvent(ct.CALL_GET_AD_PARAMS,t)},reportRequest:function(t){zt.reportEvent(ct.PROXY_REQUEST,t)},reportResponse:function(t){zt.reportEvent(ct.PROXY_RESPONSE,t)},reportSetAdOrder:function(t){var e=ut.parseProxyAdResponse(t);zt.reportEvent(ct.SET_AD_ORDER,e)},reportCreated:function(t,e){var o,i=n({ad_type:t.adType,ad_report_params:zt.getAdReportParams(t),adid:null===(o=t.auth)||void 0===o?void 0:o.adid},e);zt.reportEvent(ct.AD_CREATED,i)},reportLoaded:function(t,e,o){var i={};Object.entries(e).forEach((function(t){var e=t[0],o=t[1],r=e.replace(/([A-Z])/g,"_$1").toLowerCase();i[r]=o})),i.ad_type=t.adType,i.loading_time=i.loading_time||-1,i.material_duration&&(i.material_duration=1e3*i.material_duration),zt.reportNormalEvent(ct.AD_LOADED,t,n(n({},i),o))},reportAdShow:function(t,e,o){zt.reportNormalEvent(ct.AD_SHOW,t,n({material_type:e},o))},reportClick:function(t,e,o){var i=e.actionType,r=e.playTime,s=a(e,["actionType","playTime"]);zt.reportNormalEvent(ct.AD_CLICK,t,n(n({ad_type:t.adType,ad_playtime:r,ad_act_type:i},s),o))},reportPicture:function(t,e){var o,i,r,n=e.video,a=e.time,l=e.vid;return s(this,void 0,void 0,(function(){var e,s,p,c,u;return d(this,(function(d){switch(d.label){case 0:d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Lt({video:n,adInfo:t})];case 2:return p=d.sent(),e=p.imageData,[3,4];case 3:return c=d.sent(),s=c,[3,4];case 4:return u=zt.outerApi.playerData,zt.reportNormalEvent(ct.PICTURE,t,{crc:Vt({vid:l,guid:null!==(o=u.playerGuid)&&void 0!==o?o:"",platform:null!==(i=u.playerPlatform)&&void 0!==i?i:"",flowid:null!==(r=u.playerFlowid)&&void 0!==r?r:""}),ad_pdata:e,error_code:s,time:a}),[2]}}))}))},reportExposure:function(t,e,o){void 0===e&&(e=!0),zt.reportNormalEvent(ct.AD_EXPOSURE,t,n({ad_type:t.adType,is_first_exposure:e?"1":"0"},o))},reportEnded:function(t,e,o){var i;zt.reportEvent(ct.AD_ENDED,n(n({ad_type:t.adType,ad_report_params:zt.getAdReportParams(t),adid:null===(i=t.auth)||void 0===i?void 0:i.adid},e),o))},reportTechParam:function(t){void 0===t&&(t={}),zt.reportEvent(ct.TECH_PARAM,n({plugin:"new"},t))},reportNonStandard:function(t){void 0===t&&(t={}),zt.reportEvent(ct.NON_STANDARD_EXPOSURE,n({},t))}},$t=["width","height","left","right","top","bottom"],Kt="txp_none",Gt={},Yt=1,Ft=function(t,e){if(!e||!e.trim())return!1;var o=e.split(" "),i=t.className.split(" "),r=!0;return o.forEach((function(t){return!(!t||-1!==i.indexOf(t))&&(r=!1,!0)})),r},Wt=function(t,e){if(t&&e&&e.trim())return e.split(" ").forEach((function(e){!function(t,e){if(Ft(t,e)){var o=t.className.split(" "),i=o.indexOf(e);o.splice(i,1);var r=t;r.className=o.join(" "),r.className}}(t,e)})),t.className},qt=function(t,e){if(!t)return"";if(!e||Ft(t,e))return t.className;var o=t;if(!t.className||0===t.className.length)return o.className=e,e;var i=t.className.split(" ");return i.push(e),o.className=i.join(" "),t.className},jt=function(t,e){var o=t.zid;return o&&Gt[o]?Gt[o][e]:[]},Qt=function(t,e){var o=t.zid;o&&Gt[o]&&(e?delete Gt[o][e]:delete Gt[o])},Jt=function(t,e,o,i){if(void 0===i&&(i=!1),"function"==typeof t.removeEventListener)t.removeEventListener(e,o,i);else if("function"==typeof t.detachEvent)t.detachEvent("on".concat(e),o,i);else{t["on".concat(e)]=null}},Xt=function(t){return Object.entries(t).map((function(t){var e=t[0],o=t[1];return"".concat(e,": ").concat(o,";")})).join("")},Zt=function(t,e,o){if(!t)return"";var i=t;return e?void 0===o?i.getAttribute(e):(i.setAttribute(e,o),o):""},te=function(t,e){t&&e&&t.removeAttribute(e)},ee=function(t,e,o){if(!t||!e)return"";if(void 0===o&&"string"==typeof e){var i={};try{i=document.defaultView.getComputedStyle(t,null)}catch(e){i=t.currentStyle}return i[e]}if("object"==typeof e){var r=e,n=t;Object.entries(r).forEach((function(t){var e=t[0],o=t[1],i=o;$t.includes(e)&&"number"==typeof o&&(i="".concat(o,"px")),n.style[e]=i}))}"string"==typeof e&&"string"==typeof o&&(t.style[e]=/width|height|left|right|top|bottom/i.test(e)&&"number"==typeof o?"".concat(o,"px"):o)},oe=qt,ie=Wt,re=function(t){t&&qt(t,Kt)},ne=function(t){Wt(t,Kt)},ae=function(t,e,o,i){if(void 0===i&&(i=!1),t&&(function(t){if(t.zid)return t.zid;Yt+=1,t.zid=Yt}(t),e&&o)){var r=function(t,e,o){var i=t.zid,r={evt:e};return Gt[i]||(Gt[i]={}),r.cb=function(t){o(t)},Gt[i][e]||(Gt[i][e]=[]),Gt[i][e].push(r),r}(t,e,o);if("function"==typeof t.addEventListener)t.addEventListener(e,r.cb,i);else if("function"==typeof t.attachEvent)t.attachEvent(e,r.cb,i);else{t["on".concat(e)]=r.cb}}},se=function(t,e,o,i){if(void 0===i&&(i=!1),t&&e)if(2===arguments.length){var r=jt(t,e)||[];r.forEach((function(e){Jt(t,e.evt,e.cb,!1)})),Qt(t,e)}else arguments.length>2&&Jt(t,e,o,i)},de=function(t,e){var o=t;if(o)return void 0!==e&&(o.innerText=e),o.innerText},le=function(t,e){var o=t;if(o)return void 0!==e&&(o.innerHTML=e),o.innerHTML};var pe,ce,ue=function(t){function i(e){var o=t.call(this,e)||this;return o.reportMethod=void 0,o.destroyEvents=[],o.playerMemoryData=null,o.isMiniPlayerOpened=!1,o.options=e,o.plugin=e.plugin,o.initEvents(),o}return r(i,t),i.prototype.setOptions=function(t){this.options=n(n({},this.options),t),this.plugin=this.options.plugin},Object.defineProperty(i.prototype,"videoPlayData",{get:function(){var t;return{volume:this.plugin.player.volume,duration:this.plugin.player.duration,playerVid:"".concat(this.plugin.player.vid),playtime:(this.plugin.player.playtime||0)+(this.options.soloPlayPhlsTimeOffset||0)/1e3,type:null===(t=this.plugin.player.config)||void 0===t?void 0:t.type,state:this.plugin.player.state}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isMimiPlayer",{get:function(){return this.isMiniPlayerOpened},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"sessionId",{get:function(){var t,e;return null!==(e=null===(t=this.plugin.player.getCommonKv("getinfoAdInfo"))||void 0===t?void 0:t.adsid)&&void 0!==e?e:""},enumerable:!1,configurable:!0}),i.prototype.emitAdBlockEnabledChange=function(t){this.plugin.adBlockEnabled=t},i.prototype.showOpenVIPGuide=function(){var t,e;null===(e=(t=this.options.playerMethod).showOpenVIPGuide)||void 0===e||e.call(t)},i.prototype.getEvents=function(){var t,o=this;return(t={})[B.SET_LOADING]=function(t){var i=function(e){t(e.data)};o.plugin.player.pluginMsg.on(e.H5_EXT_EVENT.SET_LOADING,i),o.destroyEvents.push((function(){o.plugin.player.pluginMsg.off(e.H5_EXT_EVENT.SET_LOADING,i)}))},t[B.VIDEO_TIMEUPDATE]=function(t){o.listenPlayerEvent(e.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,t)},t[B.VIDEO_PLAYING]=function(t){o.plugin.player.on(e.H5_PLAY_EVENT.VIDEO_PLAYING,(function(e){var o;!0===(null===(o=e.data)||void 0===o?void 0:o.isFirst)&&Ht.reportVideoStartPlay(),t(e.data)}))},t[B.VIDEO_PAUSE]=function(t){o.plugin.player.on(e.H5_PLAY_EVENT.VIDEO_PAUSE,(function(e){Ht.reportVideoPause(),t(e.data)}))},t[B.CTRL_SHOW]=function(t){o.listenCtrlBarEvent("ctrl:show",t)},t[B.CTRL_HIDE]=function(t){o.listenCtrlBarEvent("ctrl:hide",t)},t[B.HOVER_PROGRESS]=function(t){o.listenCtrlBarEvent("ctrl:hover-progress",t)},t[B.SHOW_LEVELS]=function(t){o.listenCtrlBarEvent("ctrl:show-levels",t)},t[B.TOGGLE_MINI_PLAYER]=function(t){var e,i,r=function(e){o.isMiniPlayerOpened!==e.data.isOpened&&(o.isMiniPlayerOpened=e.data.isOpened,t(e.data))};null===(i=null===(e=o.plugin.player)||void 0===e?void 0:e.miniPlayerPlugin)||void 0===i||i.on("toggle",r),o.destroyEvents.push((function(){var t,e;null===(e=null===(t=o.plugin.player)||void 0===t?void 0:t.miniPlayerPlugin)||void 0===e||e.off("toggle",r)}))},t[B.AD_SESSION_ID_CHANGE]=function(t){var i=function(e){var i,r,n,a;"0"===(null===(i=e.data)||void 0===i?void 0:i.code)&&((null!==(r=o.playerData.playerSessionId)&&void 0!==r?r:"")!==(null!==(a=null===(n=o.plugin.player.getCommonKv("getinfoAdInfo"))||void 0===n?void 0:n.adsid)&&void 0!==a?a:"")&&t(e.data))};o.plugin.player.on(e.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,i),o.destroyEvents.push((function(){o.plugin.player.off(e.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,i)}))},t[B.VIDEO_PLAY_SESSION_END]=function(t){o.listenPlayerEvent(e.H5_PLAY_EVENT.PLAY_SESSION_END,t)},t[B.VIDEO_SETLEVEL_END]=function(t){o.listenPlayerEvent(e.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,t)},t},i.prototype.prependEmbedAd=function(t,e,o){switch(t){case J.LOADING:this.safePrependEle("ui-loading","prependElement",e);break;case J.PROGRESS_PREVIEW:this.safePrependEle("ui-preview","prependElement",e),this.safePrependEle("ui-preview-list","prependElement",o,"current");break;case J.VIDEO_RESOLUTION:this.safePrependEle("ctrlbar","prependElementToLevels",e)}},i.prototype.getPlayerSize=function(){var t=this.plugin.player,e=t.container,o=t.currentVideoElement,i=(null==o?void 0:o.offsetWidth)||(null==e?void 0:e.offsetWidth),r=(null==o?void 0:o.offsetHeight)||(null==e?void 0:e.offsetHeight),n=this.plugin.player.videoSize;return{playerWidth:i,playerHeight:r,playerOWidth:n.width,playerOHeight:n.height}},i.prototype.requestProxyHttp=function(t,e){var o,i;return s(this,void 0,void 0,(function(){return d(this,(function(r){return t===W.ANCHOR&&this.requestMidRollAd(),[2,null===(i=null===(o=this.options)||void 0===o?void 0:o.requestProxyHttp)||void 0===i?void 0:i.call(o,t,e)]}))}))},i.prototype.getCtrlBarSize=function(){var t,e,o,i=null===(o=null===(e=null===(t=this.plugin.player)||void 0===t?void 0:t.plugins)||void 0===e?void 0:e.ctrlbar)||void 0===o?void 0:o.el;if(i)return{width:i.offsetWidth,height:i.offsetHeight}},i.prototype.capturePlayer=function(){return Promise.resolve()},i.prototype.shrinkVideoContainer=function(t,e){var o,i=this.plugin.player.videoElementsContainer;if(!i)return Promise.reject();var r=(null!==(o=i.parentElement)&&void 0!==o?o:i).getBoundingClientRect();if(this.playerMemoryData)return this.resizeVideoContainer(t,e);this.playerMemoryData={cssText:i.style.cssText,rect:r};var n=["width","height","top","left"].map((function(t){return"".concat(t," 200ms cubic-bezier(0.4, 0, 0.2, 1)")})).join(",");return ee(i,{transition:n,width:"".concat(r.width,"px"),height:"".concat(r.height,"px"),zIndex:"1001",backgroundColor:"#000"}),this.resizeVideoContainer(t,e)},i.prototype.resizeVideoContainer=function(t,e){var o,i=this,r=this.plugin.player.videoElementsContainer;if(!r||!this.playerMemoryData)return Promise.reject();var n=(null!==(o=r.parentElement)&&void 0!==o?o:r).getBoundingClientRect();return new Promise((function(o){var a,s={width:Math.floor(n.width*e),height:Math.floor(n.height*e),top:16,left:16};switch(t){case rt.SPLIT_TYPE_LEFT_TOP:s.top=16,s.left=16;break;case rt.SPLIT_TYPE_LEFT_MIDDLE:s.top=n.height/2-s.height/2,s.left=16;break;case rt.SPLIT_TYPE_LEFT_BOTTOM:s.top=n.height-s.height-16,s.left=16;break;case rt.SPLIT_TYPE_RIGHT_MIDDLE:s.top=n.height/2-s.height/2,s.left=n.width-s.width-16}if(function(t,e){if(!t||!e)return!1;var o=Object.keys(t),i=Object.keys(e);return o.length===i.length&&o.every((function(o){return t[o]===e[o]}))}(s,null===(a=i.playerMemoryData)||void 0===a?void 0:a.sizeAndPosition))return o(s);ee(r,{width:"".concat(s.width,"px"),height:"".concat(s.height,"px"),top:"".concat(s.top,"px"),left:"".concat(s.left,"px"),borderRadius:"12px",overflow:"hidden"}),i.playerMemoryData.sizeAndPosition=s;var d=function(){r.removeEventListener("transitionend",d),o(s)};r.addEventListener("transitionend",d)}))},i.prototype.resetVideoContainer=function(t){var e=this,o=this.plugin.player.videoElementsContainer;if(!o||!this.playerMemoryData)return Promise.reject();var i=o.parentElement.getBoundingClientRect();return ee(o,{width:"".concat(i.width,"px"),height:"".concat(i.height,"px"),top:"0",left:"0"}),new Promise((function(i){var r=function(){if(o.removeEventListener("transitionend",r),e.playerMemoryData&&(o.style.cssText=e.playerMemoryData.cssText,e.playerMemoryData=null),t)try{e.plugin.player.play()}catch(t){}i()};o.addEventListener("transitionend",r)}))},i.prototype.destroy=function(){this.destroyEvents.forEach((function(t){t()}))},i.prototype.launchMiniProgram=function(){return!1},i.prototype.safePrependEle=function(t,e,o,i){var r;void 0===i&&(i="container");var n=this.plugin.player;(null===(r=n.plugins[t])||void 0===r?void 0:r[e])&&"function"==typeof n.plugins[t][e]?n.plugins[t][e](o,i):n.pluginMsg.on("pluginsetup:".concat(t),(function(){n.plugins[t][e](o,i)}))},i.prototype.getCtrlBar=function(){var t=this;return new Promise((function(e){var o=t.plugin.player,i=o.plugins.ctrlbar;if(i)e(i);else{var r=function(){e(o.plugins.ctrlbar),o.pluginMsg.off("pluginsetup:ctrlbar",r)};o.pluginMsg.on("pluginsetup:ctrlbar",r)}}))},i.prototype.listenCtrlBarEvent=function(t,e){var o=this,i=function(){e({})};this.getCtrlBar().then((function(e){null==e||e.on(t,i),o.destroyEvents.push((function(){null==e||e.off(t,i)}))}))},i.prototype.listenPlayerEvent=function(t,e){var o=this,i=function(t){e(t.data)};this.plugin.player.on(t,i),this.destroyEvents.push((function(){o.plugin.player.off(t,i)}))},i.prototype.prepareMidRollAdRequestParam=function(){var t={pr:1,otype:"json",idlist:this.plugin.player.getCommonKv(e.COMMON_DATA_KEY.vid),vuid:o.cookieTool.get("vuserid")||o.cookieTool.get("vqq_vuserid")};if(1===this.phlsPlayType)return t;var i=this.plugin.player.getCommonKv("hlsAdRanges");return(null==i?void 0:i.length)>0&&(t.adsegments=JSON.stringify({ad_segments:i.map((function(t){return{start_time:t.start,duration:t.end-t.start}}))})),t},i.prototype.requestMidRollAd=function(){return s(this,void 0,void 0,(function(){var t,e,i;return d(this,(function(r){switch(r.label){case 0:t=Y?G:K,e=this.prepareMidRollAdRequestParam(),i={},r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,o.netTool.jsonp(t,{name:"thumbplayer_mr_ad_callback",query:e})];case 2:return i=r.sent(),[3,5];case 3:return r.sent(),[3,5];case 4:return this.plugin.player.emit("getVideoMarkAllOver",i),[7];case 5:return[2]}}))}))},i}(at);t.AdTypeV=void 0,(pe=t.AdTypeV||(t.AdTypeV={})).LD="LD",pe.HT="HT",pe.ZC="ZC",pe.CZC="CZC",pe.ZT="ZT",pe.KB="KB",pe.PSJ="PSJ",pe.PLJ="PLJ",pe.PPB="PPB",pe.PVL="PVL",pe.PDF="PDF",pe.BS="BS",pe.VIN="VIN",pe.PHLS="PHLS",pe.DER="DER",function(t){t.LD="WL",t.KB="WK",t.HT="WH"}(ce||(ce={}));var he=function(){function t(){this.beforeRequest=function(t){return!(!t.logs.msg.includes('"scope":')||!t.logs.msg.includes('"level":'))},this.initAegis()}return t.prototype.setOuterApi=function(t){var e,o;this.outerApi=t,null===(e=this.aegis)||void 0===e||e.setConfig({uin:null!==(o=this.outerApi.playerData.playerGuid)&&void 0!==o?o:""})},t.prototype.updateUin=function(t){var e;t&&(null===(e=this.aegis)||void 0===e||e.setConfig({uin:t}))},t.prototype.report=function(t){this.aegis&&this.aegis.infoAll(t)},t.prototype.reportEvent=function(t){this.aegis&&this.aegis.reportEvent(t)},t.prototype.initAegis=function(){var t,e,o,i;return s(this,void 0,void 0,(function(){return d(this,(function(r){return window.Aegis?(this.aegis=new window.Aegis({id:"YrDeWFbYKW7YWqzGaW",uin:null!==(e=null===(t=this.outerApi)||void 0===t?void 0:t.playerData.playerGuid)&&void 0!==e?e:"",pagePerformance:!1,reportApiSpeed:!1,reportAssetSpeed:!1,webVitals:!1,offlineLog:!0,delay:1e4,beforeRequest:this.beforeRequest}),this.aegis.setConfig({uin:null!==(i=null===(o=this.outerApi)||void 0===o?void 0:o.playerData.playerGuid)&&void 0!==i?i:""}),[2]):[2]}))}))},t}(),fe=new he,ve="3.4.15";function me(t,e){var o=t,i=function(t){if("object"==typeof t){var e=[];return Object.keys(t).forEach((function(o){e.push("".concat(o,"=").concat(t[o]))})),e.join("&")}return""}(e);return"string"==typeof t&&i&&(o+=(-1===t.indexOf("?")?"?":"&")+i),o}function ye(t,e){void 0===e&&(e=window.location.href);var o,i=new RegExp("(^|&|\\\\?)".concat(t,"=([^&]*)(&|$|#)"));return(o=e.match(i))?o[2]:""}function _e(){for(var t,e=document.location.toString().toLowerCase(),o="",i=["ptag","adtag","pgv_ref"],r=0,n=i.length;r<n&&!(o=ye(i[r],e));r++);if(!o)try{o=null!==(t=sessionStorage.getItem("ptag"))&&void 0!==t?t:""}catch(t){}if(!o){var a=function(t){if(null==t||""===t)return"";var e=document.createElement("a");return e.href=t,e.hostname}(document.referrer);a&&-1===["v.qq.com","film.qq.com","m.v.qq.com"].indexOf(a)&&(o=a.replace(/\./g,"_"))}return o||(o=kt("ptag")),o}var ge,Ae=function(t,e,o){var i=t;return e&&(i+=(-1===t.indexOf("?")?"?":"&")+function(t,e){var o=[];return Object.keys(t).forEach((function(i){var r=t[i];o.push("".concat(i,"=").concat(e?encodeURIComponent(r):r))})),o.join("&")}(e,o)),i},Ee=function(t,e){void 0===e&&(e={});var o=t;return Object.entries(e).forEach((function(t){var e=t[0],i=t[1];o=o.replace(e,i)})),o},Ie=function(){function t(){this.logger=V("OrderReporterHelper"),this.urlList=[],this.timer=null,this.imgObj=null}return Object.defineProperty(t.prototype,"config",{get:function(){var t=this.outerApi,e=t.playerData,o=t.videoPlayData.duration;return{from:e.playerFrom,pf:e.playerPf,v:e.playerVersion,dura:o,coverid:e.playerCid||"",pf_ex:e.playerPfEx,chid:e.playerChid||0,tpid:e.playerTpid||"",vptag:e.playerVptag||_e()||"",appversion:ve}},enumerable:!1,configurable:!0}),t.prototype.setOuterApi=function(t){this.outerApi=t},t.prototype.getOriginReportUrl=function(t,e,o){var i,r,n=this.getFullUrl({reportUrl:t,oadId:"".concat(null!==(r=null===(i=e.auth)||void 0===i?void 0:i.adid)&&void 0!==r?r:""),orderIdx:e.orderIdx});return(null==o?void 0:o.replaceDict)&&(n=Ee(t,o.replaceDict)),(null==o?void 0:o.appendParams)&&(n=Ae(n,o.appendParams)),n},t.prototype.getOtherReportUrl=function(t,e){var o=t;return(null==e?void 0:e.replaceDict)&&(o=Ee(t,e.replaceDict)),o},t.prototype.reportOriginUrl=function(t,e,o){var i=this.getOriginReportUrl(t,e,o);this.logger.log("上报链接",i),this.requestReportUrl(i)},t.prototype.reportOtherUrl=function(t,e){var o=this.getOtherReportUrl(t,e);this.logger.log("上报链接",o),this.requestReportUrl(o)},t.prototype.requestReportUrl=function(t){var e,o=this,i=t;if(-1===i.indexOf("uniquetimestamp")&&(i=Ae(i,{uniquetimestamp:Date.now()})),this.timer)this.urlList.push(i);else{this.timer=+setTimeout((function(){o.timeoutHandler()}),1e3);var r=null===(e=/adtype=([^&]+)/.exec(i))||void 0===e?void 0:e[1];i.includes("etype=1001")&&(fe.reportEvent("start cgi original report, reportType: ".concat(r)),window.__adBlockEnabled&&fe.reportEvent("cgi original report fail, reportType: ".concat(r))),this.outerApi.reportMethod?this.outerApi.reportMethod(i):(this.imgObj=document.createElement("img"),this.imgObj.onerror=this.timeoutHandler.bind(this),this.imgObj.src=i)}},t.prototype.getFullUrl=function(t){var e=t.reportUrl,o=t.orderIdx,i={oadid:t.oadId||"",url:window.location.href,lcount:o||1,t:0},r=function(t){var e=t.indexOf("?"),o=t.substring(e+1),i={};return o.split("&").forEach((function(t){var e=t.split("=");e.length>=2&&(i[e.shift()]=e.join("="))})),i}(e),a=e.split("?")[0],s=n(n(n({},i),this.config),r);return Ae(a,s,!0)},t.prototype.timeoutHandler=function(){if(0===this.urlList.length)return this.imgObj=null,void(this.timer=null);this.timer&&clearTimeout(this.timer),this.timer=null,this.requestReportUrl(this.urlList.shift())},t}(),Ce=new Ie;!function(t){t[t.INIT=0]="INIT",t[t.LOADING=1]="LOADING",t[t.LOAD_READY=2]="LOAD_READY",t[t.PLAYING=3]="PLAYING",t[t.PAUSED=4]="PAUSED",t[t.END=-1]="END",t[t.WAIT_FOR_STOP=-2]="WAIT_FOR_STOP",t[t.ERROR=5]="ERROR"}(ge||(ge={}));var Te,xe=function(){function e(t){this.logger=V("AbstractAd"),this.adCore=t.adCore,this.order=t.order,this.adInfo=this.getInitAdInfo(),this.beforeInit(t),this.data=this.initData(),this.setState(ge.INIT),this.logger.log("创建广告实例",this.adType),Ht.reportCreated(this.order,this.getVrExtraData()),Ht.reportTechParam(n({name:"createAd",ad_type:this.adType},this.getVrExtraData()))}return Object.defineProperty(e.prototype,"adType",{get:function(){return this.order.adType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){var t;return null!==(t=this.data.state)&&void 0!==t?t:ge.INIT},enumerable:!1,configurable:!0}),e.prototype.beforeInit=function(t){},e.prototype.load=function(){this.setState(ge.LOADING),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adType:this.adType,adOrder:this.order,adInfo:this.adInfo})},e.prototype.play=function(){this.setState(ge.PLAYING),this.data.isStart||(this.data.isStart=!0)},e.prototype.pause=function(){this.setState(ge.PAUSED)},e.prototype.resume=function(){this.setState(ge.PLAYING)},e.prototype.mute=function(){},e.prototype.unMute=function(){},e.prototype.setVolume=function(t){},e.prototype.stop=function(e){this.data.isStart=!1,this.setState(ge.END),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_STOP,{adType:this.adType,adOrder:this.order,adInfo:this.adInfo,index:this.adInfo.orderIdx,forceStop:e})},e.prototype.destroy=function(){this.data.hasDestroy||(this.data.hasDestroy=!0,this.order.orders.forEach((function(t){t.reporter.reset()})),this.order.empty.forEach((function(t){t.reporter.reset()})),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_DESTROY,{adType:this.adType,adOrder:this.order,adInfo:this.adInfo}))},e.prototype.show=function(){var e;this.data.isShow||(this.data.isShow=!0,Ht.reportAdShow(this.adInfo,(null===(e=this.adInfo.material)||void 0===e?void 0:e.type)||ot.UNKNOWN),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_SHOW,{adType:this.adType,adOrder:this.order,adInfo:this.adInfo}),this.data.showTime||(this.data.showTime=Date.now()))},e.prototype.hide=function(){this.data.isShow=!1,this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_HIDE,{adType:this.adType,adOrder:this.order,adInfo:this.adInfo})},e.prototype.setAdFullScreen=function(t){},e.prototype.setAdSmallWindow=function(t){this.data.isSmallWindow=t.isSmallWindow},e.prototype.report=function(t){},e.prototype.resize=function(t){},e.prototype.adjustUI=function(t){},e.prototype.hideAdBeforeResize=function(){},e.prototype.seekStart=function(){},e.prototype.setState=function(t){this.data.state=t},e.prototype.canplayHandler=function(e){this.data.canPlay||(this.logger.log("广告可播",e),this.data.canPlay=!0,this.setState(ge.LOAD_READY),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_CAN_PLAY,n({adType:this.adType,adInfo:this.adInfo},e)))},e.prototype.loadCompleteHandle=function(e){this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_COMPLETE,e),e.adInfo;var o=e.adOrder,i=e.isAllLoaded,r=a(e,["adInfo","adOrder","isAllLoaded"]);this.logger.log("素材加载完成",n(n({},r),{adOrder:o,isAllLoaded:i})),Ht.reportLoaded(e.adInfo,r,this.getVrExtraData())},e.prototype.getJumpLink=function(t,e){var o=t.landing.link;if(o)return o=me(o,{pf_ex:this.adCore.outerApi.playerData.playerPfEx||"",version:ve}),e&&(o=o.replace("__ACTTYPE__",e)),o},e.prototype.openLinkAndReport=function(t,e,o){var i=this.getJumpLink(t,e.actionType);if(i){var r=Date.now();this.data.lastClickTime&&r-this.data.lastClickTime<300||(this.data.lastClickTime=r,this.adCore.outerApi.forbidLinkJump||(o?Ce.requestReportUrl(i):window.open(i),t.reporter.reportClick(),Ht.reportClick(t,e,this.getVrExtraData())))}},e.prototype.getVrExtraData=function(){return{}},e.prototype.initData=function(){return{state:ge.INIT,createTime:Date.now()}},e.prototype.getInitAdInfo=function(){var t;return null!==(t=this.order.orders[0])&&void 0!==t?t:this.order.empty[0]},e.isPointAd=!1,e.isMultiple=!1,e}(),be=function(){function e(t){this.runningSingleAdMap=new Map,this.runningMultipleAdMap=new Map,this.logger=V("AdCtrl"),this.adCore=t}return e.prototype.loadAd=function(t){this.logger.log("loadAd",t);var e=this.adCore.adPlugin.getAdClass(t);if(!e)return this.logger.warn("'".concat(t,"' 类型的广告未注册")),Promise.reject();if(e.isPointAd)return this.logger.warn("点位广告请使用 `loadAdOrder` 方法"),Promise.reject();var o=this.adCore.orderCtrl.getAdOrder(t);return o?this.loadAdOrder(o):(this.logger.warn("没有找到 '".concat(t,"' 类型的广告订单")),Promise.reject())},e.prototype.loadAdOrder=function(e){var o=e.adType;this.logger.log("loadAdOrder",o);var i=this.adCore.adPlugin.getAdClass(o);return i?e?(this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_GET_INFO,{adType:o,adOrder:e}),i.isMultiple?this.createMultipleAd(o,i,e):this.createSingleAd(o,i,e)):(this.logger.warn("没有找到 '".concat(o,"' 类型的广告订单")),Promise.reject()):(this.logger.warn("'".concat(o,"' 类型的广告未注册")),Promise.reject())},e.prototype.getRunningAds=function(t,e){var o=this.adCore.adPlugin.getAdClass(t);if(!(null==o?void 0:o.isMultiple))return(i=this.runningSingleAdMap.get(t))?[i]:[];var i,r=this.runningMultipleAdMap.get(t);return(null==r?void 0:r.size)?e?(i=r.get(e))?[i]:[]:Array.from(r.values()):[]},e.prototype.stopAllAd=function(){this.forEachAd((function(t){t.stop(!0),t.destroy()})),this.runningSingleAdMap.clear(),this.runningMultipleAdMap.clear()},e.prototype.forEachAd=function(t){this.runningSingleAdMap.forEach((function(e){t(e)})),this.runningMultipleAdMap.forEach((function(e){e.forEach((function(e){t(e)}))}))},e.prototype.createSingleAd=function(e,o,i){var r=this.runningSingleAdMap.get(e);r&&r.stop(),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_GET_INFO,{adType:e,adOrder:i});try{var n=this.createAdClass(o,{adCore:this.adCore,order:i});if(n)return this.runningSingleAdMap.set(e,n),n.load(),Promise.resolve(0!==n.order.orders.length)}catch(o){this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_ERROR,{adType:e,msg:"load ".concat(e," ad error"),event:o})}return Promise.reject()},e.prototype.createMultipleAd=function(e,o,i){var r=this,n=this.runningMultipleAdMap.get(e);n||(n=new Map,this.runningMultipleAdMap.set(e,n));var a=i.orders.filter((function(t){return!n.has(t.orderId)}));if(0===a.length)return Promise.resolve(!0);try{return a.forEach((function(t){var e=r.createAdClass(o,{adCore:r.adCore,order:{adType:i.adType,auth:i.auth,orders:[t],empty:[]}});e&&(n.set(t.orderId,e),e.load())})),Promise.resolve(!0)}catch(o){this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_ERROR,{adType:e,msg:"load ".concat(e," ad error"),event:o})}return Promise.reject()},e.prototype.createAdClass=function(t,e){return t.prototype instanceof xe?new t(e):t(e)},e}(),De=function(){function e(){this.eventEmitter=new c.exports.EventEmitter,this.logger=V("AdEventEmitter")}return e.prototype.on=function(t,e){this.eventEmitter.on(t,e)},e.prototype.off=function(t,e){this.eventEmitter.off(t,e)},e.prototype.emit=function(e,o){[t.AD_EVENT.AD_PLAY_ERROR,t.AD_EVENT.AD_ERROR].includes(e)&&this.logger.error("emit error",e,o),this.eventEmitter.emit(e,o)},e}(),Pe=function(){function t(t){this.logger=V("AdPlugin"),this.adPluginMap=new Map,this.extraWatcherSet=new Set,this.adCore=t}return t.prototype.register=function(t,e){var o;this.adPluginMap.has(t)&&this.logger.warn("".concat(t," 广告已经注册过，将覆盖以前注册的版本")),this.adPluginMap.set(t,e),null===(o=e.adWatcher)||void 0===o||o.init(this.adCore),this.startWatch(t)},t.prototype.setWatcher=function(t){this.extraWatcherSet.add(t),t.init(this.adCore),t.startWatch()},t.prototype.getAdClass=function(t){var e=this.getAdPlugin(t);return null==e?void 0:e.adClass},t.prototype.getAdWatcher=function(t){var e=this.getAdPlugin(t);return null==e?void 0:e.adWatcher},t.prototype.getAdPlugin=function(t){return this.adPluginMap.get(t)},t.prototype.getAllPlugin=function(){return Array.from(this.adPluginMap.values())},t.prototype.reset=function(){this.getAllPlugin().forEach((function(t){var e;null===(e=t.adWatcher)||void 0===e||e.reset()})),this.extraWatcherSet.forEach((function(t){t.reset()}))},t.prototype.destroy=function(){var t=this;Array.from(this.adPluginMap.keys()).forEach((function(e){t.endWatch(e)})),this.extraWatcherSet.forEach((function(t){t.endWatch()})),this.adPluginMap.clear()},t.prototype.startWatch=function(t){var e,o=this.getAdPlugin(t);null===(e=null==o?void 0:o.adWatcher)||void 0===e||e.startWatch()},t.prototype.endWatch=function(t){var e,o=this.getAdPlugin(t);null===(e=null==o?void 0:o.adWatcher)||void 0===e||e.endWatch()},t}(),Ne=function(){function t(t){this.logger=V("AdblockChecker"),this.hasCallDetectAdBlock=!1,this.enabled=!1,this.adCore=t,this.detectReady=this.doCheckAdblock()}return Object.defineProperty(t.prototype,"adBlockEnabled",{get:function(){return this.enabled},enumerable:!1,configurable:!0}),t.prototype.checkAdblock=function(){return s(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.detectReady];case 1:return t.sent(),[2,this.adBlockEnabled]}}))}))},t.prototype.adblockDetect=function(){return s(this,void 0,void 0,(function(){var t=this;return d(this,(function(e){return/mobile|mqqbrowser|android|iphone/gi.test(navigator.userAgent)?[2]:(this.logger.log("adblock 检查"),[2,new Promise((function(e){try{var o=document.createElement("div");o.className="adsbox txp_ad_center",o.style.cssText+="position:absolute;left:-9999px;top:-9999px;width:1px;height:1px;";var i=document.createElement("div");i.className="side_ad txp_ad_center",i.style.cssText+="position:absolute;left:-9999px;top:-9999px;width:1px;height:1px;",document.body.appendChild(o),document.body.appendChild(i),setTimeout((function(){try{t.hasCallDetectAdBlock=!0,0!==o.offsetHeight&&null!==i.offsetParent||(t.logger.log("adBlockEnabled",!0),t.enabled=!0,window.__adBlockEnabled=t.enabled,t.adCore.outerApi.emitAdBlockEnabledChange(!0)),o.remove(),i.remove(),e()}catch(t){e()}}),100)}catch(t){e()}}))])}))}))},t.prototype.doCheckAdblock=function(){return s(this,void 0,void 0,(function(){var t=this;return d(this,(function(e){return window.document&&document.body?[2,this.adblockDetect()]:[2,new Promise((function(e){window.document.addEventListener("readystatechange",(function(){t.hasCallDetectAdBlock||"interactive"!==document.readyState&&"complete"!==document.readyState||e(t.adblockDetect())}))}))]}))}))},t}();function we(t){var e;if(!t)return"";var o=document.createElement("a");o.href=t;var i=o.search||"";if(!i)return t;var r=i.replace(/^\?/,"").split("&");return r.sort((function(){return.5-Math.random()>0?1:-1})),r[0]&&/^vkey/.test(r[0])&&r.length>1&&(e=[r[1],r[0]],r[0]=e[0],r[1]=e[1]),i=(i=r.join("&")).replace(/sdtfrom=&|[&]?sdtfrom=$/,""),o.href.replace(o.search,"?".concat(i))}function Se(t){return n(n({},t),{file_size:Number(t.file_size),height:Number(t.height),width:Number(t.width)})}function Oe(t){var e=t.video;return e?n(n({},Se(e)),{url:we(e.url),duration:Number(e.duration)/1e3}):null}function Le(t){var e=t.image;return e?Se(e):null}!function(t){t[t.NONE=0]="NONE",t[t.END=4]="END",t[t.NOT_END=2]="NOT_END",t[t.NOT_END_ACCIDENT=10]="NOT_END_ACCIDENT",t[t.AUTO_PLAYING=7]="AUTO_PLAYING",t[t.FAIL_PLAY=500]="FAIL_PLAY"}(Te||(Te={}));var Ve,Re=function(){function t(t){this.logger=V("AdInfoReporter"),this.reportedSet=new Set,this.delayReportSet=new Set,this.adInfo=t;var e=t.data.order.report;this.effectReportList=this.formatToReportList(e[Z.EFFECT]),this.clickReportList=this.formatToReportList(e[Z.CLICK]),this.pluginReportList=this.formatToReportList(e[Z.PLUGIN]),this.playReportList=this.formatToReportList(e[Z.PLAY_BACK]),this.originExposureReportData=this.formatToExposureReportData(this.formatToReportList(e[Z.ORIGIN_EXPOSURE])),this.otherExposureReportData=this.formatToExposureReportData(this.formatToReportList(e[Z.EXPOSURE]))}return t.prototype.setVideoPlaytime=function(t,e){var o=this;this.originExposureReportData.range.forEach((function(i){o.rangeReport(t,i,(function(){o.logger.log("区间原始曝光上报",o.getLogParams()),Ce.reportOriginUrl(i.reportUrl,o.adInfo,{replaceDict:e})}))})),this.otherExposureReportData.range.forEach((function(i){o.rangeReport(t,i,(function(){o.logger.log("区间第三方曝光上报",o.getLogParams()),Ce.reportOtherUrl(i.reportUrl,{replaceDict:e})}))}))},t.prototype.reportExposure=function(t){this.reportOriginExposure(t),this.reportOtherExposure(t)},t.prototype.reportOriginExposure=function(t){var e=this;this.logger.log("原始曝光上报",this.getLogParams()),this.originExposureReportData.first.forEach((function(o){e.logger.log("首帧上报",e.getLogParams()),Ce.reportOriginUrl(o.reportUrl,e.adInfo,{replaceDict:t})})),this.originExposureReportData.delay.forEach((function(o){e.delayReport(o,(function(){Ce.reportOriginUrl(o.reportUrl,e.adInfo,{replaceDict:t,appendParams:{t:"".concat(o.reportBegin)}})}))}))},t.prototype.reportOtherExposure=function(t){var e=this;this.logger.log("第三方曝光上报",this.getLogParams()),this.otherExposureReportData.first.forEach((function(o){e.logger.log("首帧上报",e.getLogParams()),Ce.reportOtherUrl(o.reportUrl,{replaceDict:t})})),this.otherExposureReportData.delay.forEach((function(o){e.delayReport(o,(function(){Ce.reportOtherUrl(o.reportUrl,{replaceDict:t})}))}))},t.prototype.reportClick=function(){this.logger.log("第三方点击上报",this.getLogParams()),this.clickReportList.forEach((function(t){Ce.reportOtherUrl(t.reportUrl)}))},t.prototype.reportEffects=function(){this.logger.log("effects 上报",this.getLogParams()),this.effectReportList.forEach((function(t){Ce.reportOtherUrl(t.reportUrl,{replaceDict:{__ACTION_ID__:"323"}})}))},t.prototype.reportPlay=function(t){var e=t.playType,o=void 0===e?Te.NONE:e,i=t.timeOffset,r=void 0===i?0:i,n=t.timeStamp,a=void 0===n?Date.now():n,s=t.failReason,d=void 0===s?Te.NONE:s;this.logger.log("play 上报",this.getLogParams()),this.playReportList.forEach((function(t){Ce.reportOtherUrl(t.reportUrl,{replaceDict:{__PLAY_TYPE__:"".concat(o),__TIME_OFFSET__:"".concat(r),__TIMESTAMP__:"".concat(a),__FAIL_REASON__:"".concat(d)}})}))},t.prototype.reset=function(){this.reportedSet.clear(),this.delayReportSet.forEach((function(t){window.clearTimeout(t)})),this.delayReportSet.clear()},t.prototype.rangeReport=function(t,e,o){this.reportedSet.has(e)||t>=e.reportBegin&&t<=e.reportEnd&&(this.logger.log("区间上报","reportBegin:".concat(e.reportBegin,", reportEnd: ").concat(e.reportEnd,", playtime: ").concat(t)),o(),this.reportedSet.add(e))},t.prototype.delayReport=function(t,e){var o=this;this.logger.log("延迟上报",this.getLogParams());var i=window.setTimeout((function(){o.delayReportSet.delete(i),e()}),t.reportBegin);this.delayReportSet.add(i)},t.prototype.formatToReportList=function(t){var e,o=[];return null===(e=null==t?void 0:t.report_list)||void 0===e||e.forEach((function(t){l(l(l([],t.report_urls,!0),t.api_urls,!0),t.sdk_urls,!0).forEach((function(e){o.push({reportBegin:t.report_begin,reportEnd:t.report_end,reportUrl:e})}))})),o},t.prototype.formatToExposureReportData=function(t){var e={first:[],delay:[],range:[]};return t.forEach((function(t){t.reportBegin&&t.reportEnd?e.range.push(t):0===t.reportBegin?e.first.push(t):e.delay.push(t)})),e},t.prototype.getLogParams=function(){return{adType:this.adInfo.adType,index:this.adInfo.orderIdx}},t}(),Me=function(){function t(t){var e=t.data,o=t.orderIdx,i=t.isEmpty,r=t.auth;this.data=e,this.orderIdx=o,this.isEmpty=i,this.auth=r,this.reporter=new Re(this)}return Object.defineProperty(t.prototype,"adType",{get:function(){return this.data.order.ad_type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"orderId",{get:function(){return this.data.order.order_id},enumerable:!1,configurable:!0}),t.prototype.getVrReportData=function(t){var e;void 0===t&&(t=tt.COMMON);var o=null===(e=this.data.order.vr_report_dict)||void 0===e?void 0:e[t];return null==o?void 0:o.report_dict},Object.defineProperty(t.prototype,"clickable",{get:function(){return this.data.order.ad_action.type!==X.UNKNOWN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"landing",{get:function(){var t=this.data.order.ad_action;return t.type===X.CLICK?n({},t.click):t.type===X.SCAN?n({},t.scan):{}},enumerable:!1,configurable:!0}),t}(),ke=function(t){function e(e){var o=this,i=e.point,r=a(e,["point"]);return(o=t.call(this,r)||this).point=i,o}return r(e,t),e}(Me),Ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"clickable",{get:function(){return this.data.order.ad_action.type===X.CLICK},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return Oe(this.data.material)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasHotArea",{get:function(){var t;return!!(null===(t=this.clickHotArea)||void 0===t?void 0:t.height_rate)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clickHotArea",{get:function(){var t;return null===(t=this.data.poster)||void 0===t?void 0:t.click_hot_area},enumerable:!1,configurable:!0}),e}(ke);!function(t){t.UNKNOWN="UNKNOWN",t.EMPTY="empty",t.TRANSPARENT_VIDEO="TransparentVideo",t.ACTIVE_VIDEO="ActiveVideo",t.CONTRACT_VIDEO="ContractVideo",t.ACTIVE_PICTURE="ActivePicture",t.CONTRACT_PICTURE="ContractPicture",t.FULL_SCREEN_PICTURE="FullScreenPicture",t.FULL_SCREEN_VIDEO="FullScreenVideo"}(Ve||(Ve={}));var Be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"materialType",{get:function(){return this.data.material.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"imageMaterial",{get:function(){return Le(this.data.material)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoMaterial",{get:function(){return Oe(this.data.material)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){var t,e;return this.materialType===ot.IMAGE?null===(t=this.imageMaterial)||void 0===t?void 0:t.url:this.materialType===ot.VIDEO?null===(e=this.videoMaterial)||void 0===e?void 0:e.url:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableClick",{get:function(){var t;return!0===(null===(t=this.data.order.ad_action.scan)||void 0===t?void 0:t.enable_click)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"miniProgramInfo",{get:function(){var t,e=null===(t=this.data.order.ad_action.scan)||void 0===t?void 0:t.mini_program_info;if(null==e?void 0:e.appid)return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return[et.PICTURE,et.QRCODE].includes(this.data.poster.action_button.action_type)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isScanActive",{get:function(){return this.data.poster.action_button.action_type===et.QRCODE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this.data.poster.video_control.muted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"orderType",{get:function(){var t;if(this.isEmpty)return Ve.EMPTY;if(this.data.poster.split_control_info&&this.data.poster.split_control_info.split_type!==rt.SPLIT_TYPE_UNKNOWN){if(this.materialType===ot.VIDEO)return Ve.FULL_SCREEN_VIDEO;if(this.materialType===ot.IMAGE)return Ve.FULL_SCREEN_PICTURE}return this.materialType===ot.VIDEO?(null===(t=this.videoMaterial)||void 0===t?void 0:t.is_transparent)?Ve.TRANSPARENT_VIDEO:this.isActive?Ve.ACTIVE_VIDEO:Ve.CONTRACT_VIDEO:this.materialType===ot.IMAGE?this.isActive?Ve.ACTIVE_PICTURE:Ve.CONTRACT_PICTURE:Ve.UNKNOWN},enumerable:!1,configurable:!0}),e}(Me);function ze(t){var e=R(t);return["null","undefined"].includes(e)?[]:"array"===e?t:[t]}var He,$e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"material",{get:function(){return Oe(this.data.material)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWholeScene",{get:function(){return!!this.point.is_whole_scene},enumerable:!1,configurable:!0}),e}(ke),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"material",{get:function(){return Le(this.data.material)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasFlag",{get:function(){var t;return null===(t=this.data.poster)||void 0===t?void 0:t.ad_flag},enumerable:!1,configurable:!0}),e}(Me);!function(t){t.CONTRACT="Contract",t.ACTIVE_PICTURE="ActivePicture",t.ACTIVE_SCAN_JUMP="ActiveScanJump",t.ACTIVE_SCAN="ActiveScan"}(He||(He={}));var Ge,Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"material",{get:function(){var t=Oe(this.data.material);return t||{duration:0,url:"",vid:"",file_size:0,is_transparent:!1,enable_crt_cached:!1,width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFullscreenClick",{get:function(){return!!this.data.poster.enable_fullscreen_click},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return[et.PICTURE,et.QRCODE].includes(this.data.poster.action_button.action_type)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPictureActive",{get:function(){return this.data.poster.action_button.action_type===et.PICTURE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isScanActive",{get:function(){return this.data.poster.action_button.action_type===et.QRCODE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"miniProgramInfo",{get:function(){var t,e=null===(t=this.data.order.ad_action.scan)||void 0===t?void 0:t.mini_program_info;if(null==e?void 0:e.appid)return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"orderType",{get:function(){var t;return this.isActive?this.isScanActive?!0===(null===(t=this.data.order.ad_action.scan)||void 0===t?void 0:t.enable_click)?He.ACTIVE_SCAN_JUMP:He.ACTIVE_SCAN:He.ACTIVE_PICTURE:He.CONTRACT},enumerable:!1,configurable:!0}),e}(Me);!function(t){t[t.INIT=0]="INIT",t[t.LOADING=2]="LOADING",t[t.PLAYING=6]="PLAYING",t[t.END=-1]="END"}(Ge||(Ge={}));var Fe=function(){function e(t){this.adOrderMap=new Map,this.adPointMap=new Map,this.adExtraDataMap=new Map,this.adCore=t}return e.prototype.getAdOrder=function(t){var e;return null!==(e=this.adOrderMap.get(t))&&void 0!==e?e:null},e.prototype.getPoints=function(t){var e,o=this.adPointMap.get(t);return Array.from(null!==(e=null==o?void 0:o.keys())&&void 0!==e?e:[])},e.prototype.getExtraData=function(t){return this.adExtraDataMap.get(t)},e.prototype.getPointOrderFromPoint=function(t,e){var o=this.adPointMap.get(t);if(o)return o.get(e)},e.prototype.setAdOrder=function(t){switch(t.ad_scene){case W.PRE:case W.TAIL:this.fixOrderTime(t),this.setPostAdOrder(t);break;case W.ANCHOR:this.setAnchorAdOrder(t);break;case W.PROGRESS_PREVIEW:case W.VIDEO_RESOLUTION:case W.PAUSE:this.setSingleAdOrder(t);break;case W.DYNAMIC_MID:this.setDynamicMidAdOrder(t)}},e.prototype.checkPointConflict=function(t,e,o){var i=[];return this.adPointMap.forEach((function(r){r.forEach((function(r,n){(n.type===it.TIMESTAMP?e:t)>=n.begin-o&&t<=n.end+o&&i.push(r)}))})),i},e.prototype.reset=function(){this.adOrderMap.clear(),this.adPointMap.clear(),this.adExtraDataMap.clear()},e.prototype.setPostAdOrder=function(t){var e,o=this;null===(e=t.ads)||void 0===e||e.forEach((function(e){var i=o.getCreateAdOrderFn({adType:e.ad_type,empty:e.empty,auth:t.auth});switch(e.ad_type){case J.PRE:o.setAdOrderMap(i(e.pre,Ye));break;case J.BROADCAST:o.setAdOrderMap(i(e.broadcast,Ye));break;case J.TAIL:o.setAdOrderMap(i(e.tail,Ye));break;case J.LOADING:o.setAdOrderMap(i(e.loading,Ke));break;case J.DYNAMIC_MID:e.dynamic&&o.addExtraData(J.DYNAMIC_MID,e.dynamic);break;default:return[]}}))},e.prototype.setAnchorAdOrder=function(t){var e,o=this,i=function(e,i){var r=o.adPointMap.get(e);r||(r=new Map,o.adPointMap.set(e,r));var n=r.get(i);return n||(n={adType:e,point:i,orders:[],empty:[],pointStatus:Ge.INIT,auth:t.auth},r.set(i,n)),n};this.adPointMap.clear(),[J.CORNER,J.MID,J.HLS_MID,J.VIDEO_IN,J.ANCHOR_EMPTY,J.NON_STANDARD].forEach((function(t){o.adOrderMap.delete(t)})),null===(e=t.anchor_ads)||void 0===e||e.forEach((function(e){if(e.point){e.point=n(n({},e.point),{begin:Number(e.point.begin),end:Number(e.point.end),time_offset:Number(e.point.time_offset)});var o=function(o,i,r){return void 0===r&&(r=!1),{data:o,orderIdx:i,point:e.point,isEmpty:r,auth:t.auth}};e.empty.forEach((function(t,r){var n=t.order.ad_type;i(n,e.point).empty.push(new ke(o(t,r,!0)))})),e.corner.forEach((function(t,r){var n=t.order.ad_type;i(n,e.point).orders.push(new $e(o(t,r)))})),e.mid.forEach((function(t,r){var n=t.order.ad_type;i(n,e.point).orders.push(new Ye(o(t,r)))})),e.hls_mid.forEach((function(t,r){var n=t.order.ad_type;i(n,e.point).orders.push(new Ue(o(t,r)))})),e.video_in.forEach((function(t,r){var n=t.order.ad_type;i(n,e.point).orders.push(new ke(o(t,r)))})),e.anchor_empty.forEach((function(t,r){var n=t.order.ad_type;i(n,e.point).orders.push(new ke(o(t,r)))})),e.non_standard.forEach((function(t,r){var n=t.order.ad_type;i(n,e.point).orders.push(new ke(o(t,r)))})),e.ad_type===J.MID&&0===e.mid.length&&[2,3].includes(e.point.mid_type)&&i(J.MID,e.point)}else e.empty.forEach((function(e,o){new Me({data:e,orderIdx:o,auth:t.auth,isEmpty:!0}).reporter.reportExposure()}))})),this.adPointMap.forEach((function(e,i){var r={adType:i,auth:t.auth,orders:[],empty:[]};e.forEach((function(t){var e,o;(e=r.empty).push.apply(e,t.empty),(o=r.orders).push.apply(o,t.orders)})),o.setAdOrderMap(r)}))},e.prototype.setSingleAdOrder=function(t){var e=t.ad;if(e){var o=this.getCreateAdOrderFn({adType:e.ad_type,empty:e.empty,auth:t.auth});switch(e.ad_type){case J.VIDEO_RESOLUTION:if(!e.empty&&!e.video_resolution)return;this.setAdOrderMap(o(e.video_resolution,Ke));break;case J.PROGRESS_PREVIEW:if(!e.empty&&!e.progress_preview)return;this.setAdOrderMap(o(e.progress_preview,Ke));break;case J.PAUSE:if(!e.empty&&!e.pause)return;this.setAdOrderMap(o(e.pause,Be))}}},e.prototype.setDynamicMidAdOrder=function(e){var o,i=this;null===(o=e.ads)||void 0===o||o.forEach((function(o){var r,n,a=i.getCreateAdOrderFn({adType:J.MID,empty:o.empty,auth:e.auth});if(o.ad_type===J.DYNAMIC_MID){if((null===(r=o.mid)||void 0===r?void 0:r.length)&&o.mid.length>0||(null===(n=o.empty)||void 0===n?void 0:n.length)&&o.empty.length>0){var s=a(o.mid,Ye);i.adOrderMap.set(J.MID,s),i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_ORDER_SET,{adType:s.adType,adOrder:s})}o.dynamic&&i.addExtraData(J.DYNAMIC_MID,o.dynamic)}}))},e.prototype.getCreateAdOrderFn=function(t){var e=t.adType,o=t.auth,i=t.empty;return function(t,r){return{adType:e,auth:o,orders:ze(t).map((function(t,e){return new r({data:t,orderIdx:e,auth:o,isEmpty:!1})})),empty:ze(i).map((function(t,e){return new Me({data:t,orderIdx:e,auth:o,isEmpty:!0})}))}}},e.prototype.setAdOrderMap=function(e){this.adOrderMap.set(e.adType,e),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_ORDER_SET,{adType:e.adType,adOrder:e})},e.prototype.fixOrderTime=function(t){var e;null===(e=t.ads)||void 0===e||e.forEach((function(t){var e,o,i,r=function(t){var e,o;t.material.video&&t.material.video.duration<100&&(t.material.video.duration*=1e3),t.poster.skip.duration&&t.poster.skip.duration<100&&(t.poster.skip.duration*=1e3),(null===(e=t.poster.action_button.qrcode)||void 0===e?void 0:e.display_interval)&&t.poster.action_button.qrcode.display_interval<100&&(t.poster.action_button.qrcode.display_interval*=1e3),(null===(o=t.poster.action_button.picture)||void 0===o?void 0:o.display_interval)&&t.poster.action_button.picture.display_interval<100&&(t.poster.action_button.picture.display_interval*=1e3)};null===(e=t.pre)||void 0===e||e.forEach(r),null===(o=t.broadcast)||void 0===o||o.forEach(r),null===(i=t.tail)||void 0===i||i.forEach(r)}))},e.prototype.addExtraData=function(t,e){var o=this.adExtraDataMap.get(t);o||(o={}),o=n(n({},o),e),this.adExtraDataMap.set(t,o)},e}(),We=function(){function t(t){this.uiMap=new Map,this.outerApi=t}return t.prototype.getUIInterface=function(t){if(!this.uiMap.has(t)){var e=new t(this.outerApi);e.init(),this.uiMap.set(t,e)}return this.uiMap.get(t)},t.prototype.destroy=function(){this.uiMap.forEach((function(t){t.destroy()}))},t}();function qe(t,e){void 0===e&&(e={});var o=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===o&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}qe('txp,txpdiv{-webkit-box-sizing:border-box;box-sizing:border-box;display:block}.txp_ad{color:#fff;font-family:sans-serif;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%;z-index:4}.txp_ad a{text-decoration:none}.txp_ad .txp_btn_close{color:#fff;cursor:pointer;display:inline-block;height:28px;margin-left:3px;pointer-events:auto;position:relative;vertical-align:top;width:14px}.txp_ad .txp_btn_close:before{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAxMiI+PHBhdGggZmlsbD0iI2ZmZiIgZD0ibTEwLjUgMTAtLjUuNS00LTQtNCA0LS41LS41IDQtNC00LTQgLjUtLjUgNCA0IDQtNCAuNS41LTQgNCA0IDR6Ii8+PC9zdmc+) 50% no-repeat;content:"";height:12px;left:0;position:absolute;top:7px;width:12px}.txp_ad img{max-width:100%;pointer-events:auto}.txp_ad .txp_ad_inner{height:100%;left:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:100%}.txp_ad .txp_ad_inner .txp_creative_link{cursor:auto;display:block;height:100%;pointer-events:auto;width:100%}.txp_ad .txp_btn{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:none;cursor:pointer;font-family:inherit;position:relative}.txp_ad .txp_ad_dialog{background-color:#242424;background-color:rgba(36,36,36,.98);left:50%;margin:auto;padding-bottom:25px;padding-top:40px;pointer-events:auto;position:absolute;text-align:center;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:420px;z-index:7}.txp_ad .txp_ad_dialog .txp_ad_btn{background-color:#ff7800;border-radius:1px;cursor:pointer;display:block;font-size:14px;line-height:34px;margin:25px auto 0;overflow:hidden;text-align:center;width:100px}.txp_ad .txp_ad_dialog .txp_ad_fb{display:inline-block;font-size:12px;margin:15px auto 0;text-align:center}.txp_ad .txp_ad_dialog .txp_dialog_bd{color:#fff;display:block;font-size:14px;line-height:1.5;margin:auto 30px;text-align:left}.txp_ad .txp_ad_dialog .txp_btn_close{color:#848484;cursor:pointer;font-size:0;position:absolute;right:8px;top:2px;-webkit-transform:scale(1.5);transform:scale(1.5)}.txp_ad_countdown{color:#ff6e0b;display:inline-block;font-family:Helvetica,arial;font-size:14px;font-weight:400;line-height:26px;padding-left:3px;position:relative;vertical-align:top}.txp_ad_countdown:after{background-color:#fff;background-color:hsla(0,0%,100%,.6);background-size:1px 100%;bottom:9px;content:"";position:absolute;right:-9px;top:9px;width:1px}.txp_ad_skip_text{line-height:26px;margin-left:6px;padding-left:10px}.txp_ad_skip_text,.txp_btn_hint{display:inline-block;position:relative;vertical-align:top}.txp_btn_hint{background-color:#ff6e0b;border-radius:100%;height:14px;margin-left:3px;margin-top:6px;width:14px}.txp_btn_hint:after{content:"?";left:0;line-height:14px;position:absolute;text-align:center;top:0;width:100%}.txp_ad_more,.txp_ad_skip{background-color:#252525;background-color:rgba(37,37,37,.7);border-radius:1px;color:#fff!important;display:inline-block;font-size:12px;height:26px;line-height:26px;overflow:hidden;padding:0 5px;pointer-events:auto;position:relative;vertical-align:top;white-space:nowrap;z-index:100}.txp_ad .txp_ad_inner .txp_creative_link.txp_none,.txp_ad .txp_none,.txp_none,txpdiv .txp_none{display:none}');var je,Qe,Je,Xe,Ze=function(){function e(t){this.adEventEmitter=new De,this.adCtrl=new be(this),this.orderCtrl=new Fe(this),this.adPlugin=new Pe(this),this.adblockChecker=new Ne(this),this.logger=V("AdCore"),this.options=t,this.uiCtrl=new We(t.outerApi),Ce.setOuterApi(t.outerApi),zt.setOuterApi(t.outerApi),fe.setOuterApi(t.outerApi),this.bindAdEvent()}return Object.defineProperty(e.prototype,"outerApi",{get:function(){return this.options.outerApi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"postPlayer",{get:function(){return this.options.postPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pausePlayer",{get:function(){return this.options.pausePlayer},enumerable:!1,configurable:!0}),e.prototype.registerAd=function(t,e){this.logger.log("registerAd",t),this.adPlugin.register(t,e)},e.prototype.registerAds=function(t){var e=this;this.logger.log("registerAds",Object.keys(t)),Object.entries(t).forEach((function(t){var o=t[0],i=t[1];e.registerAd(Number(o),i)}))},e.prototype.getAdClass=function(t){return this.adPlugin.getAdClass(t)},e.prototype.getUIInterface=function(t){return this.uiCtrl.getUIInterface(t)},e.prototype.setAdOrder=function(e){var o,i;this.logger.log("setAdOrder",e),zt.setIsVip(!!(null===(o=e.auth)||void 0===o?void 0:o.is_vip)),zt.setStrategyIds(null!==(i=null==e?void 0:e.strategy_ids)&&void 0!==i?i:[]),Ht.reportSetAdOrder(e);try{this.orderCtrl.setAdOrder(e)}catch(o){this.adEventEmitter.emit(t.AD_EVENT.AD_ERROR,{msg:"orderError",event:o,adOrder:e})}},e.prototype.getAdOrder=function(t){return this.orderCtrl.getAdOrder(t)},e.prototype.reset=function(){this.adCtrl.stopAllAd(),this.orderCtrl.reset(),this.adPlugin.reset()},e.prototype.loadAd=function(t){return s(this,void 0,void 0,(function(){return d(this,(function(e){return[2,this.adCtrl.loadAd(t)]}))}))},e.prototype.loadAdOrder=function(t){return this.adCtrl.loadAdOrder(t)},e.prototype.playAd=function(e,o){var i=this;this.logger.log("playAd",e);var r=this.getRunningAds(e,o);0!==r.length?r.forEach((function(t){i.applyAdMethod(t,"play")})):this.adEventEmitter.emit(t.AD_EVENT.AD_STOP,{adType:e})},e.prototype.pauseAd=function(t,e){var o=this;(this.logger.log("pauseAd",t),t)?this.getRunningAds(t,e).forEach((function(t){o.applyAdMethod(t,"pause")})):this.adCtrl.forEachAd((function(t){o.applyAdMethod(t,"pause")}))},e.prototype.resumeAd=function(t,e){var o=this;(this.logger.log("resumeAd",t),t)?this.getRunningAds(t,e).forEach((function(t){o.applyAdMethod(t,"resume")})):this.adCtrl.forEachAd((function(t){o.applyAdMethod(t,"resume")}))},e.prototype.stopAd=function(t,e){var o=this;(this.logger.log("stopAd",t),t)?this.getRunningAds(t,e).forEach((function(t){o.applyAdMethod(t,"stop")})):this.stopAllAd()},e.prototype.stopAllAd=function(){this.adEventEmitter.emit(t.AD_EVENT.AD_STOP_ALL,void 0),this.reset()},e.prototype.muteAd=function(){var t=this;this.logger.log("muteAd"),this.adCtrl.forEachAd((function(e){t.applyAdMethod(e,"mute")}))},e.prototype.unmuteAd=function(){var t=this;this.logger.log("unmuteAd"),this.adCtrl.forEachAd((function(e){t.applyAdMethod(e,"unMute")}))},e.prototype.setVolume=function(t){var e=this;this.logger.log("setVolume",t),this.adCtrl.forEachAd((function(o){e.applyAdMethod(o,"setVolume",t)}))},e.prototype.getVolume=function(){return this.postPlayer.volume},e.prototype.resizeAd=function(t){var e=this;this.logger.log("resizeAd",t);var o=this.outerApi.getPlayerSize();this.adCtrl.forEachAd((function(i){e.applyAdMethod(i,"resize",n({width:o.playerWidth,height:o.playerHeight,oWidth:o.playerOWidth,oHeight:o.playerOHeight},t))}))},e.prototype.adjustUI=function(t){var e=this;this.logger.log("adjustUI",t),this.adCtrl.forEachAd((function(o){e.applyAdMethod(o,"adjustUI",t)}))},e.prototype.hideAdBeforeResize=function(){var t=this;this.logger.log("hideAdBeforeResize"),this.adCtrl.forEachAd((function(e){t.applyAdMethod(e,"hideAdBeforeResize")}))},e.prototype.hideAd=function(t,e){var o=this;(this.logger.log("hideAd",t),t)?this.getRunningAds(t,e).forEach((function(t){o.applyAdMethod(t,"hide")})):this.adCtrl.forEachAd((function(t){o.applyAdMethod(t,"hide")}))},e.prototype.showAd=function(t,e){var o=this;this.logger.log("showAd",t),this.getRunningAds(t,e).forEach((function(t){o.applyAdMethod(t,"show")}))},e.prototype.setAdFullScreen=function(t){var e=this;this.logger.log("setAdFullScreen",t),this.adCtrl.forEachAd((function(o){e.applyAdMethod(o,"setAdFullScreen",t)}))},e.prototype.setAdSmallWindow=function(t){var e=this;this.logger.log("setAdSmallWindow",t),this.adCtrl.forEachAd((function(o){e.applyAdMethod(o,"setAdSmallWindow",t)}))},e.prototype.seekStart=function(){var t=this;this.logger.log("seekStart"),this.adCtrl.forEachAd((function(e){t.applyAdMethod(e,"seekStart")}))},e.prototype.reportAd=function(t,e,o){var i=this;this.logger.log("reportAd",t,e),this.getRunningAds(t,o).forEach((function(t){i.applyAdMethod(t,"report",e)}))},e.prototype.getRunningAds=function(t,e){return this.adCtrl.getRunningAds(t,e)},e.prototype.destroy=function(){var t=this;this.logger.log("destroy"),this.adCtrl.forEachAd((function(e){t.applyAdMethod(e,"stop"),t.applyAdMethod(e,"destroy")})),this.uiCtrl.destroy(),this.adPlugin.destroy(),this.outerApi.destroy()},e.prototype.reportProxyRequest=function(t){Ht.reportRequest(t)},e.prototype.reportProxyResponse=function(t){Ht.reportResponse(t)},e.prototype.bindAdEvent=function(){var e=this;this.adEventEmitter.on(t.AD_EVENT.AD_DESTROY,(function(t){var o;e.logger.log("".concat(t.adType," 类型广告销毁"),t);var i=e.getAdClass(t.adType);if(null==i?void 0:i.isMultiple){var r=null===(o=t.adInfo)||void 0===o?void 0:o.orderId;if(r){var n=e.adCtrl.runningMultipleAdMap.get(t.adType);n&&(n.delete(r),0===n.size&&e.adCtrl.runningMultipleAdMap.delete(t.adType))}}else e.adCtrl.runningSingleAdMap.delete(t.adType)}))},e.prototype.applyAdMethod=function(e,o){for(var i,r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];try{null===(i=e[o])||void 0===i||i.call.apply(i,l([e],r,!1))}catch(i){this.adEventEmitter.emit(t.AD_EVENT.AD_ERROR,{adType:e.adType,msg:"".concat(o," ").concat(e.adType," ad"),event:i})}},e}();!function(t){t.OUT="out",t.IN="in",t.H5="H5",t.CLIENT="client"}(je||(je={}));var to=((Qe={})[ce.LD]=J.PRE,Qe[ce.KB]=J.BROADCAST,Qe[ce.HT]=J.TAIL,Qe),eo=((Je={})[t.AdTypeV.LD]=J.PRE,Je[t.AdTypeV.HT]=J.TAIL,Je[t.AdTypeV.ZC]=J.MID,Je[t.AdTypeV.CZC]=J.CREATIVE_MID,Je[t.AdTypeV.ZT]=J.PAUSE,Je[t.AdTypeV.KB]=J.BROADCAST,Je[t.AdTypeV.PSJ]=J.CORNER,Je[t.AdTypeV.PLJ]=J.LIVE_CORNER,Je[t.AdTypeV.PPB]=J.PROGRESS_PREVIEW,Je[t.AdTypeV.PVL]=J.LOADING,Je[t.AdTypeV.PDF]=J.VIDEO_RESOLUTION,Je[t.AdTypeV.BS]=J.WATCH_BUY,Je[t.AdTypeV.VIN]=J.VIDEO_IN,Je[t.AdTypeV.PHLS]=J.HLS_MID,Je[t.AdTypeV.DER]=J.ANCHOR_EMPTY,Je),oo=((Xe={})[J.PRE]=e.AD_TYPE.PRE,Xe[J.BROADCAST]=e.AD_TYPE.PRE,Xe[J.TAIL]=e.AD_TYPE.POST,Xe[J.MID]="ZC",Xe[J.PAUSE]="ZT",Xe),io={toAdCoreType:function(t){var e=eo[t];if(e)return e;if(e=to[t])return e;var o=Object.entries(oo).find((function(e){return e[1]===t}));return o?Number(o[0]):J.UNKNOWN},toAdTypeV:function(t){var e=Object.entries(eo).find((function(e){return e[1]===t}));if(e)return e[0]},toAdTypeM:function(t){var e=Object.entries(to).find((function(e){return e[1]===t}));if(e)return e[0]},toThumbPlayerAdType:function(t){return oo[t]},getAdScene:function(t){if("number"==typeof t)return t;var e=io.toAdCoreType(t);return e===J.PRE?W.PRE:e===J.TAIL?W.TAIL:W.PRE}},ro="TxpCreativePlayer-rfid",no="TxpCreativePlayer-vid-url",ao="TxpCreativePlayer-request-mid-count",so=function(t){if(/ptag=wx\.search/i.test(window.location.href))return 64;if(void 0!==(null==t?void 0:t.playerChid))return t.playerChid;var e=NaN;return/(.*\.)3g\.qq\.com$/i.test(window.location.hostname)?e=13:/(.*\.)?v\.qq\.com$/i.test(window.location.hostname)||Mt.browser.qqlive?e=Mt.browser.wechat&&Mt.mobile?180:/(.*\.)?v\.qq\.com$/i.test(window.location.hostname)&&Mt.mobile?191:0:Mt.browser.wechat&&window.location.href.indexOf("/x/qqnews/")>-1?e=3:Mt.browser.mqq&&window.location.href.indexOf("/x/qqnews/")>-1?e=10:Mt.browser.qqnews&&(e=2),e},lo=function(){return Mt.os.iphone?"iphone":Mt.os.ipad?"ipad":Mt.os.android?"android":Mt.os.windows||Mt.os.mac?"pc":""};var po,co=function(t){if(!t)return"";var e=kt("main_login");if(!e)return"";if("main_login"===t)return e;var o=kt("vqq_".concat(t));return"qq"===e&&o?o:kt(t)},uo=function(t){if(void 0===t&&(t="lossy"),void 0!==po)return po;var e=new Image,o={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return new Promise((function(i){e.onload=function(){po=!0,i(!0)},e.onerror=function(){po=!1,i(!1)},e.src="data:image/webp;base64,".concat(o[t])}))};uo();var ho,fo,vo=function(){var t="";if(void 0!==window.localStorage)try{t=window.localStorage[ro]}catch(t){return""}return t||""},mo="3.4.15";!function(t){t[t.MFT_UNKNOWN=0]="MFT_UNKNOWN",t[t.MFT_MP4=1]="MFT_MP4",t[t.MFT_HLS=3]="MFT_HLS"}(fo||(fo={}));var yo={adType:"ad_type",coverId:"cid",vid:"vid",live:"is_live",livePid:"live_id",pf:"platform",pfEx:"pf_ex",appVersion:"plugin",pu:"user_type",flowId:"flow_id",guId:"guid",refer:"referer",url:"url",ty:"site",adaptor:"switch",dType:"material",chId:"channel_id",vpTag:"pv_tag",pt:"pt",openId:"open_id",appId:"app_id",accessToken:"access_token",userId:"vuid",token:"vuser_session",lt:"type",refreshId:"refresh_id",tpId:"type_id",from:"from",platform:"play_platform",plugin:"plugin",respType:"resp_type",reqType:"req_type",v:"version",sessionId:"session_id",fmt:"fmt"},_o={is_live:"0",site:"web",vpTag:_e(),switch:1,dType:1,respType:"json",appVersion:mo},go=((ho={})[W.PRE]="pre_ad_params",ho[W.TAIL]="tail_ad_params",ho[W.ANCHOR]="anchor_ad_params",ho[W.PAUSE]="pause_ad_params",ho[W.PROGRESS_PREVIEW]="progress_preview_ad_params",ho[W.VIDEO_RESOLUTION]="video_resolution_ad_params",ho[W.DYNAMIC_MID]="mid_ad_params",ho),Ao=function(t){var e,o,i,r,a,s,d=t.adScene,l=t.params,p=t.playerData,c=p.playerPf,u=void 0===c?function(t){if(Mt.mobile)return je.H5;var e=window.location.hostname;return"v.qq.com"===e||"film.qq.com"===e||8===t?je.IN:je.OUT}(so(p)):c,h=p.playerPfEx,f=void 0===h?lo():h,v=p.playerTpid,m=void 0===v?"":v,y=null!==(e=p.playerVptag)&&void 0!==e?e:_o.vpTag,_=""===p.playerPu?q.UNKNOWN:Number(p.playerPu),g=n({user_type:_,platform:u,device:f,site:"web",flow_id:l.flowId,guid:l.guId,cid:l.coverId,vid:l.vid,is_live:_o.is_live,type_id:Number(m)||0,from:Mt.os.iphone?"3":Mt.os.ipad?"6":Mt.os.android?"4":"0",play_platform:l.platform,channel_id:so(p),referer:l.refer,url:l.url,type:(s=co("main_login"),"qq"===(null==s?void 0:s.toLowerCase())?j.QQ:"wx"===(null==s?void 0:s.toLowerCase())?j.WX:j.GUEST),open_id:co("openid"),access_token:co("access_token"),app_id:co("appid"),vuid:co("vuserid"),vuser_session:co("vusession"),refresh_id:"",version:l.v,pv_tag:y,material:fo.MFT_MP4,switch:null!==(o=l.adaptor)&&void 0!==o?o:1,fmt:nt.SHD},function(t,e,o){var i=n({},t);return Object.entries(o).forEach((function(t){var o=t[0],r=t[1];void 0!==e[o]&&(i[r]=e[o])})),i}({},n(n({},_o),l),yo)),A={base:{vid:g.vid,cid:g.cid},is_live:"1"===g.is_live,type_id:Number(g.type_id),referer:g.referer,url:g.url,flow_id:g.flow_id,refresh_id:"",fmt:dt[g.fmt]||nt.SHD},E={guid:g.guid,channel_id:Number(g.channel_id),site:g.site,platform:g.platform,from:Number(g.from),device:g.device,play_platform:Number(g.play_platform),pv_tag:g.pv_tag,support_click_scan_integration:"in"===g.platform};1===l.disable_time_offset&&(E.disable_time_offset=!0);var I={version:g.version,plugin:mo,switch:Number(g.switch),play_type:"".concat(null!==(i=l.pt)&&void 0!==i?i:"")},C={type:g.type,vuid:null!==(r=Number(g.vuid))&&void 0!==r?r:0,vuser_session:g.vuser_session,app_id:g.app_id,open_id:g.open_id,access_token:g.access_token},T={ad_scene:d,user_type:null!==(a=g.user_type)&&void 0!==a?a:q.UNKNOWN,video:A,platform:E,player:I,token:C};!0===uo()&&(T.player.img_type="webp"),l.livePid&&(T.video.pid=l.livePid,T.video.base.pid=l.livePid),"1"===l.live&&(T.video.is_live=!0);var x={ad_scene:T.ad_scene};if(x.ad_scene===W.PRE&&(T.video.refresh_id=vo()),x.ad_scene===W.ANCHOR&&l.sessionId&&(T.video.session_id=l.sessionId),x.ad_scene===W.DYNAMIC_MID){var b=Number(window.sessionStorage.getItem(ao)||0);T.dynamic={dynamic_mid_ad_request_num:b}}var D=function(){try{return window.qb_external.getQ16()}catch(t){return null}}();D&&(T.platform.qimei32=D);var P=go[x.ad_scene];return P&&(x[P]=T),zt.updateParams(T),fe.updateUin(T.platform.guid||""),Ht.reportCallGetAdParams({adScene:d,params:l}),x},Eo={playerMethod:{},playerData:{playerPf:void 0,playerPfEx:lo(),playerWidth:0,playerHeight:0,playerLeft:0,playerTop:0,playtime:0,playerEndTime:0,playerDuration:0,playerPlatform:"",playerFrom:null,playerVersion:"",playerCid:"",playerVid:"",playerFlowid:"",playerGuid:"",playerPt:"",playerPu:"",playerTrialerMode:!1,playerAdExt:"",playerType:"",playerIsSkipPrelude:!1,playerVptag:"",playerOHeight:0,playerOWidth:0,playerTpid:""},touchPlayer:!1,forbidLinkJump:!1},Io=function(i){function a(t,o){var r=i.call(this,t)||this;return r.config=n({},Eo),r.onPlaySessionStart=function(t){var e;r.reset(),r.setConf({playerData:{playerFlowid:null===(e=t.data)||void 0===e?void 0:e.flowid}})},r.initLogger=function(){var t={info:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.info.apply(r,t)},log:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.log.apply(r,t)},warn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.warn.apply(r,t)},error:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.error.apply(r,t)}};return L(t),V("VideoAdPlugin")},r.logger=r.initLogger(),r.logger.log("create plugin",o),r.setConf(o),r.adCore=r.createAdCore(),r.bindReportEvent(),r.player.on(e.H5_PLAY_EVENT.PLAY_SESSION_START,r.onPlaySessionStart),r}return r(a,i),a.prototype.getPlayerInstance=function(t){var e;return"ZT"===t?null===(e=this.adCore.pausePlayer)||void 0===e?void 0:e.player:this.adCore.postPlayer.player},a.prototype.reset=function(){this.adCore.reset()},a.prototype.getConf=function(){return this.config},a.prototype.setConf=function(){for(var t=this,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(0!==e.length&&e[0])if(this.config){if(1===e.length){var i=e[0];Object.keys(i).forEach((function(e){t.config[e]="playerData"===e||"playerMethod"===e?n(n({},t.config[e]),i[e]):i[e]}))}else if(2===e.length){var r=e[0],a=e[1],s=r.split(".");if(1===s.length)this.config[r]=a;else for(var d=this.config,l=0,p=s.length;l<p&&"object"==typeof d;l++){if(l===p-1){d[s[l]]=a;break}d=d[s[l]]}}this.adCore&&this.updateAdapterFromConfig()}else this.config=e[0]},a.prototype.setAdInfo=function(t){this.adCore.setAdOrder(t)},a.prototype.getOrdersByType=function(t){var e=io.toAdCoreType(t);if(e)return this.adCore.getAdOrder(e)},a.prototype.isOrderEmpty=function(t){if(!t)return!0;var e=this.getOrdersByType(t);return!e||0===e.orders.length},a.prototype.loadAd=function(t){var e=t.adType;this.logger.log("loadAd",{adType:e});var o=io.toAdCoreType(e);return o&&this.adCore.getAdOrder(o)?this.adCore.loadAd(o):(this.logger.log("未找到广告订单",{adType:e,adCoreType:o}),Promise.reject())},a.prototype.playAd=function(t){var e=this,o=t.adType;this.logger.log("playAd",{adType:o});var i=io.toAdCoreType(o);return i&&this.hasAdOrder(i)?this.adCore.getRunningAds(i).length?(this.adCore.playAd(i),Promise.resolve()):this.loadAd({adType:o}).finally((function(){return e.adCore.playAd(i)})):(this.logger.log("未找到广告订单",{adType:o,adCoreType:i}),Promise.reject())},a.prototype.pauseAd=function(t){this.adCore.pauseAd(t&&io.toAdCoreType(t))},a.prototype.resumeAd=function(t){this.adCore.resumeAd(t&&io.toAdCoreType(t))},a.prototype.stopAd=function(t){this.adCore.stopAd(t&&io.toAdCoreType(t))},a.prototype.readRfId=function(){return vo()},a.prototype.muteAd=function(){this.adCore.muteAd()},a.prototype.unMuteAd=function(){this.adCore.unmuteAd()},a.prototype.setAdVolume=function(t){this.adCore.setVolume(t)},a.prototype.getAdVolume=function(){return this.adCore.getVolume()},a.prototype.resizeAd=function(t){this.adCore.resizeAd(t)},a.prototype.adjustUI=function(t){this.adCore.adjustUI(t)},a.prototype.setAdSmallWindow=function(t){this.adCore.setAdSmallWindow(t)},a.prototype.hideAdBeforeResize=function(){this.adCore.hideAdBeforeResize()},a.prototype.seekStart=function(){this.adCore.seekStart()},a.prototype.reportAd=function(t,e){this.adCore.reportAd(io.toAdCoreType(t),e)},a.prototype.getAdParams=function(t){var e=Ao({adScene:io.getAdScene(t.adType),params:this.getLoadAdParams(t),playerData:this.adCore.outerApi.playerData}),o=e[go[e.ad_scene]];return this.updateConfig(e.ad_scene,o),this.logger.log("getAdParams",t,e),{adparam:t,sspAdParam:e}},a.prototype.destroy=function(){i.prototype.destroy.call(this),this.adCore.destroy(),this.player.off(e.H5_PLAY_EVENT.PLAY_SESSION_START,this.onPlaySessionStart)},a.prototype.bindPlayerEvent=function(){var o=this;this.adCore.adEventEmitter.on(t.AD_EVENT.AD_STOP,(function(t){o.emit(e.H5_PLAY_EVENT.AD_END,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_LOAD_START,(function(t){"number"==typeof t.index&&o.emit(e.H5_PLAY_EVENT.AD_REQ_ASSETS_START,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_LOAD_COMPLETE,(function(t){(void 0===t.isAllLoaded||t.isAllLoaded)&&o.emit(e.H5_PLAY_EVENT.AD_ASSETS_LOADED,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_PAUSE,(function(t){o.emit(e.H5_PLAY_EVENT.AD_PAUSE,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_RESUME,(function(t){o.emit("AD_RESUME",o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_PLAYING,(function(t){o.emit(e.H5_PLAY_EVENT.AD_PLAYING,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_TIME_UPDATE,(function(t){o.emit(e.H5_PLAY_EVENT.AD_TIME_UPDATE,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_VOLUME_CHANGE,(function(t){o.emit(e.H5_PLAY_EVENT.AD_VOLUME_CHANGE,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_SET_LOADING,(function(t){o.emit(e.H5_EXT_EVENT.SET_LOADING,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_AUTOPLAY_BLOCKED,(function(t){o.emit(e.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_COUNTDOWN_CHANGE,(function(t){o.emit("AD_COUNTDOWN_CHANGE",o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_ENTER_COUNTDOWN,(function(t){o.emit("enterCountdownEvt",o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_ENTER_COUNTDOWN_COMPLETE,(function(t){o.emit("enterCountdownCompleteEvt",o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_PLAYER_SESSION_START,(function(t){o.emit("adPlayerSessionStartEvt",o.transformEventData(t))})),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_PLAYER_SESSION_END,(function(t){o.emit("adPlayerSessionEndEvt",o.transformEventData(t))}))},a.prototype.transformEventData=function(t){return n(n({},t),{adType:this.transformToThumbPlayerAdType(t.adType),coreAdType:t.adType,h5AdType:this.transformToH5Type(t.adType)})},a.prototype.updateConfig=function(t,e){var o,i,r;if(e){var n={playerVersion:e.player.version,playerPf:e.platform.platform,playerPfEx:e.platform.device,playerFlowid:e.video.flow_id,playerGuid:e.platform.guid,playerCid:e.video.base.cid,playerVid:e.video.base.vid,playerPt:e.player.play_type,playerPu:e.user_type,playerPlatform:"".concat(null!==(o=e.platform.play_platform)&&void 0!==o?o:""),playerTpid:"".concat(null!==(i=e.video.type_id)&&void 0!==i?i:"")};t===W.ANCHOR&&(n.playerSessionId=null!==(r=e.video.session_id)&&void 0!==r?r:""),this.setConf({playerData:n})}},a.prototype.updateAdapterFromConfig=function(){var t,e,o,i,r,n,a,s,d,l,p;null===(t=this.adCore.postPlayer)||void 0===t||t.setOptions({flowId:null===(e=this.config.playerData)||void 0===e?void 0:e.playerFlowid,guId:null===(o=this.config.playerData)||void 0===o?void 0:o.playerGuid,isOpenCache:this.config.opencache,isUseDemuxKernel:this.config.isUseDemuxKernel,playerVideoDom:null===(i=this.config.playerData)||void 0===i?void 0:i.playerVideoDom}),null===(r=this.adCore.pausePlayer)||void 0===r||r.setOptions({flowId:null===(n=this.config.playerData)||void 0===n?void 0:n.playerFlowid,guId:null===(a=this.config.playerData)||void 0===a?void 0:a.playerGuid,isOpenCache:this.config.opencache,isUseDemuxKernel:this.config.isUseDemuxKernel}),null===(s=this.adCore.outerApi)||void 0===s||s.setOptions({playerData:null!==(d=this.config.playerData)&&void 0!==d?d:{playerPf:je.H5},playerMethod:null!==(l=this.config.playerMethod)&&void 0!==l?l:{},showCloseButton:"function"==typeof(null===(p=this.config.playerMethod)||void 0===p?void 0:p.showOpenVIPGuide),forbidLinkJump:this.config.forbidLinkJump})},a.prototype.transformToThumbPlayerAdType=function(t){var e,o;return null!==(o=null!==(e=io.toThumbPlayerAdType(t))&&void 0!==e?e:io.toAdTypeV(t))&&void 0!==o?o:"".concat(t)},a.prototype.bindReportEvent=function(){var t=this;this.player.pluginMsg.on(e.H5_EXT_EVENT.PROXY_HTTP_START,(function(e){var o,i=e.data;(null===(o=null==i?void 0:i.buid)||void 0===o?void 0:o.includes("ad"))&&i.sspAdParam&&t.adCore.reportProxyRequest(ut.jsonParse(i.sspAdParam))})),this.player.pluginMsg.on(e.H5_EXT_EVENT.PROXY_HTTP_END,(function(e){var o,i,r,n,a=e.data;if(null===(i=null===(o=null==a?void 0:a.reqParams)||void 0===o?void 0:o.buid)||void 0===i?void 0:i.includes("ad")){var s=ut.getAdScene(null===(r=a.reqParams)||void 0===r?void 0:r.sspAdParam);(null===(n=a.parseData)||void 0===n?void 0:n.ad)?t.adCore.reportProxyResponse(ut.parseProxyAdResponse(a.parseData.ad,s)):t.adCore.reportProxyResponse({ad_scene:null!=s?s:-1,has_error:"1",url:window.location.href,resData:a.resData,xhrReqData:a.xhrReqData,reqParams:a.reqParams,error:a.error})}})),this.player.pluginMsg.on(e.H5_EXT_EVENT.FLOW_NODE_END,(function(t){var e,o;"VideoFlowNode"===(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.name)&&"normal"===(null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.videoEndState)&&Ht.reportVideoNearEnd()}))},a.prototype.hasAdOrder=function(t){var e=function(t){return!!t&&(!!t.empty.length||!!t.orders.length)};if(t===J.PRE){var o=e(this.adCore.getAdOrder(J.PRE)),i=e(this.adCore.getAdOrder(J.BROADCAST));return o||i}return e(this.adCore.getAdOrder(t))},a.prototype.getLoadAdParams=function(t){var i,r,a,s=this.player;return n({flowId:s.getCommonKv(e.COMMON_DATA_KEY.flowid),guId:s.getCommonKv(e.COMMON_DATA_KEY.guid),coverId:s.getCommonKv(e.COMMON_DATA_KEY.cid),vid:s.getCommonKv(e.COMMON_DATA_KEY.vid),livePid:s.getCommonKv(e.COMMON_DATA_KEY.livepid),v:s.getCommonKv(e.COMMON_DATA_KEY.playerver),pt:s.getCommonKv(e.COMMON_DATA_KEY.playertype),platform:s.getCommonKv(e.COMMON_DATA_KEY.platform),url:s.getCommonKv(e.COMMON_DATA_KEY.url),refer:null!==(i=s.getCommonKv(e.COMMON_DATA_KEY.referrer))&&void 0!==i?i:"",live:s.config.type===o.PLAY_MODE.LIVE?"1":"0",sessionId:null===(r=s.getCommonKv("getinfoAdInfo"))||void 0===r?void 0:r.adsid,fmt:null!==(a=s.getCommonKv(e.COMMON_DATA_KEY.currentDefn))&&void 0!==a?a:s.getCommonKv(e.PersistedUserSettings.definition)},t)},a}(e.Plugin),Co=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.load=function(){t.prototype.load.call(this),this.play()},e.prototype.play=function(){t.prototype.play.call(this),this.show();var e=this.adCore.outerApi.videoPlayData.playtime;this.adInfo.reporter.reportExposure({__TIME_OFFSET__:"".concat(1e3*e)}),Ht.reportExposure(this.adInfo),this.stop()},e.prototype.stop=function(){var e;t.prototype.stop.call(this),Ht.reportEnded(this.order,{ad_playtime:-1,first_view:null!==(e=this.data.showTime)&&void 0!==e?e:-1}),this.destroy()},e}(xe),To=function(){function t(){this.logger=V("AdWatcher")}return t.prototype.init=function(t){this.adCore=t},t.prototype.reset=function(){},t}(),xo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleVideoTimeupdate=function(t){var o=t.data.playtime;e.timeupdate(1e3*o)},e}return r(e,t),e.prototype.startWatch=function(){this.adCore.outerApi.on(B.VIDEO_TIMEUPDATE,this.handleVideoTimeupdate)},e.prototype.endWatch=function(){this.adCore.outerApi.off(B.VIDEO_TIMEUPDATE,this.handleVideoTimeupdate)},e}(To),bo=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleVideoPlaySessionEnd=function(){var e=t.adCore.orderCtrl.getPoints(J.ANCHOR_EMPTY);(null==e?void 0:e.length)&&e.forEach((function(e){var o=t.adCore.orderCtrl.getPointOrderFromPoint(J.ANCHOR_EMPTY,e);o&&0!==o.orders.length&&o.pointStatus===Ge.INIT&&(o.pointStatus=Ge.LOADING,t.adCore.loadAdOrder(o).then((function(){o.pointStatus=Ge.END})).catch((function(t){})))}))},t}return r(o,e),o.prototype.startWatch=function(){e.prototype.startWatch.call(this),this.adCore.outerApi.on(B.VIDEO_PLAY_SESSION_END,this.handleVideoPlaySessionEnd),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_STOP_ALL,this.handleVideoPlaySessionEnd)},o.prototype.endWatch=function(){e.prototype.endWatch.call(this),this.adCore.outerApi.off(B.VIDEO_PLAY_SESSION_END,this.handleVideoPlaySessionEnd),this.adCore.adEventEmitter.off(t.AD_EVENT.AD_STOP_ALL,this.handleVideoPlaySessionEnd)},o.prototype.timeupdate=function(t){var e=this;this.adCore.outerApi.isSoloPlayingPhls||this.adCore.orderCtrl.getPoints(J.ANCHOR_EMPTY).forEach((function(o){var i=e.adCore.orderCtrl.getPointOrderFromPoint(J.ANCHOR_EMPTY,o);i&&0!==i.orders.length&&t>=o.begin&&i.pointStatus===Ge.INIT&&(i.pointStatus=Ge.LOADING,e.adCore.loadAdOrder(i).then((function(){i.pointStatus=Ge.END})).catch((function(t){})))}))},o}(xo);function Do(){return[/^http(s?):\/\/v\.qq(\.com)\/x\/(cover|page)\//.test(window.location.href),Mt.browser.qqlive].some((function(t){return t}))}var Po,No,wo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.requestAnchorOrder=function(t){t.data.isFirst&&Do()&&(Mt.mobile||"vod"!==e.adCore.outerApi.videoPlayData.type||e.adCore.outerApi.requestProxyHttp(W.ANCHOR))},e.onVideoSetLevelEnd=function(t){var o,i,r;Mt.mobile||"vod"!==e.adCore.outerApi.videoPlayData.type||"0"===(null===(o=t.data)||void 0===o?void 0:o.code)&&Do()&&(null!==(i=e.adCore.outerApi.playerData.playerSessionId)&&void 0!==i?i:"")!==(null!==(r=e.adCore.outerApi.sessionId)&&void 0!==r?r:"")&&e.adCore.outerApi.requestProxyHttp(W.ANCHOR)},e}return r(e,t),e.prototype.startWatch=function(){this.adCore.outerApi.on(B.VIDEO_PLAYING,this.requestAnchorOrder),this.adCore.outerApi.on(B.AD_SESSION_ID_CHANGE,this.requestAnchorOrder),this.adCore.outerApi.on(B.VIDEO_SETLEVEL_END,this.onVideoSetLevelEnd)},e.prototype.endWatch=function(){this.adCore.outerApi.off(B.VIDEO_PLAYING,this.requestAnchorOrder),this.adCore.outerApi.off(B.AD_SESSION_ID_CHANGE,this.requestAnchorOrder),this.adCore.outerApi.off(B.VIDEO_SETLEVEL_END,this.onVideoSetLevelEnd)},e}(To),So=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.load=function(){return t.prototype.load.call(this,{type:"video/mp4"})},e.prototype.destroy=function(){this.loadedUrl&&(this.loadedUrl=void 0)},e}(function(){function t(t){this.options=t}return Object.defineProperty(t.prototype,"materialUrl",{get:function(){return this.loadedUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loadTime",{get:function(){return this.loadEndTime&&this.loadStartTime?this.loadEndTime-this.loadStartTime:-1},enumerable:!1,configurable:!0}),t.prototype.load=function(t){var e=this;if(this.loadedUrl)return Promise.resolve(this.loadedUrl);this.loadStartTime=Date.now();var o=this.options.url,i=new XMLHttpRequest,r=o.replace("http://","https://");return i.open("GET",r,!0),i.responseType="arraybuffer",i.timeout=6e3,i.send(),new Promise((function(o,r){i.onload=function(){if(200===i.status){var n=new Uint8Array(i.response),a=window.URL.createObjectURL(new Blob([n],t));e.loadedUrl=a,e.loadEndTime=Date.now(),o(a)}else r()},i.onerror=function(){e.loadEndTime=Date.now(),r("error")},i.ontimeout=function(){e.loadEndTime=Date.now(),r("timeout")}}))},t}()),Oo=function(){function t(t,e){void 0===e&&(e=20);var o=this;this.state={isRunning:!1,runningTime:0,startTime:0},this.requestAnimationFrameId=null,this.timeupdate=function(){if(o.state.isRunning){var t=Date.now(),e=o.state.startTime,i=t-o.state.startTime;i>o.interval&&(o.state.startTime=t-i%o.interval,o.state.runningTime=Math.floor(o.state.runningTime+(o.state.startTime-e)),o.callback(o.state.runningTime)),o.requestAnimationFrameId=window.requestAnimationFrame(o.timeupdate)}},this.fps=e,this.interval=1e3/e,this.callback=t}return Object.defineProperty(t.prototype,"isRunning",{get:function(){return this.state.isRunning},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.state.runningTime},enumerable:!1,configurable:!0}),t.prototype.seek=function(t){this.state.runningTime=t},t.prototype.start=function(){this.state.isRunning||(this.state.isRunning=!0,this.state.startTime=Date.now(),this.callback(this.state.runningTime),this.timeupdate())},t.prototype.pause=function(){this.state.isRunning&&(this.state.isRunning=!1,this.requestAnimationFrameId&&window.cancelAnimationFrame(this.requestAnimationFrameId),this.state.startTime=0)},t.prototype.stop=function(){this.pause(),this.state.runningTime=0},t}();!function(t){t.CACHE="cache",t.VIDEO="video"}(Po||(Po={})),function(t){t.CANPLAY="tp-canplay",t.LOADED="tp-loaded",t.PLAY="tp-play",t.PAUSE="tp-pause",t.ENDED="tp-ended",t.ERROR="tp-error",t.TIMEUPDATE="tp-timeupdate"}(No||(No={}));var Lo,Vo={autoplay:!0,loop:!1,useCache:!1,fps:20,width:0,height:0},Ro=function(){function t(t){var e=this;this.eventEmitter=new c.exports.EventEmitter,this.logger=V("TransparentPlayer"),this.replayTimer=null,this.videoSize={width:0,height:0},this.displayOffset={scale:1,width:0,height:0},this.unbindVideoEvent=function(){e.$domNodes.video&&(e.$domNodes.video.removeEventListener("canplaythrough",e.handleVideoCanplay),e.$domNodes.video.removeEventListener("playing",e.handleVideoPlaying),e.$domNodes.video.removeEventListener("play",e.handleVideoPlay),e.$domNodes.video.removeEventListener("pause",e.handleVideoPause),e.$domNodes.video.removeEventListener("ended",e.handleVideoEnded),e.$domNodes.video.removeEventListener("error",e.handleVideoError),e.$domNodes.video.removeEventListener("progress",e.handleVideoProgress))},this.bindCacheVideoEvent=function(){e.$domNodes.cacheVideo&&e.$domNodes.cacheVideo.addEventListener("canplaythrough",e.handleCacheVideoCanplay)},this.unbindCacheVideoEvent=function(){e.$domNodes.cacheVideo&&e.$domNodes.cacheVideo.removeEventListener("canplaythrough",e.handleCacheVideoCanplay)},this.handleVideoCanplay=function(){e.emit(No.CANPLAY,{playType:Po.VIDEO,currentTime:e.fpsTimer.currentTime})},this.handleVideoPlay=function(){e.emit(No.PLAY,{playType:Po.VIDEO,currentTime:e.fpsTimer.currentTime})},this.handleVideoPlaying=function(){var t=e.$domNodes.video;t&&(e.updateBufferVideoUI(t),e.fpsTimer.start())},this.handleVideoPause=function(){e.$domNodes.video&&(e.fpsTimer.pause(),e.emit(No.PAUSE,{playType:Po.VIDEO,currentTime:Math.floor(1e3*e.$domNodes.video.currentTime)}))},this.handleVideoEnded=function(){if(e.$domNodes.video){var t=e.$domNodes.video.currentTime;e.$domNodes.video.currentTime=0,e.doEnded(t)}},this.handleVideoError=function(t){e.emit(No.ERROR,{playType:Po.VIDEO,currentTime:0,msg:t.message}),e.destroy()},this.handleVideoProgress=function(t){if(!e.isVideoLoaded){for(var o=t.target,i=o.duration,r=o.buffered,n=0,a=0;n<r.length;)a+=r.end(n)-r.start(n),n+=1;a/i>.99&&(e.isVideoLoaded=!0,e.emit(No.LOADED,{playType:Po.VIDEO,currentTime:1e3*o.currentTime}))}},this.handleCacheEnded=function(){e.cacheData&&(e.cacheData.isCached=!0,e.destroyCacheVideo())},this.handleCacheVideoCanplay=function(){var t=e.$domNodes.cacheVideo;if(t&&e.cacheData&&e.bufferContext){e.updateBufferVideoUI(t);var o=e.cacheData.currentIndex;e.cacheData.currentIndex+=1;var i=e.getFrameImageData(t,e.bufferContext);e.cacheData.imageDataList[o]=i;var r=1e3*t.duration;e.cacheData.currentTime+=e.cacheData.fpsInterval,e.cacheData.currentTime=Math.min(e.cacheData.currentTime,r),e.cacheData.currentTime>=r?e.handleCacheEnded():t.currentTime=e.cacheData.currentTime/1e3}},this.handleTimeUpdate=function(t){var o;if(e.fpsTimer.isRunning)if(null===(o=e.cacheData)||void 0===o?void 0:o.isRunning){var i=e.getCacheDataIndex(t);if(i>e.cacheData.imageDataList.length)return void e.doEnded(t/1e3);var r=e.cacheData.imageDataList[i];e.drawDisplayFrame(r),e.emit(No.TIMEUPDATE,{playType:Po.CACHE,currentTime:t})}else{var n=e.$domNodes.video;if(!n||!e.bufferContext)return;r=e.getFrameImageData(n,e.bufferContext);e.drawDisplayFrame(r),e.emit(No.TIMEUPDATE,{playType:Po.VIDEO,currentTime:1e3*n.currentTime})}},this.options=n(n({},Vo),t),this.$domNodes=this.createUI(),this.bufferContext=this.$domNodes.bufferCanvas.getContext("2d"),this.displayContext=this.$domNodes.displayCanvas.getContext("2d"),this.fpsTimer=new Oo(this.handleTimeUpdate,this.options.fps),this.bindVideoEvent(),this.options.useCache&&this.runCache()}return Object.defineProperty(t.prototype,"playtime",{get:function(){var t;if(null===(t=this.cacheData)||void 0===t?void 0:t.isRunning)return this.fpsTimer.currentTime;var e=this.$domNodes.video;return e?1e3*e.currentTime:-1},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e){this.eventEmitter.on(t,e)},t.prototype.off=function(t,e){this.eventEmitter.off(t,e)},t.prototype.play=function(){this.fpsTimer.isRunning||this.startPlay()},t.prototype.pause=function(){var t,e;this.fpsTimer.isRunning&&((null===(t=this.cacheData)||void 0===t?void 0:t.isRunning)?this.fpsTimer.pause():null===(e=this.$domNodes.video)||void 0===e||e.pause())},t.prototype.seek=function(t){this.fpsTimer.seek(1e3*t),this.$domNodes.video&&(this.$domNodes.video.currentTime=t)},t.prototype.stop=function(){var t;this.fpsTimer.stop(),!(null===(t=this.cacheData)||void 0===t?void 0:t.isRunning)&&this.$domNodes.video&&(this.$domNodes.video.currentTime=0,this.$domNodes.video.pause()),this.displayContext.clearRect(0,0,this.videoSize.width/2,this.videoSize.height)},t.prototype.resize=function(t,e){this.options.width=t,this.options.height=e;var o=this.displayContext.getImageData(this.displayOffset.width,this.displayOffset.height,Math.floor(this.videoSize.width/2),this.videoSize.height);this.updateDisplayUI(),this.drawDisplayFrame(o)},t.prototype.destroy=function(){this.stop(),this.replayTimer&&clearTimeout(this.replayTimer),this.destroyVideo(),this.destroyCacheVideo(),this.destroyBufferCanvas()},t.prototype.createVideo=function(t){var e=document.createElement("video");return e.autoplay=t,e.controls=!1,e.crossOrigin="*",e.playsInline=!0,e.style.cssText=Xt({position:"absolute",backgroundColor:"rgb(255, 255, 255)",zIndex:"-1",visibility:"hidden"}),e.muted=!0,e.src=this.options.url,e},t.prototype.createUI=function(){var t=document.createDocumentFragment(),e=this.createVideo(!!this.options.autoplay);t.appendChild(e);var o=document.createElement("canvas"),i=document.createElement("canvas");t.appendChild(i);var r,n=this.options.container;return(r="string"==typeof n?document.querySelector(n):n).style.overflow="hidden",r.appendChild(t),{container:r,video:e,bufferCanvas:o,displayCanvas:i}},t.prototype.destroyVideo=function(){var t,e=this.$domNodes.video;e&&(this.unbindVideoEvent(),e.removeAttribute("src"),null===(t=e.parentNode)||void 0===t||t.removeChild(e),this.$domNodes.video=void 0,this.destroyBufferCanvas())},t.prototype.destroyCacheVideo=function(){var t,e=this.$domNodes.cacheVideo;e&&(this.unbindCacheVideoEvent(),e.removeAttribute("src"),null===(t=e.parentNode)||void 0===t||t.removeChild(e),this.$domNodes.cacheVideo=void 0,this.destroyBufferCanvas())},t.prototype.destroyBufferCanvas=function(){this.$domNodes.video||this.$domNodes.cacheVideo||(this.$domNodes.bufferCanvas=void 0,this.bufferContext=void 0)},t.prototype.updateBufferVideoUI=function(t){if(!this.videoSize.width){this.videoSize={width:Math.floor(t.videoWidth),height:Math.floor(t.videoHeight)};var e=this.$domNodes.bufferCanvas;e&&(e.width=this.videoSize.width,e.height=this.videoSize.height),this.updateDisplayUI()}},t.prototype.updateDisplayUI=function(){var t={width:Math.floor(this.videoSize.width/2),height:this.videoSize.height},e=t.width/t.height,o=this.options.width||this.options.height*e||t.width,i=o/Math.floor(this.options.height||this.options.width/e||t.height),r={width:t.width,height:t.height};e>i?r.height=Math.floor(r.width/i):r.width=r.height*i;var n=this.$domNodes.displayCanvas;n.setAttribute("width","".concat(r.width)),n.setAttribute("height","".concat(r.height));var a={position:"absolute",left:0,bottom:0,width:"".concat(r.width,"px"),height:"".concat(r.height,"px"),display:"block","transform-origin":"0 100%"};n.style.cssText=Xt(a),this.displayOffset={scale:o/r.width,width:Math.floor((r.width-t.width)/2),height:Math.floor((r.height-t.height)/2)}},t.prototype.bindVideoEvent=function(){this.$domNodes.video&&(this.$domNodes.video.addEventListener("canplaythrough",this.handleVideoCanplay),this.$domNodes.video.addEventListener("playing",this.handleVideoPlaying),this.$domNodes.video.addEventListener("play",this.handleVideoPlay),this.$domNodes.video.addEventListener("pause",this.handleVideoPause),this.$domNodes.video.addEventListener("ended",this.handleVideoEnded),this.$domNodes.video.addEventListener("error",this.handleVideoError),this.$domNodes.video.addEventListener("progress",this.handleVideoProgress))},t.prototype.startPlay=function(){var t,e;if(null===(t=this.cacheData)||void 0===t?void 0:t.isCached)return this.cacheData.isRunning=!0,this.emit(No.PLAY,{playType:Po.CACHE,currentTime:this.fpsTimer.currentTime}),this.fpsTimer.start(),void this.destroyVideo();null===(e=this.$domNodes.video)||void 0===e||e.play()},t.prototype.doEnded=function(t){var e;this.fpsTimer.stop(),this.options.loop?this.replay():this.stop(),this.emit(No.ENDED,{playType:(null===(e=this.cacheData)||void 0===e?void 0:e.isRunning)?Po.CACHE:Po.VIDEO,currentTime:t})},t.prototype.replay=function(){var t=this;this.options.loopInterval?(this.stop(),this.replayTimer=window.setTimeout((function(){t.startPlay(),t.replayTimer=null}),Number(this.options.loopInterval))):this.startPlay()},t.prototype.drawDisplayFrame=function(t){t&&this.displayContext.putImageData(t,this.displayOffset.width,this.displayOffset.height),this.$domNodes.displayCanvas.style.transform="scale(".concat(this.displayOffset.scale,")")},t.prototype.emit=function(t,e){this.eventEmitter.emit(t,e)},t.prototype.getFrameImageData=function(t,e){var o;try{var i=this.videoSize,r=i.width,n=i.height;e.drawImage(t,0,0,r,n);for(var a=e.getImageData(r/2,0,r/2,n),s=e.getImageData(0,0,r/2,n),d=s.data.length/4,l=0;l<d;l++)s.data[4*l+3]=a.data[4*l+1];return s}catch(e){this.emit(No.ERROR,{playType:(null===(o=this.cacheData)||void 0===o?void 0:o.isRunning)?Po.CACHE:Po.VIDEO,currentTime:t.currentTime,msg:String(e)||"合成透明帧失败"})}},t.prototype.runCache=function(){if(this.cacheData={currentTime:0,fpsInterval:Math.floor(1e3/this.options.fps),imageDataList:[],isCached:!1,isRunning:!1,currentIndex:0},!this.$domNodes.cacheVideo){var t=this.createVideo(!1);this.$domNodes.container.appendChild(t),this.$domNodes.cacheVideo=t,t.currentTime=.001,this.bindCacheVideoEvent()}},t.prototype.getCacheDataIndex=function(t){return this.cacheData?Math.floor(t/this.cacheData.fpsInterval):0},t}(),Mo=function(t){return function(e){return function(t,e){return"".concat("creative-player","-").concat(t,"-").concat(e)}(t,e)}};!function(t){t.CLICK="click",t.MOUSE_ENTER="mouseenter",t.LOAD="load",t.ERROR="error"}(Lo||(Lo={}));var ko=function(){function t(t){this.$domNodes={},this.eventEmitter=new c.exports.EventEmitter,this.outerApi=t,this.container=this.getContainer()}return t.prototype.init=function(){this.mount(),this.domEvents=this.getDomEvents(),this.bindUIEvent()},t.prototype.destroy=function(){this.unbindUIEvent(),this.$domNodes.layer&&this.$domNodes.layer.remove(),this.eventEmitter.removeAllListeners()},t.prototype.on=function(t,e){this.eventEmitter.on("".concat(t),e)},t.prototype.off=function(t,e){this.eventEmitter.off("".concat(t),e)},t.prototype.emit=function(t,e){this.eventEmitter.emit("".concat(t),e)},t.prototype.setDomVisible=function(t,e){e?ne(t):re(t)},t.prototype.getContainer=function(){return this.outerApi.container},t.prototype.mount=function(){if(!this.$domNodes.layer){var t=document.createElement("txpdiv");t.dataset.role=this.roleMap.layer,this.container.appendChild(t),this.$domNodes.layer=t}this.appendDom(this.$domNodes.layer)},t.prototype.appendDom=function(t,e){var o=this;void 0===e&&(e=this.$domNodes);var i=this.getTemplate();i&&(t.innerHTML=i,Object.keys(this.roleMap).forEach((function(i){o.setDomNodes(t,e,i)})))},t.prototype.setDomNodes=function(t,e,o){void 0===e&&(e=this.$domNodes);var i=t.querySelector('[data-role="'.concat(this.roleMap[o],'"]'));i&&(e[o]=i)},t.prototype.bindUIEvent=function(){var t;null===(t=this.domEvents)||void 0===t||t.forEach((function(t){ae(t.el,t.eventName,t.listener)}))},t.prototype.unbindUIEvent=function(){var t;null===(t=this.domEvents)||void 0===t||t.forEach((function(t){se(t.el,t.eventName,t.listener)}))},t.prototype.forwardDomEvent=function(t,e,o,i){var r=this;return void 0===o&&(o=Lo.CLICK),{el:t,eventName:o,listener:function(t){i&&t.stopPropagation(),r.emit(e,{target:t.target})}}},t.prototype.getDomEvents=function(){return[]},t}();qe(".close-icon-circle{stroke-dasharray:114,114;stroke-dashoffset:114}.mod_player_float ._txp_ad_psj{display:none}.flow-close{-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:justify;-ms-flex-pack:justify;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;justify-content:space-between}.flow-close svg{height:100%;width:100%}");var Uo,Bo=Mo("corner"),zo={layer:Bo("layer"),container:Bo("container")},Ho=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=zo,e.cornerMap=new Map,e}return r(e,t),e.prototype.setContainerVisible=function(t){this.setDomVisible(this.$domNodes.container,t)},e.prototype.destroyCorner=function(t){var e=this.cornerMap.get(t);this.$domNodes.container&&e&&(this.$domNodes.container.removeChild(e.container),this.cornerMap.delete(t))},e.prototype.renderCorner=function(t){var e=this;if(this.$domNodes.container&&!this.cornerMap.has(t)){var o={container:t,flag:"".concat(t,"-flag"),close:"".concat(t,"-close"),player:"".concat(t,"-player"),closeRate:"".concat(t,"-close-rate"),hotArea:"".concat(t,"-hot-area"),hotFlag:"".concat(t,"-hot-flag")},i='\n      <txpdiv data-role="'.concat(o.container,'" style="position: absolute;" class="txp_none">\n        <span data-role="').concat(o.hotArea,'" class="yaliu-hot-area txp_none" style="position:absolute;pointer-events:auto;cursor:pointer;z-index:2;display: block;" ></span>\n        <span data-role="').concat(o.flag,'" class="txp_none" style="position: absolute;left: 0;bottom: 0;opacity: .8;line-height: 1;font-size: 12px;transform: scale(.7);z-index: 1;">广告</span>\n        <span data-role="').concat(o.close,'" class="flow-close txp_none" style="position:absolute;pointer-events:auto;cursor:pointer;z-index:2;" title="关闭该广告">\n          <svg class="yaliu-close-text" viewBox="0 0 30 24" style="pointer-events:none;cursor:none">\n            <text data-role="').concat(o.hotFlag,'" x="15" y="15" fill="white" opacity="0.9" transform="scale(0.85)" style="dominant-baseline:middle;text-anchor:middle;pointer-events:none;cursor:none" xmlns="http://www.w3.org/2000/svg">广告</text>\n          </svg>\n          <svg viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <rect x="1" y="1" width="36" height="36" rx="18" fill="black" fill-opacity="0.6"/>\n            <path d="M24.4999 13.6718L13.6408 24.531" stroke="white" stroke-width="2" stroke-linecap="round"/>\n            <path d="M24.3281 24.5L13.469 13.6409" stroke="white" stroke-width="2" stroke-linecap="round"/>\n            <circle data-role="').concat(o.closeRate,'" class="close-icon-circle" stroke-linecap="round" transform="rotate(-90 19 19)" opacity="0.9" cx="19" cy="19" r="18"  fill="none" stroke-width="2" stroke="white" />\n          </svg>\n        </span>\n        <txpdiv data-role="').concat(o.player,'" />\n      </txpdiv>\n    '),r=document.createElement("div");r.innerHTML=i,this.$domNodes.container.appendChild(r.children[0]);var n={};Object.keys(o).forEach((function(t){n[t]=e.$domNodes.container.querySelector('[data-role="'.concat(o[t],'"]'))})),this.cornerMap.set(t,n)}},e.prototype.getCornerDomNodes=function(t){return this.cornerMap.get(t)},e.prototype.getTemplate=function(){return'\n      <txpdiv data-role="'.concat(this.roleMap.container,'" class="txp_ad _txp_ad_psj" style="position: absolute; z-index: 2;">\n      </txpdiv>\n    ')},e}(ko),$o=function(){function t(t,e){this.storageKey=t,this.options=e}return Object.defineProperty(t.prototype,"storage",{get:function(){var t;return(null===(t=this.options)||void 0===t?void 0:t.useSessionStorage)?window.sessionStorage:window.localStorage},enumerable:!1,configurable:!0}),t.prototype.getData=function(t){if(!t&&this.storageData)return this.storageData;try{var e=this.storage.getItem(this.storageKey);if(e)return this.storageData=JSON.parse(e),this.storageData}catch(t){}},t.prototype.setData=function(t){try{this.storageData=t;var e=JSON.stringify(this.storageData);this.storage.setItem(this.storageKey,e)}catch(t){}},t.prototype.clear=function(){this.storage.removeItem(this.storageKey)},t}(),Ko=V("utils/video-url-cache"),Go=102e5,Yo=new $o(no),Fo=function(t){var e={};return Object.entries(t).forEach((function(t){var o=t[0],i=t[1];i&&Date.now()-i.time<=Go&&(e[o]=i)})),e},Wo=(Uo=Yo.getData())?Fo(Uo):{},qo=function(t,e,o){Ko.log("use url cache. ad_type: ".concat(o));var i=ye("fmt",e)||nt.SHD,r=Wo["".concat(i,"-").concat(t)],n=Date.now();return r&&n-r.time<=Go?(Ko.log("vid cache valid, vid: ".concat(t,"  url:").concat(r.url,",   save time: ").concat(new Date(r.time))),r.url):(function(t,e,o){var i=Date.now();Ko.log("save new cache, vid: ".concat(t,"  url:").concat(o,",   save time: ").concat(new Date(i))),Wo["".concat(e,"-").concat(t)]={url:o,time:i},Wo=Fo(Wo),Yo.setData(Wo)}(t,i,e),e)},jo=function(e){function o(t){var o=e.call(this,t)||this;return o.cornerUI=o.adCore.getUIInterface(Ho),o.handleCloseBtnClick=function(t){t.stopPropagation(),o.data.closeBtnClicked=!0,o.stop()},o.handleAdClick=function(){o.adInfo.clickable&&o.openLinkAndReport(o.adInfo,{actionType:pt.AD_VIEW_AREA,playTime:o.data.showTime?Date.now()-o.data.showTime:-1})},o.handleCloseRatePercentTimeupdate=function(t){if(!o.adInfo.isWholeScene){var e=o.cornerUI.getCornerDomNodes(o.cornerAdId);if(null==e?void 0:e.closeRate){var i=1e3*o.adInfo.material.duration,r=Math.min(t/i,1);e.closeRate.style.strokeDashoffset="".concat(114-114*r)}}},o.handleTransparentPlayerCanPlay=function(){o.canplayHandler()},o.fpsTimer=new Oo(o.handleCloseRatePercentTimeupdate,20),o.init(),o}return r(o,e),Object.defineProperty(o.prototype,"cornerAdId",{get:function(){return"corner-ad-".concat(this.adInfo.orderId)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"container",{get:function(){return this.adCore.outerApi.container},enumerable:!1,configurable:!0}),o.prototype.load=function(){var t=this;if(this.adInfo&&this.adInfo.material&&this.adInfo.point){var o=this.adInfo.material.url;o=this.adInfo.material.enable_crt_cached?qo(this.adInfo.material.vid,o,this.adInfo.adType):o,this.videoMaterial=new So({url:o});var i=this.cornerUI.getCornerDomNodes(this.cornerAdId);this.videoMaterial.load().then((function(o){var r,n,a,s;t.transparentPlayer=new Ro({url:o,width:t.containerSize.width,height:t.containerSize.height,container:i.player,loop:!0,useCache:t.adInfo.isWholeScene,autoplay:!1,fps:20,loopInterval:t.adInfo.data.poster.play.interval||0}),t.bindTransparentPlayerEvent(),t.loadCompleteHandle({adType:t.adType,adInfo:t.adInfo,index:t.adInfo.orderIdx,loadingTime:null===(r=t.videoMaterial)||void 0===r?void 0:r.loadTime,materialUrl:null===(n=t.adInfo.material)||void 0===n?void 0:n.url,materialVid:null===(a=t.adInfo.material)||void 0===a?void 0:a.vid,materialDuration:null===(s=t.adInfo.material)||void 0===s?void 0:s.duration,materialType:ot.VIDEO}),e.prototype.load.call(t)})).catch((function(){var e,o,i,r;t.loadCompleteHandle({adType:t.adType,adInfo:t.adInfo,index:t.adInfo.orderIdx,hasError:"1",detailErrorCode:S.LOAD_FAIL,loadingTime:null===(e=t.videoMaterial)||void 0===e?void 0:e.loadTime,materialUrl:null===(o=t.adInfo.material)||void 0===o?void 0:o.url,materialVid:null===(i=t.adInfo.material)||void 0===i?void 0:i.vid,materialDuration:null===(r=t.adInfo.material)||void 0===r?void 0:r.duration,materialType:ot.VIDEO})}))}else this.stop()},o.prototype.play=function(){var t,o,i,r=this,n=this.adCore.outerApi.videoPlayData.playtime;if(this.adInfo.reporter.setVideoPlaytime(1e3*n),this.data.firstStartTime<0&&this.transparentPlayerSeek(),this.fpsTimer.seek(Math.floor(1e3*n)-this.adInfo.point.begin),this.fpsTimer.start(),setTimeout((function(){r.fpsTimer.pause()}),0),this.state!==ge.PLAYING&&this.state!==ge.PAUSED&&!this.data.isForceHide)if(e.prototype.play.call(this),this.adInfo&&this.adInfo.point){null===(t=this.transparentPlayer)||void 0===t||t.play(),this.show(),this.adInfo.reporter.reportExposure(),Ht.reportExposure(this.adInfo);var a=null===(o=this.adInfo.reporter.originExposureReportData.first[0])||void 0===o?void 0:o.reportUrl;Ht.reportTechParam({name:"exposure",ad_type:this.adType,duration:null===(i=this.adInfo.material)||void 0===i?void 0:i.duration,e_time:Date.now()-this.data.createTime,playtime:this.adCore.outerApi.videoPlayData.playtime,orderId:this.adInfo.orderId,reportUrl:a?Ce.getOriginReportUrl(a,this.adInfo):""})}else this.stop()},o.prototype.pause=function(){var t;null===(t=this.transparentPlayer)||void 0===t||t.pause(),this.fpsTimer.pause(),e.prototype.pause.call(this)},o.prototype.resume=function(){var t;null===(t=this.transparentPlayer)||void 0===t||t.play(),e.prototype.resume.call(this)},o.prototype.show=function(o){var i,r=this;if(o&&(this.data.isForceHide=!0,this.transparentPlayerSeek(),null===(i=this.transparentPlayer)||void 0===i||i.play(),this.adInfo.isWholeScene&&setTimeout((function(){r.adCore.adEventEmitter.emit(t.AD_EVENT.AD_MOVE_IN,{adType:r.adType,adInfo:r.adInfo})}),200)),!this.data.isShow){var n=this.cornerUI.getCornerDomNodes(this.cornerAdId);n&&ne(n.container),this.setCloseVisible(!0),e.prototype.show.call(this),this.adCore.outerApi.resetBarrageZindex()}},o.prototype.hide=function(o){var i;if(o&&(this.data.isForceHide=!0,null===(i=this.transparentPlayer)||void 0===i||i.stop(),this.adInfo.isWholeScene&&this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_MOVE_OUT,{adType:this.adType,adInfo:this.adInfo})),this.data.isShow){var r=this.cornerUI.getCornerDomNodes(this.cornerAdId);r&&re(r.container),this.setCloseVisible(!1),e.prototype.hide.call(this),this.adCore.outerApi.resetBarrageZindex()}},o.prototype.stop=function(){var t,o,i,r,n;if(this.state!==ge.END){var a=this.data.closeBtnClicked&&!this.adInfo.isWholeScene&&null!==(o=null===(t=this.transparentPlayer)||void 0===t?void 0:t.playtime)&&void 0!==o?o:-1;this.hide(),null===(i=this.transparentPlayer)||void 0===i||i.stop(),e.prototype.stop.call(this),Ht.reportEnded(this.order,{ad_playtime:this.data.showTime&&!this.adInfo.isWholeScene?Date.now()-this.data.showTime:-1,ad_duration:null===(r=this.adInfo.material)||void 0===r?void 0:r.duration,first_view:null!==(n=this.data.showTime)&&void 0!==n?n:-1,user_close:!!this.data.closeBtnClicked,close_time:a}),this.destroy()}},o.prototype.destroy=function(){var t,o;this.data.hasDestroy||(this.unbindEvent(),this.adCore.getRunningAds(J.CORNER).length<=1&&this.cornerUI.setContainerVisible(!1),this.fpsTimer.stop(),this.cornerUI.destroyCorner(this.cornerAdId),null===(t=this.transparentPlayer)||void 0===t||t.destroy(),null===(o=this.videoMaterial)||void 0===o||o.destroy(),e.prototype.destroy.call(this))},o.prototype.resize=function(t){var e;if(t&&(this.playerSize.width=t.width||t.oWidth||this.playerSize.width,this.playerSize.height=t.height||t.oHeight||this.playerSize.height,this.playerSize.left=t.left||0,this.playerSize.top=t.top||0,this.setFlowSize(),this.setCloseBtnSizeAndPosition(),null===(e=this.transparentPlayer)||void 0===e||e.resize(this.containerSize.width,this.containerSize.height)),!this.data.isForceHide){var o=this.cornerUI.getCornerDomNodes(this.cornerAdId);ne(null==o?void 0:o.container)}},o.prototype.hideAdBeforeResize=function(){var t=this.cornerUI.getCornerDomNodes(this.cornerAdId);t&&re(t.container)},o.prototype.initData=function(){return n(n({},e.prototype.initData.call(this)),{firstStartTime:-1})},o.prototype.init=function(){this.setPlayerSize(),this.cornerUI.setContainerVisible(!0),this.cornerUI.renderCorner(this.cornerAdId),this.updateAdFlag(),this.setFlowSize(),this.setCloseBtnSizeAndPosition(),this.bindEvent()},o.prototype.bindEvent=function(){var t=this.cornerUI.getCornerDomNodes(this.cornerAdId);t&&(t.close.addEventListener("click",this.handleCloseBtnClick),this.adInfo.data.poster.click_hot_area?t.hotArea.addEventListener("click",this.handleAdClick):t.container.addEventListener("click",this.handleAdClick))},o.prototype.unbindEvent=function(){var t;null===(t=this.transparentPlayer)||void 0===t||t.off(No.CANPLAY,this.handleTransparentPlayerCanPlay);var e=this.cornerUI.getCornerDomNodes(this.cornerAdId);e&&(e.close.removeEventListener("click",this.handleCloseBtnClick),this.adInfo.data.poster.click_hot_area?e.hotArea.removeEventListener("click",this.handleAdClick):e.container.removeEventListener("click",this.handleAdClick))},o.prototype.setFlowSize=function(){var t,e=this.cornerUI.getCornerDomNodes(this.cornerAdId);if(e){var o=this.playerSize,i=o.width,r=o.height,n=o.top,a=o.left,s=this.adInfo.data.poster.position,d=Math.ceil(i*Number(s.width)),l=Math.ceil(r*Number(s.height)),p=Number(s.width)/Number(s.height)*(i/r),c=this.adInfo.material.width/2/this.adInfo.material.height;1!==Number(s.width)&&(p>c||1===Number(s.height))?d=Math.ceil(l*c):l=Math.ceil(d/c);var u=Math.floor(d)%2==0?d:d+1,h=l,f=i*Number(s.x_axis)+a,v=r*Number(s.y_axis)+n,m=r-h+n;v=Math.min(v,m);var y={position:"absolute",left:"".concat(f,"px"),top:"".concat(v,"px"),width:"".concat(u,"px"),height:"".concat(h,"px"),cursor:"auto","pointer-events":"none"};if(!this.adInfo.data.poster.click_hot_area&&this.adInfo.clickable&&(y.cursor="pointer",y["pointer-events"]="auto"),e.container.style.cssText=Xt(y),this.adInfo.data.poster.click_hot_area){var _=null!==(t=this.adInfo.data.poster.click_hot_area)&&void 0!==t?t:{},g=_.height_rate,A=void 0===g?0:g,E=_.margin_bottom_rate,I=void 0===E?0:E,C=_.margin_left_rate,T=void 0===C?0:C,x=_.margin_right_rate,b=void 0===x?0:x,D={position:"absolute",left:"".concat(Math.round(u*T),"px"),right:"".concat(Math.round(u*b),"px"),bottom:"".concat(Math.round(h*I),"px"),height:"".concat(Math.round(h*A),"px"),display:"block","z-index":"1",cursor:"auto","pointer-events":"none"};this.adInfo.clickable&&(D.cursor="pointer",D["pointer-events"]="auto"),e.hotArea.style.cssText=Xt(D)}this.containerSize={width:u,height:h,top:v,left:f},this.transparentPlayer&&this.transparentPlayer.resize(u,h)}},o.prototype.setCloseBtnSizeAndPosition=function(){var t=this.cornerUI.getCornerDomNodes(this.cornerAdId);if(null==t?void 0:t.close){var e=this.adInfo.data.poster.close_button;if(!e.height){var o={};return this.playerSize.width>=1920?(o.width="87px",o.height="36px"):(o.width="24px",o.height="24px"),o.top="0px",o.right="0px",o.bottom="auto",o.left="auto",void(t.close.style.cssText+=Xt(o))}var i={width:"".concat(Number(e.width)*this.playerSize.width*2.4,"px"),height:"".concat(Number(e.height)*this.playerSize.height,"px"),top:e.top?"".concat(Number(e.top)*this.playerSize.height,"}px"):"auto",right:e.right?"".concat(Number(e.right)*this.playerSize.width,"px"):"auto",bottom:e.bottom?"".concat(Number(e.bottom)*this.playerSize.height,"px"):"auto",left:e.left?"".concat(Number(e.left)*this.playerSize.width,"px"):"auto"};t.close.style.cssText+=Xt(i)}},o.prototype.setCloseVisible=function(t){var e=this.cornerUI.getCornerDomNodes(this.cornerAdId);(null==e?void 0:e.close)&&(t&&this.adInfo.data.poster.close_button.is_show?ne(e.close):re(e.close))},o.prototype.updateAdFlag=function(){var t=this.cornerUI.getCornerDomNodes(this.cornerAdId);(null==t?void 0:t.flag)&&(this.adInfo.data.poster.ad_flag?ne(t.flag):re(t.flag)),(null==t?void 0:t.hotFlag)&&!this.adInfo.data.poster.show_ad_icon_type&&(t.hotFlag.style.display="none")},o.prototype.setPlayerSize=function(){var t=this.adCore.outerApi.getPlayerSize();this.playerSize={width:t.playerWidth||t.playerOWidth,height:t.playerHeight||t.playerOHeight,left:0,top:0};var e=this.playerSize,o=e.width,i=e.height,r=t.playerOWidth,n=t.playerOHeight;if(o/i<r/n){this.playerSize.left=0;var a=o/r;this.playerSize.height=n*a,this.playerSize.top=(i-this.playerSize.height)/2}else{this.playerSize.top=0;a=i/n;this.playerSize.width=r*a,this.playerSize.left=(o-this.playerSize.width)/2}},o.prototype.transparentPlayerSeek=function(){var t;if(!this.adInfo.isWholeScene){var e=this.adCore.outerApi.videoPlayData.playtime-this.adInfo.point.begin/1e3;this.data.firstStartTime=e,e>0&&(null===(t=this.transparentPlayer)||void 0===t||t.seek(e))}},o.prototype.bindTransparentPlayerEvent=function(){this.transparentPlayer.on(No.CANPLAY,this.handleTransparentPlayerCanPlay)},o.isPointAd=!0,o.isMultiple=!0,o}(xe),Qo=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAdShow=function(e){e.adInfo;t.isNeedCheckType(e.adType)&&t.checkSceneShow()},t.handleAdHide=function(e){!e.adInfo.isWholeScene&&t.isNeedCheckType(e.adType)&&t.checkSceneShow()},t.handleAdPause=function(){t.adCore.pauseAd(J.CORNER)},t.handleAdResume=function(){t.adCore.resumeAd(J.CORNER)},t}return r(o,e),o.prototype.startWatch=function(){e.prototype.startWatch.call(this),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_SHOW,this.handleAdShow),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_HIDE,this.handleAdHide),this.adCore.outerApi.on(B.VIDEO_PAUSE,this.handleAdPause),this.adCore.outerApi.on(B.VIDEO_PLAYING,this.handleAdResume)},o.prototype.endWatch=function(){e.prototype.endWatch.call(this),this.adCore.adEventEmitter.off(t.AD_EVENT.AD_SHOW,this.handleAdShow),this.adCore.adEventEmitter.off(t.AD_EVENT.AD_HIDE,this.handleAdHide),this.adCore.outerApi.off(B.VIDEO_PAUSE,this.handleAdPause),this.adCore.outerApi.off(B.VIDEO_PLAYING,this.handleAdResume)},o.prototype.timeupdate=function(t){var e=this;this.adCore.outerApi.isSoloPlayingPhls||this.adCore.orderCtrl.getPoints(J.CORNER).forEach((function(o){var i=o.type===it.TIMESTAMP?Date.now():t,r=e.adCore.orderCtrl.getPointOrderFromPoint(J.CORNER,o);r&&0!==r.orders.length&&e.checkTime(r,i)}))},o.prototype.checkTime=function(t,e){var o=this,i=t.point;e>=i.begin-6e3&&e<i.begin?this.handlePreLoad(t):e>=i.begin&&e<=i.end?this.handlePlaying(t,e):t.pointStatus!==Ge.INIT&&(t.pointStatus=Ge.INIT,t.orders.forEach((function(t){o.adCore.stopAd(J.CORNER,t.orderId)})))},o.prototype.handlePreLoad=function(t){var e=this;t.pointStatus!==Ge.INIT?t.pointStatus===Ge.PLAYING&&(t.pointStatus=Ge.INIT,t.orders.forEach((function(t){e.adCore.stopAd(J.CORNER,t.orderId)}))):this.load(t)},o.prototype.handlePlaying=function(t,e){var o=this;e===t.point.begin&&t.pointStatus===Ge.PLAYING&&(t.pointStatus=Ge.INIT,t.orders.forEach((function(t){o.adCore.stopAd(J.CORNER,t.orderId)}))),t.pointStatus!==Ge.INIT?[Ge.LOADING,Ge.PLAYING].includes(t.pointStatus)&&(t.pointStatus=Ge.PLAYING,t.orders.forEach((function(t){o.adCore.playAd(J.CORNER,t.orderId)}))):this.load(t)},o.prototype.load=function(t){var e=this,o=this.adCore.getRunningAds(J.CORNER);t.orders.forEach((function(i){i.point.type===it.TIMESTAMP&&o.some((function(t){return!t.adInfo.isWholeScene}))||(i.isWholeScene||o.forEach((function(t){t.adInfo.point.type===it.TIMESTAMP&&t.stop()})),t.pointStatus=Ge.LOADING,e.adCore.loadAdOrder(n(n({},t),{orders:[i],empty:[]})).catch((function(){var t;null===(t=e.logger)||void 0===t||t.error("loadAd 失败",J.CORNER)})))}))},o.prototype.isNeedCheckType=function(t){return[J.PAUSE,J.CORNER,J.HLS_MID,J.MID].includes(t)},o.prototype.checkSceneShow=function(){var t=this.adCore.getRunningAds(J.CORNER),e=this.hasOtherShow();t.forEach((function(t){t.adInfo.isWholeScene&&(e&&t.data.isShow?t.hide(!0):t.data.isShow||t.show(!0))}))},o.prototype.hasOtherShow=function(){return!!Array.from(this.adCore.adCtrl.runningSingleAdMap.values()).some((function(t){return t.data.isShow&&![J.PROGRESS_PREVIEW,J.VIDEO_RESOLUTION].includes(t.adType)}))||Array.from(this.adCore.adCtrl.runningMultipleAdMap.entries()).some((function(t){var e=t[0],o=t[1];return[J.CORNER].includes(e)?Array.from(o.values()).some((function(t){return t.data.isShow&&!t.adInfo.isWholeScene})):Array.from(o.values()).some((function(t){return t.data.isShow}))}))},o}(xo),Jo=Mo("hls-mid"),Xo={layer:Jo("layer"),clickHotArea:Jo("click-hot-area")},Zo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=Xo,e.eventMap=new Map,e}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.$domNodes.layer&&(this.$domNodes.layer.style.cssText+="position: absolute; width: 100%; height: 100%; pointer-events: auto; z-index: 3;")},e.prototype.onMaskClick=function(t,e){var o=this.eventMap.get(t);o||(o=new Set),o.add(e),this.eventMap.set(t,o)},e.prototype.offMaskClick=function(t,e){var o=this.eventMap.get(t);o&&o.delete(e)},e.prototype.hideLayer=function(){re(this.$domNodes.layer)},e.prototype.showJumpMaskOnly=function(){ee(this.$domNodes.layer,{pointerEvents:"auto",cursor:"pointer"}),ne(this.$domNodes.layer),re(this.$domNodes.clickHotArea)},e.prototype.showHotArea=function(){ee(this.$domNodes.layer,{pointerEvents:"none",cursor:"auto"}),ee(this.$domNodes.clickHotArea,{pointerEvents:"auto",cursor:"pointer"}),ne(this.$domNodes.layer),ne(this.$domNodes.clickHotArea)},e.prototype.getDomEvents=function(){var t=this;return[{el:this.$domNodes.layer,eventName:Lo.CLICK,listener:function(e){e.target.dataset.role===t.roleMap.layer&&t.eventMap.forEach((function(e){if(e.size>0){var o=Array.from(e.values())[0];null==o||o({role:t.roleMap.layer})}}))}},{el:this.$domNodes.clickHotArea,eventName:Lo.CLICK,listener:function(){t.eventMap.forEach((function(e){if(e.size>0){var o=Array.from(e.values())[0];null==o||o({role:t.roleMap.clickHotArea})}}))}}]},e.prototype.getTemplate=function(){return'<txpdiv data-role="'.concat(this.roleMap.clickHotArea,'" style="position: absolute; pointer-events: auto"></txpdiv>')},e}(ko),ti=function(t){function e(e){var o=t.call(this,e)||this;return o.hlsMidUI=o.adCore.getUIInterface(Zo),o.handleClick=function(t){o.adInfo.clickable&&(o.adInfo.hasHotArea||t.role!==Xo.layer||o.open(),o.adInfo.hasHotArea&&t.role===Xo.clickHotArea&&o.open())},o.init(),o}return r(e,t),e.prototype.show=function(){this.data.isShow||(this.setJumpMaskVisible(!0),t.prototype.show.call(this))},e.prototype.hide=function(){this.data.isShow&&(this.setJumpMaskVisible(!1),t.prototype.hide.call(this))},e.prototype.load=function(){t.prototype.load.call(this),this.adInfo&&this.adInfo.point||this.stop()},e.prototype.play=function(){var e=this.adCore.outerApi.videoPlayData.playtime;this.adInfo.reporter.setVideoPlaytime(1e3*e),this.state!==ge.PLAYING&&this.state!==ge.PAUSED&&(this.adInfo&&this.adInfo.point?(t.prototype.play.call(this),this.show(),this.adInfo.reporter.reportExposure(),Ht.reportExposure(this.adInfo)):this.stop())},e.prototype.stop=function(){var e;this.state!==ge.END&&(this.hide(),t.prototype.stop.call(this),Ht.reportEnded(this.order,{ad_playtime:this.data.showTime?Date.now()-this.data.showTime:-1,first_view:null!==(e=this.data.showTime)&&void 0!==e?e:-1}),this.destroy())},e.prototype.destroy=function(){this.data.hasDestroy||(this.unbindUIEvent(),t.prototype.destroy.call(this))},e.prototype.resize=function(){this.resizeHotArea()},e.prototype.init=function(){this.setJumpMaskVisible(!1),this.bindUIEvent()},e.prototype.bindUIEvent=function(){this.hlsMidUI.onMaskClick(this.adInfo.orderId,this.handleClick)},e.prototype.unbindUIEvent=function(){this.hlsMidUI.offMaskClick(this.adInfo.orderId,this.handleClick)},e.prototype.open=function(){this.openLinkAndReport(this.adInfo,{actionType:pt.AD_VIEW_AREA,playTime:this.data.showTime?Date.now()-this.data.showTime:-1})},e.prototype.setJumpMaskVisible=function(t){this.adInfo.clickable&&t?this.adInfo.hasHotArea?(this.resizeHotArea(),this.hlsMidUI.showHotArea()):this.hlsMidUI.showJumpMaskOnly():this.hlsMidUI.hideLayer()},e.prototype.resizeHotArea=function(){if(this.adInfo.hasHotArea&&this.adInfo.material){var t,e,o,i,r=this.adInfo.material,n=r.width/r.height,a=this.adCore.outerApi.getPlayerSize(),s=a.playerWidth,d=a.playerHeight,l=a.playerOWidth,p=a.playerOHeight,c=s||l,u=d||p;n>c/u?(t=c,i=0,o=(u-(e=c/n))/2):(e=u,i=(c-(t=u*n))/2,o=0);var h=this.adInfo.clickHotArea,f=h.height_rate,v=void 0===f?0:f,m=h.margin_bottom_rate,y=h.margin_left_rate,_=h.margin_right_rate,g={position:"absolute",left:"".concat(Math.round(t*y+i),"px"),right:"".concat(Math.round(t*_+i),"px"),bottom:"".concat(Math.round(e*m+o),"px"),height:"".concat(Math.round(e*v),"px"),cursor:"pointer","pointer-events":"auto"};this.hlsMidUI.$domNodes.clickHotArea&&(this.hlsMidUI.$domNodes.clickHotArea.style.cssText=Xt(g))}},e.isPointAd=!0,e.isMultiple=!0,e}(xe),ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.timeupdate=function(t){var e=this,o=this.adCore.orderCtrl.getPoints(J.HLS_MID),i=this.adCore.outerApi,r=i.phlsPlayType,n=i.isSoloPlayingPhls,a=i.soloPlayPhlsTimeOffset;(1!==r||n)&&(n&&a>=0&&(t+=a),o.forEach((function(o){var i=e.adCore.orderCtrl.getPointOrderFromPoint(J.HLS_MID,o);i&&0!==i.orders.length&&e.checkTime(i,t)})))},e.prototype.checkTime=function(t,e){var o=this,i=t.point;e>=i.begin-2e3&&e<=i.begin?this.handlePreLoad(t):e>=i.begin&&e<=i.end?this.handlePlaying(t):t.pointStatus!==Ge.INIT&&(t.pointStatus=Ge.INIT,t.orders.forEach((function(t){o.adCore.stopAd(J.HLS_MID,t.orderId)})))},e.prototype.handlePreLoad=function(t){var e=this;t.pointStatus!==Ge.INIT?t.pointStatus===Ge.PLAYING&&(t.pointStatus=Ge.INIT,t.orders.forEach((function(t){e.adCore.stopAd(J.HLS_MID,t.orderId)}))):this.load(t)},e.prototype.handlePlaying=function(t){var e=this;t.pointStatus!==Ge.INIT?[Ge.LOADING,Ge.PLAYING].includes(t.pointStatus)&&(t.pointStatus=Ge.PLAYING,t.orders.forEach((function(t){e.adCore.playAd(J.HLS_MID,t.orderId)}))):this.load(t)},e.prototype.load=function(t){var e=this;t.orders.forEach((function(o){e.adCore.loadAdOrder(n(n({},t),{orders:[o],empty:[]})).then((function(){t.pointStatus=Ge.LOADING})).catch((function(){var t;null===(t=e.logger)||void 0===t||t.error("loadAd 失败",J.HLS_MID)}))}))},e}(xo),oi=0,ii=Date.now(),ri=function(){function t(t){this.image=null,this.options=t}return Object.defineProperty(t.prototype,"loadTime",{get:function(){return this.loadEndTime&&this.loadStartTime?this.loadEndTime-this.loadStartTime:-1},enumerable:!1,configurable:!0}),t.prototype.load=function(){var t=this;if(this.image)return Promise.resolve(this.image);var e=this.options;return new Promise((function(o,i){var r=new Image;r.id="ad_player_image_material_".concat(ii,"_").concat(oi),r.style.width="100%",r.style.height="100%",e.style&&Object.entries(e.style).forEach((function(t){var e=t[0],o=t[1];r.style[e]=o})),r.onload=function(){t.image=r,oi+=1,t.loadEndTime=Date.now(),o(t.image)},r.onerror=function(t){i(t)},t.loadStartTime=Date.now(),r.src=e.url}))},t.prototype.destroy=function(){this.image&&(this.image.src="",this.image=null)},t}(),ni=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return r(o,e),o.prototype.load=function(){var t=this;this.adInfo.isEmpty&&this.adInfo.reporter.reportExposure(),this.loadMaterial().then((function(){t.loadMaterialSuccess()})).catch((function(){t.loadMaterialFail()}))},o.prototype.play=function(){e.prototype.play.call(this),this.show()},o.prototype.stop=function(){this.state!==ge.END&&(this.hide(),Ht.reportEnded(this.order,{ad_playtime:-1}),e.prototype.stop.call(this),this.destroy())},o.prototype.show=function(){this.data.isShow||(this.ui.setLayerVisible(!0),e.prototype.show.call(this))},o.prototype.hide=function(){this.data.isShow&&(this.ui.setLayerVisible(!1),e.prototype.hide.call(this))},o.prototype.destroy=function(){var t;null===(t=this.data.imageMaterial)||void 0===t||t.destroy(),e.prototype.destroy.call(this)},o.prototype.report=function(){this.adInfo.reporter.reportExposure(),this.adInfo.isEmpty||Ht.reportExposure(this.adInfo)},o.prototype.loadMaterialSuccess=function(){},o.prototype.loadMaterialFail=function(){var t;null===(t=this.data.imageMaterial)||void 0===t||t.destroy(),this.stop()},o.prototype.loadMaterial=function(){var e;return s(this,void 0,void 0,(function(){return d(this,(function(o){switch(o.label){case 0:if(!(null===(e=this.adInfo.material)||void 0===e?void 0:e.url))return[2,Promise.reject("no url")];this.data.imageMaterial=new ri({url:this.adInfo.material.url}),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adType:this.order.adType,adInfo:this.adInfo}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.data.imageMaterial.load()];case 2:return o.sent(),this.canplayHandler(),this.loadCompleteHandle({adType:this.adType,adInfo:this.adInfo,index:this.adInfo.orderIdx,loadingTime:this.data.imageMaterial.loadTime,materialUrl:this.adInfo.material.url,materialType:ot.IMAGE}),[3,4];case 3:return o.sent(),this.loadCompleteHandle({adType:this.adType,adInfo:this.adInfo,index:this.adInfo.orderIdx,hasError:"1",detailErrorCode:S.LOAD_FAIL,loadingTime:this.data.imageMaterial.loadTime,materialUrl:this.adInfo.material.url,materialType:ot.IMAGE}),[2,Promise.reject("image load failed")];case 4:return[2]}}))}))},o}(xe);qe(".txp_overlay_loading_ad{left:50%;margin-top:-144px;max-width:38%;position:absolute;top:50%;-webkit-transform:translate(-50%);transform:translate(-50%);width:200px}.txp_popup_definition .txp_menuitem_ad{border-bottom:1px solid hsla(0,0%,100%,.08);cursor:default!important;font-size:12px;height:30px;line-height:30px;margin-bottom:6px;padding:0 10px 6px}.txp_popup_definition .txp_definition_ad{margin-right:6px}.txp_popup_definition .txp_definition_ad_text{color:#fff;max-width:124px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.txp_tooltip_preview_ad{height:24px;left:0;position:absolute;top:-26px;white-space:nowrap;width:100%}.txp_tooltip_preview_ad .txp_ad_mark{bottom:2px;display:inline-block;left:0;position:relative;right:auto}.txp_tooltip_preview_ad .txp_ad_mark.txp_none{display:none}.txp_ad_mark{bottom:0;color:#fff;font-size:12px;line-height:1;opacity:.8;position:absolute;right:2px;-webkit-transform:scale(.7);transform:scale(.7)}");var ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setLayerVisible=function(t){this.setDomVisible(this.$domNodes.layer,t)},e}(ko),si=Mo("loading"),di={layer:si("layer"),img:si("img"),adFlag:si("flag")},li=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=di,e}return r(e,t),e.prototype.update=function(t){var e=t.url,o=t.hasAdFlag;this.$domNodes.img&&(this.$domNodes.img.src=e),o?ne(this.$domNodes.adFlag):re(this.$domNodes.adFlag)},e.prototype.mount=function(){if(!this.$domNodes.layer){var t=document.createElement("div");t.className="txp_overlay_loading_ad txp_none",t.dataset.role=this.roleMap.layer,this.outerApi.prependEmbedAd(J.LOADING,t),this.$domNodes.layer=t}this.appendDom(this.$domNodes.layer)},e.prototype.getTemplate=function(){return'\n      <img data-role="'.concat(this.roleMap.img,'" width="200" class="txp_img" />\n      <txpdiv data-role="').concat(this.roleMap.adFlag,'" class="txp_ad_mark txp_none">广告</txpdiv>\n    ')},e}(ai),pi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=e.adCore.getUIInterface(li),e}return r(e,t),e.prototype.loadMaterialSuccess=function(){this.ui.update({url:this.adInfo.material.url,hasAdFlag:this.adInfo.hasFlag}),this.show(),this.adInfo.reporter.reportExposure(),Ht.reportExposure(this.adInfo)},e}(ni),ci=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadLoadingAd=function(e){var o=e.data;(null==o?void 0:o.value)&&(t.adCore.adCtrl.getRunningAds(J.LOADING).length&&t.adCore.reportAd(J.LOADING))},t.handleAdOrderSet=function(e){return s(t,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:if(e.adType!==J.LOADING)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.adCore.loadAd(J.LOADING)];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return[2]}}))}))},t}return r(o,e),o.prototype.startWatch=function(){this.adCore.outerApi.on(B.SET_LOADING,this.loadLoadingAd),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_ORDER_SET,this.handleAdOrderSet)},o.prototype.endWatch=function(){this.adCore.outerApi.off(B.SET_LOADING,this.loadLoadingAd),this.adCore.adEventEmitter.off(t.AD_EVENT.AD_ORDER_SET,this.handleAdOrderSet)},o}(To),ui="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAJKADAAQAAAABAAAAJAAAAAAqDuP8AAACHklEQVRYCe2YPU7DQBCFY5ASCUGLAgUdNIRDIAqgyC04CAplOkRyBlpygQghQUOJkGiQIEBHwU8VCvM9sKXVZuPYziaxBCO9eD078/yy3h2vXSr9W/IIBMndg71hGJbxboM6qIEVsApkLxFuOXZANwiCPkf/hpAqaIF3kNbeCGyDqjdFkFXAEfgEeU25DVAZSxgEGpVL4MuuIMo3WiTWQG+Ikkf8J2AfbIDFCGrLp75hufJvZR4pki6AbU84DsD8KELFRLHPHG2TqGwjRcKNxdLhfGmUELtfOeDM4tKpbl/6OUVwHWhFfQFNyDn7YmnPlQuOgW2NtBw/cWSXwYIrCf8yaEZYdsWYPuIkyh4prb5st84kNdsQnYPY7mmsmf2uNjG6ffacartiM/sgtgtkWlFaFKapeKr6j2eQuObESFHkafVplZm2O54asmET8anJGrXTiFKdMq01tiARwJhLFHkqnqZ1nYKI2AOqwj5MI+VcffhV0U27GybowYzy0G66LgSvHjWmfcRxuYtdTODpGDp5kFysW+ZUmeDkD0x2Uidce6ArrxgRket/2UNauMJYuEfH9B+u3BZtGZybKPzT3X5wwR3wCvrgEOSuWcoFrjmXfoMGwTUwrcPJTLewXVNN1J7pJn8TET2HKLn0AFYt0VN7HUz+NSgqYMV5UYxLM/++OK/SsShjtCb+scHH5xh9itEnGdn0Psf8Xu8P/n4D4PsXcaUqP5MAAAAASUVORK5CYII=",hi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAz0lEQVRIDe1V2w3CMAxs2IGBYOduUDZgC35gAnOuUpFYxvGhSvw0khulvjsn5z6m6RiMAyIyIxbEmeEpVjmVO3/lVgAmuSPSRRRbOZhkiQq0wFQRIz7mMAQG250qQ8xgOlG7iASinNUJ156Qdy8UGSUdQW2kjnFDR+JbHmLt00WJnzaRv81m92rLfhY54mpVa9fvfYiEolzK6oxABuMWY4gMdi1GE8CiOADrv0AH1Tzg28Z3n2v7HrywqRviUkp5rMdKXCr2WrnPBOWAfBx4A/82CR3u3683AAAAAElFTkSuQmCC",fi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAJKADAAQAAAABAAAAJAAAAAAqDuP8AAAAg0lEQVRYCe2WQQqAMAwEix8r+BnBg7/2G8YVPRVa2pNbmEAubaDDNISkRGAAAxiY0EBEZOVqgy6YU3kpNwsogezKJ6ygjpcJqHaXyBKm2oq+W0x1aVJRYWp4eC69D01ZV9j5d4oDU+shzMxixmv9UN/YLWhZUMNTuPb9nGMAAxhwMnADTiAA962llmkAAAAASUVORK5CYII=",vi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAABGElEQVRYCe1VwQrCMAxdBfHixY8RYf/PQPYxXryMHWaea2CWpkkKTg8NZNM2L+81ybaua9Yq0Crw4wqEEv+yLDfaP5KPIYSpFJvuEfZEa1fymbD3dJ//H/iHcAf5hbyPCYWwz+UY20cscoimCRgJ+SQ/k5tEbMiBARY5RCu2AKhMwkFqhyeWFakCrCJqyJHbJEATUUvuEiCJwDoZBo57LrboHZlczBVgXOa02KoiB9AtAKBEBJYw7a6TAwTTHsM16otXdwWS0+PksH1akCEfVv4dhjBHzi+k0l4UKN5MLbAQWGJyKlQBnsSeWBZTFFCT0IvRHkN8z10THucCw8lfUeQQTRMwE/JB7nrJbEQAixzNWgVaBf63Ai9zOaAYWlyyrgAAAABJRU5ErkJggg==",mi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACAUlEQVRYCcVXsU7DMBC109JKFWVALPADfAE7zCyVKCNLi/goBgZYO7Cws/MF/EQlaFWppdS858ZplLiNL6jJk44YN3fv2Tmfba0yMMY00dWBtWANWATTsDIwcFrBfmEL2ExrvcQzQRIYxGwfwrrJr/tpTBB2CiEUtx5ZTH6M/9vsrABzcIwpgtNLcORVkZOPXORUUfzN9z3t5MqiS27OABOuLnQogNleF1oUwKXmx/3Vsxpcvqq3FyaoDPShL2NsR4MCaH6szJH5mV+o0eNIJILk8LG+iOEPbnsjkie1IPfizXCgm81Ps1yeB4tw5PChr0KMXNxNh94+er50fTdW/Yd+sIgsOXxtjA1hrrVbgERECXKGLxYQIqIkOUNrFIMzNoLgI6IjE85984BpT3PJBNAzKwJdZckZTi6AXikRNgizXThy+hFhObB+dy9/5QJSo+fyDF6iW+TLBGTI7bRL6oRHBI9fYfCRs1Ct0dduJbBsK1VYgBxp2AzsJpdXTMeOZ7GAInIXTFq2Y7/dAkLJ/yGCdeAU/v4dEfs5t1S7q0nWeVr4QftDPb33nMbM0x5KeW73I9LfmgEk5IzEz9Eb3lpfrb/8wW3vijNwgmZdx7IFc4A3lrpgBczqYgfvLIrvarwuVY0Jud0ynIKd16WqQC5ybpYfkrG+y2l62BBS6fX8Dz8LYXDqX2E6AAAAAElFTkSuQmCC";qe(".txp_btn_ad_volume{background:rgba(37,37,37,.7) url(https://ca.gtimg.com/adplugin/js/imgs/mutes.png) no-repeat;border:none;border-radius:14px;cursor:pointer;display:inline-block;height:28px;margin-left:8px;outline:none;-webkit-user-select:initial;-moz-user-select:initial;-ms-user-select:initial;user-select:auto;vertical-align:top;width:28px}.txp_btn_ad_mute{background-position-y:-28px}.txp_cac_black_screen{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-box-pack:center;-ms-flex-pack:center;background-color:#000;bottom:0;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;justify-content:center;left:0;line-height:1.5;position:absolute;text-align:center;top:0;width:100%;z-index:1000}.txp_cac_black_screen .txp_cac_black_screen_title{color:#fff;font-size:16px;margin-bottom:15px;text-align:center}.txp_cac_black_screen .txp_cac_black_screen_em{color:#ff7000;display:inline}.txp_is_mobile .txp_ad_skip{background-color:rgba(0,0,0,.5);border-radius:14px;font-size:13px;height:26px;line-height:28px;overflow:hidden;padding:0 8px;position:absolute;right:12px;top:10px;vertical-align:top;white-space:nowrap}.txp_is_mobile .txp_ad_detail{bottom:8px;right:8px}.txp_is_mobile .txp_ad_detail .txp_ad_more{background-color:rgba(255,112,0,.75);border-radius:15px;font-size:14px;height:30px;padding:0 12px;text-decoration:none}.txp_is_mobile .txp_ad_detail .txp_ad_more txpdiv{line-height:30px}.txp_play_icon{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:10%}.txp_ad_detail,.txp_play_icon{pointer-events:auto;position:absolute}.txp_ad_detail{background-color:transparent;border-radius:8px;bottom:64px;height:34px;left:auto;overflow:hidden;right:10px;top:auto}.txp_ad_detail.txp_ad_active_normal{background-color:rgba(0,0,0,.8);height:124px;-webkit-transition:width .7s ease-in-out .8s,height .7s ease-in-out .8s,background-color 1s ease-in-out .6s;transition:width .7s ease-in-out .8s,height .7s ease-in-out .8s,background-color 1s ease-in-out .6s;width:340px}.txp_ad_detail.txp_ad_active_normal:hover{background-color:#000}.txp_ad_detail.txp_ad_active_normal .active_normal{-webkit-box-orient:vertical;-webkit-box-direction:normal;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;margin:10px;opacity:0}.txp_ad_detail.txp_ad_active_normal .active_normal .txp_ad_active_close{cursor:pointer;height:16px;line-height:8px;position:absolute;right:3px;top:3px;width:16px}.txp_ad_detail.txp_ad_active_normal .active_normal .txp_ad_active_close:hover img.hover{display:block}.txp_ad_detail.txp_ad_active_normal .active_normal .txp_ad_active_close img.hover,.txp_ad_detail.txp_ad_active_normal .active_normal .txp_ad_active_close:hover img.not-hover{display:none}.txp_ad_detail.txp_ad_active_normal .active_normal .content{display:-webkit-box;display:-ms-flexbox;display:flex;margin-bottom:10px}.txp_ad_detail.txp_ad_active_normal .active_normal .content .txp_ad_active_img{border-radius:4px;height:60px;margin-right:10px;overflow:hidden;width:60px}.txp_ad_detail.txp_ad_active_normal .active_normal .content .txp_ad_active_normal_text{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-box-pack:justify;-ms-flex-pack:justify;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font-size:14px;height:60px;justify-content:space-between;line-height:18px;width:240px}.txp_ad_detail.txp_ad_active_normal .active_normal .content .txp_ad_active_normal_text .vendor{font-size:12px;opacity:.5}.txp_ad_detail.txp_ad_active_normal .active_normal .txp_ad_more{opacity:1}.txp_ad_detail.txp_ad_active_scan{background-color:rgba(0,0,0,.8);height:207px;-webkit-transition:width .3s ease-in-out,height .3s ease-in-out;transition:width .3s ease-in-out,height .3s ease-in-out;width:162px}.txp_ad_detail.txp_ad_active_scan.has-transition{-webkit-transition:width .7s ease-in-out .8s,height .7s ease-in-out .8s,background-color 1s ease-in-out .6s;transition:width .7s ease-in-out .8s,height .7s ease-in-out .8s,background-color 1s ease-in-out .6s}.txp_ad_detail.txp_ad_active_scan.has-transition .qr-code{opacity:0}.txp_ad_detail.txp_ad_active_scan .active_scan{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:justify;-ms-flex-pack:justify;align-items:center;color:hsla(0,0%,100%,.5);display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font-size:12px;height:100%;justify-content:space-between;opacity:0;padding-bottom:15px;-webkit-transition:padding-bottom .3s ease-in-out;transition:padding-bottom .3s ease-in-out;width:100%}.txp_ad_detail.txp_ad_active_scan .active_scan .txp_ad_more{-webkit-box-pack:start;-ms-flex-pack:start;background-color:#000;border-radius:0;display:-webkit-box;display:-ms-flexbox;display:flex;height:40px;justify-content:flex-start;line-height:40px;opacity:1;padding:0 9px;-webkit-transition:padding .3s ease-in-out,background .3s ease-in-out;transition:padding .3s ease-in-out,background .3s ease-in-out}.txp_ad_detail.txp_ad_active_scan .active_scan .txp_ad_more txpdiv{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-align:left}.txp_ad_detail.txp_ad_active_scan .active_scan .txp_ad_more:hover{background-color:#000}.txp_ad_detail.txp_ad_active_scan .active_scan .item-icon{border-radius:2px;height:20px;margin-right:5px;min-width:20px;overflow:hidden;width:20px}.txp_ad_detail.txp_ad_active_scan .active_scan .item-text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.txp_ad_detail.txp_ad_active_scan .active_scan .qr-code{background-color:#fff;border-radius:4px;height:110px;padding:4px;-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transition:-webkit-transform .3s ease-in-out;transition:-webkit-transform .3s ease-in-out;transition:transform .3s ease-in-out;transition:transform .3s ease-in-out,-webkit-transform .3s ease-in-out;width:110px}.txp_ad_detail.txp_ad_active_scan .active_scan .qr-code .code{height:100%;width:100%}.txp_ad_detail.txp_ad_active_scan .txp_ad_more:hover{background-color:#000}.txp_ad_detail.can-not-open a{cursor:default}.txp_ad_detail .txp_ad_more{-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background-color:#fe5c38;border-radius:16px;bottom:unset;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:14px;height:34px;justify-content:center;left:auto;line-height:34px;opacity:0;padding:0 16px;pointer-events:auto;position:relative;right:unset;text-align:center;top:auto;-webkit-transition:opacity .5s ease-in-out;transition:opacity .5s ease-in-out;width:100%}.txp_ad_detail .txp_ad_more:hover{background-color:#ff183e}.txp_ad_detail .txp_ad_more img{height:16px;margin-right:8px;width:16px}.txp_ad_detail .active_show{opacity:1!important;-webkit-transition:opacity .3s ease-in-out;transition:opacity .3s ease-in-out}.txp_ad_control{cursor:default;pointer-events:auto;position:absolute;right:10px;top:10px;z-index:2}.txp_ad_control .txp_ad_skip{border-radius:12px;padding:0 12px}.txp_ad_control .txp_ad_skip .txp_ad_countdown{color:#fe5c38;font-size:12px}.plugin_ctrl--large .txp_ad_detail{bottom:104px}.txp_autohide .txp_ad_detail{bottom:10px}.txp_autohide .txp_ad_more{bottom:unset}.cant-open-toast{background-color:rgba(0,0,0,.9);border-radius:20px;color:#fff;font-size:14px;height:40px;left:50%;line-height:40px;padding:0 20px;position:absolute;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.center-qrcode{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background-color:rgba(0,0,0,.3);bottom:0;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;justify-content:center;left:0;pointer-events:auto;position:absolute;right:0;top:0}.center-qrcode .item-text{color:#fff;font-size:20px;margin-bottom:20px}.center-qrcode .center-qrcode-container{background-color:#fff;border-radius:2px;height:300px;padding:10px;position:relative;width:260px;z-index:2}.center-qrcode .center-qrcode-container .item-icon{border:2px solid #fff;border-radius:4px;height:50px;left:105px;position:absolute;top:105px;width:50px}.center-qrcode .center-qrcode-container .scan-tips{color:#3f3f4c;font-size:14px;margin-top:15px;text-align:center}.center-qrcode .close-qrcode{cursor:pointer;height:26px;margin-top:20px;width:26px}.center-qrcode .close-qrcode:hover .close-not-hover{display:none}.center-qrcode .close-qrcode:hover .close-hover{display:block}.center-qrcode .close-hover{display:none}.center-qrcode.small-window .item-text{margin-bottom:10px}.center-qrcode.small-window .center-qrcode-container{height:206px;width:176px}.center-qrcode.small-window .center-qrcode-container .item-icon{border-radius:2px;height:30px;left:73px;top:73px;width:30px}.center-qrcode.small-window .center-qrcode-container .scan-tips,.center-qrcode.small-window .close-qrcode{margin-top:10px}.txp-post-ad.txp_ad:hover .txp_ad_active_scan:not(.has-transition){height:219px;width:170px}.txp-post-ad.txp_ad:hover .txp_ad_active_scan:not(.has-transition) .active_scan{padding-bottom:8px}.txp-post-ad.txp_ad:hover .txp_ad_active_scan:not(.has-transition) .active_scan .txp_ad_more{background:transparent;padding:0 20px}.txp-post-ad.txp_ad:hover .txp_ad_active_scan:not(.has-transition) .qr-code{-webkit-transform:scale(1.27);transform:scale(1.27)}.txp-post-ad.txp_ad:hover .txp_ad_active_scan:not(.has-transition):hover{height:292px;width:240px}.txp-post-ad.txp_ad:hover .txp_ad_active_scan:not(.has-transition):hover .active_scan{padding-bottom:15px}.txp-post-ad.txp_ad:hover .txp_ad_active_scan:not(.has-transition):hover .qr-code{-webkit-transform:scale(1.82);transform:scale(1.82)}");var yi,_i,gi,Ai=Mo("video"),Ei={layer:Ai("layer"),videoContainer:Ai("container"),videoAdInner:Ai("inner"),videoAdContainer:Ai("ad-container"),videoAdControl:Ai("ad-control"),videoCountdown:Ai("countdown"),videoCloseBtn:Ai("close-btn"),videoSkipText:Ai("skip-text"),videoNoSkipBtn:Ai("no-skip-btn"),videoDetail:Ai("detail"),videoDetailBtn:Ai("detail-btn"),videoDetailBtnText:Ai("detail-btn-text"),activeNormalVideoDetail:Ai("active-normal-video-detail"),activeNormalVideoDetailCloseBtn:Ai("active-normal-video-detail-close-btn"),activeNormalVideoDetailItemImg:Ai("active-normal-video-detail-item-img"),activeNormalVideoDetailItemDesc:Ai("active-normal-video-detail-item-desc"),activeNormalVideoDetailItemName:Ai("active-normal-video-detail-item-name"),activeNormalVideoDetailBtn:Ai("active-normal-video-detail-btn"),activeNormalVideoDetailBtnText:Ai("active-normal-video-detail-btn-text"),activeScanVideoDetail:Ai("active-scan-video-detail"),activeScanVideoDetailBtn:Ai("active-scan-video-detail-btn"),activeScanVideoDetailBtnText:Ai("active-scan-video-detail-btn-text"),activeScanVideoDetailBtnImg:Ai("active-scan-video-detail-btn-img"),activeScanVideoDetailQrCode:Ai("active-scan-video-detail-qr-code"),activeScanVideoDetailQrCodeText:Ai("active-scan-video-detail-qr-code-text"),cantOpenToast:Ai("active-cant-open-toast"),activeScanCanOpenArrow:Ai("active-can-open-arrow"),videoLinkArea:Ai("link-area"),videoVolumeBtn:Ai("volume-btn"),videoNoSkipDialog:Ai("no-skip-dialog"),videoNoSkipAuthor:Ai("no-skip-author"),videoNoSkipKnowBtn:Ai("no-skip-know-btn"),videoNoSkipCloseBtn:Ai("no-skip-close-btn"),videoDspNameText:Ai("dsp-name-text"),videoBlackScreen:Ai("black-screen"),videoBlackScreenCount:Ai("black-screen-count"),centerQrcode:Ai("center-qrcode"),centerQrcodeItemText:Ai("center-qrcode-item-text"),centerQrcodeContainer:Ai("center-qrcode-container"),centerQrcodeItemIcon:Ai("center-qrcode-item-icon"),centerQrcodeItemScanTips:Ai("center-qrcode-item-scan-tips"),centerQrcodeCloseBtn:Ai("center-qrcode-close-btn")};!function(t){t.VIDEO_SKIP_TEXT_CLICK="VIDEO_SKIP_TEXT_CLICK",t.VIDEO_CLOSE_BUTTON_CLICK="VIDEO_CLOSE_BUTTON_CLICK",t.VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK="VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK",t.VIDEO_NO_SKIP_KNOW_BUTTON_CLICK="VIDEO_NO_SKIP_KNOW_BUTTON_CLICK",t.VIDEO_NO_SKIP_BUTTON_CLICK="VIDEO_NO_SKIP_BUTTON_CLICK",t.VIDEO_LINK_AREA_CLICK="VIDEO_LINK_AREA_CLICK",t.VIDEO_DETAIL_BUTTON_CLICK="VIDEO_DETAIL_BUTTON_CLICK",t.VIDEO_VOLUME_BUTTON_CLICK="VIDEO_VOLUME_BUTTON_CLICK",t.VIDEO_PLAY_ICON_CLICK="VIDEO_PLAY_ICON_CLICK",t.ACTIVE_SCAN_DETAIL_BUTTON_CLICK="ACTIVE_SCAN_DETAIL_BUTTON_CLICK",t.CENTER_QRCODE_CLOSE_BUTTON_CLICK="CENTER_QRCODE_CLOSE_BUTTON_CLICK"}(yi||(yi={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.WARNER=1]="WARNER",t[t.COPYRIGHT=2]="COPYRIGHT"}(_i||(_i={})),function(t){t.NORMAL="Normal",t.SCAN="Scan"}(gi||(gi={}));var Ii,Ci=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=Ei,e.activeType=null,e.hasUnfoldActiveDetail=!1,e.handleCtrlBarShow=function(){ie(e.$domNodes.videoAdInner,"txp_autohide")},e.handleCtrlBarHide=function(){oe(e.$domNodes.videoAdInner,"txp_autohide")},e}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.outerApi.isMobile&&oe(this.$domNodes.videoContainer,"txp_is_mobile"),ee(this.$domNodes.layer,{position:"absolute",width:"100%",height:"100%",zIndex:"5",pointerEvents:"none"}),this.bindOwnEvent()},e.prototype.destroy=function(){this.unbindOwnEvent(),t.prototype.destroy.call(this)},e.prototype.on=function(t,e){this.eventEmitter.on(t,e)},e.prototype.off=function(t,e){this.eventEmitter.off(t,e)},e.prototype.updateVideoContainerSize=function(t,e){ee(this.$domNodes.videoContainer,{width:t,height:e})},e.prototype.setVideoAdInnerVisible=function(t){this.setDomVisible(this.$domNodes.videoAdInner,t)},e.prototype.setVideoAdControlVisible=function(t){this.setDomVisible(this.$domNodes.videoAdControl,t)},e.prototype.setVideoLayerVisible=function(t){this.setDomVisible(this.$domNodes.videoContainer,t)},e.prototype.adjustVideoAdControl=function(t){t&&(this.$domNodes.videoAdControl&&ee(this.$domNodes.videoAdControl,"top",t.top),this.$domNodes.videoDetail&&ee(this.$domNodes.videoDetail,"bottom",t.bottom))},e.prototype.setVideoAdLayerVisible=function(t){this.setDomVisible(this.$domNodes.videoAdContainer,t)},e.prototype.updateVideoDSP=function(t){t?(de(this.$domNodes.videoDspNameText,t),ne(this.$domNodes.videoDspNameText)):(de(this.$domNodes.videoDspNameText,""),re(this.$domNodes.videoDspNameText))},e.prototype.setLinkAreaVisible=function(t){this.$domNodes.videoLinkArea&&(this.outerApi.isMobile||ee(this.$domNodes.videoLinkArea,"cursor",t?"pointer":"auto"))},e.prototype.showVideoForbidSkipAd=function(t){t===_i.COPYRIGHT?(de(this.$domNodes.videoNoSkipAuthor,"内容方"),de(this.$domNodes.videoSkipText,"应内容方要求，VIP无法免该片广告"),ne(this.$domNodes.videoSkipText),ne(this.$domNodes.videoNoSkipBtn)):t===_i.WARNER&&(de(this.$domNodes.videoNoSkipAuthor,"版权方（华纳）"),de(this.$domNodes.videoSkipText,"应版权方要求，VIP无法免该片广告"),ne(this.$domNodes.videoSkipText),ne(this.$domNodes.videoNoSkipBtn)),ne(this.$domNodes.videoNoSkipCloseBtn),ne(this.$domNodes.videoNoSkipKnowBtn)},e.prototype.updateCloseButton=function(t){var e=this.$domNodes.videoCloseBtn,o=this.$domNodes.videoSkipText;t.show?(ne(e),ne(o)):(re(e),re(o)),void 0!==t.text&&de(o,t.text)},e.prototype.updateActionButton=function(t){t.btnText&&(de(this.$domNodes.videoDetailBtnText,t.btnText),ee(this.$domNodes.videoDetailBtn,{color:t.textColor,backgroundColor:t.bgColor}))},e.prototype.updateQrcodeTips=function(t){void 0===t&&(t="微信扫码查看更多"),de(this.$domNodes.activeScanVideoDetailQrCodeText,t),de(this.$domNodes.centerQrcodeItemScanTips,t)},e.prototype.updateActionPicture=function(t){this.activeType&&this.foldActiveDetail(),this.activeType=gi.NORMAL,de(this.$domNodes.activeNormalVideoDetailBtnText,t.btnText),Zt(this.$domNodes.activeNormalVideoDetailItemImg,"src",t.icon_url),de(this.$domNodes.activeNormalVideoDetailItemDesc,t.description),de(this.$domNodes.activeNormalVideoDetailItemName,t.name)},e.prototype.updateActionQrcode=function(t){this.activeType&&this.foldActiveDetail(),this.activeType=gi.SCAN,de(this.$domNodes.videoDetailBtnText,t.btnText),de(this.$domNodes.activeScanVideoDetailBtnText,t.name),Zt(this.$domNodes.activeScanVideoDetailBtnImg,"src",t.icon_url),t.qrcodeUrl&&this.renderQrCode(this.$domNodes.activeScanVideoDetailQrCode,me(t.qrcodeUrl,{act:"1025"}),102)},e.prototype.updateCenterQrcode=function(t){de(this.$domNodes.centerQrcodeItemText,t.name),Zt(this.$domNodes.centerQrcodeItemIcon,"src",t.icon_url),t.qrcodeUrl&&this.renderQrCode(this.$domNodes.centerQrcodeContainer,me(t.qrcodeUrl,{act:"1026"}),240)},e.prototype.updateCenterQrcodeSizeClass=function(t){t>=880?ie(this.$domNodes.centerQrcode,"small-window"):oe(this.$domNodes.centerQrcode,"small-window")},e.prototype.setScanCanOpenVisible=function(t){t?(ne(this.$domNodes.activeScanCanOpenArrow),this.setLinkAreaVisible(!0),ie(this.$domNodes.videoDetail,"can-not-open")):(re(this.$domNodes.activeScanCanOpenArrow),this.setLinkAreaVisible(!1),oe(this.$domNodes.videoDetail,"can-not-open"))},e.prototype.setVideoDetailVisible=function(t){this.setDomVisible(this.$domNodes.videoDetail,t)},e.prototype.updateTrueview=function(t){var e;if(t.showCloseButton||[3,2020].includes(null!==(e=this.outerApi.playerData.playerChid)&&void 0!==e?e:0)){var o=t.countdown;o>0?(de(this.$domNodes.videoSkipText,t.skipAdTitle.replace("__second__","".concat(o))),ne(this.$domNodes.videoSkipText),re(this.$domNodes.videoCloseBtn)):(de(this.$domNodes.videoSkipText,t.skipAdSubTitle),ne(this.$domNodes.videoSkipText),ne(this.$domNodes.videoCloseBtn))}else re(this.$domNodes.videoSkipText)},e.prototype.updateVideoVolumeBtn=function(t){re(this.$domNodes.videoVolumeBtn),t?oe(this.$domNodes.videoVolumeBtn,"txp_btn_ad_mute"):ie(this.$domNodes.videoVolumeBtn,"txp_btn_ad_mute")},e.prototype.unfoldActiveDetail=function(t){var e=this;if(void 0===t&&(t=this.activeType),t&&!this.hasUnfoldActiveDetail){this.hasUnfoldActiveDetail=!0;var o=this.getActiveDetailConfig(t);oe(this.$domNodes.videoDetail,"".concat(o.videoDetailClass," has-transition")),this.$domNodes.videoDetailBtn&&(this.$domNodes.videoDetailBtn.className="txp_ad_more"),setTimeout((function(){re(e.$domNodes.videoDetailBtn),ne(o.videoDetailDom)}),500),setTimeout((function(){oe(o.videoDetailDom,"active_show"),ie(e.$domNodes.videoDetail,"has-transition")}),1500)}},e.prototype.foldActiveDetail=function(t){if(void 0===t&&(t=this.activeType),t){this.hasUnfoldActiveDetail=!1;var e=this.getActiveDetailConfig(t);this.$domNodes.videoDetail&&(this.$domNodes.videoDetail.className="txp_ad_detail"),ie(this.$domNodes.videoDetail,e.videoDetailClass),re(e.videoDetailDom),ie(e.videoDetailDom,"active_show"),this.$domNodes.videoDetailBtn&&(this.$domNodes.videoDetailBtn.className="txp_ad_more active_show"),this.activeType=null}},e.prototype.showCantOpenToast=function(){var t=this;ne(this.$domNodes.cantOpenToast),setTimeout((function(){re(t.$domNodes.cantOpenToast)}),2e3)},e.prototype.setCenterQrcodeVisible=function(t){this.setDomVisible(this.$domNodes.videoDetail,!t),this.setDomVisible(this.$domNodes.centerQrcode,t)},e.prototype.resetVideoUI=function(t){var e=[this.$domNodes.videoCountdown,this.$domNodes.videoCloseBtn,this.$domNodes.videoSkipText,this.$domNodes.videoAdControl,this.$domNodes.videoNoSkipBtn,this.$domNodes.videoNoSkipDialog,this.$domNodes.videoNoSkipKnowBtn,this.$domNodes.videoNoSkipCloseBtn,this.$domNodes.centerQrcode];t&&e.push(this.$domNodes.videoContainer,this.$domNodes.videoAdContainer),e.forEach((function(t){re(t)})),de(this.$domNodes.videoSkipText,""),de(this.$domNodes.activeScanVideoDetailQrCodeText,"微信扫码查看更多"),this.activeType&&this.foldActiveDetail()},e.prototype.updateVideoCountdown=function(t){le(this.$domNodes.videoCountdown,t)},e.prototype.updateVideoCountdownHtml=function(t){le(this.$domNodes.videoCountdown,"".concat(t,"<style>.txp_ad_countdown:after{display:none}</style>"))},e.prototype.setVideoCountdownVisible=function(t){this.setDomVisible(this.$domNodes.videoCountdown,t)},e.prototype.setNoSkipDialogVisible=function(t){this.setDomVisible(this.$domNodes.videoNoSkipDialog,t)},e.prototype.setVideoBlackScreenVisible=function(t){t&&this.setDomVisible(this.$domNodes.videoContainer,!0),this.setDomVisible(this.$domNodes.videoBlackScreen,!0)},e.prototype.updateVideoBlackScreen=function(t){de(this.$domNodes.videoBlackScreenCount,t)},e.prototype.getTemplate=function(){return'\n      <txpdiv data-role="'.concat(this.roleMap.videoContainer,'"class="txp-post-ad txp_ad txp_none" style="width: 100%; height: 100%; background-color: #000;">\n        \n        <txpdiv\n          data-role="').concat(this.roleMap.videoAdContainer,'"\n          style="width: 100%; height: 100%; position: relative"\n        ></txpdiv>\n        \n        <txp data-role="').concat(this.roleMap.videoBlackScreen,'" class="txp_cac_black_screen txp_none">\n          <txp class="txp_cac_black_screen_title">\n            广告被拦截插件误伤啦，\n            <txp data-role="').concat(this.roleMap.videoBlackScreenCount,'" class="txp_cac_black_screen_em">1</txp>\n            秒后播放\n          </txp>\n          <txp>关闭拦截插件恢复正常</txp>\n        </txp>\n    \n        \n        <txpdiv data-role="').concat(this.roleMap.videoAdInner,'" class="txp_ad_inner txp_none">\n          \n          <a data-role="').concat(this.roleMap.videoLinkArea,'" href="javascript:;" class="txp_creative_link"></a>\n    \n          \n          <txpdiv data-role="').concat(this.roleMap.cantOpenToast,'" class="cant-open-toast txp_none">暂不支持打开，请用微信扫码浏览</txpdiv>\n    \n        \n        <txpdiv data-role="').concat(this.roleMap.centerQrcode,'" class="txp_none center-qrcode">\n          \n          <div data-role="').concat(this.roleMap.centerQrcodeItemText,'" class="item-text"></div>\n          \n          <txpdiv class="center-qrcode-container">\n            <txpdiv data-role="').concat(this.roleMap.centerQrcodeContainer,'" class="code"></txpdiv>\n            \n            <img data-role="').concat(this.roleMap.centerQrcodeItemIcon,'" class="item-icon" alt="" />\n            \n            <txpdiv data-role="').concat(this.roleMap.centerQrcodeItemScanTips,'" class="scan-tips">微信扫一扫查看更多精彩</txpdiv>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(this.roleMap.centerQrcodeCloseBtn,'" class="close-qrcode" title="关闭该广告">\n            <svg class="close-not-hover" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle opacity="0.5" cx="12.5625" cy="12" r="12" fill="black"/><rect x="7.81055" y="6.56934" width="14.4" height="0.96" rx="0.48" transform="rotate(45 7.81055 6.56934)" fill="white"/><rect x="7.13184" y="16.7515" width="14.4" height="0.96" rx="0.48" transform="rotate(-45 7.13184 16.7515)" fill="white"/></svg>\n            <svg class="close-hover" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle opacity="0.8" cx="12.5625" cy="12" r="12" fill="black"/><rect x="7.81055" y="6.56934" width="14.4" height="0.96" rx="0.48" transform="rotate(45 7.81055 6.56934)" fill="#FE5C38"/><rect x="7.13184" y="16.7515" width="14.4" height="0.96" rx="0.48" transform="rotate(-45 7.13184 16.7515)" fill="#FE5C38"/></svg>\n          </txpdiv>\n        </txpdiv>\n    \n        \n        <txpdiv data-role="').concat(this.roleMap.videoDetail,'" class="txp_ad_detail">\n          \n          \n          <txpdiv data-role="').concat(this.roleMap.activeNormalVideoDetail,'" class="active_normal txp_none">\n            \n            <txpdiv data-role="').concat(this.roleMap.activeNormalVideoDetailCloseBtn,'" class="txp_ad_active_close">\n              <img\n                class="not-hover"\n                src="').concat(vi,'"\n                alt=""\n              />\n              <img\n                class="hover"\n                src="').concat(mi,'"\n                alt=""\n              />\n            </txpdiv>\n            <txpdiv class="content">\n              \n              <txpdiv class="txp_ad_active_img"><img data-role="').concat(this.roleMap.activeNormalVideoDetailItemImg,'" /></txpdiv>\n              \n              <txpdiv class="txp_ad_active_normal_text">\n                \n                <txpdiv class="desc" data-role="').concat(this.roleMap.activeNormalVideoDetailItemDesc,'"></txpdiv>\n                \n                <txpdiv class="vendor">\n                  <span data-role="').concat(this.roleMap.activeNormalVideoDetailItemName,'"></span>\n                </txpdiv>\n              </txpdiv>\n            </txpdiv>\n            <a data-role="').concat(this.roleMap.activeNormalVideoDetailBtn,'" class="txp_ad_more" href="javascript:;">\n              <img\n                src="').concat(ui,'"\n                alt=""\n              />\n              <txpdiv data-role="').concat(this.roleMap.activeNormalVideoDetailBtnText,'"></txpdiv>\n            </a>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(this.roleMap.activeScanVideoDetail,'" class="active_scan txp_none">\n            \n            <a data-role="').concat(this.roleMap.activeScanVideoDetailBtn,'" class="txp_ad_more" href="javascript:;">\n              <img data-role="').concat(this.roleMap.activeScanVideoDetailBtnImg,'" class="item-icon" alt="" />\n              <txpdiv data-role="').concat(this.roleMap.activeScanVideoDetailBtnText,'" class="item-text"></txpdiv>\n              <img\n                data-role="').concat(this.roleMap.activeScanCanOpenArrow,'"\n                src="').concat(fi,'"\n                style="margin: 0"\n                alt=""\n              />\n            </a>\n            \n            <txpdiv class="qr-code"><txpdiv data-role="').concat(this.roleMap.activeScanVideoDetailQrCode,'" class="code"></txpdiv></txpdiv>\n            <txpdiv class="text" data-role="').concat(this.roleMap.activeScanVideoDetailQrCodeText,'">微信扫码查看更多</txpdiv>\n          </txpdiv>\n          \n          <a data-role="').concat(this.roleMap.videoDetailBtn,'" class="txp_ad_more active_show" href="javascript:;">\n            <img\n              src="').concat(ui,'"\n              alt=""\n            />\n            <txpdiv data-role="').concat(this.roleMap.videoDetailBtnText,'"></txpdiv>\n          </a>\n        </txpdiv>\n    \n          \n          <txpdiv\n            data-role="').concat(this.roleMap.videoDspNameText,'"\n            style="\n              left: 10px;\n              bottom: 10px;\n              position: absolute;\n              opacity: 0.6;\n              font-size: 12px;\n              text-shadow: 2px 2px #000;\n            "\n          ></txpdiv>\n    \n          \n          <txpdiv class="txp_ad_control" data-role="').concat(this.roleMap.videoAdControl,'">\n            <txpdiv class="txp_ad_skip">\n              \n              <txpdiv data-role="').concat(this.roleMap.videoCountdown,'" class="txp_ad_countdown"></txpdiv>\n    \n              \n              <txpdiv\n                data-role="').concat(this.roleMap.videoSkipText,'"\n                class="txp_ad_skip_text"\n                style="cursor: pointer"\n              ></txpdiv>\n    \n              \n              <button data-role="').concat(this.roleMap.videoCloseBtn,'" class="txp_btn txp_btn_close"></button>\n    \n              \n              <button\n                data-role="').concat(this.roleMap.videoNoSkipBtn,'"\n                class="txp_btn txp_btn_hint"\n                title="无法跳过广告说明"\n              ></button>\n            </txpdiv>\n            <button\n              data-role="').concat(this.roleMap.videoVolumeBtn,'"\n              class="txp_btn txp_btn_ad_volume txp_none"\n              style="z-index: 10; position: relative"\n            ></button>\n          </txpdiv>\n    \n          \n          <txpdiv data-role="').concat(this.roleMap.videoNoSkipDialog,'" class="txp_ad_dialog txp_none">\n            <txpdiv class="txp_dialog_bd"> 无法关闭广告……继续争取广告权益…… </txpdiv>\n            <txpdiv data-role="').concat(this.roleMap.videoNoSkipKnowBtn,'" class="txp_ad_btn">我知道了!</txpdiv>\n            <a class="txp_ad_fb" target="_blank" href="http://support.qq.com/write.shtml?fid=850">\n              意见反馈\n            </a>\n            <button data-role="').concat(this.roleMap.videoNoSkipCloseBtn,'" class="txp_btn txp_btn_close"></button>\n          </txpdiv>\n        </txpdiv>\n      </txpdiv>\n    ')},e.prototype.getDomEvents=function(){var t=this;return[this.forwardDomEvent(this.$domNodes.videoSkipText,yi.VIDEO_SKIP_TEXT_CLICK),this.forwardDomEvent(this.$domNodes.videoCloseBtn,yi.VIDEO_CLOSE_BUTTON_CLICK),this.forwardDomEvent(this.$domNodes.videoNoSkipBtn,yi.VIDEO_NO_SKIP_BUTTON_CLICK),this.forwardDomEvent(this.$domNodes.videoNoSkipCloseBtn,yi.VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK),this.forwardDomEvent(this.$domNodes.videoNoSkipKnowBtn,yi.VIDEO_NO_SKIP_KNOW_BUTTON_CLICK),{el:this.$domNodes.videoLinkArea,eventName:Lo.CLICK,listener:function(e){t.emit(yi.VIDEO_LINK_AREA_CLICK,{target:e.target,actionType:pt.AD_VIEW_AREA})}},this.forwardActionTypeDomEvent(this.$domNodes.videoDetailBtn,pt.AD_ACTION_BUTTON,!0),this.forwardActionTypeDomEvent(this.$domNodes.activeNormalVideoDetailBtn,pt.AD_ACTION_BUTTON,!0),this.forwardActionTypeDomEvent(this.$domNodes.activeScanVideoDetailBtn,pt.ADVERTISER_NAME,!0),this.forwardActionTypeDomEvent(this.$domNodes.activeScanVideoDetailBtnImg,pt.ADVERTISER_LOGO,!0),this.forwardActionTypeDomEvent(this.$domNodes.activeNormalVideoDetailItemName,pt.ADVERTISER_NAME,!0),this.forwardActionTypeDomEvent(this.$domNodes.activeNormalVideoDetailItemImg,pt.ADVERTISER_LOGO,!0),this.forwardActionTypeDomEvent(this.$domNodes.activeNormalVideoDetailItemDesc,pt.AD_TITLE,!0),this.forwardActionTypeDomEvent(this.$domNodes.activeNormalVideoDetail,pt.AD_DETAIL,!0),this.forwardActionTypeDomEvent(this.$domNodes.videoDetail,pt.AD_DETAIL),this.forwardDomEvent(this.$domNodes.videoVolumeBtn,yi.VIDEO_VOLUME_BUTTON_CLICK),this.forwardDomEvent(this.$domNodes.activeScanVideoDetail,yi.ACTIVE_SCAN_DETAIL_BUTTON_CLICK),{el:this.$domNodes.activeNormalVideoDetailCloseBtn,eventName:Lo.CLICK,listener:function(e){e.stopPropagation(),t.foldActiveDetail()}},this.forwardActionTypeDomEvent(this.$domNodes.activeScanVideoDetailQrCode,pt.AD_ACTION_BUTTON,!0),this.forwardDomEvent(this.$domNodes.centerQrcodeCloseBtn,yi.CENTER_QRCODE_CLOSE_BUTTON_CLICK)]},e.prototype.forwardActionTypeDomEvent=function(t,e,o){var i=this;return{el:t,eventName:Lo.CLICK,listener:function(t){o&&t.stopPropagation(),i.emit(yi.VIDEO_DETAIL_BUTTON_CLICK,{target:t.target,actionType:e})}}},e.prototype.renderQrCode=function(t,e,o){return this.outerApi.renderQrCode(t,e,o)},e.prototype.getActiveDetailConfig=function(t){return t===gi.SCAN?{videoDetailClass:"txp_ad_active_scan",videoDetailDom:this.$domNodes.activeScanVideoDetail}:{videoDetailClass:"txp_ad_active_normal",videoDetailDom:this.$domNodes.activeNormalVideoDetail}},e.prototype.bindOwnEvent=function(){this.outerApi.on(B.CTRL_SHOW,this.handleCtrlBarShow),this.outerApi.on(B.CTRL_HIDE,this.handleCtrlBarHide)},e.prototype.unbindOwnEvent=function(){this.outerApi.off(B.CTRL_SHOW,this.handleCtrlBarShow),this.outerApi.off(B.CTRL_HIDE,this.handleCtrlBarHide)},e}(ko),Ti=function(){function t(t){this.videoAdInterface=t,this.ready=Promise.resolve()}return Object.defineProperty(t.prototype,"logger",{get:function(){return this.adInterface.logger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adCore",{get:function(){return this.videoAdInterface.adCore},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adInterface",{get:function(){return this.videoAdInterface},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoUI",{get:function(){return this.videoAdInterface.videoUI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blockScreen",{get:function(){return this.videoAdInterface.blockScreen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playerService",{get:function(){return this.videoAdInterface.playerService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adEndService",{get:function(){return this.videoAdInterface.adEndService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateUIService",{get:function(){return this.videoAdInterface.updateUIService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoUIEventService",{get:function(){return this.videoAdInterface.videoUIEventService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"browserEventService",{get:function(){return this.videoAdInterface.browserEventService},enumerable:!1,configurable:!0}),t}(),xi=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return r(o,e),o.prototype.handleAdEnd=function(t,e){var o=this;this.blockScreen&&!t?this.blockScreen.check((function(){o.doAdEnd()})):this.doAdEnd(t,e)},o.prototype.vrReportEnd=function(t){var e,o=this.getDurations(),i={sum:this.adInterface.order.orders.length};this.adInterface.order.orders.forEach((function(t){i[t.orderType]||(i[t.orderType]=0),i[t.orderType]+=1})),Ht.reportTechParam(n(n({name:"stop",ad_type:this.adInterface.adType,order_types:i},o),{reason:t,adx:null===(e=this.adInterface.data.currentAdInfo)||void 0===e?void 0:e.orderIdx}))},o.prototype.doAdEnd=function(e,o){var i=this.getDurations();if(this.logger.log("所有广告播放完成",i),o)this.reportAdEndToVr(i,e,o);else if(!this.adInterface.data.hasReportVideoEnd){this.adInterface.data.hasReportVideoEnd=!0,this.adInterface.hide(),this.reportAdEndToVr(i,e,o);var r=i.adDurationsTotal,n=i.adViewTimeTotal;this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_STOP,{adType:this.adInterface.order.adType,adInfo:this.adInterface.data.currentAdInfo,adOrder:this.adInterface.order,index:this.adInterface.data.adIndex,rfid:this.adInterface.data.rfid,isAllAdEnd:Math.abs(r-n)<5e3}),this.adInterface.destroy()}},o.prototype.reportAdEndToVr=function(t,e,o){var i,r=t.adDurationList,n=t.adViewTimeList,a=t.adRealViewTimeTotal,s=t.adDurationsTotal,d=t.adViewTimeTotal,l={first_view:null!==(i=this.adInterface.data.showTime)&&void 0!==i?i:-1,force_stop:!!e,unload_trigger:!!o,user_close:!!this.adInterface.data.userCloseOrderId,close_time:this.adInterface.data.userCloseOrderId?d:-1,load_to_view_time:this.adInterface.data.isEmpty?-1:this.adInterface.data.firstLoadTime,ad_playtime:a,ad_playtime_list:n,ad_duration_list:r,ad_duration:s,is_trueview:this.adInterface.data.isTrueView?"1":"0",error_code:this.adInterface.data.errorCode,block_time:this.adInterface.data.blockTime,start_to_end_time:this.adInterface.data.showTime?Date.now()-this.adInterface.data.showTime:-1};Ht.reportEnded(this.adInterface.order,l)},o.prototype.getDurations=function(){var t=this,e=this.adInterface.data.isEmpty?[]:this.adInterface.order.orders.map((function(t){return 1e3*t.material.duration})),o=e.reduce((function(t,e){return t+e}),0),i=this.adInterface.data.isEmpty?[]:this.adInterface.order.orders.map((function(e){var o=t.adInterface.getVideoInfoByOrderId(e.orderId);return o&&void 0!==o.playTime?1e3*o.playTime:0})),r=i.reduce((function(t,e){return t+e}),0);return{adDurationList:e,adDurationsTotal:o,adViewTimeList:i,adViewTimeTotal:r,adRealViewTimeTotal:this.adInterface.order.orders.reduce((function(e,o){var i=t.adInterface.getVideoInfoByOrderId(o.orderId);return(null==i?void 0:i.viewTime)?e+1e3*i.viewTime:(null==i?void 0:i.viewStartTime)?e+(Date.now()-i.viewStartTime):e}),0)}},o}(Ti),bi=function(e){function o(t){var o=e.call(this,t)||this;return o.lsKey="gp-cacdc",o.filmFirstPlay=!1,o.showing=!1,o.errorByADBlock=!1,o.isShow=!1,o.startCountdownID=null,o.handleFilmFirstPlayListener=function(t){t.data.isFirst&&!o.filmFirstPlay&&(o.filmFirstPlay=!0,o.reset())},o.reset(),o.bindPlayerEvent(),o}return r(o,e),Object.defineProperty(o.prototype,"$dom",{get:function(){return this.videoUI.$domNodes.videoBlackScreen},enumerable:!1,configurable:!0}),o.prototype.check=function(t){var e,o;return s(this,void 0,void 0,(function(){var i,r,n,a;return d(this,(function(s){switch(s.label){case 0:return[4,this.adCore.adblockChecker.checkAdblock()];case 1:return i=s.sent(),this.logger.log("是否使用 adblock",i),i?this.showing?[2]:(r=null!==(o=null===(e=this.adInterface.data.videoInfoList)||void 0===e?void 0:e.filter((function(t){return!t.viewTime||t.viewTime<1})))&&void 0!==o?o:[],this.logger.log("被 adblock 拦截的广告",r),n=r.length,this.setLSValue(n),0===(a=this.getBlockTime(n))?(t(),[2]):(this.adInterface.data.blockTime=a,this.startCountdown(t,a),[2])):(t(),[2])}}))}))},o.prototype.getLSValue=function(){var t;try{if(window.localStorage)return+(null!==(t=window.localStorage.getItem(this.lsKey))&&void 0!==t?t:0)}catch(t){return 0}return 0},o.prototype.setLSValue=function(t){try{window.localStorage&&window.localStorage.setItem(this.lsKey,"".concat(t))}catch(e){this.logger.error("localStorage.setItem 出错",this.lsKey,t)}},o.prototype.setErrorByADBlock=function(t){this.errorByADBlock=t},o.prototype.reset=function(){this.unBindPlayerEvent(),this.filmFirstPlay=!1,this.errorByADBlock=!1,this.isShow=!1,this.showing=!1,this.$dom&&oe(this.$dom,"txp_none"),Number(this.startCountdownID)>0&&(this.startCountdownID&&clearInterval(this.startCountdownID),this.startCountdownID=null)},o.prototype.bindPlayerEvent=function(){this.adCore.outerApi.on(B.VIDEO_PLAYING,this.handleFilmFirstPlayListener)},o.prototype.unBindPlayerEvent=function(){this.adCore.outerApi.off(B.VIDEO_PLAYING,this.handleFilmFirstPlayListener)},o.prototype.getBlockTime=function(t){return 1===t?30:2===t?45:t>=3?60:0},o.prototype.startCountdown=function(e,o){var i=this;this.isShow=!0,this.showing=!0;var r=o;this.videoUI.setVideoBlackScreenVisible(!0),this.videoUI.updateVideoBlackScreen("".concat(r)),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_BLACK_SCREEN,{adInfo:this.adInterface.data.currentAdInfo,adType:this.adInterface.order.adType,bc:this.getLSValue()}),this.startCountdownID=+setInterval((function(){r>0?(r-=1,i.videoUI.updateVideoBlackScreen("".concat(r))):(Number(i.startCountdownID)>0&&(i.startCountdownID&&clearInterval(i.startCountdownID),i.startCountdownID=null),e(),i.videoUI.setVideoBlackScreenVisible(!1),i.showing=!1)}),1e3)},o}(Ti),Di=function(t){function e(e){var o=t.call(this,e)||this;return o.bindBrowserEvent(),o}return r(e,t),e.prototype.destroy=function(){this.unbindBrowserEvent()},e.prototype.unbindBrowserEvent=function(){this.browserBeforeUnload&&window.removeEventListener("beforeunload",this.browserBeforeUnload)},e.prototype.bindBrowserEvent=function(){var t=this;this.unbindBrowserEvent(),this.browserBeforeUnload=function(){t.unbindBrowserEvent();var e=t.adInterface.data,o=e.currentAdInfo,i=e.currentVideoInfo;i&&(i.viewStartTime&&(i.viewTime=(Date.now()-i.viewStartTime)/1e3),t.adInterface.data.userCloseOrderId=null==o?void 0:o.orderId,t.adInterface.setRfid(""),t.adEndService.vrReportEnd("浏览器刷新"),t.adEndService.handleAdEnd(!0,!0))},window.addEventListener("beforeunload",this.browserBeforeUnload)},e}(Ti),Pi=function(){function t(t){t&&(this.api={url:"https://ra.gtimg.com/web/viewability/viewabilityalone.js",startMonitor:null},this.target=t)}return t.prototype.start=function(t){var e=this;if(this.api){var o=this.getReportData(t);o&&(this.api.startMonitor?this.api.startMonitor(o):this.initApi().then((function(){e.api.startMonitor(o)})))}},t.prototype.initApi=function(){var t=this;return new Promise((function(e,o){Ut(t.api.url,(function(i){var r;i?o():(null===(r=window.crystalViewModule)||void 0===r?void 0:r.startviewability)?(t.api.startMonitor=window.crystalViewModule.startviewability,e()):o()}))}))},t.prototype.getReportData=function(t){var e=[],o=t.reporter.pluginReportList;return o&&o.length>0?(o.forEach((function(t){e.push(t.reportUrl)})),{reportItemUrl:e,objectID:[this.target],oid:t.orderId,duration:1e3*parseInt("".concat(t.material.duration),10),retry:0}):null},t}(),Ni=function(){function t(){this.timer=NaN,this.startTime=NaN,this.during=0,this.remain=-1,this.callback=void 0}return t.prototype.on=function(t,e){var o=this;t<0||"function"==typeof e&&(this.clearTimer(),this.during=t,this.callback=e,this.timer=+setTimeout((function(){var t;null===(t=o.callback)||void 0===t||t.call(o),o.clear()}),t),this.startTime=Date.now())},t.prototype.pause=function(){var t=Date.now()-this.startTime;t>this.during||(this.remain=this.during-t,this.clearTimer())},t.prototype.go=function(){this.remain<0||this.on(this.remain,this.callback)},t.prototype.clear=function(){this.clearTimer(),this.callback=void 0,this.remain=-1},t.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=NaN),this.startTime=NaN,this.during=0},t}(),wi=function(e){function o(o){var i=e.call(this,o)||this;return i.errorCount=0,i.handleVideoLoadStart=function(e){var o=e.index,r=e.adVideoInfo;if(r.url){i.adInterface.data.firstLoadingStartTime||(i.adInterface.data.firstLoadingStartTime=Date.now()),i.logger.log("开始加载第 ".concat(o," 个"));var n=i.adInterface.order.orders[o];n&&(r.loadStartTime=Date.now(),i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adInfo:n,adType:i.adInterface.order.adType,index:n.orderIdx}))}},i.handleVideoProgress=function(e){var o=e.index,r=e.adVideoInfo,n=i.adInterface.order.orders[o];if(n){var a=r.loadedPercent;r.buffered,r.duration;if(a){var s=Date.now();a&&r.loadStartTime&&(r.speed=r.fileSize/(s-r.loadStartTime)*1e3),i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_PROGRESS,{adInfo:n,adType:i.adInterface.order.adType,speed:r.speed,loadedPercent:r.loadedPercent,buffered:r.buffered}),i.handleVideoLoadComplete(r,n),i.adInterface.adType===J.MID&&a>=.05&&i.adInterface.canplayHandler()}}},i.handleVideoCanPlay=function(t){var e=t.index,o=t.adVideoInfo;if(i.adInterface.order.orders[e]){var r=o.loadedPercent;r&&(i.logger.log("广告视频可播: ","index: ".concat(t.index,"  percent: ").concat(r)),(i.adInterface.adType!==J.MID||r>=.05)&&i.adInterface.canplayHandler())}},i.handleVideoPlaying=function(e){var o,r,n,a=e.index,s=e.adVideoInfo,d=i.adInterface.order.orders[a];if(d){i.clearAdTimer(s,a),i.updateUIService.updateVideoUI(d),i.updateUIService.updateCountdownUI(a,null!==(o=s.playTime)&&void 0!==o?o:0),i.adInterface.setState(ge.PLAYING);var l={adInfo:d,adType:i.adInterface.order.adType};if(i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAY_START,l),i.adInterface.show(),s&&!s.viewStartTime&&(s.viewStartTime=Date.now()),i.adInterface.data.hasAdPlayingEmit||(i.adInterface.data.showTime=Date.now(),i.adInterface.data.hasAdPlayingEmit=!0,i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAYING,{adType:i.adInterface.order.adType,adInfo:i.adInterface.data.currentAdInfo})),!s.hasReportView){s.hasReportView=!0,d.reporter.reportExposure(),Ht.reportExposure(d,i.adInterface.data.isFirstExposure,{order_type:d.orderType}),i.adInterface.data.isFirstExposure&&(i.adInterface.data.isFirstExposure=!1);var p=null===(r=d.reporter.originExposureReportData.first[0])||void 0===r?void 0:r.reportUrl;Ht.reportTechParam({name:"exposure",ad_type:i.adInterface.adType,order_type:d.orderType,duration:s.duration,e_time:Date.now()-i.adInterface.data.createTime,idx:s.index,playtime:i.adCore.outerApi.videoPlayData.playtime,orderId:d.orderId,reportUrl:p?Ce.getOriginReportUrl(p,d):""})}i.adInterface.data.firstViewTime||(i.adInterface.data.firstViewTime=Date.now()),i.adInterface.data.firstLoadingEndTime||(i.adInterface.data.firstLoadingEndTime=Date.now()),i.logger.log("开始播放","第 ".concat(a," 个开播了")),null===(n=i.adViewMonitor)||void 0===n||n.start(d)}},i.handleVideoResume=function(e){var o=e.index;i.logger.log("广告恢复播放",{index:o}),i.adInterface.resume(),i.videoUI.setCenterQrcodeVisible(!1);var r=i.adInterface.order.orders[o];r&&i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_RESUME,{adInfo:r,adType:i.adInterface.order.adType})},i.handleVideoPause=function(e){var o=e.index;i.logger.log("广告暂停",{index:o}),i.adInterface.pause();var r=i.adInterface.order.orders[o];r&&i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PAUSE,{adInfo:r,adType:i.adInterface.order.adType})},i.handleVideoTimeupdate=function(e){var o=e.index,r=e.adVideoInfo,n=i.adInterface.order.orders[o];if(n){var a=r.playTime,s=r.loadedPercent;i.updateUIService.updateCountdownUI(o,null!=a?a:0);var d=Math.floor(null!=a?a:0);d&&s&&d!==i.adInterface.data.prevPlayTime&&(Math.abs(d-i.adInterface.data.prevPlayTime)>1?i.adVideoPlayer.currentTime=i.adInterface.data.prevPlayTime+.5:(i.startStuckAdTimer(r),r.viewStartTime&&(r.viewTime=(Date.now()-r.viewStartTime)/1e3),i.adInterface.data.prevPlayTime=d,i.unfoldActiveDetail(n,1e3*a),i.handleVideoLoadComplete(r,n),i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_TIME_UPDATE,{adType:i.adInterface.order.adType,adInfo:n,playTime:a})))}},i.handleVideoError=function(e){if(!i.adInterface.data.isLoadComplete){var o=e.index,r=e.adVideoInfo;i.errorCount===i.adInterface.order.orders.length&&(i.adInterface.data.errorCode=S.LOAD_FREEZE),i.clearAdTimer(r,o);var a=i.adInterface.order.orders[o];if(Ht.reportTechParam({name:"playError",ad_type:i.adInterface.adType,order_type:null==a?void 0:a.orderType,idx:r.index,errorCode:r.errorCode,detailErrorCode:r.detailErrorCode,errorMsg:r.errorMsg,playUrl:r.url,vid:r.vid,orderId:null==a?void 0:a.orderId,tryBackup:!!r.backupUrlData}),e.canTryBackup)r.backupUrlData?i.adVideoPlayer.playUrl(r):i.adVideoPlayer.tryPlayBackupUrl(r);else{i.logger.error("广告播放报错",r);var s=i.adInterface.order.orders[o];if(s){r.viewStartTime&&(r.viewTime=(Date.now()-r.viewStartTime)/1e3),i.adInterface.setState(ge.ERROR),i.adInterface.data.prevPlayTime=0,i.errorCount+=1,!r.loadCompleteTime&&r.loadStartTime&&(r.loadCompleteTime=Date.now(),r.loadTime=r.loadCompleteTime-r.loadStartTime);var d=r.errorMsg,l=r.readyState,p=r.networkState;r.url||(d="MEDIA_ELEMENT_ERROR: Empty src attribute",r.detailErrorCode=S.EMPTY_URL),l&&(d+=";readyState:".concat(l)),p&&(d+=";networkState:".concat(p)),i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAY_ERROR,{index:o,errorCode:r.errorCode,detailErrorCode:r.detailErrorCode,errorMsg:d||"",adInfo:s,adType:i.adInterface.order.adType,isAllAdEnd:o===i.adInterface.order.orders.length-1,preload:o!==i.adInterface.data.adIndex}),r.hasReportLoadComplete||(r.hasReportLoadComplete=!0,i.adInterface.loadCompleteHandle(n(n({},i.getLoadCompleteParams(r,s)),{hasError:"1",eventName:"onVideoError"}))),o===i.adInterface.data.adIndex?i.adInterface.data.currentPlayAdType?(i.logger.log("当前视频失败了，当前已经准备好了，直接播放下一个"),i.playNext(i.adInterface.data.adIndex+1,!0)):(i.logger.log("当前视频失败了，但是还没有调用过play，直接预加载下一个."),i.adInterface.data.adIndex<=i.adInterface.order.orders.length-1?(i.adInterface.setAdIndex(i.adInterface.data.adIndex+1),i.preloadNext(o+1,!1)):(i.logger.log("所有都播完了"),i.adEndService.vrReportEnd("错误至最后一个"),i.adEndService.handleAdEnd())):i.preloadNext(o+1,!1)}}}},i.handleVideoEnded=function(e){var o=e.index,r=e.adVideoInfo,n=i.adInterface.order.orders[o];n&&(i.logger.log("播放完成: 第",o,"个"),i.clearAdTimer(r,o),r.viewStartTime&&(r.viewTime=(Date.now()-r.viewStartTime)/1e3),i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAY_END,{adInfo:n,adType:i.adInterface.order.adType}),i.playNext(i.adInterface.data.adIndex+1),i.adInterface.data.prevPlayTime=0)},i.startAdTimer=function(t,e){void 0===e&&(e=10);var o=t.index,r=t.adVideoInfo;i.logger.log("开始卡顿定时器",{index:o});var n=i.adInterface.order.orders[o];n&&(r.loadProgressTimer||(r.loadProgressTimer=new Ni),r.loadProgressTimer.clear(),r.loadProgressTimer.on(1e3*e,(function(){i.logger.log("订单超时",{index:o});var t=r.loadedPercent;r.status===y.PLAYING&&(!r||0!==t&&r.playTime||(r.detailErrorCode=S.TIMEOUT)),r.status===y.BUFFERING&&0===t&&(r.detailErrorCode=S.PRELOAD_TIMEOUT),Ht.reportTechParam({name:"timeout",ad_type:i.adInterface.adType,order_type:null==n?void 0:n.orderType,idx:r.index,playtime:i.adInterface.data.prevPlayTime,playUrl:r.url,vid:r.vid,orderId:null==n?void 0:n.orderId,timeoutType:"start"}),i.adVideoPlayer.setAdVideoSrcEmpty(o)})))},i.handleAutoplayBlockedAd=function(){var e;i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_AUTOPLAY_BLOCKED,{adType:i.adInterface.order.adType,adInfo:i.adInterface.data.currentAdInfo}),null===(e=i.adInterface.data.videoInfoList)||void 0===e||e.forEach((function(t){i.clearAdTimer(t,t.index)}))},i.handleSetLoading=function(){i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_SET_LOADING,{adType:i.adInterface.order.adType,adInfo:i.adInterface.data.currentAdInfo})},i.initPlayer(),i.bindVideoAdPlayerEvent(),i}return r(o,e),Object.defineProperty(o.prototype,"adVideoPlayer",{get:function(){return this.adCore.postPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"outerApi",{get:function(){return this.adCore.outerApi},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"currentTime",{get:function(){return this.adVideoPlayer.currentTime},enumerable:!1,configurable:!0}),o.prototype.setVolume=function(e){var o=Math.max(0,Math.min(1,e));this.adInterface.data.volume=o,this.adInterface.data.isMute=0===this.adInterface.data.volume,this.adVideoPlayer.volume=o,this.adInterface.data.isMute?this.mute():this.unMute(),this.videoUI.updateVideoVolumeBtn(this.adInterface.data.isMute),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_VOLUME_CHANGE,{volume:e,adType:this.adInterface.order.adType,adInfo:this.adInterface.data.currentAdInfo,orderList:this.adInterface.order.orders})},o.prototype.mute=function(){this.adVideoPlayer.volume=0},o.prototype.unMute=function(){this.adVideoPlayer.volume=this.adInterface.data.volume},o.prototype.play=function(){this.adVideoPlayer.play()},o.prototype.resume=function(){this.adVideoPlayer.resume()},o.prototype.pause=function(){this.adVideoPlayer.pause()},o.prototype.load=function(){this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAYER_SESSION_START,{adType:this.adInterface.adType,vids:this.adInterface.data.urlList.map((function(t){return t.vid}))}),this.adVideoPlayer.load(l([],this.adInterface.data.urlList,!0))},o.prototype.start=function(){this.adViewMonitor||(this.adViewMonitor=new Pi(this.videoUI.$domNodes.videoContainer)),this.play()},o.prototype.destroy=function(){var e,o=this;this.adVideoPlayer.stop(),this.adVideoPlayer.removeAllListeners(),this.unbindVideoAdPlayerEvent(),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAYER_SESSION_END,{adType:this.adInterface.adType,vids:this.adInterface.data.urlList.map((function(t){return t.vid}))}),null===(e=this.adInterface.data.videoInfoList)||void 0===e||e.forEach((function(t){o.clearAdTimer(t,t.index)}))},o.prototype.bindVideoAdPlayerEvent=function(){this.forEachEvent(w.bind)},o.prototype.unbindVideoAdPlayerEvent=function(){this.forEachEvent(w.unbind)},o.prototype.forEachEvent=function(t){this.adVideoPlayer[t](m.LOADSTART,this.handleVideoLoadStart),this.adVideoPlayer[t](m.PROGRESS,this.handleVideoProgress),this.adVideoPlayer[t](m.CANPLAY,this.handleVideoCanPlay),this.adVideoPlayer[t](m.PLAYING,this.handleVideoPlaying),this.adVideoPlayer[t](m.PLAY,this.handleVideoResume),this.adVideoPlayer[t](m.PAUSE,this.handleVideoPause),this.adVideoPlayer[t](m.TIMEUPDATE,this.handleVideoTimeupdate),this.adVideoPlayer[t](m.ERROR,this.handleVideoError),this.adVideoPlayer[t](m.ENDED,this.handleVideoEnded),this.adVideoPlayer[t](m.WATCH_LOAD_PROGRESS,this.startAdTimer),this.adVideoPlayer[t](m.AD_AUTOPLAY_BLOCKED,this.handleAutoplayBlockedAd),this.adVideoPlayer[t](m.SET_LOADING,this.handleSetLoading)},o.prototype.getLoadCompleteParams=function(t,e){return{adInfo:e,adType:this.adInterface.order.adType,index:t.index,isAllLoaded:t.index===this.adInterface.order.orders.length-1,loadingTime:t.loadTime,errorCode:t.errorCode,detailErrorCode:t.detailErrorCode,hasTryBackupUrls:!!t.backupUrlData,materialDuration:e.material.duration,orderType:e.orderType,materialVid:e.material.vid,materialUrl:e.material.url,materialType:ot.VIDEO,adblock:this.adCore.adblockChecker.adBlockEnabled?"1":"0",load_start_time:t.loadStartTime,load_complete_time:t.loadCompleteTime,start_playtime:t.viewStartTime,playtime:t.playTime}},o.prototype.handleVideoLoadComplete=function(t,e){var o;if(!this.adInterface.data.isLoadComplete&&!t.loadCompleteTime&&(null!==(o=t.loadedPercent)&&void 0!==o?o:0)>.99){var i=t.index;this.logger.log("加载完成第 ".concat(i," 个"));var r=i===this.adInterface.data.adIndex;if(t.loadCompleteTime=Date.now(),t.loadStartTime&&(t.loadTime=t.loadCompleteTime-t.loadStartTime),t.hasReportLoadComplete||(t.hasReportLoadComplete=!0,this.adInterface.loadCompleteHandle(n(n({},this.getLoadCompleteParams(t,e)),{eventName:"onVideoProgress"}))),this.adInterface.data.isLoadComplete=i>=this.adInterface.order.orders.length-1,this.adInterface.data.isLoadComplete)this.logger.log("所有广告加载完成");else{var a=r?this.adInterface.data.adIndex+1:i+1;this.preloadNext(a,r)}}},o.prototype.playNext=function(t,e){void 0===e&&(e=!1),this.logger.log("播放下一个：".concat(t)),this.adVideoPlayer.playNext(t,e)?this.adInterface.setAdIndex(this.adInterface.data.adIndex+1):(this.adEndService.vrReportEnd("播放到最后一个"),this.adEndService.handleAdEnd())},o.prototype.preloadNext=function(t,e){return this.adInterface.order.orders&&0!==this.adInterface.order.orders.length?t>=this.adInterface.order.orders.length?(this.adEndService.vrReportEnd("preloadNext 索引过界"),void this.adEndService.handleAdEnd()):this.adVideoPlayer.preloadNext(t,e)?void(this.adInterface.order.orders[t]||(this.adEndService.vrReportEnd("preloadNext 没有下一个"),this.adEndService.handleAdEnd())):(this.adEndService.vrReportEnd("preloadNext 预加载下一个"),void this.adEndService.handleAdEnd()):(this.adEndService.vrReportEnd("preloadNext 全部空单"),void this.adEndService.handleAdEnd())},o.prototype.clearAdTimer=function(t,e){var o;t.loadProgressTimer&&(this.logger.log("清除卡顿定时器",{index:e}),null===(o=t.loadProgressTimer)||void 0===o||o.clear()),this.clearStuckAdTimer(t)},o.prototype.startStuckAdTimer=function(t){var e=this;t.stuckAdTimer&&window.clearTimeout(t.stuckAdTimer);var o=this.adInterface.order.orders[t.index];t.stuckAdTimer=window.setTimeout((function(){Ht.reportTechParam({name:"timeout",ad_type:e.adInterface.adType,order_type:null==o?void 0:o.orderType,idx:t.index,playtime:e.adInterface.data.prevPlayTime,playUrl:t.url,vid:t.vid,orderId:null==o?void 0:o.orderId,state:e.adInterface.state,timeoutType:"play"}),t.stuckAdTimer=void 0}),5e3)},o.prototype.clearStuckAdTimer=function(t){t.stuckAdTimer&&(window.clearTimeout(t.stuckAdTimer),t.stuckAdTimer=void 0)},o.prototype.initPlayer=function(){var t;if(null===(t=this.adVideoPlayer)||void 0===t||t.stop(),this.adVideoPlayer.removeAllListeners(),this.videoUI.$domNodes.videoAdContainer){this.adVideoPlayer.createPlayer(this.videoUI.$domNodes.videoAdContainer);var e=this.outerApi.videoPlayData.volume;this.adInterface.data.volume=Math.min(1,Math.max(0,void 0===e?1:e)),this.adVideoPlayer.volume=this.adInterface.data.volume,this.adInterface.data.volume?this.unMute():this.mute()}else this.logger.error("'videoAdContainer' dom 节点不存在")},o.prototype.unfoldActiveDetail=function(t,e){var o,i,r=t.data.poster.action_button,n=null===(o=r.picture)||void 0===o?void 0:o.display_interval,a=null===(i=r.qrcode)||void 0===i?void 0:i.display_interval;(t.isPictureActive&&n&&e>=n||t.isScanActive&&a&&e>=a)&&this.videoUI.unfoldActiveDetail()},o.prototype.reportScreenShot=function(t,e){var o=1e3*Math.floor(5*Math.random()),i=setTimeout((function(){Ht.reportPicture(t,{vid:t.material.vid,video:e,time:o}),clearTimeout(i)}),o)},o}(Ti),Si=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.updateCountdownUI=function(t,e){var o=this.adInterface.order.orders[t];if(o&&o.adType!==J.BROADCAST){if(this.adInterface.data.isTrueView){var i=Math.floor(this.adInterface.data.skipCountdown-e);i=Math.max(Math.floor(i),0),this.videoUI.updateTrueview({countdown:i,showCloseButton:this.adCore.outerApi.showCloseButton,skipAdTitle:this.adInterface.data.skipAdTitle,skipAdSubTitle:this.adInterface.data.skipAdSubTitle})}for(var r=Math.max(o.material.duration-e,0),n=t+1;n<this.adInterface.order.orders.length;n++){var a=this.adInterface.order.orders[n];a.adType!==J.BROADCAST&&(r+=a.material.duration)}r=Math.max(Math.floor(r),0),this.adCore.outerApi.showCloseButton||this.adInterface.data.isTrueView?this.videoUI.updateVideoCountdown("".concat(r)):this.videoUI.updateVideoCountdownHtml('<span style="color:#fff;">广告剩余: </span><span>'.concat(r,'</span><span style="color:#fff;">秒</span>'))}},e.prototype.updateVideoUI=function(t){this.videoUI.resetVideoUI(),t&&(this.videoUI.setVideoLayerVisible(!0),this.videoUI.setVideoAdInnerVisible(!0),this.videoUI.setVideoAdControlVisible(!0),this.videoUI.setVideoAdLayerVisible(!0),this.videoUI.setLinkAreaVisible(t.clickable),this.updateTitle(t),this.updateSkipButton(t),this.updateActionButton(t))},e.prototype.updateTitle=function(t){this.videoUI.updateVideoDSP(t.data.poster.title.dsp_name)},e.prototype.updateSkipButton=function(t){if(this.videoUI.updateVideoVolumeBtn(this.adInterface.data.isMute),J.BROADCAST===t.adType)return this.videoUI.setVideoCountdownVisible(!1),this.adCore.outerApi.showCloseButton?void this.videoUI.updateCloseButton({text:this.adInterface.data.skipAdTitle,show:!0}):void this.videoUI.updateCloseButton({show:!1});this.videoUI.setVideoCountdownVisible(!0),this.adInterface.data.isTrueView?this.videoUI.updateTrueview({countdown:0,showCloseButton:this.adCore.outerApi.showCloseButton,skipAdTitle:this.adInterface.data.skipAdTitle,skipAdSubTitle:this.adInterface.data.skipAdSubTitle}):this.videoUI.updateCloseButton({text:this.adInterface.data.skipAdTitle,show:this.adCore.outerApi.showCloseButton})},e.prototype.updateActionButton=function(t){var e,o=t.data.poster.action_button;if(o.display_none)this.videoUI.setVideoDetailVisible(!1);else{this.videoUI.setVideoDetailVisible(!0);var i=null!==(e=t.data.poster.action_button.base.action_title.first_title)&&void 0!==e?e:"点击按钮，查看详情",r=t.data.poster.advertiser;if(this.videoUI.updateActionButton({btnText:i,bgColor:o.base.bg_color,textColor:o.base.text_color}),t.isPictureActive)this.videoUI.updateActionPicture(n(n({},r),{btnText:i}));else if(t.isScanActive){var a=t.data.order.ad_action.scan,s=n(n({},r),{btnText:i,qrcodeUrl:null==a?void 0:a.short_link});this.videoUI.updateActionQrcode(s),this.videoUI.updateCenterQrcode(s);var d=a.url,l=a.qrcode_tips;this.videoUI.setScanCanOpenVisible(t.isActive&&t.isScanActive&&!(!d||-1!==d.indexOf("http://"))),l&&this.videoUI.updateQrcodeTips(l)}}},e}(Ti),Oi=function(t){function e(e){var o=t.call(this,e)||this;return o.handleContainerClick=function(t){var e=t.target,i=o.adInterface.data,r=i.currentVideoInfo,n=i.currentAdInfo;Ht.reportTechParam({name:"containerClick",ad_type:o.adInterface.adType,order_type:null==n?void 0:n.orderType,ad_playtime:o.playerService.currentTime,is_fullscreen_click:null==n?void 0:n.isFullscreenClick,idx:null==r?void 0:r.index,el_role:e.dataset.role,el_class:e.className,orderId:n.orderId})},o.handleVideoSkipTextClick=function(){o.adInterface.data.canSkipClose&&o.handleClose()},o.handleVideoCloseButtonClick=function(){o.handleClose()},o.handleVideoLinkAreaClick=function(t){var e=t.actionType;o.adInterface.data.currentAdInfo.isFullscreenClick&&o.handleDetail(e)},o.handleVideoDetailButtonClick=function(t){var e=t.actionType;o.handleDetail(e)},o.handleVideoNoSkipButtonClick=function(){o.handleToggleNoSkipDialog(!0)},o.handleVideoNoSkipKnowButtonClick=function(){o.handleToggleNoSkipDialog(!1)},o.handleVideoNoSkipCloseButtonClick=function(){o.handleToggleNoSkipDialog(!1)},o.handleVideoVolumeButtonClick=function(){var t;o.adInterface.data.isMute=!o.adInterface.data.isMute,o.adInterface.data.isMute?o.playerService.setVolume(0):o.playerService.setVolume(Math.min(100,Math.max(0,null!==(t=o.adCore.outerApi.videoPlayData.volume)&&void 0!==t?t:1))),o.videoUI.updateVideoVolumeBtn(o.adInterface.data.isMute)},o.handleVideoPlayIconClick=function(){o.adInterface.resume()},o.handleActiveScanDetailButtonClick=function(){},o.handleCenterQrcodeButtonClick=function(){o.adInterface.resume()},o.bindVideoUIEvent(),o}return r(e,t),e.prototype.destroy=function(){this.unbindVideoUIEvent()},e.prototype.unbindVideoUIEvent=function(){var t;this.forEachEvent(w.unbind),null===(t=this.videoUI.$domNodes.videoContainer)||void 0===t||t.removeEventListener("click",this.handleContainerClick,{capture:!0})},e.prototype.bindVideoUIEvent=function(){var t;this.forEachEvent(w.bind),null===(t=this.videoUI.$domNodes.videoContainer)||void 0===t||t.addEventListener("click",this.handleContainerClick,{capture:!0})},e.prototype.forEachEvent=function(t){this.videoUI[t](yi.VIDEO_SKIP_TEXT_CLICK,this.handleVideoSkipTextClick),this.videoUI[t](yi.VIDEO_CLOSE_BUTTON_CLICK,this.handleVideoCloseButtonClick),this.videoUI[t](yi.VIDEO_LINK_AREA_CLICK,this.handleVideoLinkAreaClick),this.videoUI[t](yi.VIDEO_DETAIL_BUTTON_CLICK,this.handleVideoDetailButtonClick),this.videoUI[t](yi.VIDEO_NO_SKIP_BUTTON_CLICK,this.handleVideoNoSkipButtonClick),this.videoUI[t](yi.VIDEO_NO_SKIP_KNOW_BUTTON_CLICK,this.handleVideoNoSkipKnowButtonClick),this.videoUI[t](yi.VIDEO_NO_SKIP_CLOSE_BUTTON_CLICK,this.handleVideoNoSkipCloseButtonClick),this.videoUI[t](yi.VIDEO_VOLUME_BUTTON_CLICK,this.handleVideoVolumeButtonClick),this.videoUI[t](yi.VIDEO_PLAY_ICON_CLICK,this.handleVideoPlayIconClick),this.videoUI[t](yi.ACTIVE_SCAN_DETAIL_BUTTON_CLICK,this.handleActiveScanDetailButtonClick),this.videoUI[t](yi.CENTER_QRCODE_CLOSE_BUTTON_CLICK,this.handleCenterQrcodeButtonClick)},e.prototype.handleClose=function(){if(this.adInterface.data.canClickToStopAd){var t=this.adInterface.data,e=t.currentVideoInfo,o=t.currentAdInfo;return(null==e?void 0:e.viewStartTime)&&(e.viewTime=(Date.now()-e.viewStartTime)/1e3),this.adInterface.data.userCloseOrderId=null==o?void 0:o.orderId,this.logger.log("用户点击了关闭"),this.adEndService.vrReportEnd("用户点击关闭"),void this.adEndService.handleAdEnd()}this.adCore.outerApi.showCloseButton&&(this.adInterface.pause(),this.adInterface.data.pauseWhenVipPanelShow=!0,this.adCore.outerApi.showOpenVIPGuide())},e.prototype.handleDetail=function(t){var e;void 0===t&&(t=pt.AD_DETAIL);var o=this.adInterface.data.currentAdInfo,i={name:"click",ad_type:this.adInterface.adType,order_type:null==o?void 0:o.orderType,ad_playtime:this.playerService.currentTime,is_fullscreen_click:null==o?void 0:o.isFullscreenClick,idx:null===(e=this.adInterface.data.currentVideoInfo)||void 0===e?void 0:e.index,action_type:t,orderId:o.orderId,reportUrl:this.adInterface.getJumpLink(o,t)};if(o){if(o.orderType===He.ACTIVE_SCAN)return this.adInterface.pause(),this.videoUI.setCenterQrcodeVisible(!0),o.reporter.reportEffects(),Ht.reportClick(o,{actionType:t,playTime:this.playerService.currentTime,order_type:o.orderType}),void Ht.reportTechParam(n(n({},i),{result:"扫码"}));if(this.adInterface.resume(),o.orderType===He.ACTIVE_SCAN_JUMP&&o.miniProgramInfo)if(this.adCore.outerApi.launchMiniProgram(o.miniProgramInfo))return void this.adInterface.openLinkAndReport(o,{actionType:t,playTime:this.playerService.currentTime,order_type:o.orderType,launchMiniProgram:!0},!0);if(o.clickable)return this.adInterface.openLinkAndReport(o,{actionType:t,playTime:this.playerService.currentTime,order_type:o.orderType}),void Ht.reportTechParam(n(n({},i),{result:"跳转落地页"}));Ht.reportTechParam(n(n({},i),{result:"不可跳转"}))}else Ht.reportTechParam(n(n({},i),{result:"adInfo 未找到"}))},e.prototype.handleToggleNoSkipDialog=function(t){t?this.adInterface.pause():this.adInterface.resume(),this.videoUI.setNoSkipDialogVisible(t)},e}(Ti),Li=function(t){function e(e){var o=t.call(this,e)||this;return o.videoUI=o.adCore.getUIInterface(Ci),o.blockScreen=new bi(o),o.playerService=new wi(o),o.adEndService=new xi(o),o.updateUIService=new Si(o),o.videoUIEventService=new Oi(o),o.browserEventService=new Di(o),o.logger=V("PostAd"),o.parseOrder(),o}return r(e,t),e.prototype.load=function(){this.logger.log("调用 load"),this.state!==ge.WAIT_FOR_STOP?(this.setState(ge.LOADING),this.data.isEmpty||this.playerService.load()):this.logger.log("调用 load 方法","".concat(ge.WAIT_FOR_STOP," 状态的广告不需要执行 load"))},e.prototype.play=function(){if(this.logger.log("调用 play",{isEmpty:this.data.isEmpty}),this.data.isEmpty)return this.adEndService.vrReportEnd("整体空单"),void this.adEndService.handleAdEnd();if(this.data.currentPlayAdType=this.order.adType,[J.TAIL].includes(this.order.adType)&&this.state===ge.WAIT_FOR_STOP)return t.prototype.pause.call(this),this.adEndService.vrReportEnd("后贴已结束"),void this.adEndService.handleAdEnd();if(this.state!==ge.PLAYING){if(this.logger.log("调用 play",{state:this.state,pauseWhenVipPanelShow:this.data.pauseWhenVipPanelShow}),this.state===ge.PAUSED||this.data.pauseWhenVipPanelShow)return this.data.pauseWhenVipPanelShow=!1,void this.resume();this.playerService.start()}},e.prototype.resume=function(){this.logger.log("调用 resume"),t.prototype.resume.call(this),this.data.currentAdInfo&&this.playerService.resume()},e.prototype.pause=function(){(this.logger.log("调用 pause"),this.state!==ge.PAUSED)&&(t.prototype.pause.call(this),this.data.currentAdInfo&&this.playerService.pause())},e.prototype.mute=function(){this.logger.log("调用 mute"),this.playerService.mute()},e.prototype.unMute=function(){this.logger.log("调用 unMute"),this.playerService.unMute()},e.prototype.stop=function(t){this.logger.log("调用 stop"),this.adEndService.vrReportEnd("外部关闭"),this.blockScreen&&this.blockScreen.reset(),this.adEndService.handleAdEnd(t)},e.prototype.resize=function(t){this.logger.log("调用 resize",t);var e=t.width;e&&this.videoUI.updateCenterQrcodeSizeClass(e)},e.prototype.adjustUI=function(t){if(this.logger.log("调用 adjustUI",t),t){var e="".concat(t.top||10,"px"),o="".concat(t.bottom||10,"px");this.videoUI.adjustVideoAdControl({top:e,bottom:o})}},e.prototype.setVolume=function(t){this.playerService.setVolume(t)},e.prototype.report=function(){var t;this.logger.log("调用 report"),null===(t=this.data.currentAdInfo)||void 0===t||t.reporter.reportExposure()},e.prototype.reset=function(){var t;null===(t=this.data.videoInfoList)||void 0===t||t.forEach((function(t){var e;null===(e=t.loadProgressTimer)||void 0===e||e.clear()}))},e.prototype.destroy=function(){this.logger.log("调用 destroy"),this.data.hasDestroy||(this.pause(),this.videoUI.resetVideoUI(!0),this.playerService.destroy(),this.browserEventService.destroy(),this.reset(),this.videoUIEventService.destroy(),this.setState(ge.END),t.prototype.destroy.call(this))},e.prototype.setAdIndex=function(t){this.data.adIndex=t,this.adInfo=this.order.orders[t]},e.prototype.getVideoInfoByOrderId=function(t){var e;return null===(e=this.playerService)||void 0===e?void 0:e.adVideoPlayer.adVideoInfoList.find((function(e){return e.orderId===t}))},e.prototype.setRfid=function(t){this.data.refresh_id=t},e.prototype.initData=function(){var e=this,o=this,i=this,r=i.order,a=i.adCore,s=i.adInfo,d=n(n({},t.prototype.initData.call(this)),{duration:0,showCountdown:0,urlList:[],volume:0,isMute:!1,isLoadComplete:!1,prevPlayTime:0,hasReportVideoEnd:!1,hasAdPlayingEmit:!1,adIndex:0,isFirstExposure:!0}),l={isEmpty:function(){return 0===r.orders.length},firstLoadTime:function(){return e.data.firstLoadingEndTime&&e.data.firstLoadingStartTime?Math.abs(e.data.firstLoadingEndTime-e.data.firstLoadingStartTime):-1},isTrueView:function(){var t=a.outerApi.playerData;return("in"===t.playerPf||"H5"===t.playerPf||"client"===t.playerPf||3===t.playerChid||2020===t.playerChid)&&1===r.orders.length&&s.data.poster.skip.duration>0},trueViewCountDown:function(){return e.data.isTrueView?s.data.poster.skip.duration/1e3:0},skipCountdown:function(){var t=e.data.duration-e.data.trueViewCountDown;return e.data.duration<=t?0:e.data.trueViewCountDown},canSkipClose:function(){var t,o;if(e.data.isTrueView){var i=Math.floor(e.data.skipCountdown-(null!==(o=null===(t=e.data.currentVideoInfo)||void 0===t?void 0:t.playTime)&&void 0!==o?o:0));return(i=Math.max(Math.floor(i),0))<=0}return!0},skipAdTitle:function(){var t,e,o;return null!==(o=null===(e=null===(t=s.data.poster)||void 0===t?void 0:t.skip)||void 0===e?void 0:e.title)&&void 0!==o?o:"关闭该广告"},skipAdSubTitle:function(){var t,e,o;return null!==(o=null===(e=null===(t=s.data.poster)||void 0===t?void 0:t.skip)||void 0===e?void 0:e.sub_title)&&void 0!==o?o:"关闭该广告"},canClickToStopAd:function(){return e.data.isTrueView},rfid:function(){var t,o;return null!==(t=e.data.refresh_id)&&void 0!==t?t:null===(o=r.auth)||void 0===o?void 0:o.refresh_id},currentAdInfo:function(){return r.orders[e.data.adIndex]||o.adInfo},currentVideoInfo:function(){return o.getVideoInfoByOrderId(e.data.currentAdInfo.orderId)},videoInfoList:function(){var t;return null===(t=o.playerService)||void 0===t?void 0:t.adVideoPlayer.adVideoInfoList}};return Object.entries(l).forEach((function(t){var e=t[0],o=t[1];Object.defineProperty(d,e,{get:function(){return o()}})})),d},e.prototype.getVrExtraData=function(){var t={sum:this.order.orders.length};return this.order.orders.forEach((function(e){t[e.orderType]||(t[e.orderType]=0),t[e.orderType]+=1})),{order_types:t}},e.prototype.parseOrder=function(){var t=this;this.order.empty.forEach((function(e){t.logger.log("上报空单",{index:e.orderIdx}),e.reporter.reportExposure()})),this.data.duration=this.order.orders.reduce((function(t,e){return t+e.material.duration}),0),0!==this.order.orders.length?(this.logger.log("一共有[".concat(this.order.orders.length,"]个非空订单，总时长: ").concat(this.data.duration," s")),this.data.urlList=this.order.orders.map((function(t){var e=t.material,o=t.orderId,i=ye("fmt",e.url)||nt.SHD;return{fmt:i,orderId:o,uid:"".concat(i,"-").concat(e.vid),vid:e.vid,url:e.enable_crt_cached?qo(e.vid,e.url,t.adType):e.url,fileSize:e.file_size,duration:e.duration}}))):this.logger.log("整体空订单")},e}(xe);!function(t){t[t.START=0]="START",t[t.PAUSED=1]="PAUSED"}(Ii||(Ii={}));var Vi,Ri=function(){function t(t){var e;this.isRunning=!1,this.timeList=[],this.prevTime=null,this.interval=null,this.logger=V("CountdownInterval"),this.options=t,this.options.timeout=null!==(e=this.options.timeout)&&void 0!==e?e:200}return Object.defineProperty(t.prototype,"time",{get:function(){var t;return null!==(t=this.prevTime)&&void 0!==t?t:0},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.isRunning||(this.timeList.push({time:Date.now(),type:Ii.START}),this.startInterval())},t.prototype.paused=function(){this.isRunning&&(this.timeList.push({time:Date.now(),type:Ii.PAUSED}),this.clearInterval())},t.prototype.clear=function(){this.clearInterval(),this.timeList=[],this.prevTime=null},t.prototype.startInterval=function(){var t=this;this.interval||(this.interval=window.setInterval((function(){var e=t.getRunningTime(),o=t.options.onChange;t.prevTime!==e&&(t.prevTime=e,null==o||o(t.prevTime))}),this.options.timeout),this.isRunning=!0)},t.prototype.clearInterval=function(){this.interval&&(clearInterval(this.interval),this.interval=null,this.isRunning=!1)},t.prototype.getRunningTime=function(){var t=null,e=[];return this.timeList.forEach((function(o){o.type!==Ii.START||t?o.type===Ii.PAUSED&&t&&(e.push(o.time-t),t=null):t=o.time})),t&&e.push(Date.now()-t),Math.floor(e.reduce((function(t,e){return t+e}),0)/1e3)},t}(),Mi=Mo("enter-countdown"),ki={layer:Mi("layer"),container:Mi("container"),countdownNum:Mi("num")},Ui=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=ki,e}return r(e,t),e.prototype.updateCountdown=function(t){de(this.$domNodes.countdownNum,t),this.setDomVisible(this.$domNodes.container,!0)},e.prototype.reset=function(){de(this.$domNodes.countdownNum,""),this.setDomVisible(this.$domNodes.container,!1)},e.prototype.getTemplate=function(){return'\n      <txpdiv class="txp_ad_control txp_none" data-role="'.concat(this.roleMap.container,'">\n        <txpdiv class="txp_ad_skip">\n          <txpdiv class="txp_ad_countdown" data-role="').concat(this.roleMap.countdownNum,'"></txpdiv>\n          <txpdiv class="txp_ad_skip_text">进入广告</txpdiv>\n        </txpdiv>\n      </txpdiv>\n    ')},e}(ko),Bi=function(e){function o(o){var i=e.call(this,o)||this;return i.enterCountdownUI=i.adCore.getUIInterface(Ui),i.countdown=10,i.handleCountdownChange=function(e){var o=i.countdown-e;o>=0?i.enterCountdownUI.updateCountdown("".concat(o)):(i.countdownInterval.paused(),i.enterCountdownUI.reset(),i.adCore.adEventEmitter.emit(t.AD_EVENT.AD_ENTER_COUNTDOWN_COMPLETE,{adType:i.adType}))},i.countdownInterval=new Ri({onChange:i.handleCountdownChange}),i}return r(o,e),o.prototype.pauseCountdown=function(){this.countdownInterval.paused()},o.prototype.resumeCountdown=function(){this.countdownInterval.time<=this.countdown&&this.countdownInterval.start()},o.prototype.stop=function(){this.enterCountdownUI.reset(),this.countdownInterval.clear(),e.prototype.stop.call(this)},o.prototype.startEnterCountdown=function(){this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_ENTER_COUNTDOWN,{adType:this.adType}),this.countdownInterval.start()},o.isPointAd=!0,o.isMultiple=!1,o}(Li);!function(t){t[t.INIT=0]="INIT",t[t.REQUEST=1]="REQUEST",t[t.LOADING=2]="LOADING",t[t.PLAYING=3]="PLAYING"}(Vi||(Vi={}));var zi=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.countdownInterval=null,t.dynamicMidStatus=Vi.INIT,t.checkDynamicMid=function(e){return s(t,void 0,void 0,(function(){var t,o,i,r,n,a,s=this;return d(this,(function(d){switch(d.label){case 0:return t=1e3*e,o=this.dynamicInfo.next_request_interval,this.dynamicMidStatus!==Vi.INIT?[3,3]:t>=o-15e3?(this.dynamicMidStatus=Vi.REQUEST,Ht.reportRequestDynamicMiddle(),[4,this.requestDynamicMid()]):[3,2];case 1:d.sent(),d.label=2;case 2:return[2];case 3:return this.dynamicMidStatus===Vi.REQUEST?(this.loadDynamicMid(),[2]):(this.dynamicMidStatus===Vi.LOADING&&(i=1e3*this.adCore.outerApi.videoPlayData.playtime,r=Math.max(o-t,0),this.adCore.orderCtrl.checkPointConflict(i+r,Date.now()+r,this.conflictInterval).forEach((function(t){if(!(t.adType===J.MID||t.adType===J.CORNER&&t.point.is_whole_scene)){var e=t.point.end+s.conflictInterval-(t.point.type===it.TIMESTAMP?Date.now():i);e>r&&(r=e)}})),n=this.getAd(),r<=1e4&&(null==n?void 0:n.data.canPlay)&&(null==n||n.startEnterCountdown(),null===(a=this.countdownInterval)||void 0===a||a.clear(),this.dynamicMidStatus=Vi.PLAYING)),[2])}}))}))},t.handleVideoPause=function(){var e;null===(e=t.countdownInterval)||void 0===e||e.paused();var o=t.getAd();null==o||o.pauseCountdown()},t.handleVideoResume=function(){var e;null===(e=t.countdownInterval)||void 0===e||e.start();var o=t.getAd();null==o||o.resumeCountdown()},t.handleAdStop=function(e){[J.MID,J.DYNAMIC_MID].includes(e.adType)&&(t.clear(),t.isDynamicMid&&t.doDynamicMid())},t}return r(o,e),Object.defineProperty(o.prototype,"needCheckPlaytime",{get:function(){var t=this.adCore.getRunningAds(J.TAIL);return!t.length||!t.some((function(t){return t.hasCallPlay}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dynamicMidPoint",{get:function(){return this.adCore.orderCtrl.getPoints(J.MID).find((function(t){return 3===t.mid_type}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isDynamicMid",{get:function(){return!!this.dynamicMidPoint},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"conflictInterval",{get:function(){var t;return(null===(t=this.dynamicMidPoint)||void 0===t?void 0:t.conflict_interval)||1e4},enumerable:!1,configurable:!0}),o.prototype.startWatch=function(){e.prototype.startWatch.call(this),this.adCore.outerApi.on(B.VIDEO_PAUSE,this.handleVideoPause),this.adCore.outerApi.on(B.VIDEO_PLAYING,this.handleVideoResume),this.adCore.adEventEmitter.on(t.AD_EVENT.AD_STOP,this.handleAdStop)},o.prototype.endWatch=function(){e.prototype.endWatch.call(this),this.adCore.outerApi.off(B.VIDEO_PAUSE,this.handleVideoPause),this.adCore.outerApi.off(B.VIDEO_PLAYING,this.handleVideoResume),this.adCore.adEventEmitter.off(t.AD_EVENT.AD_STOP,this.handleAdStop)},o.prototype.timeupdate=function(t){var e=this;this.adCore.outerApi.isSoloPlayingPhls||this.needCheckPlaytime&&(this.isDynamicMid?this.doDynamicMid():this.adCore.orderCtrl.getPoints(J.MID).forEach((function(o){var i=e.adCore.orderCtrl.getPointOrderFromPoint(J.MID,o);if(2!==o.mid_type){if(0!==i.point.begin)if(i.pointStatus!==Ge.INIT){if(i.pointStatus===Ge.LOADING){var r=e.getAd();t>=i.point.begin-1e4&&(null==r?void 0:r.data.canPlay)&&(null==r||r.startEnterCountdown(),i.pointStatus=Ge.PLAYING)}}else t>=i.point.begin-15e3&&t<=i.point.begin+15e3&&(i.pointStatus=Ge.LOADING,e.adCore.loadAdOrder(i).catch((function(){var t;null===(t=e.logger)||void 0===t||t.error("loadAd 失败",J.HLS_MID)})))}else e.checkFixRealTimeMid(t,i)})))},o.prototype.reset=function(){this.clear(),window.sessionStorage.removeItem(ao)},o.prototype.clear=function(){this.dynamicMidStatus=Vi.INIT,this.countdownInterval&&(this.countdownInterval.clear(),this.countdownInterval=null)},o.prototype.requestDynamicMid=function(t){var e;return s(this,void 0,void 0,(function(){var o,i;return d(this,(function(r){switch(r.label){case 0:this.adCore.orderCtrl.adOrderMap.delete(J.MID),2===(null==t?void 0:t.mid_type)?o=null!==(e=t.zcindex)&&void 0!==e?e:0:(o=Number(window.sessionStorage.getItem(ao)||-1),o+=1),window.sessionStorage.setItem(ao,"".concat(o)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.adCore.outerApi.requestProxyHttp(W.DYNAMIC_MID)];case 2:if(r.sent(),!(null==(i=this.adCore.getAdOrder(J.MID))?void 0:i.orders.length))throw Error("未请求到动态中插广告");return[3,4];case 3:return r.sent(),this.clear(),[3,4];case 4:return[2]}}))}))},o.prototype.doDynamicMid=function(){var t;if(this.dynamicMidStatus===Vi.INIT){var e=this.adCore.orderCtrl.getExtraData(J.DYNAMIC_MID);if(e)return e.stop_request_dynamic_ad?(null===(t=this.countdownInterval)||void 0===t||t.clear(),void(this.countdownInterval=null)):void(this.countdownInterval||(this.countdownInterval=new Ri({timeout:1e3,onChange:this.checkDynamicMid}),this.dynamicInfo=e,this.countdownInterval.start()))}},o.prototype.getAd=function(){var t=this.adCore.getRunningAds(J.MID);if(t.length>0)return t[0]},o.prototype.checkFixRealTimeMid=function(t,e){if(this.dynamicMidStatus!==Vi.INIT||e.pointStatus!==Ge.INIT)if(this.dynamicMidStatus!==Vi.REQUEST){if(this.dynamicMidStatus===Vi.LOADING){var o=this.getAd();t>=e.point.begin-1e4&&(null==o?void 0:o.data.canPlay)&&(null==o||o.startEnterCountdown(),this.dynamicMidStatus=Vi.PLAYING)}}else this.loadDynamicMid();else t>=e.point.begin-15e3&&t<=e.point.begin+15e3&&(Ht.reportRequestFixedMiddle(),this.requestDynamicMid(e.point),this.dynamicMidStatus=Vi.REQUEST,e.pointStatus=Ge.LOADING)},o.prototype.loadDynamicMid=function(){var t=this,e=this.adCore.orderCtrl.getAdOrder(J.MID);e&&(0===this.adCore.getRunningAds(J.MID).length&&(this.adCore.loadAdOrder(e).catch((function(){var e;null===(e=t.logger)||void 0===e||e.error("loadAd 失败",J.HLS_MID)})),this.dynamicMidStatus=Vi.LOADING))},o}(xo),Hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.load=function(){t.prototype.load.call(this),this.adInfo&&this.adInfo.point||this.stop()},e.prototype.play=function(){var e=this.adCore.outerApi.videoPlayData.playtime;if(this.adInfo.reporter.setVideoPlaytime(1e3*e),this.state!==ge.PLAYING&&this.state!==ge.PAUSED)if(this.adInfo&&this.adInfo.point){t.prototype.play.call(this),this.show(),Ht.reportExposure(this.adInfo);var o=this.adCore.outerApi.playerData,i=o.playerVid,r=o.playerCid,a=o.playerFlowid,s=this.adInfo.point.time_offset,d=void 0===s?0:s;Ht.reportNonStandard(n({vid:i,cid:r,flow_id:a,ad_exposure_position:(1e3*e-d).toFixed(0)},this.adInfo.getVrReportData()))}else this.stop()},e.prototype.stop=function(){var e;this.state!==ge.END&&(this.hide(),t.prototype.stop.call(this),Ht.reportEnded(this.order,{ad_playtime:this.data.showTime?Date.now()-this.data.showTime:-1,first_view:null!==(e=this.data.showTime)&&void 0!==e?e:-1}),this.destroy())},e.isPointAd=!0,e.isMultiple=!0,e}(xe),$i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.timeupdate=function(t){var e=this;this.adCore.outerApi.isSoloPlayingPhls||this.adCore.orderCtrl.getPoints(J.NON_STANDARD).forEach((function(o){var i=e.adCore.orderCtrl.getPointOrderFromPoint(J.NON_STANDARD,o);i&&0!==i.orders.length&&(t>=o.begin&&t<=o.end?(i.pointStatus===Ge.INIT&&(i.orders.forEach((function(t){e.adCore.loadAdOrder(n(n({},i),{orders:[t]})).catch((function(t){}))})),i.pointStatus=Ge.PLAYING),i.pointStatus===Ge.PLAYING&&i.orders.forEach((function(t){e.adCore.playAd(J.NON_STANDARD,t.orderId)}))):i.pointStatus!==Ge.INIT&&(i.pointStatus=Ge.INIT,i.orders.forEach((function(t){e.adCore.stopAd(J.NON_STANDARD,t.orderId)}))))}))},e}(xo);qe(".txp_zt{color:#fff;height:100%;position:absolute;width:100%;z-index:2}.txp_zt .txp_zt_ad_mask{background-color:rgba(0,0,0,.5);height:100%;pointer-events:none;width:100%}.txp_zt .txp_zt_content{background-color:#1c1c1c;border-radius:4px;cursor:pointer;left:50%;overflow:hidden;pointer-events:auto;position:absolute;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.txp_zt .txp_zt_content.txp_ad_active_normal .txp_zt_progress{bottom:66px}.txp_zt .txp_zt_content.txp_ad_active_normal .txp_zt_mute{bottom:82px}.txp_zt .txp_zt_content.txp_ad_active_normal .bottom_desc_text_container,.txp_zt .txp_zt_content.txp_ad_active_normal .bottom_desc_text_container .bottom_desc_text{display:block}.txp_zt .txp_zt_content .txp_zt_loading{background-color:#1c1c1c;background-position:50%;background-repeat:no-repeat;background-size:100% 100%;cursor:auto;pointer-events:unset;z-index:2}.txp_zt .txp_zt_content .txp_zt_err_tips{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background-color:#1c1c1c;cursor:auto;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:100%;justify-content:center;position:absolute;width:100%;z-index:2}.txp_zt .txp_zt_content .txp_zt_err_tips .txp_zt_err_tips_text{font-size:16px;margin-bottom:20px}.txp_zt .txp_zt_content .txp_zt_err_tips .txp_zt_err_tips_btn{background-color:hsla(0,0%,100%,.1);border-radius:15px;cursor:pointer;font-size:12px;height:30px;line-height:30px;text-align:center;width:90px}.txp_zt .txp_zt_content .txp_zt_image_material,.txp_zt .txp_zt_content .txp_zt_video_material{height:100%;width:100%}.txp_zt .txp_zt_content .txp_zt_close{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.5);border-radius:2px;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:12px;height:26px;line-height:26px;padding-left:10px;position:absolute;right:5px;top:5px;width:58px;z-index:3}.txp_zt .txp_zt_content .txp_zt_close:hover{background-color:rgba(0,0,0,.8)}.txp_zt .txp_zt_content .txp_zt_close img{display:block;height:14px;margin-left:2px;width:14px}.txp_zt .txp_zt_content .txp_zt_detail{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#fe5c38;border-radius:15px;bottom:12px;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:12px;height:30px;line-height:30px;padding:0 15px;position:absolute;right:10px;width:100px}.txp_zt .txp_zt_content .txp_zt_detail:hover{background-color:#ff183e}.txp_zt .txp_zt_content .txp_zt_detail img{height:16px;margin-right:6px;width:16px}.txp_zt .txp_zt_content .txp_zt_mute{fill:#fff;border-radius:50%;bottom:12px;cursor:pointer;height:30px;left:10px;padding:5px;position:absolute;width:30px}.txp_zt .txp_zt_content .txp_zt_mute:hover{background-color:rgba(0,0,0,.8)}.txp_zt .txp_zt_content .txp_zt_mute.mute .txp_svg_volume_mute,.txp_zt .txp_zt_content .txp_zt_mute.volume .txp_svg_volume{display:block}.txp_zt .txp_zt_content .txp_zt_mute .txp_svg_symbol{display:none}.txp_zt .txp_zt_content .txp_zt_progress{background-color:hsla(0,0%,100%,.45);bottom:0;cursor:auto;height:4px;left:0;position:absolute;width:100%}.txp_zt .txp_zt_content .txp_zt_progress .progress{background-color:#fe5c38;border-bottom-right-radius:2px;border-top-right-radius:2px;height:4px;-webkit-transition:width .15s;transition:width .15s;width:0}.txp_zt .txp_zt_content .bottom_desc_text_container{background-color:rgba(31,31,31,.9);bottom:0;display:none;height:66px;left:0;position:absolute;width:100%}.txp_zt .txp_zt_content .bottom_desc_text_container .bottom_desc_text{color:#fff;font-size:18px;height:66px;line-height:66px;overflow:hidden;text-indent:15px;text-overflow:ellipsis;white-space:nowrap}.txp_zt .txp_zt_content .bottom_desc_text_container .bottom_desc_text.level-full{width:645px}.txp_zt .txp_zt_content .bottom_desc_text_container .bottom_desc_text.level-high-hd{width:447px}.txp_zt .txp_zt_content .bottom_desc_text_container .bottom_desc_text.level-hd{width:306px}.txp_zt .txp_zt_content .bottom_desc_text_container .bottom_desc_text.level-normal{width:180px}.txp_zt .txp_zt_content .translucent-top-text-container{background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.5)),color-stop(93%,transparent));background-image:linear-gradient(180deg,rgba(0,0,0,.5),transparent 93%);border-radius:4px 4px 0 0;height:80px;left:0;position:absolute;top:0;-webkit-transition:all .3s ease;transition:all .3s ease;width:100%}.txp_zt .txp_zt_content .translucent-top-text-container .translucent-top-text{color:#fff;font-family:PingFangSC-Regular;font-size:18px;letter-spacing:0;line-height:48px;overflow:hidden;text-indent:15px;text-overflow:ellipsis;text-shadow:0 1px 2px rgba(0,0,0,.25);white-space:nowrap}.txp_zt .txp_zt_content .translucent-top-text-container .translucent-top-text.level-full{width:540px}.txp_zt .txp_zt_content .translucent-top-text-container .translucent-top-text.level-high-hd{width:468px}.txp_zt .txp_zt_content .translucent-top-text-container .translucent-top-text.level-hd{width:342px}.txp_zt .txp_zt_content .translucent-top-text-container .translucent-top-text.level-normal{width:252px}.txp_zt .txp_zt_content .float-qrcode{background-color:rgba(0,0,0,.8);border-radius:4px;bottom:10px;height:134px;position:absolute;right:10px;-webkit-transition:all .3s ease;transition:all .3s ease;width:110px}.txp_zt .txp_zt_content .float-qrcode .float-code{background-color:#fff;height:90px;left:10px;position:absolute;top:10px;width:90px}.txp_zt .txp_zt_content .float-qrcode .float-code img{height:90%;margin:5%;width:90%}.txp_zt .txp_zt_content .float-qrcode .scan-tips{bottom:10px;color:#fff;height:14px;left:0;letter-spacing:1px;position:absolute;white-space:nowrap;width:110px}.txp_zt .txp_zt_content .float-qrcode .scan-tips span{font-size:20px;left:50%;line-height:14px;position:absolute;-webkit-transform:scale(.5) translateX(-100%);transform:scale(.5) translateX(-100%);-webkit-transform-origin:50% 50%;transform-origin:50% 50%}.txp_zt .txp_zt_content .right-qrcode{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background-color:rgba(0,0,0,.5);display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:100%;justify-content:center;pointer-events:auto;position:absolute;right:-270px;top:0;-webkit-transition:all .3s ease;transition:all .3s ease;width:270px}.txp_zt .txp_zt_content .right-qrcode.level-high-hd .item-avatar-box{margin-top:20px}.txp_zt .txp_zt_content .right-qrcode.level-high-hd .item-text{display:none}.txp_zt .txp_zt_content .right-qrcode.level-high-hd .right-code{margin-top:10px}.txp_zt .txp_zt_content .right-qrcode.level-hd .item-avatar-box{margin-top:15px}.txp_zt .txp_zt_content .right-qrcode.level-hd .item-title{margin-top:5px}.txp_zt .txp_zt_content .right-qrcode.level-hd .item-text{display:none}.txp_zt .txp_zt_content .right-qrcode.level-hd .right-code{height:136px;margin-top:5px;width:136px}.txp_zt .txp_zt_content .right-qrcode.level-normal .item-avatar-box,.txp_zt .txp_zt_content .right-qrcode.level-normal .item-text,.txp_zt .txp_zt_content .right-qrcode.level-normal .item-title{display:none}.txp_zt .txp_zt_content .right-qrcode.level-normal .right-code{height:136px;margin-top:10px;width:136px}.txp_zt .txp_zt_content .right-qrcode .item-avatar-box{border-radius:50%;height:40px;margin-top:35px;overflow:hidden;width:40px}.txp_zt .txp_zt_content .right-qrcode .item-avatar-box .item-avatar{height:100%;width:100%}.txp_zt .txp_zt_content .right-qrcode .item-title{color:#fff;font-size:14px;margin-top:10px;overflow:hidden;text-align:center;text-overflow:ellipsis;white-space:nowrap;width:190px}.txp_zt .txp_zt_content .right-qrcode .item-text{-webkit-line-clamp:2;-webkit-box-orient:vertical;color:#fff;display:-webkit-box;font-size:14px;line-height:22px;margin-top:15px;overflow:hidden;text-align:center;text-overflow:ellipsis;text-overflow:-o-ellipsis-lastline;width:200px}.txp_zt .txp_zt_content .right-qrcode .right-code{background-color:#fff;height:200px;margin-top:20px;width:200px}.txp_zt .txp_zt_content .right-qrcode .right-code img{height:90%;margin:5%;width:90%}.txp_zt .txp_zt_content .right-qrcode .scan-tips{color:#fff;font-size:14px;letter-spacing:1px;line-height:14px;margin-bottom:10px;margin-top:10px;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.25);white-space:nowrap;width:200px}.txp_zt .txp_zt_content:hover .translucent-top-text-container{top:-80px;-webkit-transition:all .3s ease;transition:all .3s ease}.txp_zt .txp_zt_content:hover .float-qrcode{right:-120px;-webkit-transition:all .3s ease;transition:all .3s ease}.txp_zt .txp_zt_content:hover .right-qrcode{right:0;-webkit-transition:all .3s ease;transition:all .3s ease}.txp_zt .txp_play_icon{left:50%;pointer-events:auto;position:absolute;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:10%}.txp_zt .txp_none{display:none!important}.txp_zt.txp_zt_3d_video .txp_zt_content{background-color:transparent;max-height:522px;max-width:932px}.txp_zt.txp_zt_3d_video .txp_zt_content .txp_zt_loading{background-color:transparent}.txp_ad .txp_btn_close_ad{background-color:#000;background-color:rgba(0,0,0,.7);height:26px;position:absolute;right:0;top:0;width:26px;z-index:2}.txp_ad .txp_btn_close_ad:after,.txp_ad .txp_btn_close_ad:before{left:7px}");var Ki,Gi,Yi,Fi=Mo("pause"),Wi={layer:Fi("layer"),pauseContainer:Fi("container"),pauseMask:Fi("mask"),pauseContent:Fi("content"),pauseLoading:Fi("loading"),pauseErrorTips:Fi("error-tips"),pauseErrorTipsBtn:Fi("error-tips-btn"),pauseVideoMaterialContainer:Fi("video-material-container"),pauseImageMaterialContainer:Fi("image-material-container"),pauseImageMaterialImg:Fi("image-material-img"),pauseTopTextContainer:Fi("top-text-container"),pauseTopText:Fi("top-text"),pauseFloatQrcode:Fi("float-qrcode"),pauseFloatQrcodeContainer:Fi("float-qrcode-container"),pauseFloatQrcodeScanTips:Fi("float-qrcode-scan-tips"),pauseRightQrcode:Fi("right-qrcode"),pauseCenterQrcodeItemAvatar:Fi("center-qrcode-item-avatar"),pauseRightQrcodeItemTitle:Fi("center-qrcode-item-title"),pauseRightQrcodeItemText:Fi("center-qrcode-item-text"),pauseCenterQrcodeContainer:Fi("center-qrcode-container"),pauseCenterQrcodeScanTips:Fi("center-qrcode-scan-tips"),pauseClose:Fi("close"),pauseMute:Fi("mute"),pauseProgressContainer:Fi("progress-container"),pauseProgress:Fi("progress"),pauseBottomTextContainer:Fi("bottom-text-container"),pauseBottomText:Fi("bottom-text"),pauseBottomTextSpan:Fi("bottom-text-span"),pauseDetailBtn:Fi("detail-btn"),pauseDetailBtnText:Fi("detail-btn-text"),pausePictureContainer:Fi("picture-container"),pausePictureImg:Fi("picture-img"),pausePictureClose:Fi("picture-close"),pausePictureDspName:Fi("picture-dsp-name"),pausePictureVpaidContainer:Fi("picture-vpaid-container")};!function(t){t.PAUSE_CONTENT_HOVER="PAUSE_CONTENT_HOVER",t.PAUSE_CLOSE_CLICK="PAUSE_CLOSE_CLICK",t.PAUSE_MUTE_CLICK="PAUSE_MUTE_CLICK",t.PAUSE_RETRY_CLICK="PAUSE_RETRY_CLICK",t.PAUSE_LINK_AREA_CLICK="PAUSE_LINK_AREA_CLICK",t.PAUSE_DETAIL_BTN_CLICK="PAUSE_DETAIL_BTN_CLICK",t.PAUSE_IMAGE_MATERIAL_IMG_LOAD="PAUSE_IMAGE_MATERIAL_IMG_LOAD",t.PAUSE_IMAGE_MATERIAL_IMG_ERROR="PAUSE_IMAGE_MATERIAL_IMG_ERROR"}(Ki||(Ki={})),function(t){t.LEVEL_FULL="levelFullHd",t.LEVEL_HIGH_HD="levelHighHd",t.LEVEL_HD="levelHd",t.LEVEL_NORMAL="levelNormal"}(Gi||(Gi={})),function(t){t[t.LEVEL_FULL=1/0]="LEVEL_FULL",t[t.LEVEL_HIGH_HD=1390]="LEVEL_HIGH_HD",t[t.LEVEL_HD=1180]="LEVEL_HD",t[t.LEVEL_NORMAL=880]="LEVEL_NORMAL"}(Yi||(Yi={}));var qi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=Wi,e}return r(e,t),e.prototype.setContainerVisible=function(t){this.setDomVisible(this.$domNodes.pauseContainer,t)},e.prototype.setPauseContentVisible=function(t){this.setDomVisible(this.$domNodes.pauseContent,t)},e.prototype.setMaskVisible=function(t){this.setDomVisible(this.$domNodes.pauseMask,t)},e.prototype.setErrorTipsVisible=function(t){this.setDomVisible(this.$domNodes.pauseErrorTips,t)},e.prototype.setLoadingVisible=function(t){this.setDomVisible(this.$domNodes.pauseLoading,t)},e.prototype.toggleMute=function(t){t?(ie(this.$domNodes.pauseMute,"volume"),oe(this.$domNodes.pauseMute,"mute")):(ie(this.$domNodes.pauseMute,"mute"),oe(this.$domNodes.pauseMute,"volume"))},e.prototype.setVideoMaterialVisible=function(t){t?(ne(this.$domNodes.pauseVideoMaterialContainer),ne(this.$domNodes.pauseProgressContainer),ne(this.$domNodes.pauseMute)):(re(this.$domNodes.pauseVideoMaterialContainer),re(this.$domNodes.pauseProgressContainer),re(this.$domNodes.pauseMute),this.setLoadingVisible(!1))},e.prototype.setImageMaterialVisible=function(t){this.setDomVisible(this.$domNodes.pauseImageMaterialContainer,t)},e.prototype.setTransparentVideoMaterialVisible=function(t){this.setDomVisible(this.$domNodes.pauseVideoMaterialContainer,t)},e.prototype.setPausePictureMaterialVisible=function(t){this.setDomVisible(this.$domNodes.pausePictureContainer,t)},e.prototype.updateTransparentVideoContainer=function(){oe(this.$domNodes.pauseContainer,"txp_zt_3d_video")},e.prototype.updateImageMaterial=function(t){Zt(this.$domNodes.pauseImageMaterialImg,"src",t)},e.prototype.updateClickable=function(t){ee(this.$domNodes.pauseContent,"cursor",t?"auto":"pointer")},e.prototype.updateActionButton=function(t){t.btnText&&(de(this.$domNodes.pauseDetailBtnText,t.btnText),ee(this.$domNodes.pauseDetailBtn,{color:t.textColor,backgroundColor:t.bgColor}),ne(this.$domNodes.pauseDetailBtn))},e.prototype.updateProgress=function(t){ee(this.$domNodes.pauseProgress,"width",t)},e.prototype.resizeMaterialContainerSize=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=this.$domNodes.pauseContainer.offsetWidth);var o=783,i=439;e<1390&&(o=602,i=338),e<1180&&(o=463,i=260),e<880&&(o=356,i=200),ee(this.$domNodes.pauseContent,{width:o,height:i}),t&&(e>=Yi.LEVEL_HIGH_HD&&e<Yi.LEVEL_FULL&&(this.showQrcodeTypeWith(Gi.LEVEL_FULL),this.showWebpageGameAdTypeWith(Gi.LEVEL_FULL)),e>=Yi.LEVEL_HD&&e<Yi.LEVEL_HIGH_HD&&(this.showQrcodeTypeWith(Gi.LEVEL_HIGH_HD),this.showWebpageGameAdTypeWith(Gi.LEVEL_HIGH_HD)),e>=Yi.LEVEL_NORMAL&&e<Yi.LEVEL_HD&&(this.showQrcodeTypeWith(Gi.LEVEL_HD),this.showWebpageGameAdTypeWith(Gi.LEVEL_HD)),e<Yi.LEVEL_NORMAL&&(this.showQrcodeTypeWith(Gi.LEVEL_NORMAL),this.showWebpageGameAdTypeWith(Gi.LEVEL_NORMAL)))},e.prototype.updateVideoPost=function(t){t&&ee(this.$domNodes.pauseLoading,"background-image","url('".concat(t,"')"))},e.prototype.updateActivePicture=function(t){oe(this.$domNodes.pauseContent,"txp_ad_active_normal"),de(this.$domNodes.pauseBottomTextSpan,t),ne(this.$domNodes.pauseBottomTextContainer)},e.prototype.updateActiveQrcode=function(t){this.$domNodes.pauseFloatQrcodeContainer&&t.qrcodeUrl&&this.outerApi.renderQrCode(this.$domNodes.pauseFloatQrcodeContainer,me(t.qrcodeUrl,{act:"1025"}),90),this.$domNodes.pauseCenterQrcodeContainer&&t.qrcodeUrl&&this.outerApi.renderQrCode(this.$domNodes.pauseCenterQrcodeContainer,me(t.qrcodeUrl,{act:"1026"}),200);var e=t.qrcodeTips||"扫码了解详情";de(this.$domNodes.pauseCenterQrcodeScanTips,e),de(this.$domNodes.pauseFloatQrcodeScanTips,e),ne(this.$domNodes.pauseFloatQrcode),ne(this.$domNodes.pauseRightQrcode),ne(this.$domNodes.pauseTopTextContainer),de(this.$domNodes.pauseTopText,t.description),Zt(this.$domNodes.pauseCenterQrcodeItemAvatar,"src",t.icon_url),de(this.$domNodes.pauseRightQrcodeItemTitle,t.name),de(this.$domNodes.pauseRightQrcodeItemText,t.description)},e.prototype.adjustDomNodes=function(){this.$domNodes.layer&&this.setDomNodes(this.$domNodes.layer,this.$domNodes,"pauseVideoMaterialContainer")},e.prototype.reset=function(){this.setMaskVisible(!1),this.setContainerVisible(!1),this.setPauseContentVisible(!1),this.setErrorTipsVisible(!1),this.setVideoMaterialVisible(!1),this.setImageMaterialVisible(!1),this.setTransparentVideoMaterialVisible(!1),this.setPausePictureMaterialVisible(!1),ee(this.$domNodes.pauseLoading,"background-image",""),ie(this.$domNodes.pauseContainer,"txp_zt_3d_video"),te(this.$domNodes.pauseImageMaterialImg,"src"),le(this.$domNodes.pauseVideoMaterialContainer,""),ie(this.$domNodes.pauseContent,"txp_ad_active_normal"),de(this.$domNodes.pauseBottomTextSpan,""),re(this.$domNodes.pauseDetailBtn),re(this.$domNodes.pauseFloatQrcode),re(this.$domNodes.pauseRightQrcode),re(this.$domNodes.pauseTopTextContainer),de(this.$domNodes.pauseTopText,""),Zt(this.$domNodes.pauseCenterQrcodeItemAvatar,"src",""),de(this.$domNodes.pauseRightQrcodeItemTitle,""),de(this.$domNodes.pauseRightQrcodeItemText,"")},e.prototype.resizePausePictureContainer=function(t,e){ee(this.$domNodes.pausePictureContainer,{width:"".concat(t,"px"),height:"".concat(e,"px"),top:"0px",left:"0px",right:"0px",bottom:"0px",margin:"auto"}),ee(this.$domNodes.pausePictureImg,{width:"".concat(t,"px"),height:"".concat(e,"px")})},e.prototype.updatePausePictureDspName=function(t){le(this.$domNodes.pausePictureDspName,t)},e.prototype.updatePausePictureImgCursor=function(t){ee(this.$domNodes.pausePictureImg,"cursor",t)},e.prototype.updatePausePictureImgSrc=function(t){this.$domNodes.pausePictureImg&&(t?this.$domNodes.pausePictureImg.src=t:te(this.$domNodes.pausePictureImg,"src"))},e.prototype.mount=function(){t.prototype.mount.call(this),this.$domNodes.layer&&(this.$domNodes.layer.style.cssText="position: absolute; top: 0px; right: 0px; width: 100%; height: 100%; z-index: 4; pointer-events: none;")},e.prototype.getDomEvents=function(){var t=this,e=!1;return[{el:this.$domNodes.pauseContent,eventName:Lo.MOUSE_ENTER,listener:function(o){o.stopPropagation(),e||(t.emit(Ki.PAUSE_CONTENT_HOVER),e=!0,setTimeout((function(){e=!1}),1e3))}},{el:this.$domNodes.pauseClose,eventName:Lo.CLICK,listener:function(e){e.stopPropagation(),t.emit(Ki.PAUSE_CLOSE_CLICK)}},{el:this.$domNodes.pauseMute,eventName:Lo.CLICK,listener:function(e){e.stopPropagation(),t.emit(Ki.PAUSE_MUTE_CLICK)}},{el:this.$domNodes.pauseErrorTipsBtn,eventName:Lo.CLICK,listener:function(e){e.stopPropagation(),t.emit(Ki.PAUSE_RETRY_CLICK)}},{el:this.$domNodes.pauseContent,eventName:Lo.CLICK,listener:function(e){e.stopPropagation(),t.emit(Ki.PAUSE_LINK_AREA_CLICK,pt.AD_VIEW_AREA)}},this.forwardActionTypeDomEvent(this.$domNodes.pauseTopTextContainer,pt.AD_DETAIL),this.forwardActionTypeDomEvent(this.$domNodes.pauseFloatQrcode,pt.AD_DETAIL),this.forwardActionTypeDomEvent(this.$domNodes.pauseRightQrcode,pt.AD_DETAIL),this.forwardActionTypeDomEvent(this.$domNodes.pauseBottomTextContainer,pt.AD_DETAIL),this.forwardActionTypeDomEvent(this.$domNodes.pauseDetailBtn,pt.AD_ACTION_BUTTON),this.forwardActionTypeDomEvent(this.$domNodes.pauseCenterQrcodeItemAvatar,pt.ADVERTISER_LOGO),this.forwardActionTypeDomEvent(this.$domNodes.pauseRightQrcodeItemTitle,pt.ADVERTISER_NAME),this.forwardActionTypeDomEvent(this.$domNodes.pauseRightQrcodeItemText,pt.AD_TITLE),this.forwardActionTypeDomEvent(this.$domNodes.pauseBottomTextSpan,pt.AD_TITLE),this.forwardActionTypeDomEvent(this.$domNodes.pauseTopText,pt.AD_TITLE),this.forwardActionTypeDomEvent(this.$domNodes.pauseCenterQrcodeContainer,pt.AD_ACTION_BUTTON),this.forwardActionTypeDomEvent(this.$domNodes.pauseFloatQrcodeContainer,pt.AD_ACTION_BUTTON),{el:this.$domNodes.pauseErrorTips,eventName:Lo.CLICK,listener:function(t){t.stopPropagation()}},{el:this.$domNodes.pauseLoading,eventName:Lo.CLICK,listener:function(t){t.stopPropagation()}},{el:this.$domNodes.pauseImageMaterialImg,eventName:Lo.LOAD,listener:function(){t.emit(Ki.PAUSE_IMAGE_MATERIAL_IMG_LOAD)}},{el:this.$domNodes.pauseImageMaterialImg,eventName:Lo.ERROR,listener:function(){t.emit(Ki.PAUSE_IMAGE_MATERIAL_IMG_ERROR)}},this.forwardDomEvent(this.$domNodes.pausePictureImg,Ki.PAUSE_LINK_AREA_CLICK),this.forwardDomEvent(this.$domNodes.pausePictureImg,Ki.PAUSE_IMAGE_MATERIAL_IMG_LOAD,Lo.LOAD),this.forwardDomEvent(this.$domNodes.pausePictureImg,Ki.PAUSE_IMAGE_MATERIAL_IMG_ERROR,Lo.ERROR),this.forwardDomEvent(this.$domNodes.pausePictureClose,Ki.PAUSE_CLOSE_CLICK)]},e.prototype.getTemplate=function(){var t=this.roleMap;return'\n      <txpdiv data-role="'.concat(t.pauseContainer,'" class="txp_zt txp_none">\n        \n        <txpdiv data-role="').concat(t.pauseMask,'" class="txp_zt_ad_mask txp_none"></txpdiv>\n    \n        \n        <txpdiv data-role="').concat(t.pauseContent,'" class="txp_zt_content txp_none">\n          \n          <txpdiv data-role="').concat(t.pauseLoading,'" class="txp_zt_loading txp_overlay_loading txp_none">\n            <txpdiv class="txp_icon_loading"></txpdiv>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.pauseErrorTips,'" class="txp_zt_err_tips txp_none">\n            <txpdiv class="txp_zt_err_tips_text">视频加载失败，请点击重试</txpdiv>\n            <txpdiv data-role="').concat(t.pauseErrorTipsBtn,'" class="txp_zt_err_tips_btn">点击重试</txpdiv>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.pauseVideoMaterialContainer,'" class="txp_zt_video_material txp_none"></txpdiv>\n          \n          <txpdiv data-role="').concat(t.pauseImageMaterialContainer,'" class="txp_zt_image_material txp_none">\n            <img data-role="').concat(t.pauseImageMaterialImg,'" style="width:100%; height:100%;" alt="" />\n          </txpdiv>\n          \n          \n          <txpdiv data-role="').concat(t.pauseTopTextContainer,'" class="txp_none translucent-top-text-container">\n            <txpdiv data-role="').concat(t.pauseTopText,'" class="translucent-top-text"></txpdiv>\n          </txpdiv>\n    \n          \n          <txpdiv data-role="').concat(t.pauseFloatQrcode,'" class="txp_none float-qrcode">\n            \n            <txpdiv data-role="').concat(t.pauseFloatQrcodeContainer,'" class="float-code"></txpdiv>\n            \n            <txpdiv class="scan-tips"><span data-role="').concat(t.pauseFloatQrcodeScanTips,'">扫码了解详情</span></txpdiv>\n          </txpdiv>\n    \n          \n          <txpdiv data-role="').concat(t.pauseRightQrcode,'" class="txp_none right-qrcode">\n            \n            <div class="item-avatar-box">\n              <img\n                data-role="').concat(t.pauseCenterQrcodeItemAvatar,'"\n                class="item-avatar"\n                alt=""\n                src="').concat(ui,'"\n              />\n            </div>\n            \n            <div data-role="').concat(t.pauseRightQrcodeItemTitle,'" class="item-title"></div>\n            <div data-role="').concat(t.pauseRightQrcodeItemText,'" class="item-text"></div>\n            \n            <txpdiv data-role="').concat(t.pauseCenterQrcodeContainer,'" class="right-code"></txpdiv>\n            \n            <txpdiv data-role="').concat(t.pauseCenterQrcodeScanTips,'" class="scan-tips">扫码了解详情</txpdiv>\n          </txpdiv>\n    \n          \n          <txpdiv data-role="').concat(t.pauseClose,'" class="txp_zt_close">\n            广告\n            <txpidv class="close">\n              <img\n                class="not-hover"\n                src="').concat(hi,'"\n                alt=""\n              />\n            </txpidv>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.pauseMute,'" class="txp_zt_mute volume txp_none">\n            <svg viewBox="0 0 20 20" class="txp_svg_volume txp_svg_symbol">\n              <path\n                d="M16.714 15.593l-.01-.01a1 1 0 0 1-1.705-.708c0-.287.124-.542.317-.724C16.354 13.073 17 11.614 17 10s-.645-3.072-1.682-4.151A.993.993 0 0 1 15 5.125a1 1 0 0 1 1-1c.3 0 .561.139.744.348l.017-.016A7.969 7.969 0 0 1 19 10c0 2.178-.874 4.15-2.286 5.593zm-3.999 3.122a.956.956 0 0 1-.688.28c-.009 0-.018.005-.027.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h3.818l5.432-3.643A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v16c0 .009-.005.017-.005.026a.959.959 0 0 1-.28.689zM6.75 6.643A.984.984 0 0 1 6 7H3v6h3c.304 0 .567.143.75.357l4.25 2.85V3.792L6.75 6.643z"\n              ></path>\n            </svg>\n            <svg viewBox="0 0 20 20" class="txp_svg_volume_mute txp_svg_symbol">\n              <path\n                d="M16.394 12.566A5.88 5.88 0 0 0 17 10a5.97 5.97 0 0 0-1.682-4.151.993.993 0 0 1-.318-.724 1 1 0 0 1 1-1c.3 0 .561.139.745.348l.016-.016A7.969 7.969 0 0 1 19 10a7.934 7.934 0 0 1-1.116 4.055l-1.49-1.489zM11 3.792L8.978 5.149 7.62 3.792l3.63-2.435A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v7.171l-2-2V3.792zm7.864 14.072a.999.999 0 0 1-1.414 0L2.136 2.55a1 1 0 1 1 1.415-1.415L18.864 16.45a1 1 0 0 1 0 1.414zM3.171 5l2 2H3v6h3c.304 0 .567.143.75.357l4.25 2.85v-3.379l2 2V18c0 .009-.005.017-.005.027a.955.955 0 0 1-.967.968c-.01 0-.019.005-.028.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.171z"\n              ></path>\n            </svg>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.pauseProgressContainer,'" class="txp_zt_progress txp_none">\n            <txpdiv data-role="').concat(t.pauseProgress,'" class="progress"></txpdiv>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.pauseBottomTextContainer,'" class="bottom_desc_text_container txp_none">\n            <txpdiv data-role="').concat(t.pauseBottomText,'" class="bottom_desc_text">\n              <span data-role="').concat(t.pauseBottomTextSpan,'"></span>\n            </txpdiv>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.pauseDetailBtn,'" class="txp_zt_detail txp_none">\n            <img\n              src="').concat(ui,'"\n              alt=""\n            />\n            <txpidv data-role="').concat(t.pauseDetailBtnText,'"></txpidv>\n          </txpdiv>\n        </txpdiv>\n        \n        \n        <txpdiv data-role="').concat(t.pausePictureContainer,'" class="txp_ad txp_none" style="position: absolute;z-index: 2; cursor: pointer;">\n          <button data-role="').concat(t.pausePictureClose,'" class="txp_btn txp_btn_close txp_btn_close_ad" title="关闭该广告" ></button>\n          <img data-role="').concat(t.pausePictureImg,'" alt="" />\n          <txpdiv style="left:8px;bottom:8px;position:absolute;opacity:0.6;font-size:12px;z-index:99">\n            <txpdiv style="background:#000;display:inline-block;box-shadow:2px 2px #000">广告</txpdiv>\n            <txpdiv data-role="').concat(t.pausePictureDspName,'" style="display:inline-block;margin-left:10px;text-shadow:2px 2px #000" />\n          </txpdiv>\n          <txpdiv data-role="').concat(t.pausePictureVpaidContainer,'" />\n        </txpdiv>\n      </txpdiv>\n    ')},e.prototype.showQrcodeTypeWith=function(t){this.resizeShowType(this.$domNodes.pauseRightQrcode,t),this.resizeShowType(this.$domNodes.pauseTopText,t)},e.prototype.showWebpageGameAdTypeWith=function(t){this.resizeShowType(this.$domNodes.pauseBottomText,t)},e.prototype.resizeShowType=function(t,e){t&&(ie(t,"level-full"),ie(t,"level-high-hd"),ie(t,"level-hd"),ie(t,"level-normal"),e===Gi.LEVEL_FULL?oe(t,"level-full"):e===Gi.LEVEL_HIGH_HD?oe(t,"level-high-hd"):e===Gi.LEVEL_HD?oe(t,"level-hd"):e===Gi.LEVEL_NORMAL&&oe(t,"level-normal"))},e.prototype.forwardActionTypeDomEvent=function(t,e){var o=this;return{el:t,eventName:Lo.CLICK,listener:function(t){t.stopPropagation(),o.emit(Ki.PAUSE_DETAIL_BTN_CLICK,e)}}},e}(ko),ji=function(t){function e(e){var o=t.call(this,e)||this;return o.pauseUI=o.adCore.getUIInterface(qi),o.handleCloseClick=function(){o.data.closeBtnClicked=!0,o.stop()},o.handleDetailClick=function(t){if(void 0===t&&(t=pt.AD_VIEW_AREA),o.adInfo.clickable&&(!o.adInfo.isScanActive||o.adInfo.enableClick)){var e=o.data.showTime?Date.now()-o.data.showTime:-1;if(o.adInfo.isScanActive&&o.adInfo.enableClick&&o.adInfo.miniProgramInfo)if(o.adCore.outerApi.launchMiniProgram(o.adInfo.miniProgramInfo))return void o.openLinkAndReport(o.adInfo,{actionType:t,playTime:e,order_type:o.adInfo.orderType,launchMiniProgram:!0},!0);o.openLinkAndReport(o.adInfo,{actionType:t,playTime:e})}},o.handleContentHover=function(){o.adInfo.data.poster.action_button.action_type===et.QRCODE&&o.adInfo.reporter.reportEffects()},o.handleImageLoad=function(){var t;o.data.endLoadTime=Date.now(),o.canplayHandler(),o.loadCompleteHandle({adType:o.adType,adInfo:o.adInfo,index:o.adInfo.orderIdx,loadingTime:o.data.endLoadTime-o.data.startLoadTime,materialUrl:null===(t=o.adInfo.imageMaterial)||void 0===t?void 0:t.url,materialType:o.adInfo.materialType}),o.show()},o.handleImageError=function(){var t;o.data.endLoadTime=Date.now(),o.data.errorCode=S.LOAD_FAIL,o.loadCompleteHandle({adType:o.adType,adInfo:o.adInfo,index:o.adInfo.orderIdx,hasError:"1",detailErrorCode:S.LOAD_FAIL,loadingTime:o.data.endLoadTime-o.data.startLoadTime,materialUrl:null===(t=o.adInfo.imageMaterial)||void 0===t?void 0:t.url,materialType:o.adInfo.materialType}),o.stop()},o.pauseUI.reset(),o.data.startTime=Date.now(),o}return r(e,t),e.prototype.stop=function(){this.state!==ge.END&&(this.hide(),t.prototype.stop.call(this),this.vrReportEnded(),this.destroy())},e.prototype.updateUI=function(){var t=this.adInfo.data.poster.action_button,e=t.base.action_title.first_title||"了解详情";this.pauseUI.updateClickable(this.adInfo.clickable);var o=this.adInfo.data.poster.advertiser;if(t.action_type!==et.QRCODE)t.action_type===et.PICTURE&&this.pauseUI.updateActivePicture(o.description),this.pauseUI.updateActionButton({btnText:e,textColor:t.base.text_color,bgColor:t.base.bg_color});else{var i=this.adInfo.data.order.ad_action.scan,r=n(n({},o),{btnText:e,qrcodeUrl:null==i?void 0:i.short_link,qrcodeTips:null==i?void 0:i.qrcode_tips});this.pauseUI.updateActiveQrcode(r)}},e.prototype.bindUIEvent=function(){this.pauseUI.on(Ki.PAUSE_CLOSE_CLICK,this.handleCloseClick),this.pauseUI.on(Ki.PAUSE_LINK_AREA_CLICK,this.handleDetailClick),this.pauseUI.on(Ki.PAUSE_DETAIL_BTN_CLICK,this.handleDetailClick),this.pauseUI.on(Ki.PAUSE_CONTENT_HOVER,this.handleContentHover)},e.prototype.unbindUIEvent=function(){this.pauseUI.off(Ki.PAUSE_CLOSE_CLICK,this.handleCloseClick),this.pauseUI.off(Ki.PAUSE_LINK_AREA_CLICK,this.handleDetailClick),this.pauseUI.off(Ki.PAUSE_DETAIL_BTN_CLICK,this.handleDetailClick),this.pauseUI.off(Ki.PAUSE_CONTENT_HOVER,this.handleContentHover)},e.prototype.getLoadTime=function(){var t=this.data;return t.startLoadTime&&t.endLoadTime?t.endLoadTime-t.startLoadTime:-1},e.prototype.vrReportEnded=function(){var t;if(!this.data.isFirstClose&&this.data.showTime){var e=this.data;Ht.reportEnded(this.order,{load_time:this.getLoadTime(),close_time:e.closeBtnClicked&&this.data.showTime?Date.now()-this.data.showTime:-1,ad_playtime:e.startTime?Date.now()-e.startTime:-1,error_code:this.data.errorCode,first_view:null!==(t=e.showTime)&&void 0!==t?t:-1},this.getVrExtraData()),e.isFirstClose=!0}},e.prototype.getVrExtraData=function(){return{order_type:this.adInfo.orderType,is_active_scan:this.adInfo.isScanActive}},e.prototype.reportExposure=function(){this.adInfo.reporter.reportExposure(),Ht.reportExposure(this.adInfo,!0,this.getVrExtraData())},e}(xe),Qi=function(e){function o(t){var o=e.call(this,t)||this;return o.pauseUI=o.adCore.getUIInterface(qi),o.pauseUI.setPauseContentVisible(!0),o.updateUI(),o.bindUIEvent(),o}return r(o,e),o.prototype.load=function(){var o;this.adInfo&&(null===(o=this.adInfo.imageMaterial)||void 0===o?void 0:o.url)?(e.prototype.load.call(this),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adType:this.order.adType,adInfo:this.adInfo}),this.data.startLoadTime=Date.now(),this.pauseUI.setImageMaterialVisible(!0),this.pauseUI.updateImageMaterial(this.adInfo.imageMaterial.url)):this.stop()},o.prototype.show=function(){e.prototype.show.call(this),this.pauseUI.setContainerVisible(!0),this.pauseUI.setLoadingVisible(!1),this.pauseUI.resizeMaterialContainerSize(this.adInfo.isActive),this.reportExposure()},o.prototype.hide=function(){e.prototype.hide.call(this),this.pauseUI.setContainerVisible(!1)},o.prototype.destroy=function(){this.data.hasDestroy||(this.unbindUIEvent(),this.pauseUI.reset(),e.prototype.destroy.call(this))},o.prototype.resize=function(t){!t||t.left&&t.top||this.pauseUI.resizeMaterialContainerSize(this.adInfo.isActive,t.width)},o.prototype.bindUIEvent=function(){e.prototype.bindUIEvent.call(this),this.pauseUI.on(Ki.PAUSE_IMAGE_MATERIAL_IMG_LOAD,this.handleImageLoad),this.pauseUI.on(Ki.PAUSE_IMAGE_MATERIAL_IMG_ERROR,this.handleImageError)},o.prototype.unbindUIEvent=function(){e.prototype.unbindUIEvent.call(this),this.pauseUI.off(Ki.PAUSE_IMAGE_MATERIAL_IMG_LOAD,this.handleImageLoad),this.pauseUI.off(Ki.PAUSE_IMAGE_MATERIAL_IMG_ERROR,this.handleImageError)},o}(ji);var Ji=function(e){function o(t){var o=e.call(this,t)||this;return o.logger=V("ContractPicturePauseAd"),o.bindUIEvent(),o}return r(o,e),o.prototype.load=function(){var o,i,r;if(this.adInfo&&(null===(o=this.adInfo.imageMaterial)||void 0===o?void 0:o.url)){e.prototype.load.call(this),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adType:this.order.adType,adInfo:this.adInfo}),this.pauseUI.updatePausePictureDspName(null===(r=null===(i=this.adInfo.data.poster)||void 0===i?void 0:i.title)||void 0===r?void 0:r.dsp_name);var n=this.adCore.outerApi.getPlayerSize(),a=n.playerWidth,s=n.playerHeight;this.resize({width:a,height:s}),this.pauseUI.updatePausePictureImgCursor(this.adInfo.clickable?"pointer":"none"),this.data.startLoadTime=Date.now(),this.pauseUI.updatePausePictureImgSrc(this.adInfo.imageMaterial.url)}else this.stop()},o.prototype.show=function(){e.prototype.show.call(this),this.pauseUI.setPausePictureMaterialVisible(!0),this.pauseUI.setContainerVisible(!0),this.adCore.outerApi.resetBarrageZindex(),this.reportExposure()},o.prototype.hide=function(){this.data.isShow&&(this.pauseUI.setPausePictureMaterialVisible(!1),this.pauseUI.setContainerVisible(!1),e.prototype.hide.call(this))},o.prototype.destroy=function(){this.pauseUI.updatePausePictureImgSrc(),this.unbindUIEvent(),this.pauseUI.reset(),e.prototype.destroy.call(this)},o.prototype.setAdSmallWindow=function(t){t&&this.resize(t)},o.prototype.resize=function(t){if(!(!t||t.left&&t.top)&&t.width&&t.height&&this.adInfo.imageMaterial){var e=this.adInfo.imageMaterial,o=e.width,i=e.height;if(o&&i){if(o>t.width||i>t.height){var r=function(t,e,o,i){if(t<=0||e<=0||o<=0||i<=0)return 0;var r=o/t,n=i/e;return Math.min(r,n)||1}(o,i,t.width,t.height);o*=r,i*=r}this.pauseUI.resizePausePictureContainer(o,i)}}},o.prototype.bindUIEvent=function(){this.pauseUI.on(Ki.PAUSE_LINK_AREA_CLICK,this.handleDetailClick),this.pauseUI.on(Ki.PAUSE_CLOSE_CLICK,this.handleCloseClick),this.pauseUI.on(Ki.PAUSE_IMAGE_MATERIAL_IMG_LOAD,this.handleImageLoad),this.pauseUI.on(Ki.PAUSE_IMAGE_MATERIAL_IMG_ERROR,this.handleImageError)},o.prototype.unbindUIEvent=function(){this.pauseUI.off(Ki.PAUSE_LINK_AREA_CLICK,this.handleDetailClick),this.pauseUI.off(Ki.PAUSE_CLOSE_CLICK,this.handleCloseClick),this.pauseUI.off(Ki.PAUSE_IMAGE_MATERIAL_IMG_LOAD,this.handleImageLoad),this.pauseUI.off(Ki.PAUSE_IMAGE_MATERIAL_IMG_ERROR,this.handleImageError)},o}(ji);qe(".txp_full_screen_pause{background:#000;color:#fff;font-family:PingFang SC;font-size:14px;font-weight:500;height:100%;position:absolute;width:100%;z-index:1000}.txp_full_screen_pause-material-container{height:100%;width:100%}.txp_full_screen_pause-material-container video{background:#000}.txp_full_screen_pause-ad-flag{-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background:hsla(0,0%,7%,.4);border-radius:3px;display:-webkit-box;display:-ms-flexbox;display:flex;height:16px;justify-content:center;left:16px;position:absolute;top:16px;width:30px;z-index:3}.txp_full_screen_pause-ad-flag>span{font-family:MF FangHei;font-size:12px;-webkit-transform:scale(.83);transform:scale(.83);-webkit-transform-origin:50% 50%;transform-origin:50% 50%}.txp_full_screen_pause-close{background:rgba(51,51,51,.6);position:absolute;right:24px;top:16px;width:89px}.txp_full_screen_pause-close,.txp_full_screen_pause-detail{-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;border-radius:18px;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;height:36px;justify-content:center}.txp_full_screen_pause-detail{background-color:#fe5c38;padding:0 12px 0 10px}.txp_full_screen_pause-detail:hover{background-color:#ff183e}.txp_full_screen_pause-detail img{height:20px;margin-right:4px;width:20px}.txp_full_screen_pause-detail-box{bottom:16px;position:absolute;right:24px}.txp_full_screen_pause-detail-box,.txp_full_screen_pause-mute{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}.txp_full_screen_pause-mute{-webkit-box-pack:center;-ms-flex-pack:center;background:rgba(51,51,51,.6);border-radius:18px;cursor:pointer;height:36px;justify-content:center;margin-left:12px;width:36px}.txp_full_screen_pause-mute .txp_svg_symbol{height:18px;width:18px}.txp_full_screen_pause-mute.volume .txp_svg_volume{display:block}.txp_full_screen_pause-mute.mute .txp_svg_volume,.txp_full_screen_pause-mute.volume .txp_svg_volume_mute{display:none}.txp_full_screen_pause-mute.mute .txp_svg_volume_mute{display:block}.txp_full_screen_pause-play-icon{-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background-color:rgba(0,0,0,.3);border-radius:12px;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;justify-content:center;opacity:0;position:absolute;-webkit-transition:opacity 50ms ease-in;transition:opacity 50ms ease-in;z-index:10000}.txp_full_screen_pause-play-icon>svg{height:32px;width:32px}");var Xi,Zi=Mo("full-screen-pause"),tr={layer:Zi("layer"),container:Zi("container"),videoContainer:Zi("video-container"),pictureContainer:Zi("picture-container"),pictureImg:Zi("picture-img"),closeBtn:Zi("close-btn"),adFlag:Zi("ad-flag"),mute:Zi("mute"),detailBox:Zi("detail-box"),detailBtn:Zi("detail-btn"),detailBtnText:Zi("detail-btn-text"),videoPlayIcon:Zi("video-play-icon")};!function(t){t.IMAGE_LOAD="FULL_SCREEN_PAUSE_IMAGE_LOAD",t.CLOSE_CLICK="FULL_SCREEN_PAUSE_CLOSE_CLICK",t.PLAY_CLICK="FULL_SCREEN_PAUSE_PLAY_ICON_CLICK",t.LINK_AREA_CLICK="FULL_SCREEN_PAUSE_LINK_AREA_CLICK",t.DETAIL_BTN_CLICK="FULL_SCREEN_PAUSE_DETAIL_BTN_CLICK",t.MUTE_CLICK="FULL_SCREEN_PAUSE_MUTE_CLICK"}(Xi||(Xi={}));var er,or=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=tr,e}return r(e,t),e.prototype.setContainerVisible=function(t){this.setDomVisible(this.$domNodes.container,t)},e.prototype.setMuteVisible=function(t){this.setDomVisible(this.$domNodes.mute,t)},e.prototype.setPictureVisible=function(t){this.setDomVisible(this.$domNodes.pictureContainer,t)},e.prototype.setVideoVisible=function(t){this.setDomVisible(this.$domNodes.videoContainer,t)},e.prototype.setPlayIconVisible=function(t){this.setDomVisible(this.$domNodes.videoPlayIcon,t)},e.prototype.updateActionButton=function(t){var e;de(this.$domNodes.detailBtnText,null!==(e=t.btnText)&&void 0!==e?e:"点击视频，了解详情"),ee(this.$domNodes.detailBtnText,{color:t.textColor,backgroundColor:t.bgColor})},e.prototype.adjustDomNodes=function(){this.$domNodes.layer&&this.setDomNodes(this.$domNodes.layer,this.$domNodes,"videoContainer")},e.prototype.updatePlayMask=function(t){this.$domNodes.videoPlayIcon&&(this.$domNodes.videoPlayIcon.style.cssText=Xt({width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),top:"".concat(t.top,"px"),left:"".concat(t.left,"px"),opacity:"1"}))},e.prototype.hidePlayMask=function(){this.$domNodes.videoPlayIcon&&(this.$domNodes.videoPlayIcon.style.opacity="0")},e.prototype.toggleMute=function(t){t?(ie(this.$domNodes.mute,"volume"),oe(this.$domNodes.mute,"mute")):(ie(this.$domNodes.mute,"mute"),oe(this.$domNodes.mute,"volume"))},e.prototype.setContainerCursor=function(t){ee(this.$domNodes.container,"cursor",t)},e.prototype.adjustAd=function(t){t&&(this.$domNodes.closeBtn&&ee(this.$domNodes.closeBtn,"top",t.top),this.$domNodes.detailBox&&ee(this.$domNodes.detailBox,"bottom",t.bottom))},e.prototype.updateImgSrc=function(t){this.$domNodes.pictureImg&&(t?this.$domNodes.pictureImg.src=t:te(this.$domNodes.pictureImg,"src"))},e.prototype.updatePostSrc=function(t){ee(this.$domNodes.videoContainer,"background-image","url('".concat(t,"')"))},e.prototype.reset=function(){this.updateImgSrc(),this.setVideoVisible(!1),this.setContainerVisible(!1),this.setPictureVisible(!1),this.setPlayIconVisible(!1),this.setMuteVisible(!0),this.$domNodes.videoPlayIcon.style.cssText="",this.$domNodes.videoContainer.style.cssText=""},e.prototype.getDomEvents=function(){var t=this;return[this.forwardDomEvent(this.$domNodes.closeBtn,Xi.CLOSE_CLICK,Lo.CLICK,!0),this.forwardDomEvent(this.$domNodes.pictureImg,Xi.IMAGE_LOAD,Lo.LOAD),this.forwardDomEvent(this.$domNodes.videoPlayIcon,Xi.PLAY_CLICK,Lo.CLICK,!0),this.forwardDomEvent(this.$domNodes.mute,Xi.MUTE_CLICK,Lo.CLICK,!0),{el:this.$domNodes.detailBtn,eventName:Lo.CLICK,listener:function(e){e.stopPropagation(),t.emit(Xi.DETAIL_BTN_CLICK,pt.AD_ACTION_BUTTON)}},{el:this.$domNodes.container,eventName:Lo.CLICK,listener:function(e){e.stopPropagation(),t.emit(Xi.LINK_AREA_CLICK,pt.AD_VIEW_AREA)}}]},e.prototype.getTemplate=function(){var t=this.roleMap,e="txp_full_screen_pause";return'\n      <txpdiv data-role="'.concat(t.container,'" class="').concat(e,' txp_none">\n          \n          <txpdiv data-role="').concat(t.videoContainer,'" class="').concat(e,'-material-container txp_none"></txpdiv>\n          \n          <txpdiv data-role="').concat(t.pictureContainer,'" class="').concat(e,'-material-container txp_none">\n            <img data-role="').concat(t.pictureImg,'" style="width:100%; height:100%;" alt="" />\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.adFlag,'" class="').concat(e,'-ad-flag">\n            <span>广告</span>\n          </txpdiv>\n          \n          <txpdiv data-role="').concat(t.closeBtn,'" class="').concat(e,'-close">\n            关闭广告\n          </txpdiv>\n          <txpdiv data-role="').concat(t.detailBox,'" class="').concat(e,'-detail-box">\n            \n            <txpdiv data-role="').concat(t.detailBtn,'" class="').concat(e,'-detail">\n              <img\n                src="').concat(ui,'"\n                alt=""\n              />\n              <txpidv data-role="').concat(t.detailBtnText,'"></txpidv>\n            </txpdiv>\n            \n            <txpdiv data-role="').concat(t.mute,'" class="').concat(e,'-mute mute">\n              <svg viewBox="0 0 20 20" class="txp_svg_volume txp_svg_symbol" fill="currentColor">\n                <path\n                  d="M16.714 15.593l-.01-.01a1 1 0 0 1-1.705-.708c0-.287.124-.542.317-.724C16.354 13.073 17 11.614 17 10s-.645-3.072-1.682-4.151A.993.993 0 0 1 15 5.125a1 1 0 0 1 1-1c.3 0 .561.139.744.348l.017-.016A7.969 7.969 0 0 1 19 10c0 2.178-.874 4.15-2.286 5.593zm-3.999 3.122a.956.956 0 0 1-.688.28c-.009 0-.018.005-.027.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h3.818l5.432-3.643A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v16c0 .009-.005.017-.005.026a.959.959 0 0 1-.28.689zM6.75 6.643A.984.984 0 0 1 6 7H3v6h3c.304 0 .567.143.75.357l4.25 2.85V3.792L6.75 6.643z"\n                ></path>\n              </svg>\n              <svg viewBox="0 0 20 20" class="txp_svg_volume_mute txp_svg_symbol" fill="currentColor">\n                <path\n                  d="M16.394 12.566A5.88 5.88 0 0 0 17 10a5.97 5.97 0 0 0-1.682-4.151.993.993 0 0 1-.318-.724 1 1 0 0 1 1-1c.3 0 .561.139.745.348l.016-.016A7.969 7.969 0 0 1 19 10a7.934 7.934 0 0 1-1.116 4.055l-1.49-1.489zM11 3.792L8.978 5.149 7.62 3.792l3.63-2.435A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v7.171l-2-2V3.792zm7.864 14.072a.999.999 0 0 1-1.414 0L2.136 2.55a1 1 0 1 1 1.415-1.415L18.864 16.45a1 1 0 0 1 0 1.414zM3.171 5l2 2H3v6h3c.304 0 .567.143.75.357l4.25 2.85v-3.379l2 2V18c0 .009-.005.017-.005.027a.955.955 0 0 1-.967.968c-.01 0-.019.005-.028.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.171z"\n                ></path>\n              </svg>\n            </txpdiv>\n          </txpdiv>\n      </txpdiv>\n      \n      <txpdiv data-role="').concat(this.roleMap.videoPlayIcon,'" class="').concat(e,'-play-icon txp_none">\n        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <g clip-path="url(#clip0_404_5155)">\n            <path d="M23.5 11.402C25.5 12.5567 25.5 15.4435 23.5 16.5982L8 25.5471C6 26.7018 3.5 25.2584 3.5 22.949L3.5 5.05115C3.5 2.74175 6 1.29838 8 2.45308L23.5 11.402Z" fill="white"/>\n          </g>\n          <defs>\n            <clipPath id="clip0_404_5155">\n              <rect width="28" height="28" fill="white"/>\n            </clipPath>\n          </defs>\n        </svg>\n      </txpdiv>\n    ')},e}(ko),ir=function(t){function e(e){var o=t.call(this,e)||this;return o.pauseUI=o.adCore.getUIInterface(or),o.resizeRunning=!1,o.needRunResize=!1,o.handleCloseClick=function(){o.data.closeBtnClicked=!0,o.pauseUI.hidePlayMask(),o.adCore.outerApi.resetVideoContainer().then((function(){o.stop()}))},o.handlePlayClick=function(){o.pauseUI.hidePlayMask(),o.adCore.outerApi.resetVideoContainer(!0).then((function(){o.stop()}))},o.handleLinkAreaClick=function(t){void 0===t&&(t=pt.AD_VIEW_AREA),o.adInfo.data.poster.enable_fullscreen_click&&o.handleDetailClick(t)},o.handleDetailClick=function(t){void 0===t&&(t=pt.AD_ACTION_BUTTON),o.adInfo.clickable&&o.openLinkAndReport(o.adInfo,{actionType:t,playTime:o.data.showTime?Date.now()-o.data.showTime:-1})},o.handleToggleMiniPlayer=function(t){o.pauseUI.setPlayIconVisible(!t.data.isOpened)},o.data.startTime=Date.now(),o.adCore.outerApi.on(B.TOGGLE_MINI_PLAYER,o.handleToggleMiniPlayer),o}return r(e,t),e.prototype.stop=function(){var e=this;this.state!==ge.END&&(this.pauseUI.hidePlayMask(),this.adCore.outerApi.resetVideoContainer().catch((function(){})).finally((function(){e.hide(),t.prototype.stop.call(e),e.vrReportEnded(),e.destroy()})))},e.prototype.destroy=function(){this.adCore.outerApi.off(B.TOGGLE_MINI_PLAYER,this.handleToggleMiniPlayer),t.prototype.destroy.call(this)},e.prototype.setAdSmallWindow=function(t){t&&this.resize()},e.prototype.resize=function(){if(!this.resizeRunning)return this.resizeVideoContainer(),void(this.needRunResize=!1);this.needRunResize=!0},e.prototype.adjustFullPauseUI=function(t){if(t){var e="".concat(t.top||16,"px"),o="".concat(t.bottom||16,"px");this.pauseUI.adjustAd({top:e,bottom:o})}},e.prototype.resizeVideoContainer=function(){var t=this;this.resizeRunning=!0,this.pauseUI.hidePlayMask();var e=this.adInfo.data.poster.split_control_info;this.adCore.outerApi.resizeVideoContainer(e.split_type,e.scale_ratio).then((function(e){t.adCore.outerApi.isMimiPlayer||t.pauseUI.updatePlayMask(e)})).catch((function(t){})).finally((function(){t.resizeRunning=!1,t.needRunResize&&t.resize()}))},e.prototype.updateUI=function(){var t=this.adInfo.data.poster.action_button,e=t.base.action_title.first_title||"了解详情";this.pauseUI.updateActionButton({btnText:e,textColor:t.base.text_color,bgColor:t.base.bg_color}),this.pauseUI.toggleMute(this.adInfo.muted),this.pauseUI.setContainerCursor(this.adInfo.data.poster.enable_fullscreen_click?"pointer":"auto"),this.pauseUI.setPlayIconVisible(!0)},e.prototype.shrinkPlayer=function(){var t=this,e=this.adInfo.data.poster.split_control_info;this.resizeRunning=!0,this.adCore.outerApi.shrinkVideoContainer(e.split_type,e.scale_ratio).then((function(e){t.adCore.outerApi.isMimiPlayer||t.pauseUI.updatePlayMask(e)})).catch((function(){t.stop()})).finally((function(){t.resizeRunning=!1,t.needRunResize&&t.resize()}))},e.prototype.bindUIEvent=function(){this.pauseUI.on(Xi.CLOSE_CLICK,this.handleCloseClick),this.pauseUI.on(Xi.PLAY_CLICK,this.handlePlayClick),this.pauseUI.on(Xi.LINK_AREA_CLICK,this.handleLinkAreaClick),this.pauseUI.on(Xi.DETAIL_BTN_CLICK,this.handleDetailClick)},e.prototype.unbindUIEvent=function(){this.pauseUI.off(Xi.CLOSE_CLICK,this.handleCloseClick),this.pauseUI.off(Xi.PLAY_CLICK,this.handlePlayClick),this.pauseUI.off(Xi.LINK_AREA_CLICK,this.handleLinkAreaClick),this.pauseUI.off(Xi.DETAIL_BTN_CLICK,this.handleDetailClick)},e.prototype.getVrExtraData=function(){return{order_type:this.adInfo.orderType,is_active_scan:this.adInfo.isScanActive}},e.prototype.reportExposure=function(){this.adInfo.reporter.reportExposure(),Ht.reportExposure(this.adInfo,!0,this.getVrExtraData())},e.prototype.vrReportEnded=function(){var t;if(!this.data.isFirstClose&&this.data.showTime){var e=this.data;Ht.reportEnded(this.order,{load_time:this.getLoadTime(),close_time:e.closeBtnClicked&&this.data.showTime?Date.now()-this.data.showTime:-1,ad_playtime:e.startTime?Date.now()-e.startTime:-1,error_code:this.data.errorCode,first_view:null!==(t=e.showTime)&&void 0!==t?t:-1},this.getVrExtraData()),e.isFirstClose=!0}},e}(xe),rr=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleImageLoad=function(){var e;t.data.endLoadTime=Date.now(),null===(e=t.capturePlayerPromise)||void 0===e||e.then((function(){var e;t.shrinkPlayer(),t.pauseUI.setContainerVisible(!0),t.show(),t.reportExposure(),t.canplayHandler(),t.loadCompleteHandle({adType:t.adType,adInfo:t.adInfo,index:t.adInfo.orderIdx,loadingTime:t.getLoadTime(),materialUrl:null===(e=t.adInfo.imageMaterial)||void 0===e?void 0:e.url,materialType:t.adInfo.materialType})})).catch((function(){t.stop()}))},t.handleImageError=function(){var e;t.data.endLoadTime=Date.now(),t.data.errorCode=S.LOAD_FAIL,t.loadCompleteHandle({adType:t.adType,adInfo:t.adInfo,index:t.adInfo.orderIdx,hasError:"1",detailErrorCode:S.LOAD_FAIL,loadingTime:t.getLoadTime(),materialUrl:null===(e=t.adInfo.imageMaterial)||void 0===e?void 0:e.url,materialType:t.adInfo.materialType}),t.stop()},t}return r(o,e),o.prototype.load=function(){var o,i=this;this.adInfo&&(null===(o=this.adInfo.imageMaterial)||void 0===o?void 0:o.url)?(e.prototype.load.call(this),this.bindUIEvent(),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adType:this.order.adType,adInfo:this.adInfo}),this.imageMaterial=new ri({url:this.adInfo.imageMaterial.url}),this.imageMaterial.load().then((function(t){i.pauseUI.updateImgSrc(t.src),i.pauseUI.setPictureVisible(!0),i.updateUI()})).catch((function(){i.handleImageError()})),this.capturePlayerPromise=this.adCore.outerApi.capturePlayer()):this.stop()},o.prototype.destroy=function(){this.pauseUI.updateImgSrc(),this.unbindUIEvent(),this.pauseUI.reset(),e.prototype.destroy.call(this)},o.prototype.updateUI=function(){e.prototype.updateUI.call(this),this.pauseUI.setMuteVisible(!1)},o.prototype.bindUIEvent=function(){e.prototype.bindUIEvent.call(this),this.pauseUI.on(Xi.IMAGE_LOAD,this.handleImageLoad)},o.prototype.unbindUIEvent=function(){e.prototype.unbindUIEvent.call(this),this.pauseUI.off(Xi.IMAGE_LOAD,this.handleImageLoad)},o.prototype.getLoadTime=function(){var t,e;return null!==(e=null===(t=this.imageMaterial)||void 0===t?void 0:t.loadTime)&&void 0!==e?e:-1},o}(ir),nr=function(){function e(e){var o=this;this.logger=V("PausePlayer"),this.data={volume:0},this.handleVideoLoadStart=function(e){var i=e.adVideoInfo;i.loadStartTime||(i.loadStartTime=Date.now(),o.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adInfo:o.adInfo,adType:o.adInfo.adType,index:o.adInfo.orderIdx}))},this.handleVideoProcess=function(e){var i=e.adVideoInfo,r=i.loadedPercent;i.buffered,i.duration;if(r){var n=Date.now();r&&i.loadStartTime&&(i.speed=i.fileSize/(n-i.loadStartTime)*1e3);var a=r>.99;o.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_PROGRESS,{adInfo:o.adInfo,adType:o.adInfo.adType,speed:i.speed,loadedPercent:i.loadedPercent,buffered:i.buffered}),a&&!o.data.endLoadTime&&o.handleVideoLoadComplete(i)}},this.handleVideoLoadComplete=function(t,e){var i,r,n;t.loadCompleteTime||(t.loadCompleteTime=Date.now(),o.data.endLoadTime=t.loadCompleteTime),t.loadStartTime&&(t.loadTime=t.loadCompleteTime-t.loadStartTime),t.hasReportLoadComplete||(t.hasReportLoadComplete=!0,o.adInterface.loadCompleteHandle({adInfo:o.adInfo,adType:o.adInfo.adType,index:0,hasError:e?"1":void 0,loadingTime:t.loadTime,errorCode:e?null==t?void 0:t.errorCode:void 0,hasTryBackupUrls:!!(null==t?void 0:t.backupUrlData),materialVid:null===(i=o.adInfo.videoMaterial)||void 0===i?void 0:i.vid,materialUrl:null===(r=o.adInfo.videoMaterial)||void 0===r?void 0:r.url,materialDuration:null===(n=o.adInfo.videoMaterial)||void 0===n?void 0:n.duration,materialType:ot.VIDEO}))},this.handleVideoCanplay=function(){o.adInterface.canplayHandler(),o.adPlayer.play(),o.adPlayer.currentVideoElement.loop=!0},this.handleVideoPlaying=function(t){var e,i,r=t.adVideoInfo;null===(i=(e=o.options).onVideoPlayStart)||void 0===i||i.call(e,r)},this.handleVideoTimeupdate=function(t){var e,i,r=t.adVideoInfo;null===(i=(e=o.options).onTimeUpdate)||void 0===i||i.call(e,o.adPlayer.currentTime,o.adInfo.videoMaterial.duration);var n=r.loadedPercent;n&&(n>.99&&!o.data.endLoadTime&&o.handleVideoLoadComplete(r))},this.handleVideoPause=function(){o.adPlayer.play()},this.handleVideoError=function(t){var e=t.adVideoInfo;t.canTryBackup?e.backupUrlData?o.adPlayer.playUrl(e):o.adPlayer.tryPlayBackupUrl(e):(o.handleVideoLoadComplete(e,!0),o.adInterface.stop())},this.options=e,this.initPlayer(),this.bindVideoEvent()}return Object.defineProperty(e.prototype,"loadTime",{get:function(){return this.data.startLoadTime&&this.data.endLoadTime?this.data.endLoadTime-this.data.startLoadTime:-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adPlayer",{get:function(){return this.adCore.pausePlayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adCore",{get:function(){return this.options.adCore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adInfo",{get:function(){return this.options.adInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adInterface",{get:function(){return this.options.adInterface},enumerable:!1,configurable:!0}),e.prototype.load=function(e){var o=e.url,i=ye("fmt",o=e.enable_crt_cached?qo(e.vid,o,this.adInfo.adType):o)||nt.SHD;this.data.urlConfig={uid:"".concat(i,"-").concat(e.vid),url:o,duration:e.duration,vid:e.vid,fileSize:e.file_size,orderId:this.adInfo.orderId},this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAYER_SESSION_START,{adType:this.adInfo.adType,vids:[this.data.urlConfig.vid]}),this.adPlayer.load([this.data.urlConfig]),this.data.startLoadTime=Date.now()},e.prototype.setVolume=function(t){this.data.volume=Math.min(1,Math.max(0,void 0===t?1:t)),this.adPlayer.volume=this.data.muted?0:this.data.volume},e.prototype.toggleMute=function(){var t,e;this.data.muted=!this.data.muted,this.adPlayer.volume=this.data.muted?0:this.data.volume,null===(e=(t=this.options).toggleMute)||void 0===e||e.call(t,this.data.muted)},e.prototype.retry=function(){this.data.urlConfig&&(this.adPlayer.load([this.data.urlConfig]),this.adPlayer.play())},e.prototype.destroy=function(){this.adPlayer.removeAllListeners(),this.unbindVideoEvent(),this.adPlayer.stop(),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_PLAYER_SESSION_END,{adType:this.adInfo.adType,vids:[this.data.urlConfig.vid]}),this.adPlayer.destroy()},e.prototype.initPlayer=function(){var t,e,o,i,r;if(null===(t=this.adPlayer)||void 0===t||t.stop(),null===(e=this.adPlayer)||void 0===e||e.removeAllListeners(),this.options.container){null===(o=this.adPlayer)||void 0===o||o.createPlayer(this.options.container);var n=this.adCore.outerApi.videoPlayData.volume;this.data.volume=Math.min(1,Math.max(0,void 0===n?1:n)),this.data.muted=this.adInfo.muted,this.adPlayer.volume=this.data.muted?0:this.data.volume,null===(r=(i=this.options).toggleMute)||void 0===r||r.call(i,this.data.muted)}else this.logger.error("'videoContainer' dom 节点不存在")},e.prototype.bindVideoEvent=function(){this.adPlayer.on(m.PROGRESS,this.handleVideoProcess),this.adPlayer.on(m.LOADSTART,this.handleVideoLoadStart),this.adPlayer.on(m.CANPLAY,this.handleVideoCanplay),this.adPlayer.on(m.PLAYING,this.handleVideoPlaying),this.adPlayer.on(m.PAUSE,this.handleVideoPause),this.adPlayer.on(m.TIMEUPDATE,this.handleVideoTimeupdate),this.adPlayer.on(m.ERROR,this.handleVideoError)},e.prototype.unbindVideoEvent=function(){this.adPlayer.off(m.PROGRESS,this.handleVideoProcess),this.adPlayer.off(m.LOADSTART,this.handleVideoLoadStart),this.adPlayer.off(m.CANPLAY,this.handleVideoCanplay),this.adPlayer.off(m.PLAYING,this.handleVideoPlaying),this.adPlayer.off(m.PAUSE,this.handleVideoPause),this.adPlayer.off(m.TIMEUPDATE,this.handleVideoTimeupdate),this.adPlayer.off(m.ERROR,this.handleVideoError)},e}(),ar=function(e){function o(t){var o=e.call(this,t)||this;return o.handleMuteClick=function(){o.pausePlayer.toggleMute()},o.pausePlayer=new nr({container:o.pauseUI.$domNodes.videoContainer,adInterface:o,adInfo:o.adInfo,adCore:o.adCore,toggleMute:function(t){o.pauseUI.toggleMute(t)},onVideoPlayStart:function(t){o.showAd(),e.prototype.play.call(o),e.prototype.show.call(o),t.hasReportView||(o.logger.log("可见曝光"),t.hasReportView=!0,o.reportExposure())}}),o}return r(o,e),Object.defineProperty(o.prototype,"adPlayer",{get:function(){return this.adCore.pausePlayer},enumerable:!1,configurable:!0}),o.prototype.load=function(){var o;this.adInfo&&(null===(o=this.adInfo.videoMaterial)||void 0===o?void 0:o.url)?(e.prototype.load.call(this),this.bindUIEvent(),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adType:this.order.adType,adInfo:this.adInfo}),this.loadPoster(),this.pausePlayer.load(this.adInfo.videoMaterial),this.capturePlayerPromise=this.adCore.outerApi.capturePlayer()):this.stop()},o.prototype.setVolume=function(t){this.pausePlayer.setVolume(t)},o.prototype.destroy=function(){this.data.hasDestroy||(this.unbindUIEvent(),this.pausePlayer.destroy(),this.pauseUI.adjustDomNodes(),this.pauseUI.reset(),e.prototype.destroy.call(this))},o.prototype.bindUIEvent=function(){e.prototype.bindUIEvent.call(this),this.pauseUI.on(Xi.MUTE_CLICK,this.handleMuteClick)},o.prototype.unbindUIEvent=function(){e.prototype.unbindUIEvent.call(this),this.pauseUI.off(Xi.MUTE_CLICK,this.handleMuteClick)},o.prototype.getLoadTime=function(){return this.pausePlayer.loadTime},o.prototype.loadPoster=function(){var t,e=this,o=null===(t=this.adInfo.data.cover_picture)||void 0===t?void 0:t.url;o&&(this.imageMaterial=new ri({url:o}),this.imageMaterial.load().then((function(t){e.pauseUI.updatePostSrc(t.src),e.showAd()})).catch((function(){})))},o.prototype.showAd=function(){var t=this;!this.data.fullScreenIsShow&&this.capturePlayerPromise&&this.capturePlayerPromise.then((function(){t.data.fullScreenIsShow=!0,t.pauseUI.setVideoVisible(!0),t.updateUI(),t.shrinkPlayer(),t.pauseUI.setContainerVisible(!0),t.show()})).catch((function(){t.stop()}))},o}(ir),sr=function(e){function o(t){var o=e.call(this,t)||this;o.handleRetryClick=function(){o.pauseUI.setLoadingVisible(!0),o.pauseUI.setErrorTipsVisible(!1),o.createTransparentPlayer()},o.handlePlayerCanplay=function(){var t;o.canplayHandler(),null===(t=o.transparentPlayer)||void 0===t||t.play()},o.handlePlayerLoaded=function(){var t,e,i;o.data.endLoadTime=Date.now(),o.loadCompleteHandle({adInfo:o.adInfo,adType:o.adType,index:0,loadingTime:o.data.endLoadTime-o.data.startLoadTime,materialVid:null===(t=o.adInfo.videoMaterial)||void 0===t?void 0:t.vid,materialUrl:null===(e=o.adInfo.videoMaterial)||void 0===e?void 0:e.url,materialDuration:null===(i=o.adInfo.videoMaterial)||void 0===i?void 0:i.duration,materialType:ot.VIDEO})},o.handlePlayerPlay=function(){o.data.startPlayTime||(o.data.startPlayTime=Date.now()),o.pauseUI.setLoadingVisible(!1),o.data.isReportView||(o.data.isReportView=!0,o.reportExposure(),o.adInfo.reporter.reportPlay({playType:Te.AUTO_PLAYING}))},o.handlePlayerEnded=function(){o.data.playTimes+=1,1===o.data.playTimes&&o.adInfo.reporter.reportPlay({playType:Te.END,timeOffset:o.adInfo.videoMaterial.duration})},o.handlePlayerError=function(){var t,e,i;o.pauseUI.setErrorTipsVisible(!0),o.pauseUI.setMaskVisible(!1),o.adInfo.reporter.reportPlay({failReason:Te.FAIL_PLAY}),o.data.endLoadTime||(o.data.endLoadTime=Date.now(),o.data.errorCode=S.LOAD_FAIL,o.loadCompleteHandle({adInfo:o.adInfo,adType:o.adType,index:0,hasError:"1",loadingTime:o.data.endLoadTime-o.data.startLoadTime,materialVid:null===(t=o.adInfo.videoMaterial)||void 0===t?void 0:t.vid,materialUrl:null===(e=o.adInfo.videoMaterial)||void 0===e?void 0:e.url,materialDuration:null===(i=o.adInfo.videoMaterial)||void 0===i?void 0:i.duration,detailErrorCode:o.data.errorCode,materialType:ot.VIDEO}))},o.pauseUI.reset(),o.pauseUI.setPauseContentVisible(!0);var i=o.adCore.outerApi.getPlayerSize();return o.playerSize={width:i.playerWidth||i.playerOWidth,height:i.playerHeight||i.playerOHeight},o.init(),o}return r(o,e),o.prototype.load=function(){this.adInfo&&this.data.videoUrl&&-1!==this.data.videoUrl.indexOf("http")?(e.prototype.load.call(this),this.pauseUI.setTransparentVideoMaterialVisible(!0),this.show(),this.adCore.adEventEmitter.emit(t.AD_EVENT.AD_LOAD_START,{adType:this.adType,adInfo:this.adInfo}),this.data.startLoadTime=Date.now(),this.createTransparentPlayer()):this.stop()},o.prototype.show=function(){e.prototype.show.call(this),this.pauseUI.setContainerVisible(!0)},o.prototype.hide=function(){e.prototype.hide.call(this),this.pauseUI.setContainerVisible(!1)},o.prototype.stop=function(){this.state!==ge.END&&(this.reportPlayNotEnd(),e.prototype.stop.call(this))},o.prototype.destroy=function(){var t;this.data.hasDestroy||(this.unbindPlayEvent(),this.unbindUIEvent(),null===(t=this.transparentPlayer)||void 0===t||t.destroy(),this.pauseUI.reset(),e.prototype.destroy.call(this))},o.prototype.resize=function(t){!t||t.left&&t.top||this.setContainerSize()},o.prototype.initData=function(){return n(n({},e.prototype.initData.call(this)),{playTimes:0})},o.prototype.bindUIEvent=function(){this.pauseUI.on(Ki.PAUSE_CLOSE_CLICK,this.handleCloseClick),this.pauseUI.on(Ki.PAUSE_RETRY_CLICK,this.handleRetryClick),this.pauseUI.on(Ki.PAUSE_LINK_AREA_CLICK,this.handleDetailClick)},o.prototype.unbindUIEvent=function(){this.pauseUI.off(Ki.PAUSE_CLOSE_CLICK,this.handleCloseClick),this.pauseUI.off(Ki.PAUSE_RETRY_CLICK,this.handleRetryClick),this.pauseUI.off(Ki.PAUSE_LINK_AREA_CLICK,this.handleDetailClick)},o.prototype.init=function(){var t;if(this.pauseUI.updateTransparentVideoContainer(),this.pauseUI.updateVideoPost(null===(t=this.adInfo.data.cover_picture)||void 0===t?void 0:t.url),this.pauseUI.setLoadingVisible(!0),this.pauseUI.setMaskVisible(!0),this.pauseUI.updateClickable(this.adInfo.clickable),this.adInfo.videoMaterial){var e=this.adInfo.videoMaterial,o=e.url,i=e.enable_crt_cached,r=e.vid;this.data.videoUrl=i?qo(r,o,this.adInfo.adType):o}this.pauseUI.setErrorTipsVisible(!1),this.setContainerSize(),this.bindUIEvent()},o.prototype.setContainerSize=function(){var t,e=this.playerSize.width,o=932,i=522;e<1390&&(o=716,i=402),e<1180&&(o=550,i=309),e<880&&(o=424,i=238),this.containerSize={width:o,height:i},ee(this.pauseUI.$domNodes.pauseContent,{width:o,height:i}),null===(t=this.transparentPlayer)||void 0===t||t.resize(o,i)},o.prototype.createTransparentPlayer=function(){var t;null===(t=this.transparentPlayer)||void 0===t||t.destroy(),this.transparentPlayer=new Ro({url:this.data.videoUrl,width:this.containerSize.width,height:this.containerSize.height,container:this.pauseUI.$domNodes.pauseVideoMaterialContainer,loop:!0,useCache:!0,autoplay:!0,fps:20,loopInterval:0}),this.transparentPlayer.on(No.CANPLAY,this.handlePlayerCanplay),this.transparentPlayer.on(No.PLAY,this.handlePlayerPlay),this.transparentPlayer.on(No.ENDED,this.handlePlayerEnded),this.transparentPlayer.on(No.ERROR,this.handlePlayerError),this.transparentPlayer.on(No.LOADED,this.handlePlayerLoaded)},o.prototype.unbindPlayEvent=function(){var t,e,o,i,r;null===(t=this.transparentPlayer)||void 0===t||t.off(No.CANPLAY,this.handlePlayerCanplay),null===(e=this.transparentPlayer)||void 0===e||e.off(No.PLAY,this.handlePlayerPlay),null===(o=this.transparentPlayer)||void 0===o||o.off(No.ENDED,this.handlePlayerEnded),null===(i=this.transparentPlayer)||void 0===i||i.off(No.ERROR,this.handlePlayerError),null===(r=this.transparentPlayer)||void 0===r||r.off(No.LOADED,this.handlePlayerLoaded)},o.prototype.reportPlayNotEnd=function(){if(this.adInfo.videoMaterial&&this.data.startPlayTime){var t=Date.now()-this.data.startPlayTime;t<this.adInfo.videoMaterial.duration&&this.adInfo.reporter.reportPlay({playType:Te.NOT_END,timeOffset:t})}},o}(ji),dr=function(t){function e(e){var o,i=this;(i=t.call(this,e)||this).logger=V("VideoPauseAd"),i.handleMuteClick=function(){i.pausePlayer.toggleMute()},i.handleRetryClick=function(){i.pauseUI.setLoadingVisible(!0),i.pauseUI.setErrorTipsVisible(!1),i.pausePlayer.retry()},i.pauseUI.setPauseContentVisible(!0),i.updateUI();var r=null===(o=i.adInfo.data.cover_picture)||void 0===o?void 0:o.url;return i.pauseUI.updateVideoPost(r),i.bindUIEvent(),i.pauseUI.updateProgress("0%"),i.pauseUI.setLoadingVisible(!0),i.pausePlayer=new nr({container:i.pauseUI.$domNodes.pauseVideoMaterialContainer,adInterface:i,adInfo:i.adInfo,adCore:i.adCore,toggleMute:function(t){i.pauseUI.toggleMute(t)},onVideoPlayStart:function(e){i.pauseUI.setLoadingVisible(!1),i.pauseUI.setMaskVisible(!0),t.prototype.play.call(i),e.hasReportView||(i.logger.log("可见曝光"),e.hasReportView=!0,i.reportExposure())},onTimeUpdate:function(t,e){i.pauseUI.updateProgress("".concat(t/e*100,"%"))}}),i.bindVideoUIEvent(),i}return r(e,t),e.prototype.getLoadTime=function(){return this.pausePlayer.loadTime},e.prototype.load=function(){var e;if(this.adInfo&&(null===(e=this.adInfo.videoMaterial)||void 0===e?void 0:e.url)){var o=this.adInfo.videoMaterial,i=o.url,r=ye("fmt",i=o.enable_crt_cached?qo(o.vid,i,this.adInfo.adType):i)||nt.SHD;this.data.urlConfig={uid:"".concat(r,"-").concat(o.vid),url:i,duration:o.duration,vid:o.vid,fileSize:o.file_size,orderId:this.adInfo.orderId},t.prototype.load.call(this),this.pauseUI.setVideoMaterialVisible(!0),this.show(),this.canplayHandler(),this.pausePlayer.load(this.adInfo.videoMaterial)}else this.stop()},e.prototype.show=function(){t.prototype.show.call(this),this.pauseUI.setContainerVisible(!0),this.pauseUI.resizeMaterialContainerSize(this.adInfo.isActive)},e.prototype.hide=function(){t.prototype.hide.call(this),this.pauseUI.setContainerVisible(!1)},e.prototype.resize=function(t){!t||t.left&&t.top||this.pauseUI.resizeMaterialContainerSize(this.adInfo.isActive,t.width)},e.prototype.setVolume=function(t){this.pausePlayer.setVolume(t)},e.prototype.destroy=function(){this.data.hasDestroy||(this.pauseUI.updateProgress("0%"),this.unbindUIEvent(),this.unbindVideoUIEvent(),this.pausePlayer.destroy(),this.pauseUI.adjustDomNodes(),this.pauseUI.reset(),t.prototype.destroy.call(this))},e.prototype.bindVideoUIEvent=function(){this.pauseUI.on(Ki.PAUSE_MUTE_CLICK,this.handleMuteClick),this.pauseUI.on(Ki.PAUSE_RETRY_CLICK,this.handleRetryClick)},e.prototype.unbindVideoUIEvent=function(){this.pauseUI.off(Ki.PAUSE_MUTE_CLICK,this.handleMuteClick),this.pauseUI.off(Ki.PAUSE_RETRY_CLICK,this.handleRetryClick)},e}(ji),lr=((er={})[Ve.UNKNOWN]=Ji,er[Ve.EMPTY]=Ji,er[Ve.CONTRACT_PICTURE]=Ji,er[Ve.TRANSPARENT_VIDEO]=sr,er[Ve.ACTIVE_VIDEO]=dr,er[Ve.CONTRACT_VIDEO]=dr,er[Ve.ACTIVE_PICTURE]=Qi,er[Ve.FULL_SCREEN_PICTURE]=rr,er[Ve.FULL_SCREEN_VIDEO]=ar,er);function pr(t){var e,o,i=null!==(e=t.order.orders[0])&&void 0!==e?e:t.order.empty[0];if(!i)return new Ji(t);i.isEmpty&&i.reporter.reportExposure();var r=i.orderType;return new(null!==(o=lr[r])&&void 0!==o?o:Ji)(t)}pr.isMultiple=!1,pr.isPointAd=!1;var cr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadPauseAd=function(t){return s(e,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return"user-click"!==t.data.pauseType?[2]:[4,this.adCore.outerApi.requestProxyHttp(W.PAUSE)];case 1:if(e.sent(),"pause"!==this.adCore.outerApi.videoPlayData.state)return[2];e.label=2;case 2:return e.trys.push([2,4,,5]),[4,this.adCore.loadAd(J.PAUSE)];case 3:return e.sent(),[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}}))}))},e.stopPauseAd=function(){e.adCore.stopAd(J.PAUSE)},e}return r(e,t),e.prototype.startWatch=function(){this.adCore.outerApi.on(B.VIDEO_PAUSE,this.loadPauseAd),this.adCore.outerApi.on(B.VIDEO_PLAYING,this.stopPauseAd)},e.prototype.endWatch=function(){this.adCore.outerApi.off(B.VIDEO_PAUSE,this.loadPauseAd),this.adCore.outerApi.off(B.VIDEO_PLAYING,this.stopPauseAd)},e}(To),ur=function(e){function o(t){var o=e.call(this,t)||this;return o.logger=V("PreAd"),o.handleAdStop=function(t){t.adType===J.PRE&&t.isAllAdEnd&&t.rfid&&(o.logger.log("设置 rfid",t.rfid),window.localStorage.setItem(ro,t.rfid||""))},o.bindAdEnd(),o}return r(o,e),o.prototype.beforeInit=function(t){this.order=this.transformOrder(t.order)},o.prototype.destroy=function(){this.unbindAdEnd(),e.prototype.destroy.call(this)},o.prototype.transformOrder=function(t){var e,o,i=n(n({},t),{orders:l([],t.orders,!0),empty:l([],t.empty,!0)}),r=this.adCore.getAdOrder(J.BROADCAST);return r&&((e=i.orders).push.apply(e,r.orders),(o=i.empty).push.apply(o,r.empty)),i},o.prototype.bindAdEnd=function(){this.adCore.adEventEmitter.on(t.AD_EVENT.AD_STOP,this.handleAdStop)},o.prototype.unbindAdEnd=function(){this.adCore.adEventEmitter.off(t.AD_EVENT.AD_STOP,this.handleAdStop)},o.isPointAd=!1,o}(Li),hr=Mo("progress-preview"),fr={layer:hr("layer"),img:hr("img"),adFlag:hr("flag")},vr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$domNodes2={},e.roleMap=fr,e}return r(e,t),e.prototype.setLayerVisible=function(t){this.setDomVisible(this.$domNodes.layer,t),this.setDomVisible(this.$domNodes2.layer,t)},e.prototype.update=function(t){var e=t.url,o=t.hasAdFlag;this.$domNodes.img&&(this.$domNodes.img.src=e),this.$domNodes2.img&&(this.$domNodes2.img.src=e),o?(ne(this.$domNodes.adFlag),ne(this.$domNodes2.adFlag)):(re(this.$domNodes.adFlag),re(this.$domNodes2.adFlag))},e.prototype.mount=function(){if(!this.$domNodes.layer){var t=document.createElement("div");t.className="txp_tooltip_preview_ad txp_none",t.dataset.role=this.roleMap.layer;var e=document.createElement("div");e.className="txp_tooltip_preview_ad txp_none",e.dataset.role=this.roleMap.layer,this.outerApi.prependEmbedAd(J.PROGRESS_PREVIEW,t,e),this.$domNodes.layer=t,this.$domNodes2.layer=e}this.appendDom(this.$domNodes.layer,this.$domNodes),this.appendDom(this.$domNodes2.layer,this.$domNodes2)},e.prototype.getTemplate=function(){return'\n      <img data-role="'.concat(this.roleMap.img,'" />\n      <txpdiv data-role="').concat(this.roleMap.adFlag,'" class="txp_ad_mark txp_none">广告</txpdiv>\n    ')},e}(ai),mr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=e.adCore.getUIInterface(vr),e}return r(e,t),e.prototype.loadMaterialSuccess=function(){this.ui.update({url:this.adInfo.material.url,hasAdFlag:this.adInfo.hasFlag}),this.show()},e}(ni);function yr(t,e){var o=t,i=null,r=!0;function n(){var t=this,n=arguments;if(r)return o.apply(t,n),void(r=!1);i||(i=window.setTimeout((function(){i&&(clearTimeout(i),i=null),o.apply(t,n)}),e))}return n.cancel=function(){i&&(clearTimeout(i),i=null)},n}for(var _r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasLoadAd=!1,e.throttleReportAd=yr((function(){e.adCore.reportAd(J.PROGRESS_PREVIEW)}),2e3),e.loadProgressPreviewAd=function(){return s(e,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return this.adCore.outerApi.requestProxyHttp?this.hasLoadAd?[3,5]:(this.hasLoadAd=!0,[4,this.adCore.outerApi.requestProxyHttp(W.PROGRESS_PREVIEW)]):[2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.adCore.loadAd(J.PROGRESS_PREVIEW)];case 3:return t.sent(),[3,5];case 4:return t.sent(),[3,5];case 5:return this.throttleReportAd(),[2]}}))}))},e}return r(e,t),e.prototype.startWatch=function(){this.adCore.outerApi.on(B.HOVER_PROGRESS,this.loadProgressPreviewAd)},e.prototype.endWatch=function(){this.adCore.outerApi.off(B.HOVER_PROGRESS,this.loadProgressPreviewAd)},e.prototype.reset=function(){this.hasLoadAd=!1,this.throttleReportAd.cancel()},e}(To),gr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasCallPlay=!1,e.logger=V("TailAd"),e.canplayDetectTimer=null,e}return r(e,t),e.prototype.play=function(){t.prototype.play.call(this),this.hasCallPlay=!0},e.prototype.destroy=function(){this.canplayDetectTimer&&(clearTimeout(this.canplayDetectTimer),this.canplayDetectTimer=null),t.prototype.destroy.call(this)},e.isPointAd=!1,e}(Li),Ar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.play=function(){var e=this.adCore.outerApi.videoPlayData.playtime;this.adInfo.reporter.setVideoPlaytime(1e3*e),this.state!==ge.PLAYING&&this.state!==ge.PAUSED&&(this.adInfo&&this.adInfo.point?(t.prototype.play.call(this),this.show(),this.adInfo.reporter.reportExposure(),Ht.reportExposure(this.adInfo)):this.stop())},e.prototype.stop=function(){var e;t.prototype.stop.call(this),Ht.reportEnded(this.order,{first_view:null!==(e=this.data.showTime)&&void 0!==e?e:-1,ad_playtime:-1}),this.destroy()},e.isPointAd=!0,e.isMultiple=!0,e}(xe),Er=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.timeupdate=function(t){var e=this;this.adCore.outerApi.isSoloPlayingPhls||this.adCore.orderCtrl.getPoints(J.VIDEO_IN).forEach((function(o){var i=e.adCore.orderCtrl.getPointOrderFromPoint(J.VIDEO_IN,o);i&&0!==i.orders.length&&(t>=o.begin&&t<=o.end?i.pointStatus===Ge.INIT?(i.orders.forEach((function(t){e.adCore.loadAdOrder(n(n({},i),{orders:[t]})).catch((function(t){}))})),i.pointStatus=Ge.PLAYING):i.pointStatus===Ge.PLAYING&&i.orders.forEach((function(t){e.adCore.playAd(J.VIDEO_IN,t.orderId)})):i.pointStatus!==Ge.INIT&&(i.pointStatus=Ge.INIT,i.orders.forEach((function(t){e.adCore.stopAd(J.VIDEO_IN,t.orderId)}))))}))},e}(xo),Ir=Mo("video-resolution"),Cr={layer:Ir("layer"),img:Ir("img"),title:Ir("title"),adFlag:Ir("flag")},Tr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleMap=Cr,e}return r(e,t),e.prototype.update=function(t){var e=t.url,o=t.hasAdFlag,i=t.title;this.$domNodes.img&&(this.$domNodes.img.src=e),de(this.$domNodes.title,i),o?ne(this.$domNodes.adFlag):re(this.$domNodes.adFlag)},e.prototype.mount=function(){if(!this.$domNodes.layer){var t=document.createElement("div");t.className="txp_menuitem txp_menuitem_ad txp_none",t.dataset.role=this.roleMap.layer,this.outerApi.prependEmbedAd(J.VIDEO_RESOLUTION,t),this.$domNodes.layer=t}this.appendDom(this.$domNodes.layer)},e.prototype.getTemplate=function(){return'\n      <img data-role="'.concat(this.roleMap.img,'" class="txp_definition_ad" style="width: 40px; height: 23px;" />\n      <txpdiv data-role="').concat(this.roleMap.title,'" class="txp_definition_ad_text"></txpdiv>\n      <txpdiv data-role="').concat(this.roleMap.adFlag,'" class="txp_ad_mark txp_none">广告</txpdiv>\n    ')},e}(ai),xr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=e.adCore.getUIInterface(Tr),e}return r(e,t),e.prototype.loadMaterialSuccess=function(){var t=this.adInfo.data;this.ui.update({title:t.poster.title,url:this.adInfo.material.url,hasAdFlag:this.adInfo.hasFlag}),this.show()},e}(ni),br=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasLoadAd=!1,e.throttleReportAd=yr((function(){e.adCore.reportAd(J.VIDEO_RESOLUTION)}),2e3),e.loadVideoResolutionAd=function(){return s(e,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return this.adCore.outerApi.requestProxyHttp?this.hasLoadAd?[3,5]:(this.hasLoadAd=!0,[4,this.adCore.outerApi.requestProxyHttp(W.VIDEO_RESOLUTION)]):[2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.adCore.loadAd(J.VIDEO_RESOLUTION)];case 3:return t.sent(),[3,5];case 4:return t.sent(),[3,5];case 5:return this.throttleReportAd(),[2]}}))}))},e}return r(e,t),e.prototype.startWatch=function(){this.adCore.outerApi.on(B.SHOW_LEVELS,this.loadVideoResolutionAd)},e.prototype.endWatch=function(){this.adCore.outerApi.off(B.SHOW_LEVELS,this.loadVideoResolutionAd)},e.prototype.reset=function(){this.hasLoadAd=!1,this.throttleReportAd.cancel()},e}(To),Dr=1,Pr=2,Nr=4,wr=8,Sr={L:1,M:0,Q:3,H:2},Or=0,Lr=1,Vr=2,Rr=3,Mr=4,kr=5,Ur=6,Br=7,zr={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;zr.getBCHDigit(e)-zr.getBCHDigit(zr.G15)>=0;)e^=zr.G15<<zr.getBCHDigit(e)-zr.getBCHDigit(zr.G15);return(t<<10|e)^zr.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;zr.getBCHDigit(e)-zr.getBCHDigit(zr.G18)>=0;)e^=zr.G18<<zr.getBCHDigit(e)-zr.getBCHDigit(zr.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!==t;)e+=1,t>>>=1;return e},getPatternPosition:function(t){return zr.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,o){switch(t){case Or:return(e+o)%2==0;case Lr:return e%2==0;case Vr:return o%3==0;case Rr:return(e+o)%3==0;case Mr:return(Math.floor(e/2)+Math.floor(o/3))%2==0;case kr:return e*o%2+e*o%3==0;case Ur:return(e*o%2+e*o%3)%2==0;case Br:return(e*o%3+(e+o)%2)%2==0;default:throw new Error("bad maskPattern:".concat(t))}},getErrorCorrectPolynomial:function(t){for(var e=new qr([1],0),o=0;o<t;o++)e=e.multiply(new qr([1,Gr.gexp(o)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case Dr:return 10;case Pr:return 9;case Nr:case wr:return 8;default:throw new Error("mode:".concat(t))}else if(e<27)switch(t){case Dr:return 12;case Pr:return 11;case Nr:return 16;case wr:return 10;default:throw new Error("mode:".concat(t))}else{if(!(e<41))throw new Error("type:".concat(e));switch(t){case Dr:return 14;case Pr:return 13;case Nr:return 16;case wr:return 12;default:throw new Error("mode:".concat(t))}}},getLostPoint:function(t){for(var e=t.getModuleCount(),o=0,i=0;i<e;i++)for(var r=0;r<e;r++){for(var n=0,a=t.isDark(i,r),s=-1;s<=1;s++)if(!(i+s<0||e<=i+s))for(var d=-1;d<=1;d++)r+d<0||e<=r+d||0===s&&0===d||a===t.isDark(i+s,r+d)&&(n+=1);n>5&&(o+=3+n-5)}for(i=0;i<e-1;i++)for(r=0;r<e-1;r++){var l=0;t.isDark(i,r)&&(l+=1),t.isDark(i+1,r)&&(l+=1),t.isDark(i,r+1)&&(l+=1),t.isDark(i+1,r+1)&&(l+=1),0!==l&&4!==l||(o+=3)}for(i=0;i<e;i++)for(r=0;r<e-6;r++)t.isDark(i,r)&&!t.isDark(i,r+1)&&t.isDark(i,r+2)&&t.isDark(i,r+3)&&t.isDark(i,r+4)&&!t.isDark(i,r+5)&&t.isDark(i,r+6)&&(o+=40);for(r=0;r<e;r++)for(i=0;i<e-6;i++)t.isDark(i,r)&&!t.isDark(i+1,r)&&t.isDark(i+2,r)&&t.isDark(i+3,r)&&t.isDark(i+4,r)&&!t.isDark(i+5,r)&&t.isDark(i+6,r)&&(o+=40);var p=0;for(r=0;r<e;r++)for(i=0;i<e;i++)t.isDark(i,r)&&(p+=1);return o+=10*(Math.abs(100*p/e/e-50)/5)}},Hr=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],$r=function(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var o=e.toString().match(/android ([0-9]\.[0-9])/i);(null==o?void 0:o[1])&&(t=parseFloat(o[1]))}return t},Kr=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},Gr={glog:function(t){if(t<1)throw new Error("glog(".concat(t,")"));return Gr.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return Gr.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},Yr=0;Yr<8;Yr++)Gr.EXP_TABLE[Yr]=1<<Yr;for(Yr=8;Yr<256;Yr++)Gr.EXP_TABLE[Yr]=Gr.EXP_TABLE[Yr-4]^Gr.EXP_TABLE[Yr-5]^Gr.EXP_TABLE[Yr-6]^Gr.EXP_TABLE[Yr-8];for(Yr=0;Yr<255;Yr++)Gr.LOG_TABLE[Gr.EXP_TABLE[Yr]]=Yr;var Fr=function(){function t(t){this.mode=Nr,this.data=t,this.parsedData=[];for(var e=0,o=this.data.length;e<o;e++){var i=[],r=this.data.charCodeAt(e);r>65536?(i[0]=240|(1835008&r)>>>18,i[1]=128|(258048&r)>>>12,i[2]=128|(4032&r)>>>6,i[3]=128|63&r):r>2048?(i[0]=224|(61440&r)>>>12,i[1]=128|(4032&r)>>>6,i[2]=128|63&r):r>128?(i[0]=192|(1984&r)>>>6,i[1]=128|63&r):i[0]=r,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!==this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return t.prototype.getLength=function(){return this.parsedData.length},t.prototype.write=function(t){for(var e=0,o=this.parsedData.length;e<o;e++)t.put(this.parsedData[e],8)},t}(),Wr=function(){function t(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return t.createData=function(e,o,i){for(var r=jr.getRSBlocks(e,o),n=new Qr,a=0;a<i.length;a++){var s=i[a];n.put(s.mode,4),n.put(s.getLength(),zr.getLengthInBits(s.mode,e)),s.write(n)}var d=0;for(a=0;a<r.length;a++)d+=r[a].dataCount;if(n.getLengthInBits()>8*d)throw new Error("code length overflow. (".concat(n.getLengthInBits(),">").concat(8*d,")"));for(n.getLengthInBits()+4<=8*d&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*d||(n.put(t.PAD0,8),n.getLengthInBits()>=8*d));)n.put(t.PAD1,8);return t.createBytes(n,r)},t.createBytes=function(t,e){for(var o=0,i=0,r=0,n=new Array(e.length),a=new Array(e.length),s=0;s<e.length;s++){var d=e[s].dataCount,l=e[s].totalCount-d;i=Math.max(i,d),r=Math.max(r,l),n[s]=new Array(d);for(var p=0;p<n[s].length;p++)n[s][p]=255&t.buffer[p+o];o+=d;var c=zr.getErrorCorrectPolynomial(l),u=new qr(n[s],c.getLength()-1).mod(c);a[s]=new Array(c.getLength()-1);for(p=0;p<a[s].length;p++){var h=p+u.getLength()-a[s].length;a[s][p]=h>=0?u.get(h):0}}var f=0;for(p=0;p<e.length;p++)f+=e[p].totalCount;var v=new Array(f),m=0;for(p=0;p<i;p++)for(s=0;s<e.length;s++)p<n[s].length&&(v[m++]=n[s][p]);for(p=0;p<r;p++)for(s=0;s<e.length;s++)p<a[s].length&&(v[m++]=a[s][p]);return v},t.prototype.addData=function(t){var e=new Fr(t);this.dataList.push(e),this.dataCache=null},t.prototype.isDark=function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error("".concat(t).concat(e));return this.modules[t][e]},t.prototype.getModuleCount=function(){return this.moduleCount},t.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},t.prototype.makeImpl=function(e,o){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[i][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,o),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,o)},t.prototype.setupPositionProbePattern=function(t,e){for(var o=-1;o<=7;o++)if(!(t+o<=-1||this.moduleCount<=t+o))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(this.modules[t+o][e+i]=0<=o&&o<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==o||6==o)||2<=o&&o<=4&&2<=i&&i<=4)},t.prototype.getBestMaskPattern=function(){for(var t=0,e=0,o=0;o<8;o++){this.makeImpl(!0,o);var i=zr.getLostPoint(this);(0==o||t>i)&&(t=i,e=o)}return e},t.prototype.createMovieClip=function(t,e,o){var i=t.createEmptyMovieClip(e,o);this.make();for(var r=0;r<this.modules.length;r++)for(var n=1*r,a=0;a<this.modules[r].length;a++){var s=1*a;this.modules[r][a]&&(i.beginFill(0,100),i.moveTo(s,n),i.lineTo(s+1,n),i.lineTo(s+1,n+1),i.lineTo(s,n+1),i.endFill())}return i},t.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},t.prototype.setupPositionAdjustPattern=function(){for(var t=zr.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var o=0;o<t.length;o++){var i=t[e],r=t[o];if(null==this.modules[i][r])for(var n=-2;n<=2;n++)for(var a=-2;a<=2;a++)this.modules[i+n][r+a]=-2==n||2==n||-2==a||2==a||0==n&&0==a}},t.prototype.setupTypeNumber=function(t){for(var e=zr.getBCHTypeNumber(this.typeNumber),o=0;o<18;o++){var i=!t&&1==(e>>o&1);this.modules[Math.floor(o/3)][o%3+this.moduleCount-8-3]=i}for(o=0;o<18;o++){i=!t&&1==(e>>o&1);this.modules[o%3+this.moduleCount-8-3][Math.floor(o/3)]=i}},t.prototype.setupTypeInfo=function(t,e){for(var o=this.errorCorrectLevel<<3|e,i=zr.getBCHTypeInfo(o),r=0;r<15;r++){var n=!t&&1==(i>>r&1);r<6?this.modules[r][8]=n:r<8?this.modules[r+1][8]=n:this.modules[this.moduleCount-15+r][8]=n}for(r=0;r<15;r++){n=!t&&1==(i>>r&1);r<8?this.modules[8][this.moduleCount-r-1]=n:r<9?this.modules[8][15-r-1+1]=n:this.modules[8][15-r-1]=n}this.modules[this.moduleCount-8][8]=!t},t.prototype.mapData=function(t,e){for(var o=-1,i=this.moduleCount-1,r=7,n=0,a=this.moduleCount-1;a>0;a-=2)for(6===a&&(a-=1);;){for(var s=0;s<2;s++)if(null==this.modules[i][a-s]){var d=!1;n<t.length&&(d=1==(t[n]>>>r&1)),zr.getMask(e,i,a-s)&&(d=!d),this.modules[i][a-s]=d,-1===(r-=1)&&(n+=1,r=7)}if((i+=o)<0||this.moduleCount<=i){i-=o,o=-o;break}}},t.PAD0=236,t.PAD1=17,t}(),qr=function(){function t(t,e){if(void 0===t.length)throw new Error("".concat(t.length,"/").concat(e));for(var o=0;o<t.length&&0===t[o];)o+=1;this.num=new Array(t.length-o+e);for(var i=0;i<t.length-o;i++)this.num[i]=t[i+o]}return t.prototype.get=function(t){return this.num[t]},t.prototype.getLength=function(){return this.num.length},t.prototype.multiply=function(e){for(var o=new Array(this.getLength()+e.getLength()-1),i=0;i<this.getLength();i++)for(var r=0;r<e.getLength();r++)o[i+r]^=Gr.gexp(Gr.glog(this.get(i))+Gr.glog(e.get(r)));return new t(o,0)},t.prototype.mod=function(e){if(this.getLength()-e.getLength()<0)return this;for(var o=Gr.glog(this.get(0))-Gr.glog(e.get(0)),i=new Array(this.getLength()),r=0;r<this.getLength();r++)i[r]=this.get(r);for(r=0;r<e.getLength();r++)i[r]^=Gr.gexp(Gr.glog(e.get(r))+o);return new t(i,0).mod(e)},t}(),jr=function(){function t(t,e){this.totalCount=t,this.dataCount=e}return t.getRSBlocks=function(e,o){var i=t.getRsBlockTable(e,o);if(void 0===i)throw new Error("bad rs block @ typeNumber:".concat(e,"/errorCorrectLevel:").concat(o));for(var r=i.length/3,n=[],a=0;a<r;a++)for(var s=i[3*a+0],d=i[3*a+1],l=i[3*a+2],p=0;p<s;p++)n.push(new t(d,l));return n},t.getRsBlockTable=function(e,o){switch(o){case Sr.L:return t.RS_BLOCK_TABLE[4*(e-1)+0];case Sr.M:return t.RS_BLOCK_TABLE[4*(e-1)+1];case Sr.Q:return t.RS_BLOCK_TABLE[4*(e-1)+2];case Sr.H:return t.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},t.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t}(),Qr=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var o=0;o<e;o++)this.putBit(1==(t>>>e-o-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length+=1},t}(),Jr=function(){function t(t,e){this._el=t,this._htOption=e}return t.prototype.draw=function(t){for(var e=this._htOption,o=this._el,i=t.getModuleCount(),r=Math.floor(e.width/i),n=Math.floor(e.height/i),a=['<table style="border:0;border-collapse:collapse;">'],s=0;s<i;s++){a.push("<tr>");for(var d=0;d<i;d++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'.concat(r,"px;height:").concat(n,"px;background-color:").concat(t.isDark(s,d)?e.colorDark:e.colorLight,';"></td>'));a.push("</tr>")}a.push("</table>"),o.innerHTML=a.join("");var l=o.childNodes[0],p=(e.width-l.offsetWidth)/2,c=(e.height-l.offsetHeight)/2;p>0&&c>0&&(l.style.margin="".concat(c,"px ").concat(p,"px"))},t.prototype.clear=function(){this._el.innerHTML=""},t}(),Xr=function(){function t(t,e){if(this._bIsPainted=!1,this._android=$r(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null,this._android&&this._android<=2.1){var o=1/window.devicePixelRatio,i=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,e,r,n,a,s,d,l,p){if("nodeName"in t&&/img/i.test(t.nodeName))for(var c=arguments.length-1;c>=1;c--)arguments[c]=arguments[c]*o;else void 0===l&&(arguments[1]*=o,arguments[2]*=o,arguments[3]*=o,arguments[4]*=o);i.apply(this,arguments)}}}return t.prototype.draw=function(t){var e=this._elImage,o=this._oContext,i=this._htOption,r=t.getModuleCount(),n=i.width/r,a=i.height/r,s=Math.round(n),d=Math.round(a);e.style.display="none",this.clear();for(var l=0;l<r;l++)for(var p=0;p<r;p++){var c=t.isDark(l,p),u=p*n,h=l*a;o.strokeStyle=c?i.colorDark:i.colorLight,o.lineWidth=1,o.fillStyle=c?i.colorDark:i.colorLight,o.fillRect(u,h,n,a),o.strokeRect(Math.floor(u)+.5,Math.floor(h)+.5,s,d),o.strokeRect(Math.ceil(u)-.5,Math.ceil(h)-.5,s,d)}this._bIsPainted=!0},t.prototype.makeImage=function(){this._bIsPainted&&this.safeSetDataURI(this.onMakeImage)},t.prototype.onMakeImage=function(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"},t.prototype.isPainted=function(){return this._bIsPainted},t.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},t.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},t.prototype.safeSetDataURI=function(t,e){var o=this;if(this._fFail=e,this._fSuccess=t,null===this._bSupportDataURI){var i=document.createElement("img"),r=function(){o._bSupportDataURI=!1,o._fFail&&o._fFail.call(o)};return i.onabort=r,i.onerror=r,i.onload=function(){o._bSupportDataURI=!0,o._fSuccess&&o._fSuccess.call(o)},void(i.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===this._bSupportDataURI&&this._fSuccess?this._fSuccess.call(this):!1===this._bSupportDataURI&&this._fFail&&this._fFail.call(this)},t}(),Zr="undefined"!=typeof CanvasRenderingContext2D?Xr:Jr,tn=function(){function t(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:Sr.H},"string"==typeof e&&(e={text:e}),e)for(var o in e)this._htOption[o]=e[o];"string"==typeof t&&(t=document.getElementById(t)),this._android=$r(),this._el=t,this._oQRCode=null,this._oDrawing=new Zr(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}return t.prototype.makeCode=function(t){this._oQRCode=new Wr(function(t,e){for(var o=1,i=Kr(t),r=0,n=Hr.length;r<=n;r++){var a=0;switch(e){case Sr.L:a=Hr[r][0];break;case Sr.M:a=Hr[r][1];break;case Sr.Q:a=Hr[r][2];break;case Sr.H:a=Hr[r][3]}if(i<=a)break;o+=1}if(o>Hr.length)throw new Error("Too long data");return o}(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},t.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},t.prototype.clear=function(){this._oDrawing.clear()},t.CorrectLevel=Sr,t}(),en=function(t){function o(e,o){var i=t.call(this,e,o)||this;return i.registerAd(),i.bindPlayerEvent(),i}return r(o,t),o.prototype.setPhlsPlayType=function(t){void 0===t&&(t=1),this.adCore.outerApi.setOptions({phlsPlayType:t})},o.prototype.startSoloPlayPhls=function(t){this.adCore.outerApi.setOptions({isSoloPlayingPhls:!0,soloPlayPhlsTimeOffset:1e3*t})},o.prototype.endSoloPlayPhls=function(){this.adCore.outerApi.setOptions({isSoloPlayingPhls:!1,soloPlayPhlsTimeOffset:void 0})},o.prototype.createAdCore=function(){var t,o,i,r,n,a,s,d,l,p,c,u=new $({plugin:this,isMobile:!1,flowId:null!==(o=null===(t=this.config.playerData)||void 0===t?void 0:t.playerFlowid)&&void 0!==o?o:this.player.getCommonKv(e.COMMON_DATA_KEY.flowid),guId:null!==(r=null===(i=this.config.playerData)||void 0===i?void 0:i.playerGuid)&&void 0!==r?r:this.player.getCommonKv(e.COMMON_DATA_KEY.guid),isOpenCache:this.config.opencache,isUseDemuxKernel:this.config.isUseDemuxKernel}),h=new $({plugin:this,isMobile:!1,flowId:null!==(a=null===(n=this.config.playerData)||void 0===n?void 0:n.playerFlowid)&&void 0!==a?a:this.player.getCommonKv(e.COMMON_DATA_KEY.flowid),guId:null!==(d=null===(s=this.config.playerData)||void 0===s?void 0:s.playerGuid)&&void 0!==d?d:this.player.getCommonKv(e.COMMON_DATA_KEY.guid),isOpenCache:this.config.opencache,isUseDemuxKernel:this.config.isUseDemuxKernel,kernelOptions:{createVideoNodeWhenLoad:!1,videoElements:void 0,originKernelConfig:{maxVideoNodeCount:1}}}),f=new ue({container:this.player.container,playerData:null!==(l=this.config.playerData)&&void 0!==l?l:{playerPf:je.IN},playerMethod:null!==(p=this.config.playerMethod)&&void 0!==p?p:{},plugin:this,showCloseButton:"function"==typeof(null===(c=this.config.playerMethod)||void 0===c?void 0:c.showOpenVIPGuide),isMobile:!1,forbidLinkJump:this.config.forbidLinkJump,renderQrCode:function(t,e,o){var i=t;return i.innerHTML="",new tn(i,{text:e,width:o,height:o})},requestProxyHttp:this.config.requestProxyHttp,phlsPlayType:0});return new Ze({postPlayer:u,pausePlayer:h,outerApi:f})},o.prototype.transformToH5Type=function(t){var e;return null!==(e=io.toAdTypeV(t))&&void 0!==e?e:"".concat(t)},o.prototype.registerAd=function(){this.adCore.registerAd(J.PRE,{adClass:ur}),this.adCore.registerAd(J.LOADING,{adClass:pi,adWatcher:new ci}),this.adCore.registerAd(J.TAIL,{adClass:gr}),this.adCore.registerAd(J.PROGRESS_PREVIEW,{adClass:mr,adWatcher:new _r}),this.adCore.registerAd(J.VIDEO_RESOLUTION,{adClass:xr,adWatcher:new br}),this.adCore.registerAd(J.PAUSE,{adClass:pr,adWatcher:new cr}),this.adCore.adPlugin.setWatcher(new wo),this.adCore.registerAd(J.CORNER,{adClass:jo,adWatcher:new Qo}),this.adCore.registerAd(J.ANCHOR_EMPTY,{adClass:Co,adWatcher:new bo}),this.adCore.registerAd(J.MID,{adClass:Bi,adWatcher:new zi}),this.adCore.registerAd(J.VIDEO_IN,{adClass:Ar,adWatcher:new Er}),this.adCore.registerAd(J.HLS_MID,{adClass:ti,adWatcher:new ei}),this.adCore.registerAd(J.NON_STANDARD,{adClass:Hi,adWatcher:new $i})},o.pluginName="ad-player-web",o}(Io);return e.H5Player.registerPlugin(e.AdPluginName,en),window.CreativePlayerPlugin=en,t.VideoAdWebPlugin=en,t.adTypeTransformer=io,Object.defineProperty(t,"__esModule",{value:!0}),t}({},ThumbPlayerH5,ThumbPlayerCore);
