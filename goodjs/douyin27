"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([[9344],{30758:function(e,n,t){t.d(n,{vA:function(){return A},yw:function(){return N},ZP:function(){return L}});var r=t(65902),a=t(30906),i=t(32781),s=t(85792),o=t.n(s),u=t(53864),c=t(79705),l=t.n(c),d=t(59676),_=t(91287),v=t(50799),f=t(36177),p=t(97876),E=t(72603),h=t(25902),I=t(9191),m=t(2015),g="DhEeeU3v",S="J8_Uj1cS",T="EDG47eF_",C="nFZmQGu5",M="TVkq94nr",O=t(31554),R=(0,d.default)((function(){return Promise.all([t.e(9344),t.e(2003),t.e(9955),t.e(2880),t.e(9083),t.e(3237),t.e(6780)]).then(t.bind(t,87653))}),{ssr:!1}),y=(0,d.default)((function(){return t.e(5269).then(t.bind(t,65734))}),{ssr:!1}),k=(0,d.default)((function(){return t.e(5269).then(t.bind(t,25944))}),{ssr:!1}),N={Video:"share_video",Live:"share_live",User:"share_user",Vs:"share_vs",Comment:"share_comment"},A={VideoPage:"VideoPage",UserPage:"UserPage"},L=function(e){var n,t=e.className,s=e.awemeInfo,c=e.hidden,d=e.awemelogPb,L=e.isLogin,b=e.handleClose,w=e.toast,P=e.reportExtraParams,U=void 0===P?{}:P,G=e.shareShowMethod,D=e.onMouseEnter,Z=e.onMouseLeave,x=(e.handleClickCopy,e.handleChooseFriend),F=e.handleShareToFriend,H=e.handleShareSuccess,V=e.shareType,Y=void 0===V?N.Video:V,W=e.uid,j=e.userInfo,B=e.commentInfo,K=e.inanyPage,J=void 0===K?A.VideoPage:K,X=e.loginDispatch,$=e.hideShareContent,Q=e.shareeListHeight,q=e.width,z=e.onFriendSearching,ee=(0,u.useState)(!1),ne=(0,i.Z)(ee,2),te=ne[0],re=ne[1],ae=(0,u.useState)(!1),ie=(0,i.Z)(ae,2),se=ie[0],oe=ie[1],ue=(0,u.useState)(!1),ce=(0,i.Z)(ue,2),le=ce[0],de=ce[1],_e=(0,u.useState)(!1),ve=(0,i.Z)(_e,2),fe=ve[0],pe=ve[1],Ee=(0,u.useRef)(null),he=(0,u.useRef)(null),Ie=p,me=Ie.EVENT,ge=(0,u.useState)(!c),Se=(0,i.Z)(ge,2),Te=Se[0],Ce=Se[1],Me=(0,u.useRef)(!c),Oe=(0,u.useMemo)((function(){return!(se&&!le)&&c}),[c,se,le]);return(0,u.useEffect)((function(){c||(de(!1),(0,O.removeLoginPanel)())}),[c]),(0,u.useEffect)((function(){c||(Ce(!0),Ie.emit(me.videoStopPlayNext)),c&&Te&&Ie.emit(me.videoRemoveStopPlayNext),Me.current=!c}),[c]),(0,u.useEffect)((function(){return function(){Me.current&&Ie.emit(me.videoRemoveStopPlayNext)}}),[]),(0,u.useEffect)((function(){var e;if(!c)switch(Y){case N.Vs:case N.Video:m.Z.sendLog("shareMenuShow",(0,a.Z)({urlParamList:["previous_page"],author_id:null==s||null===(e=s.authorInfo)||void 0===e?void 0:e.uid,group_id:null==s?void 0:s.awemeId,enter_from:(0,E.mo)(),log_pb:d,is_full_screen:(0,h.r)()?"1":"0",tab_name:v.getTabName()||(0,I.Rs)("tab_name")||"",click_method:G,share_type:"video"},U));break;case N.User:m.Z.sendLog("shareMenuShow",{enter_from:(0,E.vM)(),share_type:"user",click_method:G});break;case N.Comment:m.Z.sendLog("shareMenuShow",{enter_from:(0,E.vM)(),share_type:"comment",click_method:G})}c||te||re(!0)}),[c,G]),(0,u.useEffect)((function(){var e,n=function(e){return e.stopPropagation()};return null===(e=Ee.current)||void 0===e||e.addEventListener("wheel",n),function(){var e;null===(e=Ee.current)||void 0===e||e.removeEventListener("wheel",n)}}),[]),(0,u.useEffect)((function(){o()((function(){var e;if(!c&&null!=he&&null!==(e=he.current)&&void 0!==e&&e.clientHeight){pe(he.current.clientHeight-61<204)}}),0)}),[c,se]),(0,u.useEffect)((function(){s&&(s.logPb=d)}),[s]),(0,u.useEffect)((function(){var e=function(e){var n,t;null!==(n=Ee.current)&&void 0!==n&&null!==(t=n.contains)&&void 0!==t&&t.call(n,e.target)||se||(null==b||b(),null==z||z(!1))};return document.addEventListener("click",e,!0),function(){document.removeEventListener("click",e,!0)}}),[se]),!1===(null==s||null===(n=s.status)||void 0===n?void 0:n.allowShare)?u.createElement("div",{ref:Ee,"data-e2e":s?"video-share-container":"user-share-container"},u.createElement("div",{className:l()(t,g,S,C,M),onMouseEnter:function(){return null==D?void 0:D()},onMouseLeave:function(){return null==Z?void 0:Z()},style:{display:Oe?"none":"flex"},"data-inuser":J===A.UserPage,ref:he},"\u8be5\u4f5c\u54c1\u5df2\u88ab\u9650\u5236\u5206\u4eab")):u.createElement("div",{ref:Ee,"data-e2e":s?"video-share-container":"user-share-container"},(null==s?void 0:s.awemeType)===f.ed.XgVideo&&u.createElement("div",{className:l()(t,g,S,T),onMouseEnter:function(){return null==D?void 0:D()},onMouseLeave:function(){return null==Z?void 0:Z()},style:{display:Oe?"none":"flex",width:324},"data-inuser":J===A.UserPage},(!c||te)&&u.createElement(_.SV,null,u.createElement("div",{style:{display:se||le?"none":"block",width:"100%"}},u.createElement(y,(0,r.Z)({},e,{shareType:Y})))),L&&(!c||se)&&((null==s?void 0:s.awemeType)!==f.ed.XgVideo||W)&&Y!==N.Vs&&u.createElement(R,{toast:w,close:function(){de(!0),oe(!1),null==b||b(),p.emit(p.EVENT.videoRemoveStopPlayNext)},awemeInfo:s,shareType:Y,shareUserInfo:j,shareCommentInfo:B,handleExpand:function(){return oe(!0)},handleCollapse:function(){oe(!1)},handleHasFriends:function(e){},handleChooseFriend:x,handleShareToFriend:F,handleShareSuccess:H,reportExtraParams:(0,a.Z)((0,a.Z)({},U),{},{from_xigua:(null==s?void 0:s.awemeType)===f.ed.XgVideo?1:0}),shareeListHeight:Q,onFriendSearching:z})),(null==s?void 0:s.awemeType)!==f.ed.XgVideo&&u.createElement("div",{className:l()(t,g,S,C),onMouseEnter:function(){return null==D?void 0:D()},onMouseLeave:function(){return null==Z?void 0:Z()},style:(0,a.Z)({display:Oe?"none":"flex"},q?{width:q}:{}),"data-inuser":J===A.UserPage,ref:he},(!c||se)&&((null==s?void 0:s.awemeType)!==f.ed.XgVideo||W)&&Y!==N.Vs&&(L?u.createElement(R,{toast:w,close:function(){de(!0),oe(!1),null==b||b(),p.emit(p.EVENT.videoRemoveStopPlayNext)},awemeInfo:s,shareType:Y,shareUserInfo:j,shareCommentInfo:B,handleExpand:function(){return oe(!0)},handleCollapse:function(){oe(!1)},handleHasFriends:function(e){},handleChooseFriend:x,handleShareToFriend:F,handleShareSuccess:H,reportExtraParams:(0,a.Z)((0,a.Z)({},U),{},{from_xigua:(null==s?void 0:s.awemeType)===f.ed.XgVideo?1:0}),shareeListHeight:Q,onFriendSearching:z}):u.createElement(k,{change:function(){null==X||X({type:"updateUserInfo"})}})),(!c||te)&&!$&&u.createElement(_.SV,null,u.createElement("div",{style:{display:se||le?"none":"block",width:"100%"}},u.createElement(y,(0,r.Z)({},e,{shareType:Y,isMiniQrCode:fe}))))))}},2015:function(e,n,t){t.d(n,{h:function(){return a}});var r=t(13795),a="web_code_link";n.Z=new r.hD({shareMenuShow:{eventName:"share_menu_show",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",is_full_screen:"0",tab_name:"",click_method:"",share_type:""}},shareVideo:{eventName:"share_video",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",type:"",is_full_screen:"0",click_method:"",tab_name:"",from_follow_list:"0",from_xigua:0,aweme_type:"",personal_relation:"",relation:"",show_type:""}},shareUser:{eventName:"share_user",params:{chat_type:"",type:"",author_id:"",personal_relation:"",relation:""}},clickFavoriteVideo:{eventName:"click_favorite_video",params:{click_from:"share_board",previous_page:"",author_id:"",group_id:"",log_pb:"",enter_from:"",is_full_screen:"0",click_method:""}},clickCancelFavoriteVideo:{eventName:"click_cancel_favorite_video",params:{click_from:"share_board",previous_page:"",author_id:"",group_id:"",log_pb:"",enter_from:"",is_full_screen:"0"}},favoriteVideo:{eventName:"favorite_video",params:{click_from:"share_board",previous_page:"",author_id:"",group_id:"",log_pb:"",enter_from:"",is_full_screen:"0",click_method:"",clarity:"",aweme_type:"",item_duration_ms:0}},favoriteVideoFailed:{eventName:"favorite_video_failed",params:{click_from:"share_board",err_code:1,previous_page:"",author_id:"",group_id:"",log_pb:"",enter_from:"",is_full_screen:"0"}},cancelFavoriteVideo:{eventName:"cancel_favorite_video",params:{click_from:"share_board",previous_page:"",author_id:"",group_id:"",log_pb:"",enter_from:"",is_full_screen:"0",click_method:"",item_duration_ms:0}},download:{eventName:"download",params:{enter_from:"",enter_from_merge:"",group_id:"",click_from:""}},unsupportDownloadShow:{eventName:"unsupport_download_show",params:{enter_from:"",enter_from_merge:"",group_id:""}}})},56912:function(e,n,t){t.d(n,{r9:function(){return o},S6:function(){return u},Nk:function(){return c},E9:function(){return l},sP:function(){return d},FO:function(){return _}});var r,a,i=t(65146),s=t(94234),o={LOVE:{key:"e:love",value:'{"emoji_data":{"icon_url":"https://p6.douyinpic.com/aweme-client-static-resource/single_msg_emoji_love_1588747335.png~tplv-obj.image","me_text":"","text":"\u2764\ufe0f"},"type":1}'}},u={RECALL_ROLE:"s:recall_role",RECALL_UID:"s:recall_uid"},c={KEY_CREATE_GROUP_TYPE:"a:s_group_create_type"},l=(r={},(0,i.Z)(r,s.Hv.REGULAR_USER,[s.DK.DELETE_CONVERSATION,s.DK.STICK_ON_TOP,s.DK.REPORT,s.DK.SET_MUTED,s.DK.BLOCK_USER]),(0,i.Z)(r,s.Hv.REGULAR_GROUP,[s.DK.DELETE_CONVERSATION,s.DK.STICK_ON_TOP,s.DK.REPORT,s.DK.SET_MUTED,s.DK.QUIT_GROUP]),(0,i.Z)(r,s.Hv.REGULAR_SELF,[s.DK.DELETE_CONVERSATION,s.DK.STICK_ON_TOP,s.DK.SET_MUTED]),(0,i.Z)(r,s.Hv.STARNGER_ITEM,[s.DK.DELETE_CONVERSATION,s.DK.REPORT,s.DK.BLOCK_USER]),(0,i.Z)(r,s.Hv.STRANGER_BOX,[s.DK.DELETE_CONVERSATION]),(0,i.Z)(r,s.Hv.REGULAR_DAREN_USER,[s.DK.DELETE_CONVERSATION,s.DK.STICK_ON_TOP,s.DK.ENABLE_PIGEON_SYNC,s.DK.REPORT,s.DK.SET_MUTED,s.DK.BLOCK_USER]),r),d=(a={},(0,i.Z)(a,s.DK.INIT_VALUE,""),(0,i.Z)(a,s.DK.DELETE_CONVERSATION,"\u5220\u9664\u540e\u5c06\u6e05\u9664\u672c\u4f1a\u8bdd\u7684\u804a\u5929\u8bb0\u5f55"),(0,i.Z)(a,s.DK.QUIT_GROUP,"\u786e\u8ba4\u9000\u51fa\u6b64\u7fa4\u804a?"),(0,i.Z)(a,s.DK.DISSOLVE_GROUP,"\u786e\u8ba4\u89e3\u6563\u6b64\u7fa4\u804a\uff0c\u6240\u6709\u6210\u5458\u5c06\u9000\u51fa\u7fa4\u804a\uff0c\u65e0\u6cd5\u63a5\u6536\u6d88\u606f"),a),_={CONVETSAION_DETAIL_CONENT:"conversaton-detail-content",CONVERSAION_DETAIL_INPUT_CONTENT:"conversaton-detail-input-content"}},94234:function(e,n,t){t.d(n,{$u:function(){return r},vW:function(){return a},rS:function(){return i},GB:function(){return s},dx:function(){return o},XJ:function(){return u},Lo:function(){return c},eY:function(){return l},eD:function(){return d},ql:function(){return _},dF:function(){return v},pt:function(){return f},IM:function(){return p},tQ:function(){return E},Hv:function(){return h},DK:function(){return I},de:function(){return m}});t(69071).m.MessageType;var r=function(e){return e[e.FollowRelationUnknown=-1]="FollowRelationUnknown",e[e.NoRelationStatus=0]="NoRelationStatus",e[e.FollowingStatus=1]="FollowingStatus",e[e.FollowEachOtherStatus=2]="FollowEachOtherStatus",e[e.FollowRequestStatus=4]="FollowRequestStatus",e}({}),a=function(e){return e[e.Created=0]="Created",e[e.Preparing=1]="Preparing",e[e.Inflight=2]="Inflight",e[e.Succeeded=3]="Succeeded",e[e.Received=4]="Received",e[e.Failed=-1]="Failed",e[e.Rejected=-2]="Rejected",e[e.SelfVisible=-3]="SelfVisible",e}({}),i=function(e){return e.light="light",e.dark="dark",e}({}),s=function(e){return e[e.MEMBER=0]="MEMBER",e[e.OWNER=1]="OWNER",e[e.ADMIN=2]="ADMIN",e}({}),o=function(e){return e[e.SCENE_TYPE_DEFAULT=0]="SCENE_TYPE_DEFAULT",e[e.SCENE_TYPE_REPLY_OTHER=1]="SCENE_TYPE_REPLY_OTHER",e[e.SCENE_TYPE_REPLY_SELF=2]="SCENE_TYPE_REPLY_SELF",e[e.SCENE_TYPE_AWEME_MENTION=3]="SCENE_TYPE_AWEME_MENTION",e[e.SCENE_TYPE_COMMENT_MENTION=4]="SCENE_TYPE_COMMENT_MENTION",e[e.SCENE_TYPE_SHARE=5]="SCENE_TYPE_SHARE",e[e.SCENE_TYPE_REPLY_INPUT=6]="SCENE_TYPE_REPLY_INPUT",e[e.SCENE_TYPE_NOTICE_REPLY_DIGG=7]="SCENE_TYPE_NOTICE_REPLY_DIGG",e[e.SCENE_TYPE_NOTICE_REPLY_COMMENT=8]="SCENE_TYPE_NOTICE_REPLY_COMMENT",e[e.SCENE_TYPE_NOTICE_REPLY_ATME=9]="SCENE_TYPE_NOTICE_REPLY_ATME",e}({}),u=function(e){return e[e.AVAILABLE=0]="AVAILABLE",e[e.NOT_EXTST=1]="NOT_EXTST",e[e.INVISIBLE=2]="INVISIBLE",e[e.RECALLED=3]="RECALLED",e[e.DELETED=4]="DELETED",e}({}),c=function(e){return e[e.AUDIT_NOT_PASS=1]="AUDIT_NOT_PASS",e[e.AUDIT_ONLY_SELF=2]="AUDIT_ONLY_SELF",e[e.REVIEWING=3]="REVIEWING",e[e.ONLY_FRIEND=4]="ONLY_FRIEND",e[e.ONLY_SELF=5]="ONLY_SELF",e[e.AUTHOR_SECRET=6]="AUTHOR_SECRET",e[e.DELETE=7]="DELETE",e[e.UNKNOWN=8]="UNKNOWN",e[e.STORY=9]="STORY",e[e.PART_SEE=10]="PART_SEE",e}({}),l=function(e){return e.CHAT_NOTIFY="chat_notif",e.CHAT_PANEL="chat_panel",e.PUSH="push",e.CLIENT_PUSH="client_push",e}({}),d=function(e){return e.GROUP="group",e.PRIVATE="private",e}({}),_=function(e){return e.SYSTEM="system",e.RECOMMAND="recommend",e.INTERACTION="interaction",e.FAVORITE="favorite",e}({}),v=function(e){return e.CHAT="chat",e.CHAT_HEAD="chat_head",e.CHAT_LIST="chat_list",e}({}),f=function(e){return e.CHAT="chat",e}({}),p=function(e){return e.ISME="1",e.NOISME="0",e}({}),E=function(e){return e[e.REGULAR=0]="REGULAR",e[e.STRANGER=1]="STRANGER",e}({}),h=function(e){return e[e.REGULAR=0]="REGULAR",e[e.REGULAR_USER=1]="REGULAR_USER",e[e.REGULAR_GROUP=2]="REGULAR_GROUP",e[e.REGULAR_SELF=3]="REGULAR_SELF",e[e.STARNGER_ITEM=4]="STARNGER_ITEM",e[e.STRANGER_BOX=5]="STRANGER_BOX",e[e.REGULAR_DAREN_USER=6]="REGULAR_DAREN_USER",e}({}),I=function(e){return e[e.INIT_VALUE=0]="INIT_VALUE",e[e.DELETE_CONVERSATION=1]="DELETE_CONVERSATION",e[e.STICK_ON_TOP=2]="STICK_ON_TOP",e[e.REPORT=3]="REPORT",e[e.SET_MUTED=4]="SET_MUTED",e[e.BLOCK_USER=5]="BLOCK_USER",e[e.QUIT_GROUP=6]="QUIT_GROUP",e[e.ENABLE_PIGEON_SYNC=7]="ENABLE_PIGEON_SYNC",e[e.DISSOLVE_GROUP=8]="DISSOLVE_GROUP",e}({}),m=function(e){return e[e.TEXT=1]="TEXT",e[e.PIC=2]="PIC",e[e.BIG_EMOJI=3]="BIG_EMOJI",e[e.VIDEO=4]="VIDEO",e}({})},33200:function(e,n,t){t.d(n,{pp:function(){return r},c6:function(){return a},ds:function(){return i}});t(69071).m.ConversationType;var r={NONE:-1,SYSTEM:1,ONLY_PICTURE:2,BIG_EMOJI:5,TEXT:7,SHARE_AWEME:8,LOAD_MORE:9,SHARE_PICTURE:12,COMMAND_SHARE:13,UPDATE_TIPS:14,SAY_HELLO:15,COMMENT:16,VOICE:17,SHARE_RANK_LIST:18,SHARE_CHALLENGE:19,SHARRE_POI:20,SHARE_LIVE:21,SHARE_MUSIC:22,SHARE_HARMONY_RANK_LIST:23,SHARE_MINI_APP:24,SHARE_USER:25,SHARE_WEB:26,STORY_PICTURE:27,SHARE_COUPON:28,STORY_VIDEO:30,AT_FRIEND_INTERACT:31,STORY_REPLY:32,COMMON_RED_ENVELOPE:35,VIDEO_RED_ENVELOPE:36,VIDEO_RED_ENVELOPE_NEW_YEAR:38,XPLAN_STICKER_EMOJI:51,XPLAN_HEART_EMOJI:52,SELF_STORY_REPLY:53,GROUP_INVITE_MESSAGE:58,SHARE_WEB_FROM_THIRD_MESSAGE:60,SHARE_GOOD:61,SHARE_GOOD_WINDOW:62,SHARE_POI_RANK:63,SHARE_GOOD_WINDOW_V3:64,ENTERPRISE_CUSTOMIZED_CARD:65,ENTERPRISE_CUSTOMIZED_CARD_WITH_FIXED_HEIGHT:66,ENTERPRISE_PRODUCT_LIST_CARD:67,E_PLATFORM_MESSAGE:70,SHARE_COMPILATION:71,SHARE_STICKER:72,CHAT_CALL:73,RED_PACKET:74,FRIEND_VIDEO_DM_COMMENT:75,SHARE_VS_LIVE:76,SHARE_PHOTOS:77,DIRECT_INVITE:78,GAME_INVITE:79,COUPON_FANS_GROUP:80,SUBSCRIBE_MESSAGE:81,GAME_INVITE_V2:82,REF_MSG:83,LIVE_ADVANCED_NOTICE_MESSAGE:84,URGE_LEAVE_MESSAGE:85,SHARE_PLAYLET:86,SHARE_DSP_MUSIC:87,ONE_CARD:88,ENTER_CHAT_FROM_VIDEO_COMMENT_LINK_MESSAGE:89,FEED_VOIP_SHARE_INVITE_MESSAGE:90,STORY_PICTURE_ONCE_VIEW:91,STORY_VIDEO_ONCE_VIEW:92,ENTERPRISE_CUSTOMER_SERVICE_CARD:93,COUPON_ENTERPRISE:94,CLOUD_GAME_INVITE:96,TEXT_PUSH_GUIDE:97,BULLET:110,SHARE_COMMENT:105,IM_ENCRYPT_VOICE:109,ENCRYPT_VOICE:501,SHARE_LOCATION:502,XRTC_CHATROOM_INVITE:507,X_GROUP_HOLDER:1e3,GROUP_NOTICE_MESSAGE:1001,GROUP_GREET_MESSAGE:1002,GROUP_ANNOUNCEMENT_MESSAGE:1004,PUSH_NOTIFICATION_GUIDE_MESSAGE:1005,SYSTEM_COMPAT:1006,DENGER_WARNING_TOP_MESSAGE:1007,GROUP_MASTER_SHARE_TOKEN:1008,DOUBLE_LIKE_GUIDE:1009,STRANGER_GREET_MESSAGE:1010,ACTIVE_FRIEND_GREET_MESSAGE:1011,MUTE_GUIDE_CARD:1012,FEED_LIVE_SHARE_INVITE_MESSAGE:1013,CHAT_CALL_D_ONLY:1017,SHARE_MT_LIVE:1021,ACTION_MESSAGE:2e3,WELCOME_WORDS_CARD:9990,FANS_GROUP_MILE_STONE_CARD:9992,CREATOR_FAN_GROUP_PASSWORD_INVITE:9995,CREATOR_FAN_GROUP_CARD_INVITE_MESSAGE:9996,BIRTHDAY_WISHES_MESSAGE:9997,LIVE_FANS_GROUP_OWNER_INVITE_CARD:9998},a={DEFAULT:0,LIVE:23,AWEME_SYSTEM:100,SYSTEM_USER_ACTIVE_STATUS:101,SYSTEM_CREATE_GROUP_REWARD:102,SYSTEM_GROUP_MEMBER_ONLINE:103,SYSTEM_GROUP_SILENT_NOTICE:106,SYSTEM_GROUP_UN_SILENT_NOTICE:107,SYSTEM_MEMBER_SILENT_NOTICE:108,SYSTEM_MEMBER_UN_SILENT_NOTICE:109,AWEME_COMMENT:200,AWEME_BIG_EMOJI:500,AWEME_EMOJI_SELF:501,AWEME_NET_SEARCH_GIF:502,AWEME_TYPE_GIPHY:503,AWEME_GREET_EMOJI:504,AWEME_LITE_MSG_EMOJI:505,AWEME_LITE_MSG_EMOJI_NEW:506,AWEME_INTERACTIVE_EMOJI:507,AWEME_STORE_EMOJI:508,AWEME_SINGLE_HEYCAN_EMOJI:510,AWEME_TEXT:700,AWEME_SAY_HELLO_TEXT:701,AWEME_TEXT_GREETING:702,TEXT_REF_MSG:703,AWEME_TEXT_POSTSCRIPT:704,AWEME_TEXT_ASK:705,AWEME_TEXT_WELCOME_WORDS:706,AWEME_TEXT_REPORT_WORDS:708,AWEME_PERSONAL_INFO_REQUEST:770,AWEME_PERSONAL_INFO_RESPONSE:771,AWEME_TEXT_UNKNOWN_MSG_TYPE:799,AWEME_CARD:800,PICTURE_CARD:900,RANKING_LIST_WORD:1801,RANKING_LIST_VIDEO:1802,RANKING_LIST_MUSIC:1803,LIVE_KTV:2101,LIVE_VOICE:2102,IM_ENCRYPT_VOICE_AWE_TYPE:10900,RANKING_LIST_HARMONY:2301,MINI_GAME:2401,MINI_APP:2402,MINI_GENERALIZE:2403,ENCRYPT_PICTURE:2700,ENCRYPT_PICTURE_SHARE_FROM_THIRD:2701,ENCRYPT_PICTURE_OUT_CHECK:2702,ENCRYPT_PICTYRE_GIF:2703,WEB_SHARE_FROM_THIRD:6001,WEB_SHARE_FROM_RED_PACKET:2601,GOOD_WINDOW_V3:6400,AWEME_XEMOJI:5101,DIRECT_INVITE_VOICE_CHAT:7801,DIRECT_INVITE_KTV:7802,DIRECT_INVITE_VIDEO_CHAT:7803,DIRECT_INVITE_SHORT_VIDEO:7804,DIRECT_INVITE_FAMILIAR_KTV:7805,DIRECT_INVITE_AUDIENCE:7806,GAME_INVITE_IN_CHAT:7900,GAME_INVITE_IN_GAME:7901,GAME_INVITE_V2:8200,REF_MSG:8300,GROUP_VOTE:8800,COMMODITY_SHARE:8801,GROUP_NOTICE_ADD:100100,GROUP_NOTICE_COMMAND_ADD:100101,GROUP_NOTICE_QRCODE_ADD:100102,GROUP_NOTICE_SAFETY_WARNING:100103,GROUP_NOTICE_REMOVE:100104,GROUP_NOTICE_EXIT:100105,GROUP_NOTICE_GROUP_NAME_CHANGE:100106,GROUP_NOTICE_FROM_DUO_SHAN:100107,GROUP_NOTICE_APPLY_ADD:100109,GROUP_NOTICE_ADMIN_ADD:100110,GROUP_NOTICE_SEARCH_JOIN_GROUP:100111,GROUP_NOTICE_ACTIVITY_JOIN_GROUP:100112,GROUP_NOTICE_ACTIVITY_JOIN_GROUP_BY_FTF:100113,GROUP_NOTICE_ACTIVITY_JOIN_GROUP_BY_CIRCLE:100114,GROUP_NOTICE_WARNING_TIPS:100120,GROUP_NOTICE_GROUP_NAME_EDIT_TIPS:100121,GROUP_NOTICE_LIVE_FANS_MANAGER:100122,GROUP_NOTICE_LIVE_FANS_ANNOUNCE:100123,GROUO_NOTICE_DISABLE_SHARE:100124,GROUP_NOTICE_OPEN_DISABLES_SHARE:100125,GROUP_GREET_MESSAGE_FROM_SERVER:100200,GROUP_GREET_MESSAGE_FROM_CLIENT:100201,GROUP_OWNER_ACTIVE_GUIDE_EMOJI:100202,GROUP_MEMBER_ONLINE_GREET_EMOJI:100203,GROUP_MESSAGE_FOR_AVCALL:100300,GROUP_NOTICE_MUTE_NOTICE:9994,GROUP_NOTICE_FANS_GROUP_WELCOME_NOTICE:9995,FEED_VOIP_SHARE_FOR_AVCALL:9e3},i=[r.SHARE_AWEME,r.REF_MSG,r.SHARE_PHOTOS,r.SHARE_COMMENT,r.BULLET]},70961:function(e,n,t){t.d(n,{v:function(){return c}});var r=t(69071),a=t(45690),i=t(72494),s=r.m.ConversationType,o=s.GROUP_CHAT,u=(s.ONE_TO_ONE_CHAT,"");function c(e){var n,t=e||{},r=t.id,s=t.type,c=t.toParticipantUserId,l=t.lastMessage,d=t.coreInfo,_=void 0===d?{}:d,v=t.ext,f=s===o,p=a.default.userInfoFromServerMap,E=l||{},h=E.createdAt,I=(E.content,_.name),m=_.icon,g=(null==p?void 0:p[c])||{};g||a.default.getPatchUserInfoAsync(c);var S=(f?(null==v?void 0:v["a:ab_avatar"])||m:null==g||null===(n=g.avatar_thumb)||void 0===n?void 0:n.url_list)||u,T=(null==g?void 0:g.remark_name)||(null==g?void 0:g.nickname)||c||"";return{headIcon:S,title:f?I||r:T,timeStr:(0,i.xS)(h)}}},25674:function(e,n,t){t.d(n,{lR:function(){return k},NC:function(){return N},ur:function(){return A},s9:function(){return L},zt:function(){return b},t$:function(){return w},FG:function(){return P},Jo:function(){return U},MZ:function(){return G},np:function(){return D},gc:function(){return Z},jt:function(){return x},gP:function(){return F},Ww:function(){return H},iN:function(){return V},FH:function(){return Y},KI:function(){return W},V5:function(){return j},AD:function(){return B}});var r=t(30906),a=t(49188),i=t.n(a),s=t(94258),o=t.n(s),u=t(31674),c=t.n(u),l=t(11227),d=t.n(l),_=t(94090),v=t.n(_),f=t(26447),p=t.n(f),E=t(19672),h=t.n(E),I=t(21155),m=t.n(I),g=t(69071),S=t(65981),T=t.n(S),C=t(9267),M=t.n(C),O=t(45690),R=t(33200),y=t(94234);g.m.ConversationType;function k(e){var n=e.height,t=e.id,r=e.width,a=(e.sticker_type,e.animate_type,e.animate_url),i=e.id_str,s={aweType:R.c6.AWEME_SINGLE_HEYCAN_EMOJI,createdAt:0,display_name:"",height:n,width:r,image_id:i||t,image_type:"gif",is_card:!1,may_show_special_effect:!1,msgHint:"",package_id:0,updateConversationTime:!0,url:{height:0,uri:null==a?void 0:a.uri,url_list:null==a?void 0:a.url_list,width:0}};return{type:R.pp.BIG_EMOJI,content:c()(s)}}function N(e){var n=e.height,t=(e.id,e.width),r=e.display_name,a=e.animate_url,i=e.id_str,s=BigInt(i),o={aweType:R.c6.AWEME_EMOJI_SELF,createdAt:0,display_name:r||"",height:n,width:t,image_id:s,image_type:"gif",is_card:!1,may_show_special_effect:!1,msgHint:"",package_id:0,updateConversationTime:!0,url:{height:0,uri:null==a?void 0:a.uri,url_list:null==a?void 0:a.url_list,width:0}};return{type:R.pp.BIG_EMOJI,content:T().stringify(o)}}function A(e){var n=e.origin,t=e.id,r=n||{},a=r.width,i=r.height,s=r.uri,o=r.url_list,u={aweType:R.c6.AWEME_SINGLE_HEYCAN_EMOJI,createdAt:0,display_name:"",height:i,width:a,image_id:t,image_type:"gif",is_card:!1,may_show_special_effect:!1,msgHint:"",package_id:0,updateConversationTime:!0,url:{height:0,uri:s,url_list:o,width:0}};return{type:R.pp.BIG_EMOJI,content:c()(u)}}function L(e){var n=e.height,t=e.id,r=e.width,a=e.animate_url,i=e.display_name,s=e.resource_type,o=e.static_url_list,u=a;5===s&&(u=o[Math.floor(Math.random()*o.length)].static_url);var l={aweType:R.c6.AWEME_INTERACTIVE_EMOJI,createdAt:0,display_name:i,height:n,width:r,image_id:t,image_type:"gif",is_card:!1,may_show_special_effect:!1,msgHint:"",package_id:0,updateConversationTime:!0,url:{height:n,uri:u,url_list:[u],width:r}};return{type:R.pp.BIG_EMOJI,content:c()(l)}}function b(e){var n=e.height,t=e.id,r=e.width,a=e.animate_url,i=e.display_name,s={aweType:R.c6.AWEME_SINGLE_HEYCAN_EMOJI,createdAt:0,display_name:i,height:n,width:r,image_id:t,image_type:"gif",is_card:!1,may_show_special_effect:!1,msgHint:"",package_id:0,updateConversationTime:!0,url:{height:0,uri:null==a?void 0:a.uri,url_list:null==a?void 0:a.url_list,width:0}};return{type:R.pp.BIG_EMOJI,content:c()(s)}}function w(e){var n=arguments.length>1&&arguments[1]!==undefined&&arguments[1],t=e.content,r={};try{r=(n?T():JSON).parse(t)}catch(a){r={}}return r}function P(e,n){var t=e,r=n;return null!=e&&d()(e).call(e,"\u672a\u6210\u5e74\u5145\u503c")&&(t="\u5982\u9047\u672a\u6210\u5e74\u5145\u503c\u6253\u8d4f\u95ee\u9898\uff0c\u53ef\u5728 {{1}} \u5185\u7533\u8bf7\u9000\u6b3e",r=[{key:1,action:4,name:"\u6296\u97f3App",link:"https://www.douyin.com/downloadpage/app"}]),{newTips:t,newTemplate:r}}function U(e){var n=e.referenceInfo,t={};if(n){var r=n.hint;try{var a=JSON.parse(r).refmsg_content;a&&(t=JSON.parse(a))}catch(i){t={}}}return t}function G(e){return function(e){var n=e.text,t=e.textExtra,r=void 0===t?[]:t,a=e.content,i=e.type,s=e.referenceHint,u=e.referenceMessage,l=[];o()(r,(function(e){var n,t=null==e||null===(n=e.info)||void 0===n?void 0:n.uid;t&&l.push(t)}));var d={mention_users:l,aweType:R.c6.AWEME_TEXT,richTextInfos:r};u&&(d.aweType=R.c6.TEXT_REF_MSG),n&&(d.text=n);var _={type:i||R.pp.TEXT,mentionedUsers:l,content:a||c()(d)};return u&&(_.referenceHint=c()(s),_.referenceMessage=u),_}(e)}function D(e){var n,t=e||{},r=t.active_users,a=t.passive_users,i=t.locale_resources,s=(null==i||null===(n=i[0])||void 0===n?void 0:n.text)||"",u=O.default.curUserInfo,c=[];o()(r,(function(e){var n=(null==e?void 0:e.nickname)||"";null!=u&&u.uid&&(null==u?void 0:u.uid)===(null==e?void 0:e.uid)&&(n="\u4f60"),c.push(n)}));var l=[];return o()(a,(function(e){var n=(null==e?void 0:e.nickname)||"";null!=u&&u.uid&&(null==u?void 0:u.uid)===(null==e?void 0:e.uid)&&(n="\u4f60"),l.push(n)})),s.replace("{0}",c.join("\u3001")).replace("{1}",l.join("\u3001"))}function Z(e){var n,t,r,a,i,s,o,u,c,l,d="";if(!e)return d;var _=e.type,v=(e.visible,e.isFromMe),f=e.content;e.sender,e.conversationId,e.conversationType;if(e.isRecalled)return"".concat(v?"\u4f60":"","\u64a4\u56de\u4e86\u4e00\u6761\u6d88\u606f");var p={};try{p=JSON.parse(f)}catch(I){}switch(_){case R.pp.SYSTEM:d=j(null===(n=p)||void 0===n?void 0:n.tips,null===(t=p)||void 0===t?void 0:t.template)||"";break;case R.pp.BIG_EMOJI:d="[".concat((null===(r=p)||void 0===r?void 0:r.display_name)||"\u8868\u60c5","]");break;case R.pp.TEXT:d=(null===(a=p)||void 0===a?void 0:a.text)||"";break;case R.pp.SHARE_AWEME:d="\u5206\u4eab[\u89c6\u9891]";break;case R.pp.SAY_HELLO:var E="\u6211\u662f".concat(null===(i=p)||void 0===i?void 0:i.nickname,"\uff0c")||0;d="\u55e8\uff5e ".concat(E,"\u804a\u804a\u5929\u5427");break;case R.pp.VOICE:case R.pp.IM_ENCRYPT_VOICE:d="[\u8bed\u97f3]";break;case R.pp.SHARE_LIVE:var h;if(d="\u5206\u4eab[\u76f4\u64ad]",null!==(s=p)&&void 0!==s&&s.push_detail)d+="\uff1a".concat(null===(h=p)||void 0===h?void 0:h.push_detail);break;case R.pp.STORY_PICTURE:d="[\u56fe\u7247]";break;case R.pp.XPLAN_STICKER_EMOJI:d="[".concat((null===(o=p)||void 0===o?void 0:o.display_name)||"\u8868\u60c5","]");break;case R.pp.SHARE_PHOTOS:d="\u5206\u4eab[\u56fe\u96c6]";break;case R.pp.REF_MSG:d="".concat((null===(u=p)||void 0===u?void 0:u.shareMsgType)===R.pp.SHARE_PHOTOS?"\u5206\u4eab[\u56fe\u96c6]":"\u5206\u4eab[\u89c6\u9891]");break;case R.pp.GROUP_NOTICE_MESSAGE:d=D(p);break;case R.pp.GROUP_GREET_MESSAGE:d="\u548c\u670b\u53cb\u6253\u4e2a\u62db\u547c\u5427";break;case R.pp.GROUP_ANNOUNCEMENT_MESSAGE:d="[\u7fa4\u516c\u544a]".concat((null===(c=p)||void 0===c?void 0:c.notice_content)||"");break;case R.pp.SHARE_USER:d="[\u5206\u4eab\u7528\u6237]";break;case R.pp.SHARE_COMMENT:d="\u5206\u4eab[\u8bc4\u8bba]";break;case R.pp.BULLET:d=String((null===(l=p)||void 0===l?void 0:l.push_detail)||"\u6d88\u606f\u5361\u7247");break;default:d="\u6682\u4e0d\u652f\u6301\u8be5\u6d88\u606f\u7c7b\u578b"}return d}function x(e){var n,t="";if(!e)return t;e.type,e.visible,e.isFromMe,e.content;var r,a,i=e.sender,s=e.conversationId,o=(e.isRecalled,e.conversationType,O.default.unSendMsgConversationMap,O.default.userInfoFromSdkMap),u=O.default.userInfoFromServerMap;O.default.abTestData;a=Z(e);var c=null==o||null===(n=o[s])||void 0===n?void 0:n[i],l=null==u?void 0:u[i];return(r=(null==l?void 0:l.remark_name)||(null==c?void 0:c.alias)||(null==l?void 0:l.nickname)||"")&&(t+="".concat(r,":")),a&&(t+=a),t||""}function F(e){try{switch(M().fromValue(e).toNumber()){case R.pp.SHARE_AWEME:return"[\u5206\u4eab\u89c6\u9891]";case R.pp.SHARE_PHOTOS:return"[\u5206\u4eab\u56fe\u96c6]";default:return""}}catch(n){return""}}function H(e,n){var t,a,i=e.type,s=e.content,o=e.sender,u=(O.default.unSendMsgConversationMap,O.default.curUserInfo),c=(O.default.abTestData,O.default.curConversation),l=(O.default.userInfoFromSdkMap,O.default.userInfoFromServerMap[o]),d=l.uid,_=l.sec_uid,f=l.nickname,p=l.remark_name,E=(c.type,u.uid),h={};try{h=JSON.parse(s)}catch(T){}var I,m={},g="",S=0;switch(i){case R.pp.BIG_EMOJI:m={content:"[\u8868\u60c5]",refmsg_content:s};break;case R.pp.TEXT:m={content:h.text,refmsg_content:s};break;case R.pp.SHARE_AWEME:S=1,m={content:v()(t="".concat(F(i))).call(t,h.content_title),refmsg_content:s};break;case R.pp.STORY_PICTURE:m={content:"[\u56fe\u7247]",refmsg_content:s},g=h.itemId;break;case R.pp.XPLAN_STICKER_EMOJI:m={content:"[\u8868\u60c5]",refmsg_content:s};break;case R.pp.SHARE_PHOTOS:m={content:v()(a="".concat(F(i))).call(a,h.content_title),refmsg_content:s};break;case R.pp.BULLET:g=h.item_id,m={content:"".concat(h.description||"\u6d88\u606f\u5361\u7247"),refmsg_content:s};break;case R.pp.REF_MSG:m={content:h.text,refmsg_content:s};break;default:return!1}return I=E!==d?y.dx.SCENE_TYPE_REPLY_OTHER:y.dx.SCENE_TYPE_REPLY_SELF,(0,r.Z)((0,r.Z)({refmsg_uid:d,itemId:g,nickname:p||f,refmsg_sec_uid:_,refmsg_type:i},m),{},{scene_type:I,version:S})}var V=function(e){return p()()-new Date(e).getTime()<=2592e5},Y=function(e){return!(e>=0&&e<=1999||e>5e4&&60001!==e)},W=function(e,n){if(!e)return[];if(null==n||!n.length)return[e];var t={};o()(n,(function(e){var n="{{".concat(null==e?void 0:e.key,"}}");t[n]=e}));var r=e.match(/{{\d+}}/g),a=[e];return o()(r,(function(e){var n,r,s,u;n=a,r=e,s=t[e],u=[],o()(n,(function(e){if(i()(e)){var n=e.split(r),t=n.length,a=[];t>1?(o()(n,(function(e,n){n===t-1?a.push(e):(a.push(e),a.push(s))})),u=v()(u).call(u,a)):u.push(e)}else u.push(e)})),a=u})),a};function j(e,n){var t=String(e);return h()(n)&&m()(n).call(n,(function(e){var n;t=null===(n=t)||void 0===n?void 0:n.replace("{{".concat(null==e?void 0:e.key,"}}"),null==e?void 0:e.name)})),t}function B(e,n,t){var r,a=e.content,i=e.sender;try{r=JSON.parse(a)}catch(m){r={}}var s=r,o=s.content_title,u=s.cover_height,l=s.cover_url,d=s.cover_width,_=s.is_card,v=s.itemId,f=s.msgHint,p=s.push_detail,E=s.uid,h=s.secUID,I={aweType:R.c6.REF_MSG,scene_type:y.dx.SCENE_TYPE_REPLY_INPUT,content_title:o,cover_height:u,cover_width:d,cover_url:l,is_card:_,itemId:v,msgHint:f,push_detail:p,createdAt:0,text:n,richTextInfos:t,ref_uid:i,uid:E,sec_uid:h};return{type:R.pp.REF_MSG,content:c()(I)}}},72494:function(e,n,t){t.d(n,{xS:function(){return _},lD:function(){return v},v1:function(){return f}});var r=t(26447),a=t.n(r),i=t(94090),s=t.n(i),o=t(22541),u=t.n(o),c=t(47601),l=t.n(c);u().extend(l());var d={0:"\u661f\u671f\u65e5",1:"\u661f\u671f\u4e00",2:"\u661f\u671f\u4e8c",3:"\u661f\u671f\u4e09",4:"\u661f\u671f\u56db",5:"\u661f\u671f\u4e94",6:"\u661f\u671f\u516d"};function _(e){if(a()()-new Date(e).getTime()<=3e5)return"\u521a\u521a";var n=u()(e),t=u()(),r=n.format("HH:mm")||"";if(e>t.startOf("day").valueOf())return r;if(e>t.subtract(1,"day").startOf("day").valueOf())return"\u6628\u5929";if(e>=t.subtract(3,"day").startOf("day").valueOf()){var i=n.day();return d[i]}return e>=t.startOf("year").valueOf()?n.format("MM-DD")||"":n.format("YYYY-MM-DD")||""}function v(e){if(a()()-new Date(e).getTime()<=3e5)return"\u521a\u521a";var n=u()(e),t=u()(),r=n.format("HH:mm")||"";if(e>t.startOf("day").valueOf())return r;if(e>t.subtract(1,"day").startOf("day").valueOf())return"\u6628\u5929 ".concat(r);if(e>=t.subtract(3,"day").startOf("day").valueOf()){var i,o=n.day();return s()(i="".concat(d[o]," ")).call(i,r)}return n.format("YYYY-MM-DD HH:mm")||""}function f(e){return a()()-new Date(e).getTime()<=3e5}},45690:function(e,n,t){t.r(n),t.d(n,{default:function(){return le}});var r=t(32781),a=t(64408),i=t(77007),s=t(30906),o=t(19049),u=t(95508),c=t(65146),l=t(93935),d=t.n(l),_=t(16394),v=t.n(_),f=t(35496),p=t.n(f),E=t(32594),h=t.n(E),I=t(94258),m=t.n(I),g=t(5594),S=t.n(g),T=t(42249),C=t.n(T),M=t(56442),O=t.n(M),R=t(8369),y=t.n(R),k=t(11227),N=t.n(k),A=t(82766),L=t.n(A),b=t(94090),w=t.n(b),P=t(26447),U=t.n(P),G=t(21155),D=t.n(G),Z=t(68493),x=t.n(Z),F=t(50750),H=t.n(F),V=t(88743),Y=t.n(V),W=t(25748),j=t(69071),B=t(32487),K=t(49418),J=t(75779),X=t(71116),$=t(97876),Q=t(73772),q=t(65695),z=t(94234),ee=t(53873),ne=function e(n,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:(null==n?void 0:n.length)||0;if(a<=r)return r;var i,s,o=Math.floor((r+a)/2);return i=n[o],s=t,(null==i?void 0:i.updatedAt)>(null==s?void 0:s.updatedAt)?r=o+1:a=o,e(n,t,r,a)},te=t(33200),re=t(25674),ae=t(92582),ie=t(30758),se=j.m.ConversationType,oe=se.GROUP_CHAT,ue=se.ONE_TO_ONE_CHAT,ce=function(){function e(){var n=this;(0,o.Z)(this,e),(0,c.Z)(this,"theme",z.rS.light),(0,c.Z)(this,"curUserInfo",{}),(0,c.Z)(this,"abTestData",{}),(0,c.Z)(this,"isLogin",!1),(0,c.Z)(this,"showDlg",!1),(0,c.Z)(this,"isShareCollapse",!0),(0,c.Z)(this,"audioMd5",""),(0,c.Z)(this,"converSationListOrigin",[]),(0,c.Z)(this,"conversationPullUpPriority",{}),(0,c.Z)(this,"conversationMap",{}),(0,c.Z)(this,"isInStrangerConversationList",!1),(0,c.Z)(this,"curConversation",null),(0,c.Z)(this,"strangerBoxCover",null),(0,c.Z)(this,"enterConversation",z.eY.CHAT_NOTIFY),(0,c.Z)(this,"messageList",[]),(0,c.Z)(this,"curMsgOptPopId",""),(0,c.Z)(this,"curGroupUserIdList",[]),(0,c.Z)(this,"conversationUserids",{}),(0,c.Z)(this,"uidSecUidMap",{}),(0,c.Z)(this,"userInfoFromSdkMap",{}),(0,c.Z)(this,"userInfoFromServerMap",{}),(0,c.Z)(this,"unSendMsgConversationMap",{}),(0,c.Z)(this,"serverIdMessageMap",{}),(0,c.Z)(this,"emojiMap",{}),(0,c.Z)(this,"emojiList",[]),(0,c.Z)(this,"emojiGifList",[]),(0,c.Z)(this,"customEmojiList",[]),(0,c.Z)(this,"recentEmojiList",[]),(0,c.Z)(this,"recentGifList",[]),(0,c.Z)(this,"showSugEmoji",!0),(0,c.Z)(this,"interactiveEmojiList",[]),(0,c.Z)(this,"allFriendsList",[]),(0,c.Z)(this,"userInfoForShareMap",{}),(0,c.Z)(this,"msgListToPush",[]),(0,c.Z)(this,"awemeInfo",{}),(0,c.Z)(this,"shareType",ie.yw.Video),(0,c.Z)(this,"shareUserInfo",{}),(0,c.Z)(this,"shareCommentInfo",{}),(0,c.Z)(this,"shareeListHeight",0),(0,c.Z)(this,"shareMap",{}),(0,c.Z)(this,"replayMessageServerId",null),(0,c.Z)(this,"clientTrayGuidInfo",null),(0,c.Z)(this,"strangerMessageUnreadCount",0),(0,c.Z)(this,"isStrangerConversation",!1),(0,c.Z)(this,"shareStatusHandler",{handleCollapse:function(){},handleExpand:function(){}}),(0,c.Z)(this,"hasJoinGroupObj",{conversation:[],cursor:"0",hasMore:!0,loading:!1}),(0,c.Z)(this,"strangerConverListObj",{conversation:[],cursor:"0",hasMore:!0,loading:!1,unreadCount:0}),(0,c.Z)(this,"canShowImPush",!0),(0,c.Z)(this,"userFollowStatusMap",{}),(0,c.Z)(this,"selectChatUserShortId",""),(0,c.Z)(this,"isOpenMessageList",!0),(0,c.Z)(this,"maskIsTestGroupClickConversionListItem",!1),(0,c.Z)(this,"maskConversaionAnimationEnd",!1),(0,c.Z)(this,"maskIsExitConversation",!1),(0,c.Z)(this,"changeConversationItemStatus",!1),(0,c.Z)(this,"saveStrageConversaionInfo",{list:[],index:-1}),(0,c.Z)(this,"isShowGetConversaionListLoading",!0),(0,c.Z)(this,"isReportOpen",!1),(0,c.Z)(this,"selectedMessage",new(C())),(0,c.Z)(this,"downloadInfo",{showDownload:!1}),(0,c.Z)(this,"setSelectChatUserShortId",(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";n.selectChatUserShortId=e})),(0,c.Z)(this,"setIsOpenMessageList",(function(e){(0,ae.Gb)("click_fold_im",{is_fold:Number(!e)}),n.isOpenMessageList=e})),(0,c.Z)(this,"setMaskIsTestGroupClickConversionListItem",(function(e){n.maskIsTestGroupClickConversionListItem=e})),(0,c.Z)(this,"setMaskConversaionAnimationEnd",(function(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0];n.maskConversaionAnimationEnd=Boolean(e)})),(0,c.Z)(this,"setMaskIsExitConversation",(function(){n.maskIsExitConversation=!0})),(0,c.Z)(this,"setChangeConversationItemStatus",(function(e){n.changeConversationItemStatus=e})),(0,c.Z)(this,"setSaveStrageConversaionInfo",(function(e){n.saveStrageConversaionInfo=(0,s.Z)((0,s.Z)({},n.saveStrageConversaionInfo),e)})),(0,c.Z)(this,"setIsShowGetConversaionListLoading",(function(e){n.isShowGetConversaionListLoading=e})),(0,c.Z)(this,"updateSelectedMessage",(function(e,t){t?n.selectedMessage.add(e):n.selectedMessage.delete(e)})),(0,W.ky)(this,{theme:W.LO,curUserInfo:W.LO,abTestData:W.LO.shallow,isLogin:W.LO,showDlg:W.LO,isShareCollapse:W.LO,audioMd5:W.LO,converSationListOrigin:W.LO,conversationPullUpPriority:W.LO,curConversation:W.LO,enterConversation:W.LO,messageList:W.LO,curMsgOptPopId:W.LO,curGroupUserIdList:W.LO,conversationUserids:W.LO,uidSecUidMap:W.LO,userInfoFromSdkMap:W.LO,userInfoFromServerMap:W.LO,userInfoForShareMap:W.LO,unSendMsgConversationMap:W.LO,serverIdMessageMap:W.LO,emojiMap:W.LO,emojiList:W.LO,emojiGifList:W.LO,allFriendsList:W.LO,msgListToPush:W.LO,awemeInfo:W.LO,shareMap:W.LO,replayMessageServerId:W.LO,shareStatusHandler:W.LO,hasJoinGroupObj:W.LO,isInStrangerConversationList:W.LO,strangerBoxCover:W.LO,strangerMessageUnreadCount:W.LO,conversationMap:W.LO,strangerConverListObj:W.LO,isStrangerConversation:W.LO,canShowImPush:W.LO,userFollowStatusMap:W.LO,selectChatUserShortId:W.LO,isOpenMessageList:W.LO,maskIsTestGroupClickConversionListItem:W.LO,maskConversaionAnimationEnd:W.LO,maskIsExitConversation:W.LO,changeConversationItemStatus:W.LO,saveStrageConversaionInfo:W.LO,isShowGetConversaionListLoading:W.LO,isReportOpen:W.LO,selectedMessage:W.LO,conversationListFilter:W.Fl,allUnReadCount:W.Fl,allGroupList:W.Fl,conversationInfoMap:W.Fl,allFriendInfoList:W.Fl,usersInConversationList:W.Fl,strongNoticeList:W.Fl,converListWithStrangerBox:W.Fl,stickOnTopCount:W.Fl,videoMsgList:W.Fl,setIsLogin:W.aD,setDlgShow:W.aD,setShareCollapse:W.aD,setCurShareType:W.aD,setCurAwemeInfo:W.aD,setCurShareUserInfo:W.aD,setCurShareCommentInfo:W.aD,setShareeListHeight:W.aD,setShareMap:W.aD,setShareStatusHandler:W.aD,resetData:W.aD,setAudioMd5:W.aD,setConverSationList:W.aD,setCurConverSation:W.aD,setCurMessageList:W.aD,setConversationPullUp:W.aD,setCurMsgOptPopId:W.aD,setCurGroupUserIdList:W.aD,setConversationUserids:W.aD,setUserInfoFromSdkMap:W.aD,setUserInfoFromServerMap:W.aD,setUserInfoForShareMap:W.aD,setUnSendMsgConversation:W.aD,clearOldMsgListToPush:W.aD,closeMsgPushPop:W.aD,setUserInfoBlockStatus:W.aD,setReplayMessageServerId:W.aD,setClientTrayGuidClientId:W.aD,clearClientTrayGuidClientId:W.aD,setHasJoinGroup:W.aD,setIsInStrangerConversationList:W.aD,setStrangerBoxCover:W.aD,setStrangerMessageUnreadCount:W.aD,setConversationMap:W.aD,setStrangerConverListObj:W.aD,setIsStrangerConversation:W.aD,setCanShowImPush:W.aD,setUserFollowStatusMap:W.aD,setSelectChatUserShortId:W.aD,setIsOpenMessageList:W.aD,setMaskIsTestGroupClickConversionListItem:W.aD,setMaskConversaionAnimationEnd:W.aD,setMaskIsExitConversation:W.aD,setChangeConversationItemStatus:W.aD,setSaveStrageConversaionInfo:W.aD,setIsShowGetConversaionListLoading:W.aD,setDownloadInfo:W.aD,getUserInfoMapAsync:W.aD,getShareUserListAsync:W.aD,getEmojiGifListAsync:W.aD,pushNewMsgInList:W.aD})}var n,t,l,_,f,E,I,g,T,M,R,k,A,b,P;return(0,u.Z)(e,[{key:"conversationListFilter",get:function(){var e=this.converSationListOrigin||[],n=[];return m()(e,(function(e){e&&(e.type!==oe||e.type===oe&&e.lastMessage)&&n.push(e)})),Q.Z.warn("conversationListFilter",n),n}},{key:"stickOnTopCount",get:function(){var e,n=this.conversationListFilter||[],t=0,r=(0,i.Z)(n);try{for(r.s();!(e=r.n()).done;){var a=e.value;if(null==a||!a.isStickOnTop)break;t++}}catch(s){r.e(s)}finally{r.f()}return t}},{key:"converListWithStrangerBox",get:function(){var e,n,t=(null===(e=this.conversationListFilter)||void 0===e?void 0:O()(e).call(e))||[],r=this.stickOnTopCount||0,a=(null===(n=this.conversationListFilter)||void 0===n?void 0:n.length)||0;if(this.strangerBoxCover){var i,s=ne(t,null===(i=this.strangerBoxCover)||void 0===i?void 0:i.conversation,r,a);null==t||y()(t).call(t,s,0,this.strangerBoxCover)}return t}},{key:"allUnReadCount",get:function(){var e=p()(this.conversationListFilter,(function(e){var n=e.isMuted;e.unreadCount;return n?0:(null==e?void 0:e.unreadCount)||0})),n=X.Le.getConfig(X.gI.UnReadCount)||{},t=n.im||0,r=e;return X.Le.setConfig(X.gI.UnReadCount,(0,s.Z)((0,s.Z)({},n),{im:e})),t!==r&&$.emit($.EVENT.updateUnReadCount,!0),e}},{key:"allGroupList",get:function(){var e=[];return m()(this.conversationListFilter,(function(n){n.id;n.type===oe&&e.push(n)})),d()(e,(function(e){return null==e?void 0:e.id}))}},{key:"conversationInfoMap",get:function(){var e={};return m()(this.converSationListOrigin,(function(n){var t=n.id;n.type;e[t]=n})),e}},{key:"usersInConversationList",get:function(){var e=[];return m()(this.converSationListOrigin,(function(n){var t=n.id,r=n.type,a=n.toParticipantUserId;a&&r===ue&&e.push({uid:a,conversationId:t})})),d()(e,(function(e){return null==e?void 0:e.uid}))}},{key:"strongNoticeList",get:function(){var e=[];return m()(this.messageList,(function(n){var t,r=(0,re.t$)(n);null!=n&&n.isFromMe||null==r||null===(t=r.ext)||void 0===t||!t.strong_tips||e.push({contentObj:r,msg:n})})),e}},{key:"allFriendInfoList",get:function(){var e=[],n=this.allFriendsList||[],t=this.userInfoFromServerMap||{};return m()(n,(function(n){var r=null==t?void 0:t[n];r&&e.push(r)})),d()(e,(function(e){return null==e?void 0:e.uid}))}},{key:"videoMsgList",get:function(){var e=[];return m()(this.messageList,(function(n){var t=n||{},r=t.type,a=t.clientId;if(!t.isRecalled&&null!==te.ds&&void 0!==te.ds&&N()(te.ds).call(te.ds,r)){var i=(0,re.t$)(n)||{},s=i.itemId,o=i.item_id,u=null!=s?s:o;u&&e.push({awemeId:u,msgClientId:a})}})),e}},{key:"setTheme",value:function(e){this.theme=e}},{key:"setCurUserInfo",value:function(e){this.curUserInfo=e}},{key:"setIsLogin",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this.isLogin=e}},{key:"setDlgShow",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this.showDlg=e}},{key:"setAbTestData",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.abTestData=e}},{key:"setShareCollapse",value:function(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0],n=this.shareStatusHandler,t=n.handleCollapse,r=void 0===t?function(){}:t,a=n.handleExpand,i=void 0===a?function(){}:a;this.isShareCollapse=e,e?null==r||r():null==i||i()}},{key:"setCurShareType",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:ie.yw.Video;this.shareType=e}},{key:"setCurAwemeInfo",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.awemeInfo=e}},{key:"setCurShareUserInfo",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.shareUserInfo=e}},{key:"setCurShareCommentInfo",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.shareCommentInfo=e}},{key:"setShareeListHeight",value:function(e){this.shareeListHeight=e}},{key:"setShareStatusHandler",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{handleCollapse:function(){},handleExpand:function(){}};this.shareStatusHandler=e}},{key:"setShareMap",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.shareMap=e}},{key:"resetData",value:function(){}},{key:"setAudioMd5",value:function(e){this.audioMd5=e}},{key:"setConverSationList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.setIsShowGetConversaionListLoading(!0);for(var n=d()(e,(function(e){return null==e?void 0:e.id})),t=0,r=n.length,a=0;a<r;a++){var i=n[a];if(null==i||!i.isStickOnTop){t=a;break}}var s=[];t>0&&(s=y()(n).call(n,0,t),L()(s).call(s,(function(e,n){var t,r,a=(null==e||null===(t=e.lastMessage)||void 0===t?void 0:t.createdAt)||0;return((null==n||null===(r=n.lastMessage)||void 0===r?void 0:r.createdAt)||0)-a}))),this.converSationListOrigin=w()(s).call(s,n)}},{key:"setCurConverSation",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.curConversation=e,this.serverIdMessageMap={},this.setIsStrangerConversation((null==e?void 0:e.isStrangerConversation)||!1)}},{key:"setEnterConversation",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:z.eY.CHAT_NOTIFY;this.enterConversation=e}},{key:"setCurMessageList",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.serverIdMessageMap={},this.messageList=d()(n,(function(n){var t=n||{},r=t.serverId,a=t.clientId;return r&&(e.serverIdMessageMap[r]=n),a}))}},{key:"setConversationPullUp",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.conversationPullUpPriority=(0,s.Z)((0,s.Z)({},this.conversationPullUpPriority),{},(0,c.Z)({},null==e?void 0:e.shortId,U()()))}},{key:"setStrangerConverListObj",value:function(e){this.strangerConverListObj=e}},{key:"setConversationMap",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[],n=this.conversationMap||{};null==e||D()(e).call(e,(function(e){var t=e.id;n[t]=e})),this.conversationMap=n}},{key:"setIsInStrangerConversationList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this.isInStrangerConversationList=e}},{key:"setIsStrangerConversation",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this.isStrangerConversation=e}},{key:"setStrangerBoxCover",value:function(e){var n=e?{conversation:e,converCellType:z.tQ.STRANGER}:null;this.strangerBoxCover=n}},{key:"setStrangerMessageUnreadCount",value:function(e){this.strangerMessageUnreadCount=e}},{key:"setCurMsgOptPopId",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";this.curMsgOptPopId=e}},{key:"setCurGroupUserIdList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.curGroupUserIdList=v()(e)}},{key:"setConversationUserids",value:function(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];this.conversationUserids[e]=v()(n)}},{key:"setUserInfoFromSdkMap",value:function(e,n,t){this.userInfoFromSdkMap||(this.userInfoFromSdkMap={}),this.userInfoFromSdkMap[e]||(this.userInfoFromSdkMap[e]={}),this.userInfoFromSdkMap[e][n]||(this.userInfoFromSdkMap[e][n]=t,this.uidSecUidMap[n]=t.sec_uid)}},{key:"setUserInfoFromServerMap",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];n&&m()(n,(function(n){var t=n.uid;t&&"0"!==t&&(e.userInfoFromServerMap[t]=n)}))}},{key:"setUserInfoForShareMap",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];n&&(this.userInfoForShareMap=this.userInfoForShareMap||{},m()(n,(function(n){var t=n.uid;t&&"0"!==t&&(e.userInfoForShareMap[t]=n)})))}},{key:"setUserInfoBlockStatus",value:function(e){var n,t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];null!==(n=this.userInfoFromServerMap)&&void 0!==n&&n[e]&&(this.userInfoFromServerMap[e].is_block=t)}},{key:"setReplayMessageServerId",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.replayMessageServerId=e}},{key:"setClientTrayGuidClientId",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,n=arguments.length>1?arguments[1]:undefined;this.clientTrayGuidInfo={clientId:e,type:n}}},{key:"clearClientTrayGuidClientId",value:function(){this.clientTrayGuidInfo=null}},{key:"setUnSendMsgConversation",value:function(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;e&&(n?this.unSendMsgConversationMap[e]=n:delete this.unSendMsgConversationMap[e])}},{key:"setMultiUnSendMsgConversation",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];D()(n).call(n,(function(n){var t=n.conversationId,r=n.text,a=n.textExtra,i=n.replyMsgServerId;t&&(e.unSendMsgConversationMap[t]={text:r,textExtra:a,replyMsgServerId:i})}))}},{key:"clearOldMsgListToPush",value:function(){var e,n,t=(null===(e=this.msgListToPush)||void 0===e?void 0:e.length)||0;t<=1||null===(n=this.msgListToPush)||void 0===n||y()(n).call(n,0,t-1)}},{key:"clearAllPushList",value:function(){this.msgListToPush=[]}},{key:"closeMsgPushPop",value:function(e){var n,t;if(null!==(n=this.msgListToPush)&&void 0!==n&&n.length){var r=0;m()(this.msgListToPush,(function(n,t){(null==n?void 0:n.conversationId)===e&&(r=t)})),null===(t=this.msgListToPush)||void 0===t||y()(t).call(t,r,1)}}},{key:"setHasJoinGroup",value:function(e){this.hasJoinGroupObj=e}},{key:"setCanShowImPush",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this.canShowImPush=e}},{key:"setUserFollowStatusMap",value:function(e,n){e&&(this.userFollowStatusMap[e]=n)}},{key:"getUserInfoMapAsync",value:(P=(0,a.Z)(S().mark((function e(){var n,t=this,i=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&i[0]!==undefined?i[0]:[],e.abrupt("return",x().all(h()(n,function(){var e=(0,a.Z)(S().mark((function e(n){var a,i,s;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=8;break}return e.next=3,(0,ee.Z)((0,K.RK)(n));case 3:a=e.sent,(i=(0,r.Z)(a,2))[0],(s=i[1])&&t.setUserInfoFromServerMap([s]);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())));case 2:case"end":return e.stop()}}),e)}))),function(){return P.apply(this,arguments)})},{key:"getPatchUserInfoAsync",value:(b=(0,a.Z)(S().mark((function e(n){var t,r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===(t=this.uidSecUidMap)||void 0===t?void 0:t[n],e.abrupt("return",this.getUserInfoMapAsync([r]));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"getShareUserListAsync",value:(A=(0,a.Z)(S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return A.apply(this,arguments)})},{key:"getEmojiMaps",value:(k=(0,a.Z)(S().mark((function e(){var n,t,a,i;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H()(this.emojiMap).length>0){e.next=11;break}return e.next=4,(0,ee.Z)((0,B.zk)());case 4:if(n=e.sent,t=(0,r.Z)(n,2),a=t[0],i=t[1],!a){e.next=10;break}return e.abrupt("return");case 10:0===i.statusCode&&(this.emojiMap=i.data);case 11:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"getEmojiList",value:(R=(0,a.Z)(S().mark((function e(){var n,t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.emojiList.length>0)){e.next=4;break}return e.abrupt("return",this.emojiList);case 4:return e.next=6,(0,ee.Z)(this.getEmojiMaps());case 6:return t=[],D()(n=Y()(this.emojiMap)).call(n,(function(e){1!==e.hide&&t.push(e)})),this.emojiList=t,e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"getEmojiGifListAsync",value:(M=(0,a.Z)(S().mark((function e(){var n,t,a,i,s,o;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.emojiGifList)||void 0===n||!n.length){e.next=2;break}return e.abrupt("return",this.emojiGifList);case 2:return e.next=4,(0,ee.Z)((0,J.xD)({}));case 4:if(a=e.sent,i=(0,r.Z)(a,2),s=i[0],o=i[1],!s){e.next=10;break}return e.abrupt("return",[]);case 10:return this.emojiGifList=(null==o||null===(t=o.emoticon_data)||void 0===t?void 0:t.stickers)||[],e.abrupt("return",this.emojiGifList);case 12:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"getInteractiveEmojiListAsync",value:(T=(0,a.Z)(S().mark((function e(){var n,t,r,a;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.interactiveEmojiList)||void 0===n||!n.length){e.next=2;break}return e.abrupt("return",this.interactiveEmojiList);case 2:return e.next=4,(0,B.YX)();case 4:if(t=e.sent,r=t.statusCode,a=t.stickerList,0===r){e.next=9;break}return e.abrupt("return",[]);case 9:return this.interactiveEmojiList=a,e.abrupt("return",this.interactiveEmojiList);case 11:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"getCustomEmojiListAsync",value:(g=(0,a.Z)(S().mark((function e(){var n,t,r,a;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.customEmojiList)||void 0===n||!n.length){e.next=2;break}return e.abrupt("return",this.customEmojiList);case 2:return e.next=4,(0,B.Ol)();case 4:if(0===(a=e.sent).status_code){e.next=7;break}return e.abrupt("return",[]);case 7:return this.customEmojiList=(null===(t=a.custom_sticker_page_list)||void 0===t||null===(r=t.resources)||void 0===r?void 0:r[0].stickers)||[],e.abrupt("return",this.customEmojiList);case 9:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getRecentEmojiAsync",value:(I=(0,a.Z)(S().mark((function e(){var n,t,r,a=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&a[0]!==undefined&&a[0],null===(n=this.recentEmojiList)||void 0===n||!n.length||t){e.next=3;break}return e.abrupt("return",this.recentEmojiList);case 3:return e.next=5,(0,B.iT)(!1);case 5:if(0===(r=e.sent).status_code){e.next=8;break}return e.abrupt("return",this.recentEmojiList=[]);case 8:return this.recentEmojiList=r.sticker_list,e.abrupt("return",this.recentEmojiList);case 10:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"getRecentGifAsync",value:(E=(0,a.Z)(S().mark((function e(){var n,t,r,a=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&a[0]!==undefined&&a[0],null===(n=this.recentGifList)||void 0===n||!n.length||t){e.next=3;break}return e.abrupt("return",this.recentGifList);case 3:return e.next=5,(0,B.iT)(!0);case 5:if(0===(r=e.sent).status_code){e.next=8;break}return e.abrupt("return",this.recentGifList=[]);case 8:return this.recentGifList=r.sticker_list,e.abrupt("return",this.recentGifList);case 10:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"getShowSugEmoji",value:(f=(0,a.Z)(S().mark((function e(){var n,t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,B.nb)();case 2:n=e.sent,t=n.enable_rec_emoticon,0===n.status_code&&(this.showSugEmoji=Boolean(t));case 6:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"getUserSpotlightRelationAsync",value:(_=(0,a.Z)(S().mark((function e(){var n,t,a,i,s,o,u;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ee.Z)((0,K.v5)({}));case 2:if(t=e.sent,a=(0,r.Z)(t,2),i=a[0],s=a[1],!i){e.next=8;break}return e.abrupt("return",[]);case 8:return o=L()(n=(null==s?void 0:s.followings)||[]).call(n,(function(e,n){return null!=e&&e.follow_status?null!=n&&n.follow_status?n.follow_status-e.follow_status:-1:1})),this.setUserInfoForShareMap(o),u=[],m()(o,(function(e){var n=null==e?void 0:e.uid;"0"!==n&&u.push(n)})),this.allFriendsList=u,e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"setFollowUserAsync",value:(l=(0,a.Z)(S().mark((function e(n){var t,r=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>1&&r[1]!==undefined?r[1]:1,e.abrupt("return",(0,K.P_)(n,t));case 2:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"setUserBlockAsync",value:(t=(0,a.Z)(S().mark((function e(n,t,r,a){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,K.Ox)(n,t,r,a));case 1:case"end":return e.stop()}}),e)}))),function(e,n,r,a){return t.apply(this,arguments)})},{key:"pushNewMsgInList",value:(n=(0,a.Z)(S().mark((function e(n,t){var r,a,i,s,o,u,c,l,d,_,v,f,p;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&this.isLogin&&!this.showDlg&&this.canShowImPush){e.next=2;break}return e.abrupt("return");case 2:if(o=n.conversationId,u=n.type,c=n.createdAt,!(0,re.FH)(u)){e.next=5;break}return e.abrupt("return");case 5:if(!(new Date(c).getTime()+6e4<U()())){e.next=7;break}return e.abrupt("return");case 7:if(l=this.conversationInfoMap,d=null==l?void 0:l[o]){e.next=13;break}return e.next=12,(0,q.Z)(1500);case 12:d=t(o);case 13:if(null===(r=d)||void 0===r||null===(a=r.settingInfo)||void 0===a||!a.mute){e.next=15;break}return e.abrupt("return");case 15:_=((null===(i=this.msgListToPush)||void 0===i?void 0:i.length)||0)-1,v=null===(s=this.msgListToPush)||void 0===s?void 0:s[_],(f=null==v?void 0:v.conversationId)&&f===o?y()(p=this.msgListToPush).call(p,_,1,n):(this.msgListToPush=this.msgListToPush||[],this.msgListToPush.push(n));case 19:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"setDownloadInfo",value:function(e){this.downloadInfo=e}}]),e}(),le=new ce},73772:function(e,n,t){t.d(n,{M:function(){return c}});var r=t(19049),a=t(95508),i=t(65586).uZ,s=function(){var e;if(i){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];null===(e=console)||void 0===e||e.log.apply(e,t)}},o=function(){var e;if(i){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];null===(e=console)||void 0===e||e.warn.apply(e,t)}},u=function(){var e;if(i){s("-----\u9519\u8bef\u4fe1\u606f start-----");for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];null===(e=console)||void 0===e||e.error.apply(e,t),s("-----\u9519\u8bef\u4fe1\u606f  end -----")}},c=function(){function e(){(0,r.Z)(this,e)}return(0,a.Z)(e,null,[{key:"log",value:function(){s.apply(void 0,arguments)}},{key:"warn",value:function(){o.apply(void 0,arguments)}},{key:"error",value:function(){u.apply(void 0,arguments)}}]),e}();n.Z=c},84338:function(e,n,t){t.d(n,{N:function(){return M}});var r=t(30673),a=t(19049),i=t(95508),s=t(67026),o=t(53781),u=t(16019),c=t(75636),l=t(37326),d=t(19455),_=t.n(d),v=t(49188),f=t.n(v),p=t(8369),E=t.n(p),h=t(9942),I=t.n(h),m=t(15181),g=t.n(m),S=t(73772),T=new(I()),C=new(g()),M=function(){function e(){(0,a.Z)(this,e),(0,s.Z)(this,C),(0,o.Z)(this,T,{writable:!0,value:{}})}return(0,i.Z)(e,[{key:"on",value:function(e,n){var t=this,r=(0,l.Z)(this,T);r[e]=r[e]||[];var a=r[e];return this.hasOn(a,n)?null===S.Z||void 0===S.Z||S.Z.warn("".concat(e," \u4e8b\u4ef6\u548c\u6b64\u56de\u8c03\uff0c\u5df2\u7ecf\u901a\u8fc7on\u7ed1\u5b9a\u8fc7\uff0c\u91cd\u590d\u7ed1\u5b9a\u7ed1\u5b9a\u88ab\u5ffd\u7565")):a.push(n),function(){t.off(e,n)}}},{key:"once",value:function(e,n){var t=this;if(!this.hasOn(e,n)){return this.on(e,(function r(){n.apply(void 0,arguments),t.off(e,r)}))}return null===S.Z||void 0===S.Z||S.Z.warn("".concat(e," \u4e8b\u4ef6\u548c\u6b64\u56de\u8c03\uff0c\u5df2\u7ecf\u901a\u8fc7on\u7ed1\u5b9a\u8fc7\uff0conce\u7ed1\u5b9a\u88ab\u5ffd\u7565")),function(){}}},{key:"off",value:function(e,n){if(_()(e))(0,c.Z)(this,T,{});else{var t=(0,l.Z)(this,T);if(_()(n))t[e]=[];else{var r=t[e];if(null!=r&&r.length)for(var a=r.length,i=0;i<a;i++)if(r[i]===n)return void E()(r).call(r,i,1)}}}},{key:"emit",value:function(e){var n=(0,l.Z)(this,T)[e],t=null==n?void 0:n.length;if(t){for(var a=(0,r.Z)(n),i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];for(var u=0;u<t;u++)a[u].apply(this,s)}}},{key:"hasOn",value:function(e,n){return-1!==(0,u.Z)(this,C,O).call(this,e,n)}}]),e}();function O(e,n){var t,r=e;f()(e)&&(r=(0,l.Z)(this,T)[e]);if(null===(t=r)||void 0===t||!t.length)return-1;for(var a=r.length,i=0;i<a;i++)if(r[i]===n)return i;return-1}n.Z=M},53873:function(e,n,t){t.d(n,{F:function(){return r}});var r=function(e){var n="function"==typeof e?e():e;return null!=n&&n.then?n.then((function(e){return[null,e]})).catch((function(e){return[e||new Error("err"),undefined]})):[new Error("not promise or function"),undefined]};n.Z=r},70311:function(e,n,t){t.d(n,{p:function(){return d}});var r=t(32781),a=t(64408),i=t(5594),s=t.n(i),o=t(49418),u=t(53873),c=t(45690),l=t(94234),d=function(){var e=(0,a.Z)(s().mark((function e(n){var t,a,i,d,_,v,f,p,E,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",l.$u.FollowRelationUnknown);case 2:if(t=c.default.uidSecUidMap,!(null!=(a=c.default.userFollowStatusMap)&&a[n]||0===(null==a?void 0:a[n]))){e.next=5;break}return e.abrupt("return",null==a?void 0:a[n]);case 5:if(!(i=(null==t?void 0:t[n])||"")){e.next=19;break}return e.next=9,(0,u.Z)((0,o.RK)(i));case 9:if(d=e.sent,_=(0,r.Z)(d,2),v=_[0],f=_[1],!v){e.next=15;break}return e.abrupt("return",l.$u.FollowRelationUnknown);case 15:if(!f){e.next=19;break}return h=null!==(p=null==f?void 0:f.follow_status)&&void 0!==p?p:l.$u.FollowRelationUnknown,null===(E=c.default.setUserFollowStatusMap)||void 0===E||E.call(c.default,n,h),e.abrupt("return",h);case 19:return e.abrupt("return",l.$u.FollowRelationUnknown);case 20:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},14420:function(e,n,t){t.r(n),t.d(n,{IM_EVENT_NAMES:function(){return Je},ImSdk:function(){return qe}});var r,a,i,s,o=t(32781),u=t(64408),c=t(77007),l=t(30906),d=t(19049),_=t(95508),v=t(65146),f=t(34007),p=t(30673),E=t(94258),h=t.n(E),I=t(19478),m=t.n(I),g=t(5594),S=t.n(g),T=t(94090),C=t.n(T),M=t(11227),O=t.n(M),R=t(8e3),y=t.n(R),k=t(34346),N=t.n(k),A=t(56442),L=t.n(A),b=t(19672),w=t.n(b),P=t(68493),U=t.n(P),G=t(21155),D=t.n(G),Z=t(42249),x=t.n(Z),F=t(69071),H=t(26276),V=t(638),Y=t(77166),W=t(29938),j=t(32137),B=t(64595),K=t(77062),J=t(75303),X=t(62586),$=t(17028),Q=t(27769),q=t(3539),z=t(9267),ee=t.n(z),ne=t(68595),te=t.n(ne),re=t(66453),ae=t(18015),ie=t(13971),se=t(51365),oe=t(5611),ue=t(71116),ce=t(97876),le=t(353),de=t(65586),_e=t(49137),ve=t(84338),fe={disableInitPull:!1,appId:6383,userId:"",deviceId:"",boe:!0,debug:!0,apiUrl:"http://".concat("imapi-boe",".douyin.com"),frontierUrl:"ws://frontier-boe.douyin.com/ws/v2",token:"",authType:F.m.AuthType.SESSION_AUTH,devicePlatform:"douyin_pc",appKey:"e1bd35ec9db7b8d846de66ed140b1ad9",service:5,fpId:9,withCredentials:!0,inboxType:0,timeout:6e3,acceptIncorrectInboxType:!0,biz:"douyin_web",disablePullIntervalWhenWsIsOnline:!0,triggerPullWhenReceiveEmptyContent:!0},pe=t(6670),Ee=t(78034),he=t(65066),Ie=t(25674),me=function(e){(0,pe.Z)(r,e);var n,t=(0,Ee.Z)(r);function r(){return(0,d.Z)(this,r),t.apply(this,arguments)}return(0,_.Z)(r,[{key:"process",value:(n=(0,u.Z)(S().mark((function e(n){var t,r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==n||null===(t=n.data)||void 0===t?void 0:t.type,(0,Ie.FH)(r)){e.next=3;break}return e.abrupt("return",n);case 3:return n.needContinue=!1,n.data=null,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),r}(he.f),ge=t(17390),Se=t(22912),Te=function(e){(0,pe.Z)(r,e);var n,t=(0,Ee.Z)(r);function r(){return(0,d.Z)(this,r),t.apply(this,arguments)}return(0,_.Z)(r,[{key:"install",value:function(){}},{key:"sendPacket",value:(n=(0,u.Z)(S().mark((function e(n){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fillTtWidParam(n),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fillTtWidParam",value:function(e){var n={};try{var t=(0,Se.getSharkCommonParams)({});n.deviceId="0",n.session_did="0",n.webid=t.webid,n.fp=t.fp}catch(r){}e.device_id="0",e.headers=(0,l.Z)((0,l.Z)({},e.headers),n)}}]),r}(ge.v),Ce=t(34590),Me=t(56912),Oe=t(33200),Re=t(94234),ye=t(70311),ke=t(53873),Ne=t(65695),Ae=t(45690),Le=t(92582),be=t(32744),we=F.m.ConversationType,Pe=we.GROUP_CHAT,Ue=we.ONE_TO_ONE_CHAT,Ge=function(){var e=(0,u.Z)(S().mark((function e(n){var t,r,a,i,s,o,u,c,l,d,_;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.conversationType,r=n.isFromMe,a=n.conversationId,i=Ae.default.curConversation,s=(i||{}).toParticipantUserId,o=void 0===s?"":s,u=t===Pe?Re.eD.GROUP:Re.eD.PRIVATE,c=r?Re.IM.ISME:Re.IM.NOISME,l=(0,be.GM)(n),d={chat_type:u,is_self:c,message_type:l,conversation_id:a},t!==Ue||!o){e.next=13;break}return e.next=11,(0,ye.p)(o);case 11:_=e.sent,d.personal_relation=String(_);case 13:return e.abrupt("return",d);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),De=t(53781),Ze=t(37326),xe=t(9942),Fe=new(t.n(xe)()),He=function(){function e(){(0,d.Z)(this,e),(0,De.Z)(this,Fe,{writable:!0,value:[]})}return(0,_.Z)(e,[{key:"add",value:function(){var e;return(0,Ze.Z)(this,Fe).push(new(U())((function(n){e=n}))),e}},{key:"run",value:function(e){return U().all((0,Ze.Z)(this,Fe)).then((function(n){null==e||e(n)}))}}]),e}(),Ve=t(73772),Ye=t(70961),We=(de.uZ,F.m.ConversationType),je=We.GROUP_CHAT,Be=We.ONE_TO_ONE_CHAT,Ke=new ve.Z,Je=function(e){return e.IM_SEND_MSG="IM_SEND_MSG",e.IM_DELETE_CONVERSATION="IM_DELETE_CONVERSATION",e.IM_VIDEO_MSG_RECALLED="IM_VIDEO_MSG_RECALLED",e}({}),Xe={event:function(e,n){var t,r;null===(t=(r=window).collectEvent)||void 0===t||t.call(r,e,n)}},$e={disableInitPull:!1,appId:6383,appKey:"e1bd35ec9db7b8d846de66ed140b1ad9",userId:"",deviceId:"",service:5,debug:Boolean((0,ie.$o)(le.LocalStorageKeys.ImOptionDebug)),apiUrl:"https://imapi.douyin.com",frontierUrl:"wss://frontier-im.douyin.com/ws/v2",authType:F.m.AuthType.SESSION_AUTH,token:"",fpId:9,withCredentials:!0,inboxType:1,devicePlatform:"douyin_pc",timeout:6e3,acceptIncorrectInboxType:!0,sharkAppName:"douyin_pc",sharkPriorityRegion:"cn",biz:"douyin_web",monitor:C()(r=[]).call(r,(0,p.Z)(se.oe.getSlardarInstance()?[new H.a(se.oe.getSlardarInstance())]:[]),[new V.Cu(Xe,{metricsToReport:C()(a=[]).call(a,(0,p.Z)(V.Dp),[(0,V.af)(Y.U.BizSdkInit+Y.U.SuccessSuffix)])})]),ppe:null!==(i=(0,ie.$o)(le.LocalStorageKeys.ImOptionPPE))&&void 0!==i?i:undefined,webSocketLevel:(0,ie.$o)(le.LocalStorageKeys.ImOptionDisableWS)?W._.Disable:W._.PushOnly,useBadgeCountForUnread:!0,unreadCountReport:!0,disablePullIntervalWhenWsIsOnline:!0,triggerPullWhenReceiveEmptyContent:!0},Qe=[j.D,B.l,K.v,Te,J.b,X.n],qe=function(){function e(){(0,d.Z)(this,e)}var n,t,r,a,i,s,v,p,E,I,m,g,T,M,R,k,A,b;return(0,_.Z)(e,null,[{key:"tryStart",value:function(n,t,r){Ve.Z.warn("\u767b\u5f55\u7528\u6237\u4fe1\u606f",t);var a=(t||{}).uid,i=e.bytedIMInstance;return Ae.default.setIsLogin(n),n?i||e.init({userId:a,deviceId:a,pullInterval:r.pullInterval},!0===de.uZ):i&&e.destroy(),e.bytedIMInstance}},{key:"init",value:function(n){var t,r=arguments.length>1&&arguments[1]!==undefined&&arguments[1]?(0,l.Z)((0,l.Z)({},fe),n):(0,l.Z)((0,l.Z)({},$e),n);Ve.Z.warn("IM \u521d\u59cb\u5316\u53c2\u6570",r),t=location.host,/live.douyin.com/.test(t)||(r.authType=F.m.AuthType.PASSPORT_CERT_AUTH,r.securityScene="web_protect",r.securityCertType="cookie",Qe.push($.f));var a=new Q.A(r,Qe);return e.bytedIMInstance=a,a.resolve(q.Uk.MessageManager).processors.unshift(new me(a.ctx)),a.init().then((function(){e.getStrangerConversationPreview(),e.getAllUserConversation(!0)})),Ve.Z.warn("IM \u5b9e\u4f8b",a),e.listenEvents(),Ae.default.getEmojiList(),Ae.default.getEmojiGifListAsync(),(Ae.default.abTestData||{}).showCustomEmoji&&(Ae.default.getShowSugEmoji(),Ae.default.getCustomEmojiListAsync(),Ae.default.getRecentEmojiAsync(),Ae.default.getRecentGifAsync(),Ae.default.getInteractiveEmojiListAsync()),Ae.default.getUserSpotlightRelationAsync(),a}},{key:"destroy",value:function(){var n;e.imEvents(),null===(n=e.bytedIMInstance)||void 0===n||n.dispose(),e.bytedIMInstance=null}},{key:"onEvent",value:function(e,n){return Ke.on(e,n)}},{key:"emitEvent",value:function(e){for(var n,t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];Ke.emit.apply(Ke,C()(n=[e]).call(n,r))}},{key:"offEvent",value:function(e,n){Ke.off(e,n)}},{key:"checkAndReportReadIndexGreater",value:function(n){var t,r=(0,c.Z)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=a.readIndex,s=a.lastMessageIndex;if(i&&null!=s&&s.greaterThan(0)&&i.sub(s).greaterThanOrEqual(1e4)){var o=a.shortId;if(e.reportedReadIndexGreater.has(o))continue;(0,Le.Gb)("imsdk_debug_read_index_greater",{conversation_type:a.type,index_distance:i.sub(s).toNumber(),conversation_id:a.id,conversation_short_id:o,conversation_read_index:i.toString(),message_index_in_conversation:s.toString(),user_id:a.ctx.option.userId,debug_version:"2"}),e.reportedReadIndexGreater.add(o)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateIsStrangerConver",value:function(){var e,n=((null===Ae.default||void 0===Ae.default?void 0:Ae.default.curConversation)||{}).id,t=null===Ae.default||void 0===Ae.default||null===(e=Ae.default.conversationMap)||void 0===e?void 0:e[n],r=null==t?void 0:t.isStrangerConversation;Ae.default.setIsStrangerConversation(r)}},{key:"setCurConversation",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(Ae.default.setCurConverSation(n),n){var t=Ae.default.isStrangerConversation;void 0!==t&&t?e.strangerMessageUpsert():e.messageUpsert()}else Ae.default.setCurMessageList([])}},{key:"listenEvents",value:function(){var n=this,t=e.bytedIMInstance;if(t){var r=null==t?void 0:t.event,a=r.subscribe(W.c5.ConversationChange,(function(){e.conversationChange(),e.unreadCountReport()})),i=r.subscribe(W.c5.MessageUpsert,(function(n){if(n&&n.type===Oe.pp.GROUP_NOTICE_MESSAGE){var t=Ae.default.curConversation;t&&e.getMoreParticipants({conversation:t})}e.messageUpsert()})),s=r.subscribe(W.c5.ReceiveNewMessage,(function(t){Ve.Z.warn("ReceiveNewMessage",t),Ae.default.pushNewMsgInList(t,(function(n){return e.getConversationById(n)})),n.syncToTray()})),o=r.subscribe(W.c5.MessageRecall,(function(n){Ve.Z.warn("MessageRecall",n);var t=Ae.default.curConversation,r=n.conversationId,a=n.type;(null==t?void 0:t.id)===r&&null!==Oe.ds&&void 0!==Oe.ds&&O()(Oe.ds).call(Oe.ds,a)&&e.emitEvent(Je.IM_VIDEO_MSG_RECALLED,n)})),u=r.subscribe(W.c5.InitFinish,(function(){e.checkClientPush()}));e.imEvents=function(){r.unsubscribe(W.c5.MessageUpsert,i),r.unsubscribe(W.c5.ConversationChange,a),r.unsubscribe(W.c5.ReceiveNewMessage,s),r.unsubscribe(W.c5.InitFinish,u),r.unsubscribe(W.c5.MessageRecall,o)}}}},{key:"syncToTray",value:function(){(0,oe.DT)()&&te().app.isTopWebview().then((function(e){var n,t,r;e.data&&re.a.setImConvUnreadData({message:y()(n=N()(t=(null===(r=Ae.default.conversationListFilter)||void 0===r?void 0:L()(r).call(r))||[]).call(t,(function(e){var n,t,r=e;if(!r.unreadCount||r.isMuted||!r.lastMessage)return null;var a=(0,Ye.v)(r);return{conversation_name:a.title,unread_count:r.unreadCount,conversation_id:r.shortId,last_message_time:r.lastMessage.createdAt?Number(r.lastMessage.createdAt):0,last_message_id:r.lastMessage.serverId,avatar_url:null!==(n=w()(a.headIcon)?a.headIcon[0]:a.headIcon)&&void 0!==n?n:"",type:r.type,open_url:C()(t="sslocal://chat/center?conv_short_id=".concat(r.shortId,"&conversation_id=")).call(t,r.id),is_stick_on_top:r.isStickOnTop}}))).call(n,(function(e){return Boolean(e)}))})}))}},{key:"setConversationSettingInfo",value:function(n,t){var r=e.bytedIMInstance;null==r||r.setConversationSettingInfo((0,l.Z)({conversation:n},t))}},{key:"handleDeleteConversation",value:(b=(0,u.Z)(S().mark((function n(t){var r,a,i=arguments;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=i.length>1&&i[1]!==undefined?i[1]:0,a=i.length>2&&i[2]!==undefined?i[2]:function(){},e.emitEvent(Je.IM_DELETE_CONVERSATION,t),!r){n.next=6;break}return n.next=6,(0,Ne.Z)(r);case 6:null==a||a();case 7:case"end":return n.stop()}}),n)}))),function(e){return b.apply(this,arguments)})},{key:"deleteConversation",value:function(n){if(n){var t=e.bytedIMInstance;null==t||t.deleteConversation({conversation:n}),null===Ae.default||void 0===Ae.default||Ae.default.setCurConverSation()}}},{key:"deleteStrangerConversation",value:(A=(0,u.Z)(S().mark((function n(t,r){var a,i,s,u;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:return a=e.bytedIMInstance,n.next=5,(0,ke.F)(null==a?void 0:a.deleteStrangerConversation({conversation:t}));case 5:if(i=n.sent,s=(0,o.Z)(i,2),u=s[0],s[1],!u){n.next=11;break}return n.abrupt("return");case 11:null==r||r(),null===Ae.default||void 0===Ae.default||Ae.default.setCurConverSation();case 13:case"end":return n.stop()}}),n)}))),function(e,n){return A.apply(this,arguments)})},{key:"deleteAllStrangerConversation",value:function(){var n=e.bytedIMInstance;null==n||n.deleteAllStrangerConversation(),null===Ae.default||void 0===Ae.default||Ae.default.setCurConverSation(),null===Ae.default||void 0===Ae.default||Ae.default.setIsInStrangerConversationList(!1)}},{key:"getConversationWithUid",value:(k=(0,u.Z)(S().mark((function n(t){var r,a,i,s,u,c,l,d,_,v,f,p;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:if(r=e.bytedIMInstance){n.next=5;break}return n.abrupt("return");case 5:if(a=r.getConversationList(),i={},h()(a,(function(e){e.id;var n=e.type,t=e.toParticipantUserId;n===Be&&t&&(i[t]=e)})),s=null==i?void 0:i[t]){n.next=21;break}return n.next=12,(0,ke.F)(r.createConversation({type:Be,participants:t,inboxType:0}));case 12:if(c=n.sent,l=(0,o.Z)(c,2),d=l[0],_=l[1],!d){n.next=18;break}return n.abrupt("return");case 18:v=_.statusCode,f=_.body,p=null==f||null===(u=f.conversation)||void 0===u?void 0:u.conversation_id,0===v&&p&&(s=r.getConversation({conversationId:p}));case 21:return n.abrupt("return",s);case 22:case"end":return n.stop()}}),n)}))),function(e){return k.apply(this,arguments)})},{key:"getAllUserConversation",value:(R=(0,u.Z)(S().mark((function n(){var t,r,a,i,s,u,c,d,_,v,f,p,E,h,I,m,g,T=arguments;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=T.length>0&&T[0]!==undefined&&T[0],r=Ae.default.hasJoinGroupObj,!(a=r).loading){n.next=5;break}return n.abrupt("return");case 5:if(t&&(i={conversation:[],cursor:"0",hasMore:!0,loading:!1},Ae.default.setHasJoinGroup(i),a=i),Ae.default.setHasJoinGroup((0,l.Z)((0,l.Z)({},a),{},{loading:!0})),u=(s=a).cursor,!s.hasMore){n.next=23;break}return d=e.bytedIMInstance,n.next=12,(0,ke.F)(null==d?void 0:d.getUserConversationList({type:je,inboxType:0,limit:10,sortType:1,cursor:u}));case 12:if(_=n.sent,v=(0,o.Z)(_,2),f=v[0],p=v[1],Ve.Z.warn("getAllUserConversation",f,p),!f){n.next=20;break}return Ae.default.setHasJoinGroup((0,l.Z)((0,l.Z)({},a),{},{loading:!1})),n.abrupt("return");case 20:h=(E=p||{}).conversation,I=E.cursor,m=E.hasMore,g=null===(c=a.conversation)||void 0===c?void 0:C()(c).call(c,h),Ae.default.setHasJoinGroup({conversation:g,cursor:ee().fromValue(I).toString(),hasMore:m,loading:!1});case 23:case"end":return n.stop()}}),n)}))),function(){return R.apply(this,arguments)})},{key:"sendMessage",value:(M=(0,u.Z)(S().mark((function n(t,r){var a,i,s,u,c;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.bytedIMInstance,i=null===Ae.default||void 0===Ae.default?void 0:Ae.default.curConversation,a&&i){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,(0,ke.F)((0,f.Z)(e,e,an).call(e,i,t));case 6:return s=n.sent,(u=(0,o.Z)(s,2))[0],c=u[1],n.next=12,(0,f.Z)(this,e,tn).call(this,c,r);case 12:return n.abrupt("return",c);case 13:case"end":return n.stop()}}),n,this)}))),function(e,n){return M.apply(this,arguments)})},{key:"resendMessage",value:function(n,t){return(0,f.Z)(this,e,tn).call(this,n,t)}},{key:"getConversationById",value:function(n){var t=e.bytedIMInstance,r=null;try{var a;r=null===(a=t.getConversationList({filter:function(e){return e.id===n||e.shortId===n}}))||void 0===a?void 0:a[0]}catch(o){var i,s;se.oe.captureException("IM",o,{conversationId:n,userId:t.option.userId,conversationCount:String(null===(i=null!==(s=t.getConversationList())&&void 0!==s?s:[])||void 0===i?void 0:i.length)})}return r}},{key:"sendUserMsg",value:(T=(0,u.Z)(S().mark((function n(t,r,a){var i,s,u,c,d,_,v,p,E=this;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=null==t?void 0:t.length){n.next=3;break}return n.abrupt("return");case 3:s=e.bytedIMInstance,u=s.getConversationList(),c={},h()(u,(function(e){e.id;var n=e.type,t=e.toParticipantUserId;n===Be&&t&&(c[t]=e)})),d=new He,_=new He,v=S().mark((function n(){var i,u,v,h,I,m,g,T,C,M,O,R,y,k,N,A,L;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t[p],(u=null==c?void 0:c[i])||!i){n.next=14;break}return n.next=5,(0,ke.F)(s.createConversation({type:Be,participants:i,inboxType:0}));case 5:if(h=n.sent,I=(0,o.Z)(h,2),m=I[0],g=I[1],!m){n.next=11;break}return n.abrupt("return","continue");case 11:T=g.statusCode,C=g.body,M=null==C||null===(v=C.conversation)||void 0===v?void 0:v.conversation_id,0===T&&M&&(u=s.getConversation({conversationId:M}));case 14:if(!u){n.next=29;break}return n.next=17,(0,ke.F)((0,f.Z)(e,e,an).call(e,u,r));case 17:if(O=n.sent,(R=(0,o.Z)(O,2))[0],y=R[1]){n.next=23;break}return n.abrupt("return","continue");case 23:return k=d.add(),N=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];k(n)},A=_.add(),L=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];A(n)},n.next=29,(0,f.Z)(E,e,tn).call(E,y,(0,l.Z)((0,l.Z)({},a),{},{beforeSend:N,afterSend:L}));case 29:case"end":return n.stop()}}),n)})),p=0;case 11:if(!(p<i)){n.next=19;break}return n.delegateYield(v(),"t0",13);case 13:if("continue"!==n.t0){n.next=16;break}return n.abrupt("continue",16);case 16:p++,n.next=11;break;case 19:d.run(null==a?void 0:a.beforeSend),_.run(null==a?void 0:a.afterSend);case 21:case"end":return n.stop()}}),n)}))),function(e,n,t){return T.apply(this,arguments)})},{key:"sendGroupMsg",value:(g=(0,u.Z)(S().mark((function n(t,r,a){var i,s,u,c,d,_,v,p=this;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=null==t?void 0:t.length){n.next=3;break}return n.abrupt("return");case 3:s=null===Ae.default||void 0===Ae.default?void 0:Ae.default.conversationInfoMap,u=new He,c=new He,d=e.bytedIMInstance,_=S().mark((function n(){var i,_,E,h,I,m,g,T,C,M,O,R,y,k;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t[v],_=null==s?void 0:s[i]){n.next=11;break}return E={conversationId:i,shortId:i,type:je},n.next=6,(0,ke.F)(d.getConversationOnline(E));case 6:h=n.sent,I=(0,o.Z)(h,2),m=I[0],g=I[1],!m&&g&&(_=g);case 11:if(!_){n.next=25;break}return n.next=14,(0,ke.F)((0,f.Z)(e,e,an).call(e,_,r));case 14:if(T=n.sent,(C=(0,o.Z)(T,2))[0],!(M=C[1])){n.next=25;break}return O=u.add(),R=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];O(n)},y=c.add(),k=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];y(n)},n.next=25,(0,f.Z)(p,e,tn).call(p,M,(0,l.Z)((0,l.Z)({},a),{},{beforeSend:R,afterSend:k}));case 25:case"end":return n.stop()}}),n)})),v=0;case 9:if(!(v<i)){n.next=14;break}return n.delegateYield(_(),"t0",11);case 11:v++,n.next=9;break;case 14:u.run(null==a?void 0:a.beforeSend),c.run(null==a?void 0:a.afterSend);case 16:case"end":return n.stop()}}),n)}))),function(e,n,t){return g.apply(this,arguments)})},{key:"getIdConverMap",value:(m=(0,u.Z)(S().mark((function n(t){var r,a,i,s,u,c,l,d,_,v,f,p,E,I,m,g;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=e.bytedIMInstance,a=r.getConversationList(),i={},s={},h()(a,(function(e){var n=e.id,t=e.type,r=e.toParticipantUserId;t===Be&&r?i[r]=e:t===je&&(s[n]=e)})),u=t.length,c=0;case 7:if(!(c<u)){n.next=24;break}if(l=t[c],d=l.uid,l.type!==Be||!d||i[d]){n.next=21;break}return n.next=12,(0,ke.F)(r.createConversation({type:Be,participants:d,inboxType:0}));case 12:if(v=n.sent,f=(0,o.Z)(v,2),p=f[0],E=f[1],!p){n.next=18;break}return n.abrupt("continue",21);case 18:I=E.statusCode,m=E.body,g=null==m||null===(_=m.conversation)||void 0===_?void 0:_.conversation_id,0===I&&g&&(i[d]=r.getConversation({conversationId:g}));case 21:c++,n.next=7;break;case 24:return n.abrupt("return",{converPrevOne2OneMap:i,converPrevGroupMap:s});case 25:case"end":return n.stop()}}),n)}))),function(e){return m.apply(this,arguments)})},{key:"sendUserAndGroupMsg",value:(I=(0,u.Z)(S().mark((function n(t,r,a){var i,s,u,c,d,_,v,p,E,h,I,m=this;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=null==t?void 0:t.length){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,(0,ke.F)(e.getIdConverMap(t));case 5:if(s=n.sent,u=(0,o.Z)(s,2),c=u[0],d=u[1],!c){n.next=11;break}return n.abrupt("return");case 11:_=d.converPrevOne2OneMap,v=d.converPrevGroupMap,p=new He,E=new He,h=S().mark((function n(){var i,s,u,c,d,h,g,T,C,M,O;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t[I],s=i.uid,u=i.type,!(c=u===Be?_[s]:v[s])){n.next=17;break}return n.next=5,(0,ke.F)((0,f.Z)(e,e,an).call(e,c,r));case 5:if(d=n.sent,(h=(0,o.Z)(d,2))[0],g=h[1]){n.next=11;break}return n.abrupt("return","continue");case 11:return T=p.add(),C=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];T(n)},M=E.add(),O=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];M(n)},n.next=17,(0,f.Z)(m,e,tn).call(m,g,(0,l.Z)((0,l.Z)({},a),{},{beforeSend:C,afterSend:O}));case 17:case"end":return n.stop()}}),n)})),I=0;case 16:if(!(I<i)){n.next=24;break}return n.delegateYield(h(),"t0",18);case 18:if("continue"!==n.t0){n.next=21;break}return n.abrupt("continue",21);case 21:I++,n.next=16;break;case 24:p.run(null==a?void 0:a.beforeSend),E.run(null==a?void 0:a.afterSend);case 26:case"end":return n.stop()}}),n)}))),function(e,n,t){return I.apply(this,arguments)})},{key:"recallMessage",value:(E=(0,u.Z)(S().mark((function n(t){var r;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.bytedIMInstance,n.abrupt("return",null==r?void 0:r.recallMessage({message:t}));case 2:case"end":return n.stop()}}),n)}))),function(e){return E.apply(this,arguments)})},{key:"deleteMessage",value:function(n){var t=e.bytedIMInstance;return null==t?void 0:t.deleteMessage({message:n})}},{key:"setLikeMsg",value:(p=(0,u.Z)(S().mark((function n(t,r,a){var i;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ge(t);case 2:return(i=n.sent).action=a?"cancel":"like",(0,Le.Gb)("like_message",i),n.abrupt("return",(0,f.Z)(this,e,sn).call(this,t,(0,l.Z)((0,l.Z)({},Me.r9.LOVE),{},{operation:F.m.OPERATION_TYPE.ADD_PROPERTY_ITEM},r)));case 6:case"end":return n.stop()}}),n,this)}))),function(e,n,t){return p.apply(this,arguments)})},{key:"getMoreMessage",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:50,r=e.bytedIMInstance,a=Ae.default.messageList,i=null==a?void 0:a[0];return i?r.getMessagesByConversation({conversation:n,cursor:i,limit:t}).then((function(n){return e.messageUpsert(),n})):U().resolve({messages:[],hasMore:!1,cursor:0})}},{key:"getConversationParticipants",value:function(n){var t=e.bytedIMInstance.getConversationParticipants({conversation:n});return(0,f.Z)(this,e,on).call(this,null==n?void 0:n.id,t),t}},{key:"getMoreParticipants",value:function(n){var t=this;return e.bytedIMInstance.getConversationParticipantsAsync((0,l.Z)({},n)).then((function(r){var a;return(0,f.Z)(t,e,on).call(t,null===(a=n.conversation)||void 0===a?void 0:a.id,r),r})).catch((function(){return[]}))}},{key:"leaveConversation",value:(v=(0,u.Z)(S().mark((function n(t){var r;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.bytedIMInstance,n.next=3,r.leaveConversation({conversation:t});case 3:return n.next=5,r.deleteConversation({conversation:t});case 5:null===Ae.default||void 0===Ae.default||Ae.default.setCurConverSation();case 6:case"end":return n.stop()}}),n)}))),function(e){return v.apply(this,arguments)})},{key:"dissolveConversation",value:(s=(0,u.Z)(S().mark((function n(t){var r;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.bytedIMInstance,n.next=3,r.dissolveConversation({conversation:t});case 3:return n.next=5,r.deleteConversation({conversation:t});case 5:null===Ae.default||void 0===Ae.default||Ae.default.setCurConverSation();case 6:case"end":return n.stop()}}),n)}))),function(e){return s.apply(this,arguments)})},{key:"getAllUserFromServer",value:function(){var n=(0,f.Z)(this,e,un).call(this);return Ae.default.getUserInfoMapAsync(n)}},{key:"getAllStrangerFromServer",value:function(){var n=(0,f.Z)(this,e,cn).call(this);return Ae.default.getUserInfoMapAsync(n)}},{key:"getStrangerFromServerWithConver",value:function(n){var t=Ae.default.userInfoFromServerMap,r=Ae.default.curUserInfo.uid,a=n||{},i=a.id,s=void 0===i?"":i,o=a.firstPageParticipant,u=void 0===o?[]:o,c=a.participants,l=null==t?void 0:t[s],d=c||(null==u?void 0:u.participants)||[];if((0,f.Z)(this,e,on).call(this,s,d),!l){var _=[];D()(d).call(d,(function(e){var n=e.userId,t=e.secUid,a=e.user_id,i=e.sec_uid;(n||ee().fromValue(a).toString())!==r&&_.push(t||i)})),Ae.default.getUserInfoMapAsync(_)}}},{key:"markConversationRead",value:(i=(0,u.Z)(S().mark((function n(t){var r,a,i,s,o,u,c,l,d,_=arguments;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=_.length>1&&_[1]!==undefined&&_[1],a=_.length>2&&_[2]!==undefined&&_[2],s=(i=t||{}).indexInConversation,o=void 0===s?"":s,u=i.conversationId,c=e.bytedIMInstance,l=null,n.prev=5,l=c.getConversation({conversationId:u}),n.next=12;break;case 9:return n.prev=9,n.t0=n.catch(5),n.abrupt("return");case 12:if(l){n.next=14;break}return n.abrupt("return");case 14:if(!a){n.next=17;break}return l.settingInfo._readIndex=ee().ZERO,n.abrupt("return",c.markConversationRead({conversation:l}));case 17:o&&l&&(r?c.markStrangerConversationRead({conversation:l}):null!==(d=l.lastMessageIndex)&&void 0!==d&&d.eq(o)?c.markConversationRead({conversation:l,force:!0}):c.markConversationRead({conversation:l,readIndex:o}));case 18:case"end":return n.stop()}}),n,null,[[5,9]])}))),function(e){return i.apply(this,arguments)})},{key:"markAllStrangerConversationRead",value:(a=(0,u.Z)(S().mark((function n(){var t;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.bytedIMInstance,n.abrupt("return",t.markAllStrangerConversationRead());case 2:case"end":return n.stop()}}),n)}))),function(){return a.apply(this,arguments)})},{key:"getMessgeByServerId",value:(r=(0,u.Z)(S().mark((function n(t){var r,a,i;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.conversation,a=t.serverMessageId,i=e.bytedIMInstance,n.abrupt("return",i.getMessageByServerId({conversation:r,serverMessageId:a}));case 3:case"end":return n.stop()}}),n)}))),function(e){return r.apply(this,arguments)})},{key:"checkClientPush",value:function(){var e=ue.Le.getConfig(ue.gI.IMStatusStore)||{},n=e.conversationId,t=e.userId;n&&ce.emit(ce.EVENT.openImConversation,{conversationId:n,enterMethod:Re.eY.CLIENT_PUSH}),t&&ce.emit(ce.EVENT.sendImUserMsg,{uid:t,enterMethod:Re.eY.CLIENT_PUSH})}},{key:"isFromGroupOwner",value:(t=(0,u.Z)(S().mark((function n(t){var r,a,i,s,o,u;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",!1);case 2:if(r=e.bytedIMInstance,a=t.conversationId,i=t.sender){n.next=6;break}return n.abrupt("return",!1);case 6:if(s=r.getConversation({conversationId:a})){n.next=9;break}return n.abrupt("return",!1);case 9:if(o=s.type,u=s.coreInfo,o===je){n.next=12;break}return n.abrupt("return",!1);case 12:return n.abrupt("return",(null==u?void 0:u.owner)===i);case 13:case"end":return n.stop()}}),n)}))),function(e){return t.apply(this,arguments)})},{key:"getMoreVideoInMsg",value:(n=(0,u.Z)(S().mark((function n(){var t,r,a,i,s,u,c,l,d,_,v,f;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=Ae.default.curConversation,null!==Ae.default&&void 0!==Ae.default&&Ae.default.curMsgOptPopId&&Ae.default.setCurMsgOptPopId(),r=[],a=[],!t){n.next=16;break}return n.next=7,(0,ke.F)(e.getMoreMessage(t));case 7:if(i=n.sent,s=(0,o.Z)(i,2),u=s[0],c=s[1],!u){n.next=13;break}return n.abrupt("return",{hasMore:!0,awemeIds:r,videoMsgList:a});case 13:return d=(l=c||{}).hasMore,_=void 0===d||d,v=l.messages,f=void 0===v?[]:v,h()(f,(function(e){var n=e.type,t=e.isRecalled,i=e.clientId;if(!t&&null!==Oe.ds&&void 0!==Oe.ds&&O()(Oe.ds).call(Oe.ds,n)){var s=(0,Ie.t$)(e)||{},o=s.itemId,u=s.item_id,c=null!=o?o:u;c&&(r.push(c),a.push({awemeId:c,msgClientId:i}))}})),n.abrupt("return",{hasMore:_,awemeIds:r,videoMsgList:a});case 16:return n.abrupt("return",{hasMore:!0,awemeIds:r,videoMsgList:a});case 17:case"end":return n.stop()}}),n)}))),function(){return n.apply(this,arguments)})},{key:"upsertConversationSettingExtInfo",value:function(n,t){var r=e.bytedIMInstance;null==r||r.upsertConversationSettingExtInfo((0,l.Z)({conversation:n},t))}}]),e}();function ze(e,n,t){return en.apply(this,arguments)}function en(){return en=(0,u.Z)(S().mark((function e(n,t,r){var a,i,s,o,u,c,l,d,_,v,f,p,E=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=E.length>3&&E[3]!==undefined?E[3]:"",s=t.conversationId,o=t.conversationType,u=t.referenceInfo,c=t.mentionedUsers,l=t.type,d=Ae.default.isOpenMessageList,n){e.next=5;break}return e.abrupt("return");case 5:if(_=n.toParticipantUserId,o!==Be){e.next=12;break}return e.next=9,(0,ye.p)(_);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=Re.$u.FollowRelationUnknown;case 13:v=e.t0,u&&(f={conversation_id:s,chat_type:be.n0[o],message_type:r},o===Be&&(f.personal_relation=String(v)),(0,Le.Gb)("quote_message",f)),c&&c.length>0&&(0,Le.Gb)("send_at_message",{conversation_id:s}),(p={conversation_id:s,chat_type:be.n0[o],to_user_id:_||"",message_type:r,real_message_type:l,enter_method:be.QX[i],online_status:null===(a=_e.m.statusStore[Ae.default.uidSecUidMap[_]])||void 0===a?void 0:a.lastActiveLogValue}).is_fold=Number(!d),o===Be&&(p.personal_relation=String(v)),(0,Le.Gb)("send_message",p);case 20:case"end":return e.stop()}}),e)}))),en.apply(this,arguments)}function nn(e,n,t,r){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:"",i=n.conversationId,s=n.conversationType,o=n.type,u=n.serverId,c=n.mentionedUsers;if(e&&r){var l=e.toParticipantUserId,d=r.statusCode,_=r.success;c&&c.length>0&&(0,Le.Gb)("send_at_message_response",{conversation_id:i}),(0,Le.Gb)("send_message_response",{conversation_id:i,chat_type:be.n0[s],to_user_id:l||"",message_type:t,real_message_type:o,send_status:_?"success":"failure",status_code:"".concat(d),messgae_id:u||"",enter_method:be.QX[a]})}}function tn(e,n){return rn.apply(this,arguments)}function rn(){return(rn=(0,u.Z)(S().mark((function e(n,t){var r,a,i,o,u,c,l,d,_,v,p,E,h,I;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.beforeSend,a=void 0===r?function(){}:r,i=t.afterSend,o=void 0===i?function(){}:i,u=t.enter_method,c=void 0===u?"":u,l=t.retrying,d=void 0!==l&&l,!n){e.next=37;break}return _=n.conversationId,v=s.bytedIMInstance,p=v.getConversation({conversationId:_}),E=(0,be.GM)(n),(0,f.Z)(s,s,ze).call(s,p,n,E,c),null==a||a(n),e.next=10,v.sendMessage({message:n});case 10:if(h=e.sent,!d){e.next=13;break}return e.abrupt("return",h);case 13:if(3!==h.body.status){e.next=33;break}if(e.prev=14,7396!==(I=JSON.parse(h.checkMsg)).status_code){e.next=29;break}return Ce.F.info("\u884c\u4e3a\u5b58\u5728\u5f02\u5e38\uff0c\u9700\u8981\u5b8c\u6210\u4e8c\u6b21\u9a8c\u8bc1"),e.prev=19,e.next=22,(0,ae.d)({request:function(){return null}},{headers:{"x-vc-bdturing-parameters":btoa(I.decision_conf)},config:{url:""}});case 22:return e.next=24,s.resendMessage(n,{enter_method:c,retrying:!0});case 24:h=e.sent,e.next=29;break;case 27:e.prev=27,e.t0=e.catch(19);case 29:e.next=33;break;case 31:e.prev=31,e.t1=e.catch(14);case 33:return s.emitEvent(Je.IM_SEND_MSG,{message:n,res:h}),(0,f.Z)(this,s,nn).call(this,p,n,E,h,c),null==o||o({conversation:p,message:n,res:h}),e.abrupt("return",h);case 37:case"end":return e.stop()}}),e,this,[[14,31],[19,27]])})))).apply(this,arguments)}function an(e,n){var t=s.bytedIMInstance,r=(0,Ie.MZ)(n);return null==t?void 0:t.createMessage((0,l.Z)({conversation:e},r))}function sn(e,n){var t=s.bytedIMInstance;return null==t?void 0:t.modifyMessageProperty({message:e,modifyContent:[n]})}function on(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],t=Ae.default.curUserInfo.uid,r=[];h()(n,(function(n){var a=n.userId,i=n.role,s=n.secUid,o=n.user_id,u=n.sec_uid,c=n.alias,l=void 0===c?"":c,d=a||ee().fromValue(o).toString();d!==t&&r.push(d),d&&Ae.default.setUserInfoFromSdkMap(e,d,{alias:l,uid:d,role:i,sec_uid:s||u})})),Ae.default.setConversationUserids(e,r)}function un(){var e=this,n=Ae.default.converSationListOrigin,t=Ae.default.uidSecUidMap,r=Ae.default.userInfoFromSdkMap,a=Ae.default.userInfoFromServerMap;h()(n,(function(n){var t=n.id,a=(n.type,n.toParticipantUserId,n.firstPageParticipant),i=n.participants;null==r||r[t];(0,f.Z)(e,s,on).call(e,t,i||(null==a?void 0:a.participants))}));var i=[];return h()(t,(function(e,n){var t=a[n];e&&!t&&i.push(e)})),i}function cn(){var e=this,n=Ae.default.strangerConverListObj,t=Ae.default.uidSecUidMap,r=Ae.default.userInfoFromSdkMap,a=Ae.default.userInfoFromServerMap,i=(null==n?void 0:n.conversation)||[],o=[];return h()(i,(function(n){var t=n.id,a=void 0===t?"":t,i=n.firstPageParticipant,o=void 0===i?[]:i,u=n.participants;null==r||r[a];(0,f.Z)(e,s,on).call(e,a,u||(null==o?void 0:o.participants))})),h()(t,(function(e,n){var t=a[n];e&&!t&&o.push(e)})),o}s=qe,(0,v.Z)(qe,"bytedIMInstance",null),(0,v.Z)(qe,"imEvents",(function(){})),(0,v.Z)(qe,"conversationChange",m()((function(){var e,n,t=null!==(e=null===(n=s.bytedIMInstance)||void 0===n?void 0:n.getConversationList())&&void 0!==e?e:[];return Ae.default.setConverSationList(t),Ae.default.setConversationMap(t),s.checkAndReportReadIndexGreater(t),U().all([s.getAllUserFromServer(),s.getStrangerConversationPreview()]).then((function(){s.syncToTray()})),s.updateIsStrangerConver(),Ve.Z.warn("conversationChange",t),t}),200)),(0,v.Z)(qe,"reportedReadIndexGreater",new(x())),(0,v.Z)(qe,"messageUpsert",m()((function(){var e,n=null===Ae.default||void 0===Ae.default?void 0:Ae.default.curConversation,t=null!==(e=null==n?void 0:n.getMessageList())&&void 0!==e?e:[];Ae.default.setCurMessageList(t),Ve.Z.warn("messageUpsert",t)}),200)),(0,v.Z)(qe,"strangerMessageUpsert",m()((0,u.Z)(S().mark((function e(){var n,t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null===Ae.default||void 0===Ae.default?void 0:Ae.default.curConversation,null===(n=s.bytedIMInstance)||void 0===n||n.getStrangerConversationMessage({conversation:t}).then((function(e){Ae.default.setCurMessageList(null!=e?e:[])}));case 2:case"end":return e.stop()}}),e)}))),200)),(0,v.Z)(qe,"getStrangerConversationList",(0,u.Z)(S().mark((function e(){var n,t,r,a,i,u,c,d,_,v,f,p,E,h,I,m,g,T,M,O,R,y,k=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=k.length>0&&k[0]!==undefined&&k[0],u=Ae.default.strangerConverListObj,(c=Ae.default.setIsShowGetConversaionListLoading)(!0),null===(n=d=u)||void 0===n||!n.loading){e.next=6;break}return e.abrupt("return");case 6:if(Ae.default.setStrangerConverListObj((0,l.Z)((0,l.Z)({},d),{},{loading:!0})),i&&(d={conversation:[],cursor:"0",hasMore:!0,loading:!1,unreadCount:0}),v=(_=d).cursor,f=void 0===v?"0":v,p=_.hasMore,void 0===p||p){e.next=12;break}return Ae.default.setStrangerConverListObj((0,l.Z)((0,l.Z)({},d),{},{loading:!1})),e.abrupt("return");case 12:return e.next=14,(0,ke.F)(null===(t=s.bytedIMInstance)||void 0===t?void 0:t.getStrangerConversationList({limit:10,cursor:f}));case 14:E=e.sent,h=(0,o.Z)(E,2),I=h[0],m=h[1],I&&Ae.default.setStrangerConverListObj((0,l.Z)((0,l.Z)({},d),{},{loading:!1})),T=(g=m||{}).conversation,M=g.cursor,O=g.hasMore,R=g.unreadCount,y=(null===(r=d)||void 0===r||null===(a=r.conversation)||void 0===a?void 0:C()(a).call(a,T))||[],Ae.default.setStrangerConverListObj({conversation:y,cursor:ee().fromValue(M).toString(),hasMore:O,unreadCount:R,loading:!1}),c(!1),Ae.default.setConversationMap(y),s.getAllStrangerFromServer(),s.updateIsStrangerConver();case 26:case"end":return e.stop()}}),e)})))),(0,v.Z)(qe,"getStrangerConversationPreview",m()((function(){var e;return null===(e=s.bytedIMInstance)||void 0===e?void 0:e.getStrangerPreview({}).then((function(e){if(Ve.Z.warn("new-preview",e),e){var n=e.conversation,t=void 0===n?{}:n,r=e.unreadCount,a=void 0===r?0:r;s.getStrangerFromServerWithConver(t),Ae.default.setStrangerMessageUnreadCount(a),Ae.default.setStrangerBoxCover(t)}else Ae.default.setStrangerBoxCover(null),Ae.default.setStrangerMessageUnreadCount(0)}))}),200)),(0,v.Z)(qe,"unreadCountReport",m()((function(){var e=s.bytedIMInstance;null==e||e.unreadCountReport()}),200))},65695:function(e,n,t){var r=t(68493),a=t.n(r),i=t(85792),s=t.n(i);n.Z=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return new(a())((function(n){s()((function(){n(!0)}),e||0)}))}},32744:function(e,n,t){t.d(n,{iL:function(){return v},GM:function(){return f},n0:function(){return p},QX:function(){return E}});var r,a=t(65146),i=t(69071),s=t(13795),o=t(33200),u=t(25674),c=t(14420),l=i.m.ConversationType,d=l.GROUP_CHAT,_=l.ONE_TO_ONE_CHAT,v=new s.hD({chat_notif_show:{eventName:"chat_notif_show",params:{}},chat_notif_hover:{eventName:"chat_notif_hover",params:{}},uc_login_notify:{eventName:"uc_login_notify",params:{}},uc_login_submit:{eventName:"uc_login_submit",params:{}},uc_login_result:{eventName:"uc_login_result",params:{}},chat_cell_show:{eventName:"chat_cell_show",params:{}},chat_cell_click:{eventName:"chat_cell_click",params:{}},enter_chat:{eventName:"enter_chat",params:{}},click_enter_chat_page:{eventName:"click_enter_chat_page",params:{}},chat_setting_show:{eventName:"chat_setting_show",params:{}},chat_setting_click:{eventName:"chat_setting_click",params:{}},chat_block_popup_show:{eventName:"chat_block_popup_show",params:{}},chat_block_popup_click:{eventName:"chat_block_popup_click",params:{}},send_message:{eventName:"send_message",params:{}},send_message_response:{eventName:"send_message_response",params:{}},follow:{eventName:"follow",params:{}},follow_cancel:{eventName:"follow_cancel",params:{}},emoji_tab_show:{eventName:"emoji_tab_show",params:{}},at_panel_show:{eventName:"at_panel_show",params:{}},send_at_message:{eventName:"send_at_message",params:{}},send_at_message_response:{eventName:"send_at_message_response",params:{}},message_function_show:{eventName:"message_function_show",params:{}},message_function_click:{eventName:"message_function_click",params:{}},like_message:{eventName:"like_message",params:{}},forward_message:{eventName:"forward_message",params:{}},quote_message:{eventName:"quote_message",params:{}},recall_message:{eventName:"recall_message",params:{}},delete_message:{eventName:"delete_message",params:{}},unsupported_message_show:{eventName:"unsupported_message_show",params:{}},video_cover_show:{eventName:"video_cover_show",params:{}},video_cover_click:{eventName:"video_cover_click",params:{}},click_comment_button:{eventName:"click_comment_button",params:{}},share_menu_show:{eventName:"share_menu_show",params:{}},share_video_click_head:{eventName:"share_video_click_head",params:{}},share_video_click_more_friend:{eventName:"share_video_click_more_friend",params:{}},share_video:{eventName:"share_video",params:{}},share_user:{eventName:"share_user",params:{}},share_comment:{eventName:"share_comment",params:{}},share_search:{eventName:"share_search",params:{enter_from:"others_homepage"}},click_send_message:{eventName:"click_send_message",params:{}},im_push_show:{eventName:"im_push_show",params:{}},im_push_click:{eventName:"im_push_click",params:{}},im_push_close:{eventName:"im_push_close",params:{}},im_login_notify:{eventName:"im_login_notify",params:{}},new_im_show:{eventName:"new_im_show",params:{}},share_video_click_more_group:{eventName:"share_video_click_more_group",params:{}},unknown_notif_show:{eventName:"unknown_notif_show",params:{}},unknown_notif_click:{eventName:"unknown_notif_click",params:{}},unknown_notif_hover:{eventName:"unknown_notif_hover",params:{}},unknown_notif_delete:{eventName:"unknown_notif_delete",params:{}},unknown_cell_show:{eventName:"unknown_cell_show",params:{}},chat_cell_click_all:{eventName:"chat_cell_click_all",params:{}},click_author_head:{eventName:"click_author_head",params:{click_from:"im",is_full_webscreen:"0",clarity:""}},click_fold_im:{eventName:"click_fold_im",params:{}},click_exit_chat:{eventName:"click_exit_chat",params:{}},imsdk_debug_read_index_greater:{eventName:"imsdk_debug_read_index_greater",params:{}},im_customer_group_notify:{eventName:"im_customer_group_notify",params:{}},im_customer_notify:{eventName:"im_customer_notify",params:{}},im_customer_click:{eventName:"im_customer_click",params:{action:"1"}}}),f=function(e){var n=e.type,t=e.ext,r=(0,u.t$)(e),a=null==r?void 0:r.type,i="";switch(n){case o.pp.TEXT:i="text";break;case o.pp.SHARE_WEB:0!==(null==r?void 0:r.aweType)&&(i=(null==r?void 0:r.msgTrack)||"");break;case o.pp.SHARE_WEB_FROM_THIRD_MESSAGE:i="share_from_third";break;case o.pp.XPLAN_STICKER_EMOJI:i=a===o.c6.AWEME_XEMOJI?"xmoji":"emoji";break;case o.pp.BIG_EMOJI:i=a===o.c6.AWEME_EMOJI_SELF?"emoji":a===o.c6.AWEME_NET_SEARCH_GIF?"giphy":a===o.c6.AWEME_GREET_EMOJI?"emoji":a===o.c6.AWEME_LITE_MSG_EMOJI||a===o.c6.AWEME_LITE_MSG_EMOJI_NEW||a===o.c6.AWEME_INTERACTIVE_EMOJI?"lite_emoji":"emoji";break;case o.pp.ONE_CARD:a===o.c6.GROUP_VOTE&&(i="poll");break;case o.pp.VOICE:case o.pp.ENCRYPT_VOICE:case o.pp.IM_ENCRYPT_VOICE:i="audio";break;case o.pp.ONLY_PICTURE:case o.pp.STORY_PICTURE:i="pic";break;case o.pp.STORY_VIDEO:i="video";break;case o.pp.SHARE_AWEME:i="share_video";break;case o.pp.SHARE_PHOTOS:i="share_photos";break;case o.pp.SHARE_COMPILATION:i="share";break;case o.pp.SHARE_USER:case o.pp.SHARE_MUSIC:case o.pp.SHARE_CHALLENGE:case o.pp.SHARE_STICKER:i="page";break;case o.pp.RED_PACKET:i="redpacket";break;case o.pp.SHARE_MINI_APP:i="mini_app";break;case o.pp.REF_MSG:i="ref_message";break;case o.pp.FRIEND_VIDEO_DM_COMMENT:i="friend_video_card";break;case o.pp.GROUP_INVITE_MESSAGE:var s=null==t?void 0:t["a:group_invite"];if("1"==="".concat(s))i="group_card";else{var l=null==r?void 0:r.aweme_invite_card;i=1===(null==l?void 0:l.card_type)?"group_card":"unknown"}break;case o.pp.COMMAND_SHARE:i="token_video_card";break;case o.pp.SHARE_LIVE:i=a===o.c6.LIVE_KTV?"familiar_invitation_ktv":a===o.c6.LIVE_VOICE?"familiar_invitation_chatting_room":"live_card";break;case o.pp.FEED_LIVE_SHARE_INVITE_MESSAGE:i="co_play_invitation";break;case o.pp.DIRECT_INVITE:i="invite";break;case o.pp.GAME_INVITE:case o.pp.GAME_INVITE_V2:i="chat_game";break;case o.pp.CLOUD_GAME_INVITE:i="cloud_game_card";break;case o.pp.COUPON_ENTERPRISE:case o.pp.COUPON_FANS_GROUP:i="fansgroup_coupon";break;case o.pp.CHAT_CALL:i="chat_call";break;case o.pp.SHARE_PICTURE:i="share_picture";break;case o.pp.AT_FRIEND_INTERACT:i="publish_at";break;case o.pp.URGE_LEAVE_MESSAGE:i=c.ImSdk.isFromGroupOwner(e)?"reply_to_update":"ask_for_update";break;case o.pp.SHARE_LOCATION:i="location";break;case o.pp.STORY_PICTURE_ONCE_VIEW:i="only_once_pic";break;case o.pp.STORY_VIDEO_ONCE_VIEW:i="only_once_video";break;case o.pp.SHARE_COMMENT:i="share_comment";break;case o.pp.BULLET:i="bullet";break;default:i="unknown"}return i},p=(r={},(0,a.Z)(r,d,"group"),(0,a.Z)(r,_,"private"),r),E={chat_page:"chat_page",chat_panel:"chat_panel",share_board:"share_board",share_message:"share_message",chat_notif:"chat_notif",push:"push",hover_icon:"hover_icon",im_private:"im_private"}},92582:function(e,n,t){t.d(n,{Gb:function(){return s}});var r=t(30906),a=t(72603),i=t(32744),s=function(e,n){try{var t=n||{};i.iL.sendLog(e,(0,r.Z)({enter_from:(0,a.yW)(),previous_page:(0,a.vM)()},t))}catch(s){}}}}]);