(window.TT_HD_WEBPACK_JSONP=window.TT_HD_WEBPACK_JSONP||[]).push([[36],{MQ25:function(e,t,s){"use strict";s.r(t);var n=s("eMCs"),i=s.n(n),r=s("l9g4"),a=s.n(r),o={insert:"head",singleton:!1},c=(i()(a.a,o),a.a.locals,s("aO6Z")),h=s.n(c);function l(e){var t=this;t.suggest=e,t.storageKey="SEARCH_HISTORY",t.splitKey="{%SP%}",t.historyArr=[],t.initialize.apply(t,arguments)}function p(){var e=$.extend(this,new TT.Event);e.suggestArr=[],e.hotArr=[],e.history=new l(e),e.qureyCache={},e.initialize.apply(e,arguments)}l.prototype={initialize:function(){var e=localStorage.getItem(this.storageKey);this.historyArr=e?e.split(this.splitKey):[]},add:function(e){if(e){var t=$.inArray(e,this.historyArr);t>=0&&this.historyArr.splice(t,1),this.historyArr.unshift(e);var s=this.historyArr.join(this.splitKey);localStorage.setItem(this.storageKey,s),this.suggest.emit("update")}},del:function(e){var t=$.inArray(e,this.historyArr);if(!(t<0)){this.historyArr.splice(t,1);var s=this.historyArr.join(this.splitKey);localStorage.setItem(this.storageKey,s),this.suggest.emit("update")}},clear:function(){this.historyArr=[],localStorage.setItem(this.storageKey,""),this.suggest.emit("update")}},l.prototype.constructor=l,p.prototype={initialize:function(){var e,t=this;$.when((e=new $.Deferred,$.ajax({url:TT.app.main+"cache1min.php?m=Search&do=getHotword&v=2",type:"get",dataType:"jsonp",cache:!0,jsonpCallback:"searchHotData"}).done((function(t){e.resolve(t)})),e.promise())).done((function(e){t.hotArr=e,t.emit("update")}))},suggest:function(e){var t,s,n=this,i=Object.keys(n.qureyCache);if($.inArray(e,i)>=0)return n.suggestArr=n.qureyCache[e],void n.emit("update");$.when((t=e,s=new $.Deferred,$.ajax({url:"//search.cdn.huya.com",data:{m:"Search",do:"getSearchContent",q:t,uid:0,v:4,typ:-7,livestate:0,rows:5},dataType:"jsonp"}).done((function(e){var t=e;0!==t.responseHeader.status&&s.resolve([]);var n=t.response[1024].docs||[],i=[],r=[];$.each(n,(function(e,t){t.associate_word&&-1===$.inArray(t.associate_word,r)&&(i.push(t),r.push(t.associate_word))})),s.resolve(n)})),s.promise())).done((function(t){n.qureyCache[e]=t,n.suggestArr=t,n.emit("update")}))}},p.prototype.constructor=p,$("body").append($('<a id="search-bar-jump" href="" target="_blank" style="display: none;"/>'));var d=function(e){var t=$("#search-bar-jump");t.prop("href",e),t[0].click()};function u(e){return e?$.trim(e).replace(/<|>|\'|\"/g,"").substr(0,100):""}function g(e){var t=this;t.cfg=e,t.$searchBtn=$(e.form).find(".btn-search"),t.$input=$(e.form).find("input"),t.$container=$(e.container),t.current="",t.tpl=h.a,t.initialize.apply(t,arguments)}g.prototype={initialize:function(){this.noInput=!this.cfg.key,this.model=new p,this.bindEvent()},render:function(){this.$container.html(this.tpl({obj:{isHeader:"header"==this.cfg.position,noInput:this.noInput,suggestArr:this.model.suggestArr,historyArr:this.model.history.historyArr,hotArr:this.model.hotArr}}))},inputChange:function(e){(e=u(e))?(this.noInput=!1,this.model.suggest(e)):(this.noInput=!0,this.render())},up:function(){if(this.current){var e=this.current.split("_"),t=e[0],s=e[1],n=s-1;if("suggest"==t)n<0&&(n=this.model.suggestArr.length-1);else if("history"==t)n<0&&(t="hot",n=this.model.hotArr.length-1);else if("hot"==t&&n<0){t="history";var i=this.model.history.historyArr.length;n=(i=i>6?6:i)-1}s=n,this.current=t+"_"+s}else this.noInput?this.current="hot_"+this.model.hotArr.length-1:this.current="suggest_"+this.model.suggestArr.length-1;this.moveToCurrent()},down:function(){if(this.current){var e=this.current.split("_"),t=e[0],s=parseInt(e[1]),n=s+1;if("suggest"==t)n>=this.model.suggestArr.length&&(n=0);else if("history"==t){var i=this.model.history.historyArr.length;n>=(i=i>6?6:i)&&(t="hot",n=0)}else"hot"==t&&n>=this.model.hotArr.length&&(t="history",n=0);s=n,this.current=t+"_"+s}else this.noInput?this.model.history.historyArr.length?this.current="history_0":this.current="hot_0":this.current="suggest_0";this.moveToCurrent()},moveToCurrent:function(){if(this.current){var e=this.current.split("_"),t=e[0],s=parseInt(e[1]);this.$container.find(".search-item").removeClass("current");var n=this.$container.find('.container[data-box="'+t+'"] .search-item').eq(s);n.addClass("current"),this.$input.val(n.find(".key").text())}},bindEvent:function(){var e=this;$("body").click((function(t){var s=$(t.target);0==s.closest("#search-bar-input").length+s.closest(".search-suggest").length&&e.$container.hide()}));var t=null,s=function(){clearTimeout(t),t=setTimeout((function(){var t=e.$input.val();e.inputChange(t),e.current=""}),300)};e.$input.on("click",(function(){e.$input.val()&&s(),e.$container.show()})).on("keyup",(function(t){39!=t.keyCode&&37!=t.keyCode&&(38==t.keyCode?e.up():40==t.keyCode?e.down():s(),e.$container.show())})).closest("form").on("submit",(function(t){var s=u(e.$input.val());s||(s=u(e.$input.prop("placeholder")),e.noInput=!1,e.model.emit("update")),e.$input.val(s),e.model.history.add(s),"header"!=e.cfg.position?location.href=TT.app.main+"search?hsk="+encodeURIComponent(s):d(TT.app.main+"search?hsk="+encodeURIComponent(s)),t.preventDefault()})),e.$container.on("click",".clear-history",(function(){e.model.history.clear()})).on("click",".history-del",(function(t){var s=$(this);e.model.history.del(s.parents(".search-item").find(".key").text())})).on("click",".search-item",(function(t){var s=$(t.target);if(!(s.closest(".history-del").length+s.closest(".link-jump").length)){var n=$(this).find(".key").text();e.model.history.add(n),"header"!=e.cfg.position?location.href=TT.app.main+"search?hsk="+encodeURIComponent(n):d(TT.app.main+"search?hsk="+encodeURIComponent(n))}})).on("mouseenter",".search-item",(function(){var t=$(this),s=t.parents(".container").data("box"),n=t.index();e.$container.find(".search-item").removeClass("current"),e.current=s+"_"+n})).on("mouseleave",".search-item",(function(){e.current=""})),e.model.on("update",(function(){e.render()}))}},g.prototype.constructor=g;t.default=g},aO6Z:function(module,exports){module.exports=function anonymous(locals,escapeFn,include,rethrow){rethrow=rethrow||function(e,t,s,n,i){var r=t.split("\n"),a=Math.max(n-3,0),o=Math.min(r.length,n+3),c=i(s),h=r.slice(a,o).map((function(e,t){var s=t+a+1;return(s==n?" >> ":"    ")+s+"| "+e})).join("\n");throw e.path=c,e.message=(c||"ejs")+":"+n+"\n"+h+"\n\n"+e.message,e},escapeFn=escapeFn||function(e){return null==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __line=1,__lines='<div class="search-suggest<%= obj.isHeader ? \' header\' : \'\'%>">\n    <% if(!obj.noInput){ %>\n    <% if(obj.suggestArr.length){ %>\n    <div class="container" data-box="suggest">\n        <ul class="search-list">\n            <% for(var key in obj.suggestArr){ var item = obj.suggestArr[key]; %>\n            <li class="search-item">\n                <i class="key"><%= HUYA_UTIL.unescape(item.associate_word) %></i>\n                <% if(item.word_type == 1){ %>\n                <a class="link-jump" href="<%= TT.app.main + item.associate_id %>" target="_blank">进入直播间</a>\n                <% }else if(item.word_type == 2){ %>\n                <a class="link-jump" href="<%= TT.app.main + \'g/\' + item.associate_id %>" target="_blank">进入列表</a>\n                <% } %>\n            <% } %>\n        </li></ul>\n    </div>\n    <% } %>\n    <% }else{ %>\n\n    <% if(obj.historyArr.length){ %>\n    <div class="container" data-box="history">\n        <h2 class="search-title">历史记录<i class="clear-history">清除记录</i></h2>\n        <ul class="search-list">\n            <% for(var key in obj.historyArr){ if(key == 6) break; var item = obj.historyArr[key]; %>\n            <li class="search-item"><i class="icon"></i><i class="key"><%= HUYA_UTIL.unescape(item) %></i><i class="history-del"></i></li>\n            <% } %>\n        </ul>\n    </div>\n    <% } %>\n\n    <div class="container" data-box="hot">\n        <h2 class="search-title">热门搜索</h2>\n        <ul class="search-list">\n            <% for(var key in obj.hotArr){ var item = obj.hotArr[key]; %>\n            <li class="search-item">\n                <i class="icon"><%= parseInt(key) + 1 %></i>\n                <i class="key"><%= HUYA_UTIL.unescape(item.hot_word) %></i>\n                <% if(item.word_type == 1){ %>\n                <a class="link-jump" href="<%= TT.app.main + item.associate_id %>" target="_blank">进入直播间</a>\n                <% }else if(item.word_type == 2){ %>\n                <a class="link-jump" href="<%= TT.app.main + \'g/\' + item.associate_id %>" target="_blank">进入列表</a>\n                <% } %>\n            </li>\n            <% } %>\n        </ul>\n    </div>\n\n    <% } %>\n</div>',__filename="src/components/SearchSuggest/tpl.tmpl";try{var __output="";function __append(e){null!=e&&(__output+=e)}with(locals||{}){if(__append('<div class="search-suggest'),__append(escapeFn(obj.isHeader?" header":"")),__append('">\n    '),__line=2,obj.noInput){if(__append("\n\n    "),__line=20,obj.historyArr.length){for(var key in __append('\n    <div class="container" data-box="history">\n        <h2 class="search-title">历史记录<i class="clear-history">清除记录</i></h2>\n        <ul class="search-list">\n            '),__line=24,obj.historyArr){if(6==key)break;var item=obj.historyArr[key];__append('\n            <li class="search-item"><i class="icon"></i><i class="key">'),__line=25,__append(escapeFn(HUYA_UTIL.unescape(item))),__append('</i><i class="history-del"></i></li>\n            '),__line=26}__append("\n        </ul>\n    </div>\n    "),__line=29}for(var key in __append('\n\n    <div class="container" data-box="hot">\n        <h2 class="search-title">热门搜索</h2>\n        <ul class="search-list">\n            '),__line=34,obj.hotArr){var item=obj.hotArr[key];__append('\n            <li class="search-item">\n                <i class="icon">'),__line=36,__append(escapeFn(parseInt(key)+1)),__append('</i>\n                <i class="key">'),__line=37,__append(escapeFn(HUYA_UTIL.unescape(item.hot_word))),__append("</i>\n                "),__line=38,1==item.word_type?(__append('\n                <a class="link-jump" href="'),__line=39,__append(escapeFn(TT.app.main+item.associate_id)),__append('" target="_blank">进入直播间</a>\n                '),__line=40):2==item.word_type&&(__append('\n                <a class="link-jump" href="'),__line=41,__append(escapeFn(TT.app.main+"g/"+item.associate_id)),__append('" target="_blank">进入列表</a>\n                '),__line=42),__append("\n            </li>\n            "),__line=44}__append("\n        </ul>\n    </div>\n\n    "),__line=48}else{if(__append("\n    "),__line=3,obj.suggestArr.length){for(var key in __append('\n    <div class="container" data-box="suggest">\n        <ul class="search-list">\n            '),__line=6,obj.suggestArr){var item=obj.suggestArr[key];__append('\n            <li class="search-item">\n                <i class="key">'),__line=8,__append(escapeFn(HUYA_UTIL.unescape(item.associate_word))),__append("</i>\n                "),__line=9,1==item.word_type?(__append('\n                <a class="link-jump" href="'),__line=10,__append(escapeFn(TT.app.main+item.associate_id)),__append('" target="_blank">进入直播间</a>\n                '),__line=11):2==item.word_type&&(__append('\n                <a class="link-jump" href="'),__line=12,__append(escapeFn(TT.app.main+"g/"+item.associate_id)),__append('" target="_blank">进入列表</a>\n                '),__line=13),__append("\n            "),__line=14}__append("\n        </li></ul>\n    </div>\n    "),__line=17}__append("\n    "),__line=18}__append("\n</div>"),__line=49}return __output}catch(e){rethrow(e,__lines,__filename,__line,escapeFn)}}},l9g4:function(e,t,s){t=e.exports=s("Ai0b")(!1);var n=s("V74C"),i=n(s("wSJl")),r=n(s("vDDu")),a=n(s("lVMt"));t.push([e.i,".search-suggest-container{display:none}.search-suggest{position:absolute;top:0;left:0;width:500px;background-color:#fff;border-radius:6px;box-shadow:0 0 6px rgba(0,0,0,.3);color:#333}.search-suggest .container{padding:14px 8px}.search-suggest .search-title{position:relative;float:none;padding-top:0;height:16px;line-height:16px;font-weight:normal;font-size:12px;color:#666}.search-suggest .search-title .clear-history{position:absolute;right:0;padding-left:16px;background:url("+i+") no-repeat left center;font-size:12px}.search-suggest .search-title .clear-history:hover{cursor:pointer}.search-suggest .search-list{margin-top:5px;overflow:hidden}.search-suggest .search-item{position:relative;float:left;padding-left:28px;width:242px;height:28px;line-height:28px;box-sizing:border-box;overflow:hidden}.search-suggest .search-item .icon{position:absolute;top:5px;left:6px;display:block;width:18px;height:18px;text-align:center;line-height:18px;border-radius:50%}.search-suggest .search-item .key{display:block;width:10em;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.search-suggest .search-item .link-jump{display:none;position:absolute;top:0;right:8px;color:#ff9600}.search-suggest .search-item .link-jump:hover{cursor:pointer;text-decoration:none}.search-suggest .search-item .history-del{position:absolute;margin-top:-4px;top:50%;right:10px;display:none;width:8px;height:8px;background:url("+r+") no-repeat center center}.search-suggest .search-item .history-del:hover{cursor:pointer}.search-suggest .search-item.current,.search-suggest .search-item:hover{color:#ff9600;background-color:#f1f2f4;cursor:pointer}.search-suggest .search-item.current .link-jump,.search-suggest .search-item:hover .link-jump{display:block}.search-suggest .search-item.current .history-del,.search-suggest .search-item:hover .history-del{display:block}.search-suggest .container[data-box=suggest] .search-list{margin-top:0}.search-suggest .container[data-box=suggest] .search-item{padding-left:8px;width:100%}.search-suggest .container[data-box=suggest] .search-item .key{width:30em}.search-suggest .container[data-box=history]{padding-bottom:0}.search-suggest .container[data-box=history] .search-item .icon{background:url("+a+") no-repeat center center}.search-suggest .container[data-box=history] .search-item .key{width:15em}.search-suggest .container[data-box=hot] .search-item .icon{color:#888;background-color:#dfdfdf}.search-suggest .container[data-box=hot] .search-item .key{width:11em}.search-suggest .container[data-box=hot] .search-item:nth-child(1) .icon,.search-suggest .container[data-box=hot] .search-item:nth-child(2) .icon,.search-suggest .container[data-box=hot] .search-item:nth-child(3) .icon{color:#fff;background-color:#ff9600}.search-suggest.header{width:370px;height:auto}.search-suggest.header .search-item{width:172px}.search-suggest.header .container[data-box=suggest] .search-item .key{width:20em}.search-suggest.header .container[data-box=hot] .search-item .key{width:11em}.search-suggest.header .container[data-box=hot] .search-item:hover .key{width:6em}.search-suggest.header .container[data-box=history] .search-item .key{width:10em}",""])}}]);