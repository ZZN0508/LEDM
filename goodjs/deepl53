"use strict";(self.webpackChunk_deepl_gatsby=self.webpackChunk_deepl_gatsby||[]).push([[6242],{38572:function(e,t,n){n.d(t,{i4:function(){return s},t2:function(){return p}});var o=n(91440),i=n(39833),a=n(37565),r=n(93820);let l=e=>({type:i.YX.SET_PRODUCTS,payload:e}),u=e=>({type:i.YX.SET_COUNTRY,payload:e}),d=e=>({type:i.YX.SET_CURRENCY,payload:e}),c=function(e,t){return void 0===t&&(t=!0),{type:i.YX.SET_LOADING_STATE,payload:{identifier:e,state:t}}},s=e=>async(t,n)=>{var o,i,a,r,c,s;if("undefined"==typeof window)return;let p=null===(o=n())||void 0===o?void 0:null===(i=o.user)||void 0===i?void 0:i.userCountry,f=null===(a=n())||void 0===a?void 0:null===(r=a.product)||void 0===r?void 0:r.list,y=null===(c=n())||void 0===c?void 0:null===(s=c.product)||void 0===s?void 0:s.currency;(0===Object.keys(null!=f?f:{}).length||p===(null==e?void 0:e.country)||y===(null==e?void 0:e.currency))&&(t(l(null==e?void 0:e.products)),t(u(null==e?void 0:e.country)),t(d(null==e?void 0:e.currency)))},p=e=>async(t,n)=>"undefined"==typeof window?Promise.reject():(t(c("fetchProducts")),new Promise((i,l)=>{var u,d,p;let f=new o.ZP("https://backend-l.deepl.com/PHP/backend","/products.php"),y=!!(null!==(u=n())&&void 0!==u&&null!==(d=u.user)&&void 0!==d&&null!==(p=d.subscription)&&void 0!==p&&p.id),v={...e&&{country:e},ignoreSubscription:!y};f.callMethod("getProducts",v).then(e=>{let{result:n}=e;return t(s(n)),i(n)}).catch(e=>{t(r.hP(e)),(0,a.bc)({err:e,method:"fetchProducts",dispatch:t}),l(e)}).finally(()=>t(c("fetchProducts",!1)))}))},93820:function(e,t,n){n.d(t,{D3:function(){return m},GC:function(){return S},JT:function(){return w},LM:function(){return a},PX:function(){return T},RD:function(){return c},VE:function(){return I},en:function(){return u},eq:function(){return f},h1:function(){return d},hP:function(){return C},iH:function(){return i},kM:function(){return r},pG:function(){return P},pL:function(){return h},sQ:function(){return _},sX:function(){return s},t0:function(){return g},wo:function(){return y},xO:function(){return l},xf:function(){return E},yB:function(){return v},zY:function(){return p}});var o=n(73914);let i=e=>({type:o.B.SET_LOGOUT_REASON,payload:e}),a=e=>({type:o.B.SET_CHECKOUT_PROCESS_LOADING,payload:e}),r=e=>({type:o.B.HAS_CHECKOUT_FORM_BEEN_SUBMITTED,payload:e}),l=e=>({type:o.B.HAS_CONFIRMATION_FORM_BEEN_SUBMITTED,payload:e}),u=e=>({type:o.B.SET_CONTACT_FORM_SUBMITTING,payload:e}),d=e=>({type:o.B.SET_SIDE_MENU,payload:e}),c=e=>({type:o.B.SET_LOGIN_FORM,payload:e}),s=e=>({type:o.B.SET_PASSWORD_FORGOTTEN_FORM,payload:e}),p=e=>({type:o.B.SET_IS_PLAN_DISPLAY_READY,payload:e}),f=e=>({type:o.B.SET_IS_ORDER_WIDGET_READY,payload:e}),y=()=>e=>{e(d(!1))},v=(e,t)=>(window.setTimeout(()=>{let e=document.querySelector('div[data-witherror="true"] input'),t=document.querySelector('div[data-witherror="true"] textarea');e?e.focus():t&&t.focus()},100),{type:o.B.SET_FORM_ERROR,payload:{fieldName:e,message:t}}),h=()=>({type:o.B.CLEAR_FORM_ERRORS}),m=()=>({type:o.B.CLEAR_EXCEPTIONS}),E=(e,t)=>n=>{let i=new Date().getTime();n({type:o.B.SET_EXCEPTION,payload:{id:i,code:t,message:e}})},w=e=>({type:o.B.DISMISS_EXCEPTION,payload:e}),S=e=>{let t=new Date().getTime();return{type:o.B.SET_SUCCESS_MESSAGE,payload:{id:t,message:e}}},I=e=>({type:o.B.DISMISS_SUCCESS_MESSAGE,payload:e}),C=e=>t=>{e.exceptions&&e.exceptions.forEach(e=>t(E(e.message,e.code))),null!=e&&e.fieldErrors&&e.fieldErrors.forEach(e=>t(v(e.name,e.message))),!e.exceptions&&!e.fieldErrors&&e instanceof Error&&t(E(e.toString(),0))},T=e=>({type:o.B.SET_NOTIFICATIONS_MODAL_VISIBILITY,payload:e}),_=e=>({type:o.B.SET_COOKIE_BANNER_DISPLAYED,payload:e}),g=()=>({type:o.B.SHOW_ENTERPRISE_LOGOUT_MODAL}),P=()=>({type:o.B.SHOW_ENTERPRISE_LOGIN_MODAL})},66724:function(e,t,n){var o=n(65137),i=n(96146);let a=e=>{var t,n;return(null===(t=document)||void 0===t?void 0:null===(n=t.cookie)||void 0===n?void 0:n.indexOf(`${e}=`))>=0},r=()=>JSON.parse(`{"${document.cookie.replace(/=/g,'": "').replace(/; /g,'", "')}"}`);t.Z={getItem:o.r,setItem:i.L,existsItem:a,deleteItem:function(e,t){if(void 0===t&&(t=".deepl.com"),"undefined"==typeof window)return;let n=t?` Domain=${t}`:"";document.cookie=`${e}=; path=/; Max-Age=-1; expires=Thu, 01 Jan 1970 00:00:00 GMT;${n}`},cookieToJSON:r}},98921:function(e,t,n){n.d(t,{u:function(){return o}});let o=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let o=t.filter(e=>!!e||0===e).join(""),i=0;for(let e=0;e<o.length;e++)i=(i<<5)-i+o.charCodeAt(e)|0;return i.toString(36).replace("-","").toUpperCase()}},5580:function(e,t,n){n.d(t,{L:function(){return i}});var o=n(27378);let i="undefined"!=typeof window?o.useLayoutEffect:o.useEffect},91780:function(e,t,n){n.d(t,{dD:function(){return c},kw:function(){return s},mB:function(){return l}});var o=n(27378),i=n(41945),a=n(37565),r=n(84175);function l(){return"true"===sessionStorage.getItem("enforceLogin")}let u=()=>sessionStorage.removeItem("enforceLogin"),d=async()=>{try{let e=await fetch("https://login-wall.deepl.com/",{cache:"no-store"});if(902===e.status)return!0;return u(),!1}catch(e){if((null==e?void 0:e.status)===902)return!0;return u(),!1}};async function c(){await d()&&(sessionStorage.setItem("enforceLogin","true"),window.location.href="/login")}let s=e=>{let t=(0,i.I0)(),{0:n,1:u}=(0,o.useState)(!1);return(0,o.useEffect)(()=>{u(l()),l()&&t((0,a.ZP)({dapEventId:r.qb.LOGIN_WALL_LOADED,dapPageId:e,dapEventData:{loginWallLoadedData:{urlPath:window.location.pathname}}}))},[]),n}},16242:function(e,t,n){n.d(t,{VD:function(){return r},ju:function(){return l},n:function(){return u}});var o=n(41945),i=n(5580);let a="redirectPath",r=(e,t)=>{let n=(0,o.v9)(e=>!!e.auth.isLoggedIn);(0,i.L)(()=>{var o,i;let r;if(null==t||!t.current){if(!(r=null===(o=new URLSearchParams(window.location.search).get("redirectUri"))||void 0===o?void 0:o.replace(/\/$/,""))){let t=null===(i=sessionStorage.getItem(a)||(null==e?void 0:e.fallbackPath))||void 0===i?void 0:i.replace(/\/$/,"");null!=t&&t.startsWith("/")||""===t?r=window.location.origin+t:t&&/https:\/\/(\S+\.)?deepl\.com\//.test(t)&&(r=t)}if(n&&r&&window.location.origin+window.location.pathname+window.location.search!==r){sessionStorage.removeItem(a);try{let n=new URL(`${r}${(null==e?void 0:e.customizedHash)||window.location.hash||"#login_successful"}`);if(!n.hostname.endsWith(".deepl.com"))throw Error();t&&(t.current=!0),window.location.href=n.href}catch{console.error("The redirect URI is invalid")}}}},[n,t])},l=e=>{sessionStorage.setItem(a,e||window.location.pathname+window.location.search)},u=()=>{sessionStorage.removeItem(a)}},75136:function(e,t,n){var o;n.d(t,{T:function(){return i}});let i=((o={})[o.TOO_MANY_REQUESTS_STATUS=429]="TOO_MANY_REQUESTS_STATUS",o[o.TOO_MANY_REQUESTS=-32029]="TOO_MANY_REQUESTS",o[o.CLEARANCE_IP_MISMATCH=-31998]="CLEARANCE_IP_MISMATCH",o[o.CLEARANCE_INSUFFICIENT_BOT_SCORE=-31999]="CLEARANCE_INSUFFICIENT_BOT_SCORE",o[o.CLEARANCE_FETCH_FAILURE=90991]="CLEARANCE_FETCH_FAILURE",o[o.LOGIN_FAILED=-32602]="LOGIN_FAILED",o[o.MISSING_SSO_IDP_CONFIG=90992]="MISSING_SSO_IDP_CONFIG",o)},21125:function(e,t,n){n.r(t),n.d(t,{activateAccountInState:function(){return ed},activateSSO:function(){return t0},activateSubaccounts:function(){return tY},addSubaccountInvitations:function(){return tx},callLoginOrRegister:function(){return e0},cancelSubscription:function(){return tN},checkCurrencyChange:function(){return ne},checkIfEligibleForFreeApi:function(){return ty},checkUpgradePermission:function(){return t9},checkVAT:function(){return te},checkout:function(){return tf},checkoutHandlePayment:function(){return tp},checkoutSendData:function(){return tc},checkoutValidateVAT:function(){return tr},cleanUpStatesWhenLoginStateIsLost:function(){return e4},clearPaymentData:function(){return ee},clearValidationState:function(){return eg},closeNotification:function(){return t6},confirm:function(){return th},createIdentityProvider:function(){return tW},createSetupIntent:function(){return to},deactivateAccountInState:function(){return ec},deactivateSubaccounts:function(){return tH},disableTeamLink:function(){return tF},ensureClearanceToken:function(){return eJ},estimateSalesTax:function(){return tm},fetchAvailableCountries:function(){return eY},fetchAvailableCountriesGroupedByContinent:function(){return tC},fetchClientState:function(){return tI},fetchIdentityProvider:function(){return tQ},fetchInvitationLinkInfo:function(){return tq},fetchSSOSession:function(){return eQ},fetchTeamSSOConfiguration:function(){return tJ},fetchUserAddress:function(){return ex},fetchUserData:function(){return eH},fetchUserMail:function(){return e$},fetchUserSettlements:function(){return eK},fetchUserSubscription:function(){return eZ},finalizeCheckout:function(){return tu},generateNewApiKey:function(){return tM},generateTeamLink:function(){return tB},getCheckoutData:function(){return e7},getConsumption:function(){return t4},getOneOffSettlement:function(){return t7},getPaymentMethodData:function(){return e8},getPaymentMethodDataForEmail:function(){return e6},getSubaccountSettings:function(){return tU},getTeamAccounts:function(){return tG},getUserCountry:function(){return nn},handleClientVars:function(){return tE},handleEnterpriseAccount:function(){return tS},handleFeatureSet:function(){return tw},handleSetupIntentResult:function(){return ti},leaveTeamAndLogout:function(){return t8},login:function(){return e1},loginOrRegisterWithInvitation:function(){return tX},logout:function(){return e9},prepareForCheckout:function(){return tl},removeAccountInState:function(){return es},removeSubaccounts:function(){return t$},removeTeamLinkInState:function(){return ei},resendInvitationEmail:function(){return tK},resetPassword:function(){return e5},restrictTeamLinkDomain:function(){return tV},revokeSubaccountInvitations:function(){return tZ},sendPasswordResetLink:function(){return e2},setAddressIssue:function(){return eP},setAddressValidationInValidationState:function(){return ew},setApiKey:function(){return X},setAvailableCountries:function(){return q},setAvailableCountriesGroupedByContinentinState:function(){return W},setAvailablePaymentMethods:function(){return Q},setCheckoutData:function(){return z},setCheckoutStep:function(){return ts},setClearanceError:function(){return x},setClientStateInState:function(){return ey},setConfirmationValidationState:function(){return eC},setConsumptionInState:function(){return ef},setCurrencyValidationInValidationState:function(){return eI},setDisplayNameInState:function(){return et},setFeatureSetInState:function(){return ev},setInterfaceLanguageInState:function(){return eh},setInvitationLinkInfo:function(){return eb},setLastLoginFailed:function(){return $},setLinkDomainInState:function(){return ea},setLoadingStateInState:function(){return N},setOneOffSettlement:function(){return eA},setPaymentError:function(){return e_},setPaymentMethodData:function(){return J},setPaymentValidationInValidationState:function(){return eT},setSSOConfiguration:function(){return eO},setSSOIdentityProvider:function(){return eR},setSSOIdentityProviderApproval:function(){return eN},setSalesTaxEstimation:function(){return eL},setSessionLost:function(){return K},setSubaccountSettingsInState:function(){return eo},setSubsequentTeamSizeInState:function(){return eu},setTeamAccountsInState:function(){return er},setTeamSizeInState:function(){return el},setUserCountryInState:function(){return em},setUserDocumentLimit:function(){return t1},setUserEnterpriseAccount:function(){return M},setVATValidationInValidationState:function(){return eS},setValidationState:function(){return eE},ssoLogin:function(){return eX},ssoLogout:function(){return eW},undoDowngrade:function(){return nt},undoTermination:function(){return tD},updateApiKeyInStore:function(){return en},updateBillingEmail:function(){return tO},updateBillingInformation:function(){return tA},updateCostControlSettings:function(){return tk},updateCustomerReference:function(){return tb},updateDisplayName:function(){return tg},updateEmailAddress:function(){return tT},updateInvoiceLanguage:function(){return tL},updatePassword:function(){return t_},updatePaymentInformation:function(){return tR},updateProduct:function(){return t3},updateProductBeforeConfirmation:function(){return t2},updateTeamDocumentLimitInState:function(){return ep},updateTeamSSOConfiguration:function(){return tz},updateTeamSize:function(){return tj},updateToTeam:function(){return t5},verifyPasswordResetToken:function(){return e3}});var o=n(4769),i=n(94288),a=n(63478),r=n(59965),l=n(16242),u=n(91780),d=n(93574);let c=async(e,t,n)=>{var o;let i;if(!document){console.warn("No document object found. Please use sendFormRequest function on client side.");return}let a=document.createElement("form");a.method="POST";try{i=new URL(e)}catch{i=new URL(e,window.location.href)}a.action=new URL(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(e=>e.split("/").filter(e=>e)).flat().join("/")}(i.pathname,t||""),null===(o=i)||void 0===o?void 0:o.origin).href,Object.entries(n).forEach(e=>{let[t,n]=e,o=document.createElement("input");o.type="hidden",o.name=t,o.value=String(n),a.appendChild(o)}),document.body.appendChild(a),a.submit(),document.body.removeChild(a)};var s=n(66442),p=n(47951),f=n(75136),y=n(81186),v=n(33447),h=n(28699),m=n(66724),E=n(16800),w=n(98921),S=n(84175),I=n(91440),C=n(83732),T=n(60423),_=n(37565),g=n(38572),P=n(93820);let A="/subscription.php",L="/stripe/sca.php",b="/registration",O="/sso/identity_provider/",R="/identity-providers/",N=function(e,t){return void 0===t&&(t=!0),{type:T.Ll.SET_LOADING_STATE,payload:{identifier:e,state:t}}},D=e=>({type:T.Ll.SET_ACCOUNT,payload:e}),M=e=>({type:T.Ll.SET_ENTERPRISE_ACCOUNT,payload:e}),k=e=>({type:T.Ll.SET_ADDRESS,payload:e}),U=e=>({type:T.Ll.SET_INVOICE_LOCALE,payload:e}),B=e=>({type:T.Ll.SET_BILLING_EMAIL,payload:e}),F=e=>({type:T.Ll.SET_CUSTOMER_REFERENCE,payload:e}),V=e=>({type:T.Ll.SET_ACTIVATION,payload:e}),G=e=>({type:T.Ll.SET_SETTLEMENTS,payload:e}),j=e=>({type:T.Ll.SET_SUBSCRIPTION,payload:e}),Y=e=>({type:T.Ll.SET_TEAM_MEMBERSHIP,payload:e}),H=e=>({type:T.Ll.SET_DOC_CONSUMPTION,payload:e}),$=(e,t)=>({type:T.Ll.SET_LAST_LOGIN_FAILED,payload:{hasFailed:e,errorCode:t}}),x=e=>({type:T.Ll.SET_CLEARANCE_ERROR,payload:e}),Z=e=>({type:T.Ll.SET_EMAIL,payload:e}),K=e=>({type:T.Ll.SET_SESSION_LOST,payload:e}),q=e=>({type:T.Ll.SET_AVAILABLE_COUNTRIES,payload:e}),X=e=>({type:T.Ll.SET_API_KEY,payload:e}),W=e=>({type:T.Ll.SET_AVAILABLE_COUNTRIES_GROUPED_BY_CONTINENT,payload:e}),Q=e=>({type:T.Ll.SET_AVAILABLE_PAYMENT_METHODS,payload:e}),J=e=>({type:T.Ll.SET_PAYMENT_METHOD_DATA,payload:e}),z=e=>({type:T.Ll.SET_CHECKOUT_DATA,payload:e}),ee=()=>({type:T.Ll.CLEAR_PAYMENT_DATA}),et=e=>({type:T.Ll.SET_DISPLAY_NAME,payload:e}),en=function(e,t){return void 0===t&&(t=!0),{type:T.Ll.UPDATE_API_KEY,payload:{apiKey:e,replacedOldKey:t}}},eo=e=>({type:T.Ll.SET_SUBACCOUNTS_SETTINGS,payload:e}),ei=()=>({type:T.Ll.REMOVE_TEAM_LINK}),ea=e=>({type:T.Ll.SET_TEAM_LINK_DOMAIN,payload:e}),er=e=>({type:T.Ll.SET_TEAM_ACCOUNTS,payload:e}),el=e=>({type:T.Ll.SET_TEAM_SIZE,payload:e}),eu=e=>({type:T.Ll.SET_SUBSEQUENT_TEAM_SIZE,payload:e}),ed=e=>({type:T.Ll.ACTIVATE_TEAM_ACCOUNT,payload:e}),ec=e=>({type:T.Ll.DEACTIVATE_TEAM_ACCOUNT,payload:e}),es=e=>({type:T.Ll.REMOVE_TEAM_ACCOUNT,payload:e}),ep=e=>({type:T.Ll.UPDATE_TEAM_DOCUMENT_LIMIT,payload:e}),ef=e=>({type:T.Ll.SET_CONSUMPTION,payload:e}),ey=e=>({type:T.Ll.SET_CLIENT_STATE,payload:e}),ev=e=>({type:T.Ll.SET_FEATURE_SET,payload:e}),eh=e=>({type:T.Ll.SET_INTERFACE_LANGUAGE,payload:e}),em=e=>({type:T.Ll.SET_USER_COUNTRY,payload:e}),eE=e=>({type:T.Ll.SET_VALIDATION_STATE,payload:e}),ew=e=>({type:T.Ll.SET_ADDRESS_VALIDATION,payload:e}),eS=e=>({type:T.Ll.SET_VAT_VALIDATION,payload:e}),eI=e=>({type:T.Ll.SET_CURRENCY_VALIDATION,payload:e}),eC=e=>({type:T.Ll.SET_CONFIRMATION_VALIDATION,payload:e}),eT=e=>({type:T.Ll.SET_PAYMENT_VALIDATION,payload:e}),e_=e=>({type:T.Ll.SET_PAYMENT_ERROR,payload:e}),eg=()=>({type:T.Ll.SET_VALIDATION_STATE,payload:{}}),eP=e=>({type:T.Ll.SET_ADDRESS_ISSUE,payload:e}),eA=e=>({type:T.Ll.SET_ONE_OFF_SETTLEMENT,payload:e}),eL=e=>({type:T.Ll.SET_SALES_TAX_ESTIMATION,payload:e}),eb=(e,t,n)=>({type:T.Ll.SET_INVITATION_LINK_INFO,payload:{masterAccount:e,teamName:t,emailConstraint:n}}),eO=e=>({type:T.Ll.SET_SSO_CONFIGURATION,payload:e}),eR=e=>({type:T.Ll.SET_SSO_IDENTITY_PROVIDER,payload:e}),eN=e=>({type:T.Ll.SET_SSO_IDENTITY_PROVIDER_APPROVAL,payload:e}),eD=e=>e?new I.ZP("https://w.deepl.com","/account"):new I.ZP("https://backend-l.deepl.com/PHP/backend","/account.php"),eM=new I.ZP("https://backend-l.deepl.com/PHP/backend",A),ek=new I.ZP("https://www.deepl.com/backend",b),eU=new I.ZP("https://backend-l.deepl.com/PHP/backend",L),eB=new I.ZP("https://backend-l.deepl.com/PHP/backend","/stripe/account.php"),eF=new I.ZP("https://www.deepl.com/backend","/address"),eV=new I.ZP("https://backend-l.deepl.com/PHP/backend","/countries.php"),eG=new I.ZP("https://backend-l.deepl.com/PHP/backend","/notifications.php"),ej=()=>{let e=localStorage.getItem("user");if((null==e?void 0:e.length)>0)try{let t=JSON.parse(e);t["userDisplayName__%expires"]=Math.floor(new Date().getTime()/1e3),t["displayName__%expires"]=Math.floor(new Date().getTime()/1e3),localStorage.setItem("user",JSON.stringify(t))}catch(e){throw localStorage.removeItem("user"),e}},eY=function(e){return void 0===e&&(e=!1),async t=>{if("undefined"!=typeof window)return t(N("fetchAvailableCountries")),new Promise(n=>{eV.callMethod("getAvailableCountries",{includeStates:e}).then(e=>{t(q(e.result.countries.map(e=>({...e,countryCode:e.countryCode.toLowerCase()})))),n(e.result.countries)}).catch(e=>{(0,_.bc)({err:e,method:"fetchAvailableCountries",dispatch:t}),t(P.hP(e)),console.error(e)}).finally(()=>{t(N("fetchAvailableCountries",!1))})})}},eH=function(e){return void 0===e&&(e=!0),async(t,n)=>{var o,i,a,r,l,u,d,c,s,p,f,y,v,h,E,w;if("undefined"==typeof window)return;let S=null===(o=n())||void 0===o?void 0:null===(i=o.user)||void 0===i?void 0:i.featureSet;t(N("fetchUserData"));try{let{result:e}=await eD(!0).callMethod("getCurrentAccount");if(!(null!=S&&S.subscription.newPaymentSystem)&&(null!=S&&S.subscription.billing||null!=S&&S.subscription.usage||null!=S&&null!==(a=S.api)&&void 0!==a&&a.manageKeys)){let n=["account","subscription","address","teamMembership","availableCountries","userPaymentAvailability"];null!=S&&S.subscription.billing&&n.push("settlements"),null!=S&&S.subscription.usage&&n.push("docConsumption"),null!=S&&null!==(r=S.api)&&void 0!==r&&r.manageKeys&&n.push("apiKey");let{result:o}=await eD().callMethod("refresh",{types:n});t(D({id:null==e?void 0:e.accountId,email:null==e?void 0:e.email,name:null==e?void 0:e.name,locale:null==e?void 0:null===(l=e.locale)||void 0===l?void 0:l.languageCode,localeFull:`${null==e?void 0:null===(u=e.locale)||void 0===u?void 0:u.languageCode}_${null==e?void 0:null===(d=e.locale)||void 0===d?void 0:d.countryCode}`,accountStatus:null==o?void 0:null===(c=o.account)||void 0===c?void 0:c.accountStatus,isAccountEligibleForFreeTrial:null==o?void 0:null===(s=o.account)||void 0===s?void 0:s.isAccountEligibleForFreeTrial})),t(k(o.address)),t(V(o.activation)),t(Y(null==o?void 0:o.teamMembership)),t(G(null==o?void 0:o.settlements)),o.address.country&&(m.Z.setItem("userCountry",o.address.country,!1,""),t(em(o.address.country))),t(j(o.subscription?{...o.subscription,product:o.products[o.subscription.productId]}:{})),t(H(o.docConsumption)),t(Q(o.userPaymentAvailability)),t(q(o.availableCountries.map(e=>({name:e.name,countryCode:e.countryCode.toLowerCase(),creditCardPaymentAvailable:e.creditCardPaymentAvailable,directDebitPaymentAvailable:e.directDebitPaymentAvailable,invoicePaymentAvailable:e.invoicePaymentAvailable,invoicePaymentLimit:e.invoicePaymentLimit,vatRate:o.vatRates[e.countryCode],states:e.states,statesLabel:e.statesLabel,hasStates:e.hasStates,childCountries:e.childCountries,currency:e.currency})))),o.products&&t((0,g.i4)(o)),o.apiKey&&t(X(o.apiKey))}else t(D({id:e.accountId,email:e.email,name:e.name,accountStatus:null!==(p=n())&&void 0!==p&&null!==(f=p.user)&&void 0!==f&&null!==(y=f.featureSet)&&void 0!==y&&null!==(v=y.subscription)&&void 0!==v&&null!==(h=v.upgradeOptions)&&void 0!==h&&h.length?0:999})),e.locale&&t(U(`${e.locale.languageCode}_${e.locale.countryCode}`)),t(eY())}catch(o){if(!e)return;null!==(E=n())&&void 0!==E&&null!==(w=E.auth)&&void 0!==w&&w.isLoggedIn&&((0,_.bc)({err:o,method:"fetchUserData",dispatch:t}),t(P.hP(o)))}finally{t(N("fetchUserData",!1))}}},e$=()=>async(e,t)=>{var n,o,i,a,r;if("undefined"!=typeof window)try{let a=null===(n=t())||void 0===n?void 0:null===(o=n.user)||void 0===o?void 0:null===(i=o.featureSet)||void 0===i?void 0:i.subscription;if(null!=a&&a.billing||null!=a&&a.usage||null!=a&&a.api){let t=await eD(!0).callMethod("getCurrentAccount");e(Z(t.result.email))}else e(eH())}catch(n){null!==(a=t())&&void 0!==a&&null!==(r=a.auth)&&void 0!==r&&r.isLoggedIn&&e(P.hP(n))}},ex=()=>async(e,t)=>{if("undefined"!=typeof window)return e(N("fetchUserAddress")),eD().callMethod("refresh",{types:["address"]}).then(t=>{let{result:n}=t;return e(k(n.address))}).catch(n=>{var o,i;null!==(o=t())&&void 0!==o&&null!==(i=o.auth)&&void 0!==i&&i.isLoggedIn&&e(P.hP(n))}).finally(()=>e(N("fetchUserAddress",!1)))},eZ=()=>async(e,t)=>{if("undefined"!=typeof window)return e(N("fetchUserSubscription")),eD().callMethod("refresh",{types:["subscription"]}).then(t=>{let{result:n}=t;e((0,g.i4)(n)),e(j(n.subscription?{...n.subscription,product:n.products[n.subscription.productId]}:{})),e(V(n.activation||{}))}).catch(n=>{var o,i;null!==(o=t())&&void 0!==o&&null!==(i=o.auth)&&void 0!==i&&i.isLoggedIn&&e(P.hP(n))}).finally(()=>e(N("fetchUserSubscription",!1)))},eK=()=>async(e,t)=>{if("undefined"!=typeof window)return e(N("fetchUserSettlements")),eD().callMethod("refresh",{types:["settlements"]}).then(n=>{var o,i;let{result:a}=n;e(G(a.settlements)),e(V({...null===(o=t())||void 0===o?void 0:null===(i=o.user)||void 0===i?void 0:i.activation,hasOpenPayments:a.settlements.filter(e=>!e.isPaid).length>0}))}).catch(n=>{var o,i;null!==(o=t())&&void 0!==o&&null!==(i=o.auth)&&void 0!==i&&i.isLoggedIn&&e(P.hP(n))}).finally(()=>e(N("fetchUserSettlements",!1)))},eq=e=>async t=>{if(!e)throw Error("noIdpFound");t(N("ssoConfig",!0));try{let n=await (0,r.w)("https://w.deepl.com","/sso/config",{idp:e}),o=await n.json();if(o&&["authEndpoint","logoutEndpoint","renewEndpoint"].every(e=>Object.keys(o).includes(e)))return t(N("ssoConfig",!1)),o}catch(e){if(t(N("ssoConfig",!1)),404===e.status)throw new I.Xy(f.T.MISSING_SSO_IDP_CONFIG,"missingSsoIdpConfig");throw e}throw Error("invalidSsoConfig")},eX=e=>async t=>{let n=e.toLowerCase(),{authEndpoint:o}=await t(eq(n));(0,r.g)("https://w.deepl.com",o,{idp:n})},eW=e=>async t=>{let o=e.toLowerCase(),{logoutEndpoint:i}=await t(eq(o)),r=`${new URL(i,"https://w.deepl.com")}`;n.g.store.dispatch((0,a.UZ)("SSO_USER_REQUEST")),window.localStorage.removeItem("dl_featureSet"),(0,l.ju)();try{window.location.replace(r)}catch(e){window.location.href=r}await new Promise(e=>{setTimeout(e,2e3)})},eQ=function(e){return void 0===e&&(e=void 0),async(t,n)=>{var o,i,u,d,c,s,p;let f=e||(null===(o=n())||void 0===o?void 0:null===(i=o.auth)||void 0===i?void 0:null===(u=i.loginState)||void 0===u?void 0:u.ssoIdentityProviderName),y=null===(d=n())||void 0===d?void 0:null===(c=d.auth)||void 0===c?void 0:c.logoutReason;if(!f||"SSO_USER_REQUEST"===y)return;let{renewEndpoint:v}=await t(eq(f));try{await (0,r.w)("https://w.deepl.com",v,void 0,{method:"POST",credentials:"include"})}catch(e){if((null==e?void 0:e.status)===401){let e=null===(s=n().auth)||void 0===s?void 0:s.inactivityStartTime,o=Math.floor((e>0?Date.now()-e:0)/6e4),i=null===(p=n().translator)||void 0===p?void 0:p.hasSourceText;await t((0,_.C1)({dapEventId:S.qb.SSO_SESSION_LOST,dapPageId:(0,S.ew)(window.location.href),dapEventData:{ssoSessionLostData:{inactiveMinutes:o,hasSourceText:i}}})),t((0,a.Xd)(!0)),(0,l.ju)(),await t(eX(f))}}}},eJ=()=>async e=>{let t;let n=Date.now(),o={status:0};try{let e=new URL("https://clearance.deepl.com/token");(0,d._K)("fakeBot")&&e.searchParams.set("max_score",1);let t=await Promise.race([fetch(e.toString(),{credentials:"include",mode:"cors"}),new Promise((e,t)=>setTimeout(()=>t(new I.Xy(f.T.CLEARANCE_FETCH_FAILURE,"clearance timeout")),5e3))]);if(o.status=t.status||0,!t.ok)throw Error(`${t.status}`)}catch(e){console.warn(e.message),t=new I.Xy(f.T.CLEARANCE_FETCH_FAILURE,`Error happens while fetching clearance token: ${e.message}`)}if(o.duration=Date.now()-n,t&&(o.error=t.message),e((0,_.C1)({dapEventId:S.qb.CLEARANCE_TOKEN_REQUESTED,dapPageId:(0,S.ew)(window.location.href),dapEventData:{clearanceTokenRequestedData:o}})),t)throw t;return o},ez=async e=>{let t=null;try{t=new URL(e)}catch(t){let e="Invalid or empty captcha URL.";throw console.debug(e,"Error: ",t),Error(e)}window.location.href=t.href},e0=function(e,t,n,o){return void 0===e&&(e="login"),void 0===t&&(t=0),void 0===n&&(n=void 0),async(i,a)=>{let r=await i(eJ()),l=n?{loginState:n}:{clearanceInfo:r,referrer:window.location.href,...o};try{let t=eD(!0),n=await t.callMethod(e,l);i(D({...n.result})),i(P.D3()),i(P.iH(void 0)),ej(),await i(tI())}catch(a){var u,d,c;if((null==a?void 0:null===(u=a.exceptions)||void 0===u?void 0:u.length)>0){let r=a.exceptions.map(e=>e.code);if(r.includes(f.T.CLEARANCE_IP_MISMATCH)){let a=t+1;if(a>=3)throw new I.Xy(f.T.CLEARANCE_IP_MISMATCH);return i(e0(e,a,n,o))}if(r.includes(f.T.CLEARANCE_INSUFFICIENT_BOT_SCORE)){let e=null===(d=a.exceptions.find(e=>e.code===f.T.CLEARANCE_INSUFFICIENT_BOT_SCORE))||void 0===d?void 0:null===(c=d.data)||void 0===c?void 0:c.challengeUri;throw await ez(e),new I.Xy(f.T.CLEARANCE_INSUFFICIENT_BOT_SCORE)}if(r.includes(f.T.TOO_MANY_REQUESTS))throw new I.Xy(f.T.TOO_MANY_REQUESTS)}throw a}}},e1=e=>async t=>{if("undefined"!=typeof window){t(N("login")),t($(!1));try{null!=e&&e.oidcOptions?await c("https://w.deepl.com","/oidc/login",{username:null==e?void 0:e.email,password:null==e?void 0:e.password,...e.oidcOptions}):await t(e0("login",0,e.tempLoginState,{email:e.email,password:e.password,keepLogin:e.keepLogin,version:"44",loginDomain:"default"}))}catch(e){throw e.code===f.T.CLEARANCE_INSUFFICIENT_BOT_SCORE&&await new Promise(e=>{setTimeout(e,5e3)}),t($(!0,e.code||(null==e?void 0:e.statusCode))),(0,_.bc)({err:e,method:"login",dispatch:t}),e}finally{t(t(N("login",!1)))}}},e4=()=>e=>{e(P.kM(!1)),e(P.xO(!1)),e(D({})),e(k({})),e(V({})),e(j({})),e(z({})),e(Y({})),e(G([])),e(Q({})),e(X({})),e(ef({})),e(eR({}))},e9=e=>async(t,n)=>{var o,i,r,l;if("undefined"==typeof window)return;let u=null===(o=n().auth)||void 0===o?void 0:null===(i=o.loginState)||void 0===i?void 0:i.ssoIdentityProviderName;if(!(null!=e&&e.oidcOptions)&&u){await t(eW(u));return}try{null!=e&&e.oidcOptions?await c("https://w.deepl.com","/oidc/logout",e.oidcOptions):(await eD(!0).callMethod("logout"),t((0,a.ZZ)()),await t(tI()),(window.location.pathname.includes("/account")||window.location.pathname.includes("/your-account"))&&!window.location.href.includes("local.deepl.com")&&(window.location.href="/translator"))}catch(e){null!==(r=n())&&void 0!==r&&null!==(l=r.auth)&&void 0!==l&&l.isLoggedIn&&((0,_.bc)({err:e,method:"logout",dispatch:t}),t(P.hP(e)))}},e2=e=>async t=>{if("undefined"!=typeof window)return eD(!0).callMethod("sendPasswordLink",{email:e}).catch(e=>{t(P.hP(e))})},e3=async e=>{try{await eD(!0).callMethod("verifyPasswordResetToken",{...e})}catch(e){var t;throw null!==(t=e.exceptions)&&void 0!==t&&t.find(e=>"not_found_email_token"===e.message)?"messages:not_found_email_token":"messages:error.serverError"}},e5=e=>async t=>{try{var n;let t=await eD(!0).callMethod("resetPassword",{...e});return null==t?void 0:null===(n=t.result)||void 0===n?void 0:n.email}catch(e){throw t(P.hP(e)),e}},e8=e=>{let{subscriptionId:t,countryCode:n,allowed:o,forbidden:i}=e;return async(e,a)=>{var r,l,u;if("undefined"!=typeof window)try{let a=await eB.callMethod("getAvailablePaymentMethods",{subscriptionId:t,countryCode:n,allowed:o,forbidden:i});if(!(null!==(r=a.result)&&void 0!==r&&r.paymentMethods))throw Error("Available payment methods not found in server response");e(J(a.result))}catch(t){null!==(l=a())&&void 0!==l&&null!==(u=l.auth)&&void 0!==u&&u.isLoggedIn&&((0,_.bc)({err:t,method:"getAvailablePaymentMethods",dispatch:e}),e(P.hP(t)))}}},e6=e=>{let{email:t,productId:n,countryCode:o,allowed:i,forbidden:a}=e;return async(e,r)=>{var l,u,d,c,s,p,f;try{let p=null===(l=r())||void 0===l?void 0:null===(u=l.product)||void 0===u?void 0:null===(d=u.list)||void 0===d?void 0:null===(c=d[n])||void 0===c?void 0:c.code,f=await eB.callMethod("getAvailablePaymentMethodsForEmail",{email:t,productCode:p,countryCode:o,allowed:i,forbidden:a});if(!(null!==(s=f.result)&&void 0!==s&&s.paymentMethods))throw Error("Available payment methods not found in server response");e(J(f.result))}catch(t){null!==(p=r())&&void 0!==p&&null!==(f=p.auth)&&void 0!==f&&f.isLoggedIn&&((0,_.bc)({err:t,method:"getAvailablePaymentMethodsForEmail",dispatch:e}),e(P.hP(t)))}}},e7=(e,t)=>async(n,o)=>{if("undefined"==typeof window)return;let{user:i}=o(),a={productId:e,yearly:t,userCountry:i.userCountry},r=e=>{n((0,_.CW)({errorCode:"getCheckoutData error",errorMessage:e,source:"user/getCheckoutData"}))};if(!e||"boolean"!=typeof t){var l,u,d;let o=`invalid parameters: productId=${e}&yearly=${t}`;n(z({error:null===(l=null==o?void 0:null===(u=o.replaceAll(/[\\]/g,""))||void 0===u?void 0:null===(d=u.replaceAll(/[([")("\]")]/g,""))||void 0===d?void 0:d.replaceAll(/\\u([0-9a-f]{4})/g,(e,t)=>String.fromCharCode(parseInt(t,16))))||void 0===l||l})),r(o);return}return new Promise(e=>{eB.callMethod("checkout_getData",a).then(t=>{var o;if(!(null!=t&&t.result)){n(z({error:!0})),r("missing result object"),e(!1);return}if(null!=t&&null!==(o=t.result)&&void 0!==o&&o.needsProductData){n(z({error:!0})),r("needs product data"),e(!1);return}let{_account:a,_addressData:l,...u}=t.result;if(n(D({...i.account,...a})),n(k({...i.address,...l})),n(V({...i.activation})),Object.keys(i.checkoutData).length)n(z(u));else{let e=null==u?void 0:u.subscription,t={...u,subscription:{...e,accountLimit:1}};n(z(t))}u.billingFirstName&&u.billingLastName&&u.billingStreet&&u.billingZip&&u.billingCity&&u.billingCountry?e(!0):e(!1)}).catch(e=>{var t,i,a,l,u,d,c,s;null!==(t=o())&&void 0!==t&&null!==(i=t.auth)&&void 0!==i&&i.isLoggedIn&&((0,_.bc)({err:e,method:"getCheckoutData",dispatch:n}),n(z({error:null===(a=null===(l=e.exceptions)||void 0===l?void 0:null===(u=l[e.exceptions.length-1])||void 0===u?void 0:null===(d=u.message)||void 0===d?void 0:d.replace(/[([")("\]")]/g,"").replace(/\\u([0-9a-f]{4})/g,(e,t)=>String.fromCharCode(parseInt(t,16))))||void 0===a||a})),r(null===(c=e.exceptions)||void 0===c?void 0:null===(s=c[e.exceptions.length-1])||void 0===s?void 0:s.message))})})},te=(e,t,n)=>async(o,i)=>{var a,r,l;let u;if("undefined"!=typeof window){try{if(!(u=await eF.callMethod("CheckVAT",{countryCode:e,vatNumber:t,state:n})))throw Error("Did not receive result from remote");o(eS(null===(a=u)||void 0===a?void 0:a.result))}catch(e){null!==(r=i())&&void 0!==r&&null!==(l=r.auth)&&void 0!==l&&l.isLoggedIn&&((0,_.bc)({err:e,method:"checkVAT",dispatch:o}),o(P.hP(e)))}return new Promise(e=>{e(u)})}},tt={NO_RESPONSE:"setup_intent_no_response",ERROR:"setup_intent_error"},tn=function(e,t,n){void 0===n&&(n=null);let o=(0,w.u)(t),a=`${i.Z.t("messages:error_general_error",{supportLinkOpen:'<a href="https://support.deepl.com/hc/requests/new" target="_blank">',supportLinkClose:"</a>",interpolation:{escapeValue:!1}})} (Error Code: ${o})`;e(e_(n?{[n]:a,...n===h.G4.CREDIT_CARD&&{field:h.sx.CARD_NUMBER}}:a)),e((0,_.C1)({dapEventId:S.qb.PRO_CHECKOUT_PAYMENT_ERROR,dapPageId:"undefined"!=typeof window&&(0,S.ew)(window.location.href),dapEventData:{proCheckoutPaymentErrorData:{errorCode:o}}}))},to=function(e){return void 0===e&&(e=null),async(t,n)=>{var o,i,a,r;if("undefined"!=typeof window)try{let n=await eU.callMethod("CreateSetupIntent");if(!n)return tn(t,tt.NO_RESPONSE,e);if((null==n?void 0:null===(o=n.result)||void 0===o?void 0:o.status)==="error"||!(null!=n&&null!==(i=n.result)&&void 0!==i&&i.secret))return tn(t,tt.ERROR,e);return new Promise(e=>{e(null==n?void 0:n.result)})}catch(e){null!==(a=n())&&void 0!==a&&null!==(r=a.auth)&&void 0!==r&&r.isLoggedIn&&((0,_.bc)({err:e,method:"createSetupIntent",dispatch:t}),t(P.hP(e)))}}},ti=e=>async(t,n)=>{let o;if("undefined"==typeof window)return;let i=new I.ZP("https://backend-l.deepl.com/PHP/backend",L);try{let t=await i.callMethod("handleSetupIntentResult",{result:e});if(t)o=t.result;else throw Error("Did not receive result from remote")}catch(e){var a,r;null!==(a=n())&&void 0!==a&&null!==(r=a.auth)&&void 0!==r&&r.isLoggedIn&&((0,_.bc)({err:e,method:"handleSetupIntentResult",dispatch:t}),t(P.hP(e)))}return new Promise(e=>{e(o)})},ta=(e,t,n,o)=>{let i;let{country:a,state:r}=t,l={VAT:1,QST:2},u=a===E.Lm.CANADA&&r===E.Lm.QUEBEC?l.QST:l.VAT,d={UNSPECIFIED:0,VALID:1,INVALID:2,UNAVAILABLE:3,WRONG_FORMAT:4,COUNTRY_MISMATCH:5};if(null!=o&&o.length&&a!==o)i=d.COUNTRY_MISMATCH;else{var c;let e={[h.RO.FORMALLY_CORRECT]:d.UNAVAILABLE,[h.RO.VALID]:d.VALID,[h.RO.INVALID]:d.INVALID,[h.RO.UNDETECTABLE]:d.WRONG_FORMAT};i=null!==(c=e[n])&&void 0!==c?c:d.UNSPECIFIED}e((0,_.C1)({dapEventId:S.qb.PRO_CHECKOUT_TAX_ID_CHECK,dapPageId:S.k_["/pro-checkout/details/"],dapEventData:{proCheckoutTaxIdCheckData:{taxType:u,result:i}}}))},tr=(e,t)=>async(n,o)=>{let{country:i,isCompany:a,vatNumber:r,state:l}=e;if(a&&r&&(![E.Lm.CANADA,E.Lm.UNITED_STATES].includes(i)||l===E.Lm.QUEBEC)){let a=e=>(e&&t("vatNumber",{type:e}),n(P.LM(!1)),!1);try{let t=await n(te(i,r,l)),{result:o,countryCode:u}=(null==t?void 0:t.result)||{};if(ta(n,e,o,u),!t||o===h.RO.FORMALLY_CORRECT)return a("unavailable");if(o===h.RO.INVALID)return a("invalid");if(o===h.RO.UNDETECTABLE)return a("wrong_format");if(i!==u)return a("country_mismatch")}catch(e){var u,d;return null!==(u=o())&&void 0!==u&&null!==(d=u.auth)&&void 0!==d&&d.isLoggedIn&&((0,_.bc)({err:e,method:"checkoutValidateVAT",dispatch:n}),n(P.hP(e))),a()}}return!0},tl=()=>async()=>{"undefined"!=typeof window&&await eD(!0).callMethod("prepareForCheckout")},tu=()=>async()=>{"undefined"!=typeof window&&await eD(!0).callMethod("finalizeCheckout")},td=(e,t)=>{e((0,_.C1)({dapEventId:S.qb.PRO_CHECKOUT_ADDRESS_VALIDATION,dapPageId:S.k_["/pro-checkout/details/"],dapEventData:{proCheckoutAddressValidationData:{result:t}}}))},tc=(e,t,n)=>async(o,i)=>{let a={accountLimit:e.teamSize,billingCity:e.city,billingCompany:e.isCompany?e.company:"",billingCompanyVATNumber:e.isCompany?e.vatNumber:"",billingCompanyQSTNumber:e.isCompany?e.vatNumber:"",billingCountry:e.country.toUpperCase(),billingFirstName:e.givenName,billingLastName:e.lastName,billingState:e.state,billingStreet:e.street,billingStreetExtension:e.streetExtension,billingZip:e.zip,ccToken:e.ccToken,ddBankName:e.bankName,characterLimit:e.costControlEnabled?e.characterLimit:0,isCompany:e.isCompany,paymentType:e.paymentType,productId:t.productId,yearly:n===v.b6.YEARLY};try{let i=await eB.callMethod("checkout_saveData",a);if(!i||!(null!=i&&i.result)){if(o((0,_.CW)({errorCode:"response missing or null",errorMessage:`productId: ${a.productId}, yearly: ${a.yearly}, country: ${a.billingCountry}`,source:"user/checkoutSendData"})),a.billingCountry===E.Lm.UNITED_STATES)return td(o,h.v8.ERROR),{validationError:h.v8.ERROR};return o(z({error:!0})),!1}let r=await o(e7(t.productId,n===v.b6.YEARLY));if(!r)return!1;let l=null==i?void 0:i.result;if(await o(ew(l)),Object.values(h.v8).includes(null==l?void 0:l.result)){if("US"===e.country.toUpperCase()){let e={[h.v8.NEEDS_CONFIRMATION]:2,[h.v8.BLOCKED]:3,[h.v8.ERROR]:4,[h.v8.INVALID]:5}[null==l?void 0:l.result]||4;return td(o,e),{validationError:null==l?void 0:l.result}}return!1}return"US"===e.country.toUpperCase()&&td(o,1),o(P.kM(!0)),!0}catch(e){var r,l;return null!==(r=i())&&void 0!==r&&null!==(l=r.auth)&&void 0!==l&&l.isLoggedIn&&((0,_.bc)({err:e,method:"checkoutSendData",dispatch:o}),o(P.hP(e))),o(P.LM(!1)),!1}},ts=e=>async(t,n)=>{var o;let i=null===(o=n().user)||void 0===o?void 0:o.checkoutData;await t(z({...i,step:e}))},tp=(e,t,n)=>async(o,a)=>{var r,l,u,d;try{let u;let d=await o(to(t));if(d.error)return o(e_({[t]:d.error.message,...t===h.G4.CREDIT_CARD&&{field:h.sx.CARD_NUMBER}})),o(P.LM(!1)),!1;if(!(null!=d&&d.secret)||!(null!=d&&d.paymentMethodData)){let{code:e=999}=d;return o(e_({[t]:`Error ${e}: ${i.Z.t("pro-checkout-2020:form_error_payment_general")}`,...t===h.G4.CREDIT_CARD&&{field:h.sx.CARD_NUMBER}})),o((0,_.C1)({dapEventId:S.qb.PRO_CHECKOUT_PAYMENT_ERROR,dapPageId:S.k_["/pro-checkout/details/"],dapEventData:{proCheckoutPaymentErrorData:{selectedPaymentMethod:t,errorCode:e}}})),o(P.LM(!1)),!1}let{secret:c,paymentMethodData:{billing_details:s}}=d;switch(t){case h.G4.CREDIT_CARD:u=await e.confirmCardSetup(c,{payment_method:{card:n,billing_details:s}});break;case h.G4.DIRECT_DEBIT:u=await e.confirmSepaDebitSetup(c,{payment_method:{sepa_debit:n,billing_details:s}});break;default:return!1}if(u.error){let{message:e,code:n,decline_code:i}=u.error,a=`${e} (Error Code: ${(0,w.u)(n,i)})`,r={[t]:a,...t===h.G4.CREDIT_CARD&&{field:(0,h.ME)(null!=i?i:n)}};return o(e_(r)),o((0,_.C1)({dapEventId:S.qb.PRO_CHECKOUT_PAYMENT_ERROR,dapPageId:S.k_["/pro-checkout/details/"],dapEventData:{proCheckoutPaymentErrorData:{selectedPaymentMethod:t,errorCode:n+(i?`:${i}`:"")}}})),o(P.LM(!1)),!1}let p=null===(r=a().user)||void 0===r?void 0:r.checkoutData;await o(z({...p,isPaymentMethodCountryAllowed:!0}));let f=await o(ti(u));if((null==f?void 0:f.status)==="error"){let{code:e}=f,n=null!==(l=null==f?void 0:f.message)&&void 0!==l?l:({invalid_card_country:i.Z.t("messages:error_cardCountryNotAllowed")})[e];return o(e_({[t]:n,...t===h.G4.CREDIT_CARD&&{field:h.sx.CARD_NUMBER}})),o((0,_.CW)({errorCode:e,errorMessage:n,source:"user/checkoutHandlePayment"})),o(P.LM(!1)),!1}}catch(e){return null!==(u=a())&&void 0!==u&&null!==(d=u.auth)&&void 0!==d&&d.isLoggedIn&&((0,_.bc)({err:e,method:"checkoutHandlePayment",dispatch:o}),o(P.hP(e))),o(P.LM(!1)),!1}return!0},tf=e=>async t=>{t(e_(null));let{selection:n,paymentInterval:o,formValues:i,setError:a,stripeElement:r,stripe:l}=e;await t(tl());let u=await t(tr(i,a));if(!u)return!1;let d=await t(tc(i,n,o));if(!d)return!1;if(d.validationError)return d;if(i.paymentType===h.G4.CREDIT_CARD&&i.creditCardPersistenceStatus===h.qV.EXISTING||i.paymentType===h.G4.DIRECT_DEBIT&&i.directDebitPersistenceStatus===h.qV.EXISTING||i.paymentType===h.G4.INVOICE)return!0;let c=await t(tp(l,i.paymentType,r));return!!c||(console.info("Payment not handled."),!1)},ty=()=>async e=>{let t=await eB.callMethod("isEligibleForFreeApi");return!!t.result||((0,_.bc)({response:t,method:"checkIfEligibleForFreeApi",dispatch:e}),e(eC({exceptions:[{message:i.Z.t("messages:error_multipleFreeApisOnCheckout")}]})),e(P.LM(!1)),e((0,_.CW)({errorCode:"multiple_free_API",source:"user/checkIfEligibleForFreeApi"})),!1)},tv=(e,t)=>{let{accountLimit:n,yearly:o,selectedProduct:i,paymentType:a,isCompany:r,isReverseCharge:l,isNoVatCharged:u,vatPercent:d}=t||{},{priceMonthlyInEuro:c,priceYearlyInEuro:s}=i||{},p=Math.round(o?s*n*12:c*n)/100,f={credit_card:1,invoice:2,direct_debit:3},y={1:["2000","2100","2300"],2:["3000","3100","3200"],3:["4000","4100"],4:["1100"],5:["1200"]};e((0,_.C1)({dapEventId:S.qb.PRO_CHECKOUT_PURCHASE_COMPLETED,dapPageId:S.k_["/pro-checkout/final/"],dapEventData:{proCheckoutPurchaseCompletedData:{billingPeriod:o?2:1,planName:null!=i&&i.id&&Number.parseInt(Object.keys(y).find(e=>y[e].includes(null==i?void 0:i.id)),10)||0,paymentMethod:f[a]?f[a]:0,customerType:r?2:1,numberOfLicenses:n||0,orderValueEuros:Number((l||u?p/(1+d/100):p).toFixed(2))}}}));let v=null!=i&&i.id&&Number.parseInt(Object.keys(y).find(e=>y[e].includes(null==i?void 0:i.id)),10)||0;1===n&&4!==v&&5!==v&&e((0,_.C1)({dapEventId:403,dapPageId:S.k_["/pro-checkout/final/"],dapEventData:{pro_user_type:"SINGLE_SEAT_USER"}}))},th=function(e,t,n){return void 0===n&&(n={}),async(o,i)=>{if("undefined"==typeof window)return;o(P.LM(!0));let{user:a,product:r}=i(),{availableCountries:l}=a||{},u=new I.ZP("https://www.deepl.com/backend",b,a.interfaceLanguage),{activation:d,checkoutData:c}=a||{},{accountLimit:s,ccSuffix:p,confirmation_revocationBeginningAccepted:f,confirmation_termsAccepted:y,confirmation_termsAccepted:E,confirmation_usageRestrictionAcknowledged:w,marketingAccepted:S,ddSuffix:T,_subscriptionId:g,billingIsCompany:A,billingCompanyVATNumber:L,billingCountry:O,isEligibleForFreeTrial:R,paymentType:N,productId:D,yearly:M,retryCount:k}={...d,...c,...null==c?void 0:c.subscription,...t,...n},U=(0,C.I5)(O,L),B=["GB"].includes(O)&&(0,C.HE)(O,L),F={numberUsers:s,paymentInterval:null!=c&&c.subscription.yearly?v.b6.YEARLY:v.b6.MONTHLY,productId:D},V=(0,h.Jr)(F,null==r?void 0:r.list,l,null==a?void 0:a.userCountry),G=Math.round(U||B?e/(1+V/100):e);D===`${h.Zr.FREE_API}`&&(G=0);let j=[`${h.Zr.DEVELOPER}`,`${h.Zr.FREE_API}`].includes(D),Y={ccSuffix:p,confirmation_revocationBeginningAccepted:f,confirmation_termsAccepted:y,confirmation_termsAcceptedConsumer:E,confirmation_usageRestrictionAcknowledged:j&&w||y||E,marketingAccepted:S,confirmation_consentProductCommunication:!0,ddSuffix:T,displayedPrice:G,id:g,isEligibleForFreeTrial:R,paymentType:N,productId:D,yearly:M,retryCount:k},H={accountLimit:s,yearly:M,selectedProduct:null==r?void 0:r.list[D],paymentType:N,isCompany:A,isReverseCharge:U,isNoVatCharged:B,vatPercent:V};try{var $;await o(tu());let e=await u.callMethod("Confirm",Y);if(!(null!==($=e.result)&&void 0!==$&&$.subscriptionId))throw e;await o(tI()),o(P.xO(!0)),tv(o,H),o((0,_.ac)({event:_.ez.SUBSCRIBE,data:m.Z.cookieToJSON()}))}catch(e){(0,_.bc)({err:e,method:"confirm",dispatch:o}),o(eC(e))}finally{o(P.LM(!1))}}},tm=()=>async(e,t)=>{var n;if("undefined"==typeof window)return;let{user:o}=t(),i=null==o?void 0:null===(n=o.subscription)||void 0===n?void 0:n.id;if(!i)throw Error("no subscription id available");let a=new I.ZP("https://www.deepl.com/backend","/subscription",o.interfaceLanguage);try{let{result:t}=await a.callMethod("calculateTax",{id:i});e(eL(null==t?void 0:t.result))}catch(t){e(eL(t)),(0,_.bc)({err:t,method:"estimateSalesTax",dispatch:e})}},tE=e=>(t,n)=>{var o,i,a,r,l;let u=localStorage.getItem(y.Pd.CLIENT_VARS),d=u?JSON.parse(u):{},c=e,s=null===(o=n())||void 0===o?void 0:null===(i=o.user)||void 0===i?void 0:i.userCountry,p=null===(a=n())||void 0===a?void 0:null===(r=a.releaseGroups)||void 0===r?void 0:null===(l=r.releaseGroups)||void 0===l?void 0:l.find(e=>"DM-1255"===e.name&&2===e.variant);null!=c&&c.proAvailable&&["AR","AU","CL","CO","CR","EC","HK","IN","ID","IL","CI","MY","MA","NZ","NO","PY","PE","PH","SA","TW","TH","TR","AE","UY","VN"].includes(null!=s?s:"")&&(c.proAvailable=!!p),c.clientVars?localStorage.setItem(y.Pd.CLIENT_VARS,JSON.stringify(c.clientVars)):!c.clientVars&&d&&localStorage.removeItem(y.Pd.CLIENT_VARS),c&&t(ey(c))},tw=e=>t=>{e&&(localStorage.setItem(y.Pd.FEATURE_SET,JSON.stringify(e)),t(ev(e)))},tS=(e,t,n)=>{var o;let i=null===(o=n().user)||void 0===o?void 0:o.enterpriseAccount;e&&(!i||i.subscriptionId!==e.subscriptionId)?(localStorage.setItem(y.Pd.ENTERPRISE_ACCOUNT,JSON.stringify(e)),t(P.GC("success_logged_in_company_account")),t(P.pG())):!e&&i&&(localStorage.removeItem(y.Pd.ENTERPRISE_ACCOUNT),t(P.xf("You have been logged out from the enterprise account",6541)),t(P.t0())),t(M(null!=e?e:void 0))};function tI(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),async(n,i)=>{if("undefined"==typeof window)return;if(n(N("fetchClientState")),e){let{isDataUseProhibited:e,activePrivacyConsent:t}=i().privacy;(0,p.Tv)(e,t.includes("PERFORMANCE"),e=>(0,_.bn)(n,i,e))}let r=new I.ZP("https://w.deepl.com","/web"),l={v:"20180814"},d=[],c={};try{c=JSON.parse(window.localStorage.getItem(y.Pd.CLIENT_VARS)||"{}"),d.push.apply(d,(0,o.Z)(Object.keys(c).filter(e=>!/__%|^_persist/.test(e))))}catch(e){console.warn(e)}l.clientVars={},d.length&&d.forEach(e=>{var t,n;let o=(null===(t=c[e])||void 0===t?void 0:t._value)||c[e];if(void 0!==o)try{l.clientVars[e]=null===(n=JSON.parse(o))||void 0===n?void 0:n._value}catch(t){l.clientVars[e]=o}});try{var f,v,h,m,E,w,C,T,g,A,L,b;let e=await r.callMethod("getClientState",l),t=e.result;"#simulate-force-page-reload"===window.location.hash&&(t.updateNecessary=!0,window.location.hash=""),!t.loginState&&(window.location.pathname.includes("/translator")||window.location.pathname.includes("/write-mobile"))&&(0,u.dD)(),t.loginState||s.N0?n(M(void 0)):tS(t.ep,n,i);let o=async(e,t,o)=>{if(!s.N0){let i=new Promise(e=>{setTimeout(e,2e3)}),a=n((0,_.C1)({dapEventId:e,params:{proUser:t,userLoggedIn:o}}));await Promise.race([i,a])}},d=i().auth.loginState;(null==d?void 0:d.accountId)!==(null===(f=t.loginState)||void 0===f?void 0:f.accountId)&&(await o(null!==(w=t.loginState)&&void 0!==w&&w.accountId?S.qb.LOGGED_IN:S.qb.LOGGED_OUT,(null===(C=t.featureSet)||void 0===C?void 0:C.translator.service)==="pro"||(null===(T=t.featureSet)||void 0===T?void 0:null===(g=T.api)||void 0===g?void 0:g.service)==="pro"||(null===(A=t.featureSet)||void 0===A?void 0:null===(L=A.api)||void 0===L?void 0:L.service)==="free",!!(null!==(b=t.loginState)&&void 0!==b&&b.accountId)),n((0,a.av)(t.loginState))),n(tE(t)),n(tw(t.featureSet));let c=null!==(v=t.loginState)&&void 0!==v&&v.accountId?"free":"anonymous";n((0,a.ex)((null===(h=t.featureSet)||void 0===h?void 0:null===(m=h.translator)||void 0===m?void 0:m.service)!=="pro"||!(null!==(E=t.loginState)&&void 0!==E&&E.accountId)&&t.ep&&s.N0?c:"pro")),n((0,a.Xd)(!1))}catch(e){(0,_.bc)({err:e,method:"fetchClientState",dispatch:n}),t&&n(P.hP(e))}n(N("fetchClientState",!1))}}let tC=()=>async e=>{if("undefined"!=typeof window)return e(N("fetchAvailableCountriesGroupedByContinent")),new Promise(t=>{eV.callMethod("getAvailableCountriesGroupedByContinent",[],{}).then(n=>{e(W(n.result.countries)),t(n.result.countries)}).catch(t=>{(0,_.bc)({err:t,method:"fetchAvailableCountriesGroupedByContinent",dispatch:e}),e(P.hP(t)),console.error(t)}).finally(()=>{e(N("fetchAvailableCountriesGroupedByContinent",!1))})})},tT=(e,t)=>async n=>"undefined"==typeof window?new Promise().reject():(n(N("updateEmailAddress")),eD(!0).callMethod("setEmail",{email:e,currentPassword:t}).then(()=>{n(e$()),ej()}).catch(e=>{throw n(P.hP(e)),e}).finally(()=>n(N("updateEmailAddress",!1)))),t_=e=>{let{currentPassword:t,password:n}=e;return async e=>"undefined"==typeof window?new Promise().reject():(e(N("updatePassword")),new Promise((o,i)=>{eD(!0).callMethod("setPassword",{password:n,currentPassword:t}).then(o).catch(t=>{e(P.hP(t)),i(t)}).finally(()=>e(N("updatePassword",!1)))}))},tg=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N("updateDisplayName")),new Promise((n,o)=>{eD(!0).callMethod("setProperties",{name:e}).then(()=>{t(et(e)),ej(),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N("updateDisplayName",!1)))})),tP=e=>new Promise(t=>setTimeout(t,e)),tA=(e,t)=>async n=>{if("undefined"==typeof window)return new Promise().reject();n(N("updateBillingInformation"));try{var o;if(e.isCompany&&e.vatNumber){let o=await n(te(e.country,e.vatNumber,e.state)),{result:i,countryCode:a}=(null==o?void 0:o.result)||{};if(!o||i===h.RO.FORMALLY_CORRECT&&e.state===E.Lm.QUEBEC)throw t("vatNumber",{type:"unavailable"}),i;if(i===h.RO.UNDETECTABLE||i===h.RO.INVALID||e.country!==a)throw t("vatNumber",{type:"invalid"}),i}let i=await eM.callMethod("updateAddress",e);if(Object.values(h.v8).includes(null==i?void 0:null===(o=i.result)||void 0===o?void 0:o.result))return n(N("updateBillingInformation",!1)),i.result;await tP(2e3),await n(ex()),await n(tI()),n(N("updateBillingInformation",!1));return}catch(e){throw n(N("updateBillingInformation",!1)),n(P.hP(e)),e}},tL=e=>async t=>{if("undefined"==typeof window)return new Promise().reject();t(N("updateBillingInformation"));try{await eD(!0).callMethod("setProperties",{locale:e}),t(U(e)),t(N("updateBillingInformation",!1)),await t(eH());return}catch(e){throw t(N("updateBillingInformation",!1)),t(P.hP(e)),e}},tb=e=>async t=>{if("undefined"==typeof window)return new Promise().reject();t(N("updateBillingInformation"));try{await eM.callMethod("updateCustomerReference",{customerReference:e}),t(F(e)),t(N("updateBillingInformation",!1));return}catch(e){throw t(N("updateBillingInformation",!1)),t(P.hP(e)),e}},tO=e=>async t=>{if("undefined"==typeof window)return new Promise().reject();t(N("updateBillingInformation"));try{await eM.callMethod("updateBillingEmail",{billingEmail:e}),t(B(e)),t(N("updateBillingInformation",!1));return}catch(e){throw t(N("updateBillingInformation",!1)),t(P.hP(e)),e}},tR=e=>async(t,n)=>"undefined"==typeof window?new Promise().reject():(await t(e_(null)),t(N("updatePaymentInformation")),new Promise((o,a)=>{let{subscription:r}=n().user;e.paymentType===v.LM.CREDIT_CARD||e.paymentType===v.LM.DIRECT_DEBIT?eU.callMethod("CreateSetupIntent").then(e=>{var n,o;return e?(null==e?void 0:null===(n=e.result)||void 0===n?void 0:n.status)!=="error"&&null!=e&&null!==(o=e.result)&&void 0!==o&&o.secret?(t(tI()),Promise.resolve(e)):tn(t,tt.ERROR):tn(t,tt.NO_RESPONSE)}).then(t=>{let n=e.paymentType===v.LM.CREDIT_CARD?e.stripe.confirmCardSetup:e.stripe.confirmSepaDebitSetup,o={payment_method:{card:e.paymentType===v.LM.CREDIT_CARD?e.stripeElement:void 0,sepa_debit:e.paymentType===v.LM.DIRECT_DEBIT?e.stripeElement:void 0,billing_details:t.result.paymentMethodData.billing_details}};return n(t.result.secret,o)}).then(async e=>{if(e.error){let{message:n}=e.error;throw t(e_(n)),e.error}return eU.callMethod("handleSetupIntentResult",{result:e})}).then(n=>{var r,l,u;if(t(N("updatePaymentInformation",!1)),(null==n?void 0:null===(r=n.result)||void 0===r?void 0:r.status)==="error"){let{code:o=999}=(null==n?void 0:n.result)||{},r=null!==(l=null!==(u=null==n?void 0:n.message)&&void 0!==u?u:({invalid_card_country:i.Z.t("messages:error_cardCountryNotAllowed")})[o])&&void 0!==l?l:`Error ${o}: ${i.Z.t("pro-checkout-2020:form_error_payment_general")}`;t(e_({[e.paymentType]:r,...e.paymentType===h.G4.CREDIT_CARD&&{field:h.sx.CARD_NUMBER}})),a(Error(null==n?void 0:n.result))}else o(n)}).catch(e=>{t(N("updatePaymentInformation",!1)),t(P.hP(e)),a(e)}):eM.callMethod("updatePaymentData",{id:r.id,paymentType:"invoice"}).then(e=>{t(N("updatePaymentInformation",!1)),o(e)}).catch(e=>{t(N("updatePaymentInformation",!1)),t(P.hP(e)),a(e)})})),tN=()=>async(e,t)=>"undefined"==typeof window?new Promise().reject():(e(N("cancelSubscription")),new Promise((n,o)=>{let{user:i}=t();eM.callMethod("cancelSubscription",{action:"CancelSubscription",id:i.subscription.id}).then(()=>{e(eZ()),e((0,_.ac)({event:_.ez.CANCEL,data:m.Z.cookieToJSON()})),n()}).catch(t=>{e(P.hP(t)),o(t)}).finally(()=>e(N("cancelSubscription",!1)))})),tD=()=>async(e,t)=>"undefined"==typeof window?new Promise().reject():(e(N("undoTermination")),new Promise((n,o)=>{let{user:i}=t();eM.callMethod("rescindCancellation",{id:i.subscription.id}).then(()=>{e(eZ()),n()}).catch(t=>{e(P.hP(t)),o(t)}).finally(()=>e(N("undoTermination",!1)))})),tM=function(e){return void 0===e&&(e=!0),async(t,n)=>"undefined"==typeof window?new Promise().reject():(t(N("generateNewApiKey")),new Promise((o,i)=>{let{user:a}=n();eM.callMethod("updateAPIKey",{id:a.subscription.id||a.teamMembership.teamSubscriptionId}).then(n=>{let{result:i}=n;t(en(i.apiKey,e)),o()}).catch(e=>{t(P.hP(e)),i(e)}).finally(()=>t(N("generateNewApiKey",!1)))}))},tk=e=>async(t,n)=>"undefined"==typeof window?new Promise().reject():(t(N("updateCostControlSettings")),new Promise((o,i)=>{let{user:a}=n();eM.callMethod("updateSubscription",{...e,action:"UpdateSubscription",costControl:e.costControl?"1":"0",id:a.subscription.id}).then(()=>{t(eZ()),o()}).catch(e=>{t(P.hP(e)),i(e)}).finally(()=>t(N("updateCostControlSettings",!1)))})),tU=()=>async e=>"undefined"==typeof window?new Promise().reject():(e(N("getSubaccountSettings")),new Promise((t,n)=>{eM.callMethod("getSubaccountSettings").then(n=>{let{result:o}=n;e(eo(o)),t()}).catch(t=>{e(P.hP(t)),n(t)}).finally(()=>e(N("getSubaccountSettings",!1)))})),tB=()=>async e=>"undefined"==typeof window?new Promise().reject():(e(N("generateTeamLink")),new Promise((t,n)=>{eM.callMethod("createInvitationLink").then(()=>{e(tU()),t()}).catch(t=>{e(P.hP(t)),n(t)}).finally(()=>e(N("generateTeamLink",!1)))})),tF=()=>async e=>"undefined"==typeof window?new Promise().reject():(e(N("disableTeamLink")),new Promise((t,n)=>{eM.callMethod("revokeInvitationLink").then(()=>{e(ei()),t()}).catch(t=>{e(P.hP(t)),n(t)}).finally(()=>e(N("disableTeamLink",!1)))})),tV=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N("restrictTeamLinkDomain")),new Promise((n,o)=>{eM.callMethod("setInvitationLinkDomain",{domain:e}).then(()=>{t(ea(e)),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N("restrictTeamLinkDomain",!1)))})),tG=()=>async e=>"undefined"==typeof window?new Promise().reject():(e(N("getTeamAccounts")),new Promise((t,n)=>{eM.callMethod("getTeamAccounts").then(n=>{let{result:o}=n;e(er(o)),t()}).catch(t=>{e(P.hP(t)),n(t)}).finally(()=>e(N("getTeamAccounts",!1)))})),tj=function(e,t){return void 0===t&&(t=!0),async(n,o)=>"undefined"==typeof window?new Promise().reject():(n(N("updateTeamSize")),new Promise((i,a)=>{let{user:r}=o();ek.callMethod("UpdateAccountLimit",{id:r.subscription.id,newAccountLimit:e}).then(()=>{n(eH()),n(tU()),n(tG()),i()}).catch(e=>{var o;t&&n(P.hP(e)),a(Error(!Array.isArray(null==e?void 0:e.exceptions)||(null==e?void 0:null===(o=e.exceptions[0])||void 0===o?void 0:o.message)))}).finally(()=>n(N("updateTeamSize",!1)))}))},tY=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N(`activateSubaccounts_${e}`)),new Promise((n,o)=>{eM.callMethod("activateSubaccounts",{accountIds:[e]}).then(()=>{t(ed(e)),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N(`activateSubaccounts_${e}`,!1)))})),tH=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N(`deactivateSubaccounts_${e}`)),new Promise((n,o)=>{eM.callMethod("disableSubaccounts",{accountIds:[e]}).then(()=>{t(ec(e)),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N(`deactivateSubaccounts_${e}`,!1)))})),t$=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N(`removeSubaccounts_${e}`)),new Promise((n,o)=>{eM.callMethod("removeSubaccounts",{accountIds:[e]}).then(()=>{t(es(e)),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N(`removeSubaccounts_${e}`,!1)))})),tx=e=>async(t,n)=>{var o,i;if("undefined"==typeof window)return new Promise().reject();let{user:a}=n(),r=null!==(o=null==a?void 0:null===(i=a.address)||void 0===i?void 0:i.locale)&&void 0!==o?o:null==a?void 0:a.interfaceLanguage,l=new I.ZP("https://backend-l.deepl.com/PHP/backend",A,r);return t(N("addSubaccountInvitations")),new Promise((n,o)=>{l.callMethod("addSubaccountInvitations",{emails:[e]}).then(()=>{window.setTimeout(()=>{t(tG())},y.st.SUCCESS_MESSAGE_TTL),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N("addSubaccountInvitations",!1)))})},tZ=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N(`revokeSubaccountInvitations_${e}`)),new Promise((n,o)=>{eM.callMethod("revokeSubaccountInvitations",{invitationIds:[e]}).then(()=>{t(es(e)),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N(`revokeSubaccountInvitations_${e}`,!1)))})),tK=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N(`resendInvitationEmail_${e}`)),new Promise((n,o)=>{eM.callMethod("resendInvitationEmail",{invitationIds:[e]}).then(()=>{t(P.GC("success_invitation_mail_sent")),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N(`resendInvitationEmail_${e}`,!1)))})),tq=e=>async t=>{if("undefined"==typeof window)return new Promise().reject();t(N("invitationLinkInfo"));try{let n=await eM.callMethod("getInvitationLinkInfo",{invitationKey:e}),{masterAccount:o,teamName:i}=n.result,a=n.result.emailConstraint||"%";t(eb(o,i,a))}catch(e){throw t((0,_.C1)({dapEventId:S.qb.ACCOUNT_INVALID_INVITATION_LINK,dapPageId:"undefined"!=typeof window&&(0,S.ew)(window.location.href)})),e}finally{t(N("invitationLinkInfo",!1))}},tX=e=>async(t,n)=>{var o;if("undefined"==typeof window)return new Promise().reject();let{user:i}=n(),a=null===(o=n().auth)||void 0===o?void 0:o.isLoggedIn;t(N("registerSubaccount"));try{a&&(!e.email||i.account.email===e.email)?await eD(!0).callMethod("joinTeamByInvitation",{teamInvitationCode:e.teamInvitationCode}):(await t(e0("joinTeamAndLoginOrRegister",0,void 0,e)),await t(tI())),P.GC("joinTeam_successMessage")}finally{t(N("registerSubaccount",!1))}},tW=e=>{let{name:t}=e;return async e=>{let n;if("undefined"==typeof window)return new Promise().reject();e(N("ssoIdentityProvider",!0));try{let n=await (0,r.w)("https://w.deepl.com",O,void 0,{method:"POST",body:JSON.stringify({name:t}),credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();e(eR(o))}catch(t){var o;let e=await t.json();n=null!==(o=null==e?void 0:e.ssoError)&&void 0!==o?o:"SSO99"}finally{e(N("ssoIdentityProvider",!1))}return n}},tQ=()=>async e=>{if("undefined"==typeof window)return new Promise().reject();e(N("ssoIdentityProvider",!0));try{let t=await (0,r.w)("https://w.deepl.com",O,void 0,{method:"GET",credentials:"include"}),n=await t.json();return e(eR(n)),n}catch(t){e((null==t?void 0:t.status)===401?eR(void 0):P.hP(t))}finally{e(N("ssoIdentityProvider",!1))}},tJ=()=>async(e,t)=>{var n,o;let i=null===(n=t().user)||void 0===n?void 0:null===(o=n.ssoIdentityProvider)||void 0===o?void 0:o.name;if(i){e(N("teamSsoConfiguration",!0));try{let t=await (0,r.w)("https://backend.deepl.com",`${R}${i}`,void 0,{method:"GET",credentials:"include"}),n=await t.json();e(eO(n))}catch(t){e(P.hP(t))}finally{e(N("teamSsoConfiguration",!1))}}else e(eO(null))},tz=e=>async(t,n)=>{var o,i,a;if("undefined"==typeof window)return Promise.reject();t(N("teamSsoConfiguration",!0));let l=null===(o=n().user)||void 0===o?void 0:null===(i=o.ssoIdentityProvider)||void 0===i?void 0:i.name,u="";try{await (0,r.w)("https://backend.deepl.com",`${R}${l}`,void 0,{method:"PUT",body:JSON.stringify(e),credentials:"include",headers:{"Content-Type":"application/json"}})}catch(e){if(400===e.status){let t=await e.json();u=null!==(a=null==t?void 0:t.ssoError)&&void 0!==a?a:"SSO99"}else u="SSO99",t(P.hP(e))}finally{await t(tJ()),t(N("teamSsoConfiguration",!1))}return u},t0=e=>async(t,n)=>{var o,i,a;let l=null===(o=n().user)||void 0===o?void 0:null===(i=o.subscription)||void 0===i?void 0:i.ssoConfiguration,u="";try{t(N("teamSsoConfiguration",!0)),await (0,r.w)("https://w.deepl.com","/sso/approve_identity_provider/",{idp:e},{method:"POST",credentials:"include"}),t(eO({...l,enabled:!0})),await t(eN(!0))}catch(e){if(400===e.statusCode){let t=await e.json();u=null!==(a=null==t?void 0:t.ssoError)&&void 0!==a?a:"SSO99"}else u="SSO99",t(P.hP(e))}finally{t(N("teamSsoConfiguration",!1))}return u},t1=e=>async t=>"undefined"==typeof window?new Promise().reject():(t(N("setUserDocumentLimit")),new Promise((n,o)=>{eM.callMethod("setUserDocumentLimit",{limit:e}).then(()=>{t(ep(e)),n()}).catch(e=>{t(P.hP(e)),o(e)}).finally(()=>t(N("setUserDocumentLimit",!1)))})),t4=e=>async t=>{if("undefined"==typeof window)return new Promise().reject();let n=new I.ZP("https://backend-l.deepl.com/PHP/backend",A);return t(N("getConsumption")),new Promise((o,i)=>{n.callMethod("Consumption").then(n=>{let{result:i}=n;t(ef(e?{currentCharacterCount:i.currentCharacterCount,chartData:e(i.chartData)}:i)),o()}).catch(e=>{t(P.hP(e)),i(e)}).finally(()=>t(N("getConsumption",!1)))})},t9=e=>async(t,n)=>"undefined"==typeof window?new Promise().reject():(t(N("checkUpgradePermission")),new Promise((o,i)=>{let{user:{subscription:{id:a}}}=n();eM.callMethod("CheckUpgradePermission",{subscriptionId:a,productId:e}).then(e=>{null!==e.result?o(e.result.error||"1"===e.result):i()}).catch(e=>{t(P.hP(e)),i(e)}).finally(t(N("checkUpgradePermission",!1)))})),t2=(e,t,n,o)=>async(i,a)=>{var r,l,u;try{let i=await eB.callMethod("updateProductBeforeConfirmation",{productId:e,yearly:t,accountLimit:n,country:o});if(!(null!==(r=i.result)&&void 0!==r&&r.success))throw Error("Could not update product.")}catch(e){null!==(l=a())&&void 0!==l&&null!==(u=l.auth)&&void 0!==u&&u.isLoggedIn&&((0,_.bc)({err:e,method:"updateProductBeforeConfirmation",dispatch:i}),i(P.hP(e)))}},t3=function(e,t,n,o,i,a,r){return void 0===n&&(n=null),void 0===r&&(r=!0),async(l,u)=>"undefined"==typeof window?new Promise().reject():(l(N("updateProduct")),new Promise((d,c)=>{let s;let{user:p}=u();switch(!0){case"community"===e&&"developer"===p.subscription.productCode:s="UpdateDeveloperToCommunity";break;case"developer"===e&&"community"===p.subscription.productCode:s="UpdateCommunityToDeveloper";break;case"pro"===p.subscription.productCode:s="UpdateProductFromClassic";break;default:s="UpdateProduct"}ek.callMethod(s,{id:p.subscription.id,productCode:e,billingMonths:t||parseInt(p.subscription.billing_period_id,10),newAccountLimit:n,accountLimit:n,termsAccepted:i,confirmation_termsAccepted:i,..."developer"===e&&{immediateStartAccepted:a},..."developer"===e&&{characterLimit:o}}).then(e=>{var t,n;l(eZ()),null!=e&&null!==(t=e.result)&&void 0!==t&&t.error?c(Error(null==e?void 0:null===(n=e.result)||void 0===n?void 0:n.error)):d(e)}).catch(e=>{r&&l(P.hP(e)),c(e)}).finally(()=>l(N("updateProduct",!1)))}))},t5=function(e,t){return void 0===t&&(t=!0),async(n,o)=>"undefined"==typeof window?new Promise().reject():(n(N("updateProduct")),new Promise((i,a)=>{let{user:r}=o();ek.callMethod("UpdateProduct",{billingMonths:parseInt(r.subscription.billing_period_id,10),id:r.subscription.id,productCode:r.subscription.product.correspondingTeam,newAccountLimit:e.toString()}).then(()=>{window.setTimeout(()=>{n(eZ())},y.st.SUCCESS_MESSAGE_TTL),i()}).catch(e=>{t&&n(P.hP(e)),a(e)}).finally(()=>n(N("updateProduct",!1)))}))},t8=()=>async e=>{if("undefined"==typeof window)return;e(N("leaveTeam"));let t=await eM.callMethod("leaveTeam");return e(e9()),e(N("leaveTeam",!1)),t},t6=e=>async t=>{if("undefined"==typeof window)return;let n=await eG.callMethod("closeNotification",{uid:e});return t(tI()),n},t7=e=>async t=>{let{subscriptionId:n,productCode:o,billingPeriod:i,accountLimit:a}=e,r=Object.values(e).every(Boolean);if(!r)return;let{result:l}=await eM.callMethod("getOneOffSettlement",{subscriptionId:n,productCode:o,billingPeriod:i,accountLimit:a});l?(l.gross=parseFloat(l.gross),l.net=parseFloat(l.net),t(eA(l))):t(eA(null))},ne=e=>async(t,n)=>{let o=await eB.callMethod("checkCurrencyChange",{selectedCountry:e}),i=(null==o?void 0:o.result)!==!1;if(t(eI(i)),!i){var a;let o=(null===(a=n().user)||void 0===a?void 0:a.userCountry)||"??";t((0,_.CW)({errorCode:"currency change",errorMessage:`${o} -> ${e}`,source:"user/checkCurrencyChange"}))}return i},nt=()=>async e=>{e(N("undoDowngrade"));try{return await eM.callMethod("undoDowngrade"),await e(eZ()),e(N("undoDowngrade",!1)),!0}catch(t){throw e(N("undoDowngrade",!1)),e(P.hP(t)),t}},nn=()=>async(e,t)=>{var n,o;return null===(n=t())||void 0===n?void 0:null===(o=n.user)||void 0===o?void 0:o.userCountry}}}]);