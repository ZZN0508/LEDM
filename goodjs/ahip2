(function(){var GET_USE_TYPE="/wapi/zppassport/captcha/getType";var GET_RAND_KEY_URL="/wapi/zppassport/captcha/randkey";var JIYAN_RAND_INIT="/wapi/zppassport/captcha/init";var JIYAN_SDK_URL="https://static.zhipin.com/library/js/plugins/gt.js";var __date=new Date(),timestamp=__date.getFullYear()+""+__date.getMonth()+""+__date.getDay();var MOBILE_SDK_URL="//g.alicdn.com/sd/nch5/index.js?t="+timestamp;var PC_SDK_URL="//g.alicdn.com/sd/ncpc/nc.js?t="+timestamp;function getTimestamp(msec){msec=!msec&&msec!==0?msec:1;return parseInt((new Date()).valueOf()/msec,10)}var NETEASY_SDK_URL="//static.zhipin.com/library/js/sdk/yidun-captcha-v1.0.js?t="+getTimestamp(1*60*1000);var GET_PICTURE_SOURCE="/wapi/zppassport/captcha";function seriesLoadScripts(scripts,callback){if(typeof(scripts)!="object"){var scripts=[scripts]}var HEAD=document.getElementsByTagName("head").item(0)||document.documentElement;var s=new Array(),last=scripts.length-1,recursiveLoad=function(i){s[i]=document.createElement("script");s[i].setAttribute("type","text/javascript");s[i].onload=s[i].onreadystatechange=function(){if(!this.isLoaded&&(!this.readyState||/loaded|complete/.test(this.readyState))){this.isLoaded=true;this.onload=this.onreadystatechange=null;this.parentNode.removeChild(this);if(i!=last){recursiveLoad(i+1)}else{if(typeof(callback)=="function"){callback()}}}};s[i].setAttribute("src",scripts[i]);HEAD.appendChild(s[i])};recursiveLoad(0)}var browser={versions:function(){var u=navigator.userAgent,app=navigator.appVersion;return{trident:u.indexOf("Trident")>-1,presto:u.indexOf("Presto")>-1,webKit:u.indexOf("AppleWebKit")>-1,gecko:u.indexOf("Gecko")>-1&&u.indexOf("KHTML")==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf("Android")>-1||u.indexOf("Adr")>-1,iPhone:u.indexOf("iPhone")>-1,iPad:u.indexOf("iPad")>-1,webApp:u.indexOf("Safari")==-1,weixin:u.indexOf("MicroMessenger")>-1,qq:u.match(/\sQQ/i)==" qq"}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};var HTTP={ajax:function(options){options=options||{};options.timeout=options.timeout||5000;options.type=(options.type||"GET").toUpperCase();options.dataType=options.dataType||"json";if(options.async===false||options.async===true){options.async=options.async}else{options.async=true}options.data=options.data||{};var params=getParams(options.data);var xhr;if(window.XMLHttpRequest){xhr=new XMLHttpRequest()}else{xhr=new ActiveXObject("Microsoft.XMLHTTP")}xhr.onreadystatechange=function(){if(xhr.readyState==4){clearTimeout(options.timer);var status=xhr.status;if(status>=200&&status<300){if(typeof(xhr.responseText)==="string"){try{options.success&&options.success(JSON.parse(xhr.responseText),xhr.responseXML)}catch(err){options.success&&options.success(xhr.responseText,xhr.responseXML)}}else{options.success&&options.success(xhr.responseText,xhr.responseXML)}}else{options.fail&&options.fail(status)}}};if(options.type=="GET"){xhr.open("GET",options.url+"?"+params,options.async);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");if(typeof options.beforeSend==="function"){options.beforeSend()}try{xhr.send(null)}catch(err){clearTimeout(options.timer);options.fail&&options.fail(err.message)}}else{if(options.type=="POST"){xhr.open("POST",options.url,options.async);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");if(options.dataType==="json"){xhr.setRequestHeader("Content-Type","application/json")}else{xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(typeof options.beforeSend==="function"){options.beforeSend()}try{xhr.send(params)}catch(err){clearTimeout(options.timer);options.fail&&options.fail(err.message)}}else{if(options.type=="PUT"){xhr.open("PUT",options.url,options.async);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");if(options.dataType==="json"){xhr.setRequestHeader("Content-Type","application/json")}else{xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(typeof options.beforeSend==="function"){options.beforeSend()}try{xhr.send(options.data)}catch(err){clearTimeout(options.timer);options.fail&&options.fail(err.message)}}}}options.timer=setTimeout(function(){options.fail&&options.fail("timeOut");xhr.abort()},options.timeout);function getParams(data){var arr=[];for(var param in data){arr.push(encodeURIComponent(param)+"="+encodeURIComponent(data[param]))}return arr.join("&")}}};var isInit={ALI_VERIFY:0,JIYAN_VERIFY:0,PICTURE_VERIFY:0,NETEASY_VERIFY:0,TYPE:1,ALI_VERIFY_ARR:[],JIYAN_VERIFY_ARR:[],NETEASY_VERIFY_ARR:[]};function VerifyCodeSDK(options){this.type=options.type;this.dom=options.dom;JIYAN_RAND_INIT=options.getJiYanKeyUrl||JIYAN_RAND_INIT;this.success=options.success||function(){};this.fail=options.fail||function(){};this.ready=options.ready||function(){};this.delayLoad=options.delayLoad;if(!this.dom||typeof(options.dom.setAttribute)!=="function"){this.fail("传入dom异常");return}this.captchaInfo=options.captchaInfo||{};this.myData=options.myData||{};
this.selfData=null;if(this.type){this.goLoad();return}var _this=this;HTTP.ajax({url:GET_USE_TYPE,type:"GET",success:function(data){if(data.code==0){var type=data.zpData.captchaType;_this.type=type;_this.captchaInfo=data.zpData||{};_this.goLoad();_this.ready({type:type,el:_this.dom})}},fail:function(){}})}VerifyCodeSDK.prototype.goLoad=function(){var el=this.dom;var _this=this;if(this.delayLoad){try{var remove_doms=el.getElementsByClassName("geetest_fullpage_click");for(var i=0;i++;i<remove_doms.length){var deleDom=remove_doms[i];deleDom.parentNode.removeChild(deleDom)}var remove_doms=el.getElementsByClassName("geetest_holder");if(remove_doms.length){var deleDom=remove_doms[0];deleDom.parentNode.removeChild(deleDom)}var remove_doms=el.getElementsByClassName("verify-init-btn");if(remove_doms.length){var deleDom=remove_doms[0];deleDom.parentNode.removeChild(deleDom)}}catch(err){}var btnDom=document.createElement("div");btnDom.setAttribute("class","verify-init-btn");btnDom.innerHTML='<span class="verify-init-dot"></span>点击按钮进行验证';el.appendChild(btnDom);var handler=function(){btnDom.removeEventListener("click",handler);_this.nextStep()};btnDom.addEventListener("click",handler)}else{this.nextStep()}};VerifyCodeSDK.prototype.nextStep=function(){var dom=this.dom;var type=this.type;var success=this.success;var fail=this.fail;var myData=this.myData;var captchaInfo=this.captchaInfo;var delayLoad=this.delayLoad;switch(type){case 1:this.selfData=new JiyanSDK({dom:dom,success:success,fail:fail,myData:myData,delayLoad:delayLoad});break;case 2:this.selfData=new AliSDK({dom:dom,success:success,fail:fail,myData:myData});break;case 3:this.selfData=new PictureSDK({dom:dom,success:success,fail:fail,myData:myData});break;case 4:this.selfData=new NetEasySDK({dom:dom,success:success,fail:fail,myData:myData,captchaInfo:captchaInfo});break;default:this.type=isInit.TYPE;this.goLoad();break}};VerifyCodeSDK.prototype.getInputValue=function(){var value="";if(this.type===3){value=this.selfData.getInputValue()}return value};VerifyCodeSDK.prototype.reset=function(){this.goLoad()};function OtherPlatformSDK(options){this.type=options.type;this.dom=options.dom;this.success=options.success||function(){};this.fail=options.fail||function(){};this.ready=options.ready||function(){};if(!this.dom||typeof(options.dom.setAttribute)!=="function"){this.fail("传入dom异常");return}this.myData=options.myData||{};this.selfData=null;if(this.type!==1&&this.type!==2&&this.type!==3){this.fail("传入type无效");return}else{if(this.type===1){this.gt=options.gt;this.challenge=options.challenge}else{if(this.type===3){this.getPictureUrl=options.getPictureUrl;this.randKey=options.randKey}}}this.goLoad()}OtherPlatformSDK.prototype.goLoad=function(){var dom=this.dom;var type=this.type;var success=this.success;var fail=this.fail;var myData=this.myData;switch(type){case 1:var gt=this.gt;var challenge=this.challenge;if(!gt||!challenge){this.fail("传入参数异常gt||challenge");return}this.selfData=new JiyanSDK({dom:dom,success:success,fail:fail,gt:gt,challenge:challenge});break;case 2:this.selfData=new AliSDK({dom:dom,success:success,fail:fail,myData:myData});break;case 3:var getPictureUrl=this.getPictureUrl;var randKey=this.randKey;if(!getPictureUrl||!randKey){this.fail("传入参数异常getPictureUrl||randKey");return}this.selfData=new PictureSDK({dom:dom,success:success,fail:fail,getPictureUrl:getPictureUrl,randKey:randKey});break;default:this.type=isInit.TYPE;this.goLoad();break}};OtherPlatformSDK.prototype.reset=function(data){if(this.type==1){this.gt=data.gt;this.challenge=data.challenge;if(!this.gt||!this.challenge){this.fail("传入参数异常gt||challenge");return}}else{if(this.type==3){this.getPictureUrl=data.getPictureUrl;this.randKey=data.randKey;if(!this.getPictureUrl||!this.randKey){this.fail("传入参数异常getPictureUrl||randKey");return}}}this.goLoad()};OtherPlatformSDK.prototype.getInputValue=function(){var value="";if(this.type===3){value=this.selfData.getInputValue()}return value};function JiyanSDK(options){this.dom=options.dom;this.success=options.success;this.fail=options.fail;this.myData=options.myData;this.delayLoad=options.delayLoad;var _this=this;var gt=options.gt;var challenge=options.challenge;var _flag=false;var data={};if(gt&&challenge){_flag=true;data={gt:gt,challenge:challenge}}if(isInit.JIYAN_VERIFY===0){isInit.JIYAN_VERIFY=1;isInit.JIYAN_VERIFY_ARR.push(_this);seriesLoadScripts(JIYAN_SDK_URL,function(){isInit.JIYAN_VERIFY=2;for(var k=0;k<isInit.JIYAN_VERIFY_ARR.length;k++){if(_flag){isInit.JIYAN_VERIFY_ARR[k].doing(data)}else{isInit.JIYAN_VERIFY_ARR[k].reset()}}})}else{if(isInit.JIYAN_VERIFY===1){isInit.JIYAN_VERIFY_ARR.push(_this)}else{if(isInit.JIYAN_VERIFY===2){if(_flag){_this.doing(data)}else{_this.reset()}}}}}JiyanSDK.prototype.reset=function(){var el=this.dom;if(!el){return false}var _this=this;HTTP.ajax({url:GET_RAND_KEY_URL,type:"GET",success:function(res){if(res.code==0){_this.getKey({randKey:res.zpData.randKey})}}})};JiyanSDK.prototype.getKey=function(datas){var _this=this;if(_this.myData&&_this.myData.token){datas.token=_this.myData.token
}HTTP.ajax({url:JIYAN_RAND_INIT,type:"POST",data:datas,dataType:"form",success:function(result){if(result.code==0){var data=null;if(result.zpData&&result.zpData.startCaptcha){try{data=JSON.parse(result.zpData.startCaptcha)}catch(err){_this.fail("数据异常");return}}else{_this.fail("数据异常");return}_this.doing(data)}else{_this.fail(result.message)}}})};JiyanSDK.prototype.doing=function(data){var _this=this;initGeetest({gt:data.gt,challenge:data.challenge,offline:false,new_captcha:true,product:"float",width:"100%",height:"30px"},function(captchaObj){var el=_this.dom;try{var remove_doms=el.getElementsByClassName("verify-init-btn");if(remove_doms.length){var deleDom=remove_doms[0];deleDom.parentNode.removeChild(deleDom)}captchaObj.appendTo(el)}catch(err){}captchaObj.onReady(function(){var remove_doms=el.getElementsByClassName("geetest_holder");if(remove_doms.length){var deleDom=remove_doms[0];deleDom.parentNode.removeChild(deleDom)}if(_this.delayLoad){var timer=setTimeout(function(){var geetestRadarTipDom=el.getElementsByClassName("geetest_radar_tip")[0];if(document.all){geetestRadarTipDom.click()}else{var e=document.createEvent("MouseEvents");e.initEvent("click",true,true);geetestRadarTipDom.dispatchEvent(e)}});timer=null}}).onSuccess(function(){var result=captchaObj.getValidate();var parmas={challenge:result.geetest_challenge,validate:result.geetest_validate,seccode:result.geetest_seccode,el:_this.dom,type:1};_this.success(parmas)}).onError(function(error){_this.fail(error)})})};function AliSDK(options){this.dom=options.dom;this.success=options.success;this.fail=options.fail;this.isMobile=browser.versions.mobile;this.loadURL=this.isMobile?MOBILE_SDK_URL:PC_SDK_URL;this.myData=options.myData;var _this=this;if(isInit.ALI_VERIFY===0){isInit.ALI_VERIFY=1;isInit.ALI_VERIFY_ARR.push(_this);seriesLoadScripts(_this.loadURL,function(){isInit.ALI_VERIFY=2;for(var k=0;k<isInit.ALI_VERIFY_ARR.length;k++){isInit.ALI_VERIFY_ARR[k].reset()}})}else{if(isInit.ALI_VERIFY===1){isInit.ALI_VERIFY_ARR.push(_this)}else{if(isInit.ALI_VERIFY===2){_this.reset()}}}}AliSDK.prototype.reset=function(){if(this.isMobile){this.loadMobile()}else{this.loadPC()}};AliSDK.prototype.loadPC=function(){var _this=this;if(typeof(_this.dom.getAttribute)!=="function"){_this.fail("传递dom异常");return}var dom_id="verrify"+Math.random().toString(32).substr(-6,6);this.dom.setAttribute("id",dom_id);var option=this.myData;var nc_token=["BOSS_PC",(new Date()).getTime(),Math.random().toString(16)].join(":");var NC_Opt={renderTo:"#"+dom_id,appkey:option.appkey||"FFFF0N00000000006DC1",scene:option.scene||"nc_login",token:nc_token,customWidth:option.width||"100%",trans:{"position":"sign-sms"},elementID:["sign-sms"],is_Opt:0,language:"cn",isEnabled:true,timeout:3000,times:5,apimap:{},callback:function(data){data.type=2;data.platForm="pc";data.el=_this.dom;data.csig=data.sig;data.csessionId=data.csessionid;delete (data.sig);delete (data.csessionid);data.ctoken=nc_token;if(typeof _this.success==="function"){_this.success(data)}},error:function(err){if(typeof _this.fail==="function"){_this.fail(err)}}};var nc=new noCaptcha(NC_Opt);nc.upLang("cn",{_startTEXT:"请按住滑块，拖动到最右边",_yesTEXT:"验证通过",_error300:'哎呀，出错了，点击<a href="javascript:__nc.reset()">刷新</a>再来一次',_errorNetwork:'网络不给力，请<a href="javascript:__nc.reset()">点击刷新</a>',})};AliSDK.prototype.loadMobile=function(){var _this=this;var option=this.myData;if(typeof(_this.dom.getAttribute)!=="function"){_this.fail("传递dom异常");return}var dom_id="verrify"+Math.random().toString(32).substr(-6,6);this.dom.setAttribute("id",dom_id);var nc_token=["BOSS_H5",(new Date()).getTime(),Math.random().toString(16)].join(":");var nc=NoCaptcha.init({renderTo:"#"+dom_id,appkey:option.appkey||"FFFF0N00000000006DC1",scene:"nc_login_h5",token:nc_token,customWidth:"100%",trans:{"position":"sign-h5"},elementID:["sign-h5"],is_Opt:0,language:"cn",timeout:10000,retryTimes:5,errorTimes:5,inline:false,apimap:{},bannerHidden:false,initHidden:false,callback:function(data){if(typeof _this.success==="function"){data.type=2;data.platForm="mobile";data.el=_this.dom;data.csig=data.sig;data.csessionId=data.csessionid;delete (data.sig);delete (data.csessionid);data.ctoken=nc_token;_this.success(data)}},error:function(err){if(typeof _this.fail==="function"){_this.fail(err)}}});NoCaptcha.setEnabled(true);nc.reset();NoCaptcha.upLang("cn",{"LOADING":"加载中...","SLIDER_LABEL":"请向右滑动验证","CHECK_Y":"验证通过","CHECK_N":"验证未通过",})};function PictureSDK(options){this.dom=options.dom;this.success=options.success;this.fail=options.fail;this.getPictureUrl=options.getPictureUrl;this.randKey=options.randKey;if(this.getPictureUrl&&this.randKey){this.getImage();return}var _this=this;HTTP.ajax({url:GET_RAND_KEY_URL,type:"GET",success:function(res){if(res.code==0){_this.randKey=res.zpData.randKey;_this.getImage()}}})}PictureSDK.prototype.getImage=function(){var _this=this;var _dom=this.dom;_dom.innerHTML="";var url=GET_PICTURE_SOURCE+"?randomKey="+this.randKey;if(this.getPictureUrl){url=this.getPictureUrl+"?randomKey="+this.randKey
}var imageDom=document.createElement("img");imageDom.setAttribute("src",url);imageDom.setAttribute("class","code_img");imageDom.setAttribute("style","height:30px;display: inline-block;margin-left:15px;");var inputDom=document.createElement("input");inputDom.setAttribute("placeholder","请输入验证码");inputDom.setAttribute("class","input_code ipt");inputDom.setAttribute("style","width: 100px;height:30px;display: inline-block;position: relative;top:-9px;");var boxDOM=document.createElement("div");boxDOM.setAttribute("class","picture_box");boxDOM.setAttribute("style","width:100%;min-height:30px;");boxDOM.appendChild(inputDom);boxDOM.appendChild(imageDom);_dom.appendChild(boxDOM);imageDom.onload=function(){if(typeof _this.success==="function"){var data={randKey:_this.randKey,type:3,el:_this.dom};_this.success(data)}};if(!_this.getPictureUrl){imageDom.addEventListener("click",function(){HTTP.ajax({url:GET_RAND_KEY_URL,type:"GET",success:function(res){if(res.code==0){_this.randKey=res.zpData.randKey;imageDom.setAttribute("src",GET_PICTURE_SOURCE+"?randomKey="+_this.randKey)}}})})}imageDom.onerror=function(err){_this.fail(err)}};PictureSDK.prototype.getInputValue=function(){var dom=this.dom.getElementsByClassName("input_code")[0];var value="";if(dom){value=dom.value}return value};function NetEasySDK(options){this.dom=options.dom;this.success=options.success;this.fail=options.fail;this.myData=options.myData||{};this.captchaInfo=options.captchaInfo||{};if(isInit.NETEASY_VERIFY===0){isInit.NETEASY_VERIFY=1;isInit.NETEASY_VERIFY_ARR.push(this);seriesLoadScripts(NETEASY_SDK_URL,function(){isInit.NETEASY_VERIFY=2;for(var k=0;k<isInit.NETEASY_VERIFY_ARR.length;k++){isInit.NETEASY_VERIFY_ARR[k].reset()}})}else{if(isInit.NETEASY_VERIFY===1){isInit.NETEASY_VERIFY_ARR.push(this)}else{if(isInit.NETEASY_VERIFY===2){this.reset()}}}}NetEasySDK.prototype.reset=function(){var _this=this;if(typeof(this.dom.getAttribute)!=="function"){this.fail("传递dom异常");return}var dom_id="verrify"+Math.random().toString(32).substr(-6,6);this.dom.setAttribute("id",dom_id);initNECaptchaWithFallback({element:"#"+dom_id,captchaId:this.captchaInfo.wyCaptchaId||"",mode:this.myData.mode||"float",width:this.myData.width||"100%",height:this.myData.height||"30px",onVerify:function(err,data){if(err){return}_this.success({type:4,el:_this.dom,validate:data.validate,wyCaptchaId:_this.captchaInfo.wyCaptchaId})}},function(instance){},function(error){_this.fail(error)})};window.VerifyCodeSDK=VerifyCodeSDK;window.OtherPlatformSDK=OtherPlatformSDK}());