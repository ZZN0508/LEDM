"use strict";(self.webpackChunk_deepl_gatsby=self.webpackChunk_deepl_gatsby||[]).push([[6886],{58425:function(e,t,n){n.d(t,{SA:function(){return o},Xk:function(){return l}});var a,r,i=n(77396);let s=0,o=((a={}).TRIGGER__SOURCE_LANG_CHANGED="TRIGGER__SOURCE_LANG_CHANGED",a.TRIGGER__TARGET_LANG_CHANGED="TRIGGER__TARGET_LANG_CHANGED",a.TRIGGER__SOURCE_TEXT_CHANGED_WHILE_TYPING="TRIGGER__SOURCE_TEXT_CHANGED_WHILE_TYPING",a.TRIGGER__SOURCE_TEXT_CHANGED="TRIGGER__SOURCE_TEXT_CHANGED",a.TRIGGER__FAILSAFE_CHECK="TRIGGER__FAILSAFE_CHECK",a.TRIGGER__UNSPECIFIED="",a),l=((r={}).TYPE__TRANSLATE_SOURCE="TYPE__TRANSLATE_SOURCE",r.TYPE__SMART_EDIT_REQUEST="TYPE__SMART_EDIT_REQUEST",r.TYPE__DUMMY="TYPE__DUMMY",r),c=function(){function e(e,t,n){void 0===n&&(n=o.TRIGGER__UNSPECIFIED),this._id=void 0,this._running=!1,this.targetIsPredefined=!1,this.splitSentenceRequestUsed=void 0,this.detectSourceLangInTranslation=void 0,this.type=void 0,this.trigger=void 0,this.langContext=void 0,this.onSentenceSplittingReceived=(0,i.$)(),this.onRequestEnded=(0,i.$)(),this.sourceTextAreaContentSnapshot=void 0,this._id=++s,this.type=t,this.trigger=n,this.langContext=e}var t=e.prototype;return t.isRunning=function(){return this._running},t.start=function(){this._running=!0},t.stop=function(){this._running=!1,this.onRequestEnded()},e}();t.ZP=c},35728:function(e,t,n){var a=n(61606),r=n(75671),i=n(88141);a.Z.defineType("/translator/core/langPreference",["/translator/webTranslatorCore","/translator/core/config"],(e,t)=>{let n="[langPreference]",{langConfig:a}=e._internalLanguageManagement,s="1.0.0.0",o=t.get("isWriteMode")?"preferredLangWeightsWrite":"preferredLangWeights",l=`LMT_langDetection.${o}`,c=(0,r.O)(l,{},2592e3),g=(0,r.O)("LMT_langDetection.version",s);function u(){let e={...c()};return Object.keys(e).forEach(t=>{(!a[t]||"number"!=typeof e[t]||Number.isNaN(e[t]))&&delete e[t]}),e}function d(e,t,r){if(!t||!a[t]){console.warn(n,`language not supported: ${t}`);return}if("number"!=typeof r||Number.isNaN(r)||r<0){console.warn(n,`invalid weight: ${r}`);return}e[t]=Math.round(1e6*r)/1e6}function h(e){let t=u(),n=Object.entries(e);if(0!==n.length)n.forEach(e=>{let[n,r]=e;if(a[n]){var i;let e=t[n],a=(i=1e-5)*Math.floor((.97*(e||0)+r)/i);d(t,n,a)}}),t&&c(t)}!function(){var e;let n=g()===s,r=u();n&&0!==Object.keys(r).length||((e=r=function(){let e={};(t.get("il")||"").substr(0,2).toUpperCase(),[{lang:"DE",weight:.18566},{lang:"EN",weight:.41238},{lang:"ES",weight:.09657},{lang:"FR",weight:.13952},{lang:"IT",weight:.02701},{lang:"JA",weight:.03904},{lang:"NL",weight:.02651},{lang:"PL",weight:.01376},{lang:"PT",weight:.01421},{lang:"RU",weight:.01584},{lang:"ZH",weight:.02671}].filter(e=>void 0!==a[e.lang]).forEach(t=>d(e,t.lang,t.weight));let n=(t.get("il")||"").substr(0,2).toUpperCase();return a[n]&&e[n]&&d(e,n,.4),e}())&&c(e),g(s))}();let p=(0,i.Sc)(500,e=>h(e));return{getPreferredLangs:function(){let e=function(){let e=u(),t=Object.entries(e).sort((e,t)=>{let[n,a]=e,[r,i]=t;return a-i}).map(e=>{let[t,n]=e;return t});return t}();return e},getLanguagePreference:function(){let e=u(),t={weight:{...e},default:"default"};return t},pushPreferredLang:function(e){let t=Object.keys(a),n={};t.forEach(e=>{n[e]=0}),n[e]=1,h(n),u()},pushDetectedLanguages:function(e){let t=Object.entries(e);0!==t.length&&(e={...e},Object.keys(a).forEach(t=>{e[t]||(e[t]=0)}),p(e))},test:{preferredLangWeights:c}}})},24810:function(e,t,n){var a=n(61606),r=n(30171),i=n(58425);a.Z.defineType("/translator/core/loadingTranslation",["core/requestHandling","core/textareas"],(e,t)=>{let n=(0,r.S3)(!1),a=(0,r.S3)(!!t.getTargetText());return(0,r.S1)([e.hasPendingRequestsOfType(i.Xk.TYPE__TRANSLATE_SOURCE),t.isSourceTextEmpty],(e,t)=>{n(e&&!t)}),t.onTargetTextChanged.push(()=>{a(!!t.getTargetText())}),{isLoading:n,hasPartialTargetText:a}})},72757:function(e,t,n){var a=n(61606),r=n(98808);a.Z.defineType("/translator/core/networkStatus",[],()=>{let e=(0,r.f)(),t=(0,r.f)(),n=(0,r.f)();return{onRPCCallFailed:e,onRPCCallSucceeded:t,onRequestFailed:n}})},80909:function(e,t,n){var a=n(30171);n(61606).Z.defineType("/translator/core/observeSourceTextAndLanguage",["webTranslatorCore","/translator/core/textareas"],(e,t)=>{let n=(0,a.S3)(!0);return e.features.with(["/translator/core/selectedLanguages"],e=>{e.onSourceLanguageChanged.push(e=>{n(!1)})}),t.onSourceTextChangedPreview.push(()=>{n(!0)}),{sourceTextModifiedAfterLastSourceLanguageChange:n}})},71716:function(e,t,n){var a=n(30171),r=n(61606),i=n(84627),s=n(58425);r.Z.defineType("/translator/core/requestHandling",[],()=>{let e=(0,i.fo)(),t=(0,i.S3)(!1),n=new Map,r=e=>{let t=n.get(e);void 0===t?n.set(e,(0,i.S3)(1)):t(t()+1)},o=e=>{let t=n.get(e);void 0===t?n.set(e,(0,i.S3)(0)):t(t()-1)},l=0,c=new Set;return{hasPendingRequests:t,hasPendingRequestsOfType(e){let t=n.get(e);return void 0===t&&(t=(0,i.S3)(0),n.set(e,t)),(0,a.G7)(t,e=>e>0)},onRequestContextStarted:e,waitForPendingRequests:async()=>new Promise((e,n)=>{let a=()=>{t()?t.onValueChanged.push(()=>(setTimeout(a),"REMOVE")):e()};a()}),startRequestContext(n,a,i){void 0===i&&(i=s.SA.TRIGGER__UNSPECIFIED);let g=new s.ZP(n,a,i);return(c.add(g),g.isRunning())?console.warn("request already running",g):(g.start(),g.onRequestEnded.push(()=>{--l,o(a),t(l>0)}),g.onRequestEnded.push(()=>c.delete(g)),++l,r(g.type),t(l>0),e(g)),g},dbg_getActiveRequests:()=>c}})},18563:function(e,t,n){var a=n(52425),r=n(61606),i=n(93843),s=n(69496),o=n(51102),l=n(83115);r.Z.defineType("/translator/core/richTextHandling",[],()=>({updateSourceSentencesHtml:function(e,t){let n=JSON.parse(t),r=a.vm.createNodeTreeFromDescription(n),c=0;e.forEach((e,t)=>{let n=e.getWhitespacesBefore().length+e.getRawTrimmedText().length+e.getWhitespacesAfter().length,a=e.getTrimmedHtml(),g=r?(0,i._n)(r,c+e.getWhitespacesBefore().length,e.getRawTrimmedText().length):(0,s.p$)(e.getRawTrimmedText()),u=r?(0,i.GB)(r,c+e.getWhitespacesBefore().length):void 0;if(e.setTrimmedHtml(g),u?e.setParagraph({tag:u.tag}):e.setParagraph(o.g),a!==g&&e.translation){let t=l.Z.create(e.getRawTrimmedText());t.setSourceHtml(e.getTrimmedHtml()),t.setDetectedLanguages(e.translation.detectedLanguages),e.translation=t}c+=n})},updateTargetSentencesHtml:function(e,t){let n=JSON.parse(t),r=a.vm.createNodeTreeFromDescription(n),l=0;e.forEach((e,t)=>{let n=e.getWhitespacesBefore(),a=e.getWhitespacesAfter(),c=e.getInnerText(),g=e.getText(),u=r?(0,i._n)(r,l+n.length,c.length):(0,s.p$)(e.getInnerText()),d=r?(0,i.GB)(r,l):void 0;e.getHtml().updateOuter((0,s.p$)(n),u,(0,s.p$)(a)),d?e.setParagraph({tag:d.tag}):e.setParagraph(o.g),l+=g.length})},getTextareaSnapshot:function(e){return JSON.stringify(e.toDescription())}}))},22133:function(e,t,n){n.d(t,{Cc:function(){return a},Hk:function(){return i},L$:function(){return g},X3:function(){return s},kX:function(){return r},oo:function(){return o}});let a="[^\\S\r\n]",r=/^\s*/g,i=/\s*$/;function s(e){let t=e.match(/(^\s*)$/g);if(t)return t[0];{let t=e.match(RegExp(`
(${a}*)$`));return t?t[1]:""}}let o="^\\s*$",l=`^${a}*(?=\\S)`,c=`^\\s*
(?=${a}*\\S)`,g=RegExp(`${o}|${l}|${c}`,"g")},79298:function(e,t,n){var a=n(4769),r=n(61606),i=n(30171);r.Z.defineType("/translator/core/targetLanguages",["/translator/core/languageManagement","/translator/core/config"],(e,t)=>{let n=(0,i.S3)(e.getSelectedTargetLangSettings());e.onSelectedTargetLangSettingsChanged.push(e=>{n(e)});let r=t=>{e.setUserSelectedTargetLangSettings({lang:t.lang,variant:t.variant})},s=()=>e.getSelectableTargetLangEntries(),o=e=>{let n=t.get("il");return(0,a.Z)(e).sort((e,t)=>e.label.localeCompare(t.label,n))};return{currentLanguage:n,setCurrentLanguage:r,getLanguages:s,sortLanguages:o}})},22308:function(e,t,n){var a=n(35208),r=n(61606),i=n(84627),s=n(30171),o=n(25889),l=n(69496);r.Z.defineType("/translator/core/textareas",["/translator/core/domElements","/translator/webTranslatorCore","/translator/core/config","/translator/core/richTextHandling"],(e,t,n,r)=>{let c,g;let{sourceEdit:u,targetEdit:d}=e,h=n.get("isRtfEnabled");function p(){return u.dTextarea}function f(){return d.dTextarea}let T=new WeakMap;function _(e){let n="",a="",r=(0,i.fo)({allowReplay:!0}),o=(0,i.fo)({allowReplay:!0});function l(t,i){void 0===t&&(t="update"),void 0===i&&(i=!1);let l=e.value,c=h?e.dTextarea.getHtml():"",g=h?a!==c:n!==l;if(g){n=l,a=c;let e=(0,s.S3)(!0);r(n,t,i,e),e()&&o(n,t,i)}}if(e.addEventListener("input",t=>{"insertFromPaste"===t.inputType?l("paste"):!0===T.get(e)?l("replace"):l("typing")}),e.addEventListener("keyup",e=>l("typing")),e.addEventListener("dta_undo",e=>l("update")),e.addEventListener("change",e=>l("typing")),e.addEventListener("dl-programmatic-change",e=>l("update")),e.addEventListener("paste",e=>{l("paste"),setTimeout(()=>l("paste"))}),e.addEventListener("drop",e=>{l("update"),setTimeout(()=>l("update"))}),""!==e.value&&e===u){let e=t._domInternals.sourcePasted,n=e?"paste":"typing";setTimeout(()=>l(n))}return{checkForChangedText:l,onTextChangedPreview:r,onTextChanged:o,getText:()=>n}}let S=_(u),E=_(d),v=t.sourceIsEmpty,m=(0,i.fo)();v.onValueChanged.push(e=>e&&m());let C=(0,s.S3)(!0);function R(t,n,r){if(void 0===r&&(r=!1),""===(n=n.replace(/[\x00-\x08\x0B-\x1f\x7F\xAD]/g,""))){t.value="",t.focus({preventScroll:!0}),A(t);return}if(t.value===n){console.warn("[updateTextareaText]","the updated text was identical to the original text, hence we abort update and focus textarea to keep cursor position"),t.focus({preventScroll:!0});return}let i=window.scrollY;if(c||!g){let i=t.value;try{if(e.isSelectionInTextarea(t)||t.focus({preventScroll:!0}),!e.isSelectionInTextarea(t)){t.value=n,A(t);return}let{commonPrefixLength:s,changedPartInFirstString:l,changedPartInSecondString:c}=o.ZP.getStringChangeRange(i,n);if(t.setSelectionRange(s,s+l.length),T.set(t,!0),document.execCommand("insertText",!1,c),t instanceof a.dTextareaComponent&&t.dTextarea._applyDomChanges(),setTimeout(()=>T.set(t,!1)),t.value!==n){t.value=n;let e=r?s:s+c.length;t.setSelectionRange(e,e)}else r&&t.setSelectionRange(s,s)}finally{g||i===n||(g=!0,t.value===n?c=!0:(c=!1,t.value=n))}}else t.value=n;window.scrollY!==i&&window.scrollTo(0,i),A(t)}function x(e){if(e instanceof a.dTextareaComponent){let t=e.dTextarea.getFirstLevelNodes(),n=t.map(e=>({text:e.collectText(),node:e}));return n.filter(e=>""!==e.text)}return(0,o.KU)(e.value).map(e=>({text:e,node:void 0}))}function L(e){return e instanceof a.dTextareaComponent?r.getTextareaSnapshot(e.dTextarea):e.value}function A(e){let t=new Event("dl-programmatic-change",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)}function b(){return e.isSelectionInSourceTextarea()?e.sourceEdit:e.isSelectionInTargetTextarea()?e.targetEdit:void 0}function I(e,t){if(!e)return console.warn("[_insertTextViaValue]","no active textarea found",e),!1;let n=e.selectionStart,a=e.selectionEnd,r=e.value;return e.value=r.substr(0,n)+t+r.substr(a),e.setSelectionRange(n+t.length,n+t.length),A(e),!0}return E.onTextChanged.push(e=>{C(0===e.length)}),{isSourceTextEmpty:v,isTargetTextEmpty:C,onSourceTextChangedPreview:S.onTextChangedPreview,onSourceTextChanged:S.onTextChanged,onTargetTextChangedPreview:E.onTextChangedPreview,onTargetTextChanged:E.onTextChanged,onSourceTextBecomesEmpty:m,getSourceText:function(){return u.value},getSourceHtml:function(){if(h){var e,t;return null!==(e=null===(t=u.dTextarea)||void 0===t?void 0:t.getHtml())&&void 0!==e?e:""}{console.warn("attempting to get html from non web component source text area");let e=u.value;e=(0,l.p$)(e);let t=e.split("\n");return t.map(e=>`<div>${e.length>0?e:"<br>"}</div>`).join("")}},getTargetText:function(){return d.value},getTargetHtml:function(){if(h){var e,t;return null!==(e=null===(t=d.dTextarea)||void 0===t?void 0:t.getHtml())&&void 0!==e?e:""}{console.warn("attempting to get html from non web component target text area");let e=d.value;e=(0,l.p$)(e);let t=e.split("\n");return t.map(e=>`<div>${e.length>0?e:"<br>"}</div>`).join("")}},updateTextareaText:function(e,t,n){void 0===n&&(n=!1),R(e,t,n);let a=e===u?S.checkForChangedText:E.checkForChangedText;a("update",!0)},updateSourceText:(e,t)=>{R(u,e,t)},updateTargetText:(e,t)=>{R(d,e,t)},setSourceTextExplicitly:function(e,t,n,a){if(void 0===t&&(t="update"),void 0===n&&(n=!1),void 0===a&&(a=!1),u.value=e,S.checkForChangedText(t,n),a){let e=document.createEvent("Event");e.initEvent("dl-programmatic-change",!0,!0),u.dispatchEvent(e)}},updateSourceHtml:function(e,t,n,a){if(void 0===t&&(t="update"),void 0===n&&(n=!1),void 0===a&&(a=!1),u.dTextarea.updateHtml(e),S.checkForChangedText(t,n),a){let e=document.createEvent("Event");e.initEvent("dl-programmatic-change",!0,!0),u.dispatchEvent(e)}},setTargetTextExplicitly:function(e,t){void 0===t&&(t="update"),e!==d.value&&(d.value=e,E.checkForChangedText(t))},updateTargetHtml:function(e,t){void 0===t&&(t="update"),d.dTextarea.updateHtml(e),E.checkForChangedText(t)},getSourceParagraphs:()=>x(u),getTargetParagraphs:()=>x(d),getSourceDTextarea:p,getTargetDTextarea:f,updateTargetTextareaDOM(){var e;null===(e=f())||void 0===e||e.applyInternalMetaChanges()},updateSourceTextareaDOM(){var e;null===(e=p())||void 0===e||e.applyInternalMetaChanges()},isNewTextareaActive:function(){return e.isNewTextareaActive()},insertTextIntoActiveTextarea:function(t){let n=!1;return e.isNewTextareaActive()?n=I(b(),t):(n=function(e){let t=!1;try{t=document.execCommand("insertText",!1,e)}catch(e){console.warn("[_insertTextWithExecCommand]",e)}return t}(t))||(n=I(b(),t)),n},getSourceTextareaSnapshot:()=>L(u),getTargetTextareaSnapshot:()=>L(d)}})},3190:function(e,t,n){var a=n(30171),r=n(67974),i=n(61606),s=n(98808),o=n(58425),l=n(41941),c=n(69748),g=n(69496),u=n(83115),d=n(94982),h=n(51102);i.Z.defineType("/translator/core/translateSourceSentences",["/translator/core/translationBackend","/translator/core/requestHandling","/translator/core/languageManagement","/translator/core/triggerSourceTranslation","/translator/core/updateSourceSentences","/translator/core/networkStatus","/translator/core/textareas","/translator/core/config","globalState"],(e,t,n,i,p,f,T,_,S)=>{let E="[translateSourceSentences]",v=(0,s.f)(),m=(0,s.f)(),C=(0,s.f)(),R=(0,s.f)(),x=(0,s.f)(),L=(0,s.f)(),A=(0,s.f)(),b=(0,s.f)(),I=(0,s.f)(),O=_.get("isRtfEnabled");R.push(()=>{b({type:"initialTranslation"})});let N=!1,y=null,P=!1;function w(e,t){let n=new Map;e.sourceSentences.filter(function(e){let n=e.translation;return void 0===n.getTargetText()||n.status===u.Z.STATUS__OBSOLETE||n.status===u.Z.STATUS__READY__PREDEFINED&&n.requiresMetadataUpdate()||n.status===u.Z.STATUS__READY__FAST_QUALITY&&t!==o.SA.TRIGGER__SOURCE_TEXT_CHANGED_WHILE_TYPING}).forEach(e=>{n.set(e.getChain(),[])}),e.sourceSentences.forEach(e=>{n.has(e.getChain())&&n.get(e.getChain()).push(e)});let a=function(e,t){let n=0,a=[];return t.forEach(t=>{let r=t.map(e=>e.translation),i=[],s="";t.forEach((e,t)=>{let a=e.translation;if(i.push({text:O?a.getSourceHtml():a.getSourceText(),id:n+=1,prefix:e.getWhitespacesBefore()}),a.isTargetTextPredefined()){if(0===t){var r;s=null!==(r=a.getTargetText())&&void 0!==r?r:""}else console.warn(`Chaining warning! translation at index ${t} has a target text predefined`)}});let o={kind:l.Z.JOB_KIND__DEFAULT,sentences:i};if(e.isContextEnabled()){let e=(0,c.rU)(t[0]),n=(0,c.rU)(t[t.length-1]);o.raw_en_context_before=e.prefix,o.raw_en_context_after=n.postfix}if(s&&(o.de_sentence_beginning=s),1===e.sourceSentences.length||_.get("isWriteMode")?o.preferred_num_beams=4:o.preferred_num_beams=1,_.get("isWriteMode")){let n=1===e.sourceSentences.length&&1===t.length;o.write_variant_requests=n?["main","variants"]:["main"]}a.push({job:o,translations:r})}),a}(e,n);return a}function U(s,l){let d=s.langContext,h=(0,a.S3)([]);A(s,h);let m=(0,a.S3)(1e4);I(m),(0,r.AV)(`sourceTranslation${d.getId()}`,async()=>(await new Promise(e=>{(0,a.S1)(h,t=>{t&&0!==t.length||e()})}),new Promise((a,h)=>{if(!n.isActiveLangContext(d)){h(r.AV.FAILURE_REASON__CANCELED);return}let S=w(d,s.trigger);if(!S.length){s.stop(),C(s),a();return}if(_.get("CONFIG__USE_FAST_TYPING_REQUESTS")&&s.trigger===o.SA.TRIGGER__SOURCE_TEXT_CHANGED_WHILE_TYPING&&1===S.length&&1===S[0].translations.length){let e=S[0];e.job.quality="fast",_.get("CONFIG__USE_FAST_TYPING_REQUESTS__DEV_MOCKUP")&&(e.translations[0].status=u.Z.STATUS__REQUESTS_FAST__DEV_TEST)}l<1&&(S.length>1||S[0].translations.length>1)&&(l=1);let m={target_lang:n.getSelectedTargetLang()};s.detectSourceLangInTranslation?m.preference=n.getLanguagePreference():m.preference={weight:{},default:"default"},s.detectSourceLangInTranslation?m.source_lang_user_selected=n.getUnifiedSelectedSourceLanguageOrAuto():m.source_lang_computed=n.getActiveLangContext().getSourceLang();let R=d.createJobSettings(m,l),A=e.sendTranslationJobs_batched(S.map(e=>e.job),R,_.get("CONFIG__TRANSLATION_JOB_BATCH_SIZE")),b=0;function I(e){s.stop(),A.stopped(!0),f.onRequestFailed("translation",e),l<0?h(e):a()}x(s,A),A.next().then(function e(r){let l=r.currentBatchId(),h=r.getCurrentResult();if(!n.isActiveLangContext(d)){s.stop(),a();return}if(!h){C(s),a();return}let m=h.source_lang,R=h.target_lang;if(m&&R&&0===l){if(s.trigger===o.SA.TRIGGER__SOURCE_LANG_CHANGED&&"auto"!==n.getUnifiedSelectedSourceLanguageOrAuto()&&m!==n.getUnifiedSelectedSourceLanguageOrAuto()){s.stop(),a();return}s.detectSourceLangInTranslation||m===d.getSourceLang()||(console.warn(`BUG in Scheduler. Source language has been determined and cannot be changed. receivedSourceLang=${m}`),m=d.getSourceLang());let e=h.detectedLanguages;if(e&&n.pushDetectedLanguages(e),d.getSourceLang()!==m||d.getTargetLang()!==R){if(d.getTargetLang()&&d.getTargetLang()!==R&&console.warn("Should not happen: state.getTargetLang()!==receivedTargetLang ",d.getTargetLang(),R),!N&&!s.splitSentenceRequestUsed&&d.sourceSentences.length>1&&d.getSourceLang()){N=!0;let e=(e,t)=>t(!0);p.doCheckIfSentenceSplittingShouldBeEnforced.push(e),T.onSourceTextBecomesEmpty.push(()=>(N=!1,p.doCheckIfSentenceSplittingShouldBeEnforced.remove(e),"REMOVE")),setTimeout(()=>i.triggerTranslationUpdate(t.startRequestContext(n.getActiveLangContext(),o.Xk.TYPE__TRANSLATE_SOURCE,s.trigger)))}else n.notifyChangedSourceLangDetected(m);s.stop(),a();return}}let x=h.translations,A=[],y=!1;x.forEach(e=>{let t=S[b].translations,n=h.detectedLanguages;b+=1,t.length&&t[0].status===u.Z.STATUS__REQUESTS_FAST__DEV_TEST&&(e.quality="fast"),t.forEach((t,a)=>{t.setDetectedLanguages(n);let r={...e};r.beams=e.beams.map(e=>{let t={...e};return t.sentences=[e.sentences[a]],delete t.num_symbols,t});let i=[];if(e.beams.length){let n=[];e.beams.forEach(e=>{let t=e.sentences[a],r=t.text,s=O?(0,g.Sl)(r):r,o=O?r:(0,g.p$)(r);n.push({text:s,html:o,rephraseVariant:e.rephrase_variant});let{ids:l,text:c,...u}=t;i.push(u)});let s=n[0].text,o=n[0].html,l=t.isTargetTextPredefined();"fast"===e.quality?t.status=u.Z.STATUS__READY__FAST_QUALITY:t.status=u.Z.STATUS__READY,_.get("CONFIG__USE_FAST_TYPING_REQUESTS__DEV_MOCKUP")&&t.status===u.Z.STATUS__READY__FAST_QUALITY&&(s=s.toUpperCase()),!l&&(t.setTargetText(s),O&&t.setTargetHtml(o)),t.setAlternativeTranslationTexts(n.slice(1)),t.setTranslationResult(r)}else t.setTargetText(""),O&&t.setTargetHtml(""),t.setAlternativeTranslationTexts([]),t.setTranslationResult(r),y=!0;A.push({translation:t,translationMetaDataForBeams:i})})}),v(A),y&&(console.warn(E,"Empty beams!"),console.warn(E,"Job wrappers:",S),console.warn(E,"Result:",h)),x.length<r.getNumberOfJobsInCurrentBatch()?(r.stopped(!0),L(s),C(s),n.notifyTranslationLanguageChanged(),a()):x.length!==r.getNumberOfJobsInCurrentBatch()?(r.stopped(!0),f.onRequestFailed("translation",(0,c.$H)("LMT_ERROR_TYPE__UNEXPECTED")),n.notifyTranslationLanguageChanged(),a()):r.finished()?(C(s),n.notifyTranslationLanguageChanged(),a()):r.next().then(e).catch(I)}).catch(I)})),m()).then(e=>{}).catch(e=>{if(e===r.AV.FAILURE_REASON__CANCELED)s.stop();else if(e===r.AV.FAILURE_REASON__TIMEOUT);else if(l<0){s.stop(),console.warn(e),S.GSTATE__TYPING_REQUESTS_BLOCKED_UNTIL=Date.now()+_.get("CONFIG__BLOCK_TYPING_REQUEST_DURATION");let a=t.startRequestContext(d,o.Xk.TYPE__DUMMY);setTimeout(()=>a.stop(),1.1*_.get("CONFIG__SEND_BACKUP_REQUEST_DELAY")),(0,r.wx)("assureSourceTranslationIsRequested",()=>{i.triggerTranslationUpdate(t.startRequestContext(n.getActiveLangContext(),o.Xk.TYPE__TRANSLATE_SOURCE,o.SA.TRIGGER__SOURCE_TEXT_CHANGED))},_.get("CONFIG__SEND_BACKUP_REQUEST_DELAY"))}else s.stop()})}function G(e){var t,n,a,r,i;let s=e.getSourceSentence(),o=s.translation;if(null===(t=o.getTargetText())||void 0===t||t.trim(),s.getTextRev()>=e.getTextRev()){let t=[];0>e.getWhitespacesBeforeRev()&&void 0!==o.additionalData.predefinedWhitespaceBefore?(t.push(o.additionalData.predefinedWhitespaceBefore),e.updateWhitespacesBeforeRev()):s.getWhitespacesBeforeRev()>e.getWhitespacesBeforeRev()?(t.push(s.getWhitespacesBefore()),e.updateWhitespacesBeforeRev(s.getWhitespacesBeforeRev())):t.push(e.getWhitespacesBefore());let l=o.getTargetText(),c="[...]";if(void 0===l){e.allowTextToBeResetByTranslation();let n=s.previousTranslations?s.previousTranslations.slice(0):[];for(;;){let e=n.shift();if(e){if(e.getTargetText()){c=null!==(i=e.getTargetHtml())&&void 0!==i?i:"",t.push(e.getTargetText());break}}else{t.length&&"[...] "===t[t.length-1]||t.push("[...] ");break}}}else e.setTextRev(s.getTextRev()),t.push(l);if(0>e.getWhitespacesAfterRev()&&void 0!==o.additionalData.predefinedWhitespaceAfter)t.push(o.additionalData.predefinedWhitespaceAfter),e.updateWhitespacesAfterRev();else if(s.getWhitespacesAfterRev()>=e.getWhitespacesAfterRev()){let n=s.getWhitespacesAfter();l&&/[ ？。．！]$/.test(l)&&n.startsWith(" ")?n=n.substr(1):n||!s.nextSentence||s.nextSentence.getWhitespacesBefore()||(n=" "),t.push(n),e.updateWhitespacesAfterRev(s.getWhitespacesAfterRev())}else t.push(e.getWhitespacesAfter());e.clearCache(),e.updateRawText(t.join(""),void 0!==l,!1),O&&e.getHtml().updateOuter((0,g.p$)(e.getWhitespacesBefore()),null!==(n=o.getTargetHtml())&&void 0!==n?n:c,(0,g.p$)(e.getWhitespacesAfter())),O&&e.setParagraph(null!==(a=null===(r=e.getSourceSentence())||void 0===r?void 0:r.getParagraph())&&void 0!==a?a:h.g),e.setTextRev(s.getTextRev())}else s.getWhitespacesBeforeRev()>e.getWhitespacesBeforeRev()&&(e.updateRawText(s.getWhitespacesBefore()+e.getText().trimStart(),!0,!0),e.updateWhitespacesBeforeRev(s.getWhitespacesBeforeRev()),O&&e.getHtml().updateWhitespacesBefore((0,g.p$)(e.getWhitespacesBefore()))),s.getWhitespacesAfterRev()>e.getWhitespacesAfterRev()&&(e.updateRawText(e.getText().trimEnd()+s.getWhitespacesAfter(),!0,!0),e.updateWhitespacesAfterRev(s.getWhitespacesAfterRev()),O&&e.getHtml().updateWhitespacesAfter((0,g.p$)(e.getWhitespacesAfter())))}return p.onSourceSentencesChanged.push(e=>{y=e._id,P=!0,U(e,e.trigger===o.SA.TRIGGER__SOURCE_TEXT_CHANGED_WHILE_TYPING?-1:1)}),C.push(e=>{let t=e.langContext;e.stop();let a=t.sourceSentences.slice(0),r=t.targetSentences.splice(0),i=t.targetSentences,s=[];for(;r.length&&r[0].getSourceSentence()===a[0];){let e=r.shift();G(e),i.push(e),s.push(e),a.shift()}let o=[];for(;r.length&&r[r.length-1].getSourceSentence()===a[a.length-1];){let e=r.pop();G(e),o.unshift(e),a.pop(),s.push(e)}for(;a.length&&r.length;){let e=a.shift(),t=r.shift();t.setSourceSentence(e),G(t),i.push(t),s.push(t)}for(;a.length;){let e=a.shift(),t=d.Z.create("");t.setSourceSentence(e),G(t),i.push(t),s.push(t)}for(;r.length;)r.shift();for(;o.length;){let e=o.shift();i.push(e)}if(s.length&&m(s),n.isActiveLangContext(t)){if(O){let e=d.Z.getJoinedHtml(i);T.updateTargetHtml(null!=e?e:"","update")}else{let e=d.Z.getJoinedText(i);T.setTargetTextExplicitly(e,"update")}if(y===e._id||P){var l;null===(l=T.getTargetDTextarea())||void 0===l||l.resetUndoStack(),P=!1}R(t,[])}}),{onBatchedTranslationRequestStarted:x,onFinalizeTranslations:v,onFinalizeUpdatedTargetSentences:m,onPartialTranslationReceived:L,onTargetSentencesHaveChanged:R,onTranslationReady:b,onTranslationsHaveChanged:C,onDefineTranslationRequestTimeout:I,collectReasonsToDelayTranslation:A,triggerTranslationUpdate(e){void 0===e&&(e=o.SA.TRIGGER__UNSPECIFIED);let a=t.startRequestContext(n.getActiveLangContext(),o.Xk.TYPE__TRANSLATE_SOURCE,e);a.detectSourceLangInTranslation=!1,U(a,1)},testInterface:{createJobsForSentencesToTranslate:w}}})},64514:function(e,t,n){var a=n(61606),r=n(98808),i=n(30171),s=n(84627),o=n(98824),l=n(25889),c=n(10878);let g=function(){this.chainedSentenceBlocks=[],this.detectedLang=void 0,this.langIsConfident=void 0,this.splitSentenceRequestUsed=void 0,this.detectedLanguages=void 0},u=(e,t)=>`${JSON.stringify(e)}:${JSON.stringify(t.langConfig)}:${JSON.stringify(t.requestParams||"")}:${JSON.stringify(t.commonJobParams||"")}`,d=(e,t,n)=>`${JSON.stringify(t)}:${JSON.stringify(e)}:${null!=n?n:"translate"}`,h=function(){function e(e){void 0===e&&(e=400),this._maxSize=e,this._cache=new Map}var t=e.prototype;return t.size=function(){return this._cache.size},t.set=function(e,t){this._cache.set(e,t),this._cache.size>=this._maxSize&&this.garbageCollect()},t.get=function(e){return this._cache.get(e)},t.clear=function(){this._cache.clear()},t.getFirstKey=function(){return this._cache.keys().next()},t.garbageCollect=function(){let e=this._cache.size,t=this._maxSize/2,n=this._cache.keys();for(;e>t;){let t=n.next().value;this._cache.delete(t),e-=1}},e}();function p(e){return{errorType:"LMT_ERROR_TYPE__UNEXPECTED",message:e}}function f(e,t){return{errorType:c.ri,rpcError:e,statusCode:e&&e.data&&e.data.status,trigger:t}}function T(e,t,n){return o.C.connectTo({url:e,timeout:12e4,withCredentials:t,responseWithMetadata:n,f_str:(e,t)=>e.replace('hod":"',(t+3)%13==0||(t+5)%29==0?'hod" : "':'hod": "')})}function _(e,t){return void 0===t&&(t=5e3),e+Math.floor(Math.random()*Math.min(t,Math.floor(e/2)))}let S=function(){function e(e){let{url:t,enableJobCaching:n=!0,isScheduler:a=!0,withCredentials:r,rpcConfig:i,doFinalizeJobRequestParameters:o=(0,s.fo)(),doFinalizeSentenceSplittingRequestParameters:l=(0,s.fo)(),dbg:c=!1}=e;this._translationJobCache=void 0,this._splitTextCache=void 0,this.onRequestSucceeded=(0,s.fo)(),this.onSplitSentenceResultReceived=(0,s.fo)(),this.onTranslationsReceived=(0,s.fo)(),this.onRequestFailed=(0,s.fo)(),this.rpcConfig=void 0,this.conf_splittingRequestBatchSize=1e4,this.doFinalizeJobRequestParameters=void 0,this.doFinalizeSentenceSplittingRequestParameters=void 0,this._dbg=void 0,this._enableJobCaching=void 0,this._isScheduler=void 0,this._rpc_splitTextIntoChains=void 0,this._rpc_sendTranslationJobs=void 0,this._rpc_sendAdditionalData=void 0,this._translationJobCache=new h,this._splitTextCache=new h,this.rpcConfig=i,this.doFinalizeJobRequestParameters=o,this.doFinalizeSentenceSplittingRequestParameters=l,this._dbg=c,this._enableJobCaching=n,this._isScheduler=a,void 0===r&&(r=t.startsWith("https://")),this._rpc_splitTextIntoChains=T(t,r,!0).getFunction("LMT_split_text");let g=T(t,r,!0).getFunction("LMT_handle_jobs");this._rpc_sendTranslationJobs=(e,t)=>{let n=1,r=Date.now(),i=e;return i.jobs&&i.jobs.forEach(e=>{e.sentences&&e.sentences.forEach(e=>{n+=((e.text||"").match(/[i]/g)||[]).length})}),a&&(i.timestamp=r+(n-r%n)),g(i,t)},this._rpc_sendAdditionalData=a?T(t,r,!1).getFunction("LMT_handleAdditionalData"):()=>new Promise(()=>{throw Error("Additional data handling is not available!")})}var t=e.prototype;return t.requestSentenceSplitting=function(t,n,a,r,i){void 0===a&&(a="translations"),void 0===r&&(r="translate"),void 0===i&&(i=!1);let s=this;return new Promise((c,u)=>{let h=s._dbg;h&&console.log("[sentenceSplitting] Request.",t);let p=new g,T="TRIGGER__SOURCE_LANG_CHANGED"===a||"TRIGGER__TARGET_LANG_CHANGED"===a,S=d(t,n,r),E=s._splitTextCache.get(S);if(s._enableJobCaching&&E){h&&console.debug("using cached split text result",S),c(E);return}if(!i&&(!t||!t.length||1===t.length&&t[0].length<200&&!t[0].match(/[.!?;":？。．！\u037e].*\S.*$/m)&&!T)){t&&t.length>0&&p.chainedSentenceBlocks.push([[t[0]]]),h&&console.log("[sentenceSplitting] textblocks not complex enough for a request"),p.splitSentenceRequestUsed=!1,c(p);return}h&&console.log("[sentenceSplitting] textblocksToRequest.",t);let v=l.ZP.splitIntoBatches(t,s.conf_splittingRequestBatchSize,e=>e.length);h&&console.log("[sentenceSplitting] Request batches:",JSON.stringify(v));let m=function(t){void 0===t&&(t=0);let a=performance.now();if(v.length){let i=v[0];h&&console.log("[sentenceSplitting] BATCH:",i);let l={texts:i,commonJobParams:{mode:r},lang:n};s.doFinalizeSentenceSplittingRequestParameters(l);let c=s._rpc_splitTextIntoChains;c(l).then(t=>{v.shift();let n=t.data,r=t.metadata,i=performance.now()-a,o=e.prepareRequestTimings(r,i);s.onRequestSucceeded("splitting",i,o),s.onSplitSentenceResultReceived(n,o),n.texts.forEach(e=>{let t=e.chunks.map(e=>e.sentences.map(e=>e.text));p.chainedSentenceBlocks.push(t)}),void 0===p.detectedLang&&(p.detectedLang=n.lang.detected,p.langIsConfident=n.lang.isConfident,p.splitSentenceRequestUsed=!0,p.detectedLanguages=n.lang.detectedLanguages),m()},n=>{let r=n.metadata,i=n.error,l=performance.now()-a,c=e.prepareRequestTimings(r,l);s.onRequestFailed("splitting",i,l,c);let g=t||0;if(console.warn(`[sentenceSplitting] Error during splitting request (retryNr ${g}: `,i),g>=3||i&&i.errorType===o.Z.REQUEST_FAILED&&i.data&&403===i.data.status)u(f(i,"splitting"));else{let e=3e3+5e3*g;console.log(`[sentenceSplitting] Trying again in ${e=_(e)}ms!`),setTimeout(()=>{m(g+1)},e)}})}else s._splitTextCache.set(S,p),c(p)};m()})},t.dev_clearTranslationCache=function(){this._translationJobCache.clear(),console.log("[TranslationJobHandler] Clear cache!")},t.sendTranslationJobs=function(t,n,a){void 0===a&&(a=!1);let r=this,i=performance.now();return new Promise((s,l)=>{let c=r._dbg,{langConfig:g}=n,d=void 0===n.priority?1:n.priority,h=u(t,n),T=r._translationJobCache.get(h);if(r._enableJobCaching&&T)c&&console.log("Using cached translation job result.",n),s(T);else{let u=function(T){let S={jobs:t,lang:g,priority:d};n.commonJobParams&&(r._isScheduler?S.commonJobParams=n.commonJobParams:t.forEach(e=>Object.assign(e,n.commonJobParams))),n.requestParams&&Object.assign(S,n.requestParams),r.doFinalizeJobRequestParameters(S),r._rpc_sendTranslationJobs(S,r.rpcConfig).then(n=>{let a=n.data,o=n.metadata,c=performance.now()-i,u=e.prepareRequestTimings(o,c),{translations:d}=a;if(r.onRequestSucceeded("translation",c,u),r.onTranslationsReceived(a,d,t,g,u),!Array.isArray(d)){console.warn("Invalid result:"),console.log("<<<< Result: "),console.log(JSON.stringify(a)),console.log(">>>>"),l(p("Invalid translation results."));return}d.length===t.length&&r._translationJobCache.set(h,a),s(a)},t=>{let n=t.metadata,s=t.error,g=performance.now()-i,d=e.prepareRequestTimings(n,g);c&&console.log("[LMT_Backend]","rpcError",s);let h=s.data.responseData&&s.data.responseData.timeout;if(r.onRequestFailed("translation",s,g,d),console.warn(`[sendTranslationJobs] Error during translation request (retryNr ${T}: `,s),1042901===s.code||1042902===s.code||1042911===s.code||1042912===s.code||!h&&!a||T>=3||s&&s.errorType===o.Z.REQUEST_FAILED&&s.data&&(403===s.data.status||456===s.data.status))l(f(s,"translation"));else{let e;console.log(`[sendTranslationJobs] Trying again in ${e=_(e=h?1e3*parseFloat(s.data.responseData.timeout):3e3+5e3*T)}ms!`),setTimeout(()=>{u(T+1)},e)}})};u(0)}})},t.sendTranslationJobs_batched=function(e,t,n){let a;let r="undefined"!=typeof TextEncoder?new TextEncoder:void 0,i=e=>r?r.encode(JSON.stringify(e)).length:JSON.stringify(e).length,o=l.ZP.splitIntoBatches(e,n,i),c=0,g=0,d=[],h=(0,s.S3)(-1),f=(0,s.S3)(!1),T=(0,s.S3)(!1),_=(0,s.S3)(!1),S=this;o.forEach(e=>{let n=u(e,t),a=S._translationJobCache.get(n);!a&&++c;let r=0;e.forEach(e=>{e.sentences&&e.sentences.forEach(e=>{r+=e.text.length})}),g+=r,d.push(r)});let E={mode:"sequential",currentBatchId:h,isLastBatch:_,getCurrentResult:()=>a,getNumberOfJobsInCurrentBatch:()=>o[h()].length,next:()=>new Promise((e,n)=>{if(E.finished()){n(p("Already finished!"));return}h(h()+1);let r=o[h()];_(h()>=o.length-1),S.sendTranslationJobs(r,t,t.priority>0).then(t=>{E.numRemainingCharacters(E.numRemainingCharacters()-d[h()]),a=t,(_()||f())&&T(!0),e(E)},e=>{f(!0),T(!0),n(e)})}),finished:T,stopped:f,numCharactersToTranslate:(0,s.S3)(g),numRemainingCharacters:(0,s.S3)(g),numNotCachedBatchesToTranslate:(0,s.S3)(c)};return E},t.sendAdditionalData=function(e){return this._rpc_sendAdditionalData(e,this.rpcConfig)},e.prepareRequestTimings=function(e,t){var n,a,r,i,s,o,l,c;let g=null==e?void 0:e.serverTiming,u={duration:t,handshakeDuration:null!==(n=null==g?void 0:null===(a=g.l7_lb_tls)||void 0===a?void 0:a.duration)&&void 0!==n?n:0,idleDuration:null!==(r=null==g?void 0:null===(i=g.l7_lb_idle)||void 0===i?void 0:i.duration)&&void 0!==r?r:0,requestReceiveDuration:null!==(s=null==g?void 0:null===(o=g.l7_lb_receive)||void 0===o?void 0:o.duration)&&void 0!==s?s:0,totalDuration:null!==(l=null==g?void 0:null===(c=g.l7_lb_total)||void 0===c?void 0:c.duration)&&void 0!==l?l:0};return u},e}();"undefined"!=typeof window&&window.M&&window.M.registerAsync("LMT_Backend",S),a.Z.defineType("/translator/core/translationBackend",["/translator/core/config","/translator/core/networkStatus"],(e,t)=>{let n=(0,i.S3)(void 0===e.get("backend.translationEndpoint")),a=(0,i.S3)(e.get("backend.translationEndpoint")||e.get("backend.scheduler")),s=(0,i.S3)(e.get("backend.splittingEndpoint")||e.get("backend.scheduler")),o=(0,r.f)(),l=(0,r.f)(),c=(0,r.f)(),g=(0,r.f)(),u=(0,r.f)(),d=(0,r.f)(),h=(0,r.f)(),p={translation:(0,i.G7)([a,n],(e,t)=>f(e,t)),sentenceSplitting:(0,i.G7)([s],e=>f(e))};function f(n,a){let r=new S({url:n,isScheduler:a,doFinalizeJobRequestParameters:o,doFinalizeSentenceSplittingRequestParameters:l,enableJobCaching:!e.get("disableCaches")});return r.onRequestSucceeded.push(function(){t.onRPCCallSucceeded(),c.apply(void 0,arguments)}),r.onRequestFailed.push(function(){t.onRPCCallFailed(),d.apply(void 0,arguments)}),r.onTranslationsReceived.push(function(){u.apply(void 0,arguments)}),r.onSplitSentenceResultReceived.push(function(){g.apply(void 0,arguments)}),r}return e.get("backend.testUserBlocking")&&(0,i.S1)(p.translation,e=>{e.rpcConfig={queryParams:{"x-simulate-too-many-requests":"1"}}}),{translationBackend:p.translation,sentenceSplittingBackend:p.sentenceSplitting,onRequestSucceeded:c,onSplitSentenceResultReceived:g,onTranslationsReceived:u,onRequestFailed:d,onSelectTranslationBackend:h,registerCustomBackends:function(e){Object.keys(e).forEach(t=>{p[t]=e[t]})},doFinalizeJobRequestParameters:o,doFinalizeSentenceSplittingRequestParameters:l,backendURL_translation:a,backendURL_sentenceSplitting:s,sendTranslationJobs(){var e;let t=(0,i.S3)(p.translation());return h(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],p,t),(e=t()).sendTranslationJobs.apply(e,arguments)},sendTranslationJobs_batched(){var e;let t=(0,i.S3)(p.translation());return h(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],p,t),(e=t()).sendTranslationJobs_batched.apply(e,arguments)},requestSentenceSplitting(){var e;return(e=p.sentenceSplitting()).requestSentenceSplitting.apply(e,arguments)},sendAdditionalData(){var e;return(e=p.translation()).sendAdditionalData.apply(e,arguments)},translationProvidesLangDetection:(0,i.G7)(n,e=>e)}})},20121:function(e,t,n){var a=n(98808),r=n(61606),i=n(84627),s=n(58425),o=n(83115);r.Z.defineType("/translator/core/triggerSourceTranslation",["/translator/core/languageManagement","/translator/core/requestHandling","/translator/core/textareas","/translator/core/config"],(e,t,n,r)=>{let l=(0,a.f)(),c="";e.onActiveLangContextChanged.push(e=>{let n=t.startRequestContext(e,s.Xk.TYPE__TRANSLATE_SOURCE,e.getSourceLang()!==c?s.SA.TRIGGER__SOURCE_LANG_CHANGED:s.SA.TRIGGER__TARGET_LANG_CHANGED);c=e.getSourceLang(),l(n)});let g="",u="";function d(a,i){void 0===a&&(a=s.SA.TRIGGER__SOURCE_TEXT_CHANGED),void 0===i&&(i=!1);let o=r.get("isRtfEnabled"),c=n.getSourceText(),d=o?n.getSourceHtml():"",h=o?d!==u:c!==g;if(!h&&!i)return!1;{g=c,u=d;let n=t.startRequestContext(e.getActiveLangContext(),s.Xk.TYPE__TRANSLATE_SOURCE,a);return l(n),!0}}return n.onSourceTextChanged.pushWithReplay((a,c,u)=>{if("internal"===c||"predefinedState"===c){g=n.getSourceText();return}d("typing"===c?s.SA.TRIGGER__SOURCE_TEXT_CHANGED_WHILE_TYPING:s.SA.TRIGGER__SOURCE_TEXT_CHANGED,u),i.ZP.setTimeout_consolidated("assureInitialTranslationIsRequested",()=>{d()||e.getActiveLangContext().sourceSentences.some(e=>e.translation&&e.translation.status===o.Z.STATUS__READY__FAST_QUALITY)&&l(t.startRequestContext(e.getActiveLangContext(),s.Xk.TYPE__TRANSLATE_SOURCE,s.SA.TRIGGER__FAILSAFE_CHECK))},r.get("CONFIG__SEND_BACKUP_REQUEST_DELAY"))}),{checkForChangedSourceEdit(){d()},triggerTranslationUpdate:function(e){l(e)},onSourceTranslationShouldUpdate:l}})},40001:function(e,t,n){var a=n(4769),r=n(67974),i=n(98808),s=n(30171),o=n(61606),l=n(25889),c=n(83115),g=n(89550),u=n(69748),d=n(58425),h=n(78780),p=n(22133);let f="LMT_ERROR_TYPE__LINE_TOO_LONG_TO_SPLIT";o.Z.defineType("/translator/core/updateSourceSentences",["/translator/core/translationBackend","/translator/core/requestHandling","/translator/core/textareas","/translator/core/languageManagement","/translator/core/triggerSourceTranslation","/translator/core/networkStatus","/translator/core/config","/translator/core/domElements","/translator/core/observeSourceTextAndLanguage","/translator/core/richTextHandling"],(e,t,n,o,T,_,S,E,v,m)=>{var C;let R;let x=(0,i.f)(),L=(0,i.f)(),A=(0,i.f)(),b=0,I=S.get("isWriteMode"),O=S.get("isRtfEnabled"),N=null!==(C=S.get("CONFIG__MAX_SOURCE_LINE_LENGTH"))&&void 0!==C?C:14e3;function y(e,t,n,a,r,i){function s(e){return e&&e.translation&&e.translation.getSourceText()}let l="[doUpdateSourceSentences]",d=e.sourceSentences,f=d.splice(0);if(t){var T,_,S,E;let a=t.slice(0),h=n;for(;a.length&&f.length&&s(f[0])===a[0];){let e=f.shift();d.push(e);let t=a.shift(),n=null!==(T=null===(_=h.match(p.kX))||void 0===_?void 0:_[0])&&void 0!==T?T:"";if(e.updateWhitespacesBefore(n),n.length&&(h=h.substring(n.length)),h.startsWith(t))e.updateRawTrimmedText(t),h=h.substring(t.length);else{let n=t.replace(/\s/g,""),a=RegExp(`^(\\s*\\S){${n.length}}`),r=h.match(a);r?(e.updateRawTrimmedText(r[0].trim()),h=h.substring(r[0].length)):(e.updateRawTrimmedText(t),console.warn(l,"Could not consume source sentence text!"),console.log(`[${t}]`),console.log(`[${h}]`))}let r=h.match(p.L$);r&&r[0].length?(e.updateWhitespacesAfter(r[0]),h=h.substring(r[0].length)):e.updateWhitespacesAfter("")}let v=[];for(;a.length&&f.length&&s(f[f.length-1])===a[a.length-1];){let e=f.pop(),t=a.pop();v.unshift(e);let n=null!==(S=null===(E=h.match(p.Hk))||void 0===E?void 0:E[0])&&void 0!==S?S:"";if(e.updateWhitespacesAfter(n),n.length&&(h=h.substring(0,h.length-n.length)),h.endsWith(t))e.updateRawTrimmedText(t),h=h.substring(0,h.length-t.length);else{let n=t.replace(/\s/g,""),a=RegExp(`(\\S(\\s*\\S){${n.length-1}})$`),r=h.match(a);r?(e.updateRawTrimmedText(r[0].trim()),h=h.substring(0,h.length-r[0].length)):(console.warn(l,"(back) Could not consume source sentence text!"),console.log(`[${t}]`),console.log(`[${h}]`))}let r=(0,p.X3)(h);r?(e.updateWhitespacesBefore(r),h=h.substring(0,h.length-r.length)):e.updateWhitespacesBefore("")}let C=[];for(a.forEach(e=>{var t,n;let a=new g.t;C.push([a,e]);let r=f.shift();if(r){let e=r.previousTranslations?r.previousTranslations.slice(0):[];r.translation&&e.unshift(r.translation);let t=[];for(;e.length;){let n=e.shift();if(t.push(n),n.getTargetText())break}a.previousTranslations=t}let i=null!==(t=null===(n=h.match(p.kX))||void 0===n?void 0:n[0])&&void 0!==t?t:"";if(a.updateWhitespacesBefore(i),i.length&&(h=h.substring(i.length)),h.startsWith(e))a.updateRawTrimmedText(e),h=h.substring(e.length);else{let t=e.replace(/\s/g,""),n=RegExp(`^(\\s*\\S){${t.length}}`),r=h.match(n);r?(a.updateRawTrimmedText(r[0].trim()),h=h.substring(r[0].length)):(console.warn(l,"Could not consume source sentence text!"),console.log(`[${e}]`),console.log(`[${h}]`))}let s=h.match(p.L$);s?(a.updateWhitespacesAfter(s[0]),h=h.substring(s[0].length)):a.updateWhitespacesAfter(""),r&&(a._whitespacesBefore===r._whitespacesBefore&&(a._whitespacesBeforeRev=r._whitespacesBeforeRev),a._whitespacesAfter===r._whitespacesAfter&&(a._whitespacesAfterRev=r._whitespacesAfterRev)),d.push(a)});v.length;)d.push(v.shift());d.forEach((e,t)=>{e.prevSentence=d[t-1],e.nextSentence=d[t+1]}),O&&r.sourceTextAreaContentSnapshot&&m.updateSourceSentencesHtml(d,r.sourceTextAreaContentSnapshot),C.forEach(t=>{let n,[a,r]=t,s=O?a.getTrimmedHtml():r;if(e.isContextEnabled()){let e=(0,u.rU)(a);n=`${e.prefix.join("/")}//${s}//${e.postfix.join("/")}`}else n=s;let o=e.getRegisteredTranslation(n);void 0===o&&(o=c.Z.create(r),O&&o.setSourceHtml(a.getTrimmedHtml()),e.registerTranslation(n,o)),o.setDetectedLanguages(i),a.translation=o}),o.notifyTranslationLanguageChanged()}let v=a.slice(0),C=new h.Z;e.sourceSentences.forEach(e=>{v[0]-=1,e.setChain(C),0===v[0]&&(v.shift(),C=new h.Z)})}function P(e){let t,n=0,a=[];return e.forEach(e=>{t&&e.getChain()!==t?(a.push(n),n=1):n+=1,t=e.getChain()}),t&&a.push(n),a}let w=/[\x00-\x08\x0B-\x1f\x7F\xAD]/g;function U(i){let c;let g=i.langContext,u=n.getSourceText();if(O&&(i.sourceTextAreaContentSnapshot=n.getSourceTextareaSnapshot()),u.match(w)){u=u.replace(w,""),i.stop(),setTimeout(()=>{n.setSourceTextExplicitly(u)});return}if(!S.get("CONFIG__IS_PRO")&&u.match(/<\/(head|script|style)/i)&&(u.match(/</g)||[]).length>7){setTimeout(()=>{E.targetEdit.value=u;let e=+Date.now();e>b+5e3&&(b=e,A()),i.stop()},3e4);return}let h=o.getUnifiedSelectedSourceLanguageOrAuto(),p={lang_user_selected:h},T=v.sourceTextModifiedAfterLastSourceLanguageChange();!T&&h&&"auto"!==h&&(p.lang_computed=h),p.preference=o.getLanguagePreference(),o.isAlternativeLanguageDetectionEnabled()&&(p.detection="alternative");let C=o.getSelectedTargetLang(),R=e=>{h!==o.getUnifiedSelectedSourceLanguageOrAuto()||C!==o.getSelectedTargetLang()?i.stop():function(e,n,r){let i=e.langContext;if(""===n.trim())y(i,[],n,[],e),e.onSentenceSplittingReceived(),x(e);else if(r.changedCleanedParagraphs.length){let s=r.splittingResult,l=s.chainedSentenceBlocks.map(e=>e.flat()),c=r.unchangedSplittedParagraphsPrefix.concat(l,r.unchangedSplittedParagraphsPostfix),g=s.detectedLang,u=s.detectedLanguages,h=r.unchangedSplittedParagraphsPrefix.flat().length,p=r.unchangedSplittedParagraphsPostfix.flat().length,f=0===h?[]:P(i.getSourceSentences().slice(0,h)),T=0===p?[]:P(i.getSourceSentences().slice(-p)),_=[];s.chainedSentenceBlocks.forEach(e=>{e.forEach(e=>{_.push(e.length)})});let S=[].concat((0,a.Z)(f),_,(0,a.Z)(T));if(s.detectedLanguages&&o.pushDetectedLanguages(s.detectedLanguages),g&&g!==i.getSourceLang()){let e=0;r.unchangedSplittedParagraphsPrefix.forEach(t=>t.forEach(t=>{e+=t.length})),e>500||o.notifyChangedSourceLangDetected(g)}let E=[];if(c.forEach(e=>{e.forEach(e=>{E.push(e.trim())})}),!o.isActiveLangContext(i)){e.stop();let n=e.sourceTextAreaContentSnapshot;e=t.startRequestContext(o.getActiveLangContext(),d.Xk.TYPE__TRANSLATE_SOURCE,e.trigger),O&&(e.sourceTextAreaContentSnapshot=n)}e.splitSentenceRequestUsed=!!s.splitSentenceRequestUsed,e.detectSourceLangInTranslation=!g,y(i,E,n,S,e,u),e.onSentenceSplittingReceived(),x(e)}else{e.splitSentenceRequestUsed=!1,e.detectSourceLangInTranslation=!1;let t=[];r.unchangedSplittedParagraphsPrefix.forEach(e=>{e.forEach(e=>t.push(e.trim()))});let a=P(i.getSourceSentences());y(i,t,n,a,e),e.onSentenceSplittingReceived(),O&&e.sourceTextAreaContentSnapshot&&e.sourceTextAreaContentSnapshot&&m.updateSourceSentencesHtml(i.getSourceSentences(),e.sourceTextAreaContentSnapshot),x(e)}}(i,c,e)},U=()=>{let e=[],t=Math.floor(.75*N),a=["! ","? ",": ","; ",". ",", ",'" '," "];n.getSourceText().split("\n").forEach(n=>{for(;;){if(n.length<N){e.push(n);break}{let r=n.length,i=!1;for(let r=0;r<a.length;r++){let s=n.indexOf(a[r],t);if(s>=0&&s<N){e.push(n.substring(0,s+1).trimEnd()),n=`   ${n.substring(s+a[r].length).trimStart()}`,i=!0;break}}if(i||(e.push(n.substring(0,t).trimEnd()),n=`   ${n.substring(t).trimStart()}`),n.length>=r)throw Error("Sanity check failed!")}}}),n.setSourceTextExplicitly(e.join("\n"),"update",!1,!1)};(0,r.AV)(`sentenceSplitting${g.getId()}`,()=>{let t=u.substring(0,S.get("CONFIG__MAX_NUM_CHARACTERS"));c=t;let n=function(e,t){let n=!1,a=[];if(t.split("\n").forEach(e=>{let t=l.ZP.collapseWhitespaces(e).trim();t.length>N&&(n=!0),t.length&&a.push(t)}),n)return f;let r=[],i=[],s=[],o=0,c=0,g=0;for(;e.sourceSentences[o]&&void 0!==a[c];){let t=a[c],n=[];for(;t.length;){let a=e.sourceSentences[o];if(!a)break;let r=a.getNormalizedText();if(n.push(r),t.startsWith(r))t=t.substring(r.length).trim(),o+=1;else break}if(t.length)break;g+=a[c].length,i.push(n),c+=1}let u=e.sourceSentences[o]||a[c];u&&g>0&&g<500&&(g=0,i.splice(0));let d=e.sourceSentences.length-1,h=a.length-1;for(;e.sourceSentences[d]&&void 0!==a[c]&&d>o&&h>c;){let t=a[h],n=[];for(;t.length;){let a=e.sourceSentences[d];if(!a)break;let r=a.getNormalizedText();if(n.unshift(r),t.endsWith(r))t=t.substring(0,t.length-r.length).trim(),d-=1;else break}if(t.length)break;s.unshift(n),h-=1}r=a.slice(i.length,a.length-s.length);let p=0;if(r.forEach(e=>{p+=e.length}),p>0){let e=0;for(;p<500;)if(e=1-e){if(i.length){let e=i.pop().join(" ");r.unshift(e),p+=e.length}else if(s.length){let e=s.shift().join(" ");r.push(e),p+=e.length}else break}else if(s.length){let e=s.shift().join(" ");r.push(e),p+=e.length}else if(i.length){let e=i.pop().join(" ");r.unshift(e),p+=e.length}else break}return{unchangedSplittedParagraphsPrefix:i,changedCleanedParagraphs:r,unchangedSplittedParagraphsPostfix:s}}(g,t);if(n===f)return i.stop(),U(),Promise.resolve();if(!n.changedCleanedParagraphs.length)return R(n),Promise.resolve();{let t=(0,s.S3)(!e.translationProvidesLangDetection()||I);return t()||L(i,t),e.requestSentenceSplitting(n.changedCleanedParagraphs,p,i.trigger,I?"write":"translate",t()).then(e=>{n.splittingResult=e,R(n)}).catch(e=>{i.stop(),_.onRequestFailed("splitting",e)})}},5e3).then(()=>{}).catch(e=>{e===r.AV.FAILURE_REASON__CANCELED?i.stop():e===r.AV.FAILURE_REASON__TIMEOUT||i.stop()})}let G=(0,s.S3)([]);return(0,s.S1)(G,e=>{if(!e.length&&R){let e=R;R=void 0,U(e)}}),T.onSourceTranslationShouldUpdate.push(e=>{R&&(R.stop(),R=void 0),G().length?R=e:U(e)}),{onSourceSentencesChanged:x,doCheckIfSentenceSplittingShouldBeEnforced:L,addReasonToDelayUpdates(e){G([].concat((0,a.Z)(G()),[e]))},removeReasonToDelayUpdates(e){G(G().filter(t=>t!==e))},onHTMLTextInputRejected:A,testInterface:{doUpdateSourceSentences:y}}})},77055:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(30171);let r=e=>{let t={GSTATE__TYPING_REQUESTS_BLOCKED_UNTIL:0,GSTATE__EDIT_FEATURES_DISABLED:(0,a.S3)(!1)};e.globalState=t,e.features.register("globalState",t)}},16768:function(e,t,n){n.d(t,{M:function(){return a}});let a=e=>{e.features.define("/translator/webTranslatorCore",[],()=>e)}},78780:function(e,t,n){n.d(t,{Z:function(){return r}});let a=0,r=function(){this._id=a++}},18130:function(e,t,n){n(61606).Z.defineType("/translator/core/basicConfiguration",[],()=>{let e=new Map;return e.set("CONFIG__USE_FAST_TYPING_REQUESTS",!0),e.set("CONFIG__IS_DEV",!1),e.set("disableCaches",!1),e.set("CONFIG__USE_CONTEXT",!0),e.set("CONFIG__MAX_NUM_CHARACTERS",5e3),e.set("CONFIG__SEND_BACKUP_REQUEST_DELAY",1500),e.set("CONFIG__BLOCK_TYPING_REQUEST_DURATION",1e4),e.set("CONFIG__TRANSLATION_JOB_BATCH_SIZE",1e4),e.set("CONFIG__USE_FAST_TYPING_REQUESTS__DEV_MOCKUP",!1),e.set("il","en"),e.set("isMobile",void 0),e.set("isApp",void 0),e.set("backend.scheduler","../jsonrpc"),e.set("backend.translationEndpoint",void 0),e.set("backend.splittingEndpoint",void 0),e.set("backend.testUserBlocking",!1),e.set("isWriteMode",!1),e.set("isEnterpriseAccount",!1),e.set("isRtfEnabled",!1),e.set("CONFIG__MAX_SOURCE_LINE_LENGTH",14e3),{get(t){if(!e.has(t))throw Error(`config key '${t}' is invalid.`);return e.get(t)},set:function(t,n){e.set(t,n)},update:function(t,n){e.has(t)||console.warn(`config key '${t}' is invalid.`),e.set(t,n)}}})},89148:function(e,t,n){var a=n(61606),r=n(22496),i=n(12959);a.Z.defineType("/translator/core/config",["/translator/core/basicConfiguration","webTranslatorCore"],(e,t)=>{var n,a,s;let o=t._config,l=o.isPro;"0"===i.Z.context&&e.update("CONFIG__USE_CONTEXT",!1),i.Z.sft&&e.update("CONFIG__USE_FAST_TYPING_REQUESTS__DEV_MOCKUP",!0),e.update("CONFIG__IS_DEV",o.devMode);let c=o.isWriteMode?l?5e4:5e3:l?1e7:5e3;if(e.update("CONFIG__MAX_NUM_CHARACTERS",o.maxNumCharacters||c),e.update("CONFIG__TRANSLATION_JOB_BATCH_SIZE",l?1e5:1e4),e.update("isEnterpriseAccount",null!==(n=o.isEnterpriseAccount)&&void 0!==n&&n),e.update("il",o.il),e.update("isWriteMode",o.isWriteMode),e.update("backend.scheduler",i.Z.backend||o.backend),i.Z.tBackend){let t=i.Z.tBackend;t.startsWith("http")||t.startsWith("/")||(t=`http://${t}`),e.update("backend.translationEndpoint",t)}if(i.Z.sBackend){let t=i.Z.sBackend;t.startsWith("http")||t.startsWith("/")||(t=`http://${t}`),e.update("backend.splittingEndpoint",t)}i.Z.dev_block&&e.update("backend.testUserBlocking",!0),i.Z.dev_disableCaches&&e.update("disableCaches",!0);let g=!!o.isApp;return e.update("isApp",g),e.update("isMobile",!g&&r.ZP.isMobileLayout),e.set("CONFIG__IS_PRO",l),e.set("CONFIG__IS_ANONYMOUS",o.isAnonymousUser),e.set("CONFIG__IS_FREE",o.isFreeUser),e.set("CONFIG__BLOCK_SCROLLING","0"!==i.Z.blockScrolling),e.set("CONFIG__ADD_TRANSLATION_FOOTER",!l&&!r.ZP.isIPad),e.set("CONFIG__SEND_EDIT_LOGS",!1),e.set("CONFIG__PRO_INTERCEPT_PASTED_TEXT_MIN_LENGTH","50000"),e.set("userCountry",o.userCountry),e.set("readonlySourceSide",null!==(a=o.readonlySourceSide)&&void 0!==a&&a),e.update("isRtfEnabled",o.isRtfEnabled),e.update("CONFIG__MAX_SOURCE_LINE_LENGTH",null!==(s=o.maxSourceLineLength)&&void 0!==s?s:14e3),e})},91622:function(e,t,n){var a=n(61606),r=n(84627);a.Z.defineType("/translator/core/domElements",["/translator/webTranslatorCore"],e=>{let t,n;let a=e._domInternals.rootNode,i=e._domInternals.sourceEdit,s=e._domInternals.targetEdit;e.features.with(["/translator/core/domElementsTextareaHotSwap"],t=>{let n=t.swap(i,s,{isSelectionInTextarea:m});e._domInternals.sourceEdit=i=n.sourceEdit,e._domInternals.targetEdit=s=n.targetEdit});let o="D-TEXTAREA"===i.tagName,l=i.closest(".lmt__inner_textarea_container"),c=i.closest(".lmt__textarea_container"),g=s.closest(".lmt__inner_textarea_container"),u=s.closest(".lmt__textarea_container"),d=null==a?void 0:a.querySelector(".lmt__translations_as_text"),h=null==a?void 0:a.querySelector(".lmt__text"),p=null==a?void 0:a.querySelector(".lmt__doc"),f=null==a?void 0:a.querySelector(".lmt__language_select--source"),T=null==a?void 0:a.querySelector(".lmt__language_select--target"),_=(0,r.fo)(),S=(0,r.fo)();document.addEventListener("click",e=>_(e.target)),window.addEventListener("focus",function(e){document.activeElement!==t&&S(t=document.activeElement)},!0);let E=(0,r.fo)(),v=(0,r.fo)();function m(e,t){return!!(document.activeElement===e||function(e,t){let n=o||!(null!=l)?t?s:i:t?g:l;return n.contains(e)}(t||document.activeElement,s===e))}return s.addEventListener("keydown",e=>{let t={keyUpHandler:void 0,suppressKeyUpEvent:!1,keyDownEvent:e};n=t,E({event:e,info:t})}),s.addEventListener("keyup",e=>{let t;if((t=n&&e.keyCode===n.keyDownEvent.keyCode?n:Object(null)).keyUpHandler)return t.keyUpHandler(e);t.suppressKeyUpEvent||v({event:e,info:t})}),{body:document.querySelector("body"),rootContainer:a,lmtTextContainer:h,lmtDocContainer:p,sidesContainer:document.querySelector(".lmt__sides_container"),sidesContainerSource:document.querySelector(".lmt__sides_container .lmt__side_container--source"),sourceEdit:i,sourceEditInnerContainer:l,sourceEditOuterContainer:c,sourceSideContainer:null==a?void 0:a.querySelector(".lmt__side_container--source"),sourceLangSelectContainer:null==a?void 0:a.querySelector(".lmt__language_container"),sourceLanguageSelect:f,sourceLanguageSelectTriggerButton:null==f?void 0:f.querySelector(".lmt__language_select__active"),sidesContainerTarget:document.querySelector(".lmt__sides_container .lmt__side_container--target"),targetEdit:s,targetEditInnerContainer:g,targetEditOuterContainer:u,targetSideContainer:null==a?void 0:a.querySelector(".lmt__side_container--target"),targetLanguageSelect:T,targetLanguageSelectTriggerButton:null==T?void 0:T.querySelector(".lmt__language_select__active"),targetLangSelectExtensions:document.querySelector(".lmt__targetLangMenu_extensions"),translationsAsText:d,onAnyclick:_,onActiveElementChanged:S,onTargetEditKeyDown:E,onTargetEditKeyUp:v,getSourceEditCursorOffset:()=>i.selectionStart,getSourceEditCursorOffsetEnd:()=>i.selectionEnd,getTargetEditCursorOffset:()=>s.selectionStart,getTargetEditCursorOffsetEnd:()=>s.selectionEnd,isNewTextareaActive:()=>o,isSelectionInTextarea:m,isSelectionInSourceTextarea:e=>m(i,e),isSelectionInTargetTextarea:e=>m(s,e)}})},41941:function(e,t){t.Z={JOB_KIND__DEFAULT:"default",JOB_KIND__AUTOCOMPLETION:"autocompletion",JOB_KIND__ALTERNATIVES_AT_POSITION:"alternatives_at_position",JOB_KIND__SUGGEST_GLOSSARY_TAGS:"suggest_glossary_tags"}},91508:function(e,t,n){var a=n(4769),r=n(61606),i=n(30171),s=n(98808),o=n(71968),l=n(84627),c=n(78780),g=n(93546);let u=0,d=function(){function e(e,t,n){let{useContext:a,isWriteMode:r,useHtml:i,smartTargetEditingAvailable:s,autocompletionAvailable:o,wordsAreWrittenContinuously:l,alternativeLanguageDetectionEnabled:c}=n;this._registeredTranslations=void 0,this.sourceSentences=[],this.targetSentences=[],this._id=void 0,this._sourceLang=void 0,this._targetLangSettings=void 0,this._contextEnabled=void 0,this._isWriteMode=void 0,this._smartTargetEditingAvailable=void 0,this._autocompletionAvailable=void 0,this._wordsAreWrittenContinuously=void 0,this._alternativeLanguageDetectionEnabled=void 0,this._translationJobParams=void 0,this._translationRequestParams=void 0,this._registeredTranslations=new Map,this.sourceSentences=[],this.targetSentences=[],this._id=`LangContext_#${u}_${e}_${JSON.stringify(t)}`,u+=1,this._sourceLang=e,this._targetLangSettings=t,this._contextEnabled=a,this._isWriteMode=r,this._smartTargetEditingAvailable=s,this._autocompletionAvailable=o,this._wordsAreWrittenContinuously=l,this._alternativeLanguageDetectionEnabled=c,this._translationJobParams=new Map,this._translationRequestParams=new Map,this._targetLangSettings.variant&&this.setTranslationJobParams("regionVariant",{regionalVariant:this._targetLangSettings.variant}),this.setTranslationJobParams("mode",{mode:this._isWriteMode?"write":"translate"}),this.setTranslationJobParams("textType",{textType:i?"richtext":"plaintext"}),this.setTranslationJobParams("browserType",{browserType:0}),g.N.then(e=>{this.setTranslationJobParams("browserType",{browserType:e})}).catch(()=>{console.warn("[Language Context]","could not set browser type for  translation job params")})}var t=e.prototype;return t.createJobSettings=function(e,t){void 0===t&&(t=1);let n=null!=e?e:this.getLangConfigForTranslation();return this._alternativeLanguageDetectionEnabled&&(n.detection="alternative"),{langConfig:n,priority:t,commonJobParams:this.getTranslationJobParams(),requestParams:this.getTranslationRequestParams(),jobs:[]}},t.clearSentences=function(){this.sourceSentences.splice(0),this.targetSentences.splice(0)},t.getId=function(){return this._id},t.getLangConfigForTranslation=function(){return{source_lang_computed:this._sourceLang,target_lang:this._targetLangSettings.lang}},t.getRegisteredTranslation=function(e){return this._registeredTranslations.get(e)},t.getSourceLang=function(){return this._sourceLang},t.getSourceSentences=function(){return this.sourceSentences},t.getTargetLang=function(){return this._targetLangSettings.lang},t.getTargetLangSettings=function(){return this._targetLangSettings},t.getTargetSentences=function(){return this.targetSentences},t.isContextEnabled=function(){return this._contextEnabled},t.isSmartTargetEditingAvailable=function(){return this._smartTargetEditingAvailable},t.isAutocompletionAvailable=function(){return this._autocompletionAvailable},t.areWordsWrittenContinuously=function(){return this._wordsAreWrittenContinuously},t.registerTranslation=function(e,t){this._registeredTranslations.set(e,t)},t.setTranslationJobParams=function(e,t){l.ZP.isSimilar(this._translationJobParams.get(e),t)||(this._registeredTranslations.clear(),this._translationJobParams.set(e,t))},t.removeTranslationJobParams=function(e){this._translationJobParams.has(e)&&(this._registeredTranslations.clear(),this._translationJobParams.delete(e))},t.setTranslationRequestParams=function(e,t){this._translationRequestParams.set(e,t)},t.removeTranslationRequestParams=function(e){this._translationRequestParams.delete(e)},t.getTranslationJobParams=function(){let e={};return this._translationJobParams.forEach(t=>{Object.assign(e,t)}),e},t.getTranslationRequestParams=function(){let e={};return this._translationRequestParams.forEach(t=>{Object.assign(e,t)}),e},t.splitChainsOnModifiedSentences=function(){let e;if(!this.sourceSentences||0===this.sourceSentences.length)return;let t=new c.Z;this.sourceSentences.forEach(n=>{let a=n.translation;e&&e===n.getChain()?a&&a.isTargetTextPredefined()&&(t=new c.Z):(t=new c.Z,e=n.getChain()),n.setChain(t)})},e}();var h=n(25889);r.Z.defineType("/translator/core/languageManagement",["/translator/webTranslatorCore","/translator/core/config","/translator/core/langPreference","/translator/environment/releaseGroups"],(e,t,n,r)=>{let l=e._internalLanguageManagement,c=t.get("isRtfEnabled"),g=l.selectedSourceLang,u=l.selectedTargetLang,p=()=>g(),f=()=>u(),T=l.getSelectedTargetLangSettings,_=l.getPreferredTargetLangVariant,S=l.getLangAttributeForSelectedSourceLang,E=l.getLangAttributeForSelectedTargetLang,v=l.langConfig,m=(0,s.f)(),C=(0,s.f)(),R=(0,s.f)(),x=(0,i.S3)(N("",{lang:""})),L=(0,i.S3)(!1),A=(0,i.S3)(!1),b=(0,s.f)();R(x());let I=g.onValueChanged,O=l.onSelectedTargetLangSettingsChanged;function N(e,n){return h.ZP.dev_sealProxy(new d(e,n,{useContext:t.get("CONFIG__USE_CONTEXT"),isWriteMode:t.get("isWriteMode"),useHtml:c,smartTargetEditingAvailable:n&&v[n.lang]&&!v[n.lang].disableSmartTargetEditing,autocompletionAvailable:n&&v[n.lang]&&!v[n.lang].disableAutocomplete,wordsAreWrittenContinuously:n&&v[n.lang]&&v[n.lang].wordsAreWrittenContinuously,alternativeLanguageDetectionEnabled:D()}))}function y(e,t){let n=x(),a=n.getSourceLang(),r=n.getTargetLangSettings(),i=t.lang,s=v[i],c={lang:i,variant:t.variant&&s&&(!s.sourceLangsWithoutVariants||!s.sourceLangsWithoutVariants.includes(e))?t.variant:_(e,i)};e===a&&(0,o.T)(c,r)||(x(N(e,c)),R(x()),e&&e!==p()&&"auto"!==p()&&g("auto"),i&&l.updateSelectedTargetSettings(c),C(x()))}function P(e){let t=`${e||""}`.substr(0,2).toUpperCase();return v[t]?t:""}function w(){return n.getPreferredLangs()}function U(e){e&&""!==e&&"auto"!==e&&n.pushPreferredLang(e)}function G(e,t){var n,a;let r=P(e),i=P(t);i&&r!==i||(i=function(e){void 0===e&&(e=null);let t=w();if(!e)return t[t.length-1]||"";for(let n=t.length-1;n>=0;--n)if(e(t[n]))return t[n];return""}(e=>e!==r));let s={lang:i};return v[i]&&!((null===(n=v[i])||void 0===n?void 0:n.sourceLangsWithoutVariants)||[]).includes(r)&&null!==(a=v[i].variants)&&void 0!==a&&a.includes(t)&&(s.variant=t),[r,s]}function D(){return r.isActive("TC-181")}return(0,i.S1)(x,e=>{window._tState=e,l.activeSourceLang(e.getSourceLang()),l.activeTargetLang(e.getTargetLang()),e.getSourceLang()&&e.getTargetLang()&&m(e.getSourceLang(),e.getTargetLang())}),e.isActiveLangContext=e=>e===x(),e.getActiveState=()=>x(),e.getActiveLangContext=()=>x(),e.activeState=x,{doPrepareNewLangContext:R,getActiveLangContext:()=>x(),getIsoFormattedLangCodeWithCountryCode:function(e){var t;let n=(null===(t=l.langConfig[e.toUpperCase()])||void 0===t?void 0:t.countryCode)||e;return`${e.toLowerCase()}-${n.toUpperCase()}`},getPrioritizedSourceLangs:function(){let e;let t=x(),n=w();if(t.getSourceLang())e=t.getSourceLang();else if("auto"!==p())e=p();else{let t=f();e=n.filter(e=>e!==t).pop()}let a=n.filter(t=>t!==e);return a.push(e),a},getSelectedSourceLang:p,getSelectedTargetLang:f,getSelectedTargetLangSettings:T,getLangAttributeForSelectedSourceLang:S,getLangAttributeForSelectedTargetLang:E,getPreferredLangs:w,getLanguagePreference:function(){return n.getLanguagePreference()},getSourceLang:()=>x().getSourceLang(),getTargetLang:()=>x().getTargetLang(),getSelectableSourceLangEntries:()=>[{lang:"auto"}].concat((0,a.Z)(Object.keys(v).map(e=>({lang:e})))),getSelectableTargetLangEntries:()=>(function(e){let t=[],n=l.getApparentSourceLang();return Object.entries(e).forEach(e=>{let[a,r]=e;!r.variants||r.sourceLangsWithoutVariants&&r.sourceLangsWithoutVariants.includes(n)?t.push({lang:a}):r.variants.forEach(e=>t.push({lang:a,variant:e}))}),t})(v),isActiveLangContext:e=>e===x(),notifyChangedSourceLangDetected:function(e){let t=x(),n=t.getSourceLang(),a=f(),r=p();if(e===n);else if(e===a){let t=n||w().filter(t=>t!==e).pop();g("auto"),y(e,{lang:t}),b(e)}else e!==r&&g("auto"),y(e,T()),b(e)},onLangChanged:m,onActiveLangContextChanged:C,pushPreferredLang:U,pushDetectedLanguages:function(e){n.pushDetectedLanguages(e)},setUserSelectedSourceLang:function(e,t){void 0===t&&(t="selectionMenu");let n=p(),a=f(),r=x().getSourceLang();if("langSwitchButton"===t)U(e),g(e);else if(e===n);else if(e===r)U(e),g(e);else if("auto"===e)g(e),y("",{lang:""});else if(e===a){let t="auto"===n?w().filter(t=>t!==e).pop():n;U(e),g(e),y(e,{lang:t})}else U(e),g(e),y(e,{lang:a})},setUserSelectedTargetLangSettings:function(e){let t=x(),n=T(),a=t.getSourceLang();(0,o.T)(e,n)||(U(e.lang),a!==e.lang?y(a,e):(g("auto"),y("",e)))},sanitizeAndUpdateActiveLanguages(e,t){let[n,a]=G(e,t);y(n,a)},sanitizeLangCode:P,sanitizeLanguagePair:G,updateActiveLanguages:y,onSelectedSourceLangChanged:I,onSelectedTargetLangSettingsChanged:O,isGlossaryEnabled:L,isAlternativeLanguageDetectionEnabled:D,onSourceLangDetected:b,isUnsupportedLanguage:A,notifyTranslationLanguageChanged:function(){let e=x(),t=e=>"unsupported"in e&&1===e.unsupported,n=e.sourceSentences.some(e=>t(e.translation.detectedLanguages));A(n)},isRtl:function(e){var t,n;return null!==(t=null===(n=v[e])||void 0===n?void 0:n.rtl)&&void 0!==t&&t},getUnifiedSelectedSourceLanguageOrAuto:function(){if(t.get("isWriteMode")){let t=e.features.get("/translator/write/writeLanguage");return t?t.getSelectedLanguage().lang:"auto"}return p()}}})},7645:function(e,t,n){var a=n(61606),r=n(30171),i=n(83115),s=n(89550),o=n(78780);a.Z.defineType("/translator/core/predefinedState",["/translator/webTranslatorCore","/translator/core/languageManagement","/translator/core/textareas","/translator/core/updateSourceSentences","/translator/core/requestHandling","/translator/core/selectedLanguages","/translator/core/config"],(e,t,n,a,l,c,g)=>{let u;let d=(0,r.S3)(!1),h=(0,r.S3)(!0);async function p(e){return void 0===e&&(e="auto"),new Promise(n=>{let a=()=>{l.hasPendingRequests()?l.hasPendingRequests.onValueChanged.push(()=>(setTimeout(a),"REMOVE")):n(function(e,t){let n=e.getTargetLangSettings(),a={sourceLangcode:e.getSourceLang().toLocaleLowerCase()||"auto",targetLangcode:n.variant||n.lang.toLowerCase(),version:1};if("auto"===t){let n;n=!1,e.targetSentences.forEach(e=>{let t=e.getTranslation();t&&(n=n||t.isTargetTextPredefined()||e.getText().trim()!==(t.getTargetText()||"").trim())}),t=n?"full":"sourceText"}if("sourceText"===t)a.sourceText=e.sourceSentences.map(e=>e.getText()).join("");else if("full"===t){let t,n,r;let i=[],s=[];e.getTargetSentences().forEach(e=>{let a=e.getSourceSentence(),o=a.getChain();t!==o&&(t=o,n=[],r=[],i.push(n),s.push(r)),n.push(a.getText()),r.push(e.getText())}),a.sourceChains=i,a.targetChains=s}return a}(t.getActiveLangContext(),e))};a()})}function f(e){let a,r;u=e;let l=e.sourceText,p=e.sourceChains||[],f=g.get("isWriteMode");f?r={lang:a=t.sanitizeLangCode(e.sourceLangcode),variant:""}:[a,r]=t.sanitizeLanguagePair(e.sourceLangcode,e.targetLangcode);let T=a=>u!==e?"REMOVE":a.getSourceLang()&&a.getTargetLang()?(!p.length&&l?n.setSourceTextExplicitly(l,"predefinedState",!1,!0):(function(e,t,a){let r=[],l="";t.forEach((e,t)=>{let n=new o.Z,c=null==a?void 0:a[t];e.forEach((e,t)=>{0===e.trim().length&&console.warn("[predefinedState]",'creating an "empty" sentence, this can lead to problems.');let a=null==c?void 0:c[t],o=s.t.create();o.updateWhitespacesBefore(e.match(/^\s*/g)[0]),o.updateWhitespacesAfter(e.match(/\s*$/g)[0]),o.updateRawTrimmedText(e.trim()),o.setChain(n);let g=i.Z.create(o.getNormalizedText(),null==a?void 0:a.trim(),!1);g.additionalData.predefinedWhitespaceBefore=null==a?void 0:a.match(/^\s*/g)[0],g.additionalData.predefinedWhitespaceAfter=null==a?void 0:a.match(/\s*$/g)[0],o.translation=g,r.push(o),l+=e})}),e.sourceSentences=r,n.setSourceTextExplicitly(l,"predefinedState",!1,!0)}(a,p,e.targetChains||[]),n.onTargetTextChanged.push(()=>(n.onTargetTextChanged.push(()=>(u===e&&d(!1),"REMOVE")),"REMOVE"))),n.onSourceTextChanged.push(()=>(u===e&&d(!1),"REMOVE")),n.onTargetTextChanged.push((t,n)=>u!==e?"REMOVE":"update"!==n?(d(!1),"REMOVE"):void 0),t.onActiveLangContextChanged.push(t=>u!==e?"REMOVE":t!==a?(d(!1),"REMOVE"):void 0),"REMOVE"):void 0;d(!0),e.revert&&d.onValueChanged.push(()=>{for(;e.revert.length;)e.revert.shift()()}),e.targetLangcode?!a&&e.sourceText?(h(!1),n.setSourceTextExplicitly(" ","internal",!1,!0),n.setTargetTextExplicitly(""),t.setUserSelectedSourceLang("auto","internal"),setTimeout(()=>{n.setSourceTextExplicitly(l,"predefinedState",!1,!0),t.updateActiveLanguages("",r),n.onSourceTextChanged.push(()=>(u===e&&d(!1),"REMOVE")),n.onTargetTextChanged.push((t,n)=>u!==e?"REMOVE":"typing"===n?(d(!1),"REMOVE"):void 0),t.onActiveLangContextChanged.push(t=>u!==e?"REMOVE":t.getTargetLangSettings().lang!==r.lang||t.getTargetLangSettings().variant!==r.variant?(d(!1),"REMOVE"):void 0)})):(h(0===p.length&&!l),n.setSourceTextExplicitly(h()?"":" ","internal",!1,!0),n.setTargetTextExplicitly(""),t.getActiveLangContext().getSourceLang()&&t.updateActiveLanguages("",{lang:""}),t.doPrepareNewLangContext.push(T),c.setPredefinedSelectedSourceLanguage(a,"internal"),setTimeout(()=>t.updateActiveLanguages(a,r))):(h(!0),n.onSourceTextChanged.push(()=>(u===e&&d(!1),"REMOVE")),n.onTargetTextChanged.push((t,n)=>u!==e?"REMOVE":"typing"===n?(d(!1),"REMOVE"):void 0),t.onActiveLangContextChanged.push(t=>(u===e&&d(!1),"REMOVE")))}let T=e._initialState||{};return T.sourceText&&(a.addReasonToDelayUpdates("predefinedState_waitForOtherFeaturesBeforeTranslating"),setTimeout(()=>a.removeReasonToDelayUpdates("predefinedState_waitForOtherFeaturesBeforeTranslating"),100)),f(T),{applyPredefinedState:f,isInPredefinedState:d,hasTargetText:function(){var e,t,n;return(null!==(e=null===(t=u)||void 0===t?void 0:null===(n=t.targetChains)||void 0===n?void 0:n.length)&&void 0!==e?e:0)>0},isPredefinedStateEmpty:h,serializeActiveState:p,leavePredefinedState:function(){d(!1)}}})}}]);