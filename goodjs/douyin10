/*! For license information please see 3250.424c31a0.js.LICENSE.txt */
(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([[3250,4999],{6800:function(e,t,n){e.exports=n(9508)},11144:function(e,t,n){var i=n(68493);function o(e,t,n,o,r,a,s){try{var c=e[a](s),u=c.value}catch(l){return void n(l)}c.done?t(u):i.resolve(u).then(o,r)}e.exports=function(e){return function(){var t=this,n=arguments;return new i((function(i,r){var a=e.apply(t,n);function s(e){o(a,i,r,s,c,"next",e)}function c(e){o(a,i,r,s,c,"throw",e)}s(undefined)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},76537:function(e,t,n){var i=n(50750),o=n(78375),r=n(8e3),a=n(11883),s=n(21155),c=n(1586),u=n(25861),l=n(42404),d=n(74892);function f(e,t){var n=i(e);if(o){var s=o(e);t&&(s=r(s).call(s,(function(t){return a(e,t).enumerable}))),n.push.apply(n,s)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n,i,o=null!=arguments[t]?arguments[t]:{};t%2?s(n=f(Object(o),!0)).call(n,(function(t){d(e,t,o[t])})):c?u(e,c(o)):s(i=f(Object(o))).call(i,(function(t){l(e,t,a(o,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},98556:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n(53864),o=n(60443),r=n.t(o,2),a=undefined&&undefined.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};window.ucSecondVerifyReact=i,window.ucSecondVerifyReactDom=r;var s=window.ucWebSecondVerify,c=new(function(){function e(){this.initProps={aid:0},this.isInit=!1}return e.prototype.init=function(e){this.isInit||(this.initProps=e,this.isInit=!0)},e.prototype.verify=function(e){var t=this;return this.isInit?new Promise((function(n){if(2046===e.error_code){var i=a(a({verifyFinishCallback:function(e){n(e)}},e),t.initProps);if(s)return void(null==s||s(i));o=i.url,r=function(){null==(s=window.ucWebSecondVerify)||s(i)},(c=document.createElement("script")).type="text/javascript",c.src=o,document.getElementsByTagName("head")[0].appendChild(c),c.readyState?c.onreadystatechange=function(){"complete"!==c.readyState&&"loaded"!==c.readyState||(c.onreadystatechange=null,r&&r())}:c.onload=function(){r&&r()}}else n({status:!1,message:"\u9519\u8bef\u7801\u975e2046\uff0c\u4e0d\u9700\u8981\u9a8c\u8bc1\u8eab\u4efd\uff01"});var o,r,c})):Promise.resolve({status:!1,message:"\u8eab\u4efd\u9a8c\u8bc1sdk\u6ca1\u6709\u521d\u59cb\u5316\uff01"})},e}())},93250:function(e,t,n){"use strict";n.r(t),n.d(t,{checkAwemeUsedCode:function(){return B}});var i=n(53864),o=n(60443),r=n(79705),a=n.n(r),s=n(17674),c=n.n(s),u=n(62048),l=n.n(u),d=n(92716),f=n.n(d),h=n(46306),p=n(99388),_=n(77386),m=n.n(_),v=n(49148),g=n(64999),E=n(40705),b=n.n(E);function y(){y=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(I){c=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var r=t&&t.prototype instanceof f?t:f,a=Object.create(r.prototype),s=new T(o||[]);return i(a,"_invoke",{value:w(e,n,s)}),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(I){return{type:"throw",arg:I}}}e.wrap=u;var d={};function f(){}function h(){}function p(){}var _={};c(_,r,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(O([])));v&&v!==t&&n.call(v,r)&&(_=v);var g=p.prototype=f.prototype=Object.create(_);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function o(i,r,a,s){var c=l(e[i],e,r);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return o("throw",e,a,s)}))}s(c.arg)}var r;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){o(e,n,t,i)}))}return r=r?r.then(i,i):i()}})}function w(e,t,n){var i="suspendedStart";return function(o,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw r;return x()}for(n.method=o,n.arg=r;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var c=l(e,t,n);if("normal"===c.type){if(i=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i="completed",n.method="throw",n.arg=c.arg)}}}function S(e,t){var n=t.method,i=e.iterator[n];if(undefined===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=undefined,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=l(i,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var r=o.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=undefined,t.done=!0,t};return o.next=o}}return{next:x}}function x(){return{value:undefined,done:!0}}return h.prototype=p,i(g,"constructor",{value:p,configurable:!0}),i(p,"constructor",{value:h,configurable:!0}),h.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},E(b.prototype),c(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,i,o,r){void 0===r&&(r=Promise);var a=new b(u(t,n,i,o),r);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(g),c(g,s,"Generator"),c(g,r,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=O,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=undefined),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var s=n.call(r,"catchLoc"),c=n.call(r,"finallyLoc");if(s&&c){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=undefined),d}},e}function w(e,t,n,i,o,r,a){try{var s=e[r](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(i,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){w(r,i,o,a,s,"next",e)}function s(e){w(r,i,o,a,s,"throw",e)}a(undefined)}))}}function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},C.apply(this,arguments)}function k(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,T(e,t)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}var O,x=function(){function e(e){var t,n,i=e.appId,o=e.config,r=void 0===o?{}:o;null==(t=O=new h.Collector("douyin_web_login"))||t.init({app_id:i,channel:"cn",log:Boolean(false)}),this.setConfig(r),this.getToken(),null==(n=O)||n.start()}e.initTea=function(t){var n=t.appId,i=t.config,o=void 0===i?{}:i;return this._instance||(this._instance=new e({appId:n,config:o})),this._instance},e.getTea=function(){return this._instance};var t=e.prototype;return t.setConfig=function(e){var t;void 0===e&&(e={}),null==(t=O)||t.config(C({_staging_flag:0},e))},t.sendLog=function(e,t){var n;e&&(null==(n=O)||n.event(e,t))},t.sendBecon=function(e,t){var n;e&&(null==(n=O)||n.beconEvent(e,t))},t.getToken=function(){var e=this,t=new Promise((function(e){var t,n;"function"==typeof(null==(t=O)?void 0:t.getToken)&&(null==(n=O)||n.getToken((function(t){void 0===t&&(t={}),e(t)})))}));t.then((function(t){e.setConfig({device_id:(null==t?void 0:t.user_unique_id)||0})}))},e}(),I=function(){function e(e,t){var n=t.device_id,i=t.slardarConfig,o=t.context,r=void 0===o?{}:o;for(var a in this.webLoginSlardar=(0,p.createBrowserClient)(),r)this.webLoginSlardar("context.set",a,r[a]);var s={};i&&i.plugins&&(s=i.plugins);var c=C({bid:"web_login_sdk",pid:""+e,release:"0.2.16-beta.0",env:"production"},i,{plugins:C({tti:!1,performance:!1,resource:!1,pageview:{sendInit:!1},jsError:{onerror:!1,onunhandledrejection:!1,dedupe:!1,captureGlobalAsync:!1},breadcrumb:{dom:!1},ajax:{autoWrap:!0,ignoreUrls:[/^((?!(sso.douyin.com)|(\/passport\/)).)*$/],collectBodyOnError:!0},fetch:{autoWrap:!0,ignoreUrls:[/^((?!(sso.douyin.com)|(\/passport\/)).)*$/],collectBodyOnError:!0},blankScreen:{autoDetect:!1,screenshot:!1}},s)});this.webLoginSlardar("init",c),n&&this.webLoginSlardar("config",{userId:n}),this.webLoginSlardar("start")}e.initSlardar=function(t,n){var i=n.device_id,o=n.slardarConfig,r=n.context;return this._instance||(this._instance=new e(t,{device_id:i,slardarConfig:o,context:r})),this._instance},e.getSlardar=function(){return this._instance},e.clearSlardar=function(){this._instance=null};var t=e.prototype;return t.dot=function(e){this.webLoginSlardar("sendEvent",e)},t.log=function(e){this.webLoginSlardar("sendLog",e)},t.throw=function(e,t){this.webLoginSlardar("captureException",e,t)},e}(),A="kT72QRRkeCCHfPzt5RGED5ERQpcp8YZn",L=function(e){return l().encrypt(e,A).toString()},D=function(e){return l().decrypt(e,A).toString(f())},P=function(){var e=navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1===e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("ucweb")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1===e.indexOf("Safari"),isSafari:e.indexOf("Safari")>=0||e.indexOf("WebKit")>=0,isOpera:e.indexOf("Opera")>=0,isChrome:e.indexOf("Chrome/")>=0&&e.indexOf("WebKit")>=0,isMac:e.indexOf("Mac")>=0}}();function R(e,t,n){var i,o;void 0===t&&(t={}),void 0===n&&(n=!1);var r=n?null==(i=x.getTea())?void 0:i.sendBecon:null==(o=x.getTea())?void 0:o.sendLog;r&&r(e,C({},t,{params_for_special:"uc_login"}))}var M=function(){try{return window.localStorage.setItem("testlocalstorage","1"),window.localStorage.getItem("testlocalstorage"),window.localStorage.removeItem("testlocalstorage"),!0}catch(e){return!1}},N=function(){var e=window.localStorage.getItem("local_account"),t=window.localStorage.getItem("local_password"),n=window.localStorage.getItem("local_areacode");return{account:e?D(e):"",password:t?D(t):"",areaCode:n?D(n):"",local_settime:window.localStorage.getItem("local_settime"),remember_status:window.localStorage.getItem("local_remember_status")}},G=function(e){void 0===e&&(e=!1);var t=N().local_settime,n=void 0===t?"0":t;((new Date).getTime()-Number(n)>=864e6||e)&&(window.localStorage.removeItem("local_account"),window.localStorage.removeItem("local_password"),window.localStorage.removeItem("local_settime"))},B=function(e){return!!function(){try{return window.sessionStorage.setItem("testSessionStorage","1"),window.sessionStorage.getItem("testSessionStorage"),window.sessionStorage.removeItem("testSessionStorage"),!0}catch(e){return!1}}()&&window.sessionStorage.getItem("session_aweme_code")===e};function q(e){var t=I.getSlardar();t&&(e&&e.error_code&&e.description||t.throw(e,{description:"unknown error"}))}function U(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):""}var V;function j(e,t){var n=null,i=!1;setTimeout((function o(){i||(null==e||e(),n=setTimeout(o,t))}),t);return function(){i=!0,n&&clearTimeout(n),n=null}}!function(e){e.PAGE_LOGIN_MOBILE_CODE="LOGIN_MOBILE_CODE",e.PAGE_LOGIN_ACCOUNT_PWD="LOGIN_ACCOUNT_PWD",e.PAGE_LOGIN_SCAN_CODE="LOGIN_SCAN_CODE",e.PAGE_LOGIN_TRUST="LOGIN_TRUST",e.PAGE_LOGIN_PUSH="LOGIN_PUSH",e.PAGE_REGISTER_MOBILE_CODE="REGISTER_MOBILE_CODE",e.PAGE_REGISTER_EMAIL="REGISTER_EMAIL",e.PAGE_PASSWORD_RESET="PASSWORD_RESET"}(V||(V={}));var z={weixin:"\u5fae\u4fe1\u767b\u5f55",qzone_sns:"QQ\u767b\u5f55",aweme:"\u6296\u97f3\u767b\u5f55",account_pwd:"\u5e10\u5bc6\u767b\u5f55",mobile_code:"\u624b\u673a\u767b\u5f55",scan_code:"\u626b\u7801\u767b\u5f55",register_mobile_code:"\u624b\u673a\u6ce8\u518c",register_email:"\u90ae\u7bb1\u6ce8\u518c"},H={mobileCodeLoginText:{title:"\u9a8c\u8bc1\u7801\u767b\u5f55",mobilePlaceholder:"\u624b\u673a\u53f7",mobileLabel:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",codePlaceholder:"\u9a8c\u8bc1\u7801",codeLabel:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",sendCode:"\u83b7\u53d6\u9a8c\u8bc1\u7801",sending:"{seconds}s\u540e\u91cd\u65b0\u53d1\u9001",confirmInfoBeforeText:"\u5df2\u9605\u8bfb\u5e76\u540c\u610f",confirmInfoConnectText:"\u548c",buttonText:"\u767b\u5f55"},accountPwdLoginText:{title:"\u5e10\u5bc6\u767b\u5f55",accountPlaceholder:"\u624b\u673a\u53f7/\u90ae\u7bb1",accountLabel:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u6216\u90ae\u7bb1",pwdPlaceholder:"\u5bc6\u7801",pwdLabel:"\u8bf7\u8f93\u5165\u5bc6\u7801",forgetPwd:"\u5fd8\u8bb0\u5bc6\u7801",confirmInfoBeforeText:"\u5df2\u9605\u8bfb\u5e76\u540c\u610f",confirmInfoConnectText:"\u548c",buttonText:"\u767b\u5f55",rememberPwd:"\u8bb0\u4f4f\u5bc6\u7801"},scanCodeLoginText:{title:"\u626b\u7801\u767b\u5f55",qrCodeLabel:"\u4e8c\u7ef4\u7801",scanSuccess:"\u626b\u7801\u6210\u529f",refreshCode:"\u70b9\u51fb\u5237\u65b0\u4e8c\u7ef4\u7801",getCodeFailed:"\u70b9\u51fb\u5237\u65b0\u4e8c\u7ef4\u7801",refreshBtnText:"",codeFailedBtnText:"",loginSuccessBtnText:"",scanSuccessBtnText:"",loginSuccess:"\u767b\u5f55\u6210\u529f"},trustedLoginText:{title:"\u4e00\u952e\u767b\u5f55",desc:"\u6296\u97f3\u5c06\u4e25\u683c\u4fdd\u62a4\u4f60\u7684\u4e2a\u4eba\u4fe1\u606f\u5b89\u5168",subdesc:"\u767b\u5f55\u4fe1\u606f\u5df2\u4fdd\u5b58\uff0c\u53ef\u5728\u4e2a\u4eba\u4e2d\u5fc3\u5173\u95ed",buttonText:"\u4e00\u952e\u767b\u5f55",confirmInfoBeforeText:"\u540c\u610f",confirmInfoConnectText:"\u548c",otherLoginText:"\u4ee5\u5176\u4ed6\u65b9\u5f0f \u767b\u5f55"},pushLoginText:{title:"\u4e00\u952e\u767b\u5f55",desc:"\u6296\u97f3\u5c06\u4e25\u683c\u4fdd\u62a4\u4f60\u7684\u4e2a\u4eba\u4fe1\u606f\u5b89\u5168",subdesc:"\u767b\u5f55\u4fe1\u606f\u5df2\u4fdd\u5b58\uff0c\u53ef\u5728\u4e2a\u4eba\u4e2d\u5fc3\u5173\u95ed",leadText:"\u8bf7\u6253\u5f00\u624b\u673a\u300c\u6296\u97f3APP\u300d\u6216\u70b9\u51fb\u63a8\u9001\u901a\u77e5\u786e\u8ba4\u767b\u5f55",buttonText:"",buttonErrText:"\u91cd\u65b0\u7533\u8bf7\u767b\u5f55",buttonFetchText:"\u767b\u5f55\u786e\u8ba4\u4e2d",otherLoginText:"\u6ca1\u6709\u6536\u5230\u901a\u77e5\uff1f\u9009\u62e9\u5176\u4ed6\u65b9\u5f0f \u767b\u5f55"},mobileCodeRegisterText:{title:"\u624b\u673a\u6ce8\u518c",mobilePlaceholder:"\u624b\u673a\u53f7",mobileLabel:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",codePlaceholder:"\u9a8c\u8bc1\u7801",codeLabel:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",sendCode:"\u83b7\u53d6\u9a8c\u8bc1\u7801",sending:"{seconds}s\u540e\u91cd\u65b0\u53d1\u9001",confirmInfoBeforeText:"\u5df2\u9605\u8bfb\u5e76\u540c\u610f",confirmInfoConnectText:"\u548c",buttonText:"\u6ce8\u518c"},emailRegisterText:{title:"\u90ae\u7bb1\u6ce8\u518c",accountPlaceholder:"\u90ae\u7bb1",accountLabel:"\u8bf7\u8f93\u5165\u90ae\u7bb1",newPwdPlaceholder:"\u65b0\u5bc6\u7801",newPwdLabel:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801",confirmPwdPlaceholder:"\u5bc6\u7801\u786e\u8ba4",confirmPwdLabel:"\u8bf7\u786e\u8ba4\u5bc6\u7801",codePlaceholder:"\u9a8c\u8bc1\u7801",codeLabel:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",sendCode:"\u83b7\u53d6\u9a8c\u8bc1\u7801",sending:"{seconds}s\u540e\u91cd\u65b0\u53d1\u9001",confirmInfoBeforeText:"\u5df2\u9605\u8bfb\u5e76\u540c\u610f",confirmInfoConnectText:"\u548c",buttonText:"\u6ce8\u518c"},passwordResetText:{title:"\u91cd\u7f6e\u5bc6\u7801",accountPlaceholder:"\u624b\u673a\u53f7/\u90ae\u7bb1",accountLabel:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u6216\u90ae\u7bb1",newPwdPlaceholder:"\u65b0\u5bc6\u7801",newPwdLabel:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801",confirmPwdPlaceholder:"\u5bc6\u7801\u786e\u8ba4",confirmPwdLabel:"\u8bf7\u786e\u8ba4\u5bc6\u7801",codePlaceholder:"\u9a8c\u8bc1\u7801",codeLabel:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",sendCode:"\u83b7\u53d6\u9a8c\u8bc1\u7801",sending:"{seconds}s\u540e\u91cd\u65b0\u53d1\u9001",confirmInfoBeforeText:"\u5df2\u9605\u8bfb\u5e76\u540c\u610f",confirmInfoConnectText:"\u548c",buttonText:"\u63d0\u4ea4",successText:"\u4fee\u6539\u6210\u529f"},extraText:{areaCodeNoMatchedResult:"\u65e0\u5339\u914d\u6570\u636e",mobileNull:"\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a",mobileFormatError:"\u624b\u673a\u53f7\u957f\u5ea6\u4e0d\u6b63\u786e",mobileCodeNull:"\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a",mobileCodeError:"\u9a8c\u8bc1\u7801\u53ea\u80fd\u4e3a{X}\u4f4d\u6570\u5b57",emailNull:"\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a",emailFormatError:"\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e",accountNull:"\u624b\u673a\u53f7/\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a",passwordNull:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a",passwordFormatError:"\u5bc6\u7801\u5fc5\u987b\u5305\u62ec\u6570\u5b57\u3001\u5927\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\uff0c\u957f\u5ea68-20\u4f4d",confirmPasswordNull:"\u5bc6\u7801\u786e\u8ba4\u4e0d\u80fd\u4e3a\u7a7a",confirmPasswordError:"\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4",defaultError:"\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",protocolCheckedError:"\u8bf7\u5148\u52fe\u9009\u7528\u6237\u534f\u8bae\u548c\u9690\u79c1\u653f\u7b56",switchToLogin:"\u7acb\u5373\u767b\u5f55",switchToRegister:"\u7acb\u5373\u6ce8\u518c",otherLoginText:"\u5176\u4ed6\u65b9\u5f0f",faceValidDesc:"",areaCodeLabel:"\u56fd\u5bb6/\u5730\u533a"}},W={"\u4e2d\u56fd":"+86","\u4e2d\u56fd\u9999\u6e2f":"+852","\u4e2d\u56fd\u6fb3\u95e8":"+853","\u4e2d\u56fd\u53f0\u6e7e":"+886","\u963f\u5c14\u5df4\u5c3c\u4e9a":"+355","\u963f\u5c14\u53ca\u5229\u4e9a":"+213","\u963f\u5bcc\u6c57":"+93","\u963f\u6839\u5ef7":"+54","\u963f\u62c9\u4f2f\u8054\u5408\u914b\u957f\u56fd":"+971","\u963f\u9c81\u5df4\u5c9b":"+297","\u963f\u66fc":"+968","\u963f\u585e\u62dc\u7586":"+994","\u963f\u68ee\u677e":"+247","\u57c3\u53ca":"+20","\u57c3\u585e\u4fc4\u6bd4\u4e9a":"+251","\u7231\u5c14\u5170":"+353","\u7231\u6c99\u5c3c\u4e9a":"+372","\u5b89\u9053\u5c14":"+376","\u5b89\u54e5\u62c9":"+244","\u5b89\u572d\u62c9":"+1264","\u5b89\u63d0\u74dc\u548c\u5df4\u5e03\u8fbe":"+1268","\u5965\u5730\u5229":"+43","\u5965\u5170\u7fa4\u5c9b":"+358","\u6fb3\u5927\u5229\u4e9a":"+61","\u5df4\u5df4\u591a\u65af":"+1246","\u5df4\u54c8\u9a6c":"+1242","\u5df4\u57fa\u65af\u5766":"+92","\u5df4\u62c9\u572d":"+595","\u5df4\u52d2\u65af\u5766":"+970","\u5df4\u6797":"+973","\u5df4\u62ff\u9a6c":"+507","\u5df4\u897f":"+55","\u767d\u4fc4\u7f57\u65af":"+375","\u767e\u6155\u5927":"+1441","\u4fdd\u52a0\u5229\u4e9a":"+359","\u5317\u9a6c\u91cc\u4e9a\u7eb3\u7fa4\u5c9b":"+1670","\u8d1d\u5b81":"+229","\u6bd4\u5229\u65f6":"+32","\u51b0\u5c9b":"+354","\u6ce2\u591a\u9ece\u5404":"+1787","\u6ce2\u9ed1":"+387","\u6ce2\u5170":"+48","\u73bb\u5229\u7ef4\u4e9a":"+591","\u4f2f\u5229\u5179":"+501","\u535a\u8328\u74e6\u7eb3":"+267","\u4e0d\u4e39":"+975","\u5e03\u57fa\u62c9\u6cd5\u7d22":"+226","\u5e03\u9686\u8fea":"+257","\u671d\u9c9c":"+850","\u8d64\u9053\u51e0\u5185\u4e9a":"+240","\u4e39\u9ea6":"+45","\u5fb7\u56fd":"+49","\u591a\u54e5":"+228","\u591a\u7c73\u5c3c\u52a0\u5171\u548c\u56fd":"+1809","\u591a\u7c73\u5c3c\u514b":"+1767","\u4fc4\u7f57\u65af":"+7","\u5384\u74dc\u591a\u5c14":"+593","\u5384\u7acb\u7279\u91cc\u4e9a":"+291","\u6cd5\u56fd":"+33","\u6cd5\u7f57\u7fa4\u5c9b":"+298","\u6cd5\u5c5e\u6ce2\u5229\u5c3c\u897f\u4e9a":"+689","\u6cd5\u5c5e\u572d\u4e9a\u90a3":"+594","\u68b5\u8482\u5188":"+379","\u83f2\u5f8b\u5bbe":"+63","\u6590\u6d4e":"+679","\u82ac\u5170":"+358","\u4f5b\u5f97\u89d2":"+238","\u5188\u6bd4\u4e9a":"+220","\u521a\u679c":"+242","\u521a\u679c\u6c11\u4e3b\u5171\u548c\u56fd":"+243","\u54e5\u4f26\u6bd4\u4e9a":"+57","\u54e5\u65af\u8fbe\u9ece\u52a0":"+506","\u683c\u6797\u7eb3\u8fbe":"+1473","\u683c\u9675\u5170\u5c9b":"+299","\u683c\u9c81\u5409\u4e9a":"+995","\u74dc\u5fb7\u7f57\u666e":"+590","\u5173\u5c9b":"+1671","\u572d\u4e9a\u90a3":"+592","\u6d77\u5730":"+509","\u97e9\u56fd":"+82","\u8377\u5170":"+31","\u8377\u5c5e\u5b89\u7684\u5217\u65af":"+599","\u6d2a\u90fd\u62c9\u65af":"+504","\u5409\u5e03\u63d0":"+253","\u52a0\u62ff\u5927":"+1","\u5409\u5c14\u5409\u65af\u65af\u5766":"+996","\u51e0\u5185\u4e9a":"+224","\u52a0\u90a3\u5229\u7fa4\u5c9b":"+3491","\u52a0\u7eb3":"+233","\u52a0\u84ec":"+241","\u67ec\u57d4\u5be8":"+855","\u6377\u514b":"+420","\u5580\u9ea6\u9686":"+237","\u5361\u5854\u5c14":"+974","\u5f00\u66fc\u7fa4\u5c9b":"+1345","\u79d1\u6469\u7f57":"+269","\u79d1\u7d22\u6c83":"+883","\u79d1\u7279\u8fea\u74e6":"+225","\u79d1\u5a01\u7279":"+965","\u514b\u7f57\u5730\u4e9a":"+385","\u80af\u5c3c\u4e9a":"+254","\u62c9\u8131\u7ef4\u4e9a":"+371","\u83b1\u7d22\u6258":"+266","\u8001\u631d":"+856","\u9ece\u5df4\u5ae9":"+961","\u7acb\u9676\u5b9b":"+370","\u5229\u6bd4\u91cc\u4e9a":"+231","\u5229\u6bd4\u4e9a":"+218","\u5217\u652f\u6566\u58eb\u767b":"+423","\u7559\u5c3c\u65fa\u5c9b":"+262","\u5362\u68ee\u5821":"+352","\u5362\u65fa\u8fbe":"+250","\u7f57\u9a6c\u5c3c\u4e9a":"+40","\u9a6c\u8fbe\u52a0\u65af\u52a0":"+261","\u9a6c\u5c14\u4ee3\u592b":"+960","\u9a6c\u8033\u4ed6":"+356","\u9a6c\u62c9\u7ef4":"+265","\u9a6c\u6765\u897f\u4e9a":"+60","\u9a6c\u91cc":"+223","\u9a6c\u5176\u987f":"+389","\u9a6c\u7ecd\u5c14\u7fa4\u5c9b":"+692","\u9a6c\u63d0\u5c3c\u514b":"+596","\u9a6c\u7ea6\u7279":"+262","\u6bdb\u91cc\u6c42\u65af":"+230","\u6bdb\u91cc\u5854\u5c3c\u4e9a":"+222","\u7f8e\u56fd":"+1","\u7f8e\u5c5e\u8428\u6469\u4e9a":"+1684","\u7f8e\u5c5e\u7ef4\u5c14\u4eac\u7fa4\u5c9b":"+1340","\u8499\u53e4":"+976","\u8499\u585e\u62c9\u7279\u5c9b":"+1664","\u8499\u7279\u5167\u54e5\u7f85":"+382","\u5b5f\u52a0\u62c9\u56fd":"+880","\u79d8\u9c81":"+51","\u5bc6\u514b\u7f57\u5c3c\u897f\u4e9a\u8054\u90a6":"+691","\u7f05\u7538":"+95","\u6469\u5c14\u591a\u74e6":"+373","\u6469\u6d1b\u54e5":"+212","\u6469\u7eb3\u54e5":"+377","\u83ab\u6851\u6bd4\u514b":"+258","\u58a8\u897f\u54e5":"+52","\u7eb3\u7c73\u6bd4\u4e9a":"+264","\u5357\u975e":"+27","\u5c3c\u6cca\u5c14":"+977","\u5c3c\u52a0\u62c9\u74dc":"+505","\u5c3c\u65e5\u5c14":"+227","\u5c3c\u65e5\u5229\u4e9a":"+234","\u632a\u5a01":"+47","\u5e15\u52b3":"+680","\u8461\u8404\u7259":"+351","\u5343\u91cc\u8fbe\u53ca\u6258\u5df4\u54e5":"+1868","\u65e5\u672c":"+81","\u745e\u5178":"+46","\u745e\u58eb":"+41","\u5723\u8bde\u5c9b":"+61","\u5723\u57fa\u8328\u548c\u5c3c\u7ef4\u65af":"+1869","\u5723\u5362\u897f\u4e9a":"+1758","\u5723\u9a6c\u529b\u8bfa":"+223","\u5723\u76ae\u57c3\u5c14\u548c\u5bc6\u514b\u9686\u7fa4\u5c9b":"+508","\u5723\u6587\u68ee\u7279\u548c\u683c\u6797\u7eb3\u4e01\u65af":"+1784","\u65af\u91cc\u5170\u5361":"+94","\u65af\u6d1b\u4f10\u514b":"+421","\u65af\u6d1b\u6587\u5c3c\u4e9a":"+386","\u65af\u5a01\u58eb\u5170":"+268","\u82cf\u4e39":"+249","\u82cf\u91cc\u5357":"+597","\u7d22\u9a6c\u91cc":"+252","\u5854\u5409\u514b\u65af\u5766":"+992","\u6c99\u7279\u963f\u62c9\u4f2f":"+966","\u585e\u820c\u5c14":"+248","\u585e\u6d66\u8def\u65af":"+357","\u585e\u5185\u52a0\u5c14":"+221","\u585e\u62c9\u5229\u6602":"+232","\u585e\u5c14\u7ef4\u4e9a":"+381","\u8428\u5c14\u74e6\u591a":"+503","\u6c64\u52a0":"+676","\u5766\u6851\u5c3c\u4e9a":"+255","\u6cf0\u56fd":"+66","\u7279\u514b\u65af\u548c\u51ef\u79d1\u65af\u7fa4\u5c9b":"+1649","\u7a81\u5c3c\u65af":"+216","\u56fe\u74e6\u5362":"+688","\u571f\u8033\u5176":"+90","\u571f\u5e93\u66fc\u65af\u5766":"+993","\u4e4c\u5179\u522b\u514b\u65af\u5766":"+998","\u4e4c\u62c9\u572d":"+598","\u4e4c\u514b\u5170":"+380","\u4e4c\u5e72\u8fbe":"+256","\u6587\u83b1":"+673","\u59d4\u5185\u745e\u62c9":"+58","\u5371\u5730\u9a6c\u62c9":"+502","\u53d9\u5229\u4e9a":"+963","\u5308\u7259\u5229":"+36","\u65b0\u897f\u5170":"+64","\u65b0\u5580\u91cc\u591a\u5c3c\u4e9a":"+687","\u65b0\u52a0\u5761":"+65","\u5e0c\u814a":"+30","\u897f\u8428\u6469\u4e9a":"+685","\u897f\u6492\u54c8\u62c9":"+212","\u897f\u73ed\u7259":"+34","\u8d8a\u5357":"+84","\u7ea6\u65e6":"+962","\u82f1\u5c5e\u7ef4\u5c14\u4eac\u7fa4\u5c9b":"+1284","\u82f1\u56fd":"+44","\u5370\u5ea6\u5c3c\u897f\u4e9a":"+62","\u5370\u5ea6":"+91","\u610f\u5927\u5229":"+39","\u4ee5\u8272\u5217":"+972","\u4f0a\u6717":"+98","\u4f0a\u62c9\u514b":"+964","\u4e5f\u95e8":"+967","\u4e9a\u7f8e\u5c3c\u4e9a":"+374","\u7259\u4e70\u52a0":"+1876","\u4e2d\u975e":"+236","\u667a\u5229":"+56","\u76f4\u5e03\u7f57\u9640":"+350","\u4e4d\u5f97":"+235","\u8d5e\u6bd4\u4e9a":"+260"},F=["Enter","Space"],K=i.createContext({}),$=function(e,t){var n=e.config,i=n.confirm,o=n.unsetCheckbox,r=n.onPageBeforeChange,a=n.allTextConfig;switch(t.type){case"LOADING":return C({},e,{showLoading:t.showLoading||!1});case"CHANGE_PAGE":return t.currentPage&&t.currentPage!==e.currentPage?!(t.currentPage===V.PAGE_LOGIN_SCAN_CODE&&i&&i.length>0)||null!=o&&o.scanCode||e.protocolCheck?(null==r||r(t.currentPage),C({},e,{currentPage:t.currentPage||V.PAGE_LOGIN_MOBILE_CODE,prevPage:e.currentPage,conflictInfo:t.conflictInfo||e.conflictInfo})):C({},e,{errorMessage:null==a||null==(s=a.extraText)?void 0:s.protocolCheckedError}):e;var s;case"COUNT":return e.counting?e.seconds<=1?C({},e,{seconds:60,counting:!1}):C({},e,{seconds:e.seconds-1}):C({},e,{counting:!0,seconds:t.seconds||60});case"STOP_COUNT":return C({},e,{seconds:60,counting:!1});case"ERROR":return"string"==typeof t.errorMessage?"CLOSE_CAPTCHA"===t.errorMessage?e:C({},e,{errorMessage:t.errorMessage}):"SECOND_VALID"===(null==(c=t.errorMessage)?void 0:c.description)?e:C({},e,{errorMessage:(null==(u=t.errorMessage)?void 0:u.description)||(null==a||null==(l=a.extraText)?void 0:l.defaultError)});var c,u,l;case"PROTOCOL":return C({},e,{protocolCheck:t.protocolCheck||!1});default:return e}},Y=i.createContext({}),Q=function(e,t){return"RESET"===t.type?{areaCode:"+86",mobile:"",email:"",code:"",account:"",password:"",newPassword:"",confirmPassword:""}:C({},e,t)},J=i.createContext({}),X=function(e,t){var n=e.loginScanCodeConfig;switch(t.type){case"timer":n.timer=t.val;break;case"autoFreshTimes":n.autoFreshTimes=t.val;break;case"qrCodeToken":n.qrCodeToken=t.val}return C({},e,t)},Z=i.createContext({}),ee=function(e,t){return C({},e,t)},te=function(e){var t=e.buttonText,n=e.onClick,o=void 0===n?function(){}:n,r=e.disabled,s=void 0!==r&&r;return i.createElement("button",{type:"submit",className:a()(["web-login-button",{"web-login-button__disabled":s}]),onClick:o},t)},ne=function(e){var t=e.buttonText,n=e.onClick,o=void 0===n?function(){}:n,r=(0,i.useContext)(J).config.teaConfig;return i.createElement("div",{className:"web-login-button__close",onClick:function(){var e;R("click_login_later",C({},null==r||null==(e=r.config)?void 0:e.evtParams),!0),null==o||o()}},t)},ie=function(e){var t=e.needCheck,n=void 0===t||t,o=e.beforeText,r=void 0===o?"":o,s=e.connectText,c=void 0===s?"":s,u=e.onCheckClick,l=(0,i.useContext)(J).config,d=(0,i.useContext)(K).viewState,f=(0,i.useState)(d.protocolCheck),h=f[0],p=f[1],_=l.confirm||[],m=function(){var e=!h;p(e),null==u||u(e)};if(!_||0===_.length)return null;var v,g;return i.createElement("div",{className:"web-login-confirm-info",tabIndex:0,"aria-label":(g=_.map((function(e){return e.text})),""+r+g.join(c))},n&&i.createElement("span",{className:a()(["web-login-confirm-info__checkbox",{"web-login-confirm-info__checkbox__checked":h}]),role:"checkbox","aria-checked":h,tabIndex:0,"aria-label":"\u534f\u8bae\u52fe\u9009\u6846",onClick:m,onKeyDown:function(e){F.includes(e.code)&&m()}}),i.createElement("span",{className:"web-login-confirm-info__before-text"},r),(v=[],_.forEach((function(e,t){var n=e.text,o=void 0===n?"":n,r=e.url,a=void 0===r?"":r,s=e.open,u=void 0===s?"_blank":s;v.push(i.createElement("a",{target:u,key:t,href:a,className:"web-login-confirm-info__info",tabIndex:0,"aria-label":o},o)),t!==_.length-1&&v.push(i.createElement("span",{key:t+"span",className:"web-login-confirm-info__connect-text"},c))})),v))},oe=function(){var e=(0,i.useContext)(K).viewState,t=(0,i.useRef)(null);return(0,i.useEffect)((function(){""!==e.errorMessage&&t.current&&t.current.focus()}),[e.errorMessage]),i.createElement("div",{className:"web-login-error",ref:t,role:"alert","aria-relevant":"all",tabIndex:0,"aria-live":"assertive","aria-atomic":"true","aria-label":"\u8b66\u544a:"+(""===e.errorMessage?"\u65e0":e.errorMessage)},e.errorMessage)},re=function(e){var t,n,o=e.onAreaCodeBlur,r=e.onTab,s=e.onAreaCodeChange,c=e.areaCodeValue,u=(0,i.useState)("text"),l=u[0],d=u[1],f=(0,i.useState)(3),h=f[0],p=f[1],_=(0,i.useState)(!1),m=_[0],v=_[1],g=(0,i.useState)("+86"),E=g[0],b=g[1],y=(0,i.useState)(!1),w=y[0],S=y[1],C=(0,i.useRef)(null),k=(0,i.useRef)(null),T=(0,i.useContext)(J).config.allTextConfig,O=T.districtList,x=T.extraText,I=function(e){e?(v(e),S(e)):setTimeout((function(){var t,n;null!=(t=document.activeElement)&&null!=(n=t.id)&&n.includes("areacode_item_")||(v(e),S(e))}),0)},A=function(){var e;null==C||null==(e=C.current)||e.focus(),d("text"),m||v(!0)},L=function(e){var t=e.key;if(e.preventDefault(),"Tab"===t)return null==r?void 0:r();var n=document.activeElement;if(n){var i,o;if("ArrowDown"===t)null==(i=n.nextElementSibling)||null==i.focus||i.focus();if("ArrowUp"===t)null==(o=n.previousElementSibling)||null==o.focus||o.focus();if("Enter"===t){var a=n.getAttribute("data-itemvalue");a&&P(a)}}},D=function(e){I(!1)},P=function(e){v(!1),S(!1),b(e),s(e)};return(0,i.useEffect)((function(){p(c.length)}),[c]),i.createElement("div",{className:"web-login-area-code"},i.createElement("div",{className:"web-login-area-code__input-wrapper"},i.createElement("input",{type:l,size:h,name:"web-login-area-code-input",className:"web-login-area-code__input-wrapper__input",autoComplete:"off",value:c,onChange:function(e){var t,n=(null==(t=e.target)?void 0:t.value)||"";(n=n.trim().replace(/[^\d\+]+/g,""))||(n="+"),s(n),I(!0)},onFocus:A,onClick:A,onKeyUp:function(e){if(F.includes(e.code)){var t,n,i=null==k||null==(t=k.current)||null==(n=t.firstElementChild)?void 0:n.getAttribute("data-itemvalue");if(!i)return void I(!1);I(!1),b(i),s(i)}},onBlur:function(e){var t=Object.keys(O).filter((function(e){return O[e]===c}));if(t.length>0){var n=O[t[0]];I(!1),b(n),s(n)}else I(!1),s(E);null==o||o()},ref:C,role:"combobox",tabIndex:0,"aria-owns":"select-ul","aria-activedescendant":"areacode_item_0","aria-label":x.areaCodeLabel}),i.createElement("i",{onMouseDown:function(e){var t;m?v(!0):(null==C||null==(t=C.current)||t.focus(),null==e||e.preventDefault())},className:a()(["web-login-area-code__input-wrapper__icon-arrow","web-login-area-code__input-wrapper__icon-arrow__"+(m?"up":"down")])})),m&&i.createElement("div",{className:a()(["web-login-area-code__select-list-wrapper"])},i.createElement("ul",{id:"select-ul",className:"web-login-area-code__select-list-wrapper__list",ref:k},(t=[],n=Object.keys(O),w&&(n=Object.keys(O).filter((function(e){return-1!==O[e].indexOf(c)||-1!==e.indexOf(c)}))),n.forEach((function(e,n){var o=O[e],r=o===c;t.push(i.createElement("li",{key:e,className:a()(["web-login-area-code__select-list-wrapper__list__item",{"web-login-area-code__select-list-wrapper__list__item__active":r}]),onMouseDown:P.bind(null,o),"data-itemvalue":o,id:"areacode_item_"+n,tabIndex:0,onKeyDown:L,onBlur:D,"aria-label":""+e+o},i.createElement("span",null,e),i.createElement("span",null,o)))})),t.length>0?t:i.createElement("li",{className:"web-login-area-code__select-list-wrapper__list__item",tabIndex:0,id:"areacode_item_no_match",onKeyDown:L,onBlur:D,"aria-label":x.areaCodeNoMatchedResult},x.areaCodeNoMatchedResult)))))},ae=function(e){var t=(0,i.useRef)(null),n=e.value,o=void 0===n?"":n,r=e.placeholder,a=void 0===r?"":r,s=e.type,c=void 0===s?"tel":s,u=e.autoComplete,l=void 0===u?"on":u,d=e.showAreaCode,f=void 0!==d&&d,h=e.onChange,p=e.onBlur,_=e.maxLength,m=void 0===_?50:_,v=e.inputLabel,g=void 0===v?"":v;return i.createElement("div",{className:"web-login-normal-input"},f&&i.createElement(re,{areaCodeValue:e.areaCodeValue,onAreaCodeBlur:e.onAreaCodeBlur,onAreaCodeChange:e.onAreaCodeChange,onTab:function(){var e;null==(e=t.current)||null==e.focus||e.focus()}}),i.createElement("input",{ref:t,name:"normal-input",type:c,className:"web-login-normal-input__input",value:o,placeholder:a,onChange:function(e){var t=e.target.value||"";h(t.trim())},onBlur:function(e){null==p||p()},autoComplete:l,maxLength:m,tabIndex:0,"aria-label":g}))},se=function(e){var t=(0,i.useContext)(K).viewState,n=(0,i.useContext)(Y),o=n.formValue,r=n.formComputedValue,s=e.type,c=void 0===s?"tel":s,u=e.buttonType,l=void 0===u?"normal":u,d=e.onClick,f=e.onChange,h=e.onBlur,p=void 0===h?function(){}:h,_=e.value,m=void 0===_?"":_,v=e.placeholder,g=void 0===v?"":v,E=e.buttonText,b=void 0===E?"":E,y=e.sendingText,w=void 0===y?"":y,S=e.maxLength,C=void 0===S?50:S,k=e.inputLabel,T=void 0===k?"":k,O=function(e){F.includes(e.code)&&d()},x=function(){return i.createElement("span",{className:a()(["web-login-button-input__button-text",{"web-login-button-input__button-text__disable":"send"===l&&t.counting||"send"===l&&"+86"===o.areaCode&&r.realMobile.length<11},{"send-input":"send"===l}]),onMouseDown:d,tabIndex:0,"aria-live":"off",role:"send"===l&&t.counting?"timer":"button",onKeyDown:O},"send"===l&&t.counting?w.replace(/\{seconds\}/g,String(t.seconds)):b)};return i.createElement("div",{className:"web-login-button-input"},"send"===l&&x(),i.createElement("div",{className:a()(["web-login-button-input__input-wrapper",{"send-input":"send"===l}])},i.createElement("input",{name:"button-input",type:c,className:"web-login-button-input__input",placeholder:g,onChange:function(e){var t=e.target.value||"";f(t.trim())},value:m,onBlur:function(e){p()},autoComplete:"off",maxLength:C,tabIndex:0,"aria-label":T})),"send"!==l&&x())},ce=function(e){var t=(0,i.useState)(!1),n=t[0],o=t[1],r=(0,i.useContext)(K).dispatchViewState,a=(0,i.useContext)(J).config.aid,s=e.id,c=e.text,u=e.type,l=e.clickToPage,d=e.ModalComponent,f=function(){R("custom_function",{aid:a,event_name:s}),"page"===u&&l&&r({type:"CHANGE_PAGE",currentPage:l}),"modal"===u&&o(!0)};return i.createElement(i.Fragment,null,"modal"===u&&n&&i.createElement("div",{className:"web-login-link-list__item__modal"},i.createElement("div",{className:"web-login-link-list__item__modal__icon-close",onClick:function(){o(!1)}}),d&&i.createElement(d,null)),i.createElement("div",{className:"web-login-link-list__item__text",key:c,tabIndex:0,"aria-label":c,role:"button",onMouseDown:f,onKeyDown:function(e){F.includes(e.code)&&f()}},c))},ue=function(e){var t,n,o=(0,i.useContext)(K).viewState,r=(0,i.useContext)(J).config,a=r.loginType,s=void 0===a?[]:a,c=r.registerType,u=void 0===c?[]:c,l=r.linkList,d=r.allTextConfig,f=[{key:"login",existOn:[V.PAGE_REGISTER_MOBILE_CODE,V.PAGE_REGISTER_EMAIL,V.PAGE_PASSWORD_RESET],text:null==d||null==(t=d.extraText)?void 0:t.switchToLogin,type:"page",clickToPage:s.length>0?s[0]:V.PAGE_LOGIN_MOBILE_CODE},{key:"register",existOn:[V.PAGE_LOGIN_ACCOUNT_PWD,V.PAGE_LOGIN_MOBILE_CODE,V.PAGE_LOGIN_SCAN_CODE,V.PAGE_PASSWORD_RESET],text:null==d||null==(n=d.extraText)?void 0:n.switchToRegister,type:"page",clickToPage:u.length>0?u[0]:V.PAGE_REGISTER_MOBILE_CODE}],h=(l||f).filter((function(e){return"login"===e.key?e.existOn.includes(o.currentPage)&&s.length>0:"register"===e.key?e.existOn.includes(o.currentPage)&&u.length>0:e.existOn.includes(o.currentPage)}));return i.createElement("ul",{className:"web-login-link-list"},h.map((function(e){var t=e.key;return i.createElement("li",{className:"web-login-link-list__item",key:t},i.createElement(ce,Object.assign({},e,{id:t})))})))};function le(){return i.createElement("div",{className:"web-login-loading"},i.createElement("i",{className:"web-login-loading__icon"}))}var de=function(e){var t,n=(0,i.useContext)(J).config,o=(0,i.useContext)(K),r=o.viewState,s=o.dispatchViewState,u=n.aid,l=n.otherMethod,d=void 0===l?[]:l,f=n.unsetCheckbox,h=n.confirm,p=n.allTextConfig,_=n.requestFunc,m=d.filter((function(e){var t=e.type,n=e.existOn,i=e.existRules;return"page"!==t||!n||!!n.includes(r.currentPage)&&(!i||0===i.length||i.every((function(e){var t=e.page,n=e.when.prevPage;return t!==r.currentPage||n===r.prevPage})))})),v=function(e){var t=e.key,n=e.type,i=e.clickToPage,o=e.authConfig;if("page"===n&&i&&s({type:"CHANGE_PAGE",currentPage:i}),!(h&&h.length>0)||null!=f&&f.thirdParty||r.protocolCheck)return"aweme"===t?(R("uc_login_submit",{login_method:"douyin",aid:u},!0),void function(e){var t=c()(window.location.href,!0);delete t.query.code,delete t.query.state;var n=t.set("query",C({},t.query,{from_aweme:"1"})).toString(),i=e.clientKey,o=void 0===i?"":i,r=e.scope,a=void 0===r?"":r,s=e.optionalScope,u=void 0===s?"":s,l=e.state,d=void 0===l?"":l,f=c()("https://open.douyin.com/platform/oauth/connect/",!0).set("query",{client_key:o,scope:a,optionalScope:u,state:d,response_type:"code",redirect_uri:n}).toString();window.location.href=f}(o)):["weixin","qzone_sns"].includes(t)?(R("uc_login_submit",{login_method:t,aid:u}),void _.wapLogin({platform:t,platformAppId:null==o?void 0:o.platformAppId})):void 0;s({type:"ERROR",errorMessage:p.extraText.protocolCheckedError})};return m.length>0?i.createElement("div",{className:"web-login-other-login-method"},i.createElement("div",{className:"web-login-other-login-method__text"},null==p||null==(t=p.extraText)?void 0:t.otherLoginText),i.createElement("ul",{className:"web-login-other-login-method__list",onKeyDown:function(e){var t=document.activeElement;if(t){var n,i;if("ArrowRight"===e.key)null==(n=t.nextElementSibling)||null==n.focus||n.focus();if("ArrowLeft"===e.key)null==(i=t.previousElementSibling)||null==i.focus||i.focus()}}},m.map((function(e){var t=e.key,n=e.text,o=e.label,r=void 0===o?"":o;return i.createElement("li",{className:"web-login-other-login-method__list__item",key:t,onMouseDown:v.bind(null,e),tabIndex:0,"aria-label":r||z[t]||"",role:"button",onKeyDown:function(t){return function(e,t){F.includes(e.code)&&v(t)}(t,e)}},i.createElement("i",{className:a()(["web-login-other-login-method__list__item__icon","web-login-other-login-method__list__item__icon__"+t])}),n&&i.createElement("span",null,n))})))):null},fe=function(){var e=(0,i.useContext)(J).config,t=(0,i.useContext)(K),n=t.viewState,o=t.dispatchViewState,r=t.viewComputedValue,s=e.loginTab,c=void 0===s?[]:s,u=e.registerTab,l=void 0===u?[]:u,d=e.loginType,f=void 0===d?[]:d,h=e.registerType,p=void 0===h?[]:h,_=e.allTextConfig,m=("login"===r.currentState&&(c.length>0||f.length>0)?c.length>0?c:f.map((function(e){return{key:e,existOn:f}})):"register"===r.currentState&&(l.length>0||p.length>0)?l.length>0?l:p.map((function(e){return{key:e,existOn:p}})):[{key:n.currentPage,existOn:[n.currentPage]}]).filter((function(e){var t=e.existOn,i=e.existRules;return!!t.includes(n.currentPage)&&(!i||0===i.length||i.some((function(e){var t=e.page,i=e.when.prevPage;return t!==n.currentPage||i===n.prevPage})))})).map((function(e){var t=e.key;return{key:t,existOn:e.existOn,title:_.titleMap[t]}})),v=function(e){o({type:"CHANGE_PAGE",currentPage:e})};return i.createElement("ul",{className:"web-login-tab-list",onKeyDown:function(e){var t=document.activeElement;if(t){var n,i;if("ArrowRight"===e.key)null==(n=t.nextElementSibling)||null==n.focus||n.focus();if("ArrowLeft"===e.key)null==(i=t.previousElementSibling)||null==i.focus||i.focus()}}},m.map((function(e){var t=e.key,o=e.title;return i.createElement("li",{onMouseDown:function(){v(t)},key:t,className:a()(["web-login-tab-list__item",{"web-login-tab-list__item__active":t===n.currentPage}]),tabIndex:0,"aria-label":o,role:"tab","aria-selected":t===n.currentPage,onKeyDown:function(e){return function(e,t){F.includes(e.code)&&v(t)}(e,t)}},o)})))},he=function(e){var t=e.type,n=void 0===t?"form":t,o=e.children,r=(0,i.useContext)(K),a=r.viewState,s=r.dispatchViewState,c=r.viewComputedValue,u=r.viewOperations,l=(0,i.useContext)(J).config,d=l.CustomFooter,f=l.linkAreaPosition;return i.createElement("article",{className:"web-login-common-wrapper"},i.createElement("div",{className:"web-login-common-wrapper__tab"},i.createElement(fe,null),"top"===f&&i.createElement(ue,null)),"form"===n?i.createElement("form",{className:"web-login-common-wrapper__form",onSubmit:function(e){return e.preventDefault(),!1}},o):i.createElement("div",null,o),"center"===f&&i.createElement(ue,null),"login"===c.currentState&&i.createElement(de,null),"bottom"===f&&i.createElement(ue,null),d&&i.createElement(d,{changePageType:function(e){s({type:"CHANGE_PAGE",currentPage:e})},currentPage:a.currentPage,checked:a.protocolCheck,onCheckClick:u.onCheckClick}))},pe=function(e){function t(t){return e.call(this,t)||this}k(t,e);var n=t.prototype;return n.componentDidCatch=function(e,t){var n=I.getSlardar();n&&n.throw(e,{description:"error boundary",componentStack:null==t?void 0:t.componentStack})},n.render=function(){return this.props.children},t}(i.Component),_e=null,me=null,ve=null,ge=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).state={showToast:!1,text:"",root:null},t}k(t,e),t.create=function(e){if(_e)return e&&e(_e);document.querySelector("#toastContainer")||((ve=document.createElement("div")).className="login-toastWrapper",ve.id="toastContainer",document.body.appendChild(ve)),o.render(i.createElement(t,{ref:function(t){_e=t,e&&e(_e)}}),ve)},t.info=function(e,t,n){this.create((function(i){me||i&&i.handleShowToast(e,t,n)}))};var n=t.prototype;return n.handleShowToast=function(e,t,n){var i=this;me&&(clearTimeout(me),me=null),this.setState({showToast:!0,text:e,root:t}),me=setTimeout((function(){i.handleCloseToast(),i.destroy(),me=null}),n||3e3)},n.handleCloseToast=function(e){this.setState({showToast:!1},(function(){return e&&e()}))},n.destroy=function(){var e;null==(e=ve)||e.remove(),_e=null},n.render=function(){var e=this.state,t=e.showToast,n=e.text,r=e.root,a=t&&n&&i.createElement("div",{className:"login-toast login-parentToastWrapper"},n);return i.createElement(i.Fragment,null,r?o.createPortal(a,r):a)},t}(i.Component),Ee=function(e){var t=e.loginMethod,n=void 0===t?"":t,o=(0,i.useContext)(J).config,r=(0,i.useContext)(Z).dataValue.isShowFeedBack,a=o.onFeedbackClick,s=void 0===a?function(){}:a,c="\u767b\u5f55/\u6ce8\u518c\u9047\u5230\u95ee\u9898\uff1f";return i.createElement(i.Fragment,null,r&&i.createElement("div",{className:"web-login-feedback"},i.createElement("div",{className:"web-login-feedback-desc","aria-label":c,tabIndex:0},c),i.createElement("div",{className:"web-login-feedback-button",onClick:function(){null==s||s(),R("click_feedback",{enter_from:"login_panel",login_suggest_method:n})},"aria-label":"\u53bb\u53cd\u9988",tabIndex:0},"\u53bb\u53cd\u9988")))},be=function(e,t){void 0===t&&(t={});var n=(null==e?void 0:e.method)||"get",i=(null==e?void 0:e.data)||{},o={"x-tt-passport-csrf-token":U("passport_csrf_token")||U("passport_csrf_token_default")||""},r=Object.assign({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json, text/javascript"},e.headers||{},o);e.headers=r;var a,s={};return Object.keys(i).filter((function(e){return i[e]!==undefined})).forEach((function(e){s[e]=i[e]})),["post","POST"].includes(n)&&(e.params=C({},t,(null==e?void 0:e.params)||{}),e.data=(a=s,Object.keys(a).map((function(e){var t=a[e];return"object"==typeof t?encodeURIComponent(e)+"="+encodeURIComponent(JSON.stringify(t)):encodeURIComponent(e)+"="+encodeURIComponent(t)})).join("&"))),["get","GET"].includes(n)&&(e.params=C({},s,t,e.params)),e};function ye(e){var t=e.host,n=e.isBoe,i=e.aid,o=e.account_sdk_source,r=void 0===o?"web":o,a=e.language,s=e.generalParams,c=m().create({baseURL:t||window&&(n?window.location.protocol:"https:")+"//"+window.location.hostname,withCredentials:!0}),u={aid:i,account_sdk_source:r,language:a};try{s&&(u=C({},s,u))}catch(l){}return c.interceptors.request.use((function(e){return be(e,u)}),undefined),c.interceptors.response.use((function(e){return function(e){var t,n=(null==e||null==(t=e.headers)?void 0:t["x-tt-logid"])||"",i=(null==e?void 0:e.data)||{};if("string"==typeof i)try{i=JSON.parse(i)}catch(l){}if(function(e){return"success"===(null==e?void 0:e.message)}(i))return Promise.resolve(function(e){return null==e?void 0:e.data}(i));var o=function(e){return null==e?void 0:e.data}(i);return Promise.reject(C({},o,{log_id:n}))}(e)}),undefined),c}var we=function(){var e=document.getElementById("account-container-mask");e&&(e.style.display="none")},Se=function(e){var t=e.closeCallBack,n=e.upSmsConfig,o=e.request,r=void 0===o?function(){return null}:o,s=e.successCallback,c=void 0===s?function(){return null}:s,u=e.failCallback,l=void 0===u?function(){return null}:u,d=e.initProps,f=n.mobile,h=void 0===f?"":f,p=n.sms_content,_=void 0===p?"":p,m=n.channel_mobile,v=n.verify_ticket,g=(0,i.useState)(""),E=g[0],b=g[1],y=(0,i.useRef)(!0),w=(0,i.useState)(10),S=w[0],k=w[1],T=(0,i.useRef)(S),O=(0,i.useState)(!1),x=O[0],I=O[1],A=function(){t&&t(),we()},L=null,D=null;(0,i.useEffect)((function(){T.current=S})),(0,i.useEffect)((function(){return R("uc_login_notify",{aid:d.aid,login_suggest_method:"register_up_sms",url:window.location.href}),function(){clearInterval(L),clearInterval(D)}}),[]);var P=function(e,t){var n;void 0===t&&(t=!0),null==(n=e({url:"/passport/upsms/verify/",method:"GET",data:{verify_ticket:v,timestamp:(new Date).getTime()}}))||n.then((function(e){b(""),M()})).catch((function(e){t&&b((null==e?void 0:e.description)||"\u670d\u52a1\u5668\u9519\u8bef")}))},M=function(){var e;clearInterval(L),clearInterval(D),y.current=!1,I(!1),null==(e=r({url:"/upsms/login/",method:"POST",data:{verify_ticket:v}}))||e.then((function(e){if(null!=e&&e.redirect_url)return window.location.href=e.redirect_url,c(e),void we()})).catch((function(e){l(e),b((null==e?void 0:e.description)||"\u670d\u52a1\u5668\u9519\u8bef")}))};return i.createElement("div",{id:"account-container-mask"},i.createElement("div",{className:"account-container"},i.createElement("div",{className:"account-container-content"},i.createElement("div",{className:"close",onClick:function(){A()}}),i.createElement("div",{className:"title"},"\u624b\u673a\u53f7\u9a8c\u8bc1"),i.createElement("div",{className:"desc"},function(e,t,n){"mobile"===t&&(n=n||"**********"),"email"===t&&(n=n||"*****@*****");var i=new RegExp("{s*"+t+"s*}");return null==e?void 0:e.replace(i,n+"")}("\u7cfb\u7edf\u8bc6\u522b\u5230\u4f60\u7684\u64cd\u4f5c\u73af\u5883\u5b58\u5728\u98ce\u9669\uff0c\u8bf7\u4f7f\u7528\u624b\u673a\u53f7{mobile}\uff0c\u6839\u636e\u4e0b\u65b9\u63d0\u793a\u8fdb\u884c\u5b89\u5168\u8eab\u4efd\u9a8c\u8bc1\uff0c\u9a8c\u8bc1\u5b8c\u6210\u540e\u5373\u53ef\u6ce8\u518c\u6210\u529f\u3002","mobile",h)),i.createElement("div",{className:"input-container"},i.createElement("span",{className:"label"},"\u7f16\u8f91\u77ed\u4fe1"),i.createElement("span",null,_)),i.createElement("div",{className:"input-container input-last"},i.createElement("span",{className:"label"},"\u53d1\u9001\u81f3"),i.createElement("span",null,m)),i.createElement("div",{className:"normal-text tips"},"\u63d0\u793a\uff1a\u53d1\u9001\u77ed\u4fe1\u53ef\u80fd\u4ea7\u751f\u8d39\u7528\uff0c\u4e00\u822c0.1\u5143/\u6761"),i.createElement("div",{className:"error-tips"},E),i.createElement("div",{className:"button-container"},i.createElement("div",{className:"button",onClick:function(){A()}},"\u53d6\u6d88"),i.createElement("div",{className:a()("button","normal",{loading:x}),onClick:function(){var e=ye(C({},d,{account_sdk_source:"web",host:""}));return!x&&(I(!0),y.current?(D=setInterval((function(){P(e,!1)}),3e3),L=setInterval((function(){T.current<1&&(D&&P(e),clearInterval(L),clearInterval(D),y.current=!1,I(!1)),k((function(e){return e-1}))}),1e3)):(P(e),I(!1)),null)}},"\u5df2\u53d1\u9001\u77ed\u4fe1\uff0c\u7acb\u5373\u767b\u5f55",y.current&&x&&S>0?"\uff08"+S+"s\uff09":null)))))};function Ce(e){var t=(0,i.useContext)(K).dispatchViewState,n=(0,i.useContext)(Z).dispatchDataValue;return{loginSuccessHandler:function(t){var n,i;M()&&(null==(n=window)||null==(i=n.localStorage)||i.setItem("bd_ticket_login_success","1"));null!=e&&e.success?e.success(t):null!=t&&t.redirect_url&&(window.location.href=t.redirect_url)},withErrorEffect:function(e){var n=e.result,i=e.errorMessage;return t({type:"ERROR",errorMessage:i}),n},loginFailHandler:function(t){"whileErr"===(null==e?void 0:e.feedbackShowTime)&&n({isShowFeedBack:!0})}}}var ke,Te=function(){},Oe=/^([A-Za-z0-9_\-\.\+])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,10})$/,xe=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(.{8,20})$/,Ie=/^(\d{3})(\d{0,4})(\d{0,4})$/,Ae=function(e,t,n){var i=!0,o="";return t||(o=n.extraText.mobileNull,i=!1),t&&"+86"===e&&11!==t.length&&(o=n.extraText.mobileFormatError,i=!1),{result:i,errorMessage:o}},Le=function(e,t,n){var i=!0,o="";"+86"===e&&t&&11!==t.length&&(o=n.extraText.mobileFormatError,i=!1);var r=Ae(e,t,n).result;return"+86"!==e&&t&&!r&&(o="",i=!1),{result:i,errorMessage:o}},De=function(e,t,n){var i=!0,o="";return e||(o=n.extraText.mobileCodeNull,i=!1),e&&e.length!==t&&(o=(n.extraText.mobileCodeError||"").replace("{X}",6===t?"\u516d":"\u56db"),i=!1),{result:i,errorMessage:o}},Pe=function(e,t){var n=!0,i="";return e||(i=t.extraText.emailNull,n=!1),e&&!Oe.test(e)&&(i=t.extraText.emailFormatError,n=!1),{result:n,errorMessage:i}},Re=function(e,t,n){var i=!0,o="";e||(o=n.extraText.passwordNull,i=!1);var r=t?new RegExp(t):xe;return e&&!r.test(e)&&(o=n.extraText.passwordFormatError,i=!1),{result:i,errorMessage:o}},Me=function(e,t,n){var i=!0,o="";return t||(o=n.extraText.confirmPasswordNull,i=!1),t&&t!==e&&(o=n.extraText.confirmPasswordError,i=!1),{result:i,errorMessage:o}},Ne=function(e,t,n,i,o,r){return i?Ae(t,e,r):o?Pe(e,r):e?n?Pe(e,r):Ae(t,e,r):{result:!1,errorMessage:r.extraText.accountNull}},Ge=function(e){var t=e.useWrap,n=void 0===t||t,r=(0,i.useState)(!0),a=r[0],s=r[1],c=(0,i.useState)(!0),u=c[0],l=c[1],d=(0,i.useRef)(!1),f=(0,i.useRef)(null),h=((0,i.useState)(!1),(0,i.useContext)(J).config),p=h.aid,_=h.mobileCodeLength,m=void 0===_?6:_,v=h.phoneSeparate,g=void 0!==v&&v,E=h.globalMobileSupport,b=void 0!==E&&E,y=h.unsetCheckbox,w=h.confirm,S=h.allTextConfig,k=h.requestFunc,T=h.upSmsRegisterCallback,O=h.loginOnly,x=void 0===O?{mobileCode:!1,thirdParty:!1}:O,I=h.onBlurCallback,A=h.onCloseLoginPanel,L=void 0===A?function(){}:A,D=h.isShowCloseBtnAfterLoginFail,P=S.mobileCodeLoginText,M=(0,i.useContext)(K),N=M.viewState,G=M.dispatchViewState,B=M.viewOperations,U=(0,i.useContext)(Y),j=U.formValue,z=U.dispatchFormValue,H=U.formComputedValue,W=(0,i.useContext)(Z),F=W.dispatchDataValue,$=W.dataValue.isShowCloseBtn,Q=Ce(h),X=Q.withErrorEffect,ee=Q.loginSuccessHandler,re=Q.loginFailHandler,ce=function(e){var t=e.replace(/[\D]+/g,"");if("+86"===j.areaCode){if(t.length>11)return;g&&(t=t.replace(Ie,"$1 $2 $3").trim())}f.current=null,z({mobile:t})},ue=function(e){f.current=null,z({areaCode:e})},le=function(){return null==I||I("LOGIN_MOBILE_CODE","phone"),X(Ae(j.areaCode,H.realMobile,S))},de=function(){return X(Le(j.areaCode,H.realMobile,S))},fe=function(e){var t=e.replace(/[\D]+/g,"");t.length>m||(f.current=null,z({code:t}))},pe=function(){return!!le()&&(null==I||I("LOGIN_MOBILE_CODE","code"),X(De(j.code,m,S)))},_e=function(){var e,t;a||d.current||(d.current=!0,R("uc_login_submit",C({login_method:"phone_sms",aid:p},null==h||null==(e=h.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),k.mobileCodeLogin({mobile:H.fullMobile,code:j.code,extra_params:f.current||{}}).then((function(e){var t,n;d.current=!1,R("uc_login_result",C({status:"success",login_method:"phone_sms",is_new_user:x.mobileCode?0:(null==e?void 0:e.is_new_user)!==undefined?null==e?void 0:e.is_new_user:(null==e?void 0:e.new_user)!==undefined?null==e?void 0:e.new_user:-1,aid:p},null==h||null==(t=h.teaConfig)||null==(n=t.config)?void 0:n.evtParams),!0),ee(C({},e,{currentPage:V.PAGE_LOGIN_MOBILE_CODE}))})).catch((function(e){var t,n;q(e),re(),D&&F({isShowCloseBtn:!0}),"SECOND_VALID"===(null==e?void 0:e.description)&&null!=e&&e.requestData&&(f.current=null==e?void 0:e.requestData),d.current=!1,R("uc_login_result",C({status:"fail",login_method:"phone_sms",aid:p,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""},null==h||null==(t=h.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),1011!==parseInt(null==e?void 0:e.error_code)?2046===parseInt(null==e?void 0:e.error_code)||G({type:"ERROR",errorMessage:e}):G({type:"ERROR",errorMessage:"\u8bf7\u4f7f\u7528\u6296\u97f3\u624b\u673aAPP\u767b\u5f55"})})))},me=function(){le()&&!N.counting&&k.loginSendCode({mobile:H.fullMobile}).then((function(e){var t,n;R("uc_send_sms",C({login_method:"phone_sms",send_method:u?"user_click":"resend",sms_scene:"login",status:"success",aid:p},null==h||null==(t=h.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),l(!1),G({type:"ERROR",errorMessage:""});var i=null==e?void 0:e.retry_time;G({type:"COUNT",seconds:i})})).catch((function(e){var t,n;if(q(e),R("uc_send_sms",C({login_method:"phone_sms",send_method:u?"user_click":"resend",sms_scene:"login",status:"fail",error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||"",aid:p},null==h||null==(t=h.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),2030===parseInt(null==e?void 0:e.error_code)){if(x.mobileCode)return void G({type:"ERROR",errorMessage:"\u8bf7\u4f7f\u7528\u6296\u97f3\u624b\u673aAPP\u767b\u5f55"});var r=document.createElement("div");return r.setAttribute("id","uc-register-upsms"),document.body.appendChild(r),T&&T.showCallback&&T.showCallback(),void o.render(i.createElement(Se,{upSmsConfig:e,initProps:h,request:k.commonRequest,successCallback:function(e){var t,n;T&&T.successCallback&&T.successCallback(e),R("uc_login_result",C({status:"success",login_method:"phone_up_sms",is_new_user:(null==e?void 0:e.is_new_user)!==undefined?null==e?void 0:e.is_new_user:(null==e?void 0:e.new_user)!==undefined?null==e?void 0:e.new_user:-1,aid:p},null==h||null==(t=h.teaConfig)||null==(n=t.config)?void 0:n.evtParams),!0)},failCallback:function(e){var t,n;T&&T.failCallback&&T.failCallback(e),R("uc_login_result",C({status:"fail",login_method:"phone_up_sms",aid:p,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""},null==h||null==(t=h.teaConfig)||null==(n=t.config)?void 0:n.evtParams))},closeCallBack:function(){T&&T.closeCallBack&&T.closeCallBack(),r&&(o.unmountComponentAtNode(r),document.body.contains(r)&&document.body.removeChild(r))}}),r)}l(!1),G({type:"ERROR",errorMessage:e})}))};(0,i.useEffect)((function(){var e=Ae(j.areaCode,H.realMobile,S).result,t=De(j.code,m,S).result;e&&t&&(N.protocolCheck||1===(null==y?void 0:y.mobileCode)||0===(null==w?void 0:w.length))?s(!1):s(!0)}),[j.areaCode,H.realMobile,j.code,N.protocolCheck]),(0,i.useEffect)((function(){var e,t;R("uc_login_notify",C({aid:p,login_suggest_method:"phone_sms",url:window.location.href},null==h||null==(e=h.teaConfig)||null==(t=e.config)?void 0:t.evtParams))}),[]);var ve=function(){return i.createElement(i.Fragment,null,i.createElement("div",{className:"web-login-mobile-code__mobile-input-wrapper"},i.createElement(ae,{type:"tel",onBlur:le,onChange:ce,value:j.mobile,showAreaCode:b,onAreaCodeBlur:de,onAreaCodeChange:ue,areaCodeValue:j.areaCode,placeholder:null==P?void 0:P.mobilePlaceholder,inputLabel:null==P?void 0:P.mobileLabel,autoComplete:"tel"})),i.createElement("div",{className:"web-login-mobile-code__code-input-wrapper"},i.createElement(se,{type:"tel",buttonType:"send",onClick:me,onChange:fe,onBlur:pe,value:j.code,placeholder:P.codePlaceholder,buttonText:P.sendCode,sendingText:P.sending,inputLabel:P.codeLabel})),i.createElement(oe,null),i.createElement(ie,{needCheck:1!==(null==y?void 0:y.mobileCode),onCheckClick:B.onCheckClick,beforeText:P.confirmInfoBeforeText,connectText:P.confirmInfoConnectText}),i.createElement("div",{className:"web-login-mobile-code__button-wrapper"},i.createElement(te,{disabled:a,buttonText:P.buttonText,onClick:_e})),i.createElement(Ee,{loginMethod:"phone_sms"}),$&&i.createElement(ne,{buttonText:"\u6682\u4e0d\u767b\u5f55",onClick:L}))};return i.createElement("article",{className:"web-login-mobile-code"},n?i.createElement(he,null,ve()):ve())},Be=function(){var e=document.getElementById("account-container-mask");e&&(e.style.display="none")},qe=function(e){var t=e.pwdConfig,n=void 0===t?{mobile:"",isAutoSendCode:!1,maxLength:6}:t,o=e.requestFunc,r=e.successCallback,s=void 0===r?function(){return null}:r,c=e.failCallback,u=void 0===c?function(){return null}:c,l=e.closeCallBack,d=e.initProps,f=n.mobile,h=void 0===f?"":f,p=n.isAutoSendCode,_=void 0===p||p,m=n.maxLength,v=void 0===m?6:m,g=(0,i.useState)(""),E=g[0],b=g[1],y=(0,i.useState)(""),w=y[0],S=y[1],k=(0,i.useRef)(!0),T=(0,i.useState)(60),O=T[0],x=T[1],I=(0,i.useRef)(O),A=(0,i.useState)(!1),L=A[0],D=A[1],P=(0,i.useState)(!1),M=P[0],N=P[1],G=null;(0,i.useEffect)((function(){I.current=O})),(0,i.useEffect)((function(){var e,t;return R("uc_login_verify_notify",C({aid:d.aid},null==d||null==(e=d.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),_&&q(!0),function(){clearInterval(G)}}),[]);var B=function(e){var t,n;R("uc_login_verify_submit",C({aid:d.aid},null==d||null==(t=d.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),o.mobileCodeLogin({mobile:h,code:e}).then((function(e){var t,n,i,o;if(R("uc_login_verify_result",C({status:"success",aid:d.aid},null==d||null==(t=d.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),R("uc_login_result",C({status:"success",aid:d.aid},null==d||null==(i=d.teaConfig)||null==(o=i.config)?void 0:o.evtParams,{login_method:"phone_password"})),b(""),null!=e&&e.redirect_url)return window.location.href=e.redirect_url,s(e),void Be()})).catch((function(e){var t,n;R("uc_login_verify_result",C({status:"fail",aid:d.aid,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""},null==d||null==(t=d.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),u(e),b((null==e?void 0:e.description)||"\u670d\u52a1\u5668\u9519\u8bef")}))},q=function(e){if(!L){D(!0);var t=e?{auto_code:"auto_code"}:{};o.loginSendCode({mobile:h,extra_params:t}).then((function(t){var n,i;R("uc_send_sms",C({send_method:k.current?e?"auto_system":"user_click":"resend",status:"success",aid:d.aid,sms_scene:"verify"},null==d||null==(n=d.teaConfig)||null==(i=n.config)?void 0:i.evtParams)),N(!0),G=setInterval((function(){I.current<1&&(clearInterval(G),k.current=!1,D(!1),N(!1),x(60)),x((function(e){return e-1}))}),1e3),D(!1),b("")})).catch((function(t){var n,i;R("uc_send_sms",C({send_method:k.current?e?"auto_system":"user_click":"resend",status:"fail",error_code:(null==t?void 0:t.error_code)||-1,fail_info:(null==t?void 0:t.description)||"",aid:d.aid,sms_scene:"verify"},null==d||null==(n=d.teaConfig)||null==(i=n.config)?void 0:i.evtParams)),k.current=!1,D(!1),N(!1),b((null==t?void 0:t.description)||"\u670d\u52a1\u5668\u9519\u8bef")}))}};return i.createElement("div",{id:"second-sms-mask"},i.createElement("div",{className:"second-sms-container"},i.createElement("div",{className:"second-sms-container-content"},i.createElement("div",{className:"close",onClick:function(){l&&l(),Be()}}),i.createElement("div",{className:"title"},"\u624b\u673a\u53f7\u9a8c\u8bc1"),i.createElement("div",{className:"desc"},"\u4e3a\u4fdd\u62a4\u5e10\u53f7\u5b89\u5168\uff0c\u8bf7\u8f93\u5165\u5f53\u524d\u624b\u673a\u53f7 "+function(e){var t=e.length-5,n="*".repeat(t);return""+(e.substring(0,3)+n+e.substring(e.length-2))}(h)+" \u6536\u5230\u7684\u9a8c\u8bc1\u7801\u3002"),i.createElement("div",{className:"input-container"},i.createElement("input",{type:"text",onChange:function(e){var t,n=e.target.value.trim().replace(/[\D]+/g,"")||"";S(n),(t=n).length>v||t.length==v&&B(t)},value:w,autoComplete:"off",maxLength:v,tabIndex:0,"aria-label":"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"}),i.createElement("span",null,M&&O>0?O+"s":null)),i.createElement("div",{className:"error-tips"},E),i.createElement("div",{className:"button-container"},i.createElement("div",{className:a()("button",{disable:M||L}),onClick:function(){q(!1)}},!_&&k.current?"\u53d1\u9001\u9a8c\u8bc1\u7801":"\u91cd\u65b0\u53d1\u9001")))))},Ue=P.iPhone,Ve=function(e){var t=e.useWrap,n=void 0===t||t,r=(0,i.useContext)(K),s=r.viewState,c=r.dispatchViewState,u=r.viewOperations,l=(0,i.useContext)(Y),d=l.formValue,f=l.dispatchFormValue,h=l.formComputedValue,p=(0,i.useContext)(J).config,_=(0,i.useContext)(Z),m=_.dispatchDataValue,v=_.dataValue.isShowCloseBtn,g=p.aid,E=p.mobileCodeLength,b=void 0===E?6:E,y=p.phoneSeparate,w=void 0!==y&&y,S=p.passwordMaxLength,k=void 0===S?20:S,T=p.isMobileAccountOnly,O=void 0!==T&&T,x=p.isEmailAccountOnly,I=void 0!==x&&x,A=p.initialAreaCodeState,D=void 0!==A&&A,P=p.rememberPwd,B=void 0!==P&&P,U=p.unsetCheckbox,j=p.confirm,z=p.allTextConfig,H=p.requestFunc,W=p.isPwdToMobile,F=void 0!==W&&W,$=p.LoginSecondSmsCallback,Q=p.onBlurCallback,X=p.onCloseLoginPanel,ee=void 0===X?function(){}:X,re=p.isShowCloseBtnAfterLoginFail,ce=z.accountPwdLoginText,ue=z.extraText,le=(0,i.useState)(!0),de=le[0],fe=le[1],pe=(0,i.useState)(D),_e=pe[0],me=pe[1],ve=(0,i.useState)(!1),ge=ve[0],be=ve[1],ye=(0,i.useRef)(!1),we=Ce(p),Se=we.withErrorEffect,ke=we.loginSuccessHandler,Te=we.loginFailHandler,Oe=function(e){if(Ue)return/^\d*$/.test(e)?me(D):me(!1),void f({account:e});if(O){var t=e.replace(/[\D]+/g,"");f({account:t})}else if(/^[\d\s]*$/.test(e)){var n=e.replace(/[\D]+/g,"");if("+86"===d.areaCode){if(n.length>11)return;w&&(n=n.replace(Ie,"$1 $2 $3").trim())}me(D),f({account:n})}else{var i=e.replace(/\s/g,"");me(!1),f({account:i})}},xe=function(e){f({areaCode:e})},Ae=function(){return null==Q||Q("LOGIN_ACCOUNT_PWD","account"),Se(Ne(h.realAccount,d.areaCode,h.isAccountEmail,O,I,z))},De=function(){return Se(Le(d.areaCode,h.realAccount,z))},Pe=function(e){e=e.replace(/[\u4e00-\u9fa5]/g,""),f({password:e})},Re=function(){return!!Ae()&&(null==Q||Q("LOGIN_ACCOUNT_PWD","password"),d.password?(c({type:"ERROR",errorMessage:""}),!0):(c({type:"ERROR",errorMessage:ue.passwordNull}),!1))},Me=function(){var e,t;de||ye.current||(ye.current=!0,R("uc_login_submit",C({login_method:h.isAccountEmail?"email_password":"phone_password",aid:g},null==p||null==(e=p.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),H.accountPwdLogin({account:h.fullAccount,password:d.password}).then((function(e){var t,n,i,o,r;ye.current=!1,R("uc_login_result",C({status:"success",login_method:h.isAccountEmail?"email_password":"phone_password",is_new_user:0,aid:g},null==p||null==(t=p.teaConfig)||null==(n=t.config)?void 0:n.evtParams),!0),ge?(i=h.realAccount,o=d.password,r=d.areaCode,M()&&(window.localStorage.setItem("local_account",L(i)),window.localStorage.setItem("local_password",L(o)),window.localStorage.setItem("local_areacode",L(r)),window.localStorage.setItem("local_settime",(new Date).getTime().toString()),window.localStorage.setItem("local_remember_status","1"))):G(!0),ke(C({},e,{currentPage:V.PAGE_LOGIN_ACCOUNT_PWD}))})).catch((function(e){var t,n;if(q(e),Te(),re&&m({isShowCloseBtn:!0}),ye.current=!1,R("uc_login_result",C({status:"fail",login_method:h.isAccountEmail?"email_password":"phone_password",aid:g,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""},null==p||null==(t=p.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),F&&(1039===parseInt(null==e?void 0:e.error_code)||2103===parseInt(null==e?void 0:e.error_code))){var r=document.createElement("div");return r.setAttribute("id","uc-login-seconds-sms"),document.body.appendChild(r),$&&$.showCallback&&$.showCallback(),void o.render(i.createElement(qe,{pwdConfig:{mobile:h.realAccount,isAutoSendCode:1039!==parseInt(null==e?void 0:e.error_code),maxLength:b},requestFunc:H,initProps:p,successCallback:function(e){$&&$.successCallback&&$.successCallback(e)},failCallback:function(e){$&&$.failCallback&&$.failCallback(e)},closeCallBack:function(){$&&$.closeCallBack&&$.closeCallBack(),r&&(o.unmountComponentAtNode(r),document.body.contains(r)&&document.body.removeChild(r))}}),r)}2046!==parseInt(null==e?void 0:e.error_code)&&c({type:"ERROR",errorMessage:e})})))},Ge=function(){c({type:"CHANGE_PAGE",currentPage:V.PAGE_PASSWORD_RESET})},Be=function(){be(!ge)};(0,i.useEffect)((function(){Ne(h.realAccount,d.areaCode,h.isAccountEmail,O,I,z).result&&d.password&&(s.protocolCheck||1===(null==U?void 0:U.accountPwd)||0===(null==j?void 0:j.length))?fe(!1):fe(!0)}),[d.areaCode,h.realAccount,d.password,h.isAccountEmail,s.protocolCheck]),(0,i.useEffect)((function(){var e,t;!function(){if(B&&M()){G();var e=N(),t=e.account,n=e.password,i=e.remember_status,o=e.areaCode;t&&n&&"1"===i&&(setTimeout((function(){f({account:t,password:n,areaCode:o||"+86"})}),100),be(!0))}}(),R("uc_login_notify",C({aid:g,login_suggest_method:"account_password",url:window.location.href},null==p||null==(e=p.teaConfig)||null==(t=e.config)?void 0:t.evtParams))}),[]);var Ve=function(){return i.createElement(i.Fragment,null,i.createElement("div",{className:"web-login-account-password__account-input-wrapper"},i.createElement(ae,{type:"text",onBlur:Ae,onChange:Oe,value:d.account,showAreaCode:_e,onAreaCodeBlur:De,onAreaCodeChange:xe,areaCodeValue:d.areaCode,placeholder:ce.accountPlaceholder,autoComplete:"username",inputLabel:ce.accountLabel})),i.createElement("div",{className:"web-login-account-password__password-input-wrapper"},i.createElement(se,{type:"password",buttonType:"normal",onClick:Ge,onChange:Pe,onBlur:Re,maxLength:k,value:d.password,placeholder:ce.pwdPlaceholder,buttonText:ce.forgetPwd,inputLabel:ce.pwdLabel})),i.createElement(oe,null),i.createElement(ie,{needCheck:1!==(null==U?void 0:U.accountPwd),onCheckClick:u.onCheckClick,beforeText:ce.confirmInfoBeforeText,connectText:ce.confirmInfoConnectText}),B&&M()&&i.createElement("div",{className:"web-login-account-password__remember"},i.createElement("span",{className:a()(["web-login-account-password__remember__checkbox",{"web-login-account-password__remember__checkbox__checked":ge}]),onClick:Be}),i.createElement("span",{className:"web-login-account-password__remember__text"},ce.rememberPwd)),i.createElement("div",{className:"web-login-account-password__button-wrapper"},i.createElement(te,{disabled:de,buttonText:ce.buttonText,onClick:Me})),i.createElement(Ee,{loginMethod:"account_password"}),v&&i.createElement(ne,{buttonText:"\u6682\u4e0d\u767b\u5f55",onClick:ee}))};return i.createElement("article",{className:"web-login-account-password"},n?i.createElement(he,null,Ve()):Ve())},je=null,ze=[],He=function(e){if(e&&"function"==typeof e){var t=parseInt((1e8*Math.random()).toString());return ze.push({index:t,handler:e}),t}return 0},We=function(){var e=S(y().mark((function e(t,i){var o,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(je){e.next=6;break}return e.next=3,Promise.resolve().then(n.t.bind(n,64999,23));case 3:o=e.sent,r=o.FWS,je=new r({fpID:null==t?void 0:t.fpID,aID:null==t?void 0:t.aID,accessKey:null==t?void 0:t.accessKey,ttwID:null==t?void 0:t.ttwID,deviceID:null==t?void 0:t.deviceID,url:null==t?void 0:t.url});case 6:return a=He(null==i?void 0:i.onmessage),je.onopen=function(e){null==i||i.onopen(e)},je.onmessage=function(e){Array.isArray(ze)&&ze.length&&ze.map((function(t){var n=t.handler;try{n(e)}catch(i){}}))},je.onclose=function(e){je=null},e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Fe=function(){return new Promise((function(e,t){je||e(!1),e(je.close())}))},Ke="0",$e=function(e){var t=e.useWrap,n=void 0===t||t,o=(0,i.useState)(""),r=o[0],s=o[1],c=(0,i.useRef)(!1),u=(0,i.useRef)(0),l=(0,i.useRef)(0),d=(0,i.useState)({type:"",text:"",buttonText:""}),f=d[0],h=d[1],p=(0,i.useRef)((new Date).getTime()),_=(0,i.useRef)(0),m=(0,i.useRef)(!1),v=(0,i.useRef)(null),g=(0,i.useContext)(J).config,E=((0,i.useContext)(K),(0,i.useContext)(Z)),b=E.dispatchDataValue,w=E.dataValue.isShowCloseBtn,k=Ce(g).loginFailHandler,T=g.aid,O=g.ScanCodeDescription,x=void 0===O?null:O,A=g.scanCodeNeedLogo,L=void 0!==A&&A,D=g.success,P=g.isStopCheckWhenHide,M=void 0!==P&&P,N=g.refreshNumber,G=void 0===N?0:N,B=g.allTextConfig,U=g.requestFunc,j=g.operationCallback,z=g.isFrontier,H=void 0!==z&&z,W=g.frontierUrl,F=void 0===W?"":W,$=g.isShortLink,Y=void 0!==$&&$,Q=g.checkQrCodeDelayTime,X=void 0===Q?0:Q,ee=g.onCloseLoginPanel,te=void 0===ee?function(){}:ee,ie=g.isShowCloseBtnAfterLoginFail,oe=B.scanCodeLoginText,re=B.extraText,ae=(0,i.useRef)({token:"",refreshCount:0}),se=function(e){ae.current=C({},ae.current,e)},ce=(0,i.useRef)(1),ue=(0,i.useRef)(!0),le=I.getSlardar(),de=!1;(0,i.useEffect)((function(){_.current>=60&&_.current<180&&ce.current<5?ce.current=3:_.current>=180&&(ce.current=5)}),[_.current]),(0,i.useEffect)((function(){return function(){var e,t=parseInt((((new Date).getTime()-p.current)/1e3).toFixed(),10),n=_.current?parseInt((t/_.current).toFixed(),10):0;null==le||le.dot({name:"check_qrCode_count",metrics:{count:_.current,time_range:t,avg_time_range:n},categories:{count:""+_.current,time_range:""+t,avg_time_range:""+n,is_support_websocket:""+Number(Boolean(window.WebSocket)),is_frontier:""+Number(H)}}),e=l.current,(ze=ze.filter((function(t){var n=t.index;return e!==n}))).length||Fe()}}),[]);var fe,pe,_e,me=function(){"hidden"!==document.visibilityState?Se(!1):ve()},ve=function(){ue.current=!1},ge=function(e){var t,n=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);try{return JSON.parse(t)}catch(i){return t}}(null==e||null==(t=e.message)?void 0:t.payload);401===(null==n?void 0:n.protocol_type)&&be({is_frontier:!0,skip_refresh_count_limit:!0})},be=(fe=function(e){var t,n=e.is_frontier,i=void 0!==n&&n,o=e.skip_refresh_count_limit,r=void 0!==o&&o,a=null==(t=ae.current)?void 0:t.token;return a?(_.current=_.current+1,U.checkQRCode({token:a,need_logo:L,is_frontier:i,need_short_url:Y}).then((function(e){var t,n=e.status,o=e.redirect_url,a=void 0===o?"":o,l=e.qrcode,d=void 0===l?"":l,f=e.token,p=void 0===f?"":f;switch(n){case"1":case"new":return m.current=!1,c.current=!1,h({type:"",text:"",buttonText:""}),Promise.resolve(!0);case"2":case"scanned":if(!m.current){var _,v,E,b,y,w,S,O,x;Ke=null!=g&&null!=(_=g.teaConfig)&&null!=(v=_.config)&&v.videoGuideFunc?(null==g||null==(y=g.teaConfig)||null==(w=y.config)?void 0:w.videoGuideFunc())||"0":(null==g||null==(S=g.teaConfig)||null==(O=S.config)||null==(x=O.evtParams)?void 0:x.is_video_guide)||"0",R("uc_login_submit",C({login_method:"qr_code",aid:T},null==g||null==(E=g.teaConfig)||null==(b=E.config)?void 0:b.evtParams,{is_video_guide:Ke}));var I=(new Date).getTime();R("uc_scan_code_time",{login_method:"qr_code",aid:T,is_frontier:i,time_diff:Math.round((I-(null==u?void 0:u.current))/1e3)}),m.current=!0,null==j||j("LOGIN_SCAN_CODE","scannedQrCode")}return c.current||(c.current=!0),h({type:"success",text:oe.scanSuccess,buttonText:oe.scanSuccessBtnText}),Promise.resolve(!0);case"3":Fe();var A=(new Date).getTime();return R("uc_confirm_code_time",{login_method:"qr_code",aid:T,is_frontier:i,time_diff:Math.round((A-(null==u?void 0:u.current))/1e3)}),null==j||j("LOGIN_SCAN_CODE","confirmQrCode"),function(e){var t,n,i,o,r,a,s,u,l;de||(de=!0,Ke=null!=g&&null!=(t=g.teaConfig)&&null!=(n=t.config)&&n.videoGuideFunc?(null==g||null==(r=g.teaConfig)||null==(a=r.config)?void 0:a.videoGuideFunc())||"0":(null==g||null==(s=g.teaConfig)||null==(u=s.config)||null==(l=u.evtParams)?void 0:l.is_video_guide)||"0",R("uc_login_result",C({status:"success",login_method:"qr_code",is_new_user:0,aid:T},null==g||null==(i=g.teaConfig)||null==(o=i.config)?void 0:o.evtParams,{is_video_guide:Ke}),!0),ve(),c.current=!0,h({type:"success",text:oe.loginSuccess,buttonText:oe.loginSuccessBtnText}),setTimeout((function(){D?D({redirect_url:e,currentPage:V.PAGE_LOGIN_SCAN_CODE}):window.location.replace(e)}),1e3))}(a),Promise.resolve(!1);case"4":return m.current=!1,c.current=!1,h({type:"",text:"",buttonText:""}),null==j||j("LOGIN_SCAN_CODE","refreshGetQrCode"),s(L?d:"data:image/jpeg;base64,"+d),se({token:p}),Promise.resolve(!0);case"5":case"expired":return null==j||j("LOGIN_SCAN_CODE","expiredQrCode"),se({refreshCount:(null==(t=ae.current)?void 0:t.refreshCount)+1}),null==le||le.dot({name:"qrcode_visit_downstream",metrics:{count:1},categories:{isFrontier:""+Number(H),isSupportWebSocket:""+Number(Boolean(window.WebSocket)),serverIsFrontier:""+Number(i),token:p,isShortLink:""+Number(Y),visitWay:"check_qrcode"}}),r||ae.current.refreshCount<=G?(ae.current.token=p,s(L?d:"data:image/jpeg;base64,"+d),c.current=!1,ue.current=!0,h({type:"",text:"",buttonText:""}),Promise.resolve(!0)):(c.current=!0,ue.current=!1,h({type:"refresh",text:oe.refreshCode,buttonText:oe.refreshBtnText}),Promise.resolve(!1));default:return k(),Promise.resolve(!1)}})).catch((function(e){var t,n,i,o,r;q(e),c.current=!0;var a=(null==e?void 0:e.description)||(null==e||null==(t=e.data)?void 0:t.description)||(null==re?void 0:re.defaultError),s=2046===parseInt(null==e?void 0:e.error_code)?"\u5237\u65b0\u91cd\u8bd5":a;return h({type:"error",text:s,buttonText:oe.refreshBtnText}),R("uc_login_result",C({status:"fail",login_method:"qr_code",aid:T,error_code:(null==e?void 0:e.error_code)||(null==e||null==(n=e.data)?void 0:n.error_code)||-1,fail_info:(null==e?void 0:e.description)||(null==e||null==(i=e.data)?void 0:i.description)||""},null==g||null==(o=g.teaConfig)||null==(r=o.config)?void 0:r.evtParams)),ie&&b({isShowCloseBtn:!0}),k(),Promise.resolve(!1)}))):Promise.resolve(!1)},pe=(0,i.useRef)(!1),_e=(0,i.useCallback)((function(){return pe.current?undefined:(pe.current=!0,fe.apply(void 0,arguments).finally((function(){pe.current=!1})))}),[fe]),_e),ye=function(){var e=S(y().mark((function e(t){var n,i,o,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.is_frontier,i=void 0!==n&&n,o=t.skip_refresh_count_limit,r=void 0!==o&&o,e.prev=1,e.next=4,be({is_frontier:i,skip_refresh_count_limit:r});case 4:e.sent&&ue.current&&setTimeout((function(){ye({is_frontier:!1,skip_refresh_count_limit:!1})}),1e3*ce.current),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),we=function(e){["refresh","failed","error"].includes(f.type)&&Se(!0)},Se=function(e){void 0===e&&(e=!1),ue.current=!0,ye({skip_refresh_count_limit:e,is_frontier:!1})};(0,i.useEffect)((function(){var e,t;R("uc_login_notify",C({aid:T,login_suggest_method:"qr_code",url:window.location.href},null==g||null==(e=g.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),M&&document.addEventListener("visibilitychange",me);var n=new IntersectionObserver((function(e){var t=e[0];null!=t&&t.isIntersecting?U.getQrCode({need_logo:L,need_short_url:Y}).then(function(){var e=S(y().mark((function e(t){var n,i,o,r,a,d,f,p;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.qrcode,i=void 0===n?"":n,o=t.token,r=void 0===o?"":o,a=t.is_frontier,d=void 0!==a&&a,f=t.frontier_params,p=void 0===f?null:f,m.current=!1,c.current=!1,h({type:"",text:"",buttonText:""}),s(L?i:"data:image/jpeg;base64,"+i),se({token:r}),u.current=(new Date).getTime(),null==j||j("LOGIN_SCAN_CODE","getQrCode"),setTimeout(S(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(setTimeout((function(){ye({is_frontier:!1,skip_refresh_count_limit:!1})}),1e3*ce.current||1e3),!(H&&d&&p&&window.WebSocket)){e.next=12;break}if(!je){e.next=6;break}return ce.current=5,l.current||(t=He((function(e){ge(e)})),l.current=t),e.abrupt("return");case 6:return null==le||le.dot({name:"frontier_onopen",metrics:{count:1}}),e.next=9,We({fpID:null==p?void 0:p.product_id,aID:T,accessKey:null==p?void 0:p.access_key,deviceID:null==p?void 0:p.frontier_device,url:F},{onopen:function(e){ce.current=5,null==le||le.dot({name:"frontier_onopen_success",metrics:{count:1}})},onmessage:function(e){ge(e),null==le||le.dot({name:"frontier_onmessage",metrics:{count:1}})},onclose:function(e){null==le||le.dot({name:"frontier_onclose",metrics:{count:1}})}});case 9:n=e.sent,l.current=n;case 12:case"end":return e.stop()}}),e)}))),1e3*X),null==le||le.dot({name:"scan_code_init",metrics:{count:1},categories:{isFrontier:""+Number(H),isSupportWebSocket:""+Number(Boolean(window.WebSocket)),serverIsFrontier:""+Number(d),token:r}}),null==le||le.dot({name:"qrcode_visit_downstream",metrics:{count:1},categories:{isFrontier:""+Number(H),isSupportWebSocket:""+Number(Boolean(window.WebSocket)),serverIsFrontier:""+Number(d),token:r,isShortLink:""+Number(Y),visitWay:"get_qrcode"}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){q(e),c.current=!0,h({type:"failed",text:oe.getCodeFailed,buttonText:oe.codeFailedBtnText}),k()})):ve()}),{type:Object,required:!0,default:{threshold:.5}});return(null==v?void 0:v.current)&&(null==n||null==n.observe||n.observe(v.current)),function(){(null==v?void 0:v.current)&&(null==n||null==n.unobserve||n.unobserve(v.current)),ve(),se({refreshCount:0,token:""}),M&&document.removeEventListener("visibilitychange",me)}}),[]);var ke=function(){var e;return i.createElement(i.Fragment,null,i.createElement("div",{className:"web-login-scan-code__content",ref:v},i.createElement("div",{className:a()("web-login-scan-code__content__qrcode-wrapper",{"web-login-scan-code__content__qrcode-tip":!(null!=c&&c.current)}),onClick:function(e){e.stopPropagation()}},r&&i.createElement("img",{alt:"",src:r,className:"web-login-scan-code__content__qrcode-wrapper__qrcode",tabIndex:0,"aria-label":oe.qrCodeLabel}),c.current&&i.createElement("div",{className:"web-login-scan-code__content__qrcode-wrapper__mask",onClick:we},i.createElement("div",{className:"web-login-scan-code__content__qrcode-wrapper__mask__toast"},i.createElement("p",{className:a()(["web-login-scan-code__content__qrcode-wrapper__mask__toast__icon",f.type])},f.buttonText),i.createElement("p",{className:a()(["web-login-scan-code__content__qrcode-wrapper__mask__toast__text",f.type])},f.text)))),x&&i.createElement(x,{qrCodeStatus:f.type,getQRCode:function(){ye({is_frontier:!1,skip_refresh_count_limit:!1})},autoRefreshNum:null==(e=ae.current)?void 0:e.refreshCount})),i.createElement(Ee,{loginMethod:"qr_code"}),w&&i.createElement(ne,{buttonText:"\u6682\u4e0d\u767b\u5f55",onClick:te}))};return i.createElement("article",{className:"web-login-scan-code"},n?i.createElement(he,{type:"normal"},ke()):ke())},Ye="https://lf3-static.bytednsdoc.com/obj/eden-cn/oveh7hpqhpqnuhbo/douyin_pc_login/dafault-avatar.png",Qe=function(e){var t=e.useWrap,n=void 0!==t&&t,o=(0,i.useState)(""),r=o[0],s=o[1],c=(0,i.useState)(!0),u=c[0],l=c[1],d=(0,i.useState)("normal"),f=d[0],h=d[1],p=(0,i.useContext)(J).config,_=(0,i.useContext)(K),m=_.dispatchViewState,g=_.viewOperations,E=(0,i.useContext)(Z).dispatchDataValue,b=Ce(p),y=b.loginSuccessHandler,w=b.loginFailHandler,S=p.aid,k=p.unsetCheckbox,T=p.mobileCodeLength,O=void 0===T?6:T,x=p.lastPage,A=p.isFirstTrust,L=void 0!==A&&A,D=p.currentUserInfo,P=void 0===D?null:D,M=p.allTextConfig,N=p.requestFunc,G=p.next,B=p.subjectAid,U=p.scene,j=void 0===U?"normal":U,z=p.isOversea,H=void 0!==z&&z,W=p.region,F=void 0===W?"cn":W,$=p.appName,Y=void 0===$?"":$,Q=p.language,X=void 0===Q?"zh":Q,ee=p.isBoe,te=void 0!==ee&&ee,ne=p.acrawler,oe=void 0===ne?"1":ne,re=p.captchaShowMode,ae=void 0===re?"mask":re,se=p.captchaHost,ce=void 0===se?"":se,ue=p.secondVerifyWebOptions,le=p.generalParams,de=void 0===le?{}:le,fe=p.isShowCloseBtnAfterLoginFail,pe=M.trustedLoginText,_e=x===V.PAGE_LOGIN_TRUST||x===V.PAGE_LOGIN_PUSH?V.PAGE_LOGIN_SCAN_CODE:x||V.PAGE_LOGIN_SCAN_CODE,me={aid:S,subjectAid:B,scene:j,host:window.location.origin,isOversea:H,region:F,appName:Y,language:X,isBoe:te,acrawler:oe,captchaShowMode:ae,captchaHost:ce,printLog:!1,secondVerifyWebOptions:C({useSmsMode:O||6},ue),generalParams:de},ve=new v.WebInterfaceSdk(me),Ee=I.getSlardar(),be=function(){var e,t;return R("trustdevice_verify_request",C({aid:S},null==p||null==(e=p.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),null==Ee||Ee.dot({name:"can_one_login",categories:{is_first_trust:""+L}}),new Promise((function(e,t){ve.request({url:"/passport/web/can_one_login/",method:"POST",data:{sec_user_id:(null==P?void 0:P.uid)||""}}).then((function(t){var n,i,o=t.one_login_ticket,r=void 0===o?"":o;R("trustdevice_verify_result",C({result:1,aid:S},null==p||null==(n=p.teaConfig)||null==(i=n.config)?void 0:i.evtParams)),null==Ee||Ee.dot({name:"can_one_login_result",categories:{is_first_trust:""+L,status:"success"}}),e(r)})).catch((function(e){var n,i;q(e),R("trustdevice_verify_result",C({result:0,aid:S},null==p||null==(n=p.teaConfig)||null==(i=n.config)?void 0:i.evtParams)),null==Ee||Ee.dot({name:"can_one_login_result",categories:{is_first_trust:""+L,status:"fail",error_code:""+(null==e?void 0:e.error_code),fail_info:""+(null==e?void 0:e.description)}}),t(e)}))}))},ye=function(){"normal"===f&&(h("fetching"),null==Ee||Ee.dot({name:"click_to_trust_login",categories:{is_first_trust:""+L}}),L?be().then((function(e){we(e)})).catch((function(e){fe&&E({isShowCloseBtn:!0}),w(),ge.info("\u5df2\u4e3a\u4f60\u8df3\u8f6c\u5176\u4ed6\u767b\u5f55\u65b9\u5f0f",document.querySelector("#web-login-container")||null),q(e),Se(_e)})):we(r))},we=function(e){var t,n;R("uc_login_submit",C({login_method:"trustdevice_one_click",aid:S},null==p||null==(t=p.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),null==Ee||Ee.dot({name:"one_login",categories:{is_first_trust:""+L}}),N.commonRequest({url:"/one_login/",method:"POST",data:{sec_user_id:(null==P?void 0:P.uid)||"",one_login_ticket:e||"",service:G}}).then((function(e){var t,n;R("uc_login_result",C({login_method:"trustdevice_one_click",is_push_verify_stage:0,status:"success",aid:S},null==p||null==(t=p.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),null==Ee||Ee.dot({name:"one_login_result",categories:{is_first_trust:""+L,status:"success"}}),h("success"),y(C({},e,{currentPage:V.PAGE_LOGIN_TRUST}))})).catch((function(e){var t,n;fe&&E({isShowCloseBtn:!0});var i=e.error_code,o=e.verify_ticket,r=void 0===o?"":o;if(q(e),R("uc_login_result",C({status:"fail",login_method:"trustdevice_one_click",is_push_verify_stage:0,aid:S,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""},null==p||null==(t=p.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),null==Ee||Ee.dot({name:"one_login_result",categories:{is_first_trust:""+L,status:"fail",error_code:""+(null==e?void 0:e.error_code),fail_info:""+(null==e?void 0:e.description)}}),2046===i)return E({pushTicket:r}),void Se(V.PAGE_LOGIN_PUSH);w(),ge.info("\u5df2\u4e3a\u4f60\u8df3\u8f6c\u5176\u4ed6\u767b\u5f55\u65b9\u5f0f",document.querySelector("#web-login-container")||null),Se(_e)}))},Se=function(e){m({type:"CHANGE_PAGE",currentPage:e})};(0,i.useEffect)((function(){var e,t;(null==Ee||Ee.dot({name:"trust_login_init",categories:{is_first_trust:""+L}}),L)?(l(!1),R("uc_login_notify",C({aid:S,login_suggest_method:"trustdevice_one_click",url:window.location.href},null==p||null==(e=p.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),null==Ee||Ee.dot({name:"trust_login_show",categories:{is_first_trust:""+L}})):be().then((function(e){var t,n;s(e),l(!1),R("uc_login_notify",C({aid:S,login_suggest_method:"trustdevice_one_click",url:window.location.href},null==p||null==(t=p.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),null==Ee||Ee.dot({name:"trust_login_show",categories:{is_first_trust:""+L}})})).catch((function(){Se(V.PAGE_LOGIN_SCAN_CODE)}))}),[]);var ke=function(){return u?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,i.createElement("div",{className:"web-login-trusted__content"},i.createElement("div",{className:"web-login-trusted__desc"},null==pe?void 0:pe.desc),i.createElement("div",{className:"web-login-trusted__subdesc"},null==pe?void 0:pe.subdesc),i.createElement("img",{src:(null==P?void 0:P.avatarUrl)||Ye,className:"web-login-trusted__photo",onError:function(e){var t=e.currentTarget;t.onerror=null,t.src=Ye}}),i.createElement("div",{className:"web-login-trusted__nickname"},(null==P?void 0:P.nickname)||"\u672a\u77e5"),i.createElement("div",{className:"web-login-trusted__button-wrapper"},i.createElement("div",{className:a()(["web-login-button"]),onClick:ye},"normal"===f&&pe.buttonText,"fetching"===f&&i.createElement("div",{className:"web-login-button-load-icon"}),"success"===f&&i.createElement("div",{className:"web-login-button-success-icon"}))),i.createElement(ie,{needCheck:1!==(null==k?void 0:k.trusted),onCheckClick:g.onCheckClick,beforeText:pe.confirmInfoBeforeText,connectText:pe.confirmInfoConnectText}),i.createElement("div",{className:"web-login-trusted__other-login"},(e=null==pe?void 0:pe.otherLoginText,t="\u767b\u5f55",n=i.createElement("span",{onClick:function(){null==Ee||Ee.dot({name:"click_to_other_login",categories:{is_first_trust:""+L}}),Se(V.PAGE_LOGIN_SCAN_CODE)}},"\u767b\u5f55"),o=e.split(t),i.createElement(i.Fragment,null,o[0],n,o[1])))));var e,t,n,o};return i.createElement("article",{className:"web-login-trusted"},n?i.createElement(he,{type:"normal"},ke()):ke())},Je="https://lf3-static.bytednsdoc.com/obj/eden-cn/oveh7hpqhpqnuhbo/douyin_pc_login/dafault-avatar.png",Xe=function(e){var t=e.useWrap,n=void 0!==t&&t,o=(0,i.useRef)(""),r=(0,i.useRef)(0),s=(0,i.useRef)(!1),c=(0,i.useRef)(0),u=(0,i.useState)("normal"),l=u[0],d=u[1],f=(0,i.useContext)(J).config,h=(0,i.useContext)(K).dispatchViewState,p=(0,i.useContext)(Z).dataValue,_=Ce(f),m=_.loginSuccessHandler,v=_.loginFailHandler,E=f.aid,b=f.lastPage,y=void 0===b?V.PAGE_LOGIN_SCAN_CODE:b,w=f.isFirstTrust,S=void 0!==w&&w,k=f.currentUserInfo,T=void 0===k?null:k,O=f.allTextConfig,x=f.requestFunc,A=f.next,L=f.pushDisableTime,D=void 0===L?300:L,P=f.pushFrontierUrl,M=void 0===P?"":P,N=f.isFrontier,G=void 0!==N&&N,B=O.pushLoginText,q=y===V.PAGE_LOGIN_TRUST||y===V.PAGE_LOGIN_PUSH?V.PAGE_LOGIN_SCAN_CODE:y,U=I.getSlardar(),z=null,H=function(e){var t=e.count,n=void 0===t?0:t,o=e.checkAfterZero,r=(0,i.useState)(n),a=r[0],s=r[1],c=(0,i.useRef)(Te),u=(0,i.useRef)(null),l=(0,i.useRef)(null),d=(0,i.useRef)(null),f=function(){c.current=Te,null==u.current||u.current(),null==l.current||l.current(),u.current=null,l.current=null,s(n)},h=function(){if(a>1){if(d.current){var e=(new Date).getTime(),t=Math.floor((e-d.current)/1e3);return d.current=e,void s(a-t)}s(a-1)}else f(),null==o||o()};(0,i.useEffect)((function(){c.current=h}));var p=function(){var e=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);"hidden"===document.visibilityState&&e?d.current=(new Date).getTime():d.current=null};return(0,i.useEffect)((function(){return document.addEventListener("visibilitychange",p),function(){f()}}),[]),[a,function(e){var t=e.count,n=e.pollingFunc;t&&s(t),u.current&&(null==u.current||u.current()),u.current=j((function(){c.current()}),1e3),l.current&&(null==l.current||l.current()),l.current=j((function(){null==n||n()}),5e3)},f]}({count:D,checkAfterZero:function(){d("error"),s.current&&z&&z.close(),r.current>=Y?(v(),ge.info("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u65b9\u5f0f\u7ee7\u7eed\u767b\u5f55",document.querySelector("#web-login-container")||null),re(q)):ge.info("\u767b\u5f55\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u91cd\u65b0\u7533\u8bf7\u767b\u5f55",document.querySelector("#web-login-container")||null)}}),W=H[0],F=H[1],$=H[2],Y=2,Q=function(){null==U||U.dot({name:"send_push",metrics:{time:r.current+1}}),d("fetching"),r.current=r.current+1,x.commonRequest({url:"/send_push/",method:"POST",data:{device_id:"",sec_user_id:(null==T?void 0:T.uid)||"",verify_ticket:null==p?void 0:p.pushTicket}}).then((function(e){var t,n=e.token,i=void 0===n?"":n,a=e.is_frontier,c=void 0!==a&&a,u=e.frontier_params,l=void 0===u?null:u;o.current=i;var d=G&&c&&l&&Boolean(null==(t=window)?void 0:t.WebSocket);s.current=d,d?ne(l):F({count:D,pollingFunc:ee}),ge.info("\u6296\u97f3\u7535\u8111\u7aef\u5df2\u7ecf\u7ed9\u4f60\u7684\u624b\u673a\u53d1\u9001\u4e86\u63a8\u9001\u901a\u77e5",document.querySelector("#web-login-container")||null),null==U||U.dot({name:"send_push_result",categories:{status:"success"},metrics:{time:r.current+1}})})).catch((function(e){null==U||U.dot({name:"send_push_result",categories:{status:"fail",error_code:""+(null==e?void 0:e.error_code),fail_info:""+(null==e?void 0:e.description)},metrics:{time:r.current+1}}),oe(e)}))},X=function(e,t){void 0===t&&(t=1e3);var n=null;return function(i){n||(n=setTimeout((function(){n&&clearTimeout(n),n=null,e(i)}),t))}}((function(){var e,t;"fetching"===l||r.current>=Y||(R("push_login_verify_resend_click",C({aid:E},null==f||null==(e=f.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),Q())})),ee=function(){null==U||U.dot({name:"check_push"}),c.current=c.current+1,x.commonRequest({url:"/check_push_result/",method:"POST",data:{token:o.current}}).then((function(e){null==U||U.dot({name:"check_push_result",categories:{status:"success"}});var t=e.status,n=void 0===t?"":t;"allowed"===n?(ie(),te()):"rejected"!==n&&"expired"!==n||(ie(),oe({},"\u624b\u673a\u7aef\u672a\u5b8c\u6210\u786e\u8ba4\uff0c\u8bf7\u91cd\u65b0\u7533\u8bf7\u767b\u5f55"))})).catch((function(e){null==U||U.dot({name:"check_push_result",categories:{status:"fail",error_code:""+(null==e?void 0:e.error_code),fail_info:""+(null==e?void 0:e.description)}})}))},te=function(){null==U||U.dot({name:"push_login"}),x.commonRequest({url:"/one_login/",method:"POST",data:{sec_user_id:(null==T?void 0:T.uid)||"",service:A}}).then((function(e){var t,n;R("uc_login_result",C({login_method:"trustdevice_one_click",is_push_verify_stage:1,status:"success",aid:E},null==f||null==(t=f.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),null==U||U.dot({name:"push_login_result",categories:{status:"success"}}),d("success"),m(C({},e,{currentPage:V.PAGE_LOGIN_PUSH}))})).catch((function(e){var t,n;R("uc_login_result",C({status:"fail",login_method:"trustdevice_one_click",is_push_verify_stage:1,aid:E,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""},null==f||null==(t=f.teaConfig)||null==(n=t.config)?void 0:n.evtParams)),null==U||U.dot({name:"push_login_result",categories:{status:"fail",error_code:""+(null==e?void 0:e.error_code),fail_info:""+(null==e?void 0:e.description)}}),oe(e)}))},ne=function(e){F({count:D,pollingFunc:ee}),z||(z=new g.FWS({fpID:null==e?void 0:e.product_id,aID:String(E),accessKey:null==e?void 0:e.access_key,deviceID:null==e?void 0:e.frontier_device,url:M})),z.onopen=function(e){null==U||U.dot({name:"push_frontier_onopen_success",metrics:{count:1}})},z.onmessage=function(e){var t;null==U||U.dot({name:"push_frontier_onmessage",metrics:{count:1}});var n=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);try{return JSON.parse(t)}catch(i){return t}}(null==e||null==(t=e.message)?void 0:t.payload).allow_login;"true"===(void 0===n?"":n)?(ie(),te()):(ie(),oe({},"\u624b\u673a\u7aef\u672a\u5b8c\u6210\u786e\u8ba4\uff0c\u8bf7\u91cd\u65b0\u7533\u8bf7\u767b\u5f55"))},z.onclose=function(e){null==U||U.dot({name:"push_frontier_onclose",metrics:{count:1}})}},ie=function(){$(),s.current&&z&&z.close()},oe=function(e,t){void 0===t&&(t="\u7f51\u7edc\u73af\u5883\u5dee\uff0c\u8bf7\u60a8\u91cd\u65b0\u7533\u8bf7\u767b\u5f55");var n=e.error_code;r.current<Y&&![7,2029].includes(n)?(d("error"),ge.info(t,document.querySelector("#web-login-container")||null)):(v(),ge.info("\u5df2\u4e3a\u4f60\u8df3\u8f6c\u5176\u4ed6\u767b\u5f55\u65b9\u5f0f",document.querySelector("#web-login-container")||null),re(q))},re=function(e){h({type:"CHANGE_PAGE",currentPage:e})},ae=(0,i.useCallback)((function(e){var t=Math.floor(e/60),n=(e%60/100).toFixed(2).slice(-2);return i.createElement(i.Fragment,null,B.buttonFetchText,"\uff08",i.createElement("span",null,t),"\u5206",i.createElement("span",{className:"web-login-button-push-count"},n),"\u79d2","\uff09")}),[]);(0,i.useEffect)((function(){var e,t;return null==U||U.dot({name:"push_login_show",categories:{is_first_trust:""+S}}),R("push_login_verify_waits_show",C({aid:E},null==f||null==(e=f.teaConfig)||null==(t=e.config)?void 0:t.evtParams)),Q(),function(){ie(),null==U||U.dot({name:"check_push_count",metrics:{count:c.current}})}}),[]);var se=function(){return i.createElement(i.Fragment,null,i.createElement("div",{className:"web-login-push__content"},i.createElement("div",{className:"web-login-push__desc"},null==B?void 0:B.desc),i.createElement("div",{className:"web-login-push__subdesc"},null==B?void 0:B.subdesc),i.createElement("img",{src:(null==T?void 0:T.avatarUrl)||Je,className:"web-login-push__photo",onError:function(e){var t=e.currentTarget;t.onerror=null,t.src=Je}}),i.createElement("div",{className:"web-login-push__nickname"},(null==T?void 0:T.nickname)||"\u672a\u77e5"),i.createElement("div",{className:"web-login-push__lead"},null==B?void 0:B.leadText),i.createElement("div",{className:"web-login-push__button-wrapper"},i.createElement("div",{className:a()(["web-login-button",{disable:"fetching"===l}]),onClick:X},"normal"===l&&B.buttonText,"fetching"===l&&ae(W),"error"===l&&B.buttonErrText,"success"===l&&i.createElement("div",{className:"web-login-button-success-icon"}))),i.createElement("div",{className:"web-login-push__other-login"},(e=null==B?void 0:B.otherLoginText,t="\u767b\u5f55",n=i.createElement("span",{onClick:function(){null==U||U.dot({name:"click_to_other_login",categories:{is_first_trust:""+S}}),re(V.PAGE_LOGIN_SCAN_CODE)}},"\u767b\u5f55"),o=e.split(t),i.createElement(i.Fragment,null,o[0],n,o[1])))));var e,t,n,o};return i.createElement("article",{className:"web-login-push"},n?i.createElement(he,{type:"normal"},se()):se())},Ze=function(){var e=(0,i.useContext)(J).config,t=e.CustomFooter,n=e.allTextConfig,o=e.useWrap,r=n.scanCodeLoginText.title,a=(0,i.useContext)(K),s=a.viewState,c=a.dispatchViewState,u=a.viewOperations;return i.createElement("article",{className:"web-login-union"},i.createElement("div",{className:"web-login-union__login"},i.createElement("div",{className:"web-login-union__login__form"},i.createElement("div",{className:"web-login-union__login__form__content"},s.currentPage===V.PAGE_LOGIN_MOBILE_CODE?i.createElement(Ge,{useWrap:null==o?void 0:o.mobileCode}):i.createElement(Ve,{useWrap:null==o?void 0:o.accountPwd}))),i.createElement("div",{className:"web-login-union__login__scan-code"},i.createElement("div",{className:"web-login-union__login__scan-code__title"},r),i.createElement($e,{useWrap:null==o?void 0:o.scanCode}))),i.createElement("div",{className:"web-login-union__footer"},i.createElement(de,null),i.createElement(ue,null)),t&&i.createElement(t,{changePageType:function(e){c({type:"CHANGE_PAGE",currentPage:e})},currentPage:s.currentPage,checked:s.protocolCheck,onCheckClick:u.onCheckClick}))},et=function(e){var t=(0,i.useState)(!0),n=t[0],o=t[1],r=(0,i.useState)(!0),a=r[0],s=r[1],c=(0,i.useRef)(!1),u=(0,i.useContext)(J).config,l=u.aid,d=u.mobileCodeLength,f=void 0===d?6:d,h=u.phoneSeparate,p=void 0!==h&&h,_=u.globalMobileSupport,m=void 0!==_&&_,v=u.unsetCheckbox,g=u.confirm,E=u.allTextConfig,b=u.requestFunc,y=u.onBlurCallback,w=(0,i.useContext)(K),S=w.viewState,C=w.dispatchViewState,k=w.viewOperations,T=(0,i.useContext)(Y),O=T.formValue,x=T.dispatchFormValue,I=T.formComputedValue,A=Ce(u),L=A.withErrorEffect,D=A.loginSuccessHandler,P=E.mobileCodeRegisterText,M=function(){return null==y||y("REGISTER_MOBILE_CODE","phone"),L(Ae(O.areaCode,I.realMobile,E))};return(0,i.useEffect)((function(){var e=Ae(O.areaCode,I.realMobile,E).result,t=De(O.code,f,E).result;e&&t&&(S.protocolCheck||1===(null==v?void 0:v.registerMobileCode)||0===(null==g?void 0:g.length))?o(!1):o(!0)}),[O.areaCode,I.realMobile,O.code,S.protocolCheck]),(0,i.useEffect)((function(){R("uc_login_notify",{aid:l,login_suggest_method:"register_mobile",url:window.location.href})}),[]),i.createElement("article",{className:"web-login-mobile-code-register"},i.createElement(he,null,i.createElement("div",{className:"web-login-mobile-code-register__mobile-input-wrapper"},i.createElement(ae,{type:"tel",onBlur:M,onChange:function(e){var t=e.replace(/[\D]+/g,"");if("+86"===O.areaCode){if(t.length>11)return;p&&(t=t.replace(Ie,"$1 $2 $3").trim())}x({mobile:t})},value:O.mobile,showAreaCode:m,onAreaCodeBlur:function(){return L(Le(O.areaCode,I.realMobile,E))},onAreaCodeChange:function(e){x({areaCode:e})},areaCodeValue:O.areaCode,placeholder:P.mobilePlaceholder,autoComplete:"off",inputLabel:P.mobileLabel})),i.createElement("div",{className:"web-login-mobile-code-register__code-input-wrapper"},i.createElement(se,{type:"tel",buttonType:"send",onClick:function(){M()&&!S.counting&&b.registerSendCode({mobile:I.fullMobile}).then((function(e){R("uc_send_sms",{login_method:"register_mobile",send_method:a?"user_click":"resend",status:"success",aid:l}),s(!1),C({type:"ERROR",errorMessage:""});var t=null==e?void 0:e.retry_time;C({type:"COUNT",seconds:t})})).catch((function(e){q(e),R("uc_send_sms",{login_method:"register_mobile",send_method:a?"user_click":"resend",status:"fail",error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||"",aid:l}),s(!1),C({type:"ERROR",errorMessage:e})}))},onChange:function(e){var t=e.replace(/[\D]+/g,"");t.length>f||x({code:t})},onBlur:function(){return!!M()&&(null==y||y("REGISTER_MOBILE_CODE","code"),L(De(O.code,f,E)))},value:O.code,placeholder:P.codePlaceholder,buttonText:P.sendCode,sendingText:P.sending,inputLabel:P.codeLabel})),i.createElement(oe,null),i.createElement(ie,{needCheck:1!==(null==v?void 0:v.registerMobileCode),onCheckClick:k.onCheckClick,beforeText:P.confirmInfoBeforeText,connectText:P.confirmInfoConnectText}),i.createElement("div",{className:"web-login-mobile-code-register__button-wrapper"},i.createElement(te,{disabled:n,buttonText:P.buttonText,onClick:function(){c.current||n||(c.current=!0,R("uc_login_submit",{login_method:"register_mobile",aid:l}),b.mobileCodeRegister({mobile:I.fullMobile,code:O.code}).then((function(e){c.current=!1,R("uc_login_result",{status:"success",login_method:"register_mobile",is_new_user:(null==e?void 0:e.is_new_user)!==undefined?null==e?void 0:e.is_new_user:(null==e?void 0:e.new_user)!==undefined?null==e?void 0:e.new_user:-1,aid:l},!0),D(e)})).catch((function(e){q(e),c.current=!1,R("uc_login_result",{status:"fail",login_method:"register_mobile",aid:l,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""}),C({type:"ERROR",errorMessage:e})})))}}))))},tt=function(e){var t=(0,i.useState)(!0),n=t[0],o=t[1],r=(0,i.useState)(!0),a=r[0],s=r[1],c=(0,i.useRef)(!1),u=(0,i.useContext)(J).config,l=u.aid,d=u.passwordMaxLength,f=void 0===d?20:d,h=u.unsetCheckbox,p=u.confirm,_=u.requestExtraParams,m=u.passwordFormat,v=u.allTextConfig,g=u.requestFunc,E=u.onBlurCallback,b=v.emailRegisterText,y=(0,i.useContext)(K),w=y.viewState,S=y.dispatchViewState,C=y.viewOperations,k=(0,i.useContext)(Y),T=k.formValue,O=k.dispatchFormValue,x=Ce(u),I=x.withErrorEffect,A=x.loginSuccessHandler,L=function(){return null==E||E("REGISTER_EMAIL","email"),I(Pe(T.email,v))},D=function(){return!!L()&&(null==E||E("REGISTER_EMAIL","new_pwd"),I(Re(T.newPassword,m,v)))},P=function(){return!!D()&&(null==E||E("REGISTER_EMAIL","confirm_pwd"),I(Me(T.newPassword,T.confirmPassword,v)))};return(0,i.useEffect)((function(){Pe(T.email,v).result&&Re(T.newPassword,m,v).result&&Me(T.newPassword,T.confirmPassword,v).result&&T.code&&(w.protocolCheck||1===(null==h?void 0:h.registerEmail)||0===(null==p?void 0:p.length))?s(!1):s(!0)}),[T.email,T.newPassword,T.confirmPassword,T.code,w.protocolCheck]),(0,i.useEffect)((function(){R("uc_login_notify",{aid:l,login_suggest_method:"register_email",url:window.location.href})}),[]),i.createElement("article",{className:"web-login-email-register"},i.createElement(he,null,i.createElement("div",{className:"web-login-email-register__email-input-wrapper"},i.createElement(ae,{type:"email",onBlur:L,onChange:function(e){O({email:e})},value:T.email,showAreaCode:!1,placeholder:b.accountPlaceholder,autoComplete:"off",inputLabel:b.accountLabel})),i.createElement("div",{className:"web-login-email-register__new-password-input-wrapper"},i.createElement(ae,{type:"password",onBlur:D,onChange:function(e){e=e.replace(/[\u4e00-\u9fa5]/g,""),O({newPassword:e})},value:T.newPassword,showAreaCode:!1,placeholder:b.newPwdPlaceholder,autoComplete:"off",maxLength:f,inputLabel:b.newPwdLabel})),i.createElement("div",{className:"web-login-email-register__confirm-password-input-wrapper"},i.createElement(ae,{type:"password",onBlur:P,onChange:function(e){e=e.replace(/[\u4e00-\u9fa5]/g,""),O({confirmPassword:e})},value:T.confirmPassword,showAreaCode:!1,placeholder:b.confirmPwdPlaceholder,autoComplete:"off",maxLength:f,inputLabel:b.confirmPwdLabel})),i.createElement("div",{className:"web-login-email-register__code-input-wrapper"},i.createElement(se,{type:"text",buttonType:"send",onClick:function(){P()&&!w.counting&&g.emailRegisterSendCode({email:T.email,password:T.newPassword,extra_params:null==_?void 0:_.registerEmail}).then((function(e){R("uc_send_sms",{login_method:"register_email",send_method:n?"user_click":"resend",status:"success",aid:l}),o(!1),S({type:"ERROR",errorMessage:""});var t=null==e?void 0:e.retry_time;S({type:"COUNT",seconds:t})})).catch((function(e){q(e),R("uc_send_sms",{login_method:"register_email",send_method:n?"user_click":"resend",status:"fail",error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||"",aid:l}),o(!1),S({type:"ERROR",errorMessage:e})}))},onChange:function(e){O({code:e})},onBlur:function(){return!!P()&&(null==E||E("REGISTER_EMAIL","code"),I(Pe(T.email,v)))},value:T.code,placeholder:b.codePlaceholder,buttonText:b.sendCode,sendingText:b.sending,inputLabel:b.codeLabel})),i.createElement(oe,null),i.createElement(ie,{needCheck:1!==(null==h?void 0:h.registerEmail),onCheckClick:C.onCheckClick,beforeText:b.confirmInfoBeforeText,connectText:b.confirmInfoConnectText}),i.createElement("div",{className:"web-login-email-register__button-wrapper"},i.createElement(te,{disabled:a,buttonText:b.buttonText,onClick:function(){a||c.current||(c.current=!0,g.emailRegister({email:T.email,code:T.code,password:T.newPassword,extra_params:null==_?void 0:_.registerEmail}).then((function(e){c.current=!1,R("uc_login_result",{status:"success",login_method:"register_email",is_new_user:1,aid:l},!0),A(e)})).catch((function(e){q(e),c.current=!1,R("uc_login_result",{status:"fail",login_method:"register_email",aid:l,error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||""}),S({type:"ERROR",errorMessage:e})})))}}))))},nt=P.iPhone,it=function(e){var t=(0,i.useContext)(J).config,n=t.aid,o=t.mobileCodeLength,r=void 0===o?6:o,a=t.phoneSeparate,s=void 0!==a&&a,c=t.passwordMaxLength,u=void 0===c?20:c,l=t.isMobileAccountOnly,d=void 0!==l&&l,f=t.isEmailAccountOnly,h=void 0!==f&&f,p=t.initialAreaCodeState,_=t.passwordFormat,m=t.allTextConfig,v=t.requestFunc,g=t.unsetCheckbox,E=t.confirm,b=t.onBlurCallback,y=m.passwordResetText,w=(0,i.useContext)(K),S=w.viewState,k=w.dispatchViewState,T=w.viewOperations,O=(0,i.useContext)(Y),x=O.formValue,I=O.dispatchFormValue,A=O.formComputedValue,L=(0,i.useState)(p),D=L[0],P=L[1],M=(0,i.useState)(!0),N=M[0],G=M[1],B=(0,i.useState)(!0),U=B[0],j=B[1],z=(0,i.useState)(!1),H=z[0],W=z[1],F=(0,i.useRef)(!1),$=Ce(t).withErrorEffect,Q=function(){return null==b||b("PASSWORD_RESET","account"),$(Ne(A.realAccount,x.areaCode,A.isAccountEmail,d,h,m))},X=function(){return!!Q()&&(null==b||b("PASSWORD_RESET","new_pwd"),$(Re(x.newPassword,_,m)))},Z=function(){return!!X()&&(null==b||b("PASSWORD_RESET","confirm_pwd"),$(Me(x.newPassword,x.confirmPassword,m)))};return(0,i.useEffect)((function(){R("uc_forget_password_notify",{aid:n,url:window.location.href})}),[]),(0,i.useEffect)((function(){Ne(A.realAccount,x.areaCode,A.isAccountEmail,d,h,m).result&&Re(x.newPassword,_,m).result&&Me(x.newPassword,x.confirmPassword,m).result&&(A.isAccountEmail||De(x.code,r,m).result)&&(S.protocolCheck||1===(null==g?void 0:g.resetPwd)||0===(null==E?void 0:E.length))?G(!1):G(!0)}),[A.realAccount,x.areaCode,x.newPassword,x.confirmPassword,x.code,A.isAccountEmail,S.protocolCheck]),i.createElement("article",{className:"web-login-password-reset"},i.createElement(he,null,i.createElement("div",{className:"web-login-password-reset__account-input-wrapper"},i.createElement(ae,{type:"text",onBlur:Q,onChange:function(e){if(nt)return/^\d*$/.test(e)?P(p):P(!1),void I({account:e});if(d){var t=e.replace(/[\D]+/g,"");I({account:t})}else if(/^[\d\s]*$/.test(e)){var n=e.replace(/[\D]+/g,"");if("+86"===x.areaCode){if(n.length>11)return;s&&(n=n.replace(Ie,"$1 $2 $3").trim())}P(p),I({account:n})}else{var i=e.replace(/\s/g,"");P(!1),I({account:i})}},value:x.account,showAreaCode:D,onAreaCodeBlur:function(){return $(Le(x.areaCode,A.realAccount,m))},onAreaCodeChange:function(e){I({areaCode:e})},areaCodeValue:x.areaCode,placeholder:y.accountPlaceholder,autoComplete:"username",inputLabel:y.accountLabel})),i.createElement("div",{className:"web-login-password-reset__new-password-input-wrapper"},i.createElement(ae,{type:"password",onBlur:X,onChange:function(e){e=e.replace(/[\u4e00-\u9fa5]/g,""),I({newPassword:e})},value:x.newPassword,showAreaCode:!1,maxLength:u,placeholder:y.newPwdPlaceholder,autoComplete:"off",inputLabel:y.newPwdLabel})),i.createElement("div",{className:"web-login-password-reset__confirm-password-input-wrapper"},i.createElement(ae,{type:"password",onBlur:Z,onChange:function(e){e=e.replace(/[\u4e00-\u9fa5]/g,""),I({confirmPassword:e})},value:x.confirmPassword,showAreaCode:!1,maxLength:u,placeholder:y.confirmPwdPlaceholder,autoComplete:"off",inputLabel:y.confirmPwdLabel})),i.createElement("div",{className:"web-login-password-reset__code-input-wrapper"},i.createElement(se,{type:"text",buttonType:"send",onClick:function(){Z()&&!S.counting&&v.resetSendCode({isEmail:A.isAccountEmail,requestParams:{account:A.fullAccount}}).then((function(e){var i,o;R("uc_send_sms",C({login_method:"pwd_reset",send_method:U?"user_click":"resend",status:"success",aid:n},null==t||null==(i=t.teaConfig)||null==(o=i.config)?void 0:o.evtParams)),j(!1),k({type:"ERROR",errorMessage:""});var r=null==e?void 0:e.retry_time;k({type:"COUNT",seconds:r})})).catch((function(e){var i,o;q(e),R("uc_send_sms",C({login_method:"pwd_reset",send_method:U?"user_click":"resend",status:"fail",error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||"",aid:n},null==t||null==(i=t.teaConfig)||null==(o=i.config)?void 0:o.evtParams)),j(!1),k({type:"ERROR",errorMessage:e})}))},onChange:function(e){if(A.isAccountEmail)I({code:e});else{var t=e.replace(/[\D]+/g,"");t.length>r||I({code:t})}},onBlur:function(){return!!Z()&&(null==b||b("PASSWORD_RESET","code"),!!A.isAccountEmail||$(De(x.code,r,m)))},value:x.code,placeholder:y.codePlaceholder,buttonText:y.sendCode,sendingText:y.sending,inputLabel:y.codeLabel})),i.createElement(oe,null),i.createElement(ie,{needCheck:1!==(null==g?void 0:g.resetPwd),onCheckClick:T.onCheckClick,beforeText:y.confirmInfoBeforeText,connectText:y.confirmInfoConnectText}),i.createElement("div",{className:"web-login-password-reset__button-wrapper"},i.createElement(te,{disabled:N,buttonText:y.buttonText,onClick:function(){N||F.current||(F.current=!0,R("uc_forget_password_submit",{aid:n}),v.resetPassword({isEmail:A.isAccountEmail,requestParams:{account:A.fullAccount,password:x.newPassword,code:x.code}}).then((function(e){F.current=!1,R("uc_forget_password_result",{status:"success",aid:n}),W(!0),setTimeout((function(){k({type:"CHANGE_PAGE",currentPage:V.PAGE_LOGIN_ACCOUNT_PWD})}),1e3)})).catch((function(e){q(e),F.current=!1,R("uc_forget_password_result",{status:"fail",error_code:(null==e?void 0:e.error_code)||-1,fail_info:(null==e?void 0:e.description)||"",aid:n}),k({type:"ERROR",errorMessage:e})})))}}))),H&&i.createElement("div",{className:"web-login-password-reset__toast"},i.createElement("i",{className:"web-login-password-reset__toast__icon"}),i.createElement("p",{className:"web-login-password-reset__toast__text"},y.successText)))},ot=function(e){var t=e.config,n=t.currentUserInfo,o=void 0===n?null:n,r=t.isAllowTrust,a=void 0!==r&&r,s=t.indexPage,c=t.loginType,u=t.unionLoginPanel,l=void 0!==u&&u,d=t.onPageChange,f=t.useWrap,h=t.feedbackShowTime,p=void 0===h?"never":h,_=(0,i.useReducer)($,{showLoading:!0,currentPage:"",prevPage:"",counting:!1,seconds:60,errorMessage:"",protocolCheck:!1,config:t}),m=_[0],v=_[1],g=(0,i.useReducer)(Q,{areaCode:"+86",mobile:"",email:"",code:"",account:"",password:"",newPassword:"",confirmPassword:""}),E=g[0],b=g[1],y=(0,i.useReducer)(X,t)[1],w=(0,i.useReducer)(ee,{pushTicket:""}),S=w[0],C=w[1],k=(0,i.useMemo)((function(){return[V.PAGE_LOGIN_ACCOUNT_PWD,V.PAGE_LOGIN_MOBILE_CODE,V.PAGE_LOGIN_SCAN_CODE].includes(m.currentPage)?"login":[V.PAGE_REGISTER_MOBILE_CODE,V.PAGE_REGISTER_EMAIL].includes(m.currentPage)?"register":""}),[m.currentPage]),T=(0,i.useMemo)((function(){return E.mobile.replace(/\s/g,"")}),[E.mobile]),O=(0,i.useMemo)((function(){return E.account.replace(/\s/g,"")}),[E.account]),x=(0,i.useMemo)((function(){return E.areaCode+" "+T}),[E.areaCode,T]),I=(0,i.useMemo)((function(){return!/^\d*$/.test(O)}),[O]),A=(0,i.useMemo)((function(){return I?O:E.areaCode+" "+O}),[I,O,E.areaCode]);return(0,i.useEffect)((function(){m.counting?(ke&&clearInterval(ke),ke=setInterval((function(){v({type:"COUNT"})}),1e3)):ke&&clearInterval(ke)}),[m.counting]),(0,i.useEffect)((function(){"always"===p?setTimeout((function(){C({isShowFeedBack:!0})}),3e3):"whileErr"===p&&setTimeout((function(){C({isShowFeedBack:!0})}),3e4)}),[p]),(0,i.useEffect)((function(){null==d||d(m.currentPage),v({type:"STOP_COUNT"}),v({type:"ERROR",errorMessage:""}),b({type:"RESET"})}),[m.currentPage]),(0,i.useEffect)((function(){return function(){ke&&clearInterval(ke)}}),[]),(0,i.useEffect)((function(){o&&0!==Object.keys(o).length&&a?v({type:"CHANGE_PAGE",currentPage:V.PAGE_LOGIN_TRUST}):v({type:"CHANGE_PAGE",currentPage:s||(null==c?void 0:c[0])||V.PAGE_LOGIN_MOBILE_CODE}),v({type:"LOADING",showLoading:!1})}),[]),i.createElement(K.Provider,{value:{viewState:m,dispatchViewState:v,viewComputedValue:{currentState:k},viewOperations:{onCheckClick:function(e){v({type:"PROTOCOL",protocolCheck:e})}}}},i.createElement(Y.Provider,{value:{formValue:E,dispatchFormValue:b,formComputedValue:{realMobile:T,realAccount:O,fullMobile:x,fullAccount:A,isAccountEmail:I}}},i.createElement(J.Provider,{value:{config:t,dispatchConfigValue:y}},i.createElement(Z.Provider,{value:{dataValue:S,dispatchDataValue:C}},i.createElement("div",{className:"web-login-container",id:"web-login-container"},m.showLoading&&i.createElement(le,null),i.createElement("article",{className:"web-login"},function(){switch(m.currentPage){case V.PAGE_LOGIN_MOBILE_CODE:return l?i.createElement(Ze,null):i.createElement(Ge,{useWrap:null==f?void 0:f.mobileCode});case V.PAGE_LOGIN_ACCOUNT_PWD:return l?i.createElement(Ze,null):i.createElement(Ve,{useWrap:null==f?void 0:f.accountPwd});case V.PAGE_LOGIN_SCAN_CODE:return l?i.createElement(Ze,null):i.createElement($e,{useWrap:null==f?void 0:f.scanCode});case V.PAGE_REGISTER_MOBILE_CODE:return i.createElement(et,null);case V.PAGE_REGISTER_EMAIL:return i.createElement(tt,null);case V.PAGE_LOGIN_TRUST:return i.createElement(Qe,null);case V.PAGE_PASSWORD_RESET:return i.createElement(it,null);case V.PAGE_LOGIN_PUSH:return i.createElement(Xe,null);default:return null}}()))))))},rt=function(e){var t=e.aid,n=e.subjectAid,i=e.mobileCodeLength,o=void 0===i?6:i,r=e.scope,a=void 0===r?"web":r,s=e.scene,c=void 0===s?"normal":s,u=e.host,l=void 0===u?"":u,d=e.isOversea,f=void 0!==d&&d,h=e.region,p=void 0===h?"cn":h,_=e.appName,m=void 0===_?"":_,g=e.language,E=void 0===g?"zh":g,b=e.isBoe,y=void 0!==b&&b,w=e.acrawler,S=void 0===w?"1":w,k=e.captchaShowMode,T=void 0===k?"mask":k,O=e.captchaHost,x=void 0===O?"":O,I=e.secondVerifyWebOptions,A=e.generalParams,L=void 0===A?{}:A,D={aid:t,subjectAid:n,scene:c,host:l,isOversea:f,region:p,appName:m,language:E,isBoe:y,acrawler:S,captchaShowMode:T,captchaHost:x,printLog:!1,secondVerifyWebOptions:C({useSmsMode:o||6},I),generalParams:L,enabledMonitor:!1};return"sso"===a?{type:"sso",request:new v.SsoInterfaceSdk(D)}:{type:"web",request:new v.WebInterfaceSdk(D)}},at=function(e){return new st({accountAPI:rt(e),params:e})},st=function(e){var t=this;this.loginOnly={mobileCode:!1,thirdParty:!1},this.commonRequest=function(e){return t.accountAPI.request.request(e)},this.loginSendCode=function(e){var n=e.mobile,i=void 0===n?"":n,o=e.extra_params,r=void 0===o?{}:o,a={mobile:i,extra_params:C({is6Digits:t.is6Digits},r)};return"sso"===t.accountAPI.type?t.accountAPI.request.login.sendMobileCodeV2(a):"aff"===t.scene?t.accountAPI.request.affLogin.sendCode(a):t.accountAPI.request.login.sendCode(a)},this.registerSendCode=function(e){var n=C({},e,{extra_params:{is6Digits:t.is6Digits}});return"sso"===t.accountAPI.type?t.accountAPI.request.login.sendMobileCodeV2(n):"aff"===t.scene?t.accountAPI.request.affRegister.sendMobileCode(n):t.accountAPI.request.login.sendCode(n)},this.mobileCodeLogin=function(e){return"sso"===t.accountAPI.type?t.loginOnly.mobileCode?t.accountAPI.request.login.quickAuthLoginOnly(C({},e,{service:t.next})):t.accountAPI.request.login.quickAuthV2(C({},e,{service:t.next})):"aff"===t.scene?t.accountAPI.request.affLogin.smsLogin(e):t.accountAPI.request.login.smsLogin(C({},e,{login_only:t.loginOnly.mobileCode}))},this.mobileCodeRegister=function(e){return"sso"===t.accountAPI.type?t.accountAPI.request.login.quickAuthV2(C({},e,{service:t.next})):"aff"===t.scene?t.accountAPI.request.affRegister.verifyMobile(e):t.accountAPI.request.login.smsLogin(e)},this.emailRegister=function(e){return"sso"===t.accountAPI.type?t.accountAPI.request.register.emailRegister(C({},e,{email_logic_type:2})):t.accountAPI.request.login.emailRegister(C({},e,{ifLogin:!0}))},this.emailRegisterSendCode=function(e){return"sso"===t.accountAPI.type?t.accountAPI.request.register.sendEmailCodeV2({email:e.email,next:t.next,email_logic_type:2}):t.accountAPI.request.login.sendEmailCode(C({},e,{next:t.next}))},this.accountPwdLogin=function(e){return"sso"===t.accountAPI.type?t.accountAPI.request.login.accountLoginV2(C({},e,{service:t.next})):"aff"===t.scene?t.accountAPI.request.affLogin.pwdLogin(e):t.accountAPI.request.login.pwdLogin(e)},this.subjectLogin=function(e){var n=e.login_subject_uid,i=e.user_identity_list.user_identity_id_str,o=void 0===i?"0":i;return t.accountAPI.request.affLogin.subjectLogin({login_subject_uid:n,user_identity_id:o})},this.resetSendCode=function(e){var n=e.isEmail,i=e.requestParams;if(n){var o={email:i.account};return"sso"===t.accountAPI.type?t.accountAPI.request.password.sendEmailCodeV2(o):"aff"===t.scene?t.accountAPI.request.affForgetPwd.sendEmailCode(o):t.accountAPI.request.forgetPwd.sendEmailCode(o)}var r={mobile:i.account,extra_params:{is6Digits:t.is6Digits}};return"sso"===t.accountAPI.type?t.accountAPI.request.password.sendMobileCodeV2(C({},r,{check_register:!0})):"aff"===t.scene?t.accountAPI.request.affForgetPwd.sendMobileCode(r):t.accountAPI.request.forgetPwd.sendCode(r)},this.resetPassword=function(e){var n=e.isEmail,i=e.requestParams;if("sso"===t.accountAPI.type)return t.accountAPI.request.password.resetPassword(i);if(n){var o={email:i.account,password:i.password,code:i.code};return"aff"===t.scene?t.accountAPI.request.affForgetPwd.emailReset(o):t.accountAPI.request.forgetPwd.resetPwdByEmail(o)}var r={mobile:i.account,password:i.password,code:i.code};return"aff"===t.scene?t.accountAPI.request.affForgetPwd.mobileReset(r):t.accountAPI.request.forgetPwd.resetPwdByMobile(r)},this.getQrCode=function(e){return void 0===e&&(e={}),"sso"===t.accountAPI.type?t.accountAPI.request.qrcodeLogin.getQrcode({service:t.next,extra_params:e}):t.accountAPI.request.qrcodeLogin.getQrcode({next:t.next})},this.checkQRCode=function(e){var n=e.token,i=e.need_logo,o=void 0!==i&&i,r=e.is_frontier,a=void 0!==r&&r,s=e.need_short_url,c=void 0!==s&&s;return"sso"===t.accountAPI.type?t.accountAPI.request.qrcodeLogin.checkQrconnect({service:t.next,token:n,extra_params:{need_logo:o,is_frontier:a,need_short_url:c}}):t.accountAPI.request.qrcodeLogin.checkQrconnect({next:t.next,token:n})},this.wapLogin=function(e){var n=e.platform,i=e.platformAppId,o=c()(t.next,!0).origin;return"sso"===t.accountAPI.type?(t.accountAPI.request.login.wapLogin({origin:o,next:t.next,platform_app_id:"number"==typeof i&&"weixin"===n?String(i):"",platform:"qzone_sns"===n?"qzone_sns":""}),Promise.resolve()):Promise.reject("NOT SUPPORT")},this.checkAwemeLogin=function(e){return"sso"===t.accountAPI.type?t.accountAPI.request.login.bindWithMobileLogin({code:e.code,service:t.next,platform_app_id:e.platformAppId,change_bind:e.changeBind||0,profile_key:e.profileKey}):t.accountAPI.request.login.bindWithMobileLogin({code:e.code,platform:"aweme",platform_app_id:e.platformAppId,change_bind:e.changeBind||0,need_mobile:e.needMobile||0})},this.authLogin=function(e){return"sso"===t.accountAPI.type?t.accountAPI.request.login.authLogin({code:e.code,service:t.next,platform_app_id:e.platformAppId,profile_key:e.profileKey,login_only:t.loginOnly.thirdParty}):t.accountAPI.request.login.authLogin({code:e.code,platform_app_id:e.platformAppId,profile_key:e.profileKey,login_only:t.loginOnly.thirdParty})};var n=e.accountAPI,i=e.params,o=i.scene,r=void 0===o?"normal":o,a=i.next,s=i.loginOnly,u=void 0===s?{}:s,l=i.mobileCodeLength,d=void 0===l?6:l;this.scene=r,this.next=a,this.loginOnly=C({mobileCode:!1,thirdParty:!1},u),this.accountAPI=n,this.mobileCodeLength=d,this.is6Digits=6===d?1:0};var ct={loginType:["LOGIN_MOBILE_CODE"],registerType:[],globalMobileSupport:!1,mobileCodeLength:6,confirm:[],otherMethod:[],accountType:[],loginTab:[],registerTab:[],passwordMaxLength:20,phoneSeparate:!1,linkAreaPosition:"bottom"},ut=function(e){var t,n,i,o,r,a,s,c,u,l,d=C({},ct,e),f=(a=(o=e).textConfig,s=void 0===a?{}:a,c=o.districtList,u=void 0===c?null:c,l=b()(H,s||{},{arrayMerge:function(e,t){return t}}),(r={})[V.PAGE_LOGIN_MOBILE_CODE]=l.mobileCodeLoginText.title,r[V.PAGE_LOGIN_ACCOUNT_PWD]=l.accountPwdLoginText.title,r[V.PAGE_LOGIN_SCAN_CODE]=l.scanCodeLoginText.title,r[V.PAGE_REGISTER_MOBILE_CODE]=l.mobileCodeRegisterText.title,r[V.PAGE_REGISTER_EMAIL]=l.emailRegisterText.title,r[V.PAGE_PASSWORD_RESET]=l.passwordResetText.title,C({},l,{districtList:u||W,titleMap:r})),h=at(e);return C({},d,{isMobileAccountOnly:Boolean((null==(t=d.accountType)?void 0:t.includes("mobile"))&&1===d.accountType.length),isEmailAccountOnly:Boolean((null==(n=d.accountType)?void 0:n.includes("email"))&&1===d.accountType.length),initialAreaCodeState:Boolean(d.globalMobileSupport)&&Boolean(null==(i=d.accountType)?void 0:i.includes("mobile")),allTextConfig:f,loginScanCodeConfig:{timer:null,qrCodeToken:"",autoFreshTimes:0},requestFunc:h})};t.default=function(e){var t=this;this.checkAwemeLogin=function(){var e=c()(window.location.href,!0).query||{};e.from_aweme&&e.code&&!B(e.code)&&t.init()},this.checkLogin=function(){return t.accountSDK.request.login.checkLogin({service:t.initProps.next})},this.logout=function(){var e=t.initProps,n=e.scene,i=void 0===n?"normal":n,o=e.next;return"sso"===t.accountSDK.type?t.accountSDK.request.login.logout({service:o}):"aff"===i?t.accountSDK.request.affLogin.logout({next:o,not_redirect:!1}):t.accountSDK.request.login.logout({next:o})},this.setTeaConfig=function(e){void 0===e&&(e={}),function(e){var t;void 0===e&&(e={});var n=null==(t=x.getTea())?void 0:t.setConfig;n&&n(e)}(e)},this.LoginContainer=function(){var e=t.initProps.LoginComponent;if(e){var n=at(t.initProps);return i.createElement(pe,null,i.createElement(e,{requestFuncs:n}))}return i.createElement(pe,null,i.createElement(ot,{config:ut(t.initProps)}))},this.init=function(e){var n=t.initProps,r=n.ele,a=n.LoginComponent,s=e||r;if(!s)throw new Error("[web-login-sdk]: Must provide options.ele");if(a){var c=at(t.initProps);o.render(i.createElement(pe,null,i.createElement(a,{requestFuncs:c})),s)}else o.render(i.createElement(pe,null,i.createElement(ot,{config:ut(t.initProps)})),s);return function(){o.unmountComponentAtNode(s)}},this.initProps=e,this.accountSDK=rt(e),x.initTea(e.teaConfig||{appId:e.aid}),I.clearSlardar(),I.initSlardar(e.aid,{device_id:null==e?void 0:e.device_id,slardarConfig:null==e?void 0:e.slardarConfig,context:C({},null==e?void 0:e.slardarContext,{is_frontier:""+Number(e.isFrontier)})}),this.checkAwemeLogin()}},64999:function(e,t,n){var i,o,r,a,s=n(74892).default,c=n(76537).default,u=n(11144).default,l=n(5594),d=n(1268).default,f=n(79795).default,h=n(17689).default,p=n(17800).default,_=n(40316).default,m=n(73638).default,v=n(6800),g=n(68493),E=n(26447),b=n(56442),y=n(29809),w=n(34346),S=n(92524),C=n(94090),k=n(21155),T=n(8369),O=n(31674),x=n(76569),I=n(58144),A=n(11227),L=n(90457),D=n(9942),P=n(82766),R=n(67624),M=n(54343),N=n(8e3),G=n(7943),B=n(70200),q=n(85792),U=n(19672),V=n(84639),j=n(52249),z=n(50750),H=n(42404),W=n(56038).default;a=function(e){"use strict";function t(e,t,n,i){return new(n||(n=g))((function(o,r){function a(e){try{c(i.next(e))}catch(t){r(t)}}function s(e){try{c(i.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))}var n="";function i(){var e,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",i="".concat(E()),o=n||(n=function(e){var t=/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/.test(e),n=/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/.test(e);return t?function(e){var t,n=w(t=e.split(/\./)).call(t,(function(e){return t=e,b(n=Array(8).join("0")+y(t,10).toString(2)).call(n,-8);var t,n})),i=[];i[0]=r(n[0]+n[1]),i[1]=r(n[2]+n[3]);var o=["0000","0000","0000","0000","0000","ffff",i[0],i[1]];return o.join("")}(e):n?function(e){var t="",n=[],i=0,o=0,r=!0,a="0000";if(S(e).call(e,"::")>-1){for(var s=e.split("::"),c=0;c<s.length;c++){var u=s[c];if(S(u).call(u,":")>0){var l=u.split(":");r&&(i=l.length),o+=l.length;for(var d=0;d<l.length;d++)if(4!==l[d].length){var f=a.substring(0,4-l[d].length),h=C(f).call(f,l[d]);n.push(h)}else n.push(l[d]);r=!1}else{if(4!==u.length){var p=a.substring(0,4-u.length),_=C(p).call(p,u);n.push(_)}else n.push(u);r&&(i+=1),o+=1,r=!1}}for(var m="",v=0;v<8-o;v++)m=C(m).call(m,a);for(var g=0;g<n.length;g++)g===i?(t=C(t).call(t,m),t=C(t).call(t,n[g])):t=C(t).call(t,n[g]);return t}for(var E=e.split(":"),b=0;b<E.length;b++){var y=E[b];if(4!==E[b].length){var w=a.substring(0,4-E[b].length),k=C(w).call(w,y);t=C(t).call(t,k)}else t=C(t).call(t,y)}return t}(e):"00000000000000000000000000000000"}(t));return"02"+i+o+b(e=Math.random().toString(16)).call(e,-6)}function o(){return 1e4*E()+Math.floor(1e4*Math.random())}function r(e){var t;return b(t=Array(4).join("0")+y(e,2).toString(16)).call(t,-4)}function a(e,t){var n=e.key;n!==undefined&&(fe(t,10),se(t,n));var i=e.value;i!==undefined&&(fe(t,18),se(t,i))}function F(e){var t={};e:for(;!ne(e);){var n=de(e);switch(n>>>3){case 0:break e;case 1:t.key=ae(e,de(e));break;case 2:t.value=ae(e,de(e));break;default:Q(e,7&n)}}if(t.key===undefined)throw new Error("Missing required field: key");if(t.value===undefined)throw new Error("Missing required field: value");return t}function K(e){var t=Z();return function(e,t){var n=e.SeqID;n!==undefined&&(fe(t,8),pe(t,n));var i=e.LogID;i!==undefined&&(fe(t,16),pe(t,i));var o=e.service;o!==undefined&&(fe(t,24),pe(t,J(o)));var r=e.method;r!==undefined&&(fe(t,32),pe(t,J(r)));var s=e.headers;if(s!==undefined){var c,u=m(s);try{for(u.s();!(c=u.n()).done;){var l=c.value;fe(t,42);var d=Z();a(l,d),fe(t,d.limit),ce(t,d),ee(d)}}catch(v){u.e(v)}finally{u.f()}}var f=e.payloadEncoding;f!==undefined&&(fe(t,50),se(t,f));var h=e.payloadType;h!==undefined&&(fe(t,58),se(t,h));var p=e.payload;p!==undefined&&(fe(t,66),fe(t,p.length),function(e,t){var n=ie(e,t.length);e.bytes.set(t,n)}(t,p));var _=e.LogIDNew;_!==undefined&&(fe(t,74),se(t,_))}(e,t),function(e){var t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}function $(e){return function(e){var t={};e:for(;!ne(e);){var n=de(e);switch(n>>>3){case 0:break e;case 1:t.SeqID=he(e,!0);break;case 2:t.LogID=he(e,!0);break;case 3:t.service=de(e);break;case 4:t.method=de(e);break;case 5:var i=Y(e);(t.headers||(t.headers=[])).push(F(e)),e.limit=i;break;case 6:t.payloadEncoding=ae(e,de(e));break;case 7:t.payloadType=ae(e,de(e));break;case 8:t.payload=re(e,de(e));break;case 9:t.LogIDNew=ae(e,de(e));break;default:Q(e,7&n)}}if(t.SeqID===undefined)throw new Error("Missing required field: SeqID");if(t.LogID===undefined)throw new Error("Missing required field: LogID");if(t.service===undefined)throw new Error("Missing required field: service");if(t.method===undefined)throw new Error("Missing required field: method");return t}({bytes:t=e,offset:0,limit:t.length});var t}function Y(e){var t=de(e),n=e.limit;return e.limit=e.offset+t,n}function Q(e,t){switch(t){case 0:for(;128&ue(e););break;case 2:te(e,de(e));break;case 5:te(e,4);break;case 1:te(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function J(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}var X=[];function Z(){var e=X.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function ee(e){X.push(e)}function te(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function ne(e){return e.offset>=e.limit}function ie(e,t){var n=e.bytes,i=e.offset,o=e.limit,r=i+t;if(r>n.length){var a=new Uint8Array(2*r);a.set(n),e.bytes=a}return e.offset=r,r>o&&(e.limit=r),i}function oe(e,t){var n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function re(e,t){var n=oe(e,t);return e.bytes.subarray(n,n+t)}function ae(e,t){for(var n=oe(e,t),i=String.fromCharCode,o=e.bytes,r="\ufffd",a="",s=0;s<t;s++){var c=o[s+n],u=void 0,l=void 0,d=void 0,f=void 0;0==(128&c)?a+=i(c):192==(224&c)?s+1>=t||128!=(192&(u=o[s+n+1]))||(f=(31&c)<<6|63&u)<128?a+=r:(a+=i(f),s++):224==(240&c)?s+2>=t||32896!=(49344&((u=o[s+n+1])|(l=o[s+n+2])<<8))||(f=(15&c)<<12|(63&u)<<6|63&l)<2048||f>=55296&&f<=57343?a+=r:(a+=i(f),s+=2):240==(248&c)?s+3>=t||8421504!=(12632256&((u=o[s+n+1])|(l=o[s+n+2])<<8|(d=o[s+n+3])<<16))||(f=(7&c)<<18|(63&u)<<12|(63&l)<<6|63&d)<65536||f>1114111?a+=r:(a+=i(55296+((f-=65536)>>10),56320+(1023&f)),s+=3):a+=r}return a}function se(e,t){for(var n=t.length,i=0,o=0;o<n;o++){var r=t.charCodeAt(o);r>=55296&&r<=56319&&o+1<n&&(r=(r<<10)+t.charCodeAt(++o)-56613888),i+=r<128?1:r<2048?2:r<65536?3:4}fe(e,i);for(var a=ie(e,i),s=e.bytes,c=0;c<n;c++){var u=t.charCodeAt(c);u>=55296&&u<=56319&&c+1<n&&(u=(u<<10)+t.charCodeAt(++c)-56613888),u<128?s[a++]=u:(u<2048?s[a++]=u>>6&31|192:(u<65536?s[a++]=u>>12&15|224:(s[a++]=u>>18&7|240,s[a++]=u>>12&63|128),s[a++]=u>>6&63|128),s[a++]=63&u|128)}}function ce(e,t){for(var n=ie(e,t.limit),i=e.bytes,o=t.bytes,r=0,a=t.limit;r<a;r++)i[r+n]=o[r]}function ue(e){return e.bytes[oe(e,1)]}function le(e,t){var n=ie(e,1);e.bytes[n]=t}function de(e){var t,n=0,i=0;do{t=ue(e),n<32&&(i|=(127&t)<<n),n+=7}while(128&t);return i}function fe(e,t){for(t>>>=0;t>=128;)le(e,127&t|128),t>>>=7;le(e,t)}function he(e,t){var n,i=0,o=0,r=0;return i=127&(n=ue(e)),128&n&&(i|=(127&(n=ue(e)))<<7,128&n&&(i|=(127&(n=ue(e)))<<14,128&n&&(i|=(127&(n=ue(e)))<<21,128&n&&(o=127&(n=ue(e)),128&n&&(o|=(127&(n=ue(e)))<<7,128&n&&(o|=(127&(n=ue(e)))<<14,128&n&&(o|=(127&(n=ue(e)))<<21,128&n&&(r=127&(n=ue(e)),128&n&&(r|=(127&(n=ue(e)))<<7))))))))),{low:i|o<<28,high:o>>>4|r<<24,unsigned:t}}function pe(e,t){var n=t.low>>>0,i=(t.low>>>28|t.high<<4)>>>0,o=t.high>>>24,r=0===o?0===i?n<16384?n<128?1:2:n<1<<21?3:4:i<16384?i<128?5:6:i<1<<21?7:8:o<128?9:10,a=ie(e,r),s=e.bytes;switch(r){case 10:s[a+9]=o>>>7&1;case 9:s[a+8]=9!==r?128|o:127&o;case 8:s[a+7]=8!==r?i>>>21|128:i>>>21&127;case 7:s[a+6]=7!==r?i>>>14|128:i>>>14&127;case 6:s[a+5]=6!==r?i>>>7|128:i>>>7&127;case 5:s[a+4]=5!==r?128|i:127&i;case 4:s[a+3]=4!==r?n>>>21|128:n>>>21&127;case 3:s[a+2]=3!==r?n>>>14|128:n>>>14&127;case 2:s[a+1]=2!==r?n>>>7|128:n>>>7&127;case 1:s[a]=1!==r?128|n:127&n}}function _e(e){return $(e)}function me(e){return K(e)}var ve,ge=4294967296,Ee=0x10000000000000000,be=Ee/2,ye=String.prototype.charCodeAt,we=function(){function e(t,n,i){p(this,e),this.isLong=!0,this.low=0|t,this.high=0|n,this.unsigned=!!i}return _(e,[{key:"toHash",value:function(){return String.fromCharCode(255&this.low,this.low>>>8&255,this.low>>>16&255,this.low>>>24,255&this.high,this.high>>>8&255,this.high>>>16&255,this.high>>>24)}},{key:"toNumber",value:function(){return this.unsigned?(this.high>>>0)*ge+(this.low>>>0):this.high*ge+(this.low>>>0)}},{key:"isZero",value:function(){return 0===this.high&&0===this.low}},{key:"add",value:function(t){e.isLong(t)||(t=e.fromNumber(t));var n=this.high>>>16,i=65535&this.high,o=this.low>>>16,r=65535&this.low,a=t.high>>>16,s=65535&t.high,c=t.low>>>16,u=0,l=0,d=0,f=0;return d+=(f+=r+(65535&t.low))>>>16,f&=65535,l+=(d+=o+c)>>>16,d&=65535,u+=(l+=i+s)>>>16,l&=65535,u+=n+a,u&=65535,e.fromBits(d<<16|f,u<<16|l,this.unsigned)}},{key:"equals",value:function(t){return e.isLong(t)||(t=e.fromNumber(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low}},{key:"addOne",value:function(){return-1===this.low&&-1===this.high?e.fromBits(0,0,this.unsigned):-1===this.low?e.fromBits(0,this.high+1,this.unsigned):e.fromBits(this.low+1,this.high,this.unsigned)}},{key:"toBytes",value:function(e){return e?this.toBytesLE():this.toBytesBE()}},{key:"toBytesLE",value:function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}},{key:"toBytesBE",value:function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]}}],[{key:"isLong",value:function(e){return e&&!0===e.isLong}},{key:"fromBits",value:function(t,n,i){return new e(t,n,i)}},{key:"fromBytes",value:function(t,n,i){return i?e.fromBytesLE(t,n):e.fromBytesBE(t,n)}},{key:"fromBytesLE",value:function(t,n){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)}},{key:"fromBytesBE",value:function(t,n){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)}},{key:"fromHash",value:function(t){return"\0\0\0\0\0\0\0\0"===t?Se:new e((ye.call(t,0)|ye.call(t,1)<<8|ye.call(t,2)<<16|ye.call(t,3)<<24)>>>0,(ye.call(t,4)|ye.call(t,5)<<8|ye.call(t,6)<<16|ye.call(t,7)<<24)>>>0,!0)}},{key:"fromNumber",value:function(t){var n=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1];if(isNaN(t))return n?Ce:Se;if(n){if(t>=Ee)return Te}else{if(t<=-be)return Oe;if(t+1>=be)return ke}return e.fromBits(t%ge|0,t/ge|0,n)}}]),e}(),Se=new we(0,0,!1),Ce=new we(0,0,!0),ke=we.fromBits(-1,2147483647,!1),Te=we.fromBits(-1,-1,!0),Oe=we.fromBits(0,-2147483648,!1);e.ErrorCode=void 0,(ve=e.ErrorCode||(e.ErrorCode={}))[ve.NATIVE_ERROR=5001]="NATIVE_ERROR",ve[ve.CONNECTING_ERROR=5002]="CONNECTING_ERROR",ve[ve.MAX_RETRIES_ERROR=5003]="MAX_RETRIES_ERROR",ve[ve.MESSAGE_ERROR=5004]="MESSAGE_ERROR",ve[ve.OPEN_ERROR=5005]="OPEN_ERROR";var xe=_((function e(t){p(this,e),this.type=t,this.target=null})),Ie=function(e){f(n,e);var t=h(n);function n(e,i){var o;return p(this,n),(o=t.call(this,e)).message=i&&i.message||null,o}return _(n)}(xe),Ae=function(t){f(i,t);var n=h(i);function i(t,o){var r;return p(this,i),(r=n.call(this,t)).error=o&&o.error||null,r.colno=o&&o.colno||0,r.filename=o&&o.filename||"",r.lineno=o&&o.lineno||0,r.message=o&&o.message||"",r.code=o&&o.code||e.ErrorCode.NATIVE_ERROR,r}return _(i)}(xe),Le=function(e){f(n,e);var t=h(n);function n(e,i){var o;return p(this,n),(o=t.call(this,e)).code=i&&i.code||0,o.reason=i&&i.reason||"",o.wasClean=i&&i.wasClean||!1,o}return _(n)}(xe),De=function(e){f(n,e);var t=h(n);function n(e,i){var o;return p(this,n),(o=t.call(this,e)).data=i&&i.data||null,o}return _(n)}(xe),Pe=function(e){f(n,e);var t=h(n);function n(e,i){var o;return p(this,n),(o=t.call(this,e)).data=i&&i.data||null,o.message=i&&i.message||null,o}return _(n)}(De),Re=function(e){f(n,e);var t=h(n);function n(e,i){var o;return p(this,n),(o=t.call(this,e)).data=i&&i.data||null,o}return _(n)}(xe);function Me(e,t){var n=t.message,i=t.code;return new Ae(e,{message:n,code:i})}function Ne(e,t){var n=t.code,i=t.reason,o=t.wasClean;return"undefined"!=typeof CloseEvent?new CloseEvent(e,{code:n,reason:i,wasClean:o}):new Le(e,{code:n,reason:i,wasClean:o})}var Ge=function(){function e(t,n){p(this,e),this.endpoints=t,this.maxRetries=n,this.currentIndex=0,this.currentEndpointTriesCount=0}return _(e,[{key:"resetEndpointConfig",value:function(){this.currentIndex=0,this.currentEndpointTriesCount=0}},{key:"resetTries",value:function(){this.currentEndpointTriesCount=0}},{key:"getCurrentEndpoint",value:function(){return this.endpoints[this.currentIndex]}},{key:"getCurrentEndpointTriesCount",value:function(){return this.currentEndpointTriesCount}},{key:"checkReachMaxTries",value:function(){return this.currentIndex>=this.endpoints.length||this.currentIndex===this.endpoints.length-1&&this.currentEndpointTriesCount===this.maxRetries}},{key:"checkCurrentEndpointReachedMaxRetries",value:function(){return this.currentIndex==this.endpoints.length||this.currentEndpointTriesCount>this.maxRetries}},{key:"replaceBackupEndpointAndUpdateCount",value:function(){return this.currentEndpointTriesCount=1,this.currentIndex++,this.endpoints[this.currentIndex]}},{key:"getCurrentEndpointAndUpdateCount",value:function(){return this.currentEndpointTriesCount++,this.getCurrentEndpoint()}}]),e}(),Be=(void 0!==v&&"Window"===v.constructor.name||"undefined"!=typeof window&&"Window"===window.constructor.name)&&"undefined"!=typeof document,qe=void 0!==v&&("Object"===v.constructor.name||"DedicatedWorkerGlobalScope"===v.constructor.name)&&"undefined"!=typeof tt,Ue=(void 0!==v&&"Object"===v.constructor.name||void 0===v||void 0!==v&&!!v.WeixinJSBridge)&&"undefined"!=typeof wx,Ve=void 0!==v&&("DedicatedWorkerGlobalScope"===v.constructor.name||"SharedWorkerGlobalScope"===v.constructor.name||"ServiceWorkerGlobalScope"===v.constructor.name)&&"undefined"!=typeof self,je=void 0!==v&&"Object"===v.constructor.name&&"Object"===window.constructor.name&&"undefined"!=typeof process&&process.version,ze=function(){function e(){p(this,e),this._listeners={}}return _(e,[{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o,r=this._listeners[e];if(r)k(o=b(r).call(r)).call(o,(function(e){return e.fn.apply(e.ctx,n)}));else if("error"===e&&!this.onerror){var a=n.length&&n[0];if(a instanceof Error)throw a;throw new Error("Unhandled error."+(a?" ("+a.message+")":"")).context=a,a}return this}},{key:"off",value:function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=null;else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?T(n).call(n,i,1):++i;return this}},{key:"on",value:function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this}}]),e}(),He=function(e){f(n,e);var t=h(n);function n(e,i,o){var r,a;return p(this,n),(a=t.call(this))._socket=null,Ue&&wx.connectSocket&&(a._socket=wx.connectSocket({url:e,protocols:i,header:o,fail:function(e){var t=Me("error",{message:e.errMsg||e.errNo?"message: ".concat(e.errMsg)||0:O(e)});a.emit("error",t)}})),qe&&tt.connectSocket&&(a._socket=tt.connectSocket({url:e,protocols:i,header:o,fail:x(r=function(e){var t=Me("error",{message:e.errMsg||e.errNo?"message: ".concat(e.errMsg)||0:O(e)});a.emit("error",t)}).call(r,d(a))})),a._addWsListeners(),a}return _(n,[{key:"_addWsListeners",value:function(){var e=this;this._socket.onOpen((function(t){e.emit("open",new Re("open",t))})),this._socket.onClose((function(t){e.emit("close",new Le("close",t))})),this._socket.onMessage((function(t){e.emit("message",new Pe("message",t))})),this._socket.onError((function(t){e.emit("error",new Ae("error",t))}))}},{key:"send",value:function(e){var t=this;if(e instanceof Uint8Array){var n,i=b(n=e.buffer).call(n,e.byteOffset,e.byteLength+e.byteOffset);this._socket&&this._socket.send({data:i,fail:function(e){t.emit("error",Me("error",{message:e.errMsg||e.errNo?"message: ".concat(e.errMsg)||0:O(e)}))}})}else this._socket&&this._socket.send({data:e,fail:function(e){t.emit("error",Me("error",{message:e.errMsg||e.errNo?"message: ".concat(e.errMsg)||0:O(e)}))}})}},{key:"close",value:function(e,t){this._socket&&this._socket.close({code:e,reason:t})}},{key:"addEventListener",value:function(e,t){this.on(e,t)}},{key:"removeEventListener",value:function(e,t){this.off(e,t)}},{key:"readyState",get:function(){return this._socket.readyState}},{key:"binaryType",get:function(){return this._socket.binaryType},set:function(e){}},{key:"url",get:function(){return this._socket.url}},{key:"protocol",get:function(){return this._socket.protocol}},{key:"extensions",get:function(){return this._socket.extensions}},{key:"bufferedAmount",get:function(){return 0}}]),n}(ze);function We(e,t,n){return!!(null==e?void 0:I(e).call(e,(function(e){return e.key===t&&e.value===n})))}function Fe(e,t){var n;return null===(n=null==e?void 0:I(e).call(e,(function(e){return e.key===t})))||void 0===n?void 0:n.value}function Ke(e){return t(this,void 0,void 0,l.mark((function t(){var n,i,o,r,a,s,c,u,d,f;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this._options.enableAutoAck,i=We(e.message.headers,"need_ack","1"),o=We(e.message.headers,"is_ack","1"),r=We(e.message.headers,"x_frontier_qos_ack","1"),n&&i&&(a=e.message,s=a.SeqID,c=a.LogID,u=a.service,d=a.LogIDNew,f=a.method,this._sendAck({SeqID:s,LogID:c,LogIDNew:d,service:u,method:f,headers:[{key:"is_ack",value:"1"},{key:"ack_id",value:d||""},{key:"ack_code",value:"0"}]})),o&&!r&&this._dispatchAckMessageEvent(e);case 6:case"end":return t.stop()}}),t,this)})))}function $e(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t}function Ye(e,t,n){if(n-t<1)return"";for(var i="",o=t;o<n;){var r=e[o++];if(r<=127)i+=String.fromCharCode(r);else if(r>=192&&r<224)i+=String.fromCharCode((31&r)<<6|63&e[o++]);else if(r>=224&&r<240)i+=String.fromCharCode((15&r)<<12|(63&e[o++])<<6|63&e[o++]);else if(r>=240){var a=((7&r)<<18|(63&e[o++])<<12|(63&e[o++])<<6|63&e[o++])-65536;i+=String.fromCharCode(55296+(a>>10)),i+=String.fromCharCode(56320+(1023&a))}}return i}function Qe(e,t,n){for(var i,o,r=n,a=0;a<e.length;++a)(i=e.charCodeAt(a))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(a+1)))?(i=65536+((1023&i)<<10)+(1023&o),++a,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-r}function Je(e){return t(this,void 0,void 0,l.mark((function t(){var n;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=6;break}return n=new Uint8Array($e(e)),Qe(e,n,0),t.abrupt("return",n);case 6:if(!(e instanceof ArrayBuffer)){t.next=10;break}return t.abrupt("return",new Uint8Array(e));case 10:return t.abrupt("return",new Uint8Array(e.buffer,e.byteOffset,e.byteLength));case 11:case"end":return t.stop()}}),t)})))}function Xe(e){return t(this,void 0,void 0,l.mark((function t(){var n,i,o,r,a,s,c,u,d;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=_e,t.next=3,Je(e.data);case 3:t.t1=t.sent,n=(0,t.t0)(t.t1);try{n.payload instanceof Uint8Array?(i=this._options.payloadEncoding instanceof Object?{force:!!this._options.payloadEncoding.force,encoding:this._options.payloadEncoding.encoding?this._options.payloadEncoding.encoding.replace(/\s/g,"").toLowerCase():""}:{force:!1,encoding:this._options.payloadEncoding?this._options.payloadEncoding.replace(/\s/g,"").toLowerCase():""},o=n.payloadEncoding?n.payloadEncoding.replace(/\s/g,"").toLowerCase():"",r=this._options.payloadType instanceof Object?{force:!!this._options.payloadType.force,type:this._options.payloadType.type?this._options.payloadType.type.replace(/\s/g,"").toLowerCase():""}:{force:!1,type:this._options.payloadType?this._options.payloadType.replace(/\s/g,"").toLowerCase():""},a=n.payloadType?n.payloadType.replace(/\s/g,"").toLowerCase():"",s=r.force?r.type:a||r.type,c=i.force?i.encoding:o||i.encoding,u=["text/plain;charset=utf-8","application/json","application/json;charset=utf-8","string"],d=["none_none","binary"],this._options.enableTransformTextPayload&&A(u).call(u,s)&&(!c||A(d).call(d,c))?n.textPayload=Ye(n.payload,0,n.payload.byteLength):n.textPayload=""):n.textPayload=""}catch(l){n.textPayload=""}e.message=n;case 7:case"end":return t.stop()}}),t,this)})))}function Ze(e,t,n){var i=-1;return function t(o){var r;return++i<n.length?x(r=n[i]).call(r,e)(o).then((function(){return t(o)})):g.resolve()}(t)}var et,nt,it=function(e,t){return L(t).call(t,(function(t){return e instanceof t}))},ot=new D,rt=new D,at=new D,st=new D,ct=new D,ut={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return rt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||at.get(e);if("store"===t)return n.objectStoreNames[1]?undefined:n.objectStore(n.objectStoreNames[0])}return ft(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function lt(e){var t;return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?A(t=nt||(nt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).call(t,e)?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(ht(this),n),ft(ot.get(this))}:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return ft(e.apply(ht(this),n))}:function(t){for(var n,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];var a=e.call.apply(e,C(n=[ht(this),t]).call(n,o));return at.set(a,P(t)?P(t).call(t):[t]),ft(a)}}function dt(e){return"function"==typeof e?lt(e):(e instanceof IDBTransaction&&function(e){if(!rt.has(e)){var t=new g((function(t,n){var i=function(){e.removeEventListener("complete",o),e.removeEventListener("error",r),e.removeEventListener("abort",r)},o=function(){t(),i()},r=function(){n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",o),e.addEventListener("error",r),e.addEventListener("abort",r)}));rt.set(e,t)}}(e),it(e,et||(et=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,ut):e)}function ft(e){if(e instanceof IDBRequest)return t=e,(n=new g((function(e,n){var i=function(){t.removeEventListener("success",o),t.removeEventListener("error",r)},o=function(){e(ft(t.result)),i()},r=function(){n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",r)}))).then((function(e){e instanceof IDBCursor&&ot.set(e,t)})).catch((function(){})),ct.set(n,t),n;var t,n;if(st.has(e))return st.get(e);var i=dt(e);return i!==e&&(st.set(e,i),ct.set(i,e)),i}var ht=function(e){return ct.get(e)};function pt(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.blocked,o=n.upgrade,r=n.blocking,a=n.terminated,s=indexedDB.open(e,t),c=ft(s);return o&&s.addEventListener("upgradeneeded",(function(e){o(ft(s.result),e.oldVersion,e.newVersion,ft(s.transaction))})),i&&s.addEventListener("blocked",(function(){return i()})),c.then((function(e){a&&e.addEventListener("close",(function(){return a()})),r&&e.addEventListener("versionchange",(function(){return r()}))})).catch((function(){})),c}var _t,mt=["get","getKey","getAll","getAllKeys","count"],vt=["put","add","delete","clear"],gt=new R;function Et(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(gt.get(t))return gt.get(t);var n=t.replace(/FromIndex$/,""),i=t!==n,o=A(vt).call(vt,n);if(n in(i?IDBIndex:IDBObjectStore).prototype&&(o||A(mt).call(mt,n))){var r=function(){var e=u(l.mark((function e(t){var r,a,s,c,u,d,f=arguments;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.transaction(t,o?"readwrite":"readonly"),s=a.store,c=f.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=f[d];return i&&(s=s.index(u.shift())),e.next=6,g.all([(r=s)[n].apply(r,u),o&&a.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return gt.set(t,r),r}}}ut=c(c({},_t=ut),{},{get:function(e,t,n){return Et(e,t)||_t.get(e,t,n)},has:function(e,t){return!!Et(e,t)||_t.has(e,t)}});var bt=function(e){f(i,e);var n=h(i);function i(){var e;return p(this,i),(e=n.call(this))._qosDB=undefined,e._intervalTimeoutId=null,e._interval=36e5,e._init(),e}return _(i,[{key:"openDB",value:function(){return t(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._init();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"_init",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new g((function(e){t._qosDB?e(t):(pt("frontier",1,{upgrade:function(e,t,n,i){e.createObjectStore("qos",{keyPath:"message_id"})}}).then((function(e){t._qosDB=e,t._intervalFlush(),t.emit("ready")})),t.on("ready",(function(){e(t),t.off()})))})));case 1:case"end":return e.stop()}}),e)})))}},{key:"_intervalFlush",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearInterval(this._intervalTimeoutId),this._intervalTimeoutId=M((function(){t.flushExpired()}),this._interval);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"get",value:function(e){var n;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=this._qosDB)||void 0===n?void 0:n.get("qos",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"set",value:function(e,n){var i;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(i=this._qosDB)||void 0===i?void 0:i.put("qos",{message_id:e,timestamp:n});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"del",value:function(e){var n;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=this._qosDB)||void 0===n?void 0:n.delete("qos",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){var e;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this._qosDB)||void 0===e?void 0:e.clear("qos");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"keys",value:function(){var e;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this._qosDB)||void 0===e?void 0:e.getAllKeys("qos");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getAll",value:function(){var e;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this._qosDB)||void 0===e?void 0:e.getAll("qos");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"flushExpired",value:function(){var e;return t(this,void 0,void 0,l.mark((function t(){var n,i,o=this;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this._qosDB)||void 0===e?void 0:e.getAll("qos");case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:n=t.t0,i=N(n).call(n,(function(e){return e.timestamp<E()})),k(i).call(i,(function(e){var t;null===(t=o._qosDB)||void 0===t||t.delete("qos",e.message_id)}));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"closeDB",value:function(){var e;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:clearInterval(this._intervalTimeoutId),null===(e=this._qosDB)||void 0===e||e.close(),this._qosDB=undefined;case 3:case"end":return t.stop()}}),t,this)})))}},{key:"isReady",get:function(){return this._qosDB}}]),i}(ze),yt=function(){function e(){p(this,e),this._qosDB=localStorage,this._intervalTimeoutId=null,this._interval=36e5,this._intervalFlush()}return _(e,[{key:"openDB",value:function(){return t(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._intervalTimeoutId){e.next=2;break}return e.abrupt("return");case 2:return this._intervalFlush(),e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"_intervalFlush",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearInterval(this._intervalTimeoutId),this._intervalTimeoutId=M((function(){t.flushExpired()}),this._interval);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"_add_prefix",value:function(e){var t;return C(t="".concat(this._prefix)).call(t,e)}},{key:"_prefix",get:function(){return"frontier_qos_msg_id_"}},{key:"get",value:function(e){return t(this,void 0,void 0,l.mark((function t(){var n;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._qosDB.getItem(this._add_prefix(e)),t.abrupt("return",JSON.parse(n||"{}"));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"set",value:function(e,n){return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._qosDB.setItem(this._add_prefix(e),O({message_id:e,timestamp:n})));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"del",value:function(e){return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._qosDB.removeItem(this._add_prefix(e)));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){return t(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._qosDB.clear());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"keys",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t,n,i=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=0;n<this._qosDB.length;n++)t.push(this._qosDB.key(n));return e.abrupt("return",N(t).call(t,(function(e){return null==e?void 0:G(e).call(e,i._prefix)})));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"getAll",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t,n,i,o;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,B(t=this).call(t);case 3:for(i in e.sent)o=this._qosDB.getItem(i),n.push(JSON.parse(o||"{}"));return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"flushExpired",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t,n,i=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAll();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:t=e.t0,n=N(t).call(t,(function(e){return e.timestamp<E()})),k(n).call(n,(function(e){i.del(e.message_id)}));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"closeDB",value:function(){clearInterval(this._intervalTimeoutId)}},{key:"isReady",get:function(){return this._qosDB}}]),e}(),wt=function(){function e(){p(this,e),this._qosDB=qe?tt:Ue?wx:null,this._intervalTimeoutId=null,this._interval=36e5,this._intervalFlush()}return _(e,[{key:"openDB",value:function(){return t(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._intervalTimeoutId){e.next=2;break}return e.abrupt("return");case 2:return this._intervalFlush(),e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"_intervalFlush",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearInterval(this._intervalTimeoutId),this._intervalTimeoutId=M((function(){t.flushExpired()}),this._interval);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"_add_prefix",value:function(e){var t;return C(t="".concat(this._prefix)).call(t,e)}},{key:"_prefix",get:function(){return"frontier_qos_msg_id_"}},{key:"get",value:function(e){return t(this,void 0,void 0,l.mark((function t(){var n;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._qosDB.getStorageSync(this._add_prefix(e)),t.abrupt("return",JSON.parse(n||"{}"));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"set",value:function(e,n){return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._qosDB.setStorageSync(this._add_prefix(e),O({message_id:e,timestamp:n})));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"del",value:function(e){return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._qosDB.removeStorageSync(this._add_prefix(e)));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){return t(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._qosDB.clearStorageSync());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"keys",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t,n,i=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._qosDB.getStorageInfoSync(),n=B(t),e.abrupt("return",N(n).call(n,(function(e){return null==e?void 0:G(e).call(e,i._prefix)})));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"getAll",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t,n,i,o,r,a,s;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,B(t=this).call(t);case 3:i=e.sent,o=m(i),e.prev=5,o.s();case 7:if((r=o.n()).done){e.next=15;break}return a=r.value,e.next=11,this.get(a);case 11:s=e.sent,n.push(s);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),o.e(e.t0);case 20:return e.prev=20,o.f(),e.finish(20);case 23:return e.abrupt("return",n);case 24:case"end":return e.stop()}}),e,this,[[5,17,20,23]])})))}},{key:"flushExpired",value:function(){return t(this,void 0,void 0,l.mark((function e(){var t,n,i=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAll();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:t=e.t0,n=N(t).call(t,(function(e){return e.timestamp<E()})),k(n).call(n,(function(e){i.del(e.message_id)}));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"closeDB",value:function(){clearInterval(this._intervalTimeoutId)}},{key:"isReady",get:function(){return this._qosDB}}]),e}();function St(){return qe||qe?new wt:(Be||Ve)&&("undefined"==typeof indexedDB?"undefined":W(indexedDB))!==undefined?new bt:(Be||Ve)&&("undefined"==typeof localStorage?"undefined":W(localStorage))!==undefined?new yt:null}function Ct(e){var n,i,o,r;return t(this,void 0,void 0,l.mark((function t(){var a,s,c,u,d;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=We(e.message.headers,"code","-1"),s=We(e.message.headers,"is_ack","1"),c=Fe(e.message.headers,"x_frontier_msgid"),u=Number(Fe(e.message.headers,"x_frontier_ttl"))||0,d=We(e.message.headers,"x_frontier_qos","2"),!We(e.message.headers,"x_frontier_qos_ack","1")||!d){t.next=8;break}return t.abrupt("return");case 8:if(!d||this._qosDB){t.next=13;break}if(this._qosDB=St(),!this._qosDB){t.next=13;break}return t.next=13,this._qosDB.openDB();case 13:if(!d||this._qosDB.isReady){t.next=16;break}return t.next=16,this._qosDB.openDB();case 16:if(!(e.message.service>0&&s)||a){t.next=30;break}if(!c||!d){t.next=28;break}return t.next=20,null===(n=this._qosDB)||void 0===n?void 0:n.get(c);case 20:if(t.sent){t.next=25;break}return this._dispatchMessageEvent(e),t.next=25,null===(i=this._qosDB)||void 0===i?void 0:i.set(c,E()+u);case 25:return t.abrupt("return");case 28:this._dispatchMessageEvent(e);case 29:return t.abrupt("return");case 30:if(!(e.message.service>0)){t.next=44;break}if(!c||!d){t.next=42;break}return t.next=34,null===(o=this._qosDB)||void 0===o?void 0:o.get(c);case 34:if(t.sent){t.next=39;break}return this._dispatchMessageEvent(e),t.next=39,null===(r=this._qosDB)||void 0===r?void 0:r.set(c,E()+u);case 39:return t.abrupt("return");case 42:this._dispatchMessageEvent(e);case 43:return t.abrupt("return");case 44:case"end":return t.stop()}}),t,this)})))}function kt(e){try{return"string"!=typeof e&&(e instanceof ArrayBuffer||e.buffer&&e.buffer instanceof ArrayBuffer)?"":"string"==typeof e?(JSON.parse(e),"application/json"):""}catch(t){return"string"==typeof e?"text/plain;charset=utf-8":""}}function Tt(e){return t(this,void 0,void 0,l.mark((function t(){var n,i=this;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._uptimeTimeoutId=q(x(n=function(){return x(Ot).call(Ot,i)(e)}).call(n,this),this._options.uptimeInterval);case 1:case"end":return t.stop()}}),t,this)})))}function Ot(e){var n,i;return t(this,void 0,void 0,l.mark((function t(){var o,r,a,s,c,u=this;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._ws&&this._ws.readyState===this.OPEN){t.next=2;break}return t.abrupt("return");case 2:r=this._options.pingInterval,null===(n=this._endpointManager)||void 0===n||n.resetEndpointConfig(),a=0;case 5:if(!(a<this._messageQueue.length)){t.next=16;break}if(s=this._messageQueue[a],this._ws.readyState!==this.OPEN||null===s){t.next=12;break}this._ws&&this._ws.send(s),this._messageQueue[a]=null,t.next=13;break;case 12:return t.abrupt("break",16);case 13:a++,t.next=5;break;case 16:this._messageQueue=N(o=this._messageQueue).call(o,(function(e){return Boolean(e)})),this._pingPongTimeoutId=q((function(){return u._ping()}),r),this._dispatchOpenEvent(e),this._isBrowser&&this._ws&&(this._ws.binaryType=this._binaryType),c=null===(i=this._endpointManager)||void 0===i?void 0:i.getCurrentEndpoint(),this._debug("open ".concat(c," success"));case 22:case"end":return t.stop()}}),t,this)})))}function xt(){return t(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._isInit=!1,clearTimeout(this._connectionTimeoutId);case 2:case"end":return e.stop()}}),e,this)})))}function It(e){var n,i;return t(this,void 0,void 0,l.mark((function t(){var o,r,a,s,c,u;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=We(e.message.headers,"x_frontier_qos","2"),r=We(e.message.headers,"x_frontier_is_ack","1"),a=null===(n=Fe(e.message.headers,"x_frontier_ack_msgid"))||void 0===n?void 0:n.split(","),!o||this._qosDB){t.next=8;break}if(this._qosDB=St(),!this._qosDB){t.next=8;break}return t.next=8,this._qosDB.openDB();case 8:if(!o||this._qosDB.isReady){t.next=11;break}return t.next=11,this._qosDB.openDB();case 11:if(!(o&&r&&a&&a.length)){t.next=29;break}s=m(a),t.prev=13,s.s();case 15:if((c=s.n()).done){t.next=21;break}return u=c.value,t.next=19,null===(i=this._qosDB)||void 0===i?void 0:i.del(u);case 19:t.next=15;break;case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(13),s.e(t.t0);case 26:return t.prev=26,s.f(),t.finish(26);case 29:case"end":return t.stop()}}),t,this,[[13,23,26,29]])})))}var At=function(n){f(a,n);var r=h(a);function a(n){var i;p(this,a),(i=r.call(this))._miniNavigatorOnline=!0,i._isBrowser=Be,i._isNode=je,i._isMiniTT=qe,i._isMiniWX=Ue,i._isWorker=Ve,i._messageQueue=[],i._endpointManager=null,i._readyClosed=!1,i._binaryType="arraybuffer",i._connectLock=!1,i._connectionTimeoutId=null,i._uptimeTimeoutId=null,i._reconnectTimeoutId=null,i._pingPongTimeoutId=null,i._seqId=0,i._isInit=!1,i._url="",i._qosDB=null,i._protocols="pbbp2",i.CLOSED=3,i.CONNECTING=0,i.OPEN=1,i.CLOSING=2,i._onOpen=function(t){Ze(d(i),t,[xt,Tt]).then((function(){var e,t=null===(e=i._endpointManager)||void 0===e?void 0:e.getCurrentEndpoint();i._debug("open ".concat(t))})).catch((function(t){var n=Me("error",{message:t.message,code:e.ErrorCode.OPEN_ERROR});i._dispatchErrorEvent(n)}))},i._onMessage=function(n){return t(d(i),void 0,void 0,l.mark((function t(){var i,o,r,a=this;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this._options,o=i.pingInterval,r=i.pingFrequency,clearTimeout(this._reconnectTimeoutId),"hi"!==n.data&&"auto"!==r||(clearTimeout(this._pingPongTimeoutId),this._pingPongTimeoutId=q((function(){return a._ping()}),o)),"hi"!==n.data){t.next=5;break}return t.abrupt("return");case 5:Ze(this,n,[Xe,Ke,It,Ct]).then((function(){a._debug("received",n.message)})).catch((function(t){var n=Me("error",{message:t.message,code:e.ErrorCode.MESSAGE_ERROR});a._dispatchErrorEvent(n)}));case 6:case"end":return t.stop()}}),t,this)})))},i._onError=function(t){var n,o,r=null===(n=i._endpointManager)||void 0===n?void 0:n.checkReachMaxTries(),a=null===(o=i._endpointManager)||void 0===o?void 0:o.getCurrentEndpoint();if(!r||t.message)i._ws&&i._ws.readyState===i.OPEN&&i._disconnect(),i._dispatchErrorEvent(Me("error",{message:t.message,code:e.ErrorCode.NATIVE_ERROR}));else{var s="connect ".concat(a," fail, max retries reached");i._dispatchErrorEvent(Me("error",{message:s,code:e.ErrorCode.MAX_RETRIES_ERROR}))}},i._onClose=function(e){return t(d(i),void 0,void 0,l.mark((function t(){var n,i,o,r,a,s,c,u,d,f,h,p,_,m;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._clearTimer(),this._clearPingTimer(),this._removeWsListeners(),this._connectLock=!1,(d=null===(n=this._endpointManager)||void 0===n?void 0:n.checkReachMaxTries())||!this._navigatorOnline()||this._readyClosed){t.next=11;break}return f=null===(i=this._endpointManager)||void 0===i?void 0:i.getCurrentEndpoint(),this._dispatchCloseEvent(Ne("close",{code:1006,reason:e.reason||"connecting failed, unknown reason, hostname: ".concat(f)})),this._options.reconnectInterceptor(e.code,e.reason)&&this._connect(),t.abrupt("return");case 11:if(1e3===e.code||!this._readyClosed){t.next=15;break}return this._dispatchCloseEvent(Ne("close",{code:1e3,reason:"bye"})),null===(o=this._endpointManager)||void 0===o||o.resetEndpointConfig(),t.abrupt("return");case 15:if(1e3===e.code||!d){t.next=22;break}return h=null===(r=this._endpointManager)||void 0===r?void 0:r.getCurrentEndpoint(),p=(p=e.reason)?C(_="connecting failed, ".concat(p,", hostname: ")).call(_,h,", max retries reached"):"connecting failed, unknown reason, hostname: ".concat(h,", max retries reached"),this._dispatchCloseEvent(Ne("close",{code:e.code,reason:p})),null===(a=this._endpointManager)||void 0===a||a.resetEndpointConfig(),t.abrupt("return");case 22:if(1e3===e.code||e.reason){t.next=27;break}return m=null===(s=this._endpointManager)||void 0===s?void 0:s.getCurrentEndpoint(),this._dispatchCloseEvent(Ne("close",{code:e.code,reason:"connecting failed, unknown reason, hostname: ".concat(m)})),null===(c=this._endpointManager)||void 0===c||c.resetEndpointConfig(),t.abrupt("return");case 27:this._dispatchCloseEvent(e),null===(u=this._endpointManager)||void 0===u||u.resetEndpointConfig();case 29:case"end":return t.stop()}}),t,this)})))},i.onclose=null,i.onerror=null,i.onmessage=null,i.onopen=null,i.onStartReconnect=null,i.onReceiveAck=null,i.onStopImmediatelyReconnect=null,i._options={url:"",automaticOpen:!0,initReconnectInterval:1e3,maxReconnectInterval:1e4,reconnectIntervalGrowFactor:2,timeoutInterval:5e3,uptimeInterval:1e3,maxRetries:5,debug:!1,maxMessageQueueLength:Infinity,service:0,logIDGenerator:o,headers:undefined,payloadEncoding:"",payloadType:"",fpID:"",deviceID:"",accessKey:"",ttwID:"",bddID:"",aID:"",disableAutoReconnect:!1,customParams:{},pingInterval:3e4,pingTimeoutInterval:5e3,pingFrequency:"auto",enableTransformTextPayload:!1,logIDNewConfig:{enableAutoGenerateLogIDNew:!1,userIp:""},miniProgramParams:{customHttpHeader:{}},enableAutoAck:!1,reconnectInterceptor:function(){return!0},enableQoS:!1};var s=n.url,c=n.ws,u=U(s)?s:"string"==typeof s?[s]:[];if(!u||0===u.length)throw new Error("please provide valid url, 'options.env' param is deprecated, you can use 'options.url' param instead");if(!function(e){return!!(e||(Be||Ve)&&"undefined"!=typeof WebSocket&&WebSocket||Ue&&wx.connectSocket||qe&&tt.connectSocket)}(c))throw new Error("please provide ws params, WebSocket constructor is undefined");return V(i._options,n),i._endpointManager=new Ge(u,i._options.maxRetries),i._options.automaticOpen&&(i._isInit=!0,i._connect()),i._isMiniTT||i._isMiniWX?i._onPageNetWorkChange():i._isBrowser&&i._initGlobalEventListener(),i}return _(a,[{key:"_handleOnLine",value:function(){this._options.disableAutoReconnect||this._readyClosed||this._handleReconnect()}},{key:"_handleOffLine",value:function(){this._destroyWebSocket();var e=new Ie("reconnect",{message:"stop immediately reconnect"});this.onStopImmediatelyReconnect&&this.onStopImmediatelyReconnect(e)}},{key:"_initGlobalEventListener",value:function(){var e,t,n,i;this._isBrowser&&window.addEventListener("online",x(e=this._handleOnLine).call(e,this)),this._isBrowser&&window.addEventListener("offline",x(t=this._handleOffLine).call(t,this)),this._isBrowser&&window.addEventListener("pagehide",x(n=this._handlePageHide).call(n,this)),this._isBrowser&&document.addEventListener("resume",x(i=this._handlePageShow).call(i,this))}},{key:"_handlePageHide",value:function(e){e.persisted||(this._isBrowser&&window.removeEventListener("pagehide",this._handlePageHide),this._isBrowser&&document.removeEventListener("resume",this._handlePageShow),this.close()),this._isBrowser&&window.removeEventListener("online",this._handleOnLine),this._isBrowser&&window.removeEventListener("offline",this._handleOffLine)}},{key:"_handlePageShow",value:function(){var e,t;!this._navigatorOnline()||this._ws&&this._ws.readyState===this.OPEN&&this._ws.readyState===this.CONNECTING||this._handleOnLine(),this._isBrowser&&window.addEventListener("online",x(e=this._handleOnLine).call(e,this)),this._isBrowser&&window.addEventListener("offline",x(t=this._handleOffLine).call(t,this))}},{key:"_generateUrl",value:function(e){return t(this,void 0,void 0,l.mark((function t(){var n,i,o,r,a,c,u,d,f,h,p,_,m,v,g,E,b,y,w,S,k,T,O,x;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this._options,a=r.fpID,c=r.deviceID,u=r.bddID,d=r.ttwID,f=r.accessKey,h=r.aID,p=r.customParams,_=void 0===p?{}:p,m=r.enableAutoAck,v=r.enableQoS,this._isBrowser||this._isMiniWX||this._isMiniTT?(g=location&&"https:"==location.protocol?"wss://":"ws://",E=e.replace(/((^ws)|(^http))((?:[s]*:\/\/))/,""),b=/^wss(.*:\/\/)/.test(e)?e:C(y="".concat(g)).call(y,E)):(g="wss://",E=e.replace(/(^http)((?:[s]*:\/\/))/,""),b=/(^ws)((?:[s]*:\/\/))/.test(E)?E:C(w="".concat(g)).call(w,E)),S=u?"bd_did":d?"ttwid":"device_id",(k=u||d||c)&&S){t.next=6;break}throw new Error("please provide bddID, deviceID or ttwID");case 6:if("function"!=typeof _){t.next=12;break}return t.next=9,_();case 9:t.t0=t.sent,t.next=13;break;case 12:t.t0=_;case 13:return T=t.t0,O=V((s(n={device_platform:"web",version_code:"fws_1.0.0",access_key:f,fpid:a,aid:h},S,k),s(n,"xsack",m?1:0),s(n,"xaack",m?1:0),s(n,"xsqos",v?1:0),n),T),x=j(i=z(O)).call(i,(function(e,t){var n,i,o;return C(n=C(i=C(o="".concat(e)).call(o,e?"&":"?")).call(i,t,"=")).call(n,O[t])}),""),t.abrupt("return",C(o="".concat(b,"/ws/v2")).call(o,x));case 17:case"end":return t.stop()}}),t,this)})))}},{key:"_connect",value:function(){var n,i,o,r,a,s,c;return t(this,void 0,void 0,l.mark((function t(){var u,d,f,h,p,_,m,v,g,E,b,y,w,S,k,T,O=this;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._connectLock&&!this._readyClosed){t.next=2;break}return t.abrupt("return");case 2:if(this._connectLock=!0,t.prev=3,d=null===(n=this._endpointManager)||void 0===n?void 0:n.checkCurrentEndpointReachedMaxRetries(),f=this._options.timeoutInterval,!d){t.next=28;break}if(h=null===(i=this._endpointManager)||void 0===i?void 0:i.getCurrentEndpoint(),p=null===(o=this._endpointManager)||void 0===o?void 0:o.replaceBackupEndpointAndUpdateCount(),_=null===(r=this._endpointManager)||void 0===r?void 0:r.getCurrentEndpointTriesCount(),!p){t.next=22;break}return g=C(m="connect ".concat(h," timeout, max retries reached, will use backup endpoint ")).call(m,p," to retry"),E=Me("error",{message:g,code:e.ErrorCode.MAX_RETRIES_ERROR}),this._debug(g),this._dispatchErrorEvent(E),t.next=17,this._generateUrl(p);case 17:this._url=t.sent,this._debug(C(v="connect ".concat(p," ")).call(v,_," times")),this._removeWsListeners(),t.next=26;break;case 22:return b="connect ".concat(h," timeout, max retries reached"),this._debug(b),this._dispatchErrorEvent(Me("error",{message:b,code:e.ErrorCode.MAX_RETRIES_ERROR})),t.abrupt("return");case 26:t.next=35;break;case 28:return w=null===(a=this._endpointManager)||void 0===a?void 0:a.getCurrentEndpointAndUpdateCount(),S=null===(s=this._endpointManager)||void 0===s?void 0:s.getCurrentEndpointTriesCount(),t.next=32,this._generateUrl(w||"");case 32:this._url=t.sent,this._debug(C(y="connect ".concat(w," ")).call(y,S," times")),this._removeWsListeners();case 35:if(this._isInit?this._isInit=!1:(k=new Ie("reconnect",{message:"start"}),this.onStartReconnect&&this.onStartReconnect(k)),!((T=(null===(c=this._endpointManager)||void 0===c?void 0:c.getCurrentEndpointTriesCount())||0)>1)){t.next=40;break}return t.next=40,this._wait(T-1);case 40:this._debug(C(u="connecting url: ".concat(this._url," protocols: ")).call(u,this._protocols)),this._ws=(l={url:this._url,protocols:[this._protocols],headers:this._options.miniProgramParams.customHttpHeader},(x=this._options.ws)?new x(l.url,l.protocol):(Be||Ve)&&"undefined"!=typeof WebSocket&&WebSocket?new WebSocket(l.url,l.protocols):Ue||qe?new He(l.url,l.protocol,l.headers):void 0),(this._isBrowser||this._isWorker)&&this._ws&&(this._ws.binaryType=this._binaryType),this._addWsListeners(),this._connectionTimeoutId=q((function(){return O._onTimeout()}),f),t.next=51;break;case 47:throw t.prev=47,t.t0=t.catch(3),this._connectLock=!1,t.t0;case 51:case"end":return t.stop()}var l,x}),t,this,[[3,47]])})))}},{key:"_clearTimer",value:function(){clearTimeout(this._connectionTimeoutId),clearTimeout(this._uptimeTimeoutId),this._connectionTimeoutId=null,this._uptimeTimeoutId=null}},{key:"_clearPingTimer",value:function(){clearTimeout(this._pingPongTimeoutId),clearTimeout(this._reconnectTimeoutId),this._pingPongTimeoutId=null,this._reconnectTimeoutId=null}},{key:"_debug",value:function(){if(this._options.debug)for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]}},{key:"_getIntervalValue",value:function(e){var t=this._options,n=t.initReconnectInterval,i=t.maxReconnectInterval,o=t.reconnectIntervalGrowFactor,r=n*Math.pow(o,e-1);return r>i?i:r}},{key:"_ping",value:function(){var e=this;this._ws&&this._ws.readyState===this.CONNECTING?this._pingPongTimeoutId=q((function(){return e._ping()}),this._options.pingInterval):this._ws&&this._ws.readyState===this.OPEN?(this._ws&&this._ws.send("hi"),this._reconnectTimeoutId=q((function(){return e._handleReconnect()}),this._options.pingTimeoutInterval)):this._handleReconnect()}},{key:"_navigatorOnline",value:function(){return this._isMiniTT||this._isMiniWX?this._miniNavigatorOnline:!this._isBrowser&&!this._isWorker||navigator.onLine}},{key:"_handleReconnect",value:function(){var e;this._navigatorOnline()&&!this._readyClosed&&(null===(e=this._endpointManager)||void 0===e||e.resetEndpointConfig(),this._ws?this._disconnect(1001,"going away, try reconnecting server",!0):this._connect())}},{key:"_onPageNetWorkChange",value:function(){var e=this;this._isMiniTT?tt.onNetworkStatusChange((function(t){var n=t.isConnected;e._miniNavigatorOnline=n,n?e._handleOnLine():e._handleOffLine()})):this._isMiniWX&&wx.onNetworkStatusChange((function(t){var n=t.isConnected;e._miniNavigatorOnline=n,n?e._handleOnLine():e._handleOffLine()}))}},{key:"_wait",value:function(e){var t=this;return new g((function(n){q(n,t._getIntervalValue(e))}))}},{key:"_disconnect",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1e3,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",n=arguments.length>2&&arguments[2]!==undefined&&arguments[2];this._ws&&this._destroyWebSocket(e,t,n)}},{key:"_onTimeout",value:function(){var e,t=null===(e=this._endpointManager)||void 0===e?void 0:e.getCurrentEndpoint();this._debug("connect ".concat(t," timeout")),this._disconnect(1001,"timeout, try reconnecting",!0)}},{key:"_sendAck",value:function(e){var t=me(e);this._ws&&this._ws.readyState===this.OPEN&&(this._ws&&this._ws.send(t),this._debug("send_ack",e))}},{key:"_removeWsListeners",value:function(){this._ws&&(this._ws.removeEventListener("open",this._onOpen),this._ws.removeEventListener("close",this._onClose),this._ws.removeEventListener("message",this._onMessage),this._ws.removeEventListener("error",this._onError))}},{key:"_addWsListeners",value:function(){this._ws&&(this._ws.addEventListener("open",this._onOpen),this._ws.addEventListener("close",this._onClose),this._ws.addEventListener("message",this._onMessage),this._ws.addEventListener("error",this._onError))}},{key:"_wsInstanceClose",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1e3,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";try{this._ws&&this._ws.close(e,t)}catch(n){}}},{key:"_destroyWebSocket",value:function(){var e,t,n,i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1e3,o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",r=arguments.length>2&&arguments[2]!==undefined&&arguments[2];if(this._clearPingTimer(),this._clearTimer(),this._removeWsListeners(),this._wsInstanceClose(1e3,o),this._connectLock=!1,r&&this._navigatorOnline()&&!this._readyClosed)if(null===(e=this._endpointManager)||void 0===e?void 0:e.checkReachMaxTries()){var a=null===(t=this._endpointManager)||void 0===t?void 0:t.getCurrentEndpoint();this._dispatchCloseEvent(Ne("close",{code:1006,reason:"connect ".concat(a," timeout, max retries reached"),wasClean:!0}))}else this._options.reconnectInterceptor(i,o)&&this._connect(),this._dispatchCloseEvent(Ne("close",{code:i,reason:o,wasClean:!0}));else this._navigatorOnline()||this._readyClosed?this._dispatchCloseEvent(Ne("close",{code:i,reason:"bye"})):this._dispatchCloseEvent(Ne("close",{code:1006,reason:"going away, network offline"})),this._ws=null,null===(n=this._endpointManager)||void 0===n||n.resetEndpointConfig()}},{key:"_dispatchOpenEvent",value:function(e){this.emit("open",e),this.onopen&&this.onopen(e)}},{key:"_dispatchMessageEvent",value:function(e){this.emit("message",e),this.onmessage&&this.onmessage(e)}},{key:"_dispatchAckMessageEvent",value:function(e){this.emit("ack",e),this.onReceiveAck&&this.onReceiveAck(e)}},{key:"_dispatchErrorEvent",value:function(e){this.emit("error",e),this.onerror&&this.onerror(e)}},{key:"_dispatchCloseEvent",value:function(e){this.emit("close",e),this.onclose&&this.onclose(e)}},{key:"binaryType",get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)}},{key:"retryCount",get:function(){var e;return(null===(e=this._endpointManager)||void 0===e?void 0:e.getCurrentEndpointTriesCount())||0}},{key:"bufferedAmount",get:function(){var e;return j(e=this._messageQueue).call(e,(function(e,t){return e+=t&&t.byteLength||0}),0)+(this._ws?this._ws.bufferedAmount:0)}},{key:"extensions",get:function(){return this._ws?this._ws.extensions:""}},{key:"protocol",get:function(){return this._ws?this._ws.protocol:""}},{key:"readyState",get:function(){return this._ws?this._ws.readyState:this._options.automaticOpen?this.CONNECTING:this.CLOSED}},{key:"url",get:function(){return this._ws?this._ws.url:""}},{key:"close",value:function(){var e,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1e3,n=arguments.length>1?arguments[1]:undefined;if(this._readyClosed=!0,this._clearTimer(),this._clearPingTimer(),null===(e=this._qosDB)||void 0===e||e.closeDB(),this._ws)if(this._ws.readyState!==this.CLOSED&&this._ws.readyState!==this.CLOSING)this._destroyWebSocket(t,n);else{this._debug("close, ws already closed");var i=Ne("close",{code:1e3,reason:"ws already closed",wasClean:!0});this._dispatchCloseEvent(i)}else{this._debug("close, ws instance not initialized");var o=Ne("close",{code:1e3,reason:"ws instance not initialized",wasClean:!0});this._dispatchCloseEvent(o)}}},{key:"send",value:function(e,n){return t(this,void 0,void 0,l.mark((function t(){var o,r,a,s,c,u,d,f,h,p,_,m,v,g,E,b,y,w,S;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}throw new Error("please provide a valid data, data must be a string or an arraybuffer");case 2:return"number"==typeof e&&(e=O(e)),"string"==typeof e||e instanceof ArrayBuffer||e.buffer&&e.buffer instanceof ArrayBuffer||(e=O(e)),t.next=6,Je(e);case 6:if(o=t.sent,r=kt(e),s=(a=n||{}).method,c=void 0===s?0:s,u=a.service,d=void 0===u?this._options.service:u,f=a.logID,h=void 0===f?this._options.logIDGenerator():f,p=a.headers,_=void 0===p?this._options.headers:p,m=a.payloadEncoding,v=void 0===m?this._options.payloadEncoding:m,g=a.payloadType,E=void 0===g?this._options.payloadType:g,b=a.logIDNew,y=void 0===b?this._options.logIDNewConfig.enableAutoGenerateLogIDNew?i(this._options.logIDNewConfig.userIp):"":b,d){t.next=11;break}throw new Error("please provide a valid service");case 11:return w={SeqID:we.fromNumber(this._seqId++),LogID:we.fromNumber(h),service:d,method:c,headers:_,payloadEncoding:v instanceof Object?v.encoding?v.encoding:"":v,payloadType:E instanceof Object?E.type?E.type:r:E||r,payload:o,LogIDNew:y},S=me(w),this._ws&&this._ws.readyState===this.OPEN?(this._ws&&this._ws.send(S),this._debug("sent",w)):this._messageQueue.length<this._options.maxMessageQueueLength?(this._messageQueue.push(S),this._debug("enqueue",w)):(this._messageQueue.shift(),this._messageQueue.push(S)),t.abrupt("return",this._seqId);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"reconnect",value:function(e){var n;return t(this,void 0,void 0,l.mark((function t(){var i,o;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(e||{}).url,o=U(i)?i:"string"==typeof i?[i]:[],e&&V(this._options,e),o&&o.length?this._endpointManager=new Ge(o,this._options.maxRetries):null===(n=this._endpointManager)||void 0===n||n.resetEndpointConfig(),this._readyClosed=!1,this._ws&&this._ws.readyState!==this.CLOSED?this._disconnect(1e3,"manual reconnecting",!0):(this._isInit=!0,this._connect());case 6:case"end":return t.stop()}}),t,this)})))}},{key:"connect",value:function(){var e;return t(this,void 0,void 0,l.mark((function t(){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._connectLock||(null===(e=this._endpointManager)||void 0===e||e.resetEndpointConfig(),this._readyClosed=!1,this._isInit=!0,this._connect());case 1:case"end":return t.stop()}}),t,this)})))}},{key:"addEventListener",value:function(e,t){this.on(e,t)}},{key:"dispatchEvent",value:function(e){var t=e.type;this.emit(t,e)}},{key:"removeEventListener",value:function(e,t){this.off(e,t)}}]),a}(ze);e.CustomCloseEvent=Le,e.CustomErrorEvent=Ae,e.Event=xe,e.FWS=At,e.FrontierMessageEvent=Pe,e.MessageEvent=De,e.OpenEvent=Re,e.ReconnectEvent=Ie,e.createCloseEvent=Ne,e.createErrorEvent=Me,e.decodedFrame=_e,e.encodeFrame=me,H(e,"__esModule",{value:!0})},"object"===W(t)?a(t):(o=[t],(r="function"==typeof(i=a)?i.apply(t,o):i)===undefined||(e.exports=r))},89282:function(e,t,n){"use strict";var i,o=n(42404),r=n(84639),a=n(76569),s=n(35221),c=n(99052),u=n(50750),l=n(92524),d=n(94090),f=n(88743),h=n(34346),p=n(21155),_=n(31674),m=n(82766),v=n(8369),g=n(68493),E=n(85792),b=n(8e3),y=n(11227),w=n(58144),S=n(95140),C=n(56038).default;function k(e){return e&&"object"==C(e)&&"default"in e?e.default:e}o(t,"__esModule",{value:!0});var T=n(98636),O=n(77495),x=n(85983),I=n(69076),A=k(n(73836)),L=k(n(71182)),D=k(n(98556)),P=k(n(77386)),R=n(99388),M=k(n(94386));function N(){var e;return(N=r?a(e=r).call(e):function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function G(e,t){var n,i,o;e.prototype=s(t.prototype),e.prototype.constructor=e,i=e,o=t,(c?a(n=c).call(n):function(e,t){return e.__proto__=t,e})(i,o)}function B(e,t){if(null==e)return{};var n,i,o={},r=u(e);for(i=0;i<r.length;i++)l(t).call(t,n=r[i])>=0||(o[n]=e[n]);return o}var q={SEND_MOBILE_CODE:"/passport/web/send_code/",SEND_EMAIL_CODE:"/passport/web/email/send_code/",VERIFY_MOBILE_CODE:"/passport/web/validate_code/",VERIFY_EMAIL_CODE:"/passport/web/email/verify/",CHECK_MOBILE_CODE:"/passport/web/mobile/check_code/",CHECK_EMAIL_CODE:"/passport/web/email/check_code/",SMS_LOGIN:"/passport/web/sms_login/",SMS_LOGIN_ONLY:"/passport/web/sms_login_only/",SMS_LOGIN_CONTINUE:"/passport/web/sms_login_continue/",EMAIL_LOGIN:"/passport/web/email/login/",EMAIL_CODE_LOGIN:"/passport/web/email/code_login/",EMAIL_CODE_QUICK_LOGIN:"/passport/web/email/quick_login/",EMAIL_REGISTER_LOGIN:"/passport/web/email/register_verify_login/",EMAIL_REGISTER:"/passport/web/email/register_verify/",PWD_LOGIN:"/passport/web/user/login/",AUTH_LOGIN:"/passport/web/auth/login/",AUTH_LOGIN_ONLY:"/passport/web/auth/login_only/",AUTH_BIND_ONLY:"/passport/web/auth/bind_login/",MOBILE_BIND_ONLY:"/passport/web/mobile/bind_login/",MOBILE_EMAIL_REGISTER:"/passport/web/mobile_email_register/",MOBILE_REGISTER:"/passport/mobile/register/",MOBILE_OAUTH:"/passport/auth/show_oauth_mobile/",LOGOUT:"/passport/web/logout/",CHECK_LOGIN:"/passport/account/info/v2/",BIND_WITH_MOBILE_LOGIN:"/passport/web/auth/bind_with_mobile_login/",BIND_WITH_EMAIL_LOGIN:"/passport/web/auth/bind_with_email_login/",GET_QRCODE:"/passport/web/get_qrcode/",CHECK_QRCONNECT:"/passport/web/check_qrconnect/",SCAN_QRCODE:"/passport/web/scan_qrcode/",CONFIRM_QRCODE:"/passport/web/confirm_qrcode/",THIRD_AUTH:"/passport/web/web_login/",WEB_SHARE_LOGIN:"/passport/web/auth/share_login/",AUTH_LOGIN_URL:"/passport/auth/wap_login/",EMAIL_REGISTER_NO_VERIFY:"/passport/web/email/register/",EMAIL_REGISTER_NO_VERIFY_V2:"/passport/web/email/register/v2/",GET_QRCODE_FROM_WECHAT:"/passport/web/wechat/get_qrcode/",CHECK_QRCODE_FROM_WECHAT:"/passport/web/wechat/check_qrcode_status/",MOBILE_BIND:"/passport/web/mobile/bind/",EMAIL_BIND:"/passport/web/email/bind/",AUTH_BIND:"/passport/web/auth/bind/",AUTH_UNBIND:"/passport/web/auth/unbind/",AUTH_SWITCH_BIND:"/passport/web/auth/switch_bind/",MOBILE_REBIND:"/passport/web/mobile/change/",EMAIL_REBIND:"/passport/web/email/change/",RESET_PWD_BY_MOBILE:"/passport/web/password/reset/",RESET_PWD_BY_EMAIL:"/passport/web/email/password/reset/",RESET_PWD_BY_MOBILE_TICKET:"/passport/web/password/reset_by_ticket/",RESET_PWD_BY_EMAIL_TICKET:"/passport/web/password/reset_by_email_ticket/",PWD_CHANGE_BY_MOBILE:"/passport/web/password/change/",PWD_UPDATE:"/passport/web/password/update/",PWD_CHANGE_BY_EMAIL:"/passport/web/email/change_password/",PWD_SET:"/passport/web/password/set/",PWD_HAS_SET:"/passport/password/has_set/",PWD_HAS_SET_V2:"/passport/web/password/has_set/",PWD_SET_BY_EAMIL_AND_LOGIN:"/passport/web/email/password/reset_and_login/",ACCOUNT_VERIFY:"/passport/web/account/verify/",AUTH_VERIFY:"/passport/web/auth/verify/",SMS_AUTHORIZE:"/passport/web/sms/authorize/",CANCEL_VERIFY_WAY:"/passport/auth/cancel_verify_way/",CANCEL_CHECK:"/passport/web/cancel/check/",CANCEL_CONFIRM:"/passport/web/cancel/confirm/",CANCEL_REQUEST_CANCEL:"/passport/web/cancel/login/",CHECK_MOBILE_REGISTER:"/passport/web/user/check_mobile_registered/",CHECK_EMAIL_REGISTER:"/passport/web/user/check_email_registered",CHANGE_QRCODE_SUCCESS:"/passport/qrcode_twostep_verify/scan_qrcode/",CHANGE_QRCODE_CONFIRM:"/passport/qrcode_twostep_verify/confirm_by_ticket/",GET_OPEN_AUTH_INFO:"/passport/open/auth_info/v2/",OPEN_SEND_CODE:"/passport/open/send_code/",OPEN_SMS_AUTH:"/passport/open/web/sms/auth/",OPEN_ACCOUNT_AUTH:"/passport/open/web/account/auth/",OPEN_THIRD_AUTH:"/passport/open/web/third_party/auth/",OPEN_GET_QRCODE:"/passport/open/get_qrcode/",OPEN_CHECK_QRCODE:"/passport/open/check_qrcode",OPEN_TO_SCAN_QRCODE:"/passport/open/to_scan_qrcode/",OPEN_SCAN_QRCODE:"/passport/open/scan_qrcode/",OPEN_CONFIRM_QRCODE:"/passport/open/confirm_qrcode/",OPEN_WEB_AUTH:"/passport/open/web/auth/",GET_OPEN_OAUTH_TOKEN:"/passport/web/auth/get_oauth_token/",OPEN_UPDATE_AUTHORIZE_INFO:"/passport/web/auth/update_authorize_info/",PLATFORM_OAUTH_CONNECT:"/platform/oauth/connect/",ACCOUNT_INFO:"/passport/web/account/info/",ACCOUNT_SET:"/passport/web/account/set/",OAUTH_PROFILE:"/web/user/get/oauth_profile/",UPLOAD_AVATAR:"/web/user/update/upload_avatar/",UPDATE_USERINFO:"/web/user/update/user_info/",CHECK_DEFAULT_INFO:"/web/user/check/default_info/",GET_BACKGROUND_LIST:"/web/user/settings/{aid}/default_background_image_list/",GET_DEFAULT_AVATAR_LIST:"/web/user/settings/{aid}/default_avatar_list/",GET_RECOMMEND_NAME:"/web/user/settings/recommend_name/",UPLOAD_PICTURE:"/web/user/upload/pic/",CHECK_REMAIN_TIMES:"/web/user/get/remain_update_times/",DOWNLOAD_IMAGE:"/user/web/download/image/",DOWNLOAD_IMAGE_V2:"/user/web/download/image/v2/"},U={SEND_MOBILE_CODE:"/passport/aff/web/mobile/send_code/",SEND_EMAIL_CODE:"/passport/aff/web/email/send_code/",VERIFY_MOBILE_CODE:"/passport/aff/web/mobile/validate_code/",VERIFY_EMAIL_CODE:"/passport/aff/web/email/verify/",CHECK_MOBILE_CODE:"/passport/aff/web/mobile/check_code/",CHECK_EMAIL_CODE:"/passport/aff/web/email/check_code/",SMS_LOGIN:"/passport/aff/web/mobile/sms_login/",EMAIL_LOGIN:"/passport/aff/web/email/code_login/",PWD_LOGIN:"/passport/aff/web/user/login/",OAUTH_LOGIN_CALL:"/passport/aff/web/oauth/login/call/",OAUTH_LOGIN_ONLY:"/passport/aff/web/oauth/login_only/",OAUTH_LOGIN:"/passport/aff/web/oauth/login/",SUBJECT_LOGIN_LIST:"/passport/aff/web/subject/login_list/",SUBJECT_LOGIN:"/passport/aff/web/subject/login/",LOGOUT:"/passport/aff/web/logout/",REGISTER_EMAIL_USER_ONLY:"/passport/aff/web/email/register/only_user/",REGISTER_EMAIL:"/passport/aff/web/email/register/",REGISTER_MOBILE_USER_ONLY:"/passport/aff/web/mobile/register/only_user/",REGISTER_MOBILE:"/passport/aff/web/mobile/register/",RESET_BY_MOBILE:"/passport/aff/web/mobile/password/reset/",RESET_BY_EMAIL:"/passport/aff/web/email/password/reset/",MOBILE_INVITE:"/passport/aff/web/invitation/mobile/invite/",EMAIL_INVITE:"/passport/aff/web/invitation/email/invite/",LARK_INVITE:"/passport/aff/web/invitation/lark/invite/",INVITE_LIST:"/passport/aff/web/invitation/list/",CANCEL_INVITE:"/passport/aff/web/invitation/cancel/",RESEND_INVITE:"/passport/aff/web/invitation/resend/",UPDATE_INVITE:"/passport/aff/web/invitation/update/",CHECK_INVITE_VALID:"/passport/aff/web/invitation/check/",ACCEPT_INVITE:"/passport/aff/web/invitation/accept/",CREATE_BY_USERNAME:"/passport/aff/web/subject/username/create/",CREATE_BY_MOBILE:"/passport/aff/web/subject/mobile/create/",CREATE_BY_EMAIL:"/passport/aff/web/subject/email/create/",SUBJECT_LIST:"/passport/aff/web/subject/all/list/",SUBJECT_DEPUTY_LIST:"/passport/aff/web/subject/deputy/list/",SUBJECT_IDENTITY_LIST:"/passport/aff/web/subject/identity/list/",UPDATE_DEPUTY_INFO:"/passport/aff/web/deputy/update/",FREEZE_DEPUTY:"/passport/aff/web/deputy/freeze/",DELETE_DEPUTY:"/passport/aff/web/deputy/delete/",UPDATE_SUBJECT_INFO:"/passport/aff/web/subject/update/",FREEZE_SUBJECT:"/passport/aff/web/subject/freeze/",RESOURCE_LIST:"/passport/aff/web/resource/list/",CREATE_ROLE:"/passport/aff/web/role/create/",UPDATE_ROLE:"/passport/aff/web/role/update/",BAN_ROLE:"/passport/aff/web/role/ban/",ROLE_LIST:"/passport/aff/web/role/list/",ROLE_INFO:"/passport/aff/web/role/info/",CREATE_USER_WITH_ROLE:"/passport/aff/web/user/create_with_role/",ADD_USER_ROLE:"/passport/aff/web/user_role/add/",DELETE_USER_ROLE:"/passport/aff/web/user_role/del/",USER_ROLE_LIST:"/passport/aff/web/user_role/list/",ALL_USER_ROLE_LIST:"/passport/aff/web/user_role/all/list/",USER_PERMISSIONS:"/passport/aff/web/user/permissions/",SUCCESSOR_SEND_CODE:"/passport/aff/web/admin/successor/send_code/",TRANSFER_MANAGER:"/passport/aff/web/admin/transfer/",MEMBER_SWITCH:"/passport/aff/web/member/switch/"},V={MOBILE_CODE_URL:"/send_activation_code/",MOBILE_CODE_URL_V2:"/send_activation_code/v2/",EMAIL_ACTIVATE_URL:"/send_email_activate_link/",EMAIL_ACTIVATE_URL_V2:"/send_email_activate_link/v2/",EMAIL_ACTIVATE_CODE_URL:"/send_email_activate_code/",EMAIL_ACTIVATE_CODE_URL_V2:"/send_email_activate_code/v2/",CHECK_LOGIN:"/check_login/",MOBILE_CODE_LOGIN_URL:"/quick_login/",MOBILE_CODE_LOGIN_URL_V2:"/quick_login/v2/",MOBILE_CODE_LOGIN_ONLY_URL:"/quick_login_only/",ACCOUNT_LOGIN_URL:"/account_login/",ACCOUNT_LOGIN_URL_V2:"/account_login/v2/",AUTH_LOGIN_URL:"/passport/auth/wap_login/",BIND_WITH_MOBILE_LOGIN:"/bind_with_mobile_login/",AUTH_LOGIN:"/auth/login/",AUTH_LOGIN_ONLY:"/auth/login_only/",LOGOUT:"/logout/",EMAIL_ACTIVATE_CODE_LOGIN:"/activate_email/code_login/",EMAIL_REGISTER:"/activate_email/register/",EMAIL_REGISTER_V2:"/activate_email/register/v2/",MOBILE_REGISTER_WITH_EMAIL:"/register/",MOBILE_REGISTER_WITH_EMAIL_V2:"/register/v2/",SSO_EMAIL_ACTIVATE_CODE_URL:"/sso/send_email_activate_code/",RESET_PASSWORD:"/reset_password/",RESET_PASSWORD_BY_EMAIL:"/activate_email/reset_password/",BIND_MOBILE:"/bind_mobile/",CHANGE_MOBILE:"/change_mobile/",QUICK_AUTH:"/quick_auth/",GET_QRCODE:"/get_qrcode/",CHECK_QRCONNECT:"/check_qrconnect/",SCAN_QRCODE:"/scan_qrcode/",CONFIRM_QRCODE:"/confirm_qrcode/",MOBILE_EMAIL_REGISTER:"/mobile_email_register/"};function j(e){var t,n,i=window.byted_acrawler,o=d(t=[]).call(t,f(q),f(U),f(V)),r=h(n=f(V)).call(n,(function(e){return[e,"/passport/sso"+e]}))||[];i&&i.init({aid:e.aid,isSDK:!0,boe:e.isBoe||!1,enablePathList:o,urlRewriteRules:r})}function z(e,t){var n="https://lf3-cdn-tos.bytescm.com/obj/rc-web-sdk/webmssdk.js";"gcp"===e||"giso"===e?n="https://sf16-secsdk.ibytedtos.com/obj/rc-web-sdk-giso/webmssdk/1.0.0.303/webmssdk.js":"sg"===e?n="https://sf16-secsdk.ibytedtos.com/obj/rc-web-sdk-sg/webmssdk/1.0.0.303/webmssdk.js":"va"!==e&&"gcs"!==e||(n="https://sf16-secsdk.ibytedtos.com/obj/rc-web-sdk-gcs/webmssdk/1.0.0.303/webmssdk.js"),window.byted_acrawler?j(t):function(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=globalThis.xssNamespace.douyin_web.filterUrl(e,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),document.getElementsByTagName("head")[0].appendChild(n),n.readyState?n.onreadystatechange=function(){"complete"!==n.readyState&&"loaded"!==n.readyState||(n.onreadystatechange=null,t&&t())}:n.onload=function(){t&&t()}}(n,(function(){j(t)}))}function H(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):""}function W(e,t,n){var i;void 0===n&&(n=!0),t&&p(i=u(t)).call(i,(function(e){}))}function F(e){var t;return h(t=u(e)).call(t,(function(t){var n=e[t];return"object"==C(n)?encodeURIComponent(t)+"="+encodeURIComponent(_(n)):encodeURIComponent(t)+"="+encodeURIComponent(n)})).join("&")}function K(e){var t;if(!e)return{};var n={};return p(t=e.split("&")).call(t,(function(e){var t=e.split("=");n[t[0]]=t[1]})),n}var $=function(e){var t,n=[];if(void 0===e)return"";t=function(e){for(var t,n=e.toString(),i=[],o=0;o<n.length;o++)0<=(t=n.charCodeAt(o))&&t<=127?i.push(t):128<=t&&t<=2047?(i.push(192|31&t>>6),i.push(128|63&t)):(2048<=t&&t<=55295||57344<=t&&t<=65535)&&(i.push(224|15&t>>12),i.push(128|63&t>>6),i.push(128|63&t));for(var r=0;r<i.length;r++)i[r]&=255;return i}(e);for(var i=0,o=t.length;i<o;++i)n.push((5^t[i]).toString(16));return n.join("")},Y=function(e,t){var n,i=0,o=0;if("object"!=C(e))return e;if(!t||t.length<=0)return e;for(var r=N({mix_mode:i},e),a=0,s=t.length;a<s;++a)void 0!==(n=r[t[a]])&&(i|=1,o|=1,r[t[a]]=$(n));return r.mix_mode=i,r.fixed_mix_mode=o,r},Q=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t=-1);var i=m(n=u(e)).call(n)||[];return t>=0&&v(i).call(i,t),{str:h(i).call(i,(function(t){var n=e[t];return"object"==C(n)?t+"="+_(n):t+"="+n})).join("&"),arr:i}},J=function(e,t,n){if(void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=""),!n)return{};var i=Q(e,10),o=i.str,r=void 0===o?"":o,a=i.arr,s=void 0===a?[]:a,c=Q(t).str,u=A(r+"&"+(void 0===c?"":c)+"&app_key="+n);return{sign:L.stringify(u),qs:$(s.join(","))}},X=function(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyz",n="",i=e;i>0;--i)n+=t[Math.floor(36*Math.random())];return n},Z={};function ee(e){return Z[e]}var te,ne,ie,oe,re=["request"],ae={aid:0,iid:"0",did:"0"},se={sideSlide:"disabled",lang:"zh",showMode:"mask",region:"cn",app_name:""},ce={cn:T,sg:O,va:x,in:I},ue=h(i=[98,111,101,45,118,101,114,105,102,121,46,98,121,116,101,100,97,110,99,101,46,110,101,116]).call(i,(function(e){return String.fromCharCode(e)})).join(""),le=function(e){var t=e.requestConfig,n=e.verifyData,i=e.requestData,o={};try{o=JSON.parse(n)}catch(e){}return new g((function(e,n){ie.render({verify_data:o,captchaOptions:{successCb:function(){try{return g.resolve(ie.getFp()).then((function(i){var o;null===(o=te)||void 0===o||o(N({},t,{params:N({},t.params,{isResend:!0,fp:i,verifyFp:i})})).then((function(t){e(t)})).catch((function(e){n(e)}))}))}catch(e){return g.reject(e)}},closeCb:function(){n("CLOSE_CAPTCHA")}},secondVerifyWebOptions:{callBack:function(o){try{var r,a=t.data||"";return i&&(a=F(N({},K(a),i))),null===(r=te)||void 0===r||r(N({},t,{params:N({},t.params,{isResend:!0}),data:a})).then((function(t){e(t)})).catch((function(e){n(e)})),g.resolve()}catch(e){return g.reject(e)}},closeCallBack:function(){n({description:"SECOND_VALID",requestData:i})}}})}))},de=["request","aid"],fe=function(){function e(e){this.accountApiSlardar=R.createBrowserClient(),this.accountApiSlardar("init",{bid:"passport_account_api",pid:""+e,release:"2.2.7-beta.6",env:"production",plugins:{tti:!1,performance:!1,resource:!1,pageview:!1,jsError:{onerror:!1,onunhandledrejection:!1,dedupe:!1,captureGlobalAsync:!1},breadcrumb:{dom:!1},ajax:{autoWrap:!1,ignoreUrls:[/^((?!\/passport\/).)*$/],collectBodyOnError:!0},fetch:{autoWrap:!1,ignoreUrls:[/^((?!\/passport\/).)*$/],collectBodyOnError:!0},blankScreen:{autoDetect:!1,screenshot:!1}}}),this.accountApiSlardar("start"),this.accountApiSlardar("sendEvent",{name:"passport_account_api"})}e.initSlardar=function(t){return this._instance||(this._instance=new e(t)),this._instance},e.getSlardar=function(){return this._instance},e.clearSlardar=function(){this._instance=null};var t=e.prototype;return t.dot=function(e){this.accountApiSlardar("sendEvent",e)},t.log=function(e){this.accountApiSlardar("sendLog",e)},t.throw=function(e,t){this.accountApiSlardar("captureException",e,t)},e}(),he=["isResend"],pe={web:{respHandler:function(e){return"success"===(null==e?void 0:e.message)},successCallBack:function(e){return null==e?void 0:e.data},failCallBack:function(e){return null==e?void 0:e.data}},sso:{respHandler:function(e){return 0===(null==e?void 0:e.error_code)},successCallBack:function(e){return"success"===(null==e?void 0:e.message)?e.data:e},failCallBack:function(e){return e}},app:{},auth:{respHandler:function(e){return 0===(null==e?void 0:e.status_code)},successCallBack:function(e){return e.data},failCallBack:function(e){return e}}},_e=function(e){null==e||null===(t=e.config)||void 0===t||t.url;var t,n,i,o=(null==e||null===(n=e.headers)||void 0===n?void 0:n["x-tt-logid"])||"",r=function(e){var t,n,i=(null==e||null===(t=e.data)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.response)||(null==e?void 0:e.data)||{};if("string"==typeof i)try{i=JSON.parse(i)}catch(e){}return i}(e),a=ee("initProps"),s=(null==a?void 0:a.printLog)||!1;if("success"===(null==r?void 0:r.message))return s&&W(0,{SUCCESS:r.data,Logid:o},!1),g.resolve(r.data);s&&W(0,{ERROR:r.data,Logid:o},!1);var c=null==r||null===(i=r.data)||void 0===i?void 0:i.verify_center_decision_conf;return null!=a&&a.appShowCaptcha||!c?g.reject(N({},r.data,{log_id:o})):g.resolve(le({verifyData:c,requestConfig:null==e?void 0:e.config}))},me=function(e,t){var n;n=e,new g((function(e){Z.initProps=n,e(Z)})),this.request=new ve(e,t);var i,o,r,a=e.enabledMonitor,s=void 0===a||a;try{s&&(fe.clearSlardar(),fe.initSlardar(e.aid))}catch(e){}(function(e){var t=e.request,n=B(e,re);te=t,function(e){var t,n=e.isBoe,i=e.captchaOptions,o=void 0===i?{}:i,r=e.secondVerifyWebOptions,a=void 0!==n&&n?"//"+ue:void 0,s={commonOptions:N({},ae,{aid:e.aid,did:e.did?String(e.did):"0",iid:e.iid?String(e.iid):"0"}),captchaOptions:N({},se,{sideSlide:e.captchaSideSlide||"disabled",lang:e.language||"zh",showMode:e.captchaShowMode||"mask",region:e.region||"cn",app_name:e.appName||"",host:e.captchaHost||a||""},o),secondVerifyWebOptions:r};(ie=ce[e.region||"cn"]||T).init||(ie=null===(t=ie)||void 0===t?void 0:t.default),e.captchaConfig&&"function"==typeof ie.config&&ie.config(e.captchaConfig),ie.init(s,(function(){}),(function(){}))}(n)})(N({},e,{request:this.request})),o=(i=N({},e,{request:this.request})).request,r=i.aid,B(i,de),oe=o,D.init({aid:r})},ve=function(e,t){var n,i,o,a;return void 0===t&&(t="web"),null!==(n=ee("initProps"))&&void 0!==n&&n.fetch?(o=(i=ee("initProps")||{}).isBoe,(a=P.create(N({},i.axiosConfig,{baseURL:i.host||window&&(void 0!==o&&o?"http":"https")+"://"+window.location.hostname,adapter:function(e){var t=e.baseURL,n=e.url,i=e.method,o=void 0===i?"GET":i,r=e.params,a=void 0===r?{}:r,s=e.data,c=void 0===s?{}:s,u=ee("initProps"),l=u.fetch,d=(null==u?void 0:u.printLog)||!1,f=M.isValid(n)?n:t+n;return d&&W(0,{"data >>>>":c,"params >>>>":a},!1),l({url:f,method:o.toUpperCase(),params:N({},a,{is_native_h5:1}),data:c,needCommonParams:!0,header:{"x-tt-passport-csrf-token":H("passport_csrf_token")||H("passport_csrf_token_default")||""}}).then((function(t){return{data:t,status:200,statusText:"ok",config:e}}))},withCredentials:!0,transformRequest:[function(e){var t=e;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){}return t}]}))).interceptors.response.use(_e,void 0),a):function(e){var t=ee("initProps")||{},n=P.create(N({},t.axiosConfig,{baseURL:t.host||window&&(t.isBoe?window.location.protocol:"https:")+"//"+window.location.hostname,withCredentials:!0}));return n.interceptors.request.use((function(t){return function(e,t){void 0===t&&(t={});try{var n=ee("initProps"),i=(null==n?void 0:n.printLog)||!1;return g.resolve(function(){if(ne)return g.resolve(ne);try{var e,t=ee("initProps");if(null!=t&&null!==(e=t.captchaOptions)&&void 0!==e&&e.fp)return ne=t.captchaOptions.fp,t.captchaOptions.fp}catch(e){}return g.race([new g((function(e){E((function(){return e("")}),1e3)})),ie.getFp()]).then((function(e){return ne=e,e}))}()).then((function(o){var a,s,c,l,d,f=(null==n?void 0:n.appKey)||"",h=(null==e||e.url,(null==e?void 0:e.method)||"get"),_=(null==e?void 0:e.data)||{},m={"x-tt-passport-csrf-token":H("passport_csrf_token")||H("passport_csrf_token_default")||""},v=r({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json, text/javascript"},m,e.headers||{},{});if(e.headers=v,i&&W(0,{"%cdata >>>>":_,"%ccommon params >>>>":t}),null!==(d=e.params)&&void 0!==d&&d.isResend){var g=B(e.params,he);return N({},e,{params:g})}var E={};if(p(a=b(s=u(_)).call(s,(function(e){return void 0!==_[e]}))).call(a,(function(e){E[e]=_[e]})),y(c=["post","POST"]).call(c,h)){var w=N({},t,{verifyFp:o,fp:o},(null==e?void 0:e.params)||{}),S=J(w,E,f);e.params=N({},w,S),e.data="undefined"!=typeof FormData&&_ instanceof FormData?_:F(E)}if(y(l=["get","GET"]).call(l,h)){var C=N({},E,t,{verifyFp:o,fp:o},e.params),k=J(C,{},f);e.params=N({},C,k)}return e}))}catch(e){return g.reject(e)}}(t,e)}),void 0),n.interceptors.response.use((function(e){return function(e){var t,n,i,o,r,a,s,c,l,d,f,p,m=pe[e.config.params.account_sdk_source],v=(null==m?void 0:m.respHandler)||function(e){return"success"===(null==e?void 0:e.message)},E=(null==m?void 0:m.successCallBack)||function(e){return null==e?void 0:e.data},b=(null==m?void 0:m.failCallBack)||function(e){return null==e?void 0:e.data},y=(null==e||null===(t=e.config)||void 0===t?void 0:t.url)||"",w=(null==e||null===(n=e.headers)||void 0===n?void 0:n["x-tt-logid"])||"",S=(null==e?void 0:e.data)||{},k=ee("initProps"),T=(null==k?void 0:k.printLog)||!1;if("string"==typeof S)try{S=JSON.parse(S)}catch(e){}if(v(S))return T&&W(0,{"%cSUCCESS":E(S),"%cLogid":w}),g.resolve(E(S));var O,x=b(S),I=(null===(i=S)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.verify_center_decision_conf)||(null===(r=S)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.verify_center_secondary_decision_conf)||(null===(s=S)||void 0===s?void 0:s.verify_center_decision_conf)||(null===(c=S)||void 0===c?void 0:c.verify_center_secondary_decision_conf),A=(null===(l=S)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.error_code)||(null===(f=S)||void 0===f?void 0:f.error_code),L=null==x?void 0:x.url;T&&W(0,{"%cERROR":x,"%cLogid":w});try{var P=fe.getSlardar();null==P||P.dot({name:"request_error",metrics:{count:1},categories:{path:y,error_code:A}})}catch(e){}if(2046===A&&"function"==typeof(null==k||null===(p=k.secondVerifyWebOptions)||void 0===p?void 0:p.onValid))return null==k||null===(O=k.secondVerifyWebOptions)||void 0===O||O.onValid(),g.reject({description:"SECOND_VALID"});if(2046===A&&L)return function(e){try{var t=e.requestConfig,n=e.verifyDecision,i=n.biz_params,o=void 0===i?{}:i,r=t.data,a=void 0===r?"":r,s=t.params,c=void 0===s?{}:s;return g.resolve(D.verify(n)).then((function(e){if(null!=e&&e.status){var i,r=function(e,t,n){void 0===t&&(t={});var i,o=K(e);return i=N({},o,t),h(n=u(i)).call(n,(function(e){var t=i[e];return"object"==C(t)?e+"="+_(t):e+"="+t})).join("&")}(a,o);return null===(i=oe)||void 0===i?void 0:i(N({},t,{params:N({},c,{isResend:!0}),data:r}))}throw n}))}catch(e){return g.reject(e)}}({requestConfig:null==e?void 0:e.config,verifyDecision:x});if(I){var R,M,G,B=(null===(R=S)||void 0===R||null===(M=R.data)||void 0===M?void 0:M.sms_code_key)||(null===(G=S)||void 0===G?void 0:G.sms_code_key);return g.resolve(le({verifyData:I,requestConfig:null==e?void 0:e.config,requestData:2046===A&&B?{sms_code_key:B}:void 0})).then((function(e){return g.resolve(e)})).catch((function(e){return g.reject(e)}))}var q=b(S);return g.reject(N({},q,{log_id:w}))}(e)}),void 0),n}(function(e,t){var n,i=e.scene,o=e.aid,r=e.language,a=void 0===r?"":r,s=e.subjectAid,c=e.aff_multi_login,u=void 0===c?0:c,l=e.generalParams,d=void 0===l?{}:l;if("web"===t){var f={aid:o};"aff"===(void 0===i?"normal":i)&&(f.subject_aid=void 0===s?0:s),1===u&&(f.aff_multi_login=1),n=f}if("sso"===t||"auth"===t){var h={aid:o};1===u&&(h.aff_multi_login=1),n=h}if(n=N({},n,{account_sdk_source:t,sdk_version:"2.2.7-beta.6"}),d)try{n=N({},d,n)}catch(e){}return a&&(n=N({},n,{language:a})),n}(e,t))},ge=function(e){var t=this;this.sendCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,type:7},void 0===n?{}:n),["mobile","type"]);return t.request({url:U.SEND_MOBILE_CODE,method:"POST",data:i})},this.smsLogin=function(e){var n=e.need_frozen_user,i=e.extra_params,o=Y(N({mobile:e.mobile,code:e.code,need_frozen_user:void 0===n?0:n,type:7},void 0===i?{}:i),["mobile","type","code"]);return t.request({url:U.SMS_LOGIN,method:"POST",data:o})},this.sendEmailCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,type:13},void 0===n?{}:n),["email","type"]);return t.request({url:U.SEND_EMAIL_CODE,method:"POST",data:i})},this.emailLogin=function(e){var n=e.need_frozen_user,i=e.extra_params,o=Y(N({email:e.email,code:e.code,need_frozen_user:void 0===n?0:n,type:13},void 0===i?{}:i),["email","type","code"]);return t.request({url:U.EMAIL_LOGIN,method:"POST",data:o})},this.pwdLogin=function(e){var n,i,o=e.password,r=e.need_frozen_user,a=void 0===r?0:r,s=e.extra_params,c=void 0===s?{}:s,u=w(n=["email","username","mobile","account"]).call(n,(function(t){return!!e[t]}));if(!u)return g.reject();var l=Y(N(((i={password:o})[u]=e[u],i.need_frozen_user=a,i),c),["password",u]);return t.request({url:U.PWD_LOGIN,method:"POST",data:l})},this.oauthLoginCall=function(e){var t=e.platform_app_id,n=e.next,i=e.extra_params,o=void 0===i?{}:i,r=ee("initProps")||{},a=F(N({platform_app_id:t,next:n,aid:r.aid,subject_aid:r.subjectAid,account_sdk_source:"web"},o));window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(U.OAUTH_LOGIN_CALL+"?"+a,null,{logType:"js.window.location",mode:"black",reportOnly:!1})},this.oauthLogin=function(e){var n=e.need_frozen_user,i=e.login_only,o=e.extra_params;return t.request({url:void 0===i||i?U.OAUTH_LOGIN_ONLY:U.OAUTH_LOGIN,method:"POST",data:N({platform_app_id:e.platform_app_id,redirect_uri:e.redirect_uri,code:e.code,need_frozen_user:void 0===n?0:n},void 0===o?{}:o)})},this.subjectLoginList=function(e){void 0===e&&(e={});var n=e.extra_params;return t.request({url:U.SUBJECT_LOGIN_LIST,method:"GET",data:void 0===n?{}:n})},this.subjectLogin=function(e){var n=e.user_identity_id,i=e.extra_params,o=Y(N({login_subject_uid:e.login_subject_uid,user_identity_id:void 0===n?"0":n},void 0===i?{}:i),["login_subject_uid","user_identity_id"]);return t.request({url:U.SUBJECT_LOGIN,method:"POST",data:o})},this.logout=function(e){var n=e.next,i=void 0===n?"":n,o=e.not_redirect,r=void 0!==o&&o,a=ee("initProps")||{},s={account_sdk_source:"web",aid:a.aid,subject_aid:a.subjectAid,next:i};if(r)return t.request({url:U.LOGOUT,method:"GET",data:N({},s,{next:encodeURIComponent(s.next)})});window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(U.LOGOUT+"?"+F(s),null,{logType:"js.window.location",mode:"black",reportOnly:!1})},this.memberSwitch=function(e){var n=e.extra_params;return t.request({url:U.MEMBER_SWITCH,method:"POST",data:N({to_sec_member_id:e.to_sec_member_id},void 0===n?{}:n)})},this.request=e.request},Ee=["extra_params","only_user"],be=["extra_params","only_user"],ye=function(e){var t=this;this.sendEmailCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,type:1},void 0===n?{}:n),["email","type"]);return new g((function(e,n){t.request({url:U.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.verifyEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,type:1},void 0===n?{}:n),["email","code","type"]);return new g((function(e,n){t.request({url:U.CHECK_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.registerByEmail=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=e.only_user,r=void 0!==o&&o,a=B(e,Ee),s=Y(N({},a,i),["base_infos","subject_name","password","identity_card","real_name"]),c=r?U.REGISTER_EMAIL_USER_ONLY:U.REGISTER_EMAIL;return new g((function(e,n){t.request({url:c,method:"POST",data:s}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendMobileCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,type:1},void 0===n?{}:n),["mobile","type"]);return new g((function(e,n){t.request({url:U.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.verifyMobile=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,type:1},void 0===n?{}:n),["mobile","code","type"]);return new g((function(e,n){t.request({url:U.CHECK_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.registerByMobile=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=e.only_user,r=void 0!==o&&o,a=B(e,be),s=Y(N({},a,i),["base_infos","subject_name","password","identity_card","real_name"]),c=r?U.REGISTER_MOBILE_USER_ONLY:U.REGISTER_MOBILE;return new g((function(e,n){t.request({url:c,method:"POST",data:s}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.request=e.request},we=function(e){var t=this;this.sendEmailCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,type:4},void 0===n?{}:n),["email","type"]);return t.request({url:U.SEND_EMAIL_CODE,method:"POST",data:i})},this.sendMobileCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,type:6},void 0===n?{}:n),["mobile","type"]);return t.request({url:U.SEND_MOBILE_CODE,method:"POST",data:i})},this.mobileReset=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,password:e.password},void 0===n?{}:n),["mobile","code","password"]);return t.request({url:U.RESET_BY_MOBILE,method:"POST",data:i})},this.emailReset=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,password:e.password},void 0===n?{}:n),["email","code","password"]);return t.request({url:U.RESET_BY_EMAIL,method:"POST",data:i})},this.request=e.request},Se=["extra_params"],Ce=["extra_params"],ke=["extra_params"],Te=function(e){var t=this;this.mobileInvite=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Se),r=Y(N({},o,i),["mobile"]);return t.request({url:U.MOBILE_INVITE,method:"POST",data:r})},this.emailInvite=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Ce),r=Y(N({},o,i),["email"]);return t.request({url:U.EMAIL_INVITE,method:"POST",data:r})},this.larkInvite=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,ke),r=Y(N({},o,i),["email"]);return t.request({url:U.LARK_INVITE,method:"POST",data:r})},this.getInvitationList=function(e){var n=e.page,i=void 0===n?1:n,o=e.page_size,r=void 0===o?10:o,a=e.extra_params,s=void 0===a?{}:a;return new g((function(e,n){t.request({url:""+U.INVITE_LIST+i+"/",method:"GET",data:N({page_size:r},s)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.cancelInvitation=function(e){var n=e.invite_id,i=void 0===n?0:n,o=e.extra_params,r=void 0===o?{}:o;return new g((function(e,n){t.request({url:U.CANCEL_INVITE,method:"POST",data:N({invite_id:i},r)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.resendInvitation=function(e){var n=e.invite_id,i=void 0===n?0:n,o=e.next_url,r=void 0===o?"":o,a=e.link,s=void 0===a?"":a,c=e.extra_params,u=void 0===c?{}:c;return new g((function(e,n){t.request({url:U.RESEND_INVITE,method:"POST",data:N({invite_id:i,next_url:r,link:s},u)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.updateInvitation=function(e){var n=e.invite_id,i=e.extra_params,o=Y(N({invite_id:void 0===n?0:n,deputy_identity_id:e.deputy_identity_id,deputy_name:e.deputy_name},void 0===i?{}:i),["deputy_name"]);return new g((function(e,n){t.request({url:U.UPDATE_INVITE,method:"POST",data:o}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.checkRegisterStatus=function(e){var n=e.invite_ticket,i=e.extra_params,o=void 0===i?{}:i;return new g((function(e,i){t.request({url:U.CHECK_INVITE_VALID,method:"POST",data:N({invite_ticket:n},o)}).then((function(t){e(t)})).catch((function(e){i(e)}))}))},this.acceptInvitation=function(e){var n=e.extra_params,i=Y(N({invite_ticket:e.invite_ticket,password:e.password,extra:e.extra},void 0===n?{}:n),["password","extra"]);return t.request({url:U.ACCEPT_INVITE,method:"POST",data:i})},this.request=e.request},Oe=["extra_params"],xe=["extra_params"],Ie=["extra_params"],Ae=function(e){var t=this;this.createByUsername=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Oe),r=Y(N({},o,i),["subject_name","deputy_name","password","username","base_infos","detail_infos"]);return new g((function(e,n){t.request({url:U.CREATE_BY_USERNAME,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.createByMobile=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,xe),r=Y(N({},o,i),["subject_name","deputy_name","password","mobile","base_infos","detail_infos"]);return new g((function(e,n){t.request({url:U.CREATE_BY_MOBILE,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.createByEmail=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Ie),r=Y(N({},o,i),["subject_name","deputy_name","password","email","base_infos","detail_infos"]);return new g((function(e,n){t.request({url:U.CREATE_BY_EMAIL,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.getSubjectList=function(e){var n=e.page,i=void 0===n?1:n,o=e.page_size,r=void 0===o?10:o,a=e.deputy_identity_id,s=e.extra_params,c=void 0===s?{}:s;return new g((function(e,n){t.request({url:""+U.SUBJECT_LIST+i+"/",method:"GET",data:N({page_size:r,deputy_identity_id:a},c)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.getSubjectDeputyList=function(e){var n=e.page,i=void 0===n?1:n,o=e.page_size,r=void 0===o?10:o,a=e.extra_params,s=void 0===a?{}:a;return new g((function(e,n){t.request({url:""+U.SUBJECT_DEPUTY_LIST+i+"/",method:"GET",data:N({page_size:r},s)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.getSubjectIdentityList=function(e){var n=e.page,i=void 0===n?1:n,o=e.page_size,r=void 0===o?10:o,a=e.extra_params,s=void 0===a?{}:a;return new g((function(e,n){t.request({url:""+U.SUBJECT_IDENTITY_LIST+i+"/",method:"GET",data:N({page_size:r},s)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.updateDeputyInfo=function(e){var n=e.extra_params,i=Y(N({sec_user_id:e.sec_user_id,deputy_identity_id:e.deputy_identity_id,deputy_name:e.deputy_name,user_identity_id:e.user_identity_id},void 0===n?{}:n),["deputy_name","user_identity_id"]);return new g((function(e,n){t.request({url:U.UPDATE_DEPUTY_INFO,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.freezeDeputy=function(e){var n=e.is_frozen,i=e.extra_params,o=Y(N({sec_user_id:e.sec_user_id,user_identity_id:e.user_identity_id,is_frozen:void 0===n?0:n},void 0===i?{}:i),["sec_user_id","user_identity_id"]);return new g((function(e,n){t.request({url:U.FREEZE_DEPUTY,method:"POST",data:o}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.deleteDeputy=function(e){var n=e.extra_params,i=Y(N({sec_user_id:e.sec_user_id,user_identity_id:e.user_identity_id},void 0===n?{}:n),["user_identity_id"]);return new g((function(e,n){t.request({url:U.DELETE_DEPUTY,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.updateSubjectInfo=function(e){var n=e.extra_params,i=Y(N({sec_subject_uid:e.sec_subject_uid,subject_name:e.subject_name,base_infos:e.base_infos,detail_infos:e.detail_infos},void 0===n?{}:n),["sec_subject_uid","subject_name","base_infos","detail_infos"]);return new g((function(e,n){t.request({url:U.UPDATE_SUBJECT_INFO,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.freezeSubject=function(e){var n=e.is_frozen,i=e.extra_params,o=Y(N({sec_subject_uid:e.sec_subject_uid,is_frozen:void 0===n?0:n},void 0===i?{}:i),["sec_subject_uid"]);return new g((function(e,n){t.request({url:U.FREEZE_SUBJECT,method:"POST",data:o}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.request=e.request},Le=function(e){var t=this;this.getResourceList=function(e){var n=e.page,i=void 0===n?1:n,o=e.page_size,r=void 0===o?10:o,a=e.subject_uid,s=e.extra_params,c=void 0===s?{}:s;return new g((function(e,n){t.request({url:""+U.RESOURCE_LIST+i+"/",method:"GET",data:N({page_size:r,subject_uid:a},c)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.request=e.request},De=function(e){var t=this;this.createRole=function(e){var n=e.role_name,i=e.permissions,o=e.subject_uid,r=e.extra_params,a=void 0===r?{}:r;return new g((function(e,r){t.request({url:U.CREATE_ROLE,method:"POST",data:N({role_name:n,permissions:i,subject_uid:o},a)}).then((function(t){e(t)})).catch((function(e){r(e)}))}))},this.updateRole=function(e){var n=e.role_key,i=e.role_name,o=e.permissions,r=e.description,a=e.subject_uid,s=e.extra_params,c=void 0===s?{}:s;return new g((function(e,s){t.request({url:U.UPDATE_ROLE,method:"POST",data:N({role_key:n,role_name:i,permissions:o,description:r,subject_uid:a},c)}).then((function(t){e(t)})).catch((function(e){s(e)}))}))},this.banRole=function(e){var n=e.role_key,i=e.subject_uid,o=e.extra_params,r=void 0===o?{}:o;return new g((function(e,o){t.request({url:U.BAN_ROLE,method:"POST",data:N({role_key:n,subject_uid:i},r)}).then((function(t){e(t)})).catch((function(e){o(e)}))}))},this.getRoleList=function(e){var n=e.subject_uid,i=e.extra_params,o=void 0===i?{}:i;return new g((function(e,i){t.request({url:U.ROLE_LIST,method:"GET",data:N({subject_uid:n},o)}).then((function(t){e(t)})).catch((function(e){i(e)}))}))},this.getRoleInfo=function(e){var n=e.role_key,i=e.subject_uid,o=e.extra_params,r=void 0===o?{}:o;return new g((function(e,o){t.request({url:U.ROLE_INFO,method:"GET",data:N({role_key:n,subject_uid:i},r)}).then((function(t){e(t)})).catch((function(e){o(e)}))}))},this.request=e.request},Pe=function(e){var t=this;this.createUserWithRole=function(e){var n=e.role_key,i=e.sec_user_id,o=e.name,r=e.identity_id,a=e.subject_uid,s=e.extra_params,c=void 0===s?{}:s;return new g((function(e,s){t.request({url:U.CREATE_USER_WITH_ROLE,method:"POST",data:N({role_key:n,sec_user_id:i,name:o,identity_id:r,subject_uid:a},c)}).then((function(t){e(t)})).catch((function(e){s(e)}))}))},this.addUserRole=function(e){var n=e.role_key,i=e.sec_user_identity_ids,o=e.subject_uid,r=e.extra_params,a=void 0===r?{}:r;return new g((function(e,r){t.request({url:U.ADD_USER_ROLE,method:"POST",data:N({role_key:n,sec_user_identity_ids:i,subject_uid:o},a)}).then((function(t){e(t)})).catch((function(e){r(e)}))}))},this.deleteUserRole=function(e){var n=e.role_key,i=e.sec_user_identity_ids,o=e.subject_uid,r=e.extra_params,a=void 0===r?{}:r;return new g((function(e,r){t.request({url:U.DELETE_USER_ROLE,method:"POST",data:N({role_key:n,sec_user_identity_ids:i,subject_uid:o},a)}).then((function(t){e(t)})).catch((function(e){r(e)}))}))},this.getUserRoleList=function(e){var n=e.subject_uid,i=e.extra_params,o=void 0===i?{}:i;return new g((function(e,i){t.request({url:U.USER_ROLE_LIST,method:"GET",data:N({subject_uid:n},o)}).then((function(t){e(t)})).catch((function(e){i(e)}))}))},this.getAllUserRoleList=function(e){var n=e.subject_uid,i=e.identity_id,o=e.page,r=void 0===o?1:o,a=e.page_size,s=void 0===a?10:a,c=e.extra_params,u=void 0===c?{}:c;return new g((function(e,o){t.request({url:""+U.ALL_USER_ROLE_LIST+r+"/",method:"GET",data:N({subject_uid:n,identity_id:i,page_size:s},u)}).then((function(t){e(t)})).catch((function(e){o(e)}))}))},this.getUserPermissions=function(e){var n=e.subject_uid,i=e.extra_params,o=void 0===i?{}:i;return new g((function(e,i){t.request({url:U.USER_PERMISSIONS,method:"GET",data:N({subject_uid:n},o)}).then((function(t){e(t)})).catch((function(e){i(e)}))}))},this.request=e.request},Re=["extra_params"],Me=function(e){var t=this;this.sendCodeToOldManager=function(e){void 0===e&&(e={});var n=e.extra_params,i=Y(N({type:22},void 0===n?{}:n),["type"]);return new g((function(e,n){t.request({url:U.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendEmailCodeToOldManager=function(e){void 0===e&&(e={});var n=e.extra_params,i=Y(N({type:6},void 0===n?{}:n),["type"]);return new g((function(e,n){t.request({url:U.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.verifyOldManagerMobile=function(e){var n=e.extra_params,i=Y(N({code:e.code,type:22},void 0===n?{}:n),["code","type"]);return new g((function(e,n){t.request({url:U.VERIFY_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.verifyOldManagerEmail=function(e){var n=e.extra_params,i=Y(N({code:e.code,type:6},void 0===n?{}:n),["code","type"]);return new g((function(e,n){t.request({url:U.VERIFY_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendCodeToNewManager=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,verify_ticket:e.verify_ticket,type:101},void 0===n?{}:n),["mobile","type"]);return new g((function(e,n){t.request({url:U.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendEmailCodeToNewManager=function(e){var n=e.extra_params,i=Y(N({email:e.email,verify_ticket:e.verify_ticket,type:101},void 0===n?{}:n),["email","type"]);return new g((function(e,n){t.request({url:U.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.verifyNewManagerMobile=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,type:101},void 0===n?{}:n),["mobile","code","type"]);return new g((function(e,n){t.request({url:U.CHECK_MOBILE_CODE,method:"GET",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.verifyNewManagerEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,type:101},void 0===n?{}:n),["email","code","type"]);return new g((function(e,n){t.request({url:U.CHECK_EMAIL_CODE,method:"GET",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.transferManager=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Re);return t.request({url:U.TRANSFER_MANAGER,method:"POST",data:N({},o,i)})},this.request=e.request},Ne=["extra_params"],Ge=["extra_params"],Be=["extra_params"],qe=function(e){var t=this;this.sendCode=function(e){var n=e.registerOnly,i=e.extra_params,o=Y(N({mobile:e.mobile,type:void 0!==n&&n?16:24},void 0===i?{}:i),["mobile","type"]);return new g((function(e,n){t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:o}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.smsLogin=function(e){var n=e.login_only,i=void 0!==n&&n,o=e.extra_params,r=Y(N({mobile:e.mobile,code:e.code},void 0===o?{}:o),["mobile","code"]),a=i?q.SMS_LOGIN_ONLY:q.SMS_LOGIN;return new g((function(e,n){t.request({url:a,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.smsLoginContinue=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,sms_code_key:e.sms_code_key},void 0===n?{}:n),["mobile","sms_code_key"]);return new g((function(e,n){t.request({url:q.SMS_LOGIN_CONTINUE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.webLogin=function(e){var n=e.platform_app_id,i=e.next,o=e.extra_params,r=void 0===o?{}:o;return new g((function(e,o){t.request({url:q.SMS_LOGIN_CONTINUE,method:"POST",data:N({platform_app_id:n,next:i},r)}).then((function(t){e(t)})).catch((function(e){o(e)}))}))},this.emailLogin=function(e){var n=e.extra_params,i=Y(N({email:e.email,password:e.password},void 0===n?{}:n),["email","password"]);return new g((function(e,n){t.request({url:q.EMAIL_LOGIN,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.emailCodeLogin=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,ect_type:13},void 0===n?{}:n),["email","code"]);return t.request({url:q.EMAIL_CODE_LOGIN,method:"POST",data:i})},this.emailCodeQuickLogin=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code},void 0===n?{}:n),["email","code"]);return t.request({url:q.EMAIL_CODE_QUICK_LOGIN,method:"POST",data:i})},this.pwdLogin=function(e){var n=e.extra_params,i=Y(N({username:e.username,mobile:e.mobile,email:e.email,account:e.account,password:e.password},void 0===n?{}:n),["username","mobile","email","account","password"]);return t.request({url:q.PWD_LOGIN,method:"POST",data:i})},this.authLogin=function(e){var n=e.platform_app_id,i=e.code,o=e.access_token,r=e.access_token_secret,a=e.openid,s=e.profile_key,c=e.login_only,u=void 0!==c&&c,l=e.extra_params,d=void 0===l?{}:l;return new g((function(e,c){t.request({url:u?q.AUTH_LOGIN_ONLY:q.AUTH_LOGIN,method:"POST",data:N({platform_app_id:n,code:i,access_token:o,access_token_secret:r,openid:a,profile_key:s},d)}).then((function(t){e(t)})).catch((function(e){c(e)}))}))},this.webShareLogin=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Ne);return t.request({url:q.WEB_SHARE_LOGIN,method:"POST",data:N({},i,o)})},this.getOauthMobile=function(e){var n=e.access_token,i=e.access_token_secret,o=e.code,r=e.expires_in,a=e.openid,s=e.platform_app_id,c=e.platform,u=e.need_plaintext,l=void 0!==u&&u,d=e.profile_key,f=e.extra_params,h=void 0===f?{}:f;return new g((function(e,u){t.request({url:q.MOBILE_OAUTH,method:"POST",data:N({access_token:n,access_token_secret:i,code:o,expires_in:r,openid:a,platform_app_id:s,platform:c,need_plaintext:l,profile_key:d},h)}).then((function(t){e(t)})).catch((function(e){u(e)}))}))},this.authBindLogin=function(e){var n=e.extra_params,i=Y(N({platform_app_id:e.platform_app_id,code:e.code,mobile:e.mobile,sms_code:e.sms_code,sms_code_key:e.sms_code_key,profile_key:e.profile_key,state:e.state},void 0===n?{}:n),["mobile","sms_code"]);return new g((function(e,n){t.request({url:q.AUTH_BIND_ONLY,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.mobileBindLogin=function(e){var n=e.extra_params,i=Y(N({code:e.code,mobile:e.mobile,profile_key:e.profile_key,state:e.state},void 0===n?{}:n),["mobile","code"]);return new g((function(e,n){t.request({url:q.MOBILE_BIND_ONLY,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.logout=function(e){var n=e.next,i=void 0===n?"/":n,o=e.need_redirect,r=void 0===o?1:o;if(!r)return t.request({url:q.LOGOUT,data:{need_redirect:r}});var a,s=(null===(a=ee("initProps"))||void 0===a?void 0:a.aid)||"",c=encodeURIComponent(i);window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(""+(t.host||"")+q.LOGOUT+"?account_sdk_source=web&aid="+s+"&next="+c,null,{logType:"js.window.location",mode:"black",reportOnly:!1})},this.sendEmailCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,next:e.next,password:e.password,type:1},void 0===n?{}:n),["email","password","type"]);return t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i})},this.sendEmailLoginCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,next:e.next,type:13},void 0===n?{}:n),["email","type"]);return t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i})},this.sendEmailQuickLoginCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,next:e.next,type:16},void 0===n?{}:n),["email","type"]);return t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i})},this.emailRegister=function(e){var n=e.ifLogin,i=void 0!==n&&n,o=e.extra_params,r=Y(N({email:e.email,code:e.code,password:e.password,type:1},void 0===o?{}:o),["email","password","type","code"]);return t.request({url:i?q.EMAIL_REGISTER_LOGIN:q.EMAIL_REGISTER,method:"POST",data:r})},this.mobileRegister=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,password:e.password,type:16},void 0===n?{}:n),["mobile","code","password","type"]);return new g((function(e,n){t.request({url:q.MOBILE_REGISTER,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.mobileEmailRegister=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,sms_code:e.sms_code,email:e.email,email_code:e.email_code,password:e.password,verify_ticket:e.verify_ticket,sms_type:16,ect_type:1},void 0===n?{}:n),["mobile","sms_code","sms_type","email","email_code","ect_type","password"]);return new g((function(e,n){t.request({url:q.MOBILE_EMAIL_REGISTER,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.checkLogin=function(e){void 0===e&&(e={});var n=e.extra_params;return t.request({url:q.CHECK_LOGIN,method:"GET",data:void 0===n?{}:n})},this.bindWithMobileLogin=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Ge);return t.request({url:q.BIND_WITH_MOBILE_LOGIN,method:"POST",data:N({},i,o)})},this.bindWithEmailLogin=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Be);return t.request({url:q.BIND_WITH_EMAIL_LOGIN,method:"POST",data:N({},i,o)})},this.thirdAuth=function(e){var t,n=e.platform_app_id,i=e.next,o=void 0===i?"/":i,r=e.use_local_host,a=void 0===r?0:r,s=e.action,c=e.extra_params,u=void 0===c?{}:c,l="account_sdk_source=web&aid="+((null===(t=ee("initProps"))||void 0===t?void 0:t.aid)||"")+"&next="+encodeURIComponent(o)+"&platform_app_id="+n+"&use_local_host="+a+"&action="+s;for(var d in u)d&&(l="string"==typeof u[d]?l+"&"+d+"="+encodeURIComponent(u[d]):l+"&"+d+"="+u[d]);window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(q.THIRD_AUTH+"?"+l,null,{logType:"js.window.location",mode:"black",reportOnly:!1})},this.emailRegisterNoVerifyV2=function(e){var n=e.extra_params,i=Y(N({email:e.email,password:e.password,next_url:e.next_url,recaptcha_token:e.recaptcha_token},void 0===n?{}:n),["email","password","recaptcha_token"]);return t.request({url:q.EMAIL_REGISTER_NO_VERIFY_V2,method:"POST",data:i})},this.wapLogin=function(e){var n,i=e.origin,o=void 0===i?"":i,r=e.type,a=void 0===r?"web":r,s=e.use_local_host,c=e.scopes,l=void 0===c?"user_info":c,d=e.url_params,f=void 0===d?"":d,h=e.platform_app_id,_=e.platform,m=void 0===_?"":_,v=e.replace,g=void 0!==v&&v,E=encodeURIComponent(e.next),b=encodeURIComponent(t.host+"/auth/login_success/?service="+E),y={aid:t.aid,type:a,use_local_host:s,scopes:l,next:b,url_params:f,platform_app_id:h,platform:m},w="",S=u(y).length;p(n=u(y)).call(n,(function(e,t){w+=S===t+1?e+"="+y[e]:e+"="+y[e]+"&"}));var C=""+o+q.AUTH_LOGIN_URL+"?"+w;g?window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(C,null,{logType:"js.window.location",mode:"black",reportOnly:!1}):window.open(C,"_blank")},this.bindVerifyInfo=function(e){var n=e.extra_params;return t.request({url:"/passport/common/register/web/bind_verify_info/",method:"GET",data:N({auth_ticket:e.auth_ticket,verify_ticket:e.verify_ticket,token:e.token,scene:e.scene,user_type:e.user_type},void 0===n?{}:n)})};var n=e.host,i=e.aid;this.request=e.request,this.host=n,this.aid=i},Ue=["extra_params"],Ve=["extra_params"],je=function(){function e(e){this.request=e.request}var t=e.prototype;return t.getQrcode=function(e){return this.request({url:q.GET_QRCODE+"?next="+encodeURIComponent(e.next),method:"GET"})},t.checkQrconnect=function(e){var t=e.token,n=e.extra_params;return this.request({url:q.CHECK_QRCONNECT+"?next="+encodeURIComponent(e.next),method:"GET",data:N({token:t},n)})},t.getQrcodeFromWechat=function(e){var t=e.extra_params,n=void 0===t?{}:t,i=B(e,Ue);return this.request({url:q.GET_QRCODE_FROM_WECHAT,method:"POST",data:N({},n,i)})},t.checkQrcodeFromWechat=function(e){var t=e.extra_params,n=void 0===t?{}:t,i=B(e,Ve);return this.request({url:q.CHECK_QRCODE_FROM_WECHAT,method:"POST",data:N({},n,i)})},e}(),ze=function(e){var t=this;this.sendCode=function(e){var n=e.unbind_exist,i=e.extra_params,o=Y(N({mobile:e.mobile,type:8,unbind_exist:void 0===n?0:n},void 0===i?{}:i),["mobile","type","unbind_exist"]);return t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:o})},this.bindMobile=function(e){void 0===e&&(e={});var n=e.unbind_exist,i=e.extra_params,o=Y(N({mobile:e.mobile,code:e.code,password:e.password,verify_ticket:e.verify_ticket,unbind_exist:void 0===n?0:n,type:8},void 0===i?{}:i),["mobile","code","password","unbind_exist","type"]);return t.request({url:q.MOBILE_BIND,method:"POST",data:o})},this.sendEmailCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,type:8},void 0===n?{}:n),["email","type"]);return new g((function(e,n){t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.bindEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code},void 0===n?{}:n),["email","code"]);return new g((function(e,n){t.request({url:q.EMAIL_BIND,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.bindAuth=function(e){var n=e.platform_app_id,i=e.code,o=e.access_token,r=e.access_token_secret,a=e.openid,s=e.profile_key,c=e.state,u=e.extra_params,l=void 0===u?{}:u;return new g((function(e,u){t.request({url:q.AUTH_BIND,method:"POST",data:N({platform_app_id:n,code:i,access_token:o,access_token_secret:r,openid:a,profile_key:s,state:c},l)}).then((function(t){e(t)})).catch((function(e){u(e)}))}))},this.unbindAuth=function(e){var n=e.platform,i=e.extra_params,o=void 0===i?{}:i;return new g((function(e,i){t.request({url:q.AUTH_UNBIND,method:"POST",data:N({platform:n},o)}).then((function(t){e(t)})).catch((function(e){i(e)}))}))},this.switchBindAuth=function(e){var n=e.platform_app_id,i=e.profile_key,o=e.extra_params,r=void 0===o?{}:o;return new g((function(e,o){t.request({url:q.AUTH_SWITCH_BIND,method:"POST",data:N({platform_app_id:n,profile_key:i},r)}).then((function(t){e(t)})).catch((function(e){o(e)}))}))},this.changeQrcodeSuccess=function(e){var n=e.extra_params;return t.request({url:q.CHANGE_QRCODE_SUCCESS,method:"POST",data:N({token:e.token},void 0===n?{}:n)})},this.changeQrcodeComfirm=function(e){var n=e.extra_params;return t.request({url:q.CHANGE_QRCODE_CONFIRM,method:"POST",data:N({token:e.token,verify_ticket:e.verify_ticket},void 0===n?{}:n)})},this.request=e.request},He=function(e){var t=this;this.checkMobileRegistered=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile},void 0===n?{}:n),["mobile"]);return new g((function(e,n){t.request({url:q.CHECK_MOBILE_REGISTER,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.checkEmailRegistered=function(e){var n=e.extra_params,i=Y(N({email:e.email},void 0===n?{}:n),["email"]);return t.request({url:q.CHECK_EMAIL_REGISTER,method:"POST",data:i})},this.request=e.request},We=function(e){this.request=e.request},Fe=function(e){var t=this;this.sendCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,type:6},void 0===n?{}:n),["mobile","type"]);return new g((function(e,n){t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.validateCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,type:6},void 0===n?{}:n),["mobile","code","type"]);return new g((function(e,n){t.request({url:q.CHECK_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.resetPwdByMobile=function(e){var n=e.extra_params,i=Y(N({password:e.password,mobile:e.mobile,code:e.code},void 0===n?{}:n),["password","mobile","code"]);return new g((function(e,n){t.request({url:q.RESET_PWD_BY_MOBILE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendEmailCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,type:4},void 0===n?{}:n),["email","type"]);return new g((function(e,n){t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.validateEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,type:4},void 0===n?{}:n),["email","code","type"]);return t.request({url:q.CHECK_EMAIL_CODE,method:"POST",data:i})},this.resetPwdByEmail=function(e){var n=e.extra_params,i=Y(N({password:e.password,email:e.email,code:e.code},void 0===n?{}:n),["password","email","code"]);return new g((function(e,n){t.request({url:q.RESET_PWD_BY_EMAIL,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.resetPwdByMobileTicket=function(e){var n=e.extra_params,i=Y(N({password:e.password,ticket:e.ticket},void 0===n?{}:n),["password"]);return new g((function(e,n){t.request({url:q.RESET_PWD_BY_MOBILE_TICKET,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.resetPwdByEmailTicket=function(e){var n=e.extra_params,i=Y(N({password:e.password,ticket:e.ticket},void 0===n?{}:n),["password"]);return new g((function(e,n){t.request({url:q.RESET_PWD_BY_EMAIL_TICKET,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.request=e.request},Ke=function(e){var t=this;this.sendCodeToOldMobile=function(e){var n=e.use_bind_mobile,i=e.extra_params,o=Y(N({mobile:e.mobile,type:void 0===n||n?22:28},void 0===i?{}:i),["mobile","type"]);return new g((function(e,n){t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:o}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.validateOldMobile=function(e){var n=e.use_bind_mobile,i=e.extra_params,o=Y(N({code:e.code,type:void 0===n||n?22:28},void 0===i?{}:i),["code","type"]);return new g((function(e,n){t.request({url:q.VERIFY_MOBILE_CODE,method:"POST",data:o}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendCodeToNewMobile=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,old_mobile:e.old_mobile,type:20,ticket:e.ticket},void 0===n?{}:n),["mobile","old_mobile","type"]);return new g((function(e,n){t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.rebindMobile=function(e){var n=e.kick_other,i=e.extra_params,o=Y(N({mobile:e.mobile,code:e.code,ticket:e.ticket,kick_other:void 0===n?0:n},void 0===i?{}:i),["mobile","code"]);return new g((function(e,n){t.request({url:q.MOBILE_REBIND,method:"POST",data:o}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendCodeToOldEmail=function(e){void 0===e&&(e={});var n=e.extra_params,i=Y(N({email:e.email,type:6},void 0===n?{}:n),["email","type"]);return new g((function(e,n){t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.validateOldEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,type:6},void 0===n?{}:n),["email","code","type"]);return new g((function(e,n){t.request({url:q.VERIFY_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendCodeToNewEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,ticket:e.ticket,type:7},void 0===n?{}:n),["email","type"]);return new g((function(e,n){t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.rebindEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,type:7,ticket:e.ticket},void 0===n?{}:n),["email","code","type"]);return new g((function(e,n){t.request({url:q.EMAIL_REBIND,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.request=e.request},$e=function(e){var t=this;this.sendCode=function(e){void 0===e&&(e={});var n=e.verify_mobile_seperate,i=e.extra_params,o=Y(N({type:void 0!==n&&n?22:13},void 0===i?{}:i),["type"]);return t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:o})},this.validateMobile=function(e){var n=e.extra_params,i=Y(N({code:e.code,type:22},void 0===n?{}:n),["code","type"]);return new g((function(e,n){t.request({url:q.VERIFY_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.changePwdByMobile=function(e){var n=e.extra_params,i=Y(N({password:e.password,code:e.code,ticket:e.ticket},void 0===n?{}:n),["password","code"]);return new g((function(e,n){t.request({url:q.PWD_CHANGE_BY_MOBILE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.updatePwd=function(e){var n=e.extra_params,i=Y(N({password:e.password,current_password:e.current_password},void 0===n?{}:n),["password","current_password"]);return new g((function(e,n){t.request({url:q.PWD_UPDATE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendEmailCode=function(e){void 0===e&&(e={});var n=e.extra_params,i=Y(N({type:11},void 0===n?{}:n),["type"]);return new g((function(e,n){t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.validateEmail=function(e){var n=e.extra_params,i=Y(N({code:e.code,type:11},void 0===n?{}:n),["code","type"]);return new g((function(e,n){t.request({url:q.VERIFY_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.changePwdByEmail=function(e){var n=e.extra_params,i=Y(N({password:e.password,code:e.code,ticket:e.ticket},void 0===n?{}:n),["password","code"]);return new g((function(e,n){t.request({url:q.PWD_CHANGE_BY_EMAIL,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.setPassword=function(e){var n=e.extra_params,i=Y(N({password:e.password},void 0===n?{}:n),["password"]);return new g((function(e,n){t.request({url:q.PWD_SET,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.checkHasSetPwd=function(e){void 0===e&&(e={});var n=e.extra_params,i=void 0===n?{}:n;return new g((function(e,n){t.request({url:q.PWD_HAS_SET,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.checkWebHasSetPwd=function(e){void 0===e&&(e={});var n=e.extra_params;return t.request({url:q.PWD_HAS_SET_V2,method:"GET",data:void 0===n?{}:n})},this.changePwdByEmailAndLogin=function(e){var n=e.extra_params,i=Y(N({password:e.password,code:e.code,email:e.email},void 0===n?{}:n),["password","code"]);return t.request({url:q.PWD_SET_BY_EAMIL_AND_LOGIN,method:"POST",data:i})},this.request=e.request},Ye=function(e){var t=this;this.notLoginSendCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,type:34},void 0===n?{}:n),["mobile","type"]);return new g((function(e,n){t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.notLoginValidateMobile=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,type:34},void 0===n?{}:n),["mobile","code","type"]);return new g((function(e,n){t.request({url:q.CHECK_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.notLoginSendEmailCode=function(e){var n=e.extra_params,i=Y(N({email:e.email,type:15},void 0===n?{}:n),["email","type"]);return new g((function(e,n){t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.notLoginValidateEmail=function(e){var n=e.extra_params,i=Y(N({email:e.email,code:e.code,type:15},void 0===n?{}:n),["email","code","type"]);return new g((function(e,n){t.request({url:q.CHECK_EMAIL_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendCode=function(e){void 0===e&&(e={});var n=e.extra_params,i=Y(N({type:22},void 0===n?{}:n),["type"]);return new g((function(e,n){t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.validateMobile=function(e){var n=e.extra_params,i=Y(N({code:e.code,type:22},void 0===n?{}:n),["code","type"]);return new g((function(e,n){t.request({url:q.VERIFY_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.sendEmailCode=function(e){void 0===e&&(e={});var n=e.extra_params,i=Y(N({type:6},void 0===n?{}:n),["type"]);return t.request({url:q.SEND_EMAIL_CODE,method:"POST",data:i})},this.validateEmail=function(e){var n=e.extra_params,i=Y(N({code:e.code,type:6},void 0===n?{}:n),["code","type"]);return t.request({url:q.VERIFY_EMAIL_CODE,method:"POST",data:i})},this.accountVerify=function(e){var n=e.extra_params,i=Y(N({account:e.account,password:e.password,user_login_version:1},void 0===n?{}:n),["account","password"]);return new g((function(e,n){t.request({url:q.ACCOUNT_VERIFY,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.authVerify=function(e){var n=e.platform_app_id,i=e.code,o=e.access_token,r=e.access_token_secret,a=e.openid,s=e.profile_key,c=e.extra_params,u=void 0===c?{}:c;return new g((function(e,c){t.request({url:q.AUTH_VERIFY,method:"POST",data:N({platform_app_id:n,code:i,access_token:o,access_token_secret:r,openid:a,profile_key:s},u)}).then((function(t){e(t)})).catch((function(e){c(e)}))}))},this.smsAuthorizeSendCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,type:26},void 0===n?{}:n),["mobile","type"]);return new g((function(e,n){t.request({url:q.SEND_MOBILE_CODE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.smsAuthorize=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,type:26},void 0===n?{}:n),["mobile","code","type"]);return new g((function(e,n){t.request({url:q.SMS_AUTHORIZE,method:"POST",data:i}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.request=e.request},Qe=function(e){var t=this;this.verifyWay=function(e){var n=e.extra_params;return t.request({url:q.CANCEL_VERIFY_WAY,method:"GET",data:N({cancel_ticket:e.cancel_ticket},void 0===n?{}:n)})},this.checkIfPass=function(e){return t.request({url:q.CANCEL_CHECK,method:"GET",data:N({value_ticket:e.value_ticket},e.extra_params)})},this.confirm=function(e){var n=e.extra_params;return t.request({url:q.CANCEL_CONFIRM,method:"POST",data:N({value_ticket:e.value_ticket,token:e.token,cancel_ticket:e.cancel_ticket,abandon:e.abandon},void 0===n?{}:n)})},this.cancel=function(e){return t.request({url:q.CANCEL_REQUEST_CANCEL,method:"POST",data:N({type:e.type,token:e.token},e.extra_params)})},this.request=e.request},Je=["extra_params"],Xe=["extra_params"],Ze=["extra_params"],et=["extra_params"],tt=function(){function e(e){var t=e.isBoe,n=void 0!==t&&t;this.request=e.request,this.isBoe=n}var t=e.prototype;return t.getAuthInfo=function(e){var t=e.extra_params;return this.request({url:q.GET_OPEN_AUTH_INFO,method:"GET",data:N({client_key:e.client_key,scope:e.scope},void 0===t?{}:t)})},t.sendCode=function(e){var t=e.extra_params,n=Y(N({mobile:e.mobile,type:27},void 0===t?{}:t),["mobile","type"]);return this.request({url:q.OPEN_SEND_CODE,method:"GET",data:n})},t.smsAuth=function(e){var t=e.extra_params,n=Y(N({client_key:e.client_key,scope:e.scope,source:e.source,redirect_uri:e.redirect_uri,state:e.state,mobile:e.mobile,code:e.code},void 0===t?{}:t),["mobile","code"]);return this.request({url:q.OPEN_SMS_AUTH,method:"POST",data:n})},t.accountAuth=function(e){var t=e.extra_params,n=Y(N({client_key:e.client_key,scope:e.scope,source:e.source,redirect_uri:e.redirect_uri,state:e.state,password:e.password,account:e.account},void 0===t?{}:t),["password","account"]);return this.request({url:q.OPEN_ACCOUNT_AUTH,method:"POST",data:n})},t.thirdAuth=function(e){var t=e.extra_params,n=void 0===t?{}:t,i=B(e,Je);return this.request({url:q.OPEN_THIRD_AUTH,method:"POST",data:N({},i,n)})},t.getQRCode=function(e){var t=e.extra_params;return this.request({url:q.OPEN_GET_QRCODE,method:"POST",data:N({client_key:e.client_key,scope:e.scope,state:e.state,next:e.next},void 0===t?{}:t)})},t.checkQRCode=function(e){var t=e.extra_params;return this.request({url:q.OPEN_CHECK_QRCODE,method:"POST",data:N({token:e.token,next:e.next,scope:e.scope,client_key:e.client_key},void 0===t?{}:t)})},t.toScanQRCode=function(e){var t=e.extra_params;return this.request({url:q.OPEN_TO_SCAN_QRCODE,method:"POST",data:N({},void 0===t?{}:t)})},t.scanQRCode=function(e){var t=e.extra_params;return this.request({url:q.OPEN_SCAN_QRCODE,method:"POST",data:N({token:e.token},void 0===t?{}:t)})},t.confirmQRCode=function(e){var t=e.extra_params;return this.request({url:q.OPEN_CONFIRM_QRCODE,method:"POST",data:N({token:e.token,scopes:e.scopes},void 0===t?{}:t)})},t.webAuth=function(e){var t=e.extra_params,n=void 0===t?{}:t,i=B(e,Xe);return this.request({url:q.OPEN_WEB_AUTH,method:"POST",data:N({},i,n)})},t.getOauthToken=function(e){var t=e.extra_params,n=void 0===t?{}:t,i=B(e,Ze);return this.request({url:q.GET_OPEN_OAUTH_TOKEN,method:"GET",data:N({},i,n)})},t.updateAuthorizeInfo=function(e){var t=e.extra_params,n=void 0===t?{}:t,i=B(e,et);return this.request({url:q.OPEN_UPDATE_AUTHORIZE_INFO,method:"POST",data:N({},i,n)})},t.douyinOauthConnect=function(e){var t,n=X(8)+"-"+X(4)+"-"+X(4)+"-"+X(4)+"-"+X(12),i=e.optionalScope,o=e.state,r=void 0===o?n:o,a=e.response_type,s=e.host,c=""+(void 0===s?"https://open.douyin.com":s)+q.PLATFORM_OAUTH_CONNECT+"?"+h(t=S({client_key:e.client_key,scope:e.scope,optionalScope:void 0===i?"":i,state:r,response_type:void 0===a?"code":a,redirect_uri:e.redirect_uri})).call(t,(function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&"),u=new Date;u.setTime(u.getTime()+5184e6),document.cookie="passport_open_state="+r+"; Domain="+window.location.host+"; Path=/; SameSite=None; Secure; expires="+u.toUTCString(),window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(c,null,{logType:"js.window.location",mode:"black",reportOnly:!1})},e}(),nt=function(e){var t=this;this.getAccountInfo=function(e){void 0===e&&(e={});var n=e.extra_params;return t.request({url:q.ACCOUNT_INFO,method:"GET",data:void 0===n?{}:n})},this.setAccount=function(e){void 0===e&&(e={});var n=e.extra_params,i=Y(N({password:e.password,username:e.username},void 0===n?{}:n),["password","username"]);return t.request({url:q.ACCOUNT_SET,method:"POST",data:i})},this.request=e.request},it=["extra_params"],ot=function(e){var t=this;this.getOauthProfile=function(e){var n,i=e.extra_params;return t.request({url:q.OAUTH_PROFILE,method:"GET",data:N({aid:null===(n=t.props)||void 0===n?void 0:n.aid,access_token:e.access_token,access_token_secret:e.access_token_secret,code:e.code,expires_in:e.expires_in,openid:e.openid,platform_app_id:e.platform_app_id,platform:e.platform},void 0===i?{}:i)})},this.uploadAvatar=function(e){var n=e.avatar,i=e.extra_params,o=new FormData,r=new Blob([n],{type:n.type});return o.append("avatar",r),t.request({url:q.UPLOAD_AVATAR,method:"POST",data:o,params:N({},i),headers:{"Content-Type":"multipart/form-data"}})},this.updateUserInfo=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=N({},B(e,it),i);return t.request({url:q.UPDATE_USERINFO,method:"POST",data:o})},this.checkDefaultInfo=function(e){var n=e.extra_params;return t.request({url:q.CHECK_DEFAULT_INFO,method:"GET",params:N({scene:e.scene},void 0===n?{}:n)})},this.getDefaultImageList=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=q.GET_BACKGROUND_LIST.replace("{aid}",String(t.props.aid));return t.request({url:o,method:"GET",params:N({},i)})},this.getDefaultAvatarList=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=q.GET_DEFAULT_AVATAR_LIST.replace("{aid}",String(t.props.aid));return t.request({url:o,method:"GET",params:N({},i)})},this.getRecommendName=function(e){var n=e.extra_params;return t.request({url:q.GET_RECOMMEND_NAME,method:"GET",params:N({},void 0===n?{}:n)})},this.checkRemainTimes=function(e){var n=e.field_namespace,i=e.extra_params;return t.request({url:q.CHECK_REMAIN_TIMES,method:"GET",params:N({field:e.field,field_namespace:void 0===n?"":n},void 0===i?{}:i)})},this.uploadPicture=function(e){var n=e.pic,i=e.is_sensitive,o=e.extra_params,r=void 0===o?{}:o,a=new FormData,s=new Blob([n],{type:n.type});return a.append("pic",s),t.request({url:q.UPLOAD_PICTURE,method:"POST",data:a,params:N({is_sensitive:i},r)})},this.downloadImage=function(e){var n=e.extra_params;return t.request({url:q.DOWNLOAD_IMAGE,method:"GET",params:N({key:e.key},void 0===n?{}:n)})},this.request=e.request,this.props=e},rt=function(e){function t(t){var n;n=e.call(this,t,"web")||this;t.printLog;var i=t.acrawler,o=void 0===i?"":i;o&&z(o,t);var r=N({},t,{request:n.request});return n.login=new qe(r),n.qrcodeLogin=new je(r),n.register=new We(r),n.forgetPwd=new Fe(r),n.bind=new ze(r),n.rebind=new Ke(r),n.password=new $e(r),n.extra=new He(r),n.verify=new Ye(r),n.cancel=new Qe(r),n.open=new tt(r),n.account=new nt(r),n.user=new ot(r),n.affLogin=new ge(r),n.affRegister=new ye(r),n.affInvite=new Te(r),n.affSubject=new Ae(r),n.affForgetPwd=new we(r),n.affResource=new Le(r),n.affRole=new De(r),n.affUser=new Pe(r),n.affSuper=new Me(r),n}return G(t,e),t}(me),at=function(e){var t=this;this.notLoginSendCode=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,type:34},void 0===n?{}:n),["mobile","type"]);return t.request({url:"/passport/mobile/send_code/",method:"POST",data:i})},this.notLoginValidateMobile=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,type:34},void 0===n?{}:n),["mobile","code","type"]);return t.request({url:"/passport/mobile/check_code/",method:"POST",data:i})},this.request=e.request},st=["extra_params"],ct=["extra_params"],ut=function(e){var t=this;this.bindWithMobileLogin=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,st);return t.request({url:"/passport/auth/bind_with_mobile_login/",method:"POST",data:N({},i,o)})},this.authLogin=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,ct);return t.request({url:"/passport/auth/login/",method:"POST",data:N({},i,o)})},this.memberSwitch=function(e){return t.request({url:"/passport/aff/mobile/member/switch/",method:"POST",data:{to_sec_member_id:e.to_sec_member_id}})},this.request=e.request},lt=function(e){var t=this;this.unbindUnusableMobile=function(e){var n=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,scene:1},void 0===n?{}:n),["mobile","code"]);return t.request({url:"/passport/mobile/unbind_limited_unusable_mobile/",method:"POST",data:i})},this.request=e.request},dt=function(e){function t(t){var n;n=e.call(this,t,"app")||this;t.printLog;var i=t.acrawler,o=void 0===i?"":i;o&&z(o,t);var r=N({},t,{request:n.request});return n.verify=new at(r),n.login=new ut(r),n.bind=new lt(r),n}return G(t,e),t}(me),ft=["mobile","type"],ht=["mobile","type"],pt=["email","password"],_t=["email","password"],mt=["email","password"],vt=["email","password"],gt=function(e){var t=this;this.baseSendMobileCode=function(e){var n=e.mobile,i=e.type,o=B(e,ft),r=Y(N({mobile:n,type:i},o),["mobile","type"]);return new g((function(e,n){t.request({url:V.MOBILE_CODE_URL,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.baseSendMobileCodeV2=function(e){var n=e.mobile,i=e.type,o=B(e,ht),r=Y(N({mobile:n,type:i},o),["mobile","type"]);return new g((function(e,n){t.request({url:V.MOBILE_CODE_URL_V2,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.baseSendEmailLink=function(e){var n=e.email,i=e.password,o=B(e,pt),r=Y(N({email:n,password:i},o),["email","password"]);return new g((function(e,n){t.request({url:V.EMAIL_ACTIVATE_URL,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.baseSendEmailLinkV2=function(e){var n=e.email,i=e.password,o=B(e,_t),r=Y(N({email:n,password:i},o),["email","password"]);return new g((function(e,n){t.request({url:V.EMAIL_ACTIVATE_URL_V2,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.baseSendEmailCode=function(e){var n=e.email,i=e.password,o=B(e,mt),r=Y(N({email:n,password:i},o),["email","password"]);return new g((function(e,n){t.request({url:V.EMAIL_ACTIVATE_CODE_URL,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.baseSendEmailCodeV2=function(e){var n=e.email,i=e.password,o=B(e,vt),r=Y(N({email:n,password:i},o),["email","password"]);return new g((function(e,n){t.request({url:V.EMAIL_ACTIVATE_CODE_URL_V2,method:"POST",data:r}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},this.request=e.request},Et=["extra_params"],bt=["extra_params"],yt=["mobile","code","extra_params"],wt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).sendMobileCode=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Et);return t.baseSendMobileCode(N({},o,{type:8},i))},t.sendMobileCodeV2=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,bt);return t.baseSendMobileCodeV2(N({},o,{type:8},i))},t.mobileBind=function(e){var n=e.mobile,i=e.code,o=e.extra_params,r=void 0===o?{}:o,a=B(e,yt),s=Y(N({mobile:n,code:i},a,{type:8},r),["mobile","type","code"]);return t.request({url:V.BIND_MOBILE,method:"POST",data:s})},t}return G(t,e),t}(gt),St=["extra_params"],Ct=["extra_params"],kt=["mobile","code","extra_params"],Tt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).sendMobileCode=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,St);return t.baseSendMobileCode(N({},o,{type:20},i))},t.sendMobileCodeV2=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Ct);return t.baseSendMobileCodeV2(N({},o,{type:20},i))},t.mobileChange=function(e){var n=e.mobile,i=e.code,o=e.extra_params,r=void 0===o?{}:o,a=B(e,kt),s=Y(N({mobile:n,code:i},a,r),["mobile","code"]);return t.request({url:V.CHANGE_MOBILE,method:"POST",data:s})},t}return G(t,e),t}(gt),Ot=["extra_params"],xt=["extra_params"],It=["extra_params"],At=["extra_params"],Lt=["extra_params"],Dt=["extra_params"],Pt=function(e){function t(t){var n;(n=e.call(this,t)||this).checkLogin=function(e){var t=e.extra_params,i=void 0===t?{}:t,o=B(e,Ot);return n.request({url:V.CHECK_LOGIN,method:"GET",data:N({},o,i)})},n.sendMobileCodeV2=function(e){var t=e.extra_params,i=void 0===t?{}:t,o=B(e,xt);return n.baseSendMobileCodeV2(N({},o,{type:24},i))},n.quickAuthV2=function(e){var t=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,service:e.service},void 0===t?{}:t),["mobile","code","password"]);return n.request({url:V.MOBILE_CODE_LOGIN_URL_V2,method:"POST",data:i})},n.quickAuthLoginOnly=function(e){var t=e.extra_params,i=Y(N({mobile:e.mobile,code:e.code,service:e.service},void 0===t?{}:t),["mobile","code"]);return n.request({url:V.MOBILE_CODE_LOGIN_ONLY_URL,method:"POST",data:i})},n.accountLoginV2=function(e){var t=e.account_type,i=e.extra_params,o=Y(N({account:e.account,password:e.password,account_type:void 0===t?0:t,service:e.service},void 0===i?{}:i),["account","password"]);return n.request({url:V.ACCOUNT_LOGIN_URL_V2,method:"POST",data:o})},n.logout=function(e){var t=e.service,i=e.not_redirect;if(void 0!==i&&i)return new g((function(e,i){n.request({url:"/csrf_token/",method:"POST"}).then((function(o){var r=o.passport_csrf_token;n.request({url:V.LOGOUT,method:"GET",data:{aid:n.aid,service:t,sso_not_redirect:1},headers:{"x-tt-passport-csrf-token":void 0===r?"":r}}).then((function(t){e(t)})).catch((function(e){i(e)}))})).catch((function(e){i(e)}))}));window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(""+n.host+V.LOGOUT+"?service="+encodeURIComponent(t),null,{logType:"js.window.location",mode:"black",reportOnly:!1})},n.wapLogin=function(e){var t,i=e.origin,o=void 0===i?"":i,r=e.type,a=void 0===r?"sso":r,s=e.use_local_host,c=e.scopes,l=void 0===c?"user_info":c,d=e.url_params,f=void 0===d?"":d,h=e.platform_app_id,_=e.platform,m=void 0===_?"":_,v=e.replace,g=void 0!==v&&v,E=encodeURIComponent(e.next),b=encodeURIComponent(n.host+"/auth/login_success/?service="+E),y={aid:n.aid,type:a,use_local_host:s,scopes:l,next:b,url_params:f,platform_app_id:h,platform:m},w="",S=u(y).length;p(t=u(y)).call(t,(function(e,t){w+=S===t+1?e+"="+y[e]:e+"="+y[e]+"&"}));var C=""+o+V.AUTH_LOGIN_URL+"?"+w;g?window.location.href=globalThis.xssNamespace.douyin_web.filterUrl(C,null,{logType:"js.window.location",mode:"black",reportOnly:!1}):window.open(C,"_blank")},n.sendEmailLink=function(e){var t=e.extra_params,i=void 0===t?{}:t,o=B(e,It);return n.baseSendEmailLink(N({},o,{ect_type:13},i))},n.sendEmailLinkV2=function(e){var t=e.extra_params,i=void 0===t?{}:t,o=B(e,At);return n.baseSendEmailLinkV2(N({},o,{ect_type:13},i))},n.sendEmailCode=function(e){var t=e.extra_params,i=void 0===t?{}:t,o=B(e,Lt);return n.baseSendEmailCode(N({},o,{ect_type:13},i))},n.sendEmailCodeV2=function(e){var t=e.extra_params,i=void 0===t?{}:t,o=B(e,Dt);return n.baseSendEmailCodeV2(N({},o,{ect_type:13},i))},n.bindWithMobileLogin=function(e){var t=e.change_bind,i=e.extra_params;return n.request({url:V.BIND_WITH_MOBILE_LOGIN,method:"POST",data:N({code:e.code,platform_app_id:e.platform_app_id,service:e.service,profile_key:e.profile_key,change_bind:void 0===t?0:t},void 0===i?{}:i)})},n.authLogin=function(e){var t=e.login_only,i=e.extra_params;return n.request({url:void 0!==t&&t?V.AUTH_LOGIN_ONLY:V.AUTH_LOGIN,method:"POST",data:N({code:e.code,platform_app_id:e.platform_app_id,service:e.service,profile_key:e.profile_key},void 0===i?{}:i)})},n.mobileEmailRegister=function(e){var t=e.extra_params,i=Y(N({mobile:e.mobile,sms_code:e.sms_code,email:e.email,email_code:e.email_code,password:e.password,verify_ticket:e.verify_ticket,service:e.service,sms_type:16,ect_type:1},void 0===t?{}:t),["mobile","sms_code","sms_type","email","email_code","ect_type","password"]);return n.request({url:V.MOBILE_EMAIL_REGISTER,method:"POST",data:i})},n.memberSwitch=function(e){var t=e.extra_params;return n.request({url:"/aff/member/switch/",method:"POST",data:N({to_sec_member_id:e.to_sec_member_id},void 0===t?{}:t)})};var i=t.host,o=t.originHost;return n.aid=t.aid,n.host=i,n.originHost=o,n}return G(t,e),t}(gt),Rt=["extra_params"],Mt=["extra_params"],Nt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).sendMobileCodeV2=function(e){var n=e.check_register,i=e.extra_params;return t.baseSendMobileCodeV2(N({mobile:e.mobile,type:void 0!==n&&n?4:6},void 0===i?{}:i))},t.sendEmailCodeV2=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Rt);return t.baseSendEmailCodeV2(N({},o,{ect_type:4},i))},t.resetPassword=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=Y({account:e.account,code:e.code,password:e.password},["account","code","password"]);return new g((function(e,n){t.request({url:V.RESET_PASSWORD,method:"POST",data:N({},o,i)}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},t.resetPasswordByEmailCode=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=Y({email:e.email,code:e.code,password:e.password},["email","code","password"]);return t.request({url:V.RESET_PASSWORD_BY_EMAIL,method:"POST",data:N({},o,{ect_type:4},i)})},t.sendEmailCodeModifyPassword=function(e){void 0===e&&(e={});var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Mt);return t.baseSendEmailCodeV2(N({},o,{ect_type:11},i))},t.modifyPasswordByEmailCode=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=Y({email:e.email,code:e.code,password:e.password},["email","code","password"]);return t.request({url:V.RESET_PASSWORD_BY_EMAIL,method:"POST",data:N({},o,{ect_type:11},i)})},t}return G(t,e),t}(gt),Gt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).getQrcode=function(e){var n=e.extra_params,i=void 0===n?{}:n;return t.request({url:V.GET_QRCODE+"?service="+encodeURIComponent(e.service),method:"GET",data:i})},t.checkQrconnect=function(e){var n=e.token,i=e.extra_params,o=void 0===i?{}:i;return t.request({url:V.CHECK_QRCONNECT+"?service="+encodeURIComponent(e.service),method:"GET",data:N({token:n},o)})},t}return G(t,e),t}(gt),Bt=["extra_params"],qt=["extra_params"],Ut=["code","extra_params"],Vt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).sendMobileCode=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Bt);return t.baseSendMobileCode(N({},o,{type:22},i))},t.sendMobileCodeV2=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,qt);return t.baseSendMobileCodeV2(N({},o,{type:22},i))},t.quickAuth=function(e){var n=e.code,i=e.extra_params,o=void 0===i?{}:i,r=B(e,Ut),a=Y(N({code:n},r,o),["code"]);return t.request({url:V.QUICK_AUTH,method:"POST",data:a})},t}return G(t,e),t}(gt),jt=["email","extra_params"],zt=["email","code","mobile","password","extra_params"],Ht=["email","code","mobile","password","extra_params"],Wt=["email","code","extra_params"],Ft=["extra_params"],Kt=["extra_params"],$t=["extra_params"],Yt=["extra_params"],Qt=["extra_params"],Jt=["extra_params"],Xt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).emailRegisterXhr=function(e){return t.request({url:V.EMAIL_REGISTER,method:"POST",data:e})},t.emailRegister=function(e){var n=e.email,i=e.extra_params,o=void 0===i?{}:i,r=B(e,jt),a=Y(N({email:n},r,{ect_type:1},o),["email","code","password"]);return t.emailRegisterXhr(a)},t.emailRegisterAndBindMoblieV2=function(e){var n=e.email,i=e.code,o=e.mobile,r=e.password,a=e.extra_params,s=void 0===a?{}:a,c=B(e,zt),u=Y(N({email:n,code:i,mobile:o,password:r},c,s),["email","code","mobile","password"]);return t.request({url:V.EMAIL_REGISTER_V2,method:"POST",data:u})},t.mobileRegisterAndBindEmailV2=function(e){var n=e.email,i=e.code,o=e.mobile,r=e.password,a=e.extra_params,s=void 0===a?{}:a,c=B(e,Ht),u=Y(N({email:n,code:i,mobile:o,password:r},c,s),["email","code","mobile","password"]);return t.request({url:V.MOBILE_REGISTER_WITH_EMAIL,method:"POST",data:u})},t.emailActivateCodeLogin=function(e){var n=e.email,i=e.code,o=e.extra_params,r=void 0===o?{}:o,a=B(e,Wt),s=Y(N({email:n,code:i},a,{ect_type:13},r),["email","code"]);return t.request({url:V.EMAIL_ACTIVATE_CODE_LOGIN,method:"POST",data:s})},t.sendMobileCode=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Ft);return t.baseSendMobileCode(N({},o,{type:16},i))},t.sendMobileCodeV2=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Kt);return t.baseSendMobileCodeV2(N({},o,{type:16},i))},t.sendEmailLink=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,$t);return t.baseSendEmailLink(N({},o,{ect_type:1},i))},t.sendEmailLinkV2=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Yt);return t.baseSendEmailLinkV2(N({},o,{ect_type:1},i))},t.sendEmailCode=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Qt);return t.baseSendEmailCode(N({},o,{ect_type:1},i))},t.sendEmailCodeV2=function(e){var n=e.extra_params,i=void 0===n?{}:n,o=B(e,Jt);return t.baseSendEmailCodeV2(N({},o,{ect_type:1},i))},t}return G(t,e),t}(gt),Zt=function(e){function t(t){var n;n=e.call(this,t,"sso")||this;var i=t.host,o=t.acrawler,r=void 0===o?"":o;t.printLog,r&&z(r,t),n.host=i||"",n.originHost=window.location.origin;var a=N({},t,{request:n.request});return n.bindMobile=new wt(a),n.changeMobile=new Tt(a),n.login=new Pt(N({},a,{originHost:n.originHost})),n.password=new Nt(a),n.qrcodeLogin=new Gt(a),n.quickAuth=new Vt(a),n.register=new Xt(a),n}return G(t,e),t}(me),en=function(e){var t=this;this.webSdkInit=function(e){var n=e.extra_params;return t.request({url:"/user_info/common/v1/web_sdk_init/",method:"POST",data:N({mode:e.mode,scene:e.scene},void 0===n?{}:n)})},this.request=e.request},tn=function(e){function t(t){var n;n=e.call(this,t,"auth")||this;t.printLog;var i=t.acrawler,o=void 0===i?"":i;o&&z(o,t);var r=N({},t,{request:n.request});return n.common=new en(r),n}return G(t,e),t}(me),nn=rt,on=dt,rn=Zt,an=tn,sn={web:rt,app:dt,sso:Zt,auth:tn},cn={web:null,app:null,sso:null,auth:null};t.AccountSdkInstance=function(){function e(){}return e.createAccountSdk=function(t,n){return cn[t]||(cn[t]=e.create(sn[t]||sn.web,n)),cn[t]},e.create=function(e,t){return new e(t)},e}().createAccountSdk,t.AppInterface=dt,t.AppInterfaceSdk=on,t.AuthInterface=tn,t.AuthInterfaceSdk=an,t.SsoInterface=Zt,t.SsoInterfaceSdk=rn,t.WebInterface=rt,t.WebInterfaceSdk=nn,t.default=function(e){var t=e.scope;switch(void 0===t?"web":t){case"web":default:return new rt(e);case"app":return new dt(e);case"sso":return new Zt(e);case"auth":return new tn(e)}},t.encryptParams=Y},49148:function(e,t,n){"use strict";e.exports=n(89282)},46306:function(e,t,n){"use strict";n.r(t),n.d(t,{Collector:function(){return at}});var i=function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function r(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function a(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e}var s,c=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var n=this;e&&t&&"function"==typeof t&&this.on(e,(function i(o){t(o),n.off(e,i)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var n=this._hooks[e].indexOf(t);-1!==n&&this._hooks[e].splice(n,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,n){if(n){if(!e)return;-1!==this._cache.indexOf(n)?this._emit(e,t):(this._hooksCache.hasOwnProperty(n)||(this._hooksCache[n]={}),this._hooksCache[n].hasOwnProperty(e)||(this._hooksCache[n][e]=[]),this._hooksCache[n][e].push(t))}else this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&a(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),u=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},l=function(e){return Array.isArray(e)},d=(s=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return s+=1}),f=function(e){return function(e,t,n){if("string"==typeof e&&"number"==typeof n){var i,o=[];n=n<=25?n:n%25;var r=String.fromCharCode(n+97);i=e.split(r);for(var a=0;a<i.length;a++){var s=parseInt(i[a],n);s=1*s^64;var c=String.fromCharCode(s);o.push(c)}return o.join("")}}(e,0,25)},h=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},p=function(e,t,n){var i=document.createElement("script");i.src=e,i.onerror=function(){n(e)},i.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(i)},_=function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach((function(t){void 0!==document[t]&&(e=1)})),e},m=function(e){var t=document.createElement("a");return t.href=e,t},v=function(e){var t={};try{var n=m(e).search;if(!n)return t;(n=n.slice(1)).split("&").forEach((function(e){var n,i,o=e.split("=");o.length&&(n=o[0],i=o[1]);try{t[n]=decodeURIComponent(void 0===i?"":i)}catch(e){t[n]=i}}))}catch(e){}return t},g=function(e){for(var t=0,n=0,i=(e+="").length,o=0;o<i;o++)((t=31*t+e.charCodeAt(n++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t};function E(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof window||"undefined"!=typeof window?window:"undefined"!=typeof self&&self;var b,y,w=E((function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function o(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},o.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in r)r[c]&&(s+="; "+c,!0!==r[c]&&(s+="="+r[c].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var o={},r=document.cookie?document.cookie.split("; "):[],a=0;a<r.length;a++){var s=r[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(s[0]);if(c=(i.read||i)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(o[u]=c,e===u)break}catch(e){}}return e?o[e]:o}}return o.set=r,o.get=function(e){return a(e,!1)},o.getJSON=function(e){return a(e,!0)},o.remove=function(t,n){r(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))},e.exports=n()})),S=function(e,t){try{return e?w.get(e,{domain:t||document.domain}):w.get()}catch(e){return""}},C=function(e,t,n,i){try{var o=i||document.domain,r=+new Date+(n||6048e5);w.set(e,t,{expires:new Date(r),path:"/",domain:o})}catch(e){}},k=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return S(e,t)},e.prototype.setCookie=function(e,t,n,i){C(e,t,n,i)},e}(),T={getItem:function(e){try{var t=localStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||{}}catch(e){}return{}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return S(e,t)},setCookie:function(e,t,n,i){C(e,t,n,i)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(i){return!1}}()},O={getItem:function(e){try{var t=sessionStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||{}}catch(e){}return{}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return S(e,t)},setCookie:function(e,t,n,i){C(e,t,n,i)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(i){return!1}}()},x=function(){function e(e,t){this._storage=t&&"session"===t?O:!e&&T.isSupportLS?T:new k}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,n,i){this._storage.setCookie(e,t,n,i)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),I=function(){function e(e,t,n){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=n}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,n=document.referrer,i=n?m(n).hostname:"",o=v(window.location.href),r=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(e,t,n,i){var o=new x(!1),r=new x(!1,"session"),a=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},u=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],l={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var d=!1;for(var f in l)l[f]&&(-1!==u.indexOf(f)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[f]=l[f]):c[f]=l[f],d=!0);if(d)r.setItem(s,"1"),o.setCookie(a,JSON.stringify(c),i,n);else{var h=o.getCookie(a,n);h&&(c=JSON.parse(h))}r.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return l}return c}(this.appid,o,this.domain,this.cookie_expire);var a=this.browser(),s=this.os();return{browser:a.browser,browser_version:a.browser_version,platform:r,os_name:s.os_name,os_version:s.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(s.os_name),language:t,referrer:n,referrer_host:i,utm:this.utm,latest_data:this.last(n,i)}},e.prototype.last=function(e,t){var n="",i="",o="",r=location.hostname,a=!1;if(e&&t&&r!==t){n=e,i=t,a=!0;var s=v(e);s.keyword&&(o=s.keyword)}return{$latest_referrer:n,$latest_referrer_host:i,$latest_search_keyword:o,isLast:a}},e.prototype.browser=function(){var e,t,n="",i=""+parseFloat(this.appVersion),o=this.userAgent;return-1!==o.indexOf("Edge")||-1!==o.indexOf("Edg")?(n="Microsoft Edge",-1!==o.indexOf("Edge")?(e=o.indexOf("Edge"),i=o.substring(e+5)):(e=o.indexOf("Edg"),i=o.substring(e+4))):-1!==(e=o.indexOf("MSIE"))?(n="Microsoft Internet Explorer",i=o.substring(e+5)):-1!==(e=o.indexOf("Lark"))?(n="Lark",i=o.substring(e+5,e+11)):-1!==(e=o.indexOf("MetaSr"))?(n="sougoubrowser",i=o.substring(e+7,e+10)):-1!==o.indexOf("MQQBrowser")||-1!==o.indexOf("QQBrowser")?(n="qqbrowser",-1!==o.indexOf("MQQBrowser")?(e=o.indexOf("MQQBrowser"),i=o.substring(e+11,e+15)):-1!==o.indexOf("QQBrowser")&&(e=o.indexOf("QQBrowser"),i=o.substring(e+10,e+17))):-1!==o.indexOf("Chrome")?-1!==(e=o.indexOf("MicroMessenger"))?(n="weixin",i=o.substring(e+15,e+20)):-1!==(e=o.indexOf("360"))?(n="360browser",i=o.substring(o.indexOf("Chrome")+7)):-1!==o.indexOf("baidubrowser")||-1!==o.indexOf("BIDUBrowser")?(-1!==o.indexOf("baidubrowser")?(e=o.indexOf("baidubrowser"),i=o.substring(e+13,e+16)):-1!==o.indexOf("BIDUBrowser")&&(e=o.indexOf("BIDUBrowser"),i=o.substring(e+12,e+15)),n="baidubrowser"):-1!==(e=o.indexOf("xiaomi"))?-1!==o.indexOf("openlanguagexiaomi")?(n="openlanguage xiaomi",i=o.substring(e+7,e+13)):(n="xiaomi",i=o.substring(e-7,e-1)):-1!==(e=o.indexOf("TTWebView"))?(n="TTWebView",i=o.substring(e+10,e+23)):(-1!==(e=o.indexOf("Chrome"))||-1!==(e=o.indexOf("Chrome")))&&(n="Chrome",i=o.substring(e+7)):-1!==o.indexOf("Safari")?-1!==(e=o.indexOf("QQ"))?(n="qqbrowser",i=o.substring(e+10,e+16)):-1!==(e=o.indexOf("Safari"))&&(n="Safari",i=o.substring(e+7),-1!==(e=o.indexOf("Version"))&&(i=o.substring(e+8))):-1!==(e=o.indexOf("Firefox"))?(n="Firefox",i=o.substring(e+8)):-1!==(e=o.indexOf("MicroMessenger"))?(n="weixin",i=o.substring(e+15,e+20)):-1!==(e=o.indexOf("QQ"))&&(n="qqbrowser",i=o.substring(e+3,e+8)),-1!==(t=i.indexOf(";"))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(" "))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(")"))&&(i=i.substring(0,t)),{browser:n,browser_version:i}},e.prototype.os=function(){for(var e="",t="",n=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],i=0;i<n.length;i++){var o=n[i];if(o.r.test(this.userAgent)){"Mac OS X"===(e=o.s)&&this.isNewIpad()&&(e="iOS");break}}var r,a,s=function(e,t){var n=e.exec(t);return n&&n[1]?n[1]:""},c=function(e,t){var n=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return n?n.slice(1)[0]:""};switch(/Windows/.test(e)&&(t=s(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":(a=s(/Android ([\.\_\d]+)/,r=this.userAgent))||(a=s(/Android\/([\.\_\d]+)/,r)),t=a,e="android";break;case"iOS":t=this.isNewIpad()?c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios"}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var n=navigator.userAgent.replace("Mozilla/5.0 (",""),i=n.indexOf(";");t=n.slice(0,i)}}catch(e){return t.trim()}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),A={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},L={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},D="5.0.47",P=function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t=this;if(!e||!e.length)return!1;var n=e[0];if(!n)return!1;var i=n.events,o=n.header;if(!i||!i.length)return!1;var r=!0;return i.forEach((function(e){if(!e)return r=!1,void(e.checkEvent="\u4e8b\u4ef6\u5f02\u5e38");t.checkEventName(e.event)||(r=!1,e.checkEvent="\u4e8b\u4ef6\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934"),t.checkEventParams(e.params)||(r=!1,e.checkParams="\u5c5e\u6027\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934")})),this.checkEventParams(o)||(r=!1),r},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),!Object.keys(t).length)return!0;for(var n in t)return!(!this.calculate(n,"params")||"string"==typeof t[n]&&t[n].length>1024);return!0},e.prototype.calculate=function(e,t){return-1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!new RegExp("^\\$").test(e)&&!new RegExp("^__").test(e)||!1},e}();!function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.UnReady="un-ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report"}(b||(b={})),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(y||(y={}));var R=b,M=void 0,N=(new Date).getTimezoneOffset(),G=parseInt(""+-N/60,10),B=60*N,q=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var n=new I(t.app_id,t.cookie_domain||"",t.cookie_expire||7776e6).init();this.eventCheck=new P(e,t);var i="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new x(!1,"session"),this.localStorage=new x(!1,"local"),t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var o=this.localStorage.getItem(i);o&&1==o?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(i,"1")),this.envInfo={user:{user_unique_id:M,user_type:M,user_id:M,user_is_auth:M,user_is_login:M,device_id:M,web_id:M,ip_addr_id:M,user_unique_id_type:M},header:{app_id:M,app_name:M,app_install_id:M,install_id:M,app_package:M,app_channel:M,app_version:M,ab_version:M,os_name:n.os_name,os_version:n.os_version,device_model:n.device_model,ab_client:M,traffic_type:M,client_ip:M,device_brand:M,os_api:M,access:M,language:n.language,region:M,app_language:M,app_region:M,creative_id:n.utm.creative_id,ad_id:n.utm.ad_id,campaign_id:n.utm.campaign_id,log_type:M,rnd:M,platform:n.platform,sdk_version:D,sdk_lib:"js",province:M,city:M,timezone:G,tz_offset:B,tz_name:M,sim_region:M,carrier:M,resolution:n.screen_width+"x"+n.screen_height,browser:n.browser,browser_version:n.browser_version,referrer:n.referrer,referrer_host:n.referrer_host,width:n.screen_width,height:n.screen_height,screen_width:n.screen_width,screen_height:n.screen_height,utm_term:n.utm.utm_term,utm_content:n.utm.utm_content,utm_source:n.utm.utm_source,utm_medium:n.utm.utm_medium,utm_campaign:n.utm.utm_campaign,tracer_data:JSON.stringify(n.utm.tracer_data),custom:{},wechat_unionid:M,wechat_openid:M}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(n),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(){var e=this.initConfig.channel_domain;if(e)this.domain=e;else{var t=this.initConfig.channel;this.domain=f(L[t])}},e.prototype.setDomain=function(e){this.domain=e},e.prototype.getDomain=function(){return this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,t=null;if(this.initConfig.ab_cross){var n=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);t=n?JSON.parse(n):null}else t=this.localStorage.getItem(e);this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.clearAbCache=function(){this.ab_version="",this.ab_cache={}},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t=this.initConfig.report_url||"/list";break;case"webid":t="/webid";break;case"tobid":t="/tobid"}var n="";return this.initConfig.caller&&(n="?sdk_version="+D+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+n},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(n){void 0!==e[n]&&null!==e[n]||t.delete(n);try{t.eventCheck.calculate(n,"config")}catch(i){}if("traffic_type"===n&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[n]),"evtParams"===n)t.evtParams=i({},t.evtParams||{},e.evtParams||{});else if("_staging_flag"===n)t.evtParams=i({},t.evtParams||{},{_staging_flag:e._staging_flag});else if("reportErrorCallback"===n&&"function"==typeof e[n])t.reportErrorCallback=e[n];else{var o="",r="";if(n.indexOf(".")>-1){var a=n.split(".");o=a[0],r=a[1]}o?"user"===o||"header"===o?t.envInfo[o][r]=e[n]:t.envInfo.header.custom[r]=e[n]:Object.hasOwnProperty.call(t.envInfo.user,n)?["user_type","ip_addr_id"].indexOf(n)>-1?t.envInfo.user[n]=e[n]?Number(e[n]):e[n]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(n)>-1?t.envInfo.user[n]=e[n]?String(e[n]):e[n]:["user_is_auth","user_is_login"].indexOf(n)>-1?t.envInfo.user[n]=Boolean(e[n]):"device_id"===n&&(t.envInfo.user[n]=e[n]):Object.hasOwnProperty.call(t.envInfo.header,n)?t.envInfo.header[n]=e[n]:t.envInfo.header.custom[n]=e[n]}}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var n=Object.assign(e,t);this.storage.setItem(this.configKey,n)}}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}(),U=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog},e.prototype.warn=function(e){this.isLog},e.prototype.error=function(e){this.isLog},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),V=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var t=window.navigator.userAgent;if(!t)return!0;var n=!1;return this.spiderBot.forEach((function(e){-1!==t.indexOf(e)&&(n=!0)})),n},e}(),j=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&!!AppLogBridge}catch(e){return!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,n){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){e?t(!0):n(!1)})):n(!1)}catch(e){n(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e))}catch(e){}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(n){"user_unique_id"===n?t.setUserUniqueId(e[n]):e[n]?t.addHeaderInfo(n,e[n]):t.removeHeaderInfo(n)}))}catch(e){}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57cb\u70b9\u4e0a\u62a5",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){}},e}(),z=500,H=5005;function W(e,t,n,i,o,r,a,s,c){try{var u=new XMLHttpRequest,l=s||"POST";u.open(l,""+e,!0),u.setRequestHeader("Content-Type","application/json; charset=utf-8"),a&&u.setRequestHeader("X-MCS-AppKey",""+a),i&&(u.withCredentials=!0),n&&(u.timeout=n,u.ontimeout=function(){r&&r(t,H)}),u.onload=function(){if(o){var e=null;if(u.responseText){try{e=JSON.parse(u.responseText)}catch(t){e={}}o(e,t)}}},u.onerror=function(){u.abort(),r&&r(t,z)},c?u.send(t):u.send(JSON.stringify(t))}catch(e){}}var F=function(e,t,n,i){try{var o,r=e.match(/\/v\d\//);o=r?r[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var a=e.split(o)[0];if(!a)return void i(e,t,4001);t.forEach((function(o){var r=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t+="&"+n+"="+encodeURIComponent(JSON.stringify(e[n])));return"&"===t[0]?t.slice(1):t}(o),s=new Image(1,1);s.onload=function(){s=null,n&&n()},s.onerror=function(){s=null,i&&i(e,t,4e3)},s.src=a+"/gif?"+r}))}catch(n){i&&i(e,t,4002,n.message)}},K=function(e,t,n,i,o,r,a,s){var c=window.navigator.userAgent;if(-1===window.navigator.appName.indexOf("Microsoft Internet Explorer")||-1===c.indexOf("MSIE 8.0")&&-1===c.indexOf("MSIE 9.0")){if(a)return window.navigator&&window.navigator.sendBeacon?void(window.navigator.sendBeacon(e,JSON.stringify(t))?o():r(e,t,4003)):void F(e,t,o,r)}else F(e,t,o,r);W(e,t,n,i,o,r,"","",s)},$=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Y=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.storage=new x(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(R.SessionReset,(function(){n.resetSessionId()})),this.collect.on(R.SessionResetTime,(function(){n.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:$(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:$(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime)},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(){var e={sessionId:$(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:$(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),Q=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new P(e,t),this.cacheStorgae=new x(!0),this.localStorage=new x(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||t.report_time||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.pageId=$(),this.collect.on(R.Ready,(function(){n.reportAll(!1)})),this.collect.on(R.ConfigDomain,(function(){n.reportUrl=n.configManager.getUrl("event")})),this.collect.on(R.Event,(function(e){n.event(e)})),this.collect.on(R.BeconEvent,(function(e){n.beconEvent(e)})),this.collect.on(R.CleanEvents,(function(){n.reportAll(!1)})),this.linster()},e.prototype.linster=function(){var e=this;window.addEventListener("unload",(function(){e.reportAll(!0)}),!1),h((function(){e.reportAll(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.reportAll(!0)}),!1)},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{var n=a(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,n),this.reportTimeout&&clearTimeout(this.reportTimeout),n.length>=this.maxReport)this.report(!1);else{var i=this.reportTime;this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),i)}}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){var t=a(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.destroyInstance||this.collect.sdkStop||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))},e.prototype.reportBecon=function(){if(!this.collect.destroyInstance&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroyInstance&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var n=0;n<e.length;n+=this.eventLimit){var i;i=e.slice(n,n+this.eventLimit);var o=this.split(this.merge(i));this.send(o,t)}else o=this.split(this.merge(e)),this.send(o,t)},e.prototype.handleRefer=function(){var e="";if(this.config.spa||this.config.autotrack){var t=this.localStorage.getItem(this.refer_key)||{};e=t.routeChange?t.refer_key:document.referrer}else e=document.referrer;return e},e.prototype.merge=function(e,t){var n=this,o=this.configManager.get(),r=o.header,a=o.user;this.config.enable_pageid&&(r.custom.page_id=this.pageId),r.custom=JSON.stringify(r.custom);var s=this.configManager.get("evtParams"),c=this.configManager.get("user_unique_id_type"),u=e.map((function(e){try{Object.keys(s).length&&!t&&(e.params=i({},s,e.params)),c&&(e.params.$user_unique_id_type=c);var o=n.configManager.getAbCache();return o&&o.uuid&&o.uuid===a.user_unique_id&&n.configManager.getAbVersion()&&(e.ab_sdk_version=n.configManager.getAbVersion()),e.session_id=n.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(i){return n.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:i.message}),e}})),l=JSON.parse(JSON.stringify({events:u,user:a,header:r}));l.local_time=Math.floor(Date.now()/1e3),l.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,l.verbose=1;var d=[];return d.push(l),d},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var n=this;e.length&&(this.config.disable_track_event||e.forEach((function(e){try{var i=JSON.parse(JSON.stringify(e));n.config.filter&&(i=n.config.filter(i)),n.collect.eventFilter&&i&&(i=n.collect.eventFilter(i));var o=i||e,r=JSON.parse(JSON.stringify(o));if(n.eventCheck.checkVerify(r),!o.length)return;n.collect.emit(R.SubmitBefore,o),K(n.reportUrl,o,n.timeout,n.enable_ttwebid,(function(e,t){e&&0!==e.e?(n.collect.emit(R.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),n.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u5931\u8d25",time:Date.now(),data:r,code:e.e,failType:"\u6570\u636e\u5f02\u5e38\u5931\u8d25",status:"fail"})):(n.collect.emit(R.SubmitScuess,{eventData:t,res:e}),n.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:r,code:200,status:"success"}))}),(function(e,t){n.configManager.get("reportErrorCallback")(e,t),n.collect.emit(R.SubmitError,{type:"f_net",eventData:e,errorCode:t}),n.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u7f51\u7edc\u5f02\u5e38",time:Date.now(),data:r,code:t,failType:"\u7f51\u7edc\u5f02\u5e38\u5931\u8d25",status:"fail"})}),t,!1),n.collect.emit(R.SubmitAfter,o)}catch(e){n.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}})))},e}(),J=function(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)},X=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new x(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(R.ConfigUuid,(function(e){n.setUuid(e)})),this.collect.on(R.ConfigWebId,(function(e){n.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(R.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(R.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:J(),user_unique_id:this.configManager.get("user_unique_id")||J()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=v(window.location.href);return!(!t||!t.Web_ID||(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),0))}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),n={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77WEBID\u8bf7\u6c42",logType:"fetch",level:"info",time:Date.now(),data:n});var i=J();W(t,n,3e5,!1,(function(t){var n;t&&0===t.e?(n=t.web_id,e.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u6210\u529f",logType:"fetch",level:"info",time:Date.now(),data:t})):(n=i,e.collect.configManager.set({localWebId:i}),e.collect.emit(R.TokenError),e.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u8fd4\u56de\u503c\u5f02\u5e38",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")),e.complete({web_id:e.configManager.get("web_id")||n,user_unique_id:e.configManager.get("user_unique_id")||n})}),(function(){e.complete({web_id:e.configManager.get("web_id")||i,user_unique_id:e.configManager.get("user_unique_id")||i}),e.collect.configManager.set({localWebId:i}),e.collect.emit(R.TokenError),e.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")}))},e.prototype.complete=function(e){var t=e.web_id,n=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:n}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(R.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",n=this.configManager.get("user_unique_id");(n||t)&&this.configManager.set({user_unique_id:n||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(R.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),n=this.configManager.get("user_unique_id"),i=this.cacheToken&&this.cacheToken.user_unique_id;if(t===n&&t===i)return;this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(R.TokenChange,"uuid"),this.collect.emit(R.SessionReset)}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&this.configManager.get("user_unique_id")!==this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(R.TokenReset,"uuid"))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),n=this.configManager.get("user_unique_id");n&&n!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(R.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(R.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this,t=this.configManager.getUrl("tobid");return new Promise((function(n){W(t,{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},3e4,e.enable_ttwebid,(function(e){e&&0===e.e?n(e.tobid):n("")}),(function(){n("")}))}))},e}(),Z=function(){function e(e,t){this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.eventVerifyReady=!1,this.collect=e,this.config=t,this.app_id=t.app_id;var n=e.adapters,i=n.storage,o=n.fetch;this.cacheStorgae=new i(!1,"session"),this.fetch=o,this.eventVerifyInfo=[],this.sdk_type=D.includes("tob")?"tob":"inner",this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],t.enable_debug&&this.load()}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){},t.onload=function(){},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){}},e.prototype.load=function(){return e=this,void 0,n=function(){var e,t;return function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=v(window.location.href),1===this.getStorage()||e.open_devtool_web||parseInt(e.app_id)===this.app_id?(this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool(),[4,this.fetchEventInfo()]):[2];case 1:return t=n.sent(),this.sendData("devtool:web:verify",t.verifyStatus),this.eventVerifyInfo=t.data,[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))},new((t=void 0)||(t=Promise))((function(i,o){function r(e){try{s(n.next(e))}catch(e){o(e)}}function a(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new t((function(t){t(e.value)})).then(r,a)}s((n=n.apply(e,[])).next())}));var e,t,n},e.prototype.getStorage=function(){return this.cacheStorgae.getItem("__applog_devtool_web_"+this.app_id)},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web_"+this.app_id,1)},e.prototype.loadDevTool=function(){this.loadScript("https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/debug-web.0.0.2.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"\u57fa\u672c\u4fe1\u606f",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,"\u4e0a\u62a5\u57df\u540d":this.collect.configManager.getDomain(),"SDK\u7248\u672c":D,"SDK\u5f15\u5165\u65b9\u5f0f":"npm"}},{title:"\u7528\u6237\u4fe1\u606f",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70b9\u51fb\u83b7\u53d6SSID"}},{title:"\u516c\u5171\u53c2\u6570\u4fe1\u606f",type:2,infoName:{"\u6d4f\u89c8\u5668":this.collect.configManager.get("browser"),"\u6d4f\u89c8\u5668\u7248\u672c":this.collect.configManager.get("browser_version"),"\u5e73\u53f0":this.collect.configManager.get("platform"),"\u8bbe\u5907\u578b\u53f7":this.collect.configManager.get("device_model"),"\u64cd\u4f5c\u7cfb\u7edf":this.collect.configManager.get("os_name"),"\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c":this.collect.configManager.get("os_version"),"\u5c4f\u5e55\u5206\u8fa8\u7387":this.collect.configManager.get("resolution"),"\u6765\u6e90":this.collect.configManager.get("referrer"),"\u81ea\u5b9a\u4e49\u4fe1\u606f":""}},{title:"\u914d\u7f6e\u4fe1\u606f",type:3,infoName:{"\u5168\u57cb\u70b9":!!this.config.autotrack,"\u505c\u7559\u65f6\u957f":!!this.config.enable_stay_duration}},{title:"A/B\u914d\u7f6e\u4fe1\u606f",type:4,infoName:{"A/B\u5b9e\u9a8c":!!this.config.enable_ab_test}},{title:"\u5ba2\u6237\u7aef\u4fe1\u606f",type:3,infoName:{"\u6253\u901a\u5f00\u5173":!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(R.Ready,(function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName["\u81ea\u5b9a\u4e49\u4fe1\u606f"]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B\u57df\u540d"]=e.config.ab_channel_domain||f(A[e.config.channel]),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName["\u662f\u5426\u6253\u901a"]=!!e.collect.bridgeReport)}))},e.prototype.loadHook=function(){var e=this;this.collect.stop(),this.collect.on(y.DEBUGGER_MESSAGE,(function(t){switch(t.type){case y.DEBUGGER_MESSAGE_SDK:var n={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(n.desc={content:JSON.stringify(t.data)}),e.updateLog(n),t.secType&&"AB"===t.secType?(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case y.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var i=t.data[0],o=i.events,r=i.header;if(r.custom=JSON.parse(r.custom),!o.length)return;o.forEach((function(n){n.checkShow=!0,n.searchShow=!0,n.type=-1!==e.filterEvent.indexOf(n.event)?"sdk":"cus",n.type=e.collect.bridgeReport?"bridge":n.type,n.params=JSON.parse(n.params),"fail"===t.status&&(n.info={message:"code: "+t.code+"\uff0c msg: "+t.failType},n.failType=t.failType);var i=!1,o=!1,r=[];e.eventVerifyInfo&&e.eventVerifyInfo.length&&(e.eventVerifyInfo.forEach((function(e){e.eventStatus=!1})),e.eventVerifyInfo.forEach((function(t){n.event===t.name&&(o=!0,i=!0,n.verifyStatus=t.status,Object.keys(n.params).forEach((function(i){if("event_index"!==i){var a={};a.paramsKey=i,a.paramsKeyValue=n.params[""+i],a.paramsStatus=!1,a.paramsStatusInfo="\u5c5e\u6027\u672a\u5f55\u5165",t.params.forEach((function(t){i===t.name&&(t.checked=!0,typeof n.params[""+i]!==e.formatParamsType(t.value_type)?a.paramsStatusInfo="\u5c5e\u6027\u7c7b\u578b\u9519\u8bef\uff0c\u5e94\u4e3a"+e.formatParamsType(t.value_type):(a.paramsStatus=!0,a.paramsStatusInfo=""))})),r.push(a),a.paramsStatusInfo&&(o=!1)}})),t.params.forEach((function(e){e.checked||(o=!1,r.push({paramsKey:e.name,paramsStatus:!1,paramsStatusInfo:"\u7f3a\u5c11\u5c5e\u6027"+e.name}))})))}))),n.reportStatus="success"===t.status,n.paramsInfo=r,n.eventStatus=o&&"success"===t.status,n.eventRecord=i})),e.updateEvent(i)}return}}))},e.prototype.formatParamsType=function(e){switch(e){case 0:return"string";case 1:case 2:return"number";case 3:return"boolean"}},e.prototype.fetchEventInfo=function(){var e=this;try{return new Promise((function(t){var n=f("1fz22z22z1nz21z4mz4bz4bz18z1nz1nz1jz1mz1ez1fz1mz1kz1cz4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22z4bz18z1nz1nz1jz1mz1ez1bz1cz24z22z1mz1mz1jz21z4bz1mz1nz1cz1lz18z1nz1gz4bz24z4dz4bz18z1nz1nz16z1jz1mz1ez16z1kz1cz22z18")+"?app_id="+e.app_id+"&t="+e.sdk_type+"&nc=false";e.fetch(n,null,3e3,!1,(function(n){e.eventVerifyReady=!0,e.collect.reStart(),t({data:n.data,verifyStatus:!0})}),(function(){e.eventVerifyReady=!0,e.collect.reStart(),t({data:[],verifyStatus:!1})}),"","GET")}))}catch(e){return{data:[],verifyStatus:!1}}},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t.origin===location.origin){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event,appid:e.app_id}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()}))}}))},e.prototype.sendData=function(e,t){try{var n={type:e,payload:t};(window.opener||window.parent).postMessage(n,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady||this.eventVerifyReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode("#debugger-applog-web {\n      position: fixed;\n      width: 50px;\n      height: 50px;\n      background-image: url('https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/applog.png');;\n      bottom: 5%;\n      right: 10%;\n      cursor: pointer;\n      z-index:100;\n      background-size: 50px;\n    }")),e.appendChild(t);var n=document.createElement("div");n.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web"></div>';var i=document.createElement("div");i.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(n),document.getElementsByTagName("body")[0].appendChild(i),document.getElementById("debugger-applog-web").addEventListener("click",(function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),ee=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroyInstance=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=e,this.hook=new c,this.remotePlugin=new Map,this.Types=R,this.adapters.fetch=W,this.adapters.storage=x,this.loadType="full"}return e.usePlugin=function(t,n,i){if(n){for(var o=!1,r=0,a=e.plugins.length;r<a;r++)if(e.plugins[r].name===n){e.plugins[r].plugin=t,e.plugins[r].options=i||{},o=!0;break}o||e.plugins.push({name:n,plugin:t,options:i})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,n){e&&("full"===this.loadType&&this.remotePlugin.get(e)||(t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:n}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk")))},e.prototype.init=function(t){var n,i=this;this.logger=new U(this.name,t.log),this.inited?this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):t&&u(t)?t.app_id&&"number"==typeof(n=t.app_id)&&!isNaN(n)?!t.app_key||function(e){return"string"==typeof e}(t.app_key)?(t.channel_domain||-1!==["cn","sg","va"].indexOf(t.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !"),t.channel="cn"),this.spider=new V,this.spider.checkSpider(t)?this.logger.warn("your env may be a spider, can not report!"):(this.appBridge=new j(this,t.enable_native),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new q(this,t),this.debugger=new Z(this,t),this.initConfig=t,this.emit(R.Init),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cINIT",data:t,level:"info",time:Date.now()}),t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new Q,this.tokenManager=new X,this.sessionManager=new Y,Promise.all([new Promise((function(e){i.once(R.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){i.once(R.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var n=t.plugin,o=t.options,r=Object.assign(i.initConfig,o),a=new n;return a.apply(i,r),e.push(a),e}),i.pluginInstances)}catch(t){i.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}i.sdkReady=!0,i.emit(R.Ready),i.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u521d\u59cb\u5316\u5b8c\u6210",time:Date.now(),level:"info",data:i.configManager.get("user")}),i.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(i.configManager.get("user"))),i.logger.info("appid: "+t.app_id+", sdk is ready, version type is "+i.loadType+", version is "+D+", you can report now !!!"),t.disable_auto_pv&&(i.disableAutoPageView=!0);try{"full"===i.loadType&&(t.enable_ab_test||t.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(t){i.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}i.pageView(),i.on(R.TokenChange,(function(e){"webid"===e&&i.pageView(),i.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u8bbe\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(R.TokenReset,(function(){i.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u91cd\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(R.RouteChange,(function(e){e.init||t.disable_route_report||i.pageView()}))})),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t)),this.inited=!0)):this.logger.warn("app_key param is error, must be string, please check!"):this.logger.warn("app_id param is error, must be number, please check!"):this.logger.warn("init params error,please check!")},e.prototype.config=function(e){if(this.inited)if(e&&u(e))if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var t=i({},e),n=this.initConfig.configPersist||this.initConfig.config_persist||!1;if(this.initConfig&&n){var o=this.configManager.getStore();o&&(t=Object.assign(o,e)),this.configManager.setStore(e)}t.web_id,t.user_unique_id;var r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&(n[i[o]]=e[i[o]])}return n}(t,["web_id","user_unique_id"]);this.configManager.set(r),t.hasOwnProperty("web_id")&&this.emit(R.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(R.ConfigUuid,t.user_unique_id),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cCONFIG",level:"info",time:Date.now(),data:t})}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.setUserUniqueID=function(e){this.config({user_unique_id:e})},e.prototype.setHeaderInfo=function(e,t){var n={};n[e]=t,this.config(n)},e.prototype.removeHeaderInfo=function(e){var t={};t[e]=void 0,this.config(t)},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(R.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.started=!0,this.emit(R.Start),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(R.Ready)))},e.prototype.event=function(e,t){var n=this;try{var i=[];if(Array.isArray(e))e.forEach((function(e){var t=n.processEvent(e[0],e[1]||{});t&&i.push(t)}));else{var o=this.processEvent(e,t);if(!o)return;i.push(o)}this.bridgeReport?i.forEach((function(e){var t=e.event,i=e.params;n.appBridge.onEventV3(t,JSON.stringify(i))})):i.length&&(this.emit(R.Event,i),this.emit(R.SessionResetTime))}catch(e){this.logger.warn("something error, please check"),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){if(Array.isArray(e))this.logger.warn("beconEvent not support batch report, please check");else{var n=[],i=this.processEvent(e,t||{});i&&(n.push(i),n.length&&(this.emit(R.BeconEvent,n),this.emit(R.SessionResetTime)))}},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return this.logger.warn("eventName is null\uff0c please check"),null;var n=e;/^event\./.test(e)&&(n=e.slice(6));var i=t;"object"!=typeof i&&(i={}),i.profile?delete i.profile:i.event_index=d();var o=void 0;return i.local_ms?(o=i.local_ms,delete i.local_ms):o=+new Date,{event:n,params:i,local_time_ms:o,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(n){return this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:n.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,n){this.hook.emit(e,t,n)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.stop=function(){this.sdkStop=!0},e.prototype.reStart=function(){this.sdkStop=!1},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){if(void 0===e&&(e={}),this.inited){var t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},n=i({},t,e);this.event("predefine_pageview",n)}},e.prototype.clearEventCache=function(){this.emit(R.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=g(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(R.CustomWebId)}},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=g(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(R.CustomWebId)}},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.resetStayDuration=function(e,t,n){this.emit(R.ResetStay,{url_path:e,title:t,url:n},R.Stay)},e.prototype.resetStayParams=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),this.emit(R.SetStay,{url_path:e,title:t,url:n},R.Stay)},e.prototype.getToken=function(e,t){var n=this;if(this.inited){var o=!1,r=function(t){if(!o){o=!0;var r=n.configManager.get().user;return t&&(r.tobid=t,r["diss".split("").reverse().join("")]=t),e(i({},r))}},a=function(){n.tokenManager.getTobId().then((function(e){r(e)}))};this.sdkReady?a():(t&&setTimeout((function(){r()}),t),this.on(R.Ready,(function(){a()})))}},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(R.ProfileSet,e,R.Profile),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(R.ProfileSetOnce,e,R.Profile),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(R.ProfileIncrement,e,R.Profile),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(R.ProfileUnset,e,R.Profile),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(R.ProfileAppend,e,R.Profile),this.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(R.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,R.Ab)},e.prototype.getVar=function(e,t,n){this.emit(R.AbVar,{name:e,defaultValue:t,callback:n},R.Ab)},e.prototype.getABconfig=function(e,t){this.emit(R.AbConfig,{params:e,callback:t},R.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(R.AbVersionChangeOn,e,R.Ab),function(){t.emit(R.AbVersionChangeOff,e,R.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(R.AbVersionChangeOff,e,R.Ab)},e.prototype.openOverlayer=function(){this.emit(R.AbOpenLayer,"",R.Ab)},e.prototype.closeOverlayer=function(){this.emit(R.AbCloseLayer,"",R.Ab)},e.prototype.getAllVars=function(e){this.emit(R.AbAllVars,e,R.Ab)},e.prototype.autoInitializationRangers=function(e){var t,n,i,o,r,a,s,c;n=(t=e).app_id,i=t.channel,o=t.onTokenReady,r=L[i]+"/webid",a=new x(!1),s="__tea_cache_tokens_"+n,(c=a.getItem(s))&&c.web_id?o(c.web_id):K(r,{app_key:"",app_id:n,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},3e3,!1,(function(e){if(e&&0===e.e){o(e.web_id);var t={web_id:e.web_id,user_unique_id:e.web_id,timestamp:Date.now()};a.setItem(s,t)}else o("")}),(function(){o("")}),!0)},e.prototype.destoryInstace=function(){this.destroyInstance||(this.destroyInstance=!0,this.off(R.TokenComplete))},e.plugins=[],e}(),te="__rangers_ab_style__",ne={},ie=[],oe=function(e){e.length&&e.forEach((function(e){ie.push(e)}))};function re(e,t,n,i){var o=e&&e.source||window.opener||window.parent,r=e&&e.origin||i||"*",a={type:t,payload:n};o.postMessage(JSON.stringify(a),r)}function ae(e,t){ne[e]=ne[e]||[],ne[e].push(t)}function se(e){if(ie.some((function(e){return"*"===e}))||ie.some((function(t){return e.origin.indexOf(t)>-1}))){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(!t)return;var n=t.type,i=t.payload;ne[n]&&ne[n].forEach((function(t){"function"==typeof t&&t(e,i)}))}}function ce(e,t){var n=i({},e);delete n.filter,(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:n,version:t},"*"),window.addEventListener("message",se,!1)}var ue,le="",de=!1;function fe(e){var t=e.event,n=e.editorUrl;e.collectInstance,e.fromSession,de||(de=!0,p(n,(function(){re(t,"abEditorScriptloadSuccess")}),(function(){t&&re(t,"abEditorScriptloadError"),de=!1})))}!function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(ue||(ue={}));var he=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,this.config.enable_ab_test){var i=t.enable_multilink,o=t.ab_channel_domain,r=t.enable_ab_visual,a=t.ab_cross,s=t.ab_cookie_domain,c=o||f(A[t.channel||"cn"]),u=e.adapters,l=u.storage,d=u.fetch;this.cacheStorgae=new l(!1),this.fetch=d,this.enable_multilink=i,this.enable_ab_visual=r,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.ab_cross=a,this.ab_cookie_domain=s||"",this.fetchUrl=c+"/service/2/abtest_config/",this.reportUrl=""+e.configManager.getUrl("event"),this.exposureLimit=t.exposure_limit||20,this.ab_batch_time=t.ab_batch_time||500;var h=this.collect.Types;this.types=h,this.collect.on(h.TokenChange,(function(e){"uuid"===e&&n.readyStatus&&(n.clearCache(),n.fetchAB())})),this.collect.on(h.TokenReset,(function(e){"uuid"===e&&n.readyStatus&&(n.clearCache(),n.fetchAB())})),this.collect.on(h.AbVar,(function(e){var t=e.name,i=e.defaultValue,o=e.callback;n.getVar(t,i,o)})),this.collect.on(h.AbAllVars,(function(e){n.getAllVars(e)})),this.collect.on(h.AbConfig,(function(e){var t=e.params,i=e.callback;n.getABconfig(t,i)})),this.collect.on(h.AbExternalVersion,(function(e){n.setExternalAbVersion(e)})),this.collect.on(h.AbOpenLayer,(function(){n.openOverlayer()})),this.collect.on(h.AbCloseLayer,(function(){n.closeOverlayer()})),this.collect.on(h.AbVersionChangeOn,(function(e){n.changeListener.set(e,e)})),this.collect.on(h.AbVersionChangeOff,(function(e){n.changeListener.get(e)&&n.changeListener.delete(e)})),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(h.AbReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var n=this.collect.hook._hooksCache[e];if(!Object.keys(n).length)return;var i=function(e){n[e].length&&n[e].forEach((function(n){t.collect.hook.emit(e,n)}))};for(var o in n)i(o)}},e.prototype.loadMode=function(){var e,t,n=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}}(),i="";if(n){var o=n.scenario,r=n.href;o?(this.editMode=!0,i=o):!r||-1===r.indexOf("datatester")&&-1===r.indexOf("visual-editor")||(this.editMode=!0,i="visual-editor")}this.enable_ab_visual&&(function(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{},oe(["*"]);var n,i="";ce(t,D);var o="";try{var r=window.performance.getEntriesByType("resource");if(r&&r.length&&(r.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(o=e.name)})),o||document.currentScript&&(o=document.currentScript.src),o&&(n=o.split("/"))&&n.length)){i="https:/";for(var a=2;a<n.length&&a!==n.length-1;a++)i=i+"/"+n[a];i+="/visual-ab-core"}}catch(e){}ae("tea:openVisualABEditor",(function(n){var o=n.data;if("string"==typeof n.data)try{o=JSON.parse(n.data)}catch(e){o=void 0}if(o){var r=o.lang;if(o.appId!==t.app_id)return void re(n,"appIdError");var a=o.version;le=a&&i?i+(a?"."+a:".1.0.1")+".js?query="+Date.now():"https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-core.js?query="+Date.now(),window.TEAVisualEditor.lang=r,window.TEAVisualEditor.__ab_domin=t.channel_domain||"",fe({event:n,editorUrl:le,collectInstance:e})}}))}(this.collect,this.config),"visual-editor"===i)?this.collect.destoryInstace():this.enable_multilink&&(e=this.collect,t=this.config,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=t.app_id,ae("tea:openTesterEventInspector",(function(t){var n=t.data;if("string"==typeof t.data)try{n=JSON.parse(t.data)}catch(e){n=void 0}if(n){var i=n.referrer,o=n.lang,r=n.appId;window.TEAVisualEditor.__editor_ajax_domain=i||"",window.TEAVisualEditor.__ab_appId=r||"",window.TEAVisualEditor.lang=o||"",fe({event:t,editorUrl:"https://lf3-data.volccdn.com/obj/data-static/log-sdk/collect/tester-event-inspector.js?query="+Date.now(),collectInstance:e})}})))},e.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,n=e.ab_ext_version,i=e.ab_version_multilink,o=e.data,r=this.checkFromUrl();r?this.mulilinkVersions.push(r):this.mulilinkVersions=i||[],this.extVersions=n||[],this.versions=t||[],this.data=o;var a=this.versions.concat(this.extVersions);this.enable_multilink&&(a=a.concat(this.mulilinkVersions)),this.configVersions(a.join(","))},e.prototype.checkFromUrl=function(){var e=v(window.location.href);return e&&e.vid?e.vid:""},e.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach((function(t){"function"==typeof t&&t(e)}))},e.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},e.prototype.getVar=function(e,t,n){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof n)throw new Error("callback must be a function");var i={name:e,defaultValue:t,callback:n,type:ue.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(i,e):this.callbacks.push(i)},e.prototype.getRealVar=function(e,t){var n=e.name,i=e.defaultValue,o=e.callback,r=this.data;if(r){if(u(r[n])){var a=r[n].vid;return"$ab_url"===t?this.mulilinkVersions.includes(a)||this.mulilinkVersions.push(a):this.versions.includes(a)||this.versions.push(a),this.updateVersions(),this.fechEvent(a,t,i),o(r[n].val),void this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u66dd\u5149\u4e86\u5b9e\u9a8c"+n,level:"info",time:Date.now(),data:r[n]})}this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getVar",level:"info",time:Date.now(),data:i}),o(i)}else o(i)},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:ue.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbacks.push(t)},e.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getAllVars",level:"info",time:Date.now(),data:this.data})},e.prototype.fechEvent=function(e,t,n){try{if(this.config.disable_track_event)return;if(!e)return;var i=this.collect.configManager.get(),o=i.header,r=i.user,a=this.getABCache();if(a&&a.uuid&&a.uuid!==r.user_unique_id)return;var s={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?n:window.location.href}),local_time_ms:Date.now()};o.custom=JSON.stringify(o.custom);var c={events:[s],user:r,header:o};"$ab_url"===t&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([c])):this.reportExposure(c)}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.reportExposure=function(e){var t=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report():this.reportTimeout=setTimeout((function(){t.report(),clearTimeout(t.reportTimeout)}),this.ab_batch_time)},e.prototype.report=function(){var e=this;this.fetch(this.reportUrl,this.exposureCache,2e4),this.exposureCache.forEach((function(t){e.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:[t],code:200,status:"success"})})),this.exposureCache=[]},e.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},e.prototype.getABconfig=function(e,t){var n=Object.keys(e);n&&n.length&&this.collect.configManager.set(e),this.fetchAB(t)},e.prototype.get=function(e){if(this.ab_cross){var t=this.cacheStorgae.getCookie(e,this.ab_cookie_domain);return t?JSON.parse(t):{}}return this.cacheStorgae.getItem(e)},e.prototype.set=function(e,t){this.ab_cross?this.cacheStorgae.setCookie(e,t,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(e,t),this.collect.configManager.setAbCache(t)},e.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.get(this.abKey)||t,e?t[e]:t},e.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},e.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.set(this.abKey,t)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},e.prototype.openOverlayer=function(e){var t=this;if(function(){if(!document.getElementById(te)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id=te,n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}}(),e)var n=setTimeout((function(){t.closeOverlayer(),clearTimeout(n)}),e)},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(te))&&e.parentElement.removeChild(e)},e.prototype.fetchComplete=function(e,t){var n=this;try{if(e&&"[object Object]"==Object.prototype.toString.call(e)){this.data=e,this.setAbCache(t);var i=[];Object.keys(e).forEach((function(t){var n=e[t].vid;n&&i.push(n)})),this.versions=this.versions.filter((function(e){return i.includes(e)}));var o=e.$ab_url,r=e.$ab_modification;if(r&&r.val&&this.enable_ab_visual){if(this.collect.destroyInstance)return;this.getVar("$ab_modification",window.location.href,(function(){var e;e=r.val,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.__ab_config=e,p("https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-loader.js?query="+Date.now(),(function(){}),(function(){})),n.closeOverlayer()}))}else if(o&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter((function(e){return i.includes(e)}));var a=o.val,s=o.vid;a&&s&&this.getVar("$ab_url",a,(function(){n.editMode||(a!==window.location.href?setTimeout((function(){if(!n.collect.destroyInstance){var e=""+a;e=-1===e.indexOf("http")?"https://"+e:e,m(e).host!==location.host?e=e+"&vid="+s:window.history.replaceState("","",e),window.location.href=e}}),100):n.closeOverlayer())}))}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach((function(e){return n[e.type===ue.Var?"getRealVar":"getRealAllVars"](e,"")})),this.callbacks=[]}catch(e){}},e.prototype.fetchAB=function(e){var t=this,n=this.collect.configManager.get(),o={header:i({aid:this.config.app_id},n.user||{},n.header||{},{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77AB\u5b9e\u9a8c\u8bf7\u6c42",level:"info",logType:"fetch",time:Date.now(),data:o}),this.fetch(this.fetchUrl,o,this.config.ab_timeout||3e3,!1,(function(i){t.fetchStatus="complete",t.refreshFetchStatus="complete";var o=i.data;"success"===i.message?(t.fetchComplete(o,n.user.user_unique_id),e&&e(o)):(t.fetchComplete(null,n.user.user_unique_id),e&&e(null)),t.collect.emit(t.types.AbComplete,o),t.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u6210\u529f",level:"info",logType:"fetch",time:Date.now(),data:o})}),(function(){t.fetchStatus="complete",t.refreshFetchStatus="complete",t.fetchComplete(null,n.user.user_unique_id),t.collect.emit(t.types.AbTimeout),e&&e(null),t.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",level:"error",logType:"fetch",time:Date.now()})}))},e.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true[\0-\xff]*":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true[\0-\xff]*");var n=new RegExp(t,"g");e=e.replace(n,"")}catch(e){}return e},e}(),pe=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(e.adapters.fetch,t.event_verify_url&&"string"==typeof t.event_verify_url&&(this.url=t.event_verify_url+"/v1/list_test",this.url)){var i=e.Types;e.on(i.SubmitBefore,(function(e){window.navigator.sendBeacon(n.url,JSON.stringify(e))}))}},e}(),_e=function(){function e(e,t){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.collect=e,this.config=t,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,u(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration))}return e.prototype.setParams=function(e,t,n){this.set_path=e,this.set_url=n,this.set_title=t},e.prototype.enable=function(e,t,n){this.url_path=e,this.url=n,this.title=t,this.disableCallback=this.enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype.sendEvent=function(e,t){void 0===t&&(t=!1);var n=t?this.aliveDTime:Date.now()-this.sessionStartTime;n<0||n>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||(this.collect.beconEvent(this.options.aliveName,i({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:n,is_support_visibility_change:_(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:e},this.options.params)),this.sessionStartTime=Date.now())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval((function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!1,!0)}),1e3)},e.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},e.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},e.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var t=this.visibilitychange.bind(this),n=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",n),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",n)}},e}(),me=function(){function e(e,t){var n=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.visibilitychange=function(){"hidden"===document.visibilityState?n.activeEndTime=Date.now():"visible"===document.visibilityState&&(n.activeEndTime&&(n.totalTime+=n.activeEndTime-n.activeStartTime,n.activeTimes+=1),n.activeEndTime=void 0,n.activeStartTime=Date.now())},this.beforeunload=function(){if(n.totalTime+=(n.activeEndTime||Date.now())-n.activeStartTime,n.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:n.totalTime,page_title:document.title||location.pathname}))}catch(e){}n.sendEventPageClose()},this.collect=e,this.config=t,this.maxDuration=t.maxDuration||t.max_duration||864e5,this.pageStartTime=Date.now(),u(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.resetData()}return e.prototype.setParams=function(e,t,n){this.set_path=e,this.set_url=n,this.set_title=t},e.prototype.resetParams=function(e,t,n){this.url_path=e,this.url=n,this.title=t},e.prototype.enable=function(e,t,n){this.url_path=e,this.url=n,this.title=t,this.disableCallback=this.enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,location.href,document.title)},e.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.collect.beconEvent(this.options.closeName,i({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:_()},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.enablePageClose=function(){var e=this,t=this.visibilitychange.bind(this),n=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",n),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",n)}},e}(),ve=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new _e(e,t),this.pageClose=new me(e,t);var i=this.collect.Types;this.collect.on(i.ResetStay,(function(e){var t=e.url_path,i=e.title,o=e.url;n.resetStayDuration(t,i,o)})),this.collect.on(i.RouteChange,(function(e){e.init||t.disable_route_report||n.resetStayDuration()})),this.collect.on(i.SetStay,(function(e){var t=e.url_path,i=e.title,o=e.url;n.setStayParmas(t,i,o)})),this.enable(this.url_path,this.title,this.url),this.ready(i.Stay),this.collect.emit(i.StayReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var n=this.collect.hook._hooksCache[e];if(!Object.keys(n).length)return;var i=function(e){n[e].length&&n[e].forEach((function(n){t.collect.hook.emit(e,n)}))};for(var o in n)i(o)}},e.prototype.enable=function(e,t,n){this.pageAlive.enable(e,t,n),this.pageClose.enable(e,t,n)},e.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.setStayParmas=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),this.pageAlive.setParams(e,t,n),this.pageClose.setParams(e,t,n),this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884c resetStayParams",level:"info",time:Date.now(),data:{url_path:e,title:t,url:n}})},e.prototype.reset=function(e,t,n){this.disable(),this.enable(e,t,n)},e.prototype.resetStayDuration=function(e,t,n){this.reset(e,t,n),this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884c resetStayDuration",level:"info",time:Date.now(),data:{url_path:e,title:t,url:n}})},e}(),ge=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.duration=6e4,this.reportUrl=e.configManager.getDomain()+"/profile/list";var i=e.Types,o=e.adapters.fetch;this.eventCheck=new P(e,t),this.fetch=o,this.cache={},this.collect.on(i.ProfileSet,(function(e){n.setProfile(e)})),this.collect.on(i.ProfileSetOnce,(function(e){n.setOnceProfile(e)})),this.collect.on(i.ProfileUnset,(function(e){n.unsetProfile(e)})),this.collect.on(i.ProfileIncrement,(function(e){n.incrementProfile(e)})),this.collect.on(i.ProfileAppend,(function(e){n.appendProfile(e)})),this.collect.on(i.ProfileClear,(function(){n.cache={}})),this.ready(i.Profile)},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var n=this.collect.hook._hooksCache[e];if(!Object.keys(n).length)return;var i=function(e){n[e].length&&n[e].forEach((function(n){t.collect.hook.emit(e,n)}))};for(var o in n)i(o)}},e.prototype.report=function(e,t){void 0===t&&(t={});try{if(this.config.disable_track_event)return;var n=[];n.push(this.collect.processEvent(e,t));var i=this.collect.eventManager.merge(n);this.fetch(this.reportUrl,i),this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:i,code:200,status:"success"})}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setProfile=function(e){var t=this.formatParams(e);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set",i({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this.formatParams(e,!0);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set_once",i({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e&&this.report("__profile_increment",i({},e,{profile:!0}))},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",i({},t,{profile:!0}))}},e.prototype.appendProfile=function(e){if(e){var t={};for(var n in e)("string"==typeof e[n]||"Array"===Object.prototype.toString.call(e[n]).slice(8,-1))&&(t[n]=e[n]);Object.keys(t).length&&this.report("__profile_append",i({},t,{profile:!0}))}},e.prototype.pushCache=function(e){var t=this;Object.keys(e).forEach((function(n){t.cache[n]={val:t.clone(e[n]),timestamp:Date.now()}}))},e.prototype.formatParams=function(e,t){var n=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return;var i={};for(var o in e)("string"==typeof e[o]||"number"==typeof e[o]||"Array"===Object.prototype.toString.call(e[o]).slice(8,-1))&&(i[o]=e[o]);var r=Object.keys(i);if(!r.length)return;if(!this.eventCheck.checkEventParams(i))return;var a=Date.now();return r.filter((function(i){var o=n.cache[i];return t?!o:!(o&&n.compare(o.val,e[i])&&a-o.timestamp<n.duration)})).reduce((function(e,t){return e[t]=i[t],e}),{})}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.clone=function(t){try{return JSON.parse(JSON.stringify(t))}catch(e){return this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),t}},e.prototype.unReady=function(){},e}(),Ee=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var n,i=Date.now()+t;return n=window.setTimeout((function o(){var r=Date.now()-i;e(),i+=t,n=window.setTimeout(o,Math.max(0,t-r))}),t),function(){window.clearTimeout(n)}}((function(){e.isSessionhasEvent&&e.endCurrentSession()}),e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,!t.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var i=this.collect.Types;this.collect.on(i.SessionReset,(function(){n.process()}))}},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),be=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,!this.config.channel_domain){var i=e.adapters.fetch;if(this.fetch=i,!t.disable_track_event&&!t.disable_sdk_monitor){this.url=e.configManager.getUrl("event");var o=this.collect.Types;this.collect.on(o.Ready,(function(){n.sdkOnload()})),this.collect.on(o.SubmitError,(function(e){var t=e.type,i=e.eventData,o=e.errorCode;"f_data"===t&&n.sdkError(i,o)}))}}},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),n=t.header,i=t.user,o=n.app_id,r=n.app_name,a=n.sdk_version,s=i.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:o,app_name:r||"",sdk_version:a,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC",url:location.href}),local_time_ms:Date.now()}],user:{user_unique_id:s},header:{}};setTimeout((function(){e.fetch(e.url,[c],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(e){}},e.prototype.sdkError=function(e,t){var n=this;try{var i=e[0],o=i.user,r=i.header,a=[];e.forEach((function(e){e.events.forEach((function(e){a.push(e)}))}));var s={events:a.map((function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:r.app_id,app_name:r.app_name||"",error_event:e.event,sdk_version:r.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(r),user:JSON.stringify(o)}),local_time_ms:Date.now()}})),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout((function(){n.fetch(n.url,[s],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(e){}},e}();function ye(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0}return!1}function we(e){for(var t=e;t&&!ye(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function Se(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}var Ce=function(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0},ke=function(e,t){if("string"==typeof t)return Ce(e,t);if(l(t)){for(var n=!1,i=0;i<t.length;i++)if(Ce(e,t[i])){n=!0;break}return n}},Te=function(e,t){var n={};if("string"==typeof t)Ce(e,t)&&(n.attrs=e.getAttribute(t));else if(l(t))for(var i=0;i<t.length;i++)Ce(e,t[i])&&(n[t[i]]=e.getAttribute(t[i]));return n},Oe=function(){function e(e,t,n){var o=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(e){(function(e,t){if(window.innerHeight,window.innerWidth,1!==e.nodeType)return!1;if(!t.svg&&function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,n=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,n=!0):t=t.parentElement;return n}(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var n=e;return!("none"===n.style.display||!ye(n,"container")&&!function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some((function(e){return e.children.length>0}))}return!0}(n)&&!t.svg)})(e.target,o.options)&&o.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){o.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){o.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t){t&&"pushState"===t&&o.eventHandel({eventType:"dom",eventName:"beat"},i({beat_type:0},e)),o.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(e){o.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=n.getConfig().eventConfig,this.collect=t,this.options=e,this.beatTime=e.beat}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e){if(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv){this.collect.on("route-change",(function(e){var n=e.config,i=e.name;t.getPageViewEvent(n,i),t.pageView=!0}));var n=setTimeout((function(){t.pageView||(t.getPageViewEvent(t.getDefaultConfig()),t.pageView=!0,clearTimeout(n))}),2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",(function(){t.beatEvent(t.beatTime)}));var i=0,o=null;window.addEventListener("scroll",(function(){clearTimeout(o),o=setTimeout(r,500),i=document.documentElement.scrollTop||document.body.scrollTop}));var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==i&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var a=window.performance&&window.performance.getEntriesByType("paint");if(a&&a.length){new PerformanceObserver((function(e){var n=e.getEntries(),i=n[n.length-1],o=i.renderTime||i.loadTime;t.statistics||(t.getPageLoadEvent(o),t.statistics=!0)})).observe({entryTypes:["largest-contentful-paint"]});var s=setTimeout((function(){t.statistics||(t.getPageLoadEvent(a[0].startTime||0),t.statistics=!0,clearTimeout(s))}),2e3)}else this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(e){var t=this;try{var n;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(n=setInterval((function(){t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})}),e)),h((function(){t.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),t.beatTime&&clearInterval(n)}))}catch(e){}},e.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},e}(),xe={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},Ie=function(){function e(e,t){this.config=e,this.config.eventConfig=Object.assign(this.config.eventConfig,t)}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function Ae(e,t,n,i){var o={},r=function(e){if(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;return{left:t.left,top:t.top,element_width:n,element_height:i}}}(t),a=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=e.clientX,i=e.clientY,o=t.left,r=t.top,a=n-o>=0?n-o:0,s=i-r>=0?i-r:0;return{touch_x:Math.floor(a),touch_y:Math.floor(s)}}(e,r),s=r.element_width,c=r.element_height,u=a.touch_x,l=a.touch_y,d=function(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var n=[],i=[];return t.forEach((function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,n=e.parentElement;if(n)for(var i=n.children,o=0;o<i.length&&i[o]!==e;o++)i[o].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),ye(e,"list")?"[]":""].join(""),index:t}}(e),o=t.str,r=t.index;n.unshift(o),i.unshift(r)})),{element_path:"/"+n.join("/"),positions:i}}(t),f=d.element_path,h=d.positions,p=function(e){var t=we(e),n=[];return function e(t){var i=Se(t);if(i&&-1===n.indexOf(i)&&n.push(i),t.childNodes.length>0)for(var o=t.childNodes,r=0;r<o.length;r++)8!==o[r].nodeType&&e(o[r])}(t),n}(t),_=window.performance.timing.navigationStart,m=Date.now()-_,v=h.map((function(e){return""+e})),g=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(g=window.TEAVisualEditor.getOriginXpath({xpath:f,positions:v})),o.element_path=g&&g.xpath||f,o.positions=g&&g.positions||v,i&&!i.text&&(o.texts=p,o.element_title=function(e){var t=we(e),n="";return function e(t){var i=Se(t);if(i&&(n+=i),t.childNodes.length>0)for(var o=t.childNodes,r=0;r<o.length;r++)3===o[r].nodeType&&e(o[r])}(t),n}(t)),o.element_id=t.getAttribute("id")||"",o.element_class_name=t.getAttribute("class")||"",o.element_type=t.nodeType,o.element_width=Math.floor(s),o.element_height=Math.floor(c),o.touch_x=u,o.touch_y=l,o.page_manual_key="",o.elememt_manual_key="",o.since_page_start_ms=m,o.page_start_ms=_,o.page_path=location.pathname,o.page_host=location.host,n.track_attr&&function(e,t){return!!ke(e,t)}(t,n.track_attr)){var E=Te(t,n.track_attr);for(var b in E)o[b]=E[b]}var y=we(t);return"A"===y.tagName&&(o.href=y.getAttribute("href")),"IMG"===t.tagName&&(o.src=t.getAttribute("src")),o}var Le=function(e,t,n,o,r){return i({event:e},Ae(t,n,o,r),{is_html:1,page_key:window.location.href,page_title:document.title})},De=function(){function e(e,t){this.ignore={text:!1},this.initConfig=e,this.options=t,this.eventName=t&&"tea"===t.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure"},t&&!1===t.text&&(this.ignore.text=!0),t&&t.exposure&&t.exposure.eventName&&(this.eventName.exposure=t.exposure.eventName)}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}(e.target))return null;var n="bav2b_click";switch(t){case"click":return n=this.eventName.click,Le(n,e,e.target,this.options,this.ignore);case"exposure":return n=this.eventName.exposure,Le(n,e,e.target,this.options,this.ignore);case"change":return i({},Le(n="bav2b_change",e,e.target,this.options),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(n,e.target));case"submit":return Le(n="bav2b_submit",e,e.target,this.options)}}catch(i){return null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var n=JSON.parse(t);e.refer_page_duration_ms=n?n.duration:""}e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"",t.refer_page_manual_key="";try{var n=e.lcp,i=window.performance.timing,o=i.loadEventEnd-i.navigationStart;t.page_init_cost_ms=parseInt(n||(o>0?o:0)),t.page_start_ms=i.navigationStart}catch(e){}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e}(),Pe=function(){function e(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){var n=e.eventSend,i=t.event;delete t.event,n&&"becon"===n?this.collect.beconEvent(i,t):this.collect.event(i,t)},e.prototype.get=function(e,t){var n=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,n)},e.prototype.post=function(e,t){var n=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,n)},e}(),Re="_TEA_VE_OPEN",Me="_TEA_VE_APIHOST",Ne="lang",Ge="_VISUAL_EDITOR_V",Be="_VISUAL_EDITOR_U";function qe(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||w.get(Ne),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||w.get(Me),n=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||w.get(Ge),i=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||w.get(Be),o=+new Date,r=new Date(o+18e5);w.set(Re,"1",{expires:r}),w.set(Me,t,{expires:r}),w.set(Be,i,{expires:r}),w.set(Ne,e,{expires:r}),w.set(Ge,n||"",{expires:r})}catch(e){}}var Ue=!1;function Ve(e){var t=e.event,n=e.editorUrl,i=e.autoTrackInstance;Ue||(Ue=!0,p(n,(function(){re(t,"editorScriptloadSuccess"),i.destroy()}),(function(){t&&re(t,"editorScriptloadError"),Ue=!1})))}var je,ze=function(){function e(e){this._instance=null,this._intersection=e,this.init()}return e.prototype.init=function(){var e=this;this._instance=new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e.attributeChangeObserve(t),"childList"===t.type&&e.modifyNodeObserve(t)}))})),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})},e.prototype.attributeChangeObserve=function(e){e.target.hasAttribute("data-exposure")?this.exposureAdd(e,"mutation"):this.exposureRemove(e)},e.prototype.modifyNodeObserve=function(e){var t=this;Array.prototype.forEach.call(e.addedNodes,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureAdd(e,"intersect"),t.mapChild(e,t.exposureAdd)})),Array.prototype.forEach.call(e.removedNodes,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureRemove(e),t.mapChild(e,t.exposureRemove)}))},e.prototype.mapChild=function(e,t){var n=this;1===e.nodeType&&e.children.length&&Array.prototype.forEach.call(e.children,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t(e),n.mapChild(e,t)}))},e.prototype.exposureAdd=function(e,t){this._intersection.exposureAdd(e,t)},e.prototype.exposureRemove=function(e){this._intersection.exposureRemove(e)},e._exposure_observer=null,e}(),He=function(){function e(t,n){this.count=1,this.instance=this.buildObserver(),this.observeMap=e._observer_map,t.autotrack.exposure.ratio?this.Ratio=t.autotrack.exposure.ratio:0===t.autotrack.exposure.ratio?this.Ratio=0:this.Ratio=.5,this.EventHandle=n}return e.prototype.buildObserver=function(){var t=this;if(!e._observer_instance)return IntersectionObserver&&(e._observer_instance=new IntersectionObserver((function(e){e.forEach((function(e){t.observeMap.get(e.target._observeId)&&t.exposureEvent(e)}))}),{threshold:[.01,.25,.5,.75,1]})),e._observer_instance},e.prototype.exposureAdd=function(e,t){var n=e;"mutation"===t&&(n=e.target);var i=n._observeId;if(i||this.observeMap.has(i)){if(!1===n.visible){var o=n.getBoundingClientRect(),r=o.top,a=o.left,s=o.right,c=o.bottom;r>=0&&c<=window.innerHeight&&a>=0&&s<=window.innerWidth&&(n.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e))}}else n._observeId=this.count,n.visible=!1,this.observeMap.set(this.count,n),this.observe(n),this.count++},e.prototype.exposureRemove=function(e){this.observeMap.has(e._observeId)&&(this.observeMap.delete(e._observeId),this.unobserve(e))},e.prototype.exposureEvent=function(e){if(e.intersectionRatio>=this.Ratio&&e.isIntersecting){if("0"===e.target.style.opacity||"hidden"===e.target.style.visibility)return;if(!0===e.target.visible)return;e.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e)}else e.target.visible=!1},e.prototype.observe=function(e){this.instance.observe(e)},e.prototype.unobserve=function(e){this.instance.unobserve(e)},e._observer_instance=null,e._observer_map=new Map,e}(),We=function(){function e(e,t){e.autotrack&&e.autotrack.exposure&&(this._intersection=new He(e,t),this._observer=new ze(this._intersection),this.initObserver())}return e.prototype.initObserver=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),(function(t){e._intersection.exposureAdd(t,"intersect")}))},e}(),Fe={hashTag:!1,impr:!1},Ke=function(){function e(){}return e.prototype.apply=function(e,t){if(this.autoTrackStart=!1,this.collect=e,this.config=t,t.autotrack){var n=e.Types;t.autotrack&&t.autotrack.collect_url&&!t.autotrack.collect_url()||(this.ready(n.Autotrack),this.collect.emit(n.AutotrackReady))}},e.prototype.ready=function(e){this.collect.set(e);var t=this.config.autotrack;t="object"==typeof t?t:{},t=Object.assign(Fe,t),this.destroyed=!1,this.options=t,this.Config=new Ie(xe,this.options),this.Exposure=new We(this.config,this.handle.bind(this)),this.Listener=new Oe(t,this.collect,this.Config),this.EventHandle=new De(this.config,t),this.Request=new Pe(this.collect),this.autoTrackStart=!0,this.init(),function(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{};var n="",i="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-editor-rangers.js?query="+Date.now();window.TEAVisualEditor.appId=t.app_id;var o=t.channel_domain,r="";if(oe(["*"]),o){var a,s="";try{var c=window.performance.getEntriesByType("resource");if(c&&c.length&&(c.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(s=e.name)})),s&&(a=s.split("/"))&&a.length)){r="https:/";for(var u=2;u<a.length&&u!==a.length-1;u++)r=r+"/"+a[u];if(r&&r.indexOf("/5.0")){var l=r.split("/5.0");r=l[0]||r}}}catch(e){}}if(ce(t,D),"1"===w.get(Re)){var d=function(){var e=w.get(Me);try{e=JSON.parse(e)}catch(e){}return e}(),f="";d&&(window.TEAVisualEditor.__editor_ajax_domain=d,f=w.get(Be)),Ve({event:null,editorUrl:f||i,autoTrackInstance:e}),qe()}else try{ae("tea:openVisualEditor",(function(t){var a=t.data;if("string"==typeof t.data)try{a=JSON.parse(t.data)}catch(e){a=void 0}if(a){var s=a.referrer,c=a.lang;if(s&&(window.TEAVisualEditor.__editor_ajax_domain=s),n=i,o){var u=a.version;n=r?r+(u?"/visual-editor-rangers-v"+u:"/visual-editor-rangers-v1.0.0")+".js":i,window.TEAVisualEditor.__editor_verison=u}window.TEAVisualEditor.__editor_url=n,window.TEAVisualEditor.lang=c,Ve({event:t,editorUrl:n,autoTrackInstance:e}),qe()}})),window.TEAVisualEditor.openAutotrackEditor=function(){Ve({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){}try{ae("tea:openHeatMapCore",(function(n){var i=n.data.app_id;i&&i!==t.app_id||Ve({event:n,editorUrl:"https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/heatmap-core.js?query="+Date.now(),autoTrackInstance:e})}))}catch(e){}}(this,this.config)},e.prototype.init=function(){this.Listener.init(this.handle.bind(this));try{"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var n=e.eventName;if("click"===n||"exposure"===n||"change"===n||"submit"===n){var i=this.EventHandle.handleEvent(t,n);null!==i&&this.Request.send({eventType:"custom",eventName:"report_"+n+"_event",extra:{methods:"GET"}},i)}else if("page_view"===n||"page_statistics"===n){var o;o="page_view"===n?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},o)}else if("beat"===n){var r=this.EventHandle.handleBeadtEvent(t),a=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:a},r)}}catch(e){}},e.prototype.destroy=function(){this.autoTrackStart&&(this.autoTrackStart=!1,this.Listener.removeListener())},e}();!function(e){e.Net="net",e.FailNet="f_net",e.FailData="f_data"}(je||(je={}));var $e={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},Ye=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(this.ready=t.app_id&&t.enable_tracer&&!t.disable_track_event,this.ready){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=e,this.appid=t.app_id,this.reportUrl=e.configManager.getUrl("event");var i=this.collect.Types,o=e.adapters.fetch;this.fetch=o,this.collect.on(i.Event,(function(){n.addCount("log")})),this.collect.on(i.SubmitError,(function(e){var t=e.type,i=e.eventDate,o=e.errorCode,r=e.response;n.addErrorCount(i,t,o,r)})),this.listener(),this.collect.emit(i.TracerReady)}},e.prototype.addCount=function(e,t,n){void 0===t&&(t="net"),void 0===n&&(n=1);try{this.tracerCache||(this.tracerCache=new Map);var i=void 0;if(this.tracerCache.has(e))(o=this.tracerCache.get(e)).has(t)?(i=o.get(t).params.count,i++,o.set(t,this.processTracer(i,e,t))):(i=n,o.set(t,this.processTracer(n,e,t)));else{var o=new Map;i=n,o.set(t,this.processTracer(n,e,t)),this.tracerCache.set(e,o)}"net"===t&&i>=this.limit[e]&&this.report(!1)}catch(e){}},e.prototype.addErrorCount=function(e,t,n,i){var o=this;try{if(e&&e.length){var r=e[0].events;r&&r.length&&("f_data"===t?(i&&i.hasOwnProperty("sc")?this.addCount("log",t,r.length-i.sc):this.addCount("log",t,r.length),this.errorCode[t]=n):r.forEach((function(e){var i="log";for(var r in $e)if(-1!==$e[r].indexOf(e.event)){i=r;break}o.addCount(i,t,1),o.errorCode[t]=n})))}}catch(e){}},e.prototype.report=function(e){if(this.tracerCache){var t=[];this.tracerCache.forEach((function(e){e.forEach((function(e){t.push(e)}))})),t&&t.length&&this.sendTracer(t,e)}},e.prototype.sendTracer=function(e,t){try{var n=this.collect.eventManager.merge(e);t&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(n)):this.fetch(this.reportUrl,n),this.tracerCache=null}catch(e){}},e.prototype.processTracer=function(e,t,n){var i={count:e,state:n,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:D};"f_net"!==n&&"f_data"!==n||(i.errorCode=this.errorCode[n]);var o=this.collect.processEvent("applog_trace",i);if(o&&o.event)return delete o.is_bav,o},e.prototype.listener=function(){var e=this;document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.leavePage()})),h((function(){e.leavePage()}))},e.prototype.leavePage=function(){this.report(!0)},e}(),Qe=E((function(e,t){e.exports=function(){var e="millisecond",t="second",n="minute",i="hour",o="day",r="week",a="month",s="quarter",c="year",u="date",l="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},_={s:p,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),o=n%60;return(t<=0?"+":"-")+p(i,2,"0")+":"+p(o,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),o=t.clone().add(i,a),r=n-o<0,s=t.clone().add(i+(r?-1:1),a);return+(-(i+(n-o)/(r?o-s:s-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return{M:a,y:c,w:r,d:o,D:u,h:i,m:n,s:t,ms:e,Q:s}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},m="en",v={};v[m]=h;var g=function(e){return e instanceof w},E=function(e,t,n){var i;if(!e)return m;if("string"==typeof e)v[e]&&(i=e),t&&(v[e]=t,i=e);else{var o=e.name;v[o]=e,i=o}return!n&&i&&(m=i),i||!n&&m},b=function(e,t){if(g(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new w(n)},y=_;y.l=E,y.i=g,y.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var w=function(){function h(e){this.$L=E(e.locale,null,!0),this.parse(e)}var p=h.prototype;return p.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(y.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(d);if(i){var o=i[2]-1||0,r=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],o,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)):new Date(i[1],o,i[3]||1,i[4]||0,i[5]||0,i[6]||0,r)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},p.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},p.$utils=function(){return y},p.isValid=function(){return!(this.$d.toString()===l)},p.isSame=function(e,t){var n=b(e);return this.startOf(t)<=n&&n<=this.endOf(t)},p.isAfter=function(e,t){return b(e)<this.startOf(t)},p.isBefore=function(e,t){return this.endOf(t)<b(e)},p.$g=function(e,t,n){return y.u(e)?this[t]:this.set(n,e)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(e,s){var l=this,d=!!y.u(s)||s,f=y.p(e),h=function(e,t){var n=y.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return d?n:n.endOf(o)},p=function(e,t){return y.w(l.toDate()[e].apply(l.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},_=this.$W,m=this.$M,v=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case c:return d?h(1,0):h(31,11);case a:return d?h(1,m):h(0,m+1);case r:var E=this.$locale().weekStart||0,b=(_<E?_+7:_)-E;return h(d?v-b:v+(6-b),m);case o:case u:return p(g+"Hours",0);case i:return p(g+"Minutes",1);case n:return p(g+"Seconds",2);case t:return p(g+"Milliseconds",3);default:return this.clone()}},p.endOf=function(e){return this.startOf(e,!1)},p.$set=function(r,s){var l,d=y.p(r),f="set"+(this.$u?"UTC":""),h=(l={},l[o]=f+"Date",l[u]=f+"Date",l[a]=f+"Month",l[c]=f+"FullYear",l[i]=f+"Hours",l[n]=f+"Minutes",l[t]=f+"Seconds",l[e]=f+"Milliseconds",l)[d],p=d===o?this.$D+(s-this.$W):s;if(d===a||d===c){var _=this.clone().set(u,1);_.$d[h](p),_.init(),this.$d=_.set(u,Math.min(this.$D,_.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},p.set=function(e,t){return this.clone().$set(e,t)},p.get=function(e){return this[y.p(e)]()},p.add=function(e,s){var u,l=this;e=Number(e);var d=y.p(s),f=function(t){var n=b(l);return y.w(n.date(n.date()+Math.round(t*e)),l)};if(d===a)return this.set(a,this.$M+e);if(d===c)return this.set(c,this.$y+e);if(d===o)return f(1);if(d===r)return f(7);var h=(u={},u[n]=6e4,u[i]=36e5,u[t]=1e3,u)[d]||1,p=this.$d.getTime()+e*h;return y.w(p,this)},p.subtract=function(e,t){return this.add(-1*e,t)},p.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var i=e||"YYYY-MM-DDTHH:mm:ssZ",o=y.z(this),r=this.$H,a=this.$m,s=this.$M,c=n.weekdays,u=n.months,d=function(e,n,o,r){return e&&(e[n]||e(t,i))||o[n].substr(0,r)},h=function(e){return y.s(r%12||12,e,"0")},p=n.meridiem||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i},_={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:y.s(s+1,2,"0"),MMM:d(n.monthsShort,s,u,3),MMMM:d(u,s),D:this.$D,DD:y.s(this.$D,2,"0"),d:String(this.$W),dd:d(n.weekdaysMin,this.$W,c,2),ddd:d(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(r),HH:y.s(r,2,"0"),h:h(1),hh:h(2),a:p(r,a,!0),A:p(r,a,!1),m:String(a),mm:y.s(a,2,"0"),s:String(this.$s),ss:y.s(this.$s,2,"0"),SSS:y.s(this.$ms,3,"0"),Z:o};return i.replace(f,(function(e,t){return t||_[e]||o.replace(":","")}))},p.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},p.diff=function(e,u,l){var d,f=y.p(u),h=b(e),p=6e4*(h.utcOffset()-this.utcOffset()),_=this-h,m=y.m(this,h);return m=(d={},d[c]=m/12,d[a]=m,d[s]=m/3,d[r]=(_-p)/6048e5,d[o]=(_-p)/864e5,d[i]=_/36e5,d[n]=_/6e4,d[t]=_/1e3,d)[f]||_,l?m:y.a(m)},p.daysInMonth=function(){return this.endOf(a).$D},p.$locale=function(){return v[this.$L]},p.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=E(e,t,!0);return i&&(n.$L=i),n},p.clone=function(){return y.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},h}(),S=w.prototype;return b.prototype=S,[["$ms",e],["$s",t],["$m",n],["$H",i],["$W",o],["$M",a],["$y",c],["$D",u]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),b.extend=function(e,t){return e.$i||(e(t,w,b),e.$i=!0),b},b.locale=E,b.isDayjs=g,b.unix=function(e){return b(1e3*e)},b.en=v[m],b.Ls=v,b.p={},b}()})),Je=E((function(e,t){var n,i,o,r,a,s,c,u,l,d,f,h,p,_,m,v,g;e.exports=(a=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,u=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:s=31536e6,months:c=2592e6,days:r=864e5,hours:o=36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},d=function(e){return e instanceof g},f=function(e,t,n){return new g(e,n,t.$l)},h=function(e){return i.p(e)+"s"},p=function(e){return e<0},_=function(e){return p(e)?Math.ceil(e):Math.floor(e)},m=function(e){return Math.abs(e)},v=function(e,t){return e?p(e)?{negative:!0,format:""+m(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},g=function(){function e(e,t,n){var i=this;if(this.$d={},this.$l=n,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return f(e*l[h(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach((function(t){i.$d[h(t)]=e[t]})),this.calMilliseconds(),this;if("string"==typeof e){var o=e.match(u);if(o){var r=o.slice(2).map((function(e){return Number(e)}));return this.$d.years=r[0],this.$d.months=r[1],this.$d.weeks=r[2],this.$d.days=r[3],this.$d.hours=r[4],this.$d.minutes=r[5],this.$d.seconds=r[6],this.calMilliseconds(),this}}return this}var t=e.prototype;return t.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce((function(t,n){return t+(e.$d[n]||0)*l[n]}),0)},t.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=_(e/s),e%=s,this.$d.months=_(e/c),e%=c,this.$d.days=_(e/r),e%=r,this.$d.hours=_(e/o),e%=o,this.$d.minutes=_(e/6e4),e%=6e4,this.$d.seconds=_(e/1e3),e%=1e3,this.$d.milliseconds=e},t.toISOString=function(){var e=v(this.$d.years,"Y"),t=v(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var i=v(n,"D"),o=v(this.$d.hours,"H"),r=v(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3);var s=v(a,"S"),c=e.negative||t.negative||i.negative||o.negative||r.negative||s.negative,u=o.format||r.format||s.format?"T":"",l=(c?"-":"")+"P"+e.format+t.format+i.format+u+o.format+r.format+s.format;return"P"===l||"-P"===l?"P0D":l},t.toJSON=function(){return this.toISOString()},t.format=function(e){var t=e||"YYYY-MM-DDTHH:mm:ss",n={Y:this.$d.years,YY:i.s(this.$d.years,2,"0"),YYYY:i.s(this.$d.years,4,"0"),M:this.$d.months,MM:i.s(this.$d.months,2,"0"),D:this.$d.days,DD:i.s(this.$d.days,2,"0"),H:this.$d.hours,HH:i.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:i.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:i.s(this.$d.seconds,2,"0"),SSS:i.s(this.$d.milliseconds,3,"0")};return t.replace(a,(function(e,t){return t||String(n[e])}))},t.as=function(e){return this.$ms/l[h(e)]},t.get=function(e){var t=this.$ms,n=h(e);return"milliseconds"===n?t%=1e3:t="weeks"===n?_(t/l[n]):this.$d[n],0===t?0:t},t.add=function(e,t,n){var i;return i=t?e*l[h(t)]:d(e)?e.$ms:f(e,this).$ms,f(this.$ms+i*(n?-1:1),this)},t.subtract=function(e,t){return this.add(e,t,!0)},t.locale=function(e){var t=this.clone();return t.$l=e,t},t.clone=function(){return f(this.$ms,this)},t.humanize=function(e){return n().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},t.milliseconds=function(){return this.get("milliseconds")},t.asMilliseconds=function(){return this.as("milliseconds")},t.seconds=function(){return this.get("seconds")},t.asSeconds=function(){return this.as("seconds")},t.minutes=function(){return this.get("minutes")},t.asMinutes=function(){return this.as("minutes")},t.hours=function(){return this.get("hours")},t.asHours=function(){return this.as("hours")},t.days=function(){return this.get("days")},t.asDays=function(){return this.as("days")},t.weeks=function(){return this.get("weeks")},t.asWeeks=function(){return this.as("weeks")},t.months=function(){return this.get("months")},t.asMonths=function(){return this.as("months")},t.years=function(){return this.get("years")},t.asYears=function(){return this.as("years")},e}(),function(e,t,o){n=o,i=o().$utils(),o.duration=function(e,t){var n=o.locale();return f(e,{$l:n},t)},o.isDuration=d;var r=t.prototype.add,a=t.prototype.subtract;t.prototype.add=function(e,t){return d(e)&&(e=e.asMilliseconds()),r.bind(this)(e,t)},t.prototype.subtract=function(e,t){return d(e)&&(e=e.asMilliseconds()),a.bind(this)(e,t)}})}));Qe.extend(Je);var Xe=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],Ze=["and","or","not"],et=function(){function e(){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[]}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,this.config.cep){var i=e.adapters,o=i.fetch,r=i.storage,a=e.Types;this.types=a,this.storage=new r(!1),this.fetch=o,this.configManager=e.configManager,this.url=t.cep_url?""+t.cep_url:e.configManager.getDomain()+"/service/2/cep_settings/",this.reportUrl=e.configManager.getUrl("event"),this.key="__tea_cep_plan_"+t.app_id,this.quotasKey="__tea_cep_plan_quotas_"+t.app_id,this.isWait=!1,this.eventCache=[],this.test=e.configManager.staging,this.collect.on(a.SubmitAfter,(function(e){n.matchEvent(e)})),this.init()}},e.prototype.init=function(){var e=this,t=!0,n=0,i=0,o=0,r=!1,a=this.storage.getItem(this.key)||{};if(a&&Object.keys(a).length&&(r=!0,n=a.last_update_time,i=a.fetch_interval,o=a.config_version||0,t=Date.now()-n>1e3*i),t){var s=this.configManager.get(),c=s.header,u=s.user;this.fetch(this.url,{header:c,user:u,local_time:Date.now(),config_version:o},1e4,!1,(function(t){t&&0===t.code?(a.fetch_interval=t.fetch_interval,a.data=t.data,a.last_update_time=Date.now(),a.config_version=t.config_version,e.clearQuotas(),e.initState(t.data),e.storage.setItem(e.key,a),t.data.forEach((function(t){e.event("__cep_sdk_onboard",t.plan_id)}))):304!==t.code&&400!==t.code||!r||(a.last_update_time=Date.now(),e.storage.setItem(e.key,a),e.initState(a.data))}),(function(){r?(e.planData=a.data,e.initState(a.data)):e.support=!1}))}else a.last_update_time=Date.now(),this.storage.setItem(this.key,a),this.initState(a.data)},e.prototype.initState=function(e){var t=this;e&&e.length&&(this.stateArray=new Map,this.waitArray=new Map,this.planData=e,e.forEach((function(e){var n=new Map;if(e.pattern&&e.pattern.events){var i=1===e.pattern.events.length;e.pattern.events.forEach((function(e){n.set(e.id,{id:e.id,isMatch:!1,event:null,after:e.after||null,connection:e.connection||null,window:e.window||null,matchTime:0,initTime:Date.now(),singleRule:i})})),t.stateArray.set(e.plan_id,{patternState:n,singleRule:i,pattern:{aid:e.aid,biz_id:e.biz_id,end_time:e.end_time,start_time:e.start_time,web_sdk_version:e.web_sdk_version,stage:e.stage},quotas:e.quotas})}})),this.cepReady=!0,this.dealCache(),this.collect.emit(this.types.CepReady))},e.prototype.check=function(e){var t=Date.now();return!(Date.now()>1e3*e.end_time)&&(!(t<1e3*e.start_time||t>1e3*e.end_time)&&(this.staing="testing"===e.staing,!(D<e.web_sdk_version&&(this.support=!1,1))))},e.prototype.dealCache=function(){var e=this;if(this.eventCache.length){var t=1;this.eventCache.forEach((function(n){e.matchEvent(n),t++})),t===this.eventCache.length&&(this.eventCache=[])}},e.prototype.matchEvent=function(e){if(this.support&&(!this.staing||this.test)&&e&&e.length)try{if(!this.cepReady)return void this.eventCache.push(e);var t=e[0],n=t.header,i=t.user,o=t.events;o.length&&o.reverse();for(var r=0;r<o.length;r++){var a=o[r].event;if(-1!==Xe.indexOf(a))return!1;this.matchRule(n,i,o[r])}}catch(e){return void this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.matchRule=function(e,t,n){try{for(var i=0;i<this.planData.length;i++){var o=this.planData[i],r=o.plan_id;if(this.check(o)&&this.checkQuotas(r)&&o.pattern&&o.pattern.events)for(var a=o.pattern.events,s=0;s<a.length;s++)if(this.rule(e,t,n,a[s].condition)){var c=this.stateArray.get(r).patternState,u=c.get(a[s].id);if(this.stateArray.get(r).singleRule){this.changeStatus(r,a[s].id,n),this.publish([n],r,a[s].id);break}if(!u.isMatch){u.after&&c.get(u.after).isMatch?this.changeStatus(r,a[s].id,n):u.after||this.changeStatus(r,a[s].id,n);break}}}this.statusCheck()}catch(e){return void this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.changeStatus=function(e,t,n){var i=this.stateArray.get(e),o=i.patternState.get(t);o.isMatch=!0,o.event=n,o.matchTime=n.local_time_ms||Date.now(),i.patternState.set(t,o),this.stateArray.set(e,i)},e.prototype.statusCheck=function(){var e,t,n,i;try{for(var a=o(this.stateArray),s=a.next();!s.done;s=a.next()){var c=r(s.value,2),u=c[0],l=c[1],d=l.patternState;if(l.isSingle)break;try{for(var f=o(d),h=f.next();!h.done;h=f.next()){var p=r(h.value,2),_=p[0],m=p[1];if(m.after&&(!m.after||d.get(m.after).isMatch)){if("NOT_FOLLOWED_BY"===m.connection){m.isMatch?this.reset(u,_):Date.now()-d.get(m.after).matchTime>m.window?this.publish([d.get(m.after).event,m.event],u,_):this.startWait(u,_,m);break}m.isMatch?m.matchTime-d.get(m.after).matchTime<=m.window?this.publish([d.get(m.after).event,m.event],u,_):this.reset(u,_):Date.now()-d.get(m.after).matchTime>m.window?this.reset(u,_):this.startWait(u,_,m);break}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}},e.prototype.startWait=function(e,t,n){var i=this;try{this.waitArray.get(e)||this.waitArray.set(e,new Map);var o=this.waitArray.get(e);if(!o.get(t)){var r=setTimeout((function(){var o=i.stateArray.get(e).patternState,r=o.get(t);if("NOT_FOLLOWED_BY"===r.connection)!r.isMatch&&o.get(r.after).isMatch||r.matchTime-o.get(r.after).matchTime>n.window?((a=i.waitArray.get(e).get(t)).triggerWait=!0,i.waitArray.set(e,i.waitArray.get(e).set(t,a)),i.publish([o.get(r.after).event],e,t)):i.reset(e,t);else if("FOLLOWED_BY"===r.connection){var a;r.isMatch&&o.get(r.after).isMatch?((a=i.waitArray.get(e).get(t)).triggerWait=!0,i.waitArray.set(e,i.waitArray.get(e).set(t,a)),i.publish([o.get(r.after).event],e,t)):i.reset(e,t)}}),n.window);o.set(t,{waitFn:r,triggerWait:!1}),this.waitArray.set(e,o)}}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.rule=function(e,t,n,i){var o=this;try{var r=n.event,a=n.params;if(a=JSON.parse(a),-1!==Ze.indexOf(i.op)){if(i.conditions&&i.conditions.length){var s=i.conditions,c=0,u=new Map;u.set(c,{op:i.op,result:void 0,resultList:[],resultKey:[],resultLength:s.length}),function n(i,s){for(var l=0;l<i.length;l++)if(c++,-1!==Ze.indexOf(i[l].op)&&i[l].hasOwnProperty("conditions"))u.set(c,{op:i[l].op,result:void 0,fatherKey:s,resultList:[],resultKey:[],resultLength:i[l].conditions.length}),n(i[l].conditions,c);else{var d=o.scope(i[l].key),f=d.scope,h=d.key,p=d.key2,_=f?"header"===f?p?JSON.parse(e[p])[h]:e[h]:"user"===f?t[h]:a[h]:r,m=o.calculate(i[l].op,_,i[l].value);u.set(c,{op:i[l].op,result:m,fatherKey:s})}}(s,c);for(var l=u.get(0);void 0===l.result||l.resultList.length<l.resultLength;)u.forEach((function(e,t){if(void 0!==e.result&&void 0!==e.fatherKey){var n=u.get(e.fatherKey);n.resultList.length<n.resultLength&&-1===n.resultKey.indexOf(t)&&(n.resultKey.push(t),n.resultList.push(e.result),u.set(e.fatherKey,n))}})),u.forEach((function(e){e.resultList&&e.resultList.length===e.resultLength&&("and"===e.op&&(e.result=-1===e.resultList.indexOf(!1)),"or"===e.op&&(e.result=-1!==e.resultList.indexOf(!0)))}));return u.get(0).result}return!1}var d=this.scope(i.key),f=d.scope,h=d.key,p=d.key2,_=f?"header"===f?p?JSON.parse(e[p])[h]:e[h]:"user"===f?t[h]:a[h]:r;return this.calculate(i.op,_,i.value)}catch(e){return this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.publish=function(e,t,n){try{var i=this.configManager.get().user,o={biz_id:this.stateArray.get(t).pattern.biz_id,plan_id:t,uid:i.user_id||"",did:i.device_id||"",uuid:i.user_unique_id,events:e,extra:{url:window.location.href}};this.collect.emit("__cep_match",o),(window.opener||window.parent).postMessage({type:"__cep_match",data:o},"*"),this.event("__cep_trigger_sdk",t),this.addQuotas(t),this.reset(t,n)}catch(e){return void this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.addQuotas=function(e){var t=this.stateArray.get(e).quotas;if(t&&t.length){var n=this.storage.getItem(this.quotasKey)||{};n[e]||(n[e]={value:0,lastTime:Date.now()});var i=n[e].value;0===i&&(n[e].lastTime=Date.now()),n[e].value=i+1,this.storage.setItem(this.quotasKey,n)}},e.prototype.checkQuotas=function(e){var t=this.stateArray.get(e).quotas,n=this.storage.getItem(this.quotasKey)||{};if(n[e]||(n[e]={value:0,lastTime:Date.now()}),t&&t.length){var i=t[0].granularity,o=t[0].value;if("per_keyid"!==t[0].type)return!0;var r=this.release(i);return"all"===r?!(n[e].value>=o):Date.now()-n[e].lastTime>=r?(n[e].value=0,n[e].lastTime=Date.now(),this.storage.setItem(this.quotasKey,n),!0):!(n[e].value>=o)}return!0},e.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},e.prototype.release=function(e){if("all"===e)return e;var t=Qe.duration(e);return t?t.asMilliseconds():"all"},e.prototype.reset=function(e,t){var n=this.stateArray.get(e);if(n.singleRule){var i=n.patternState.get(t);i.isMatch=!1,i.event=null,i.matchTime=0,i.initTime=Date.now(),n.patternState.set(t,i)}else n.patternState.forEach((function(e){e.isMatch=!1,e.event=null,e.matchTime=0,e.initTime=Date.now()}));this.stateArray.set(e,n);var o=this.waitArray.get(e);o&&o.get(t)&&(clearTimeout(o.get(t).waitFn),o.delete(t))},e.prototype.event=function(e,t){try{var n={event:e,params:JSON.stringify({plan_id:t||"",biz_id:this.stateArray.get(t).pattern.biz_id}),local_time_ms:Date.now()},i=this.configManager.get(),o=i.header,r=i.user;o.custom=JSON.stringify(o.custom);var a={events:[n],user:r,header:o};this.fetch(this.reportUrl,[a])}catch(e){return void this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.scope=function(e){var t="",n="";if(e.indexOf(".")>-1){var i=e.split(".");t=i[0],e=i[1],"header"===t&&"custom"===e&&(e=i[2],n=i[1])}return{scope:t,key:e,key2:n}},e.prototype.calculate=function(e,t,n){try{if("="===e)return t===n;if(-1!==["=","<",">",">=","<=","!="].indexOf(e))switch(e){case"=":return t===n;case"<":return t<n;case">":return t>n;case">=":return t>=n;case"<=":return t<=n;case"!=":return t!==n}else{if(-1!==["in","contains"].indexOf(e))return-1!==n.indexOf(t);if(-1!==["is not null","is null"].indexOf(e))return"is null"===e?null==t:null!=t;if(-1!==["startswith","endswith"].indexOf(e)){if("startswith"===e)return 0===t.indexOf(n);var i=t.length-n.length;return t.substr(i,n.length)===n}}}catch(e){return this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),!1}},e}(),tt={autotrack:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/autotrack.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/ab.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/stay.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/route.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/cep.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/tracer.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},visual:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/visual.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},nt="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,it=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,n){if("sdk"===t){if(tt.hasOwnProperty(n)){var i=tt[n].object,o=tt[n].src[e.channel]+"?query="+Date.now();e.exist(n,i,o)}}else"object"==typeof t&&(t.src?e.exist(n,t.call,t.src):e.process(n,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.exist=function(e,t,n){var i=this;nt[t]?this.process(e,nt[t]):this.loadPlugin(e,n,(function(){i.process(e,nt[t])}),(function(){}))},e.prototype.process=function(e,t,n){try{if(n){var i=new t;i.apply&&i.apply(this.collect,this.config)}else t&&t(this.collect,this.config)}catch(t){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}},e.prototype.loadPlugin=function(e,t,n,i){var o=this;try{var r=document.createElement("script");r.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(n),r.onerror=function(){i(t)},r.onload=function(){o._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(r)}catch(e){this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}(),ot=function(){function e(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return e.prototype.apply=function(e,t){if(t.spa||t.autotrack){var n=e.Types;this.collect=e,this.config=t,this.appid=t.app_id,this.allowHash=t.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),e.emit(n.RouteReady)}},e.prototype.setKey=function(){var e=this.collect.adapters.storage;this.storage=new e(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:location.href,refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];"function"==typeof history.onpushstate&&history.onpushstate({state:n});var r=t.call.apply(t,a([history,n],i));if(e.lastLocation!==location.href){var s=e.getPopStateChangeEventData();return e.lastLocation=location.href,e.setReferCache(e.lastLocation),e.sendPv(s,"pushState"),r}};var n=history.replaceState;history.replaceState=function(t){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var r=n.call.apply(n,a([history,t],i));if(e.lastLocation!==location.href){var s=e.getPopStateChangeEventData();return e.lastLocation=location.href,e.setReferCache(e.lastLocation),e.sendPv(s),r}}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.init=function(){var e=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:e,init:!0})},e.prototype.listener=function(){var e=this,t=null;window.addEventListener("hashchange",(function(n){if(e.lastLocation!==window.location.href&&(clearTimeout(t),e.allowHash)){e.lastLocation=window.location.href;var i=e.getPopStateChangeEventData();e.setReferCache(e.lastLocation),e.sendPv(i)}})),window.addEventListener("popstate",(function(n){e.lastLocation!==window.location.href&&(t=setTimeout((function(){e.lastLocation=window.location.href;var t=e.getPopStateChangeEventData();e.setReferCache(e.lastLocation),e.sendPv(t)}),10))}))},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){try{var e,t=this.storage.getItem(this.cache_key)||{},n=this.storage.getItem("__tea_cache_first_"+this.appid);return e=!n||1!=n,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:t&&t.refer_manual_key||"",refer_page_title:t&&t.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+e}}catch(t){return this.collect.emit(y.DEBUGGER_MESSAGE,{type:y.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message}),{}}},e.prototype.sendPv=function(e,t){this.collect.emit("route-change",{config:e,init:!1})},e.prototype.handleRefer=function(){var e=this.storage.getItem()||{};return e.routeChange?e.refer_key:document.referrer},e.prototype.setReferCache=function(e){var t=this.storage.getItem(this.cache_key)||{};t.refer_key=e,t.routeChange=!0,this.storage.setItem(this.cache_key,t)},e}();ee.usePlugin(it,"extend"),ee.usePlugin(he,"ab"),ee.usePlugin(ve,"stay"),ee.usePlugin(Ke,"autotrack"),ee.usePlugin(pe,"et"),ee.usePlugin(ge,"profile"),ee.usePlugin(et,"cep"),ee.usePlugin(Ee,"heartbeat"),ee.usePlugin(be,"monitor"),ee.usePlugin(ot,"route"),ee.usePlugin(Ye,"tracer");var rt=new ee("default"),at=ee;t.default=rt},69485:function(e,t,n){var i=n(71239);e.exports=i},78986:function(e,t,n){n(41963),e.exports=n(84659)},9508:function(e,t,n){e.exports=n(56343)},56343:function(e,t,n){n(64754);var i=n(69485);e.exports=i},41963:function(e,t,n){var i=n(83489),o=n(84659);i({global:!0,forced:o.globalThis!==o},{globalThis:o})},64754:function(e,t,n){n(41963)},71239:function(e,t,n){var i=n(78986);e.exports=i},40705:function(e){"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)};var n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function r(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function a(e,t){try{return t in e}catch(n){return!1}}function s(e,t,n){var o={};return n.isMergeableObject(e)&&r(e).forEach((function(t){o[t]=i(e[t],n)})),r(t).forEach((function(r){(function(e,t){return a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,r)||(a(e,r)&&n.isMergeableObject(t[r])?o[r]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"==typeof n?n:c}(r,n)(e[r],t[r],n):o[r]=i(t[r],n))})),o}function c(e,n,r){(r=r||{}).arrayMerge=r.arrayMerge||o,r.isMergeableObject=r.isMergeableObject||t,r.cloneUnlessOtherwiseSpecified=i;var a=Array.isArray(n);return a===Array.isArray(e)?a?r.arrayMerge(e,n,r):s(e,n,r):i(n,r)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};var u=c;e.exports=u},51355:function(e,t){"use strict";var n=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function o(e){try{return encodeURIComponent(e)}catch(t){return null}}t.stringify=function(e,t){t=t||"";var i,r,a=[];for(r in"string"!=typeof t&&(t="?"),e)if(n.call(e,r)){if((i=e[r])||null!=i&&!isNaN(i)||(i=""),r=o(r),i=o(i),null===r||null===i)continue;a.push(r+"="+i)}return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,o={};t=n.exec(e);){var r=i(t[1]),a=i(t[2]);null===r||null===a||r in o||(o[r]=a)}return o}},32493:function(e){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},17674:function(e,t,n){"use strict";var i=n(32493),o=n(51355),r=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,a=/[\n\r\t]/g,s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,l=/^[a-zA-Z]:/;function d(e){return(e||"").toString().replace(r,"")}var f=[["#","hash"],["?","query"],function(e,t){return _(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",undefined,1,1],[/:(\d*)$/,"port",undefined,1],[NaN,"hostname",undefined,1,1]],h={hash:1,query:1};function p(e){var t,n=("undefined"!=typeof window||"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).location||{},i={},o=typeof(e=e||n);if("blob:"===e.protocol)i=new v(unescape(e.pathname),{});else if("string"===o)for(t in i=new v(e,{}),h)delete i[t];else if("object"===o){for(t in e)t in h||(i[t]=e[t]);i.slashes===undefined&&(i.slashes=s.test(e.href))}return i}function _(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function m(e,t){e=(e=d(e)).replace(a,""),t=t||{};var n,i=u.exec(e),o=i[1]?i[1].toLowerCase():"",r=!!i[2],s=!!i[3],c=0;return r?s?(n=i[2]+i[3]+i[4],c=i[2].length+i[3].length):(n=i[2]+i[4],c=i[2].length):s?(n=i[3]+i[4],c=i[3].length):n=i[4],"file:"===o?c>=2&&(n=n.slice(2)):_(o)?n=i[4]:o?r&&(n=n.slice(2)):c>=2&&_(t.protocol)&&(n=i[4]),{protocol:o,slashes:r||_(o),slashesCount:c,rest:n}}function v(e,t,n){if(e=(e=d(e)).replace(a,""),!(this instanceof v))return new v(e,t,n);var r,s,c,u,h,g,E=f.slice(),b=typeof t,y=this,w=0;for("object"!==b&&"string"!==b&&(n=t,t=null),n&&"function"!=typeof n&&(n=o.parse),r=!(s=m(e||"",t=p(t))).protocol&&!s.slashes,y.slashes=s.slashes||r&&t.slashes,y.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||l.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!_(y.protocol)))&&(E[3]=[/(.*)/,"pathname"]);w<E.length;w++)"function"!=typeof(u=E[w])?(c=u[0],g=u[1],c!=c?y[g]=e:"string"==typeof c?~(h="@"===c?e.lastIndexOf(c):e.indexOf(c))&&("number"==typeof u[2]?(y[g]=e.slice(0,h),e=e.slice(h+u[2])):(y[g]=e.slice(h),e=e.slice(0,h))):(h=c.exec(e))&&(y[g]=h[1],e=e.slice(0,h.index)),y[g]=y[g]||r&&u[3]&&t[g]||"",u[4]&&(y[g]=y[g].toLowerCase())):e=u(e,y);n&&(y.query=n(y.query)),r&&t.slashes&&"/"!==y.pathname.charAt(0)&&(""!==y.pathname||""!==t.pathname)&&(y.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),i=n.length,o=n[i-1],r=!1,a=0;i--;)"."===n[i]?n.splice(i,1):".."===n[i]?(n.splice(i,1),a++):a&&(0===i&&(r=!0),n.splice(i,1),a--);return r&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(y.pathname,t.pathname)),"/"!==y.pathname.charAt(0)&&_(y.protocol)&&(y.pathname="/"+y.pathname),i(y.port,y.protocol)||(y.host=y.hostname,y.port=""),y.username=y.password="",y.auth&&(~(h=y.auth.indexOf(":"))?(y.username=y.auth.slice(0,h),y.username=encodeURIComponent(decodeURIComponent(y.username)),y.password=y.auth.slice(h+1),y.password=encodeURIComponent(decodeURIComponent(y.password))):y.username=encodeURIComponent(decodeURIComponent(y.auth)),y.auth=y.password?y.username+":"+y.password:y.username),y.origin="file:"!==y.protocol&&_(y.protocol)&&y.host?y.protocol+"//"+y.host:"null",y.href=y.toString()}v.prototype={set:function(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||o.parse)(t)),r[e]=t;break;case"port":r[e]=t,i(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,c.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var a="pathname"===e?"/":"#";r[e]=t.charAt(0)!==a?a+t:t}else r[e]=t;break;case"username":case"password":r[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(r.username=t.slice(0,s),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=t.slice(s+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(t))}for(var u=0;u<f.length;u++){var l=f[u];l[4]&&(r[l[1]]=r[l[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin="file:"!==r.protocol&&_(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,n=this,i=n.host,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var a=r+(n.protocol&&n.slashes||_(n.protocol)?"//":"");return n.username?(a+=n.username,n.password&&(a+=":"+n.password),a+="@"):n.password?(a+=":"+n.password,a+="@"):"file:"!==n.protocol&&_(n.protocol)&&!i&&"/"!==n.pathname&&(a+="@"),(":"===i[i.length-1]||c.test(n.hostname)&&!n.port)&&(i+=":"),a+=i+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(a+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(a+=n.hash),a}},v.extractProtocol=m,v.location=p,v.trimLeft=d,v.qs=o,e.exports=v}}]);