!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).GD_SLS_RUM=t()}(this,function(){"use strict";function F(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j={};{var A=j;function D(t,e){try{if(i=t,o=e,!(navigator&&navigator.sendBeacon&&navigator.sendBeacon(i+"?APIVersion=0.6.0",o))){var r=t;var n=e;const a=new window.XMLHttpRequest;a.open("POST",r,!0),a.setRequestHeader("x-log-apiversion","0.6.0"),a.setRequestHeader("x-log-bodyrawsize",n.length.toString()),r=new Blob([n],{type:"application/x-protobuf"}),a.send(r)}}catch(e){window&&window.console&&"function"==typeof window.console.error&&(console.error("Failed to log to ali log service because of this exception:\n"+e),console.error("Failed log data:",t))}var i,o}Object.defineProperty(A,"__esModule",{value:!0});class Zt extends class{constructor(e){var t;this.timer=null,this.time=10,this.count=10,this.arr=[],this.time=null!=(t=e.time)?t:10,this.count=null!=(t=e.count)?t:10,this.url="https://"+e.project+"."+e.host+"/logstores/"+e.logstore+"/track",(this.opt=e).installUnloadHook&&"function"==typeof e.installUnloadHook&&e.installUnloadHook(()=>{this.platformSend(this.assemblePayload())})}assemblePayload(e=this.arr){const t={__logs__:e};return this.opt.tags&&(t.__tags__=this.opt.tags),this.opt.topic&&(t.__topic__=this.opt.topic),this.opt.source&&(t.__source__=this.opt.source),JSON.stringify(t)}platformSend(e){this.opt.sendPayload&&"function"==typeof this.opt.sendPayload&&this.arr&&0<this.arr.length&&this.opt.sendPayload(this.url,e)}transString(e){let t={};for(var r in e)"object"==typeof e[r]?t[r]=JSON.stringify(e[r]):t[r]=String(e[r]);return t}sendImmediateInner(){this.arr&&0<this.arr.length&&(this.platformSend(this.assemblePayload()),null!=this.timer&&(clearTimeout(this.timer),this.timer=null),this.arr=[])}sendInner(){if(this.timer)this.arr.length>=this.count&&(clearTimeout(this.timer),this.timer=null,this.sendImmediateInner());else{const e=this;this.arr.length>=this.count||this.time<=0?this.sendImmediateInner():this.timer=setTimeout(function(){e.sendImmediateInner()},1e3*this.time)}}send(e){e=this.transString(e);this.arr.push(e),this.sendInner()}sendImmediate(e){e=this.transString(e);this.arr.push(e),this.sendImmediateInner()}sendBatchLogs(e){e=e.map(e=>this.transString(e));this.arr.push(...e),this.sendInner()}sendBatchLogsImmediate(e){e=e.map(e=>this.transString(e));this.arr.push(...e),this.sendImmediateInner()}}{constructor(e){super(Object.assign({},e,{installUnloadHook:e=>{window.addEventListener("beforeunload",()=>{e()})},sendPayload:(e,t)=>{D(e,t)}}))}}function W(e,t,r){e[t]=r}W(window,"SLS_Tracker",Zt),A.default=Zt,A.defineGlobal=W}var H=F(j);const s=e=>{const t=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16));return(e?t.slice(t.length-e):t).replace(/-/g,"a")},$=()=>s(16).replace(/-/g,"a"),U=e=>e.startsWith("data:image")?e.substring(0,50)+"...":e.startsWith("/")&&!e.includes("://")?""+location.origin+e:e.startsWith("//")?""+location.protocol+e:e,c=(e,t=2)=>e<0?0:"number"!=typeof e?-1:Number(e.toFixed(t)),G=(e,t,r)=>{if("string"!=typeof e)return"";const n=e.split(">");return n.length<=r?e:"head"===t?n.slice(0,r).join(">"):"tail"===t?n.slice(-r).join(">"):""},V=e=>{e=e/1024/1024;return e<100/1024?1:e<500/1024?2:e<1?3:e<2?4:e<5?5:e<10?6:7};var l=function(){function s(){for(var e=0,t={};e<arguments.length;e++){var r,n=arguments[e];for(r in n)t[r]=n[r]}return t}function l(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function e(c){function a(){}function r(e,t,r){if("undefined"!=typeof document){"number"==typeof(r=s({path:"/"},a.defaults,r)).expires&&(r.expires=new Date(+new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var n=JSON.stringify(t);/^[\{\[]/.test(n)&&(t=n)}catch(e){}t=c.write?c.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var i,o="";for(i in r)r[i]&&(o+="; "+i,!0!==r[i]&&(o+="="+r[i].split(";")[0]));return document.cookie=e+"="+t+o}}function t(e,t){if("undefined"!=typeof document){for(var r={},n=document.cookie?document.cookie.split("; "):[],i=0;i<n.length;i++){var o=n[i].split("="),a=o.slice(1).join("=");t||'"'!==a.charAt(0)||(a=a.slice(1,-1));try{var s=l(o[0]),a=(c.read||c)(a,s)||l(a);if(t)try{a=JSON.parse(a)}catch(e){}if(r[s]=a,e===s)break}catch(e){}}return e?r[e]:r}}return a.set=r,a.get=function(e){return t(e,!1)},a.getJSON=function(e){return t(e,!0)},a.remove=function(e,t){r(e,"",s(t,{expires:-1}))},a.defaults={},a.withConverter=e,a}(function(){})}(),q="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),z=new Uint8Array(16);function X(){if(q)return q(z);throw new Error("uuid: This browser does not seem to support crypto.getRandomValues(). If you need to support this browser, please provide a custom random number generator through options.rng.")}for(var J=[],e=0;e<256;++e)J[e]=(e+256).toString(16).substr(1);function K(e,t){var t=t||0,r=J;return[r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[+t]]].join("")}function Z(){try{0}catch(e){}}Z(),Z();var Q="undefined"!=typeof wx&&!!wx.setStorageSync,Y="undefined"!=typeof window&&!Q,u="user_device_id",ee="user_device_id_timestamp";function te(){for(var e=new Array(16),t=0,r=0;t<16;t++)0==(3&t)&&(r=4294967296*Math.random()),e[t]=r>>>((3&t)<<3)&255;return e}function re(){return function(e,t,r){var n=t&&r||0,i=("string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),(e=e||{}).random||(e.rng||X)());if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[n+o]=i[o];return t||K(i)}("undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)?void 0:{rng:te}).replace(/-/g,"")}function ne(e,t){if(void 0===t&&(t=!1),Y){for(var r=(n=window.location.hostname.split(".")).slice(-1),n=n.slice(0,-1),i=!1,o=window.location.hostname;n.length;){r.unshift(n.pop());var a=(n.length?".":"")+r.join(".");if(l.set(u,e,{expires:1095,domain:a,sameSite:"None",secure:!0}),l.get(u)){i=!0,o=a;break}}return i||l.set(u,e,{domain:o,sameSite:"None",secure:!0}),t||l.set(ee,Date.now()+"",{domain:o,sameSite:"None",secure:!0,expires:1095}),e}if(Q)try{var s=Date.now()+"";return wx.setStorageSync(u,e),wx.setStorageSync(ee,s),wx.setStorage({key:u,data:e}),wx.setStorage({key:ee,data:s}),e}catch(e){}return e}function ie(){if(Y){if(!(r=l.get(u)))try{var e=window.localStorage.getItem("gaodingx-cache");if(e){var t=JSON.parse(e);if(t&&t.data.guest_finger&&t.data.guest_finger.data)return ne(r=t.data.guest_finger.data,!0),r}if(e=window.localStorage.getItem("guest_finger"))return ne(JSON.parse(e),!0),e}catch(e){}if(r)return r}if(Q)try{var r;if(r=wx.getStorageSync(u))return r}catch(e){}return ne(re())}const oe={dev:{project:"gaoding-dev",logstore:"gaoding-dev-rum-raw",instance:"gaoding-dev",sampleRate:1},fat:{project:"gaoding-fat",logstore:"gaoding-fat-rum-raw",instance:"gaoding-fat",sampleRate:1},stage:{project:"gaoding-stage",logstore:"gaoding-stage-rum-raw",instance:"gaoding-stage",sampleRate:1},prod:{project:"gaoding-prod",logstore:"gaoding-prod-rum-raw",instance:"gaoding-prod",sampleRate:1}};function ae(){var e={function:!0,object:!0},L=e[typeof window]&&window||this,r=e[typeof exports]&&exports,e=e[typeof module]&&module&&!module.nodeType&&module,t=r&&e&&"object"==typeof global&&global,s=(!t||t.global!==t&&t.window!==t&&t.self!==t||(L=t),Math.pow(2,53)-1),R=/\bOpera/,t=Object.prototype,n=t.hasOwnProperty,P=t.toString;function i(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function M(e){return e=A(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:i(e)}function _(e,t){for(var r in e)n.call(e,r)&&t(e[r],r,e)}function B(e){return null==e?i(e):P.call(e).slice(8,-1)}function F(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function j(r,n){var i=null,e=r,t=function(e,t){i=n(i,e,t,r)},o=-1,a=e?e.length:0;if("number"==typeof a&&-1<a&&a<=s)for(;++o<a;)t(e[o],o,e);else _(e,t);return i}function A(e){return String(e).replace(/^ +| +$/g,"")}function D(o){var t,r,e,n,i=L,a=o&&"object"==typeof o&&"String"!=B(o),s=(a&&(i=o,o=null),i.navigator||{}),c=s.userAgent||"",l=(o=o||c,a?!!s.likeChrome:/\bChrome\b/.test(o)&&!/internal|\n/i.test(P.toString())),u="Object",d=a?u:"ScriptBridgingProxyObject",p=a?u:"Environment",f=a&&i.java?"JavaPackage":B(i.java),u=a?u:"RuntimeObject",f=/\bJava/.test(f)&&i.java,p=f&&B(i.environment)==p,h=f?"a":"α",m=f?"b":"β",g=i.document||{},v=i.operamini||i.opera,a=R.test(a=a&&v?v["[[Class]]"]:B(v))?a:v=null,b=o,y=[],w=null,c=o==c,S=c&&v&&"function"==typeof v.version&&v.version(),x=j([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,t){return e||RegExp("\\b"+(t.pattern||F(t))+"\\b","i").exec(o)&&(t.label||t)}),E=j(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(e,t){return e||RegExp("\\b"+(t.pattern||F(t))+"\\b","i").exec(o)&&(t.label||t)}),T=C([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),O=j({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},function(e,t,r){return e||(t[T]||t[/^[a-z]+(?: +[a-z]+\b)*/i.exec(T)]||RegExp("\\b"+F(r)+"(?:\\b|\\w*\\d)","i").exec(o))&&r}),k=j(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(e,t){var r,n,i=t.pattern||F(t);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(o))&&(r=e,i=i,t=t.label||t,n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},i&&t&&/^Win/i.test(r)&&!/^Windows Phone /i.test(r)&&(n=n[/[\d.]+$/.exec(r)])&&(r="Windows "+n),r=String(r),e=r=M((r=i&&t?r.replace(RegExp(i,"i"),t):r).replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])),e});function C(e){return j(e,function(e,t){var r=t.pattern||F(t);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(o)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(o)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(o))&&((e=String(t.label&&!RegExp(r,"i").test(t.label)?t.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),t=t.label||t,e=M(e[0].replace(RegExp(r,"i"),t).replace(RegExp("; *(?:"+t+"[_-])?","i")," ").replace(RegExp("("+t+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function I(e){return j(e,function(e,t){return e||(RegExp(t+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(o)||0)[1]||null})}if(x=x&&[x],/\bAndroid\b/.test(k)&&!T&&(t=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(o))&&(T=A(t[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),O&&!T?T=C([O]):O&&T&&(T=T.replace(RegExp("^("+F(O)+")[-_.\\s]","i"),O+" ").replace(RegExp("^("+F(O)+")[-_.]?(\\w)","i"),O+" $2")),(t=/\bGoogle TV\b/.exec(T))&&(T=t[0]),/\bSimulator\b/i.test(o)&&(T=(T?T+" ":"")+"Simulator"),"Opera Mini"==E&&/\bOPiOS\b/.test(o)&&y.push("running in Turbo/Uncompressed mode"),"IE"==E&&/\blike iPhone OS\b/.test(o)?(O=(t=D(o.replace(/like iPhone OS/,""))).manufacturer,T=t.product):/^iP/.test(T)?(E=E||"Safari",k="iOS"+((t=/ OS ([\d_]+)/i.exec(o))?" "+t[1].replace(/_/g,"."):"")):"Konqueror"==E&&/^Linux\b/i.test(k)?k="Kubuntu":O&&"Google"!=O&&(/Chrome/.test(E)&&!/\bMobile Safari\b/i.test(o)||/\bVita\b/.test(T))||/\bAndroid\b/.test(k)&&/^Chrome/.test(E)&&/\bVersion\//i.test(o)?(E="Android Browser",k=/\bAndroid\b/.test(k)?k:"Android"):"Silk"==E?(/\bMobi/i.test(o)||(k="Android",y.unshift("desktop mode")),/Accelerated *= *true/i.test(o)&&y.unshift("accelerated")):"UC Browser"==E&&/\bUCWEB\b/.test(o)?y.push("speed mode"):"PaleMoon"==E&&(t=/\bFirefox\/([\d.]+)\b/.exec(o))?y.push("identifying as Firefox "+t[1]):"Firefox"==E&&(t=/\b(Mobile|Tablet|TV)\b/i.exec(o))?(k=k||"Firefox OS",T=T||t[1]):!E||(t=!/\bMinefield\b/i.test(o)&&/\b(?:Firefox|Safari)\b/.exec(E))?(E&&!T&&/[\/,]|^[^(]+?\)/.test(o.slice(o.indexOf(t+"/")+8))&&(E=null),(t=T||O||k)&&(T||O||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(k))&&(E=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(k)?k:t)+" Browser")):"Electron"==E&&(t=(/\bChrome\/([\d.]+)\b/.exec(o)||0)[1])&&y.push("Chromium "+t),S=S||I(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",F(E),"(?:Firefox|Minefield|NetFront)"]),(t=("iCab"==x&&3<parseFloat(S)?"WebKit":/\bOpera\b/.test(E)&&(/\bOPR\b/.test(o)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(o)&&!/^(?:Trident|EdgeHTML)$/.test(x)&&"WebKit"||!x&&/\bMSIE\b/i.test(o)&&("Mac OS"==k?"Tasman":"Trident")||"WebKit"==x&&/\bPlayStation\b(?! Vita\b)/i.test(E)&&"NetFront")&&(x=[t]),"IE"==E&&(t=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(o)||0)[1])?(E+=" Mobile",k="Windows Phone "+(/\+$/.test(t)?t:t+".x"),y.unshift("desktop mode")):/\bWPDesktop\b/i.test(o)?(E="IE Mobile",k="Windows Phone 8.x",y.unshift("desktop mode"),S=S||(/\brv:([\d.]+)/.exec(o)||0)[1]):"IE"!=E&&"Trident"==x&&(t=/\brv:([\d.]+)/.exec(o))&&(E&&y.push("identifying as "+E+(S?" "+S:"")),E="IE",S=t[1]),c){if(n="global",N=null!=(e=i)?typeof e[n]:"number",/^(?:boolean|number|string|undefined)$/.test(N)||"object"==N&&!e[n])B(t=i.runtime)==d?(E="Adobe AIR",k=t.flash.system.Capabilities.os):B(t=i.phantom)==u?(E="PhantomJS",S=(t=t.version||null)&&t.major+"."+t.minor+"."+t.patch):"number"==typeof g.documentMode&&(t=/\bTrident\/(\d+)/i.exec(o))?(S=[S,g.documentMode],(t=+t[1]+4)!=S[1]&&(y.push("IE "+S[1]+" mode"),x&&(x[1]=""),S[1]=t),S="IE"==E?String(S[1].toFixed(1)):S[0]):"number"==typeof g.documentMode&&/^(?:Chrome|Firefox)\b/.test(E)&&(y.push("masking as "+E+" "+S),E="IE",S="11.0",x=["Trident"],k="Windows");else if(f&&(b=(t=f.lang.System).getProperty("os.arch"),k=k||t.getProperty("os.name")+" "+t.getProperty("os.version")),p){try{S=i.require("ringo/engine").version.join("."),E="RingoJS"}catch(e){(t=i.system)&&t.global.system==i.system&&(E="Narwhal",k=k||t[0].os||null)}E=E||"Rhino"}else"object"==typeof i.process&&!i.process.browser&&(t=i.process)&&("object"==typeof t.versions&&("string"==typeof t.versions.electron?(y.push("Node "+t.versions.node),E="Electron",S=t.versions.electron):"string"==typeof t.versions.nw&&(y.push("Chromium "+S,"Node "+t.versions.node),E="NW.js",S=t.versions.nw)),E||(E="Node.js",b=t.arch,k=t.platform,S=(S=/[\d.]+/.exec(t.version))?S[0]:null));k=k&&M(k)}if(S&&(t=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(S)||/(?:alpha|beta)(?: ?\d)?/i.exec(o+";"+(c&&s.appMinorVersion))||/\bMinefield\b/i.test(o)&&"a")&&(w=/b/i.test(t)?"beta":"alpha",S=S.replace(RegExp(t+"\\+?$"),"")+("beta"==w?m:h)+(/\d+\+?/.exec(t)||"")),"Fennec"==E||"Firefox"==E&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(k))E="Firefox Mobile";else if("Maxthon"==E&&S)S=S.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(T))"Xbox 360"==T&&(k=null),"Xbox 360"==T&&/\bIEMobile\b/.test(o)&&y.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(E)&&(!E||T||/Browser|Mobi/.test(E))||"Windows CE"!=k&&!/Mobi/i.test(o))if("IE"==E&&c)try{null===i.external&&y.unshift("platform preview")}catch(e){y.unshift("embedded")}else(/\bBlackBerry\b/.test(T)||/\bBB10\b/.test(o))&&(t=(RegExp(T.replace(/ +/g," *")+"/([.\\d]+)","i").exec(o)||0)[1]||S)?(k=((t=[t,/BB10/.test(o)])[1]?(T=null,O="BlackBerry"):"Device Software")+" "+t[0],S=null):this!=_&&"Wii"!=T&&(c&&v||/Opera/.test(E)&&/\b(?:MSIE|Firefox)\b/i.test(o)||"Firefox"==E&&/\bOS X (?:\d+\.){2,}/.test(k)||"IE"==E&&(k&&!/^Win/.test(k)&&5.5<S||/\bWindows XP\b/.test(k)&&8<S||8==S&&!/\bTrident\b/.test(o)))&&!R.test(t=D.call(_,o.replace(R,"")+";"))&&t.name&&(t="ing as "+t.name+((t=t.version)?" "+t:""),R.test(E)?(/\bIE\b/.test(t)&&"Mac OS"==k&&(k=null),t="identify"+t):(t="mask"+t,E=a?M(a.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(t)&&(k=null),c||(S=null)),x=["Presto"],y.push(t));else E+=" Mobile";(t=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(o)||0)[1])&&(t=[parseFloat(t.replace(/\.(\d)$/,".0$1")),t],"Safari"==E&&"+"==t[1].slice(-1)?(E="WebKit Nightly",w="alpha",S=t[1].slice(0,-1)):S!=t[1]&&S!=(t[2]=(/\bSafari\/([\d.]+\+?)/i.exec(o)||0)[1])||(S=null),t[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(o)||0)[1],537.36==t[0]&&537.36==t[2]&&28<=parseFloat(t[1])&&"WebKit"==x&&(x=["Blink"]),t=c&&(l||t[1])?(x&&(x[1]="like Chrome"),t[1]||((t=t[0])<530?1:t<532?2:t<532.05?3:t<533?4:t<534.03?5:t<534.07?6:t<534.1?7:t<534.13?8:t<534.16?9:t<534.24?10:t<534.3?11:t<535.01?12:t<535.02?"13+":t<535.07?15:t<535.11?16:t<535.19?17:t<536.05?18:t<536.1?19:t<537.01?20:t<537.11?"21+":t<537.13?23:t<537.18?24:t<537.24?25:t<537.36?26:"Blink"!=x?"27":"28")):(x&&(x[1]="like Safari"),(t=t[0])<400?1:t<500?2:t<526?3:t<533?4:t<534?"4+":t<535?5:t<537?6:t<538?7:t<601?8:t<602?9:t<604?10:t<606?11:t<608?12:"12"),x&&(x[1]+=" "+(t+="number"==typeof t?".x":/[.+]/.test(t)?"":"+")),"Safari"==E&&(!S||45<parseInt(S))?S=t:"Chrome"==E&&/\bHeadlessChrome/i.test(o)&&y.unshift("headless")),"Opera"==E&&(t=/\bzbov|zvav$/.exec(k))?(E+=" ",y.unshift("desktop mode"),"zvav"==t?(E+="Mini",S=null):E+="Mobile",k=k.replace(RegExp(" *"+t+"$"),"")):"Safari"==E&&/\bChrome\b/.exec(x&&x[1])?(y.unshift("desktop mode"),E="Chrome Mobile",S=null,k=/\bOS X\b/.test(k)?(O="Apple","iOS 4.3+"):null):/\bSRWare Iron\b/.test(E)&&!S&&(S=I("Chrome")),(k=S&&0==S.indexOf(t=/[\d.]+$/.exec(k))&&-1<o.indexOf("/"+t+"-")?A(k.replace(t,"")):k)&&-1!=k.indexOf(E)&&!RegExp(E+" OS").test(k)&&(k=k.replace(RegExp(" *"+F(E)+" *"),"")),x&&!/\b(?:Avant|Nook)\b/.test(E)&&(/Browser|Lunascape|Maxthon/.test(E)||"Safari"!=E&&/^iOS/.test(k)&&/\bSafari\b/.test(x[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(E)&&x[1])&&(t=x[x.length-1])&&y.push(t),y.length&&(y=["("+y.join("; ")+")"]),O&&T&&T.indexOf(O)<0&&y.push("on "+O),T&&y.push((/^on /.test(y[y.length-1])?"":"on ")+T),k&&(t=/ ([\d.+]+)$/.exec(k),r=t&&"/"==k.charAt(k.length-t[0].length-1),k={architecture:32,family:t&&!r?k.replace(t[0],""):k,version:t?t[1]:null,toString:function(){var e=this.version;return this.family+(e&&!r?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(t=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(b))&&!/\bi686\b/i.test(b)?(k&&(k.architecture=64,k.family=k.family.replace(RegExp(" *"+t),"")),E&&(/\bWOW64\b/i.test(o)||c&&/\w(?:86|32)$/.test(s.cpuClass||s.platform)&&!/\bWin64; x64\b/i.test(o))&&y.unshift("32-bit")):k&&/^OS X/.test(k.family)&&"Chrome"==E&&39<=parseFloat(S)&&(k.architecture=64),o=o||null;var N={};return N.description=o,N.layout=x&&x[0],N.manufacturer=O,N.name=E,N.prerelease=w,N.product=T,N.ua=o,N.version=E&&S,N.os=k||{architecture:null,family:null,version:null,toString:function(){return"null"}},N.parse=D,N.toString=function(){return this.description||""},N.version&&y.unshift(S),N.name&&y.unshift(E),k&&E&&(k!=String(k).split(" ")[0]||k!=E.split(" ")[0]&&!T)&&y.push(T?"("+k+")":"on "+k),y.length&&(N.description=y.join(" ")),N}var o=D();return"function"==typeof define&&"object"==typeof define.amd&&define.amd?(L.platform=o,define(function(){return o})):r&&e?_(o,function(e,t){r[t]=e}):L.platform=o,o}function se(e){var t=((t,r)=>{let n={};return"object"!=typeof r||Object.keys(r).forEach(e=>{n[t+"."+e]=r[e]}),n})("custom",e.custom),r=ae();return Object.assign({sid:s(32).replace(/-/g,"a"),pid:$(),sr:window.screen.width+"x"+window.screen.height,ad:window.innerWidth+"x"+window.innerHeight,instance:e.instance,browser_name:r.name||window.navigator.userAgent,browser_version:r.version||"__browser_version__",os_type:navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)?"mobile":"pc",os:r.os.family||"__os__",os_version:r.os.version||"__os_version__",sdk_version:"1.11.7",sampleRate:e.sampleRate,env:e.env,version:"dev"===e.env?e.service:e.service+"_"+e.version,uid:e.userId,device_id:e.deviceId,"page.duration":performance.now().toFixed(2),"page.host":window.location.host,"page.target":window.location.pathname,"page.path":window.location.pathname+window.location.search,"page.user_agent":window.navigator.userAgent,"page.referrer":document.referrer},t)}function ce(e){let t=history.pushState;const r=(e=>{let t;return()=>{clearTimeout(t),t=setTimeout(()=>{e()},600)}})(e);history.pushState=function(){var e=t.apply(this,arguments);return r(),e};let n=history.replaceState;history.replaceState=function(){var e=n.apply(this,arguments);return r(),e},window.addEventListener("hashchange",()=>{r()},!1)}const le=r=>{if(r){let e="",t="";r.options&&r.options.base&&(e=r.options.base),r.options&&r.options.history&&(e=r.options.history.base||"/");var n,r=r.currentRoute;return r&&r.matched&&(n=r.matched,t=n&&n.length&&n[n.length-1]&&n[n.length-1].path||""),r&&r.value&&r.value.matched&&(n=r.value.matched,t=n&&n.length&&n[n.length-1]&&n[n.length-1].path||""),(e+t).replace("//","/")}};class ue{constructor(e){this.oldPageUrl="",this.config=e,this.base=se(e),this.urlChangeListener=[],this.oldPageUrl=(this.base["page.path"]||"").split("?")[0],ce(()=>this.locationUpdata())}getData(){return this.setBase("page.duration",performance.now().toFixed(2)),Object.assign({},this.base)}getBase(){return this.base}setBase(e,t){this.base[e]=t}setVueRouter(e){this.vueRouter=e;e=le(e);this.setBase("page.target",e||window.location.pathname)}setOptions(e){this.base=se(Object.assign(this.config,e))}subscribe(e,t){this[e]||(this[e]=[]),this[e].push(t)}dispatch(e,t){"pageTarget"===e&&(this.pageTarget=t,this.setBase("page.target",t||window.location.pathname))}handleUrlChange(){var e=window.location.pathname;if(this.oldPageUrl!==e&&(this.oldPageUrl=e,this.urlChangeListener))for(let e=0;e<this.urlChangeListener.length;e++){const t=this.urlChangeListener[e];t()}}locationUpdata(){var e=le(this.vueRouter);this.setBase("pid",$()),this.setBase("page.target",this.pageTarget||e||window.location.pathname),this.setBase("page.path",window.location.pathname+window.location.search),this.setBase("page.referrer",document.referrer),this.handleUrlChange()}}const de=["img","script","link","svg","iframe","audio","video","source","embed"],d={MIN_TTFB_TIME:800},o=e=>{if(!e)return{"perf.name":"","perf.type":"","perf.duration":-1,"perf.size":-1,"perf.ttfb":-1,"perf.reds":-1,"perf.rede":-1,"perf.fets":-1,"perf.dms":-1,"perf.dme":-1,"perf.conns":-1,"perf.sconns":-1,"perf.conne":-1,"perf.reqs":-1,"perf.ress":-1,"perf.rese":-1};let t=e.startTime;return"number"!=typeof(t="number"!=typeof t?e.navigationStart:t)&&(t=0),{"perf.name":e.name,"perf.type":e.initiatorType||"navigation","perf.duration":c(e.duration),"perf.size":e.decodedBodySize,"perf.ttfb":e.responseStart>t?c(e.responseStart-t):0,"perf.reds":c(e.redirectStart-t),"perf.rede":c(e.redirectEnd-t),"perf.fets":c(e.fetchStart-t),"perf.dms":c(e.domainLookupStart-t),"perf.dme":c(e.domainLookupEnd-t),"perf.conns":c(e.connectStart-t),"perf.sconns":c(e.secureConnectionStart-t),"perf.conne":c(e.connectEnd-t),"perf.reqs":c(e.requestStart-t),"perf.ress":c(e.responseStart-t),"perf.rese":c(e.responseEnd-t)}};class pe{constructor(e){this.isSendImmediate=!1,this.collect=e,this.perfInfo={"perf.name":"","perf.type":"","perf.duration":-1,"perf.size":-1,"perf.reds":-1,"perf.rede":-1,"perf.fets":-1,"perf.dms":-1,"perf.dme":-1,"perf.conns":-1,"perf.sconns":-1,"perf.conne":-1,"perf.reqs":-1,"perf.ress":-1,"perf.rese":-1,"perf.doms":-1,"perf.dome":-1,"perf.domc":-1,"perf.loads":-1,"perf.loade":-1,"perf.ttfb":-1,"perf.bad_source":[]},this.attribute=Object.assign({},e.store.getData());const t=()=>{var e=performance.getEntriesByType("navigation")[0]||performance.timing||{};let t=e.startTime;"number"!=typeof(t="number"!=typeof t?e.navigationStart:t)&&(t=0),this.perfInfo["perf.doms"]=c(e.domContentLoadedEventStart-t),this.perfInfo["perf.dome"]=c(e.domContentLoadedEventEnd-t)};"loading"!==document.readyState?t():window.addEventListener("DOMContentLoaded",()=>{const e=setTimeout(()=>{clearTimeout(e),t()},0)}),window.addEventListener("load",()=>{const n=setTimeout(()=>{clearTimeout(n);var e=performance.getEntriesByType("navigation")[0]||performance.timing||{};let t=e.startTime;"number"!=typeof(t="number"!=typeof t?e.navigationStart:t)&&(t=0);var r=o(e);this.perfInfo=Object.assign(this.perfInfo,r),this.perfInfo["perf.domc"]=c(e.domComplete-t),this.perfInfo["perf.loads"]=c(e.loadEventStart-t),this.perfInfo["perf.loade"]=c(e.loadEventEnd-t),this.perfInfo["perf.bad_source"]=(t=>{let r=[];var n=100<t.length?100:t.length;for(let e=0;e<n;e++){var i,o,a=t[e];["css","script","link","fetch","xmlhttprequest","iframe","img","video","audio"].includes(a.initiatorType)&&(i=c(a.responseStart-a.startTime),o=V(a.decodedBodySize),(i>=d.MIN_TTFB_TIME||3<o||1e3<a.duration)&&r.length<=20&&r.push({start:a.startTime,duration:a.duration,size:a.decodedBodySize,type:a.initiatorType,name:a.name}))}return r})(performance.getEntries()),this.sendImmediate()},0)}),window.addEventListener("beforeunload",()=>{this.sendImmediate()})}sendImmediate(){if(!this.isSendImmediate){const t=Object.assign(this.attribute,this.perfInfo,{t:"perf"});t["page.duration"]=performance.now().toFixed(2);var e={attribute:JSON.stringify(t),service:this.collect.config.service,start:1e3*(new Date).getTime()};this.collect.tracker.sendImmediate(e),this.isSendImmediate=!0}}}function fe(){return v.deviceMemory}function he(){return v.hardwareConcurrency}function i(){return a&&!!a.getEntriesByType&&!!a.now&&!!a.mark}function me(){y.isHidden=!1,document.hidden&&(y.isHidden=document.hidden,y.didChange=!0)}function ge(){return!!(he()&&he()<=4)||!!(fe()&&fe()<=4)}function ve(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0}function be(){addEventListener("visibilitychange",Ke,!0),addEventListener("prerenderingchange",Ke,!0)}function ye(e,t){p||(p=t,f=e,Ne=new Date,Se(removeEventListener),we())}function we(){var t;0<=f&&f<Ne-Ye&&(t={entryType:"first-input",name:p.type,target:p.target,cancelable:p.cancelable,startTime:p.timeStamp,processingStart:p.timeStamp+f},h.forEach(function(e){e(t)}),h=[])}function Se(t){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return t(e,et,L)})}function xe(e){e.forEach(function(e){e.interactionId&&(nt=Math.min(nt,e.interactionId),it=Math.max(it,e.interactionId),rt=it?(it-nt)/7+1:0)})}function Ee(){return Le?rt:performance.interactionCount||0}function Te(){return Ee()-ot}function Oe(e){var t=R[R.length-1],r=at[e.interactionId];(r||R.length<10||e.duration>t.latency)&&(r?(r.entries.push(e),r.latency=Math.max(r.latency,e.duration)):(t={id:e.interactionId,latency:e.duration,entries:[e]},at[t.id]=t,R.push(t)),R.sort(function(e,t){return t.latency-e.latency}),R.splice(10).forEach(function(e){delete at[e.id]}))}function ke(e){document.prerendering?N(function(){return ke(e)}):"complete"!==document.readyState?addEventListener("load",function(){return ke(e)},!0):setTimeout(e,0)}function Ce(){var s,c,l,u,e;e=m.reportOptions.ttfb,lt(function(e){var t,r,n,i,o;(t=e).entries.length?(o=(r=t.entries[0]).activationStart||0,n=Math.max(r.domainLookupStart-o,0),i=Math.max(r.connectStart-o,0),o=Math.max(r.requestStart-o,0),t.attribution={waitingTime:n,dnsTime:i-n,connectionTime:o-i,requestTime:t.value-o,navigationEntry:r}):t.attribution={waitingTime:0,dnsTime:0,connectionTime:0,requestTime:0},(n=e).value=n.value-n.entries[0].requestStart,x(n)},e),e=m.reportOptions.cls,l=function(e){!function(e){if(e.entries.length){var t=e.entries.reduce(function(e,t){return e&&e.value>t.value?e:t});if(t&&t.sources&&t.sources.length){r=(r=t.sources).find(function(e){return e.node&&1===e.node.nodeType})||r[0];if(r)return e.attribution={largestShiftTarget:Ue(r.node),largestShiftTime:t.startTime,largestShiftValue:t.value,largestShiftSource:r,largestShiftEntry:t,loadState:T(t.startTime)}}}var r;e.attribution={}}(e),x(e)},u=e||{},Qe(Je(function(){function e(e){e.forEach(function(e){var t,r;e.hadRecentInput||(t=o[0],r=o[o.length-1],i&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,o.push(e)):(i=e.value,o=[e]))}),i>n.value&&(n.value=i,n.entries=o,t())}var t,r=[.1,.25],n=k("CLS",0),i=0,o=[],a=C("layout-shift",e);a&&(t=I(l,n,r,u.reportAllChanges),Xe(function(){e(a.takeRecords()),t(!0)}),O(function(){n=k("CLS",i=0),t=I(l,n,r,u.reportAllChanges),ze(function(){return t()})}),setTimeout(t,0))})),e=m.reportOptions.fcp,Qe(function(e){!function(e){if(e.entries.length){var t,r=E(),n=e.entries[e.entries.length-1];if(r)return t=r.activationStart||0,t=Math.max(0,r.responseStart-t),e.attribution={timeToFirstByte:t,firstByteToFCP:e.value-t,loadState:T(e.entries[0].startTime),navigationEntry:r,fcpEntry:n}}e.attribution={timeToFirstByte:0,firstByteToFCP:e.value,loadState:T(Ve())}}(e),x(e)},e),e=m.reportOptions.fid,tt(function(e){var t;t=e.entries[0],e.attribution={eventTarget:Ue(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:T(t.startTime)},x(e)},e),e=m.reportOptions.lcp,s=function(e){!function(e){if(e.entries.length){var t,r,n,i,o,a,s=E();if(s)return o=s.activationStart||0,r=(t=e.entries[e.entries.length-1]).url&&performance.getEntriesByType("resource").filter(function(e){return e.name===t.url})[0],a=Math.max(0,s.responseStart-o),n=Math.max(a,r?(r.requestStart||r.startTime)-o:0),i=Math.max(n,r?r.responseEnd-o:0),o=Math.max(i,t?t.startTime-o:0),a={element:Ue(t.element),timeToFirstByte:a,resourceLoadDelay:n-a,resourceLoadTime:i-n,elementRenderDelay:o-i,navigationEntry:s,lcpEntry:t},t.url&&(a.url=t.url),r&&(a.lcpResourceEntry=r),e.attribution=a}e.attribution={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadTime:0,elementRenderDelay:e.value}}(e),x(e)},c=e||{},N(function(){function e(e){var t;(e=e[e.length-1])&&(t=Math.max(e.startTime-qe(),0))<i.firstHiddenTime&&(o.value=t,o.entries=[e],r())}var r,t,n=[2500,4e3],i=Ze(),o=k("LCP"),a=C("largest-contentful-paint",e);a&&(r=I(s,o,n,c.reportAllChanges),t=Je(function(){ct[o.id]||(e(a.takeRecords()),a.disconnect(),ct[o.id]=!0,r(!0))}),["keydown","click"].forEach(function(e){addEventListener(e,t,!0)}),Xe(t),O(function(e){o=k("LCP"),r=I(s,o,n,c.reportAllChanges),ze(function(){o.value=performance.now()-e.timeStamp,ct[o.id]=!0,r(!0)})}))}),st(function(e){return x(e)},m.reportOptions.inp),m.isResourceTiming&&Ae("resource",dt),m.isElementTiming&&Ae("element",ut)}function Ie(e){var t="usageDetails"in e?e.usageDetails:{};S("storageEstimate",{quota:r(e.quota),usage:r(e.usage),caches:r(t.caches),indexedDB:r(t.indexedDB),serviceWorker:r(t.serviceWorkerRegistrations)})}var p,f,Ne,h,Le,m={isResourceTiming:!1,isElementTiming:!1,maxTime:3e4,reportOptions:{}},g=window,Re=g.console,v=g.navigator,a=g.performance,Pe="4g",Me=!1,b={},_e={value:0},Be={value:{beacon:0,css:0,fetch:0,img:0,other:0,script:0,total:0,xmlhttprequest:0}},Fe={value:0},t={value:0},je={},y={isHidden:!1,didChange:!1},Ae=function(e,t){try{var r=new PerformanceObserver(function(e){t(e.getEntries())});try{return r.observe({type:e,buffered:!0}),r}catch(t){return r.observe({entryTypes:[e]}),r}}catch(e){Re.warn("Perfume.js:",e)}return null},w=function(e){return parseFloat(e.toFixed(4))},r=function(e){return"number"!=typeof e?null:w(e/Math.pow(1024,2))},De=function(e,t,r,n,i){function o(){!m.analyticsTracker||y.isHidden&&!["CLS","INP"].includes(e)||m.analyticsTracker({attribution:n,metricName:e,data:t,navigatorInformation:v?{deviceMemory:fe()||0,hardwareConcurrency:he()||0,serviceWorkerStatus:"serviceWorker"in v?v.serviceWorker.controller?"controlled":"supported":"unsupported",isLowEndDevice:ge(),isLowEndExperience:function(e,t){switch(e){case"slow-2g":case"2g":case"3g":return!0;default:return ge()||t}}(Pe,Me)}:{},rating:r,navigationType:i})}var a;["CLS","INP"].includes(e)?o():(a=o,"requestIdleCallback"in g?g.requestIdleCallback(a,{timeout:3e3}):a())},We=function(e){e.forEach(function(e){"self"!==e.name||e.startTime<_e.value||0<(e=e.duration-50)&&(Fe.value+=e,t.value+=e)})},He={RT:[100,200],TBT:[200,600],NTBT:[200,600]},$e=function(e,t){return He[e]?t<=He[e][0]?"good":t<=He[e][1]?"needsImprovement":"poor":null},S=function(e,t,r){Object.keys(t).forEach(function(e){"number"==typeof t[e]&&(t[e]=w(t[e]))}),De(e,t,null,r||{})},x=function(e){var t=e.attribution,r=e.name,n=e.rating,i=e.value,o=e.navigationType,e=("FCP"===r&&(_e.value=i),["FCP","LCP"].includes(r)&&!je[0]&&(je[0]=Ae("longtask",We)),"FID"===r&&setTimeout(function(){y.didChange||(x({attribution:t,name:"TBT",rating:$e("TBT",Fe.value),value:Fe.value,navigationType:o}),S("dataConsumption",Be.value))},1e4),w(i));e<=m.maxTime&&0<=e&&De(r,e,n,t,o)},E=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},T=function(e){if("loading"===document.readyState)return"loading";var t=E();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},Ue=function(e,t){var r,n="";try{for(;e&&9!==e.nodeType;){var i=e,o=i.id?"#"+i.id:(r=void 0,r=i.nodeName,(1===i.nodeType?r.toLowerCase():r.toUpperCase().replace(/^#/,""))+(i.className&&i.className.length?"."+i.className.replace(/\s+/g,"."):""));if(n.length+o.length>(t||100)-1)return n||o;if(n=n?o+">"+n:o,i.id)break;e=i.parentNode}}catch(e){}return n},Ge=-1,Ve=function(){return Ge},O=function(t){addEventListener("pageshow",function(e){e.persisted&&(Ge=e.timeStamp,t(e))},!0)},qe=function(){var e=E();return e&&e.activationStart||0},k=function(e,t){var r=E(),n="navigate";return 0<=Ve()?n="back-forward-cache":r&&(n=document.prerendering||0<qe()?"prerender":document.wasDiscarded?"restore":r.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},C=function(e,t,r){try{var n;if(PerformanceObserver.supportedEntryTypes.includes(e))return(n=new PerformanceObserver(function(e){Promise.resolve().then(function(){t(e.getEntries())})})).observe(Object.assign({type:e,buffered:!0},r||{})),n}catch(e){}},I=function(t,r,n,i){var o,a;return function(e){0<=r.value&&(e||i)&&((a=r.value-(o||0))||void 0===o)&&(o=r.value,r.delta=a,r.rating=(e=r.value)>n[1]?"poor":e>n[0]?"needs-improvement":"good",t(r))}},ze=function(e){requestAnimationFrame(function(){return requestAnimationFrame(function(){return e()})})},Xe=function(t){function e(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||t(e)}addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},Je=function(t){var r=!1;return function(e){r||(t(e),r=!0)}},n=-1,Ke=function(e){"hidden"===document.visibilityState&&-1<n&&(n="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("visibilitychange",Ke,!0),removeEventListener("prerenderingchange",Ke,!0))},Ze=function(){return n<0&&(n=ve(),be(),O(function(){setTimeout(function(){n=ve(),be()},0)})),{get firstHiddenTime(){return n}}},N=function(e){document.prerendering?addEventListener("prerenderingchange",function(){return e()},!0):e()},Qe=function(a,s){s=s||{},N(function(){var t,r=[1800,3e3],n=Ze(),i=k("FCP"),o=C("paint",function(e){e.forEach(function(e){"first-contentful-paint"===e.name&&(o.disconnect(),e.startTime<n.firstHiddenTime&&(i.value=Math.max(e.startTime-qe(),0),i.entries.push(e),t(!0)))})});o&&(t=I(a,i,r,s.reportAllChanges),O(function(e){i=k("FCP"),t=I(a,i,r,s.reportAllChanges),ze(function(){i.value=performance.now()-e.timeStamp,t(!0)})}))})},L={passive:!0,capture:!0},Ye=new Date,et=function(e){var t,r,n,i;function o(){ye(r,n),i()}function a(){i()}e.cancelable&&(t=(1e12<e.timeStamp?new Date:performance.now())-e.timeStamp,"pointerdown"==e.type?(r=t,n=e,i=function(){removeEventListener("pointerup",o,L),removeEventListener("pointercancel",a,L)},addEventListener("pointerup",o,L),addEventListener("pointercancel",a,L)):ye(t,e))},tt=function(s,c){c=c||{},N(function(){function e(e){e.forEach(i)}var t=[100,300],r=Ze(),n=k("FID"),i=function(e){e.startTime<r.firstHiddenTime&&(n.value=e.processingStart-e.startTime,n.entries.push(e),a(!0))},o=C("first-input",e),a=I(s,n,t,c.reportAllChanges);o&&Xe(Je(function(){e(o.takeRecords()),o.disconnect()})),o&&O(function(){var e;n=k("FID"),a=I(s,n,t,c.reportAllChanges),h=[],f=-1,p=null,Se(addEventListener),e=i,h.push(e),we()})})},rt=0,nt=1/0,it=0,ot=0,R=[],at={},st=function(n,e){var o,a;o=function(e){var t,r;(t=e).entries.length?(r=t.entries.sort(function(e,t){return t.duration-e.duration||t.processingEnd-t.processingStart-(e.processingEnd-e.processingStart)})[0],t.attribution={eventTarget:Ue(r.target),eventType:r.name,eventTime:r.startTime,eventEntry:r,loadState:T(r.startTime)}):t.attribution={},n(e)},a=e||{},N(function(){var e=[200,500];"interactionCount"in performance||Le||(Le=C("event",xe,{type:"event",buffered:!0,durationThreshold:0}));function t(e){e.forEach(function(t){t.interactionId&&Oe(t),"first-input"!==t.entryType||R.some(function(e){return e.entries.some(function(e){return t.duration===e.duration&&t.startTime===e.startTime})})||Oe(t)}),e=Math.min(R.length-1,Math.floor(Te()/50)),(e=R[e])&&e.latency!==r.value&&(r.value=e.latency,r.entries=e.entries,i())}var r=k("INP"),n=C("event",t,{durationThreshold:a.durationThreshold||40}),i=I(o,r,e,a.reportAllChanges);n&&(n.observe({type:"first-input",buffered:!0}),Xe(function(){t(n.takeRecords()),r.value<0&&0<Te()&&(r.value=0,r.entries=[]),i(!0)}),O(function(){R=[],ot=Ee(),r=k("INP"),i=I(o,r,e,a.reportAllChanges)}))})},ct={},lt=function(r,n){n=n||{};var i=[800,1800],o=k("TTFB"),a=I(r,o,i,n.reportAllChanges);ke(function(){var e,t=E();!t||(e=t.responseStart)<=0||e>performance.now()||(o.value=Math.max(e-qe(),0),o.entries=[t],a(!0),O(function(){o=k("TTFB",0),(a=I(r,o,i,n.reportAllChanges))(!0)}))})},ut=function(e){e.forEach(function(e){e.identifier&&x({attribution:{identifier:e.identifier},name:"ET",rating:null,value:e.startTime})})},dt=function(e){e.forEach(function(e){var t;m.isResourceTiming&&S("resourceTiming",e),e.decodedBodySize&&e.initiatorType&&(t=e.decodedBodySize/1e3,Be.value[e.initiatorType]+=t,Be.value.total+=t)})},pt=0,ft=(P.prototype.start=function(e){i()&&!b[e]&&(b[e]=!0,a.mark("mark_".concat(e,"_start")))},P.prototype.end=function(e,t,r){var n;void 0===t&&(t={}),void 0===r&&(r=!0),i()&&b[e]&&(a.mark("mark_".concat(e,"_end")),delete b[e],n=function(e){a.measure(e,"mark_".concat(e,"_start"),"mark_".concat(e,"_end"));e=a.getEntriesByName(e).pop();return e&&"measure"===e.entryType?e.duration:-1}(e),r&&S(e,w(n),t))},P.prototype.endPaint=function(e,t){var r=this;setTimeout(function(){r.end(e,t)})},P.prototype.clear=function(e){delete b[e],a.clearMarks&&(a.clearMarks("mark_".concat(e,"_start")),a.clearMarks("mark_".concat(e,"_end")))},P.prototype.markNTBT=function(){var e=this;this.start("ntbt"),t.value=0,clearTimeout(pt),pt=setTimeout(function(){e.end("ntbt",{},!1),x({attribution:{},name:"NTBT",rating:$e("NTBT",t.value),value:t.value}),t.value=0},2e3)},P);function P(e){void 0===e&&(e={}),this.v="8.3.0",m.analyticsTracker=e.analyticsTracker,m.isResourceTiming=!!e.resourceTiming,m.isElementTiming=!!e.elementTiming,m.maxTime=e.maxMeasureTime||m.maxTime,m.reportOptions=e.reportOptions||m.reportOptions,m.userJourneySteps=e.userJourneySteps,m.userJourneys=e.userJourneys,m.journeyMaxOutlierThreshold=e.journeyMaxOutlierThreshold,m.onMarkJourney=e.onMarkJourney,i()&&("PerformanceObserver"in g&&Ce(),void 0!==document.hidden&&document.addEventListener("visibilitychange",me),e=function(){if(!i())return{};var e=a.getEntriesByType("navigation")[0];if(!e)return{};var t=e.responseStart,r=e.responseEnd;return{fetchTime:r-e.fetchStart,workerTime:0<e.workerStart?r-e.workerStart:0,totalTime:r-e.requestStart,downloadTime:r-t,timeToFirstByte:t-e.requestStart,headerSize:e.transferSize-e.encodedBodySize||0,dnsLookupTime:e.domainLookupEnd-e.domainLookupStart,redirectTime:e.redirectEnd-e.redirectStart}}(),S("navigationTiming",e),e.redirectTime&&x({attribution:{},name:"RT",rating:$e("RT",e.redirectTime),value:e.redirectTime}),S("networkInformation",!("connection"in v)||"object"!=typeof(e=v.connection)?{}:(Pe=e.effectiveType,Me=!!e.saveData,{downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt,saveData:!!e.saveData})),v&&v.storage&&"function"==typeof v.storage.estimate&&v.storage.estimate().then(Ie))}class ht{constructor(e,t){this.isSendImmediate=!1,this.collect=e,this.store=t,this.vitalsInfo={t:"vitals","perf.lcp":-1,"perf.lcp_xpath":"","perf.lcp_pageurl":"","perf.fp":-1,"perf.fcp":-1,"perf.cls":-1,"perf.cls_xpath":"","perf.cls_pageurl":"","perf.tbt":-1,"perf.fid":-1},this.attribute=Object.assign({},e.store.getData()),this.compute(),this.store.subscribe("urlChangeListener",()=>{this.sendImmediate()}),window.addEventListener("beforeunload",()=>{this.sendImmediate()})}compute(){new ft({reportOptions:{lcp:{reportAllChanges:!0},cls:{reportAllChanges:!0}},analyticsTracker:e=>{var{attribution:e,metricName:t,data:r}=e;"FP"===t&&(this.vitalsInfo["perf.fp"]=c(r)),"FCP"===t&&(this.vitalsInfo["perf.fcp"]=c(r)),"LCP"===t&&(this.vitalsInfo["perf.lcp"]=c(r),this.vitalsInfo["perf.lcp_xpath"]=G(e&&e.element,"tail",15)),"CLS"===t&&(this.vitalsInfo["perf.cls_xpath"]=G(e&&e.largestShiftTarget,"tail",15),this.vitalsInfo["perf.cls"]=r),"TBT"===t&&(this.vitalsInfo["perf.tbt"]=c(r)),"FID"===t&&(this.vitalsInfo["perf.fid"]=c(r))}})}sendImmediate(){if(!this.isSendImmediate){const t=Object.assign(this.attribute,this.vitalsInfo);t["page.duration"]=performance.now().toFixed(2);var e={attribute:JSON.stringify(t),service:this.collect.config.service,start:1e3*(new Date).getTime()};this.collect.tracker.sendImmediate(e),this.isSendImmediate=!0}}}class mt{constructor(e,t){this.collect=e,this.store=t;const r=setTimeout(()=>{clearTimeout(r),this.addPageVisit(!0)},500);this.store.subscribe("urlChangeListener",()=>{this.addPageVisit(!1)})}addPageVisit(e){this.collect.report({t:"pv",initpv:e?"1":"0"})}}function gt(e,a,s,c){return new(s=s||Promise)(function(r,t){function n(e){try{o(c.next(e))}catch(e){t(e)}}function i(e){try{o(c.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,i)}o((c=c.apply(e,a||[])).next())})}var vt,bt={exports:{}};function yt(){return vt?bt.exports:(vt=1,bt.exports=function(){function r(e){return!isNaN(parseFloat(e))&&isFinite(e)}function n(e){return e.charAt(0).toUpperCase()+e.substring(1)}function e(e){return function(){return this[e]}}var t=["isConstructor","isEval","isNative","isToplevel"],i=["columnNumber","lineNumber"],o=["fileName","functionName","source"],a,s,c=t.concat(i,o,["args"],["evalOrigin"]);function d(e){if(!e)return;for(var t=0;t<c.length;t++)if(e[c[t]]!==undefined)this["set"+n(c[t])](e[c[t]])}d.prototype={getArgs:function(){return this.args},setArgs:function(e){if(Object.prototype.toString.call(e)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof d)this.evalOrigin=e;else if(e instanceof Object)this.evalOrigin=new d(e);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var e=this.getFileName()||"";var t=this.getLineNumber()||"";var r=this.getColumnNumber()||"";var n=this.getFunctionName()||"";if(this.getIsEval()){if(e)return"[eval] ("+e+":"+t+":"+r+")";return"[eval]:"+t+":"+r}if(n)return n+" ("+e+":"+t+":"+r+")";return e+":"+t+":"+r}},d.fromString=function e(t){var r=t.indexOf("(");var n=t.lastIndexOf(")");var i=t.substring(0,r);var o=t.substring(r+1,n).split(",");var a=t.substring(n+1);if(a.indexOf("@")===0){var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(a,"");var c=s[1];var l=s[2];var u=s[3]}return new d({functionName:i,args:o||undefined,fileName:c,lineNumber:l||undefined,columnNumber:u||undefined})};for(var l=0;l<t.length;l++){d.prototype["get"+n(t[l])]=e(t[l]);d.prototype["set"+n(t[l])]=function(t){return function(e){this[t]=Boolean(e)}}(t[l])}for(var u=0;u<i.length;u++){d.prototype["get"+n(i[u])]=e(i[u]);d.prototype["set"+n(i[u])]=function(t){return function(e){if(!r(e))throw new TypeError(t+" must be a Number");this[t]=Number(e)}}(i[u])}for(var p=0;p<o.length;p++){d.prototype["get"+n(o[p])]=e(o[p]);d.prototype["set"+n(o[p])]=function(t){return function(e){this[t]=String(e)}}(o[p])}return d}())}var wt=function(c){var n=/(^|@)\S+:\d+/;var i=/^\s*at .*(\S+:\d+|\(native\))/m;var o=/^(eval@)?(\[native code])?$/;return{parse:function e(t){if(typeof t.stacktrace!=="undefined"||typeof t["opera#sourceloc"]!=="undefined")return this.parseOpera(t);else if(t.stack&&t.stack.match(i))return this.parseV8OrIE(t);else if(t.stack)return this.parseFFOrSafari(t);else throw new Error("Cannot parse given Error object")},extractLocation:function e(t){if(t.indexOf(":")===-1)return[t];var r=/(.+?)(?::(\d+))?(?::(\d+))?$/;var n=r.exec(t.replace(/[()]/g,""));return[n[1],n[2]||undefined,n[3]||undefined]},parseV8OrIE:function e(t){var r=t.stack.split("\n").filter(function(e){return!!e.match(i)},this);return r.map(function(e){if(e.indexOf("(eval ")>-1)e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,"");var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,"");var r=t.match(/ (\(.+\)$)/);t=r?t.replace(r[0],""):t;var n=this.extractLocation(r?r[1]:t);var i=r&&t||undefined;var o=["eval","<anonymous>"].indexOf(n[0])>-1?undefined:n[0];return new c({functionName:i,fileName:o,lineNumber:n[1],columnNumber:n[2],source:e})},this)},parseFFOrSafari:function e(t){var r=t.stack.split("\n").filter(function(e){return!e.match(o)},this);return r.map(function(e){if(e.indexOf(" > eval")>-1)e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1");if(e.indexOf("@")===-1&&e.indexOf(":")===-1)return new c({functionName:e});else{var t=/((.*".+"[^@]*)?[^@]*)(?:@)/;var r=e.match(t);var n=r&&r[1]?r[1]:undefined;var i=this.extractLocation(e.replace(t,""));return new c({functionName:n,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:e})}},this)},parseOpera:function e(t){if(!t.stacktrace||t.message.indexOf("\n")>-1&&t.message.split("\n").length>t.stacktrace.split("\n").length)return this.parseOpera9(t);else if(!t.stack)return this.parseOpera10(t);else return this.parseOpera11(t)},parseOpera9:function e(t){var r=/Line (\d+).*script (?:in )?(\S+)/i;var n=t.message.split("\n");var i=[];for(var o=2,a=n.length;o<a;o+=2){var s=r.exec(n[o]);if(s)i.push(new c({fileName:s[2],lineNumber:s[1],source:n[o]}))}return i},parseOpera10:function e(t){var r=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var n=t.stacktrace.split("\n");var i=[];for(var o=0,a=n.length;o<a;o+=2){var s=r.exec(n[o]);if(s)i.push(new c({functionName:s[3]||undefined,fileName:s[2],lineNumber:s[1],source:n[o]}))}return i},parseOpera11:function e(t){var r=t.stack.split("\n").filter(function(e){return!!e.match(n)&&!e.match(/^Error created at/)},this);return r.map(function(e){var t=e.split("@");var r=this.extractLocation(t.pop());var n=t.shift()||"";var i=n.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||undefined;var o;if(n.match(/\(([^)]*)\)/))o=n.replace(/^[^(]+\(([^)]*)\)$/,"$1");var a=o===undefined||o==="[arguments not available]"?undefined:o.split(",");return new c({functionName:i,args:a,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:e})},this)}}}(yt());class St{constructor(e,t){this.exOtherLen=10,this.collect=e,this.options=t,window.addEventListener("error",e=>{this.addBrowserError(e)}),window.addEventListener("unhandledrejection",t=>{if(!this.interceptApiError(t)){let e="unhandledrejection";t.reason.message?e=t.reason.message:"string"==typeof t.reason?e="unhandledrejection: "+t.reason:"object"==typeof t.reason&&(e="unhandledrejection: "+JSON.stringify(t.reason)),this.addLog({source:"",columnNumber:0,lineNumber:0,message:e,name:t.reason.name||t.type||"unhandledrejection",stack:t.reason.stack})}},!1)}formatErrorStack(e){if(!e.stack)return{stack:"",columnNumber:0,lineNumber:0};let t=`${e.name||"Error"}: `+e.message;const r=wt.parse(e);return e.customStack&&e.customStack.forEach(e=>{t+=`
  at ${e.message} @ `+e.title}),r.forEach(e=>{t+=`
  at ${e.functionName||"<anonymous>"} @ `+e.fileName+(e.lineNumber?":"+e.lineNumber:"")+(e.columnNumber?":"+e.columnNumber:"")}),{stack:encodeURIComponent(t),columnNumber:r[0].columnNumber,lineNumber:r[0].lineNumber,fileName:r[0].fileName}}addBrowserError(e,t){e&&e.error&&this.addLog({source:e.filename,columnNumber:e.colno,lineNumber:e.lineno,message:e.message||"",name:(e.message||"").split(":")[0],stack:e.error.stack||""},"error",{start:t})}addCtsError(e,t){var r,n,i,o,a,s,c,l;(e instanceof Error||"object"==typeof e)&&({colno:r,lineno:n,message:i,name:o,stack:a,customStack:s,filename:c}=e,l=function(e,t){var r={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}(e,["colno","lineno","message","name","stack","customStack","filename"]),this.addLog({source:c||"",columnNumber:r,lineNumber:n,message:i||"",name:o||"",stack:a||"",customStack:s},t,l)),"string"==typeof e&&this.addLog({source:"",columnNumber:0,lineNumber:0,message:e,name:"自定义异常",stack:""},t)}logFillter(t){const r=this.options;if(t["ex.message"]&&t["ex.message"].includes("chrome-extension"))return!0;if(t["ex.stacktrace"]&&t["ex.stacktrace"].includes("chrome-extension"))return!0;if(!t["ex.message"]||"null"===t["ex.message"]||"undefined"===t["ex.message"])return!0;if(r&&r.errFilter){if("function"==typeof r.errFilter)return r.errFilter(t);if(Array.isArray(r.errFilter))for(let e=0;e<r.errFilter.length;e++){var n=r.errFilter[e];if(-1!==t["ex.message"].search(n))return!0}}return!1}interceptApiError(e){let t=["请重试或检查网络状态","Network Error","Request aborted"];const r=e&&e.reason&&e.reason.message;var n;if(r)return(t=this.options&&this.options.interceptApiErr?[...t,...this.options.interceptApiErr]:t).find(e=>r.includes(e))?(n=e.reason.config||{},this.collect.pluginApiErr.addLog({"http.url":n.url,"http.method":n.method,"ex.message":e.reason.message,"ex.type":e.reason.name||e.type||"unhandledrejection"}),!0):void 0}addLog(e,t="error",r){let n={},i={};r&&"object"==typeof r&&"cst_err"==t&&Object.keys(r).forEach((e,t)=>{t<this.exOtherLen&&(n["log."+e]=r[e])});var o=this.formatErrorStack(e),t=Object.assign({t:t,"ex.message":decodeURIComponent(e.message),"ex.stacktrace":o.stack,"ex.type":e.name,"ex.col":e.columnNumber||o.columnNumber,"ex.line":e.lineNumber||o.lineNumber,"ex.file":e.source||o.fileName||"","ex.id":s()},n);this.logFillter(t)||(r&&r.start&&(i.start=r.start),this.collect.pluginBehaviour.report(),this.collect.report(t,i))}}const xt=(e,t=!0)=>{let r=e,n=1;for(;null!==r.previousElementSibling;)t&&r.previousElementSibling.nodeName!==e.nodeName||n++,r=r.previousElementSibling;return n},Et=(e,t)=>{t=""===t?e:t+" > "+e;try{return 1<document.querySelectorAll(t).length}catch(e){}},Tt=(e,t)=>{if(e instanceof HTMLElement){e=(t=>{const r=[];for(;t;){var n=t.nodeName.toLowerCase(),i=t.id?"#"+t.id:"";let e="";t.className&&"string"==typeof t.className&&(e="."+t.className.trim().replace(/\s+/g,".").replace(/[:*+?^${}()|[\]\\]/gi,"\\$&")),r.unshift({element:t,selector:n+i+e}),t=t.parentNode!==document&&t.parentNode}return r})(e);const r=[];return e.forEach(e=>{Et(e.selector,r.join(" > "))&&(e.selector+=`:nth-of-type(${xt(e.element)})`),r.push(e.selector)}),(t&&r.length>t?r.slice(r.length-t):r).join(" > ")}};class Ot{constructor(e,t){this.collect=e,this.options=t,this.onerror()}onerror(){window.addEventListener("error",e=>{this.addResError(e)},!0)}addResError(e,t){var r=e.target;de.includes(r.localName)&&this.addLog(e,{start:t})}getPerformance(e){if(e){e=(t=>{var r=performance.getEntries();for(let e=r.length-1;0<=e;e--){var n=r[e];if(n.name===t)return n}})(e);if(e){e=o(e);const t=Object.assign({"perf.size_level":V(e["perf.size"])},e);return delete t["perf.type"],delete t["perf.name"],t}}}logFillter(e){const t=this.options;return!(!t||!t.errFilter||"function"!=typeof t.errFilter)&&t.errFilter(e)}addLog(e,t){e=e.target;let r={},n=e.src||e.href||"";var i=e.baseURI,i=(n===i&&(n=""),this.getPerformance(n)),o=Tt(e,10)||"",e=(n.startsWith("data:image")&&(n=n.substring(0,50)+"..."),Object.assign({t:"res_err","resource.type":e.localName,"resource.xpath":o,"resource.url":n,"resource.id":s()},i));this.logFillter(e)||(t&&t.start&&(r.start=t.start),this.collect.report(e,r))}}class kt{constructor(e){this.collect=e,"addEventListener"in performance&&performance.addEventListener("resourcetimingbufferfull",()=>{performance.clearResourceTimings()}),new PerformanceObserver(e=>{this.sesourceTiming(e.getEntries())}).observe({entryTypes:["resource"]})}sesourceTiming(e){e.forEach(e=>{const t=o(e);if(de.includes(t["perf.type"])&&t["perf.size"]&&t["perf.duration"]){t["perf.name"].startsWith("data:image")&&(t["perf.name"]=t["perf.name"].substring(0,50)+"...");const r=Object.assign({"resource.type":t["perf.type"],"resource.url":t["perf.name"],"resource.id":s(),"perf.size_level":V(t["perf.size"])},t);delete r["perf.type"],delete r["perf.name"];e=this.collect.isReportInRate();e&&this.addLog(r),!e&&r["perf.ttfb"]>=d.MIN_TTFB_TIME&&this.addLog(r)}})}addLog(e){e=Object.assign({t:"res"},e);this.collect.report(e)}}var M="__xhr_gd_ajax_hook",_=["load","loadend","timeout","error","readystatechange","abort"];function Ct(e,t){var r,n={};for(r in e)n[r]=e[r];return n.target=n.currentTarget=t,n}function It(a,s){return(s=s||window)[M]=s[M]||s.XMLHttpRequest,s.XMLHttpRequest=function(){for(var e,t=new s[M],r=0;r<_.length;++r){var n="on"+_[r];void 0===t[n]&&(t[n]=null)}for(e in t){var i="";try{i=typeof t[e]}catch(e){}"function"===i?this[e]=function(r){return function(){var e=[].slice.call(arguments);if(a[r]){var t=a[r].call(this,e,this.xhr);if(t)return t}return this.xhr[r].apply(this.xhr,e)}}(e):Object.defineProperty(this,e,{get:function(r){return function(){var e=this.hasOwnProperty(r+"_")?this[r+"_"]:this.xhr[r],t=(a[r]||{}).getter;return t&&t(e,this)||e}}(e),set:function(i){return function(t){var r=this.xhr,n=this,e=a[i];if("on"===i.substring(0,2))n[i+"_"]=t,r[i]=function(e){e=Ct(e,n),a[i]&&a[i].call(n,r,e)||t.call(n,e)};else{e=(e||{}).setter;t=e&&e(t,n)||t,this[i+"_"]=t;try{r[i]=t}catch(e){}}}}(e),enumerable:!0})}var o=this;t.getProxy=function(){return o},this.xhr=t},Object.assign(s.XMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),s[M]}const Nt=M+"_QUEUE";function Lt(s){return function(t,e){var r=window[Nt].filter(e=>e[s]);const n=r.length;let i=0;var o=()=>{++i===n&&e.next(t)};if(n)for(let e=0;e<r.length;e++){const a=r[e][s];a(t,{next:o})}else e.next(t)}}void 0===window[Nt]&&(window[Nt]=[]);var Rt=_[0],Pt=_[1],Mt=_[2],_t=_[3],Bt=_[4],Ft=_[5],jt="prototype";function At(e,t){var i,n,o;function r(){return!0}function a(i){return function(e,t){var r,n;return t=t,r=i,n=new Gt(e=e),t={config:e.config,error:t,type:r},o?o(t,n):n.next(t),!0}}function s(e,t){return 4===e.readyState&&0!==e.status?function(e,t){var r=new Ut(e),t={response:t.response||t.responseText,status:t.status,statusText:t.statusText,config:e.config,headers:e.resHeader||e.getAllResponseHeaders().split("\r\n").reduce(function(e,t){if(""===t)return e;t=t.split(":");return e[t.shift()]=t.join(":").replace(/^\s+|\s+$/g,""),e},{})};if(!n)return r.resolve(t);n(t,r)}(e,t):4!==e.readyState&&B(e,Bt),!0}t=t||window,window[Nt].push(e),t[M]||(i=Lt("onRequest"),n=Lt("onResponse"),o=Lt("onError"),It({onload:r,onloadend:r,onerror:a(_t),ontimeout:a(Mt),onabort:a(Ft),onreadystatechange:function(e){return s(e,this)},open:function(e,t){var r=this,n=t.config={headers:{}},e=(n.method=e[0],n.url=e[1],n.async=e[2],n.user=e[3],n.password=e[4],n.xhr=t,"on"+Bt);if(t[e]||(t[e]=function(){return s(t,r)}),i)return!0},send:function(e,t){var r=t.config;if(r.withCredentials=t.withCredentials,r.body=e[0],i)return!(e=function(){i(r,new $t(t))})===r.async?e():setTimeout(e),!0},setRequestHeader:function(e,t){if(t.config.headers[e[0].toLowerCase()]=e[1],i)return!0},addEventListener:function(t,e){var r,n=this;if(-1!==_.indexOf(t[0]))return r=t[1],Dt(e).addEventListener(t[0],function(e){e=Ct(e,n);e.type=t[0],e.isTrusted=!0,r.call(n,e)}),!0},getAllResponseHeaders:function(e,t){var r=t.resHeader;if(r){var n,i="";for(n in r)i+=n+": "+r[n]+"\r\n";return i}},getResponseHeader:function(e,t){t=t.resHeader;if(t)return t[(e[0]||"").toLowerCase()]}},t))}function Dt(e){return e.watcher||(e.watcher=document.createElement("a"))}function B(e,t){var r,n=e.getProxy(),i="on"+t+"_",o=Ct({type:t},n);n[i]&&n[i](o),"function"==typeof Event?r=new Event(t,{bubbles:!1}):(r=document.createEvent("Event")).initEvent(t,!1,!0),Dt(e).dispatchEvent(r)}function Wt(e){this.xhr=e,this.xhrProxy=e.getProxy()}function Ht(e){function t(e){Wt.call(this,e)}return(t[jt]=Object.create(Wt[jt])).next=e,t}Wt[jt]=Object.create({resolve:function(e){var t=this.xhrProxy,r=this.xhr;t.readyState=4,r.resHeader=e.headers,t.response=t.responseText=e.response,t.statusText=e.statusText,t.status=e.status,B(r,Bt),B(r,Rt),B(r,Pt)},reject:function(e){this.xhrProxy.status=0,B(this.xhr,e.type),B(this.xhr,Pt)}});var $t=Ht(function(e){var t,r=this.xhr;for(t in e=e||r.config,r.withCredentials=e.withCredentials,r.open(e.method,e.url,!1!==e.async,e.user,e.password),e.headers)r.setRequestHeader(t,e.headers[t]);r.send(e.body)}),Ut=Ht(function(e){this.resolve(e)}),Gt=Ht(function(e){this.reject(e)});class Vt{constructor(){this.proxyXhr(),this.proxyFetch()}proxyXhr(){At({onRequest:(e,t)=>{t.next(e)},onError:(e,t)=>{t.next(e.error)},onResponse:(e,t)=>{var r=e.headers["x-gd-trace-id"]||e.headers["X-Gd-Trace-Id"];this.success&&this.success({ok:"OK"==e.statusText,redirected:!1,status:e.status,statusText:e.statusText,url:U(e.config.url),method:e.config.method,data:e.response,responeTime:(new Date).getTime(),traceId:r}),t.next(e)}}),Object.assign(XMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4})}proxyFetch(){const a=this,t=window.fetch;window.fetch=function(i,e){const o=e&&e.method||"GET";return new Promise((r,n)=>{t.apply(window,[i,e]).then(e=>{var t=e.headers.get("x-gd-trace-id")||e.headers.get("X-Gd-Trace-Id");a.success&&a.success({ok:"OK"==e.statusText,redirected:!1,status:e.status,statusText:e.statusText,url:U(e.url),data:e.clone(),responeTime:(new Date).getTime(),method:o,traceId:t}),r(e)}).catch(e=>{let t={method:o};"string"==typeof i&&(t.url=i),i instanceof Request&&(t.url=i.url),i instanceof URL&&(t.url=i.href),e.config=t,n(e)})})}}resloveResponseErrorData(t){return gt(this,void 0,void 0,function*(){var e=e=>{if(e.code||e.message||e.msg)return JSON.stringify(e)};if(t instanceof Response)try{return e(yield t.json())}catch(e){}if("string"==typeof t)try{return e(JSON.parse(t))}catch(e){}if("object"==typeof t)return e(t)})}addEventListener(e,t){this[e]=t}}class qt{constructor(e,t){this.collect=e,this.options=t,this.ajaxHook=new Vt,this.ajaxHook.addEventListener("success",r=>gt(this,void 0,void 0,function*(){var i,e=this.collect.isReportInRate(),t=(i=r.url,yield new Promise(n=>{setTimeout(()=>{for(var e=performance.getEntries(),t=e.length-1;0<=t;t--){const r=e[t];if(r.name.endsWith(i))return n(o(r))}n(o())},10)}));(e||!e&&this.isApiErr(r.status)||!e&&t["perf.ttfb"]>=d.MIN_TTFB_TIME)&&this.success(r,t)}))}isApiErr(e){return!e||(400<=Number(e)||0===e||void 0)}success(o,a){return gt(this,void 0,void 0,function*(){var e=(e=>{let r={};const n=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(e);return n&&["url","scheme","slash","host","port","path","query","hash"].forEach(function(e,t){r[e]=n[t]}),r})(o.url),t=o.method||"GET",r=yield this.ajaxHook.resloveResponseErrorData(o.data),n={"http.url":o.url,"http.method":t,"http.status_code":o.status||0,"http.host":e.host,"http.scheme":e.scheme},i=a["perf.duration"]||0,t={duration:i+"",end:1e3*o.responeTime+"",host:"",kind:"client",links:"[]",logs:"[]",name:t+" /"+e.path,parentSpanID:"",resource:"{}",spanID:s(16),start:1e3*(o.responeTime-i)+"",statusCode:this.isApiErr(o.status)?"ERROR":"OK",statusMessage:""+o.statusText+(o.statusText&&r?" : ":"")+(r||""),traceID:o.traceId||s(32)};delete a["perf.duration"],delete a["perf.name"],(400<=o.status||a["perf.ttfb"]>=d.MIN_TTFB_TIME)&&Object.assign(n,Object.assign({},a)),this.addLog(n,t)})}logFillter(t){const r=this.options;if(r&&r.apiFilter){if("function"==typeof r.apiFilter)return r.apiFilter(t);if(Array.isArray(r.apiFilter))for(let e=0;e<r.apiFilter.length;e++){var n=r.apiFilter[e];if(-1!==t["http.url"].search(n))return!0}}return!1}addLog(e,t){e=Object.assign({t:"api"},e);this.logFillter(e)||this.collect.report(e,t)}}class zt{constructor(e,t){this.collect=e,this.options=t}logFillter(e){const t=this.options;return!(!t||!t.apiErrFilter||"function"!=typeof t.apiErrFilter)&&t.apiErrFilter(e)}addLog(e){e=Object.assign({t:"api_err"},e);this.logFillter(e)||this.collect.report(e)}}class Xt{constructor(e){this.collect=e}addLog(r,e){if("object"==typeof r){let t={};Object.keys(r).forEach(e=>{t["log."+e]=r[e]});var n=Object.assign({t:"log"},t);this.collect.report(n,null,e)}}}class Jt{constructor(e){this.logCollectLen=5,this.collect=e,this.logCollect=[],this.onClick()}log(r){if("object"==typeof r){let t={};return Object.keys(r).forEach(e=>{t["log."+e]=r[e]}),Object.assign({t:"log","log.type":"ui.click"},t)}}lazyLog(e){e=this.log(e);this.logCollect.length>=this.logCollectLen&&this.logCollect.shift(),e&&this.logCollect.push({attr:e,start:1e3*(new Date).getTime()})}onClick(){window.addEventListener("click",e=>{var t=Tt(e.target,10),e=((e,t)=>{var r;if(e&&e.outerHTML)return r=e.outerHTML.length,t<r?e.outerHTML.substring(0,t)+"......"+e.outerHTML.substring(r-20,r):e.outerHTML})(e.target,100);this.lazyLog({xpath:t,outerhtml:e})},!0)}report(){for(let e=0;e<this.logCollect.length;e++){var t=this.logCollect[e];this.collect.report(t.attr,{start:t.start})}this.logCollect=[]}}class Kt{constructor(e,t){this.collect=e,this.options=t,this.errorHandler()}vueVersion(e){try{var t=(e.version||"").split(".");if(0<t.length)return Number(t[0])}catch(e){}return 2}formatComponentName(e,t){if(e.$root===e)return"<Root>";var e="function"==typeof e&&null!=e.cid?e.options:e._isVue?e.$options||e.constructor.options:e||{};let r=e.name||e._componentTag;const n=e.__file;return!r&&n&&(e=n.match(/([^/\\]+)\.vue$/),r=e&&e[1]),(r?"<"+r.replace(/(?:^|[-_])(\w)/g,e=>e.toUpperCase()).replace(/[-_]/g,"")+">":"<Anonymous>")+(n&&!1!==t?" at "+n:"")}errorHandler(){const e=this.options.app||window.Vue;if(!e)throw new Error("cannot find Vue instance");const n=e.config.errorHandler;return e.config.errorHandler=(e,t,r)=>{this.addLog(e,t,r),"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e),"function"==typeof n&&n.call(this,e,t,r)},null}logFillter(e){const t=this.options;return!(!t||!t.errFilter||"function"!=typeof t.errFilter)&&t.errFilter(e)}addLog(e,t,r){t=t?this.formatComponentName(t,!0):void 0;e.customStack=[{title:"vue component name",message:t},{title:"vue error info",message:r}],this.logFillter(e)||this.collect.addError(e,"error")}}return new class{constructor(){}init(e){var t;if(this.config=Object.assign((t=e.env,Object.assign(oe[t],{host:"cn-hangzhou.log.aliyuncs.com",time:5,count:10,userId:ie(),deviceId:ie(),topic:"topic",source:"source",tags:{tags:"tags"}})),e),!e.env)throw new Error("Please configure the [env] parameter ");if(!e.service)throw new Error("Please configure the [service] parameter ");e.instance&&(this.config.instance=e.instance,this.config.logstore=e.instance+"-rum-raw"),this.tracker=new H(this.config),this.store=new ue(this.config),this.initPlugins(),this.preErrorReport(),document.dispatchEvent(new Event("gdSlsRumReady",{bubbles:!0}))}initPlugins(){var e;this.pref=new pe(this),this.vitals=new ht(this,this.store),this.pageVisit=new mt(this,this.store),this.pluginBehaviour=new Jt(this),this.pluginJsError=new St(this,null==(e=this.config.pluginConfig)?void 0:e.jsError),this.pluginResourceError=new Ot(this,null==(e=this.config.pluginConfig)?void 0:e.resource),this.pluginResource=new kt(this),this.pluginApi=new qt(this,null==(e=this.config.pluginConfig)?void 0:e.api),this.pluginApiErr=new zt(this,null==(e=this.config.pluginConfig)?void 0:e.apiError),this.pluginLog=new Xt(this)}preErrorReport(){var t=this.config.errors;if(t)for(let e=0;e<t.length;e++){var{error:r,start:n}=t[e];this.pluginJsError.addBrowserError(r,1e3*n),this.pluginResourceError.addResError(r,1e3*n)}this.config.errors=[]}initVuePlugin(e){if(!this.config)throw new Error("Please execute the init() function first");this.pluginVue=new Kt(this,e),this.store.setVueRouter(e&&e.router)}trackPageTarget(e){this.store.dispatch("pageTarget",e)}setOptions(e){if(!this.config)throw new Error("Please execute the init() function first");this.store.setOptions(e)}addPlugin(e,t,r){this[e]=new t(this,r)}addLog(e,t){this.pluginLog.addLog(e,t)}addError(e,t="cst_err"){this.pluginJsError.addCtsError(e,t)}isReportInRate(){return e=this.config.sampleRate,Math.ceil(100*Math.random())<=e;var e}report(e,t,r){e=Object.assign(e,this.store.getData()),e=Object.assign({attribute:JSON.stringify(e),service:this.config.service,start:1e3*(new Date).getTime()},t);null!=r&&r.immediate?this.tracker.sendImmediate(e):this.tracker.send(e)}}});
