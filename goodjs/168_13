define("pkg/@alife/vbar-notification/1.2.13/index",["preact-compat","pkg/@alife/refly-wk-store/0.0.7/index","jquery","pkg/@alife/refly-helpers/0.0.11/index","pkg/@alife/refly-request/0.2.x/index","pkg/@alife/vbar-info-renderer/1.1.x/index","pkg/@alife/csbc-editor-render/0.1.2/bundle","pkg/@alife/refly-tracelog/0.0.12/index"],function(__WEBPACK_EXTERNAL_MODULE_11__,__WEBPACK_EXTERNAL_MODULE_12__,__WEBPACK_EXTERNAL_MODULE_19__,__WEBPACK_EXTERNAL_MODULE_20__,__WEBPACK_EXTERNAL_MODULE_21__,__WEBPACK_EXTERNAL_MODULE_27__,__WEBPACK_EXTERNAL_MODULE_28__,__WEBPACK_EXTERNAL_MODULE_37__){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function checkInSellerIndex(){if(new RegExp("/"+SELLER_PAGE_NAME+"/","i").test(window.location.search))return!0;var el=document.getElementsByClassName("wk_appcode");return!(!el||!el.length||el[0].value!=SELLER_PAGE_NAME)}function checkUnReadMsg(cb){if(cb){var requestParams={msgType:"",status:"",isRead:!1,isShowUnReadCount:!0,current:1,pageSize:1};(0,_api.newGetMessageList)(function(){var res=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_res$unReadCount=res.unReadCount,unReadCount=void 0===_res$unReadCount?0:_res$unReadCount;unReadCount>0&&cb()})(requestParams,{nocache:!0})}}var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_reflyWkStore=__webpack_require__(12),_reflyWkStore2=_interopRequireDefault(_reflyWkStore),_package=__webpack_require__(13),_package2=_interopRequireDefault(_package),_container=__webpack_require__(14),_container2=_interopRequireDefault(_container),_api=__webpack_require__(17);__webpack_require__(38);var vbarInfoRendererVersion="1.1.x",SELLER_PAGE_NAME="sellberBaseNew_Index";module.exports={title:"\u6d88\u606f",icon:{normal:"url(//img.alicdn.com/tfs/TB1DedgiLDH8KJjy1XcXXcpdXXa-14-18.png) center no-repeat",hover:"url(//img.alicdn.com/tfs/TB1H98tiH_I8KJjy1XaXXbsxpXa-14-18.png) center no-repeat"},resource:{css:["//astyle.alicdn.com/pkg/"+_package2["default"].name+"/"+_package2["default"].version+"/index.css","//astyle.alicdn.com/pkg/@alife/vbar-info-renderer/"+vbarInfoRendererVersion+"/index.css"]},login:!0,panel:{name:"panel-notification",title:"\u91cd\u8981\u6d88\u606f",showHeader:!0,render:function(state,props){return _preactCompat2["default"].createElement(_container2["default"],props)}},bindEvent:function(){var _this=this;this.bindDefaultEvents();var _ref=this.element.props||{},open=_ref.open;"true"!=open&&open!==!0||!checkInSellerIndex()||checkUnReadMsg(function(){_this.showPanel()}),_reflyWkStore2["default"].$watch("vbarNotificationUpdateMessage",function(oldValue){var newValue=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},msgType=newValue.msgType,data=newValue.data;_this.updateMessage(msgType,data)})}}},,,,,,,,,,,function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_11__},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_12__},function(module,exports){module.exports={name:"@alife/vbar-notification",version:"1.2.13",description:"The notification module for 1688 tool bar.",main:"index.js",repository:{type:"git",url:"git@gitlab.alibaba-inc.com:vbar/vbar-notification.git"},keywords:["lofty","package","vbar"],scripts:{dev:"./node_modules/.bin/webpack --watch",build:"./build","build-debug":"./node_modules/.bin/webpack"},dependencies:{"@alife/alpha-jquery":"^1.0.12","@alife/refly-helpers":"^0.0.11","@alife/refly-request":"^0.2.3","@alife/refly-tracelog":"^0.0.12","@alife/refly-wk-store":"^0.0.7","@alife/vbar-info-renderer":"^1.0.0","babel-polyfill":"^6.26.0",classnames:"^2.2.5"},publishConfig:{registry:"http://registry.npm.alibaba-inc.com"},devDependencies:{"babel-core":"^6.18.0","babel-loader":"^6.2.5","babel-plugin-transform-object-assign":"^6.22.0","babel-plugin-transform-runtime":"^6.23.0","babel-preset-es2015":"^6.18.0","babel-preset-react":"^6.16.0","babel-preset-stage-0":"^6.0.15","babel-register":"^6.18.0","css-loader":"^0.26.1","es3ify-loader":"^0.2.0","extract-text-webpack-plugin":"^1.0.1","json-loader":"^0.5.7",less:"^2.7.1","less-loader":"^2.2.3","style-loader":"^0.13.1","unicode-loader":"^1.0.6",webpack:"1.13.2","webpack-dev-server":"^1.16.2"},apm:{build:!1,npmPublishType:"source",publishFolder:"dist"}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_constants=__webpack_require__(15),_utils=__webpack_require__(16),_api=__webpack_require__(17),_utils2=__webpack_require__(18),_alert=__webpack_require__(22),_alert2=_interopRequireDefault(_alert),_app=__webpack_require__(23),_app2=_interopRequireDefault(_app),$=__webpack_require__(19),TraceLog=__webpack_require__(37),logError=(0,_utils2.hell)("@alife/vbar-notification Error:\n"),traceLog=null,initialDataSource={latest:[],past:[]},msgCache={},defaultState={errorMsg:"",hasMore:!0,isLoading:!1,actions:[],tabs:[{key:"",name:"\u5168\u90e8"}],filters:{status:_constants.statusFilters},dataSource:initialDataSource,unReadCount:0,queryFilter:{msgType:"",status:""},paging:{current:0,pageSize:10},qrCodeOpitons:{enable:!1,src:""}},formatStatusFilters=function(unReadCount){return{status:(0,_constants.newStatusFilters)(_constants.statusUnreadKey,{name:"\u672a\u8bfb("+(unReadCount>0?unReadCount:0)+")"})}},Container=function(_Component){function Container(props){_classCallCheck(this,Container);var _this=_possibleConstructorReturn(this,_Component.call(this,props));return _this.state=defaultState,_this.state.activeType=(0,_utils2.parseId)(props.vbar_activeType),_this.state.currentMsgId=(0,_utils2.parseId)(props.vbar_activeTaskId),_this.onShowPanel=_this.onShowPanel.bind(_this),_this.onPanelAction=_this.onPanelAction.bind(_this),_this.getResources=_this.getResources.bind(_this),_this.renderQrCodeData=_this.renderQrCodeData.bind(_this),_this.resetVbarOpenEvent=_this.resetVbarOpenEvent.bind(_this),_this.onMsgCacheAdd=_this.onMsgCacheAdd.bind(_this),_this.getMsgCacheById=_this.getMsgCacheById.bind(_this),_this}return _inherits(Container,_Component),Container.prototype.componentDidMount=function(){traceLog||new TraceLog(".vbar-notification.container",{noClick:!0,noExposure:!1}),this.renderQrCodeData()},Container.prototype.componentWillReceiveProps=function(nextProps){var activeType=(0,_utils2.parseId)(nextProps.vbar_activeType),pre_activeType=this.state.activeType,currentMsgId=(0,_utils2.parseId)(nextProps.vbar_activeTaskId),pre_currentMsgId=this.state.currentMsgId;activeType===pre_activeType&&currentMsgId===pre_currentMsgId||this.setState({activeType:activeType,currentMsgId:currentMsgId})},Container.prototype.resetVbarOpenEvent=function(){this.setState({activeType:void 0,currentMsgId:void 0})},Container.prototype.onMsgCacheAdd=function(item){var msgId=item.msgId;msgCache&&!msgCache[msgId]&&(msgCache[msgId]=item)},Container.prototype.getMsgCacheById=function(msgId){return msgCache[msgId]},Container.prototype.renderQrCodeData=function(){var _this2=this;(0,_api.getQrCodeData)(function(res){return res&&res.content?void _this2.setState({qrCodeOpitons:res.content}):0})},Container.prototype.onShowPanel=function(){var item=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getPanelActions(item),this.markMessage(item)},Container.prototype.onPanelAction=function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_params$action=params.action,action=void 0===_params$action?{}:_params$action,_params$data=params.data,data=void 0===_params$data?{}:_params$data,key=action.key,noticeDefinitionId=data.noticeDefinitionId;"add"===key&&this.saveMsg2Task({actionKey:key,id:noticeDefinitionId})},Container.prototype.triggerAlert=function(){var _this3=this,errorMsg=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5";this.setState({errorMsg:errorMsg},function(){setTimeout(function(){_this3.setState({errorMsg:""})},1500)})},Container.prototype.saveMsg2Task=function(){var _this4=this,params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},id=params.id,actionKey=params.actionKey,saveTask=(0,_api.newSaveTask)(function(){_this4.setState(function(preState){var actions=preState.actions.map(function(item){var itemKey=item.key;return itemKey===actionKey?$.extend({},item,_constants.actionsCompletedMap[itemKey]):item});return{actions:actions}})},function(err){_this4.triggerAlert(),logError("saveTask error:",err)});saveTask(id)},Container.prototype.markMessage=function(item){var _this5=this,msgId=item.msgId,isRead=item.isRead,isOpen=item.isOpen;if(!isRead||!isOpen){var updateMsgById=(0,_api.newUpdateMessageById)(function(){setTimeout(function(){_this5.setState(function(preState){var dataSource=preState.dataSource,unReadCount=preState.unReadCount,filters=formatStatusFilters(unReadCount-1);return{dataSource:(0,_utils.mergeMsgDataSource)(dataSource,msgId,{isRead:!0,isOpen:!0}),filters:filters}}),(0,_utils.updateAliToolBarMsg)(10,{countFactor:-1}),msgCache[msgId]&&(msgCache[msgId].isRead=!0,msgCache[msgId].isOpen=!0)},1e3)},function(err){logError("markMessage error:",err)});updateMsgById({msgId:msgId,markRead:!0,markOpen:!0})}},Container.prototype.getPanelActions=function(item){var _this6=this,noticeDefinitionId=item.noticeDefinitionId,hasActions=item.hasActions;if(this.setState({actions:[]}),hasActions){var isTaskExist=(0,_api.newIsTaskExist)(function(res){var exist=res.exist,actions=exist?[_constants.actionsCompletedMap.add]:_constants.panelActions;_this6.setState({actions:actions})},function(err){logError("isTaskExist error:",err)});isTaskExist(noticeDefinitionId)}},Container.prototype.getResources=function(){var _this7=this,params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.state.isLoading){var _params$queryFilter=params.queryFilter,queryFilter=void 0===_params$queryFilter?{}:_params$queryFilter,paging=params.paging,status=queryFilter.status,isFirstPage=1===paging.current,isRead=status!==_constants.statusUnreadKey&&void 0;this.setState(function(_ref){var dataSource=_ref.dataSource;return{isLoading:!0,dataSource:isFirstPage?initialDataSource:dataSource}});var getMsgList=(0,_api.newGetMessageList)(function(res){var count=res.count,unReadCount=res.unReadCount,totalPages=res.totalPages,_res$dataSource=res.dataSource,latest=_res$dataSource.latest,past=_res$dataSource.past,tabs=res.tabs,filters=formatStatusFilters(unReadCount),newTabs=defaultState.tabs.concat(tabs),hasMore=paging.current<totalPages;_this7.setState(function(preState){var preQueryFilter=preState.queryFilter,prePaging=preState.paging,preDataSource=preState.dataSource,finalLatest=isFirstPage?latest:(0,_utils.concatList)(preDataSource.latest,latest),finalPast=isFirstPage?past:(0,_utils.concatList)(preDataSource.past,past);return{dataSource:{latest:finalLatest,past:finalPast},count:count,unReadCount:unReadCount,tabs:newTabs,filters:filters,hasMore:hasMore,isLoading:!1,queryFilter:$.extend({},preQueryFilter,queryFilter),paging:$.extend({},prePaging,paging)}})},function(err){logError("getMsgList error:",err),_this7.setState({isLoading:!1})});getMsgList(_extends({},queryFilter,paging,{isRead:isRead}))}},Container.prototype.render=function(){var _state=this.state,errorMsg=_state.errorMsg,tabs=_state.tabs,actions=_state.actions,filters=_state.filters,dataSource=_state.dataSource,hasMore=_state.hasMore,isLoading=_state.isLoading,queryFilter=_state.queryFilter,paging=_state.paging,qrCodeOpitons=_state.qrCodeOpitons;return _preactCompat2["default"].createElement("div",{className:"vbar-notification container"},errorMsg&&_preactCompat2["default"].createElement(_alert2["default"],{content:errorMsg}),_preactCompat2["default"].createElement(_app2["default"],{tabs:tabs,actions:actions,filters:filters,dataSource:dataSource,qrCodeOpitons:qrCodeOpitons,hasMore:hasMore,isLoading:isLoading,queryFilter:queryFilter,paging:paging,getResources:this.getResources,onShowPanel:this.onShowPanel,onPanelAction:this.onPanelAction,activeType:this.state.activeType,currentMsgId:this.state.currentMsgId,resetVbarOpenEvent:this.resetVbarOpenEvent,onMsgCacheAdd:this.onMsgCacheAdd,getMsgCacheById:this.getMsgCacheById}))},Container}(_preactCompat.Component);exports["default"]=Container},function(module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},actionsCompletedMap={add:{key:"add",disabled:!0,name:"\u5df2\u52a0\u5165\u5230\u5de5\u4f5c\u6e05\u5355"}},panelActions=[{key:"add",name:"\u52a0\u5165\u5de5\u4f5c\u6e05\u5355"}],statusUnreadKey="unread",statusFilters=[{key:"",name:"\u6240\u6709"},{key:statusUnreadKey,name:"\u672a\u8bfb"}],newStatusFilters=function(key,newItem){return statusFilters.map(function(item){return item.key===key?_extends({},item,newItem):item})};exports.actionsCompletedMap=actionsCompletedMap,exports.panelActions=panelActions,exports.statusUnreadKey=statusUnreadKey,exports.statusFilters=statusFilters,exports.newStatusFilters=newStatusFilters},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports.__esModule=!0,exports.concatList=exports.updateAliToolBarMsg=exports.mergeMsgDataSource=void 0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_reflyWkStore=__webpack_require__(12),_reflyWkStore2=_interopRequireDefault(_reflyWkStore),mergeMsgItems=function(){var items=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],ids=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],newValue=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return items.map(function(item){var msgId=item.msgId;return ids.indexOf(msgId)===-1?item:_extends({},item,newValue)})},mergeMsgDataSource=function(_ref,msgId){var latest=_ref.latest,past=_ref.past,newValue=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{latest:mergeMsgItems(latest,[].concat(msgId),newValue),past:mergeMsgItems(past,[].concat(msgId),newValue)}},updateAliToolBarMsg=function(msgType,data){_reflyWkStore2["default"].$set("updateMessage",{msgType:msgType,data:data})},concatList=function(){var preItems=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],nextItems=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return nextItems&&nextItems.length?preItems.concat(nextItems):preItems};exports.mergeMsgDataSource=mergeMsgDataSource,exports.updateAliToolBarMsg=updateAliToolBarMsg,exports.concatList=concatList},function(module,exports,__webpack_require__){"use strict";function newGetMessageList(onSuccess,onFail){return function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},request=(0,_utils.reinforceRequest)(getMessageListInstance,normalizeMsgListResponse)(onSuccess,onFail),msgType=params.msgType,isRead=params.isRead,current=params.current,pageSize=params.pageSize,reqParams={channelCode:12,mark:"xiaoer",isShowUnReadCount:!0,page:current,size:pageSize};return msgType&&(reqParams.typeId=msgType),(0,_utils.isUndefinedOrNull)(isRead)||(reqParams.isRead=isRead),request(reqParams,options)}}function newUpdateMessageById(onSuccess,onFail){return function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},request=(0,_utils.reinforceRequest)(updateMessageByIdInstance)(onSuccess,onFail),msgId=params.msgId,markRead=params.markRead,markOpen=params.markOpen,reqParams={bizCode:12,msgId:[].concat(msgId).join(",")};return(0,_utils.isUndefinedOrNull)(markRead)||(reqParams.markRead=markRead),(0,_utils.isUndefinedOrNull)(markOpen)||(reqParams.markOpen=markOpen),request(reqParams,MBOX_OPTIONS)}}function newSaveTask(onSuccess,onFail){return function(id){var wrappedRequest=(0,_utils.reinforceRequest)(createTaskInstance)(function(res){return res.success?void onSuccess(res):void onFail(res)},onFail);return wrappedRequest({noticeDefinitionId:id},MBOX_OPTIONS)}}function newIsTaskExist(onSuccess,onFail){return function(id){return(0,_utils.reinforceRequest)(isTaskExistInstance)(onSuccess,onFail)({key:id},MBOX_OPTIONS)}}function requestMessage(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return getMessageByIdInstance.jsonp(params,{nocache:!0})}function getMessageById(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{msgId:-1,channelCode:12},callback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return callback?void requestMessage(params).done(function(result){if(!result||result.hasError||!result.content||!result.content.content)return callback(null);var targetMsg=result.content.content,formatMsg=normalizeMsgResponse(targetMsg);return callback(formatMsg||null)}):0}exports.__esModule=!0,exports.getQrCodeData=void 0,exports.newGetMessageList=newGetMessageList,exports.newUpdateMessageById=newUpdateMessageById,exports.newSaveTask=newSaveTask,exports.newIsTaskExist=newIsTaskExist,exports.getMessageById=getMessageById;var _utils=__webpack_require__(18),Helpers=(__webpack_require__(19),__webpack_require__(20)),newRequest=__webpack_require__(21),MBOX_OPTIONS={urlTpl:"//widget.1688.com/front/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",csrfUrlTpl:"//widget.1688.com/front/ajax/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",dataType:"jsonp",transType:"jsonp",bridgeUrl:"//widget.1688.com/front/ajax/bridge.html?target={target}"},logError=(0,_utils.hell)("@alife/vbar-notification Error:\n"),msgServer=Helpers.getUrl("messageServer"),MESSAGE_LIST_URL=msgServer+"/msg/ajax/getDetailListByBiz.jsonp",MESSAGE_BY_ID_URL=msgServer+"/msg/ajax/getMsgById.jsonp",getMessageListInstance=newRequest(MESSAGE_LIST_URL),updateMessageByIdInstance=newRequest("mbox://msgCenterUpdateMsgById/execute"),getMessageByIdInstance=newRequest(MESSAGE_BY_ID_URL),createTaskInstance=newRequest("mbox://taskCreateService/execute"),isTaskExistInstance=newRequest("mbox://taskExistService/execute"),paddingTwoNumber=function(num){return num<10?"0"+num:num},formatTime=function(time){var tempTime=new Date;if(time.toLocaleDateString()===tempTime.toLocaleDateString())return paddingTwoNumber(time.getHours())+":"+paddingTwoNumber(time.getMinutes());if(tempTime.setDate(tempTime.getDate()-1),time.toLocaleDateString()===tempTime.toLocaleDateString())return"\u6628\u5929";var month=paddingTwoNumber(time.getMonth()+1),date=paddingTwoNumber(time.getDate());return time.getFullYear()===tempTime.getFullYear()?month+"\u6708"+date+"\u65e5":time.getFullYear()+"/"+month+"/"+date},normalizeMsgListResponse=function(){var res=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_res$content=res.content,content=void 0===_res$content?{}:_res$content,count=content.count,unReadCount=content.unReadCount,totalPages=content.totalPages,msgDetailList=content.msgDetailList,typeJson=content.typeJson,tabsHasActions=[],tabs=(typeJson||[]).map(function(_ref){var id=_ref.id,typeName=_ref.typeName,isConvert=_ref.isConvert;return isConvert&&tabsHasActions.push(id),{key:id,name:typeName}}),latestItems=[],pastItems=[],items=msgDetailList||[];return items.forEach(function(item){var id=item.id,typeId=item.typeId,createTimeLong=item.createTime,openStatus=item.openStatus,readStatus=item.readStatus,taskId=item.taskId,body=item.body,finalItem=void 0;try{finalItem=JSON.parse(body)}catch(err){logError("message item parse Error:",err,"\nmsg body:",body)}if(finalItem){var createTime=new Date(createTimeLong);finalItem.time=formatTime(createTime),finalItem.msgId=id,finalItem.isOpen=!!openStatus,finalItem.isRead=!!readStatus,finalItem.taskId=taskId,tabsHasActions.indexOf(typeId)!==-1&&(finalItem.hasActions=!0);var latestDeadline=new Date;latestDeadline.setDate(latestDeadline.getDate()-3),createTime>latestDeadline?latestItems.push(finalItem):pastItems.push(finalItem)}}),{count:count,unReadCount:unReadCount>0?unReadCount:0,totalPages:totalPages,dataSource:{latest:latestItems,past:pastItems},tabs:tabs}},normalizeMsgResponse=(exports.getQrCodeData=function(callback){newRequest("jdata://481910").jsonp({}).done(function(res){return res&&res.content?void(callback&&callback(res)):0})},function(msgRes){try{var finalItem=JSON.parse(msgRes.body);return finalItem.time=formatTime(new Date(msgRes.createTime)),finalItem.msgId=msgRes.id,finalItem.taskId=msgRes.taskId,finalItem.isOpen=!!msgRes.openStatus,finalItem.isRead=!!msgRes.readStatus,finalItem.hasActions=!0,finalItem}catch(err){return 0}})},function(module,exports,__webpack_require__){"use strict";function noop(){}function isAliDomain(domain,extraDomains){var domainArr=["tmall.com","tmall.hk","taobao.com","taobaocdn.com","tbcdn.cn","1688.com","alibaba.com","aliyun.com","alipay.com","alisoft.com","alimama.com","hitao.com","aliexpress.com","laiwang.com","etao.com","kissyui.com","95095.com","taohua.com","tmall.net","tmall.com.hk","taobao.net","taobao.org","alibaba-inc.com","1688.net","alibaba.net","aliyun.net","alipay.net","alisoft.net","alimama.net","hitao.net","aliexpress.net","laiwang.net","etao.net","alicdn.com","aliimg.com"];"undefined"!=typeof extraDomains&&(domainArr=domainArr.concat(extraDomains));var safeDomainReg=new RegExp("^http(s)?:\\/\\/[a-z0-9-\\.]*("+domainArr.join("|")+")","i");domain+="";var result=domain.match(safeDomainReg);return!!result}function isAliTestDomain(_path){if(_path||(_path=document.location.href),isAliDomain(_path))return/-test\./.test(_path)}function parseURL(url){var a=document.createElement("a");return a.href=url||window.location.href,{source:url,protocol:a.protocol,host:a.hostname,port:a.port,query:a.search,params:function(){try{for(var s,ret={},seg=a.search.replace(/^\?/,"").split("&"),len=seg.length,i=0;i<len;i++)seg[i]&&(s=seg[i].split("="),ret[s[0]]=decodeURIComponent(s[1]));return ret}catch(err){return{}}}(),file:(a.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:a.hash.replace("#",""),path:a.pathname.replace(/^([^\/])/,"/$1"),relative:(a.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:a.pathname.replace(/^\//,"").split("/")}}function getQuery(key){var query=parseURL().params;return key?query[key]:query}function getTraceClick(key,params){var exParams={};if(params)for(var k in params)exParams["data-trace-click-param-"+k.replace(/([A-Z])/g,"-$1").toLocaleLowerCase().replace(/^-/,"")]=params[k];return _extends({"data-trace-click":"clk-"+key,"data-trace-click-url":TRACELOG_URL},exParams)}function getTraceExposure(key,params){var exParams={};if(params)for(var k in params)exParams["data-trace-exposure-param-"+k.replace(/([A-Z])/g,"-$1").toLocaleLowerCase().replace(/^-/,"")]=params[k];return _extends({"data-trace-exposure":"exp-"+key,"data-trace-exposure-url":TRACELOG_URL},exParams)}function spreadRequest(requestInstance){var onSuccess=arguments.length>1&&void 0!==arguments[1]?arguments[1]:noop,onFail=arguments.length>2&&void 0!==arguments[2]?arguments[2]:noop;return function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};requestInstance.jsonp(params,_extends({csrfToken:!0},options)).done(function(){var res=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},flag=arguments[1],content=res.content;onSuccess(_extends({},content,{$$flag:flag}))}).fail(function(err){onFail(err)})}}function reinforceRequest(requestInstance,onHandleResponse){return function(){var onSuccess=arguments.length>0&&void 0!==arguments[0]?arguments[0]:noop,onFail=arguments.length>1&&void 0!==arguments[1]?arguments[1]:noop;return spreadRequest(requestInstance,function(res){var finalRes=res;"function"==typeof onHandleResponse&&(finalRes=onHandleResponse(finalRes)),onSuccess(finalRes)},onFail)}}function lenB(obj){return String(obj).replace(/[^\x00-\xff]/g,"**").length}exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},TRACELOG_URL=(__webpack_require__(19),"1688toolbar.tracelog.notification"),DEFAULT_AVATAR="//img.alicdn.com/tfs/TB1e.odklDH8KJjSspnXXbNAVXa-110-110.png",globalLocation=window.location,globalConsole=window.console,isUndefinedOrNull=function(obj){return void 0===obj||null===obj},isDebugMode=function(){return globalLocation.href.indexOf("_debugMode_")!==-1},hell=function(prefix){return function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];if(isDebugMode()){var log=globalConsole&&(globalConsole.error||globalConsole.log);log&&log.apply(void 0,[prefix].concat(args))}}},parseId=function(attr){return attr&&parseInt(attr)||void 0};exports.TRACELOG_URL=TRACELOG_URL,exports.DEFAULT_AVATAR=DEFAULT_AVATAR,exports.noop=noop,exports.isAliDomain=isAliDomain,exports.isAliTestDomain=isAliTestDomain,exports.getQuery=getQuery,exports.parseURL=parseURL,exports.getTraceClick=getTraceClick,exports.getTraceExposure=getTraceExposure,exports.lenB=lenB,exports.isUndefinedOrNull=isUndefinedOrNull,exports.reinforceRequest=reinforceRequest,exports.isDebugMode=isDebugMode,exports.hell=hell,exports.parseId=parseId},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_19__},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_20__},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_21__},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),Alert=function(_ref){var content=_ref.content;return _preactCompat2["default"].createElement("div",{className:"alert"},_preactCompat2["default"].createElement("p",{className:"alert__content"},_preactCompat2["default"].createElement("i",{className:"alert__icon"}),content))};Alert.defaultProps={content:""},exports["default"]=Alert},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_utils=__webpack_require__(18),_detailPanel=__webpack_require__(24),_detailPanel2=_interopRequireDefault(_detailPanel),_messageScrollList=__webpack_require__(31),_messageScrollList2=_interopRequireDefault(_messageScrollList),_statusFilters=__webpack_require__(35),_statusFilters2=_interopRequireDefault(_statusFilters),_tabs=__webpack_require__(36),_tabs2=_interopRequireDefault(_tabs),_api=__webpack_require__(17),$=__webpack_require__(19),App=function(_Component){function App(props){_classCallCheck(this,App);var _this=_possibleConstructorReturn(this,_Component.call(this,props));return _this.state={showPanel:!1,panelDataSource:{},statusActiveKey:""},_this.onTabChange=_this.onTabChange.bind(_this),_this.onStatusFitlersChange=_this.onStatusFitlersChange.bind(_this),_this.onListScroll=_this.onListScroll.bind(_this),_this.onClickPanelAction=_this.onClickPanelAction.bind(_this),_this.onClosePanel=_this.onClosePanel.bind(_this),_this.onClickItem=_this.onClickItem.bind(_this),_this}return _inherits(App,_Component),App.prototype.componentDidMount=function(){this.getList({queryFilter:{msgType:this.props.activeType||"",status:""},paging:{current:1}}),this.props.currentMsgId&&this.showActiveMessageById(this.props.currentMsgId)},App.prototype.componentWillReceiveProps=function(nextProps){var nextMsg=nextProps.currentMsgId,currentMsg=this.props.currentMsgId;nextMsg&&nextMsg!==currentMsg&&this.showActiveMessageById(nextProps.currentMsgId)},App.prototype.showActiveMessageById=function(msgId){var _this2=this,props=this.props,_message=props.getMsgCacheById&&props.getMsgCacheById(msgId);_message?this.onClickItem(_message):(0,_api.getMessageById)({msgId:msgId,channelCode:12},function(result){result&&(props.onMsgCacheAdd&&props.onMsgCacheAdd(result),_this2.onClickItem(result))})},App.prototype.getList=function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},nextQueryFilter=params.queryFilter,nextPaging=params.paging,_props=this.props,queryFilter=_props.queryFilter,paging=_props.paging,getResources=_props.getResources,finalQueryFilter=$.extend({},queryFilter,nextQueryFilter),finalPaging=$.extend({},paging,{current:paging.current+1},nextPaging);getResources({queryFilter:finalQueryFilter,paging:finalPaging})},App.prototype.onTabChange=function(){var item=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},noClosePanel=arguments[1],key=item.key;this.getList({queryFilter:{msgType:key,status:""},paging:{current:1}}),noClosePanel?this.setState({statusActiveKey:""}):this.setState({showPanel:!1,panelDataSource:{},statusActiveKey:""}),this.props.activeType&&this.props.resetVbarOpenEvent()},App.prototype.onStatusFitlersChange=function(){var item=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},key=item.key;this.getList({queryFilter:{status:key},paging:{current:1}}),this.setState({statusActiveKey:key})},App.prototype.onListScroll=function(){this.getList()},App.prototype.onClickPanelAction=function(actionItem){var _this3=this;return function(){var panelDataSource=_this3.state.panelDataSource;
_this3.props.onPanelAction({action:actionItem,data:panelDataSource})}},App.prototype.onClosePanel=function(){var _this4=this;setTimeout(function(){_this4.setState({showPanel:!1}),_this4.props.currentMsgId&&_this4.props.resetVbarOpenEvent()},100)},App.prototype.onClickItem=function(data){this.setState({showPanel:!0,panelDataSource:data}),this.props.onShowPanel(data),this.props.currentMsgId&&this.props.resetVbarOpenEvent()},App.prototype.render=function(){var _state=this.state,showPanel=_state.showPanel,panelDataSource=_state.panelDataSource,statusActiveKey=_state.statusActiveKey,_props2=this.props,tabs=_props2.tabs,_props2$filters=_props2.filters,filters=void 0===_props2$filters?{}:_props2$filters,actions=_props2.actions,hasMore=_props2.hasMore,isLoading=_props2.isLoading,dataSource=_props2.dataSource,qrCodeOpitons=_props2.qrCodeOpitons,status=filters.status;return _preactCompat2["default"].createElement("div",{className:"app"},_preactCompat2["default"].createElement(_tabs2["default"],{className:"app__tabs",defaultActiveKey:this.props.activeType||void 0,activeTab:this.props.activeType,dataSource:tabs,onChange:this.onTabChange}),status&&!!status.length&&_preactCompat2["default"].createElement(_statusFilters2["default"],{className:"app__filters",defaultActiveKey:statusActiveKey,activeKey:statusActiveKey,dataSource:status,onChange:this.onStatusFitlersChange}),_preactCompat2["default"].createElement(_messageScrollList2["default"],{className:"app__list",hasMore:hasMore,isLoading:isLoading,dataSource:dataSource,onScroll:this.onListScroll,onClickItem:this.onClickItem}),_preactCompat2["default"].createElement(_detailPanel2["default"],{className:"app__panel",visible:showPanel,actions:actions,dataSource:panelDataSource,qrCodeOpitons:qrCodeOpitons,onClickAction:this.onClickPanelAction,onClose:this.onClosePanel}))},App}(_preactCompat.Component);App.defaultProps={tabs:[],actions:[],filters:{status:[]},dataSource:{latest:[],past:[]},hasMore:!0,isLoading:!1,queryFilter:{},paging:{current:0,pageSize:15},getResources:_utils.noop,onShowPanel:_utils.noop,onPanelAction:_utils.noop},exports["default"]=App},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_classnames=__webpack_require__(25),_classnames2=_interopRequireDefault(_classnames),_utils=__webpack_require__(18),_detailRenderer=__webpack_require__(26),_detailRenderer2=_interopRequireDefault(_detailRenderer),_panel=__webpack_require__(30),_panel2=_interopRequireDefault(_panel),DetailPanel=function(_Component){function DetailPanel(){return _classCallCheck(this,DetailPanel),_possibleConstructorReturn(this,_Component.apply(this,arguments))}return _inherits(DetailPanel,_Component),DetailPanel.prototype.renderFooter=function(){var _props=this.props,actions=_props.actions,onClickAction=_props.onClickAction;return _preactCompat2["default"].createElement("div",{className:"detail-panel__footer"},actions.map(function(item){var key=item.key,name=item.name,disabled=item.disabled,clazz=(0,_classnames2["default"])("detail-panel__action",{"detail-panel__action--disabled":disabled});return _preactCompat2["default"].createElement("a",{key:key,className:clazz,onClick:onClickAction(item)},name)}))},DetailPanel.prototype.render=function(){var _classNames,_props2=this.props,className=_props2.className,visible=_props2.visible,dataSource=_props2.dataSource,onClose=_props2.onClose,qrCodeOpitons=_props2.qrCodeOpitons;if(!visible)return null;var clazz=(0,_classnames2["default"])("detail-panel",(_classNames={},_classNames[className]=!!className,_classNames));return _preactCompat2["default"].createElement(_panel2["default"],{className:clazz,footer:this.renderFooter(),onClose:onClose},_preactCompat2["default"].createElement(_detailRenderer2["default"],{dataSource:dataSource,qrCodeOpitons:qrCodeOpitons}))},DetailPanel}(_preactCompat.Component);DetailPanel.defaultProps={className:"",visible:!1,actions:[],dataSource:{latest:[],past:[]},onClickAction:_utils.noop,onClose:_utils.noop},exports["default"]=DetailPanel},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;/*!
	  Copyright (c) 2016 Jed Watson.
	  Licensed under the MIT License (MIT), see
	  http://jedwatson.github.io/classnames
	*/
!function(){"use strict";function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg))classes.push(classNames.apply(null,arg));else if("object"===argType)for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key)}}return classes.join(" ")}var hasOwn={}.hasOwnProperty;"undefined"!=typeof module&&module.exports?module.exports=classNames:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_vbarInfoRenderer=__webpack_require__(27),_vbarInfoRenderer2=_interopRequireDefault(_vbarInfoRenderer),_csbcEditorRender=__webpack_require__(28),_csbcEditorRender2=_interopRequireDefault(_csbcEditorRender),_utils=__webpack_require__(18),_detailQrcode=__webpack_require__(29),_detailQrcode2=_interopRequireDefault(_detailQrcode),traceCfg={clickLogKey:_utils.TRACELOG_URL,exposureLogKey:_utils.TRACELOG_URL},renderBodyStyle={position:"relative",minHeight:"100%"},DetailRenderer=function(_Component){function DetailRenderer(props){_classCallCheck(this,DetailRenderer);var _this=_possibleConstructorReturn(this,_Component.call(this,props)),_props$dataSource=props.dataSource,dataSource=void 0===_props$dataSource?{}:_props$dataSource;return _this.state={avatar:dataSource.senderTouxiang},_this.onAvatarError=_this.onAvatarError.bind(_this),_this}return _inherits(DetailRenderer,_Component),DetailRenderer.prototype.componentWillReceiveProps=function(nextProps){var _nextProps$dataSource=nextProps.dataSource,dataSource=void 0===_nextProps$dataSource?{}:_nextProps$dataSource;this.setState({avatar:dataSource.senderTouxiang})},DetailRenderer.prototype.onAvatarError=function(){this.setState({avatar:_utils.DEFAULT_AVATAR})},DetailRenderer.prototype.render=function(){var avatar=this.state.avatar,_props=this.props,_props$dataSource2=_props.dataSource,dataSource=void 0===_props$dataSource2?{}:_props$dataSource2,qrCodeOpitons=_props.qrCodeOpitons,traceId=dataSource.traceId,senderName=dataSource.senderName,biz=dataSource.biz,type=dataSource.type,time=dataSource.time,title=dataSource.title,content=dataSource.content,contentPic=dataSource.contentPic,pccontentUrl=dataSource.pccontentUrl,contentUrlHover=dataSource.contentUrlHover,taskId=dataSource.taskId,feedId=dataSource.feedId,noticeDefinitionId=dataSource.noticeDefinitionId,isNewContent=!!feedId,remark=[_preactCompat2["default"].createElement("span",{key:"date",className:"text date"},time)];biz&&remark.push(_preactCompat2["default"].createElement("span",{key:"biz",className:"text"},biz)),type&&(biz&&remark.push(_preactCompat2["default"].createElement("span",{key:"split",className:"split"},"|")),remark.push(_preactCompat2["default"].createElement("span",{key:"type",className:"text"},type)));var infoRendererDataSource={id:traceId,title:title,description:content,banner:{imgUrl:contentPic,redirectUrl:pccontentUrl,title:contentUrlHover}},newContentDataSource={contentId:feedId,msgId:noticeDefinitionId},newContentTracelog={logKey:traceCfg.clickLogKey,param:{id:traceId,msgId:traceId,taskId:taskId,contentId:feedId}};return _preactCompat2["default"].createElement("div",_extends({className:"detail-renderer"},(0,_utils.getTraceExposure)("msg-detail",{msgId:traceId,taskId:taskId})),_preactCompat2["default"].createElement("div",{className:"detail-renderer__header"},_preactCompat2["default"].createElement("img",{className:"detail-renderer__avatar",src:avatar,onError:this.onAvatarError}),_preactCompat2["default"].createElement("div",{className:"detail-renderer__desc"},_preactCompat2["default"].createElement("p",{className:"detail-renderer__name"},senderName),_preactCompat2["default"].createElement("p",{className:"detail-renderer__time"},remark))),_preactCompat2["default"].createElement("div",{className:"detail-renderer__body"},_preactCompat2["default"].createElement("div",{style:renderBodyStyle},isNewContent?_preactCompat2["default"].createElement(_csbcEditorRender2["default"],{dataSource:newContentDataSource,traceCfg:newContentTracelog}):_preactCompat2["default"].createElement(_vbarInfoRenderer2["default"],{dataSource:infoRendererDataSource,traceCfg:traceCfg}),_preactCompat2["default"].createElement(_detailQrcode2["default"],{enable:qrCodeOpitons.enable,src:qrCodeOpitons.src}))))},DetailRenderer}(_preactCompat.Component);DetailRenderer.defaultProps={dataSource:{}},exports["default"]=DetailRenderer},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_27__},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_28__},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),wrapStyle={height:240},boxStyle={position:"absolute",left:0,right:0,bottom:20,minHeight:160,overflow:"hidden",textAlign:"center"},qrCodeStyle={height:160},QrCode=function(props){var enable=props.enable,src=props.src;return enable&&src?_preactCompat2["default"].createElement("div",{style:wrapStyle},_preactCompat2["default"].createElement("div",{style:boxStyle},_preactCompat2["default"].createElement("img",{style:qrCodeStyle,src:src}))):_preactCompat2["default"].createElement("div",null)};QrCode.defaultProps={enable:!1,src:""},exports["default"]=QrCode},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_classnames=__webpack_require__(25),_classnames2=_interopRequireDefault(_classnames),_utils=__webpack_require__(18),Panel=function(props){var _classNames,className=props.className,title=props.title,children=props.children,onClose=(props.footer,props.onClose),clazz=(0,_classnames2["default"])("panel",(_classNames={},_classNames[className]=!!className,_classNames));return _preactCompat2["default"].createElement("div",{className:clazz},_preactCompat2["default"].createElement("div",{className:"panel__header"},_preactCompat2["default"].createElement("p",{className:"panel__title"},title),_preactCompat2["default"].createElement("span",{className:"panel__close",onClick:onClose})),_preactCompat2["default"].createElement("div",{className:"panel__body"},children))};Panel.defaultProps={className:"",title:"\u6d88\u606f\u8be6\u60c5",onClose:_utils.noop},exports["default"]=Panel},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_classnames=__webpack_require__(25),_classnames2=_interopRequireDefault(_classnames),_utils=__webpack_require__(18),_messageCards=__webpack_require__(32),_messageCards2=_interopRequireDefault(_messageCards),_tinyInfiniteScroll=__webpack_require__(34),_tinyInfiniteScroll2=_interopRequireDefault(_tinyInfiniteScroll),MessageScrollList=function(props){var _classNames2,className=props.className,hasMore=props.hasMore,isLoading=props.isLoading,_props$dataSource=props.dataSource,_props$dataSource$lat=_props$dataSource.latest,latest=void 0===_props$dataSource$lat?[]:_props$dataSource$lat,_props$dataSource$pas=_props$dataSource.past,past=void 0===_props$dataSource$pas?[]:_props$dataSource$pas,_props$emptyCfg=props.emptyCfg,emptyCfg=void 0===_props$emptyCfg?{}:_props$emptyCfg,onScroll=props.onScroll,onClickItem=props.onClickItem,tip=emptyCfg.tip,img=emptyCfg.img,latestIsEmpty=!latest||!latest.length,pastIsEmpty=!past||!past.length;if(!isLoading&&latestIsEmpty&&pastIsEmpty){var _classNames,_clazz=(0,_classnames2["default"])("message-scroll-list","message-scroll-list--empty",(_classNames={},_classNames[className]=!!className,_classNames[className+"--empty"]=!!className,_classNames));return _preactCompat2["default"].createElement("div",{className:_clazz},_preactCompat2["default"].createElement("p",{className:"message-scroll-list__tip"},tip),_preactCompat2["default"].createElement("img",{className:"message-scroll-list__img",src:img}))}var clazz=(0,_classnames2["default"])("message-scroll-list",(_classNames2={},_classNames2[className]=!!className,_classNames2));return _preactCompat2["default"].createElement(_tinyInfiniteScroll2["default"],{className:clazz,hasMore:hasMore,isInfiniteLoading:isLoading,onInfiniteLoad:onScroll},!latestIsEmpty&&_preactCompat2["default"].createElement(_messageCards2["default"],{dataSource:latest,onClickItem:onClickItem}),!pastIsEmpty&&_preactCompat2["default"].createElement(_messageCards2["default"],{title:"\u4e09\u5929\u524d",dataSource:past,onClickItem:onClickItem}))};MessageScrollList.defaultProps={className:"",hasMore:!0,isLoading:!1,dataSource:{latest:[],past:[]},emptyCfg:{tip:"\u60a8\u6682\u65f6\u8fd8\u672a\u6536\u5230\u91cd\u8981\u6d88\u606f\uff0c\u6709\u65b0\u589e\u91cd\u8981\u6d88\u606f\u65f6\uff0c\u5de5\u5177\u6761\u4f1a\u6709\u65b0\u3010\u6d88\u606f\u3011\u63d0\u9192\u54e6\uff01\u656c\u8bf7\u5173\u6ce8\uff01",img:"//img.alicdn.com/tfs/TB1cG5Tj3vD8KJjy0FlXXagBFXa-240-180.png"},onScroll:_utils.noop,onClickItem:_utils.noop},exports["default"]=MessageScrollList},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_utils=__webpack_require__(18),_messageCard=__webpack_require__(33),_messageCard2=_interopRequireDefault(_messageCard),MessageCards=function(_Component){function MessageCards(props){_classCallCheck(this,MessageCards);var _this=_possibleConstructorReturn(this,_Component.call(this,props));return _this.onClickItem=_this.onClickItem.bind(_this),_this}return _inherits(MessageCards,_Component),MessageCards.prototype.shouldComponentUpdate=function(nextProps){return nextProps.dataSource!==this.props.dataSource||nextProps.title!==this.props.title},MessageCards.prototype.onClickItem=function(current){var _this2=this;return function(){_this2.props.onClickItem(current)}},MessageCards.prototype.renderItems=function(){var _this3=this,_props$dataSource=this.props.dataSource,dataSource=void 0===_props$dataSource?[]:_props$dataSource;return dataSource.length?_preactCompat2["default"].createElement("div",{className:"message-cards__items"},dataSource.map(function(item){return _preactCompat2["default"].createElement(_messageCard2["default"],{key:item.msgId,id:item.msgId,isRead:item.isRead,avatar:item.senderTouxiang,name:item.senderName,time:item.time,title:item.title,status:item.status,content:item.content,taskId:item.taskId,onClick:_this3.onClickItem(item)})})):null},MessageCards.prototype.render=function(){var title=this.props.title;return _preactCompat2["default"].createElement("div",{className:"message-cards"},title&&_preactCompat2["default"].createElement("p",{className:"message-cards__title"},title),this.renderItems())},MessageCards}(_preactCompat.Component);MessageCards.defaultProps={title:"",dataSource:[],onClickItem:_utils.noop},exports["default"]=MessageCards},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_classnames=__webpack_require__(25),_classnames2=_interopRequireDefault(_classnames),_utils=__webpack_require__(18),MessageCard=function(_Component){function MessageCard(props){_classCallCheck(this,MessageCard);var _this=_possibleConstructorReturn(this,_Component.call(this,props));return _this.state={avatar:props.avatar,active:!1},_this.onMouseEnter=_this.onMouseEnter.bind(_this),_this.onMouseLeave=_this.onMouseLeave.bind(_this),_this.onAvatarError=_this.onAvatarError.bind(_this),_this}return _inherits(MessageCard,_Component),MessageCard.prototype.shouldComponentUpdate=function(nextProps,nextState){return nextProps.id!==this.props.id||nextProps.isRead!==this.props.isRead||nextProps.isOpen!==this.props.isOpen||nextState.avatar!==this.state.avatar||nextState.active!==this.state.active},MessageCard.prototype.onMouseEnter=function(){this.setState({active:!0})},MessageCard.prototype.onMouseLeave=function(){this.setState({active:!1})},MessageCard.prototype.onAvatarError=function(){this.setState({avatar:_utils.DEFAULT_AVATAR})},MessageCard.prototype.render=function(){var _state=this.state,avatar=_state.avatar,active=_state.active,_props=this.props,id=_props.id,isRead=_props.isRead,name=_props.name,time=_props.time,title=_props.title,content=_props.content,onClick=_props.onClick,taskId=_props.taskId,blockClazz=(0,_classnames2["default"])("message-card",{"message-card--unread":!isRead,"message-card--active":active}),hasEllipsis=(0,_utils.lenB)(content)>=50,descClazz=(0,_classnames2["default"])("message-card__desc",{"message-card__desc--has-ellipsis":hasEllipsis}),traceParams={msgId:id,taskId:taskId},traceClickProps=(0,_utils.getTraceClick)("msg-list-card",traceParams),traceExposureProps=(0,_utils.getTraceExposure)("msg-list-card",traceParams);return _preactCompat2["default"].createElement("div",{className:blockClazz,onClick:onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},_preactCompat2["default"].createElement("div",_extends({className:"message-card__box"},traceClickProps,traceExposureProps),_preactCompat2["default"].createElement("div",{className:"message-card__header"},_preactCompat2["default"].createElement("div",{className:"message-card__personal-info"},_preactCompat2["default"].createElement("img",{className:"message-card__avatar",src:avatar,onError:this.onAvatarError}),_preactCompat2["default"].createElement("span",{className:"message-card__name"},name)),_preactCompat2["default"].createElement("span",{className:"message-card__time"},time)),_preactCompat2["default"].createElement("div",{className:"message-card__body"},_preactCompat2["default"].createElement("p",{className:"message-card__title",title:title},title),_preactCompat2["default"].createElement("p",{className:descClazz,title:content},content),_preactCompat2["default"].createElement("span",{className:"message-card__more"},"\u67e5\u770b"))))},MessageCard}(_preactCompat.Component);MessageCard.defaultProps={id:"",isRead:!1,isOpen:!1,avatar:_utils.DEFAULT_AVATAR,name:"\u5c0f\u4e8c",time:"",title:"",content:"",pccontentUrl:"",onClick:_utils.noop},exports["default"]=MessageCard},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_utils=__webpack_require__(18),containerStyle={overflow:"auto"},loadingStyle={padding:"8px",fontSize:"12px",color:"#999",textAlign:"center"},TinyInfiniteScroll=function(_Component){function TinyInfiniteScroll(props){_classCallCheck(this,TinyInfiniteScroll);var _this=_possibleConstructorReturn(this,_Component.call(this,props));return _this.timer=null,_this.onScroll=_this.onScroll.bind(_this),_this}return _inherits(TinyInfiniteScroll,_Component),TinyInfiniteScroll.prototype.canLoading=function(){var $container=this.$container,totalContainerHeight=$container.scrollHeight,bottomScrollPos=$container.scrollTop+$container.offsetHeight;return totalContainerHeight-bottomScrollPos<this.props.threshold},TinyInfiniteScroll.prototype.onScroll=function(){var _this2=this,_props=this.props,hasMore=_props.hasMore,delay=_props.delay,onInfiniteLoad=_props.onInfiniteLoad;if(hasMore){var timer=this.timer;timer&&(clearTimeout(timer),this.timer=null),this.timer=setTimeout(function(){_this2.canLoading()&&onInfiniteLoad()},delay)}},TinyInfiniteScroll.prototype.render=function(){var _this3=this,_props2=this.props,className=_props2.className,isInfiniteLoading=_props2.isInfiniteLoading,children=_props2.children,clazz="tiny-infinite-scroll "+className;return _preactCompat2["default"].createElement("div",{className:clazz,style:containerStyle,ref:function($elm){_this3.$container=$elm},onScroll:this.onScroll},_preactCompat2["default"].createElement("div",{className:"tiny-infinite-scroll__body"},children),isInfiniteLoading&&_preactCompat2["default"].createElement("div",{className:"tiny-infinite-scroll__loading",style:loadingStyle},"loading..."))},TinyInfiniteScroll}(_preactCompat.Component);TinyInfiniteScroll.defaultProps={className:"",delay:160,threshold:100,hasMore:!0,isInfiniteLoading:!1,onInfiniteLoad:_utils.noop},exports["default"]=TinyInfiniteScroll},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_classnames=__webpack_require__(25),_classnames2=_interopRequireDefault(_classnames),_utils=__webpack_require__(18),StatusFilters=function(_Component){function StatusFilters(props){_classCallCheck(this,StatusFilters);var _this=_possibleConstructorReturn(this,_Component.call(this,props));return _this.state={activeKey:props.defaultActiveKey},_this.onChange=_this.onChange.bind(_this),_this}return _inherits(StatusFilters,_Component),StatusFilters.prototype.componentWillReceiveProps=function(nextProps){var activeKey=nextProps.activeKey;void 0!==activeKey&&this.setState({activeKey:activeKey})},StatusFilters.prototype.onChange=function(item){var _this2=this;return function(){_this2.setState({activeKey:item.key}),_this2.props.onChange(item)}},StatusFilters.prototype.render=function(){var _classNames,_this3=this,activeKey=this.state.activeKey,_props=this.props,className=_props.className,dataSource=_props.dataSource,clazz=(0,_classnames2["default"])("status-filters",(_classNames={},_classNames[className]=!!className,_classNames));return _preactCompat2["default"].createElement("div",{className:clazz},dataSource.map(function(){var item=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},index=arguments[1],key=item.key,name=item.name,itemClazz=(0,_classnames2["default"])("status-filters__item",{"status-filters__item--has-spliter":0!==index,"status-filters__item--active":key===activeKey});return _preactCompat2["default"].createElement("span",{key:key,className:itemClazz,onClick:_this3.onChange(item)},name)}))},StatusFilters}(_preactCompat.Component);StatusFilters.defaultProps={className:"",defaultActiveKey:"",activeKey:"",dataSource:[],onChange:_utils.noop},exports["default"]=StatusFilters},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _preactCompat=__webpack_require__(11),_preactCompat2=_interopRequireDefault(_preactCompat),_classnames=__webpack_require__(25),_classnames2=_interopRequireDefault(_classnames),_utils=__webpack_require__(18),Tabs=function(_Component){function Tabs(props){_classCallCheck(this,Tabs);var _this=_possibleConstructorReturn(this,_Component.call(this,props)),defaultActiveKey=props.defaultActiveKey,dataSource=props.dataSource,_dataSource$=dataSource[0],firstItem=void 0===_dataSource$?{}:_dataSource$,activeKey=void 0!==defaultActiveKey?defaultActiveKey:firstItem.key;return _this.state={activeKey:activeKey,currentIndex:0},_this.onClickItem=_this.onClickItem.bind(_this),_this.onClickPaging=_this.onClickPaging.bind(_this),_this}return _inherits(Tabs,_Component),Tabs.prototype.componentWillReceiveProps=function(nextProps){if(nextProps.activeTab&&nextProps.activeTab!==this.state.activeKey){var newTabId=nextProps.activeTab;this.onClickItem({key:newTabId},!0)()}},Tabs.prototype.onClickItem=function(item){var _this2=this,noClosePanel=arguments.length>1&&void 0!==arguments[1]&&arguments[1],key=item.key;return function(){_this2.state.activeKey!==key&&(_this2.setState({activeKey:key}),_this2.props.onChange(item,noClosePanel))}},Tabs.prototype.onClickPaging=function(type){var _this3=this;return function(){if(!_this3.isPagingOff(type)){var factor="prev"===type?-1:1;_this3.setState(function(preState){return{currentIndex:preState.currentIndex+=factor}})}}},Tabs.prototype.isPagingOff=function(type){var currentIndex=this.state.currentIndex,_props=this.props,tabSize=_props.tabSize,dataSource=_props.dataSource,pageSize=Math.ceil(dataSource.length/tabSize);return"prev"===type&&0===currentIndex||"prev"!==type&&currentIndex+1>=pageSize},Tabs.prototype.normalizePagingClazz=function(type){var clazz="tabs__"+("prev"===type?"prev":"next");return this.isPagingOff(type)&&(clazz+=" "+clazz+"--disabled"),clazz},Tabs.prototype.renderItems=function(){var _this4=this,items=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],tabSize=this.props.tabSize,lastIndex=items.length-1,tabStyle={width:Number(100/tabSize).toFixed(4)+"%"};return items.map(function(item,index){var key=item.key,name=item.name,tabClazz=(0,_classnames2["default"])("tabs__item",{"tabs__item--first":0===index,"tabs__item--last":index===lastIndex,"tabs__item--active":_this4.state.activeKey===key});return _preactCompat2["default"].createElement("li",{key:key,className:tabClazz,style:tabStyle,onClick:_this4.onClickItem(item)},_preactCompat2["default"].createElement("p",{className:"tabs__text"},name))})},Tabs.prototype.render=function(){var _classNames,currentIndex=this.state.currentIndex,_props2=this.props,className=_props2.className,tabSize=_props2.tabSize,dataSource=_props2.dataSource,clazz=(0,_classnames2["default"])("tabs",(_classNames={},_classNames[className]=!!className,_classNames)),startIndex=currentIndex*tabSize,items=dataSource.slice(startIndex,startIndex+tabSize),len=dataSource.length,showPaging=len>tabSize;return _preactCompat2["default"].createElement("div",{className:clazz},_preactCompat2["default"].createElement("ul",{className:"tabs__items"},this.renderItems(items)),showPaging&&_preactCompat2["default"].createElement("span",{className:this.normalizePagingClazz("prev"),onClick:this.onClickPaging("prev")}),showPaging&&_preactCompat2["default"].createElement("span",{className:this.normalizePagingClazz("next"),onClick:this.onClickPaging("next")}))},Tabs}(_preactCompat.Component);Tabs.defaultProps={className:"",tabSize:4,defaultActiveKey:void 0,dataSource:[],onChange:_utils.noop},exports["default"]=Tabs},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_37__},function(module,exports){}])});;