define("indexnew:component/gamebox/kingPosition/index.js",["global","module","exports","require","indexnew:static/js/jquery.js","indexnew:static/js/config.js","indexnew:static/js/store.js","indexnew:static/js/format.js","indexnew:static/js/log.js","indexnew:component/gamebox/common/index.js","indexnew:component/gamebox/kingPosition/template.js"],function(e,n,t,i,a,o,r,l,s,d,g){var u=a,m=o,p=r,c=l,v=m.get("userinfo")&&m.get("userinfo").islanding,f=s,y=d,h=g,_=u("#feed_news_wrap"),k={newplayedUrl:"api/getuserreporting"},w={playedGameDefaultIcon:"",playedGameTitle:"玩过的游戏",playedHoverStatus:!1,playedData:{},playedJumpUrl:"https://wan.baidu.com/user",renderKingKongTpl:function(e){var n=this,t="",i=0,a=[];return e&&(i=e.length,a=e.slice(0,4)),u.each(a,function(e,a){if(a){var o=n.renderKingKongHoverList(a.tag_to_gamelist_map,a.jump_url);t+=c(h.kingKongTpl,{url:a.jump_url,icon:a.icon_url,title:a.name,disp:i-1>e?"inline-block":"none",hoverList:o})}}),t},renderKingKongHoverList:function(e,n){var t=this,i="",a="";return e&&e.length>0&&(u.each(e,function(e,n){var i=t.renderKingKongHoverGameItem(n.game_list);a+=c(h.kingKongHoverListItemTpl,{title:n.title,gameList:i})}),i=c(h.kingKongHoverListTpl,{hoverList:a,moreGameUrl:n})),i},renderKingKongHoverGameItem:function(e){var n="";return e&&e.length>0&&u.each(e,function(e,t){t&&(n+=c(h.kingKongHoverGameItemTpl,{gameName:t.game_name,url:t.jump_url,index:e}))}),n},renderGameTpl:function(e){var n="";u.each(e.gamelist||[],function(e,t){t&&(n+=c(h.playedGameTpl,{url:t.jump_url,icon:t.icon_url,gameName:t.game_name,time:t.last_login_time_desc||"",timeLeft:v?19:0}))});var t=this.renderPlayedModuleTpl(e),i=0,a=0;return v?(i=280,a=-81):(i=184,a=-31),{ulWidth:i,ulLeft:a,gameList:n,playedModule:t,isShowMore:e.is_show_more?"block":"none",moreUrl:e.jump_url}},renderPlayedModuleTpl:function(e){var n=e.gamelist||[];this.playedHoverStatus=e.hover_status;var t=this.playedGameDefaultIcon;return n[0]&&(t=n[0].icon_url),c(h.playedModuleTpl,{display:this.playedHoverStatus?"":"hide",url:this.playedJumpUrl,icon:t,title:this.playedGameTitle})},bindKingKongHoverEvent:function(){var e=u("#gameBox",_),n=u(".king-item",e);n&&n.length>0&&u.each(n,function(e){var t=n.eq(e),i=u(".king-hover-list",t);t.mouseenter(function(){i.show();var n={type:"show",game_islogin:v,kingkongHover:1,kingKongIndex:e};f(n)}).mouseleave(function(){i.hide()})})},bindEvent:function(){{var e=this,n=u("#gameBox",_),t=u(".king-played",n),i=u(".king-played-container-redtip",t),a=u(".king-played-list",t),o=u(".king-played-list-item",a),r=u(".king-played-list-mask",a);u(".king-hover-game-item",n)}t.mouseenter(function(){i.hide();var n=e.playedData&&e.playedData.gamelist,t=n&&n.length;if(t){a.show();var o={type:"show",game_islogin:v,game_played:1};f(o)}if(v){if(e.playedHoverStatus){var l={action_type:1,t:+new Date};u.getJSON(k.newplayedUrl,l,function(n){!n||0!==n.error_no&&200!==n.error_no||(r.fadeIn(300).fadeOut(300).fadeIn(300).fadeOut(300),e.playedHoverStatus=!1)})}}else e.playedHoverStatus&&(r.fadeIn(300).fadeOut(300).fadeIn(300).fadeOut(300),e.playedHoverStatus=!1,p.set("playedHoverStatus",e.playedHoverStatus))}).mouseleave(function(){a.hide()}),v||y.bindSaveEvent(o,e.playedData.gamelist,y.changeHotKey.bind(y)),e.bindKingKongHoverEvent()}};n.exports=w});