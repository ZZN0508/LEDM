/*! For license information please see 9083.5f2de866.js.LICENSE.txt */
(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([[9083],{29938:function(e,t,n){"use strict";n.d(t,{NI:function(){return b},Lk:function(){return h},b3:function(){return k},c5:function(){return m},v9:function(){return c},k5:function(){return I},rb:function(){return f},v$:function(){return y},I7:function(){return v},O9:function(){return d},Bs:function(){return g},HF:function(){return s},P6:function(){return u},uX:function(){return p},zn:function(){return w},_:function(){return a}});var o=n(69071);const r="Detached: 3de13e09914ad53e843b91d394ff5b8b4a912769",i="3de13e0",s={sdkVersion:"1.1.1",refer:o.m.Refer.PC,buildNumber:`${i}:${r}`,wsProtocols:["binary","base64","pbbp2"],ticketType:o.m.TicketType.TICKET_TYPE_WEB,envKey:"X-Tt-Env",boeHeaderKey:"X-Use-Boe",ppeHeaderKey:"X-Use-Ppe",requestAccessName:"web_sdk",heartbeatInterval:15e3,maxHeartbeatEmptyWindow:3e4,conversationRefreshCount:10};var a,c;!function(e){e[e.Default=0]="Default",e[e.PushOnly=1]="PushOnly",e[e.All=2]="All",e[e.Disable=3]="Disable"}(a||(a={})),function(e){e.MessageMode="s:mode",e.SendResponseStatus="s:send_response_status",e.SendResponseExtraInfo="s:send_response_extra_info",e.SendResponseCheckCode="s:send_response_check_code",e.SendResponseCheckMessage="s:send_response_check_msg",e.ClientMessageId="s:client_message_id",e.MentionedUser="s:mentioned_users",e.DoNotIncreaseUnread="s:do_not_increase_unread",e.DoNotPopConversation="s:do_not_pop_conversation",e.IsRecalled="s:is_recalled",e.ServerMessageId="s:server_message_id",e.LocalLogId="s:local_logid",e.MessageVisible="s:visible",e.MessageInvisible="s:invisible",e.RelationIsMuted="s:relation_is_muted",e.RelationIsMutedServer="s:relation_is_muted_server",e.RelationNormalOnly="s:relation_normal_only",e.RelationMuteTime="s:relation_mute_time",e.RelationMuteExt="s:relation_mute_ext",e.MessageSourceAppId="s:biz_aid",e.ConversationSourceAppId="s:s_aid",e.MarkActionType="s:action_type",e.IsRootReference="s:is_root_ref",e.MarkMessageNewExt="s:mark_message_new_ext",e.AckSampling="s:is_ack_sampling",e.AckSamplingShow="s:is_ack_sampling_show",e.DoNotUpdateLastMessage="s:do_not_update_last_msg",e.DoNotMoveReadIndex="s:do_not_move_read_index",e.FileExtKeyAudioAsrText="s:file_ext_key_audio_asr_text",e.RecognitionResponseCheckCode="s:recognition_response_check_code",e.RecognitionResponseCheckMsg="s:recognition_response_check_msg",e.PushPartDisableConfig="s:push_part_disable_config",e.MustNotify="s:must_notify",e.SendTime="s:stime",e.ConversationTags="s:conversation_tag",e.UserCustomConversationTags="s:user_custom_conversation_tag",e.EditInfo="s:edit_info",e.RefContent="s:ref_content",e.RefIsEdited="s:ref_is_edited"}(c||(c={}));const d="mute_wl";var u,l,_,p,v,g,h,f,y,m,b,k,O,x,w,I;!function(e){e[e.Enable=0]="Enable",e[e.Disable=1]="Disable"}(u||(u={})),function(e){e[e.SingleChat=1]="SingleChat",e[e.GroupChat=2]="GroupChat",e[e.LiveChat=3]="LiveChat"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Dissolved=1]="Dissolved"}(_||(_={})),function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(p||(p={})),function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(v||(v={})),function(e){e[e.Unknown=0]="Unknown",e[e.Allow=1]="Allow",e[e.Disable=2]="Disable",e[e.PartAllow=3]="PartAllow"}(g||(g={})),function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(h||(h={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Start=1]="Start",e[e.Error=2]="Error",e[e.Succeeded=3]="Succeeded"}(f||(f={})),function(e){e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.LoadMore=2]="LoadMore",e[e.Init=3]="Init",e[e.UserInbox=4]="UserInbox",e[e.BroadcastLoadMore=5]="BroadcastLoadMore",e[e.Offline=6]="Offline"}(y||(y={})),function(e){e.Error="error",e.WebSocketConnected="websocket-connected",e.WebSocketDisconnected="websocket-disconnected",e.WebSocketReceiveUnexpectedFrame="websocket-receive-unexpected-frame",e.ReceiveNewMessage="receive-new-message",e.ReceiveSelfMessage="receive-self-message",e.ReceiveCommandMessage="receive-command-message",e.ReceiveBroadcastNewMessage="receive-broadcast-new-message",e.ReceiveBroadcastSelfMessage="receive-broadcast-self-message",e.ReceiveNewUpdateExtMessage="receive-new-update-ext-message",e.ReceiveNewP2PMessage="receive-new-p2p-message",e.MessageUpsert="message-upsert",e.ConversationChange="conversation-change",e.ConversationUpsert="conversation-upsert",e.ConversationDissolve="conversation-dissolve",e.ConversationBlock="conversation-block",e.ParticipantUpsert="participant-upsert",e.ParticipantJoin="participant-join",e.ParticipantLeave="participant-leave",e.ParticipantBlock="participant-block",e.ParticipantChange="participant-change",e.MessageSend="message-send",e.MessageRecall="message-recall",e.MessageDelete="message-delete",e.ConversationDelete="conversation-delete",e.ConversationLeave="conversation-leave",e.ConversationCreate="conversation-create",e.ConversationJoin="conversation-join",e.ReadReceiptChange="read-receipt-Change",e.ReceiveNewStrangerMessage="receive-new-stranger-message",e.StrangerUpgrade="stranger-upgrade",e.MessagePropertyUpsert="message-property-upsert",e.InitLoadPage="init-load-page",e.InitFinish="init-finish",e.InitParticipant="init-participant",e.TagListUpdate="tag-list-update"}(m||(m={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Success=0]="Success",e[e.InvalidToken=1]="InvalidToken",e[e.InvalidTicket=2]="InvalidTicket",e[e.InvalidRequest=4]="InvalidRequest",e[e.InvalidCommand=5]="InvalidCommand",e[e.ServerError=6]="ServerError",e[e.UserForbidden=11]="UserForbidden",e[e.MessageTargetConversationNotExist=15]="MessageTargetConversationNotExist",e[e.Degradation=16]="Degradation",e[e.RecallTimeout=17]="RecallTimeout",e[e.CallbackDeny=19]="CallbackDeny",e[e.ExpiredToken=100]="ExpiredToken",e[e.InvalidParam=400]="InvalidParam",e[e.ResourceExhausted=429]="ResourceExhausted",e[e.InternalError=500]="InternalError",e[e.InvalidInboxType=1e3]="InvalidInboxType",e[e.ConversationNotExist=1001]="ConversationNotExist",e[e.MessageNotExist=1002]="MessageNotExist",e[e.MessageOffline=1003]="MessageOffline",e[e.UnknownMessageType=1004]="UnknownMessageType",e[e.InvalidServerId=1005]="InvalidServerId",e[e.MessageNotReady=1006]="MessageNotReady",e[e.TokenFuncError=1007]="TokenFuncError",e[e.NetworkError=1008]="NetworkError",e[e.AlreadyDispose=1009]="AlreadyDispose",e[e.NoAdapter=1010]="NoAdapter",e[e.ComponentNotFound=1011]="ComponentNotFound",e[e.NotImplemented=1012]="NotImplemented",e[e.MPInvalidArgument=10001]="MPInvalidArgument",e[e.MPServerUrlError=10002]="MPServerUrlError",e[e.MPNotFileMsg=10003]="MPNotFileMsg",e[e.MPUploadError=10004]="MPUploadError",e[e.MPNotSupportCipher=10005]="MPNotSupportCipher",e[e.DbOpError=2e4]="DbOpError",e[e.StorageCryptoError=20001]="StorageCryptoError",e[e.AuthSignError=10201]="AuthSignError"}(b||(b={})),function(e){e[e.Created=0]="Created",e[e.Preparing=1]="Preparing",e[e.Inflight=2]="Inflight",e[e.Succeeded=3]="Succeeded",e[e.Received=4]="Received",e[e.Failed=-1]="Failed",e[e.Rejected=-2]="Rejected",e[e.SelfVisible=-3]="SelfVisible"}(k||(k={})),function(e){e[e.Succeeded=0]="Succeeded",e[e.UserNotInConversation=1]="UserNotInConversation",e[e.CheckConversationNotPass=2]="CheckConversationNotPass",e[e.CheckMessageNotPass=3]="CheckMessageNotPass",e[e.CheckMessageNotPassButSelfVisible=4]="CheckMessageNotPassButSelfVisible",e[e.UserHasBeenBlock=5]="UserHasBeenBlock"}(O||(O={})),function(e){e[e.Succeeded=0]="Succeeded",e[e.Rejected=1]="Rejected",e[e.PartialRejected=2]="PartialRejected"}(x||(x={})),function(e){e[e.Immediate=0]="Immediate",e[e.Throttle=1]="Throttle",e[e.Debounce=2]="Debounce",e[e.ThrottleWithArgs=3]="ThrottleWithArgs",e[e.DebounceWithArgs=4]="DebounceWithArgs"}(w||(w={})),function(e){e[e.Default=0]="Default",e[e.AwemeMode=1]="AwemeMode"}(I||(I={}))},63090:function(e,t,n){"use strict";n.d(t,{G:function(){return a}});var o=n(29938),r=n(39805),i=n(77166),s=n(3539);class a extends Error{constructor(e){var t,n,c,d;super(`${e&&e.logid?`[${e.logid}] `:""}${e&&e.msg?'message: "'+e.msg+'"':""}${e&&e.innerError?`, inner error: "${e.innerError}"`:""}`),this.ctx=e.ctx,Object.assign(this,e),Object.setPrototypeOf(this,a.prototype),(null===(t=this.innerError)||void 0===t?void 0:t.logid)&&(this.logid=this.innerError.logid);try{"string"==typeof(null===(n=this.innerError)||void 0===n?void 0:n.stack)&&(this.stack=this.innerError.stack+"\n"+(null===(c=this.stack)||void 0===c?void 0:c.split("\n").slice(2).join("\n")))}catch(u){r.Y.ctxWarn(this.ctx,`concat trace fail=${u}, current stack=${this.stack}, inner stack=${null===(d=this.innerError)||void 0===d?void 0:d.stack}`)}this.ctx&&(e.ignoreEvent||this.resolve(s.Uk.EventBus).emit(o.c5.Error,e.sender,this),this.resolve(s.Uk.Monitor).emitError(this),this.resolve(s.Uk.Monitor).emitCounter(i.U.BizSdkError,1,{type:e.type?`${e.type}:${o.NI[e.type]}`:"unknown"}))}getContext(){return this.ctx}resolve(e){return this.ctx.resolve(e)}}},39805:function(e,t,n){"use strict";n.d(t,{Y:function(){return s},h:function(){return o}});var o,r=n(3539);!function(e){e[e.debug=0]="debug",e[e.info=1]="info",e[e.warn=2]="warn",e[e.error=3]="error",e[e.none=4]="none"}(o||(o={}));o.info,o.debug,o.warn,o.error;const i={debug:o.debug,info:o.info,warn:o.warn,error:o.error,none:o.none};class s{static get isBrowser(){return"undefined"!=typeof navigator}static log(e,t,...n){t&&t.resolve(r.Uk.Monitor).emitLog(i[e],n),(null==t?void 0:t.option.debug)&&"none"!==e&&this.level<=o[e]&&(t&&r.hi.Instance.instanceCount,s.isBrowser)}static debug(...e){this.log("debug",undefined,...e)}static info(...e){this.log("info",undefined,...e)}static warn(...e){this.log("warn",undefined,...e)}static error(...e){this.log("error",undefined,...e)}static ctxDebug(e,...t){this.log("debug",e,...t)}static ctxInfo(e,...t){this.log("info",e,...t)}static ctxWarn(e,...t){this.log("warn",e,...t)}static ctxError(e,...t){this.log("error",e,...t)}}s.level=o.debug},77166:function(e,t,n){"use strict";n.d(t,{u:function(){return s},U:function(){return o}});var o,r=n(29938),i=n(3539);!function(e){e.CreateConversation="create.conv",e.SendMessage="send.msg",e.ReceiveMessage="receive.msg",e.WsConnect="ws.connect",e.NetworkRequest="network.request",e.FrontierOpen="frontier.open",e.FrontierClose="frontier.close",e.FrontierError="frontier.error",e.FrontierReceive="frontier.receive",e.FrontierLive="frontier.live",e.WebSocketConnectFirst="ws.connect.first",e.WebSocketConnectAfterClose="ws.connect.afterclose",e.WebSocketConnectNoHeartbeat="ws.connect.noheartbeat",e.BizApiInvoke="api.invoke",e.MessageAck="message.ack",e.SuccessSuffix=".success",e.ErrorSuffix=".error",e.BizSdkInit="init",e.BizRefreshToken="refresh.token",e.BizSdkError="error",e.GetMessagesByConversation="message.get.byconversation",e.GetMessagesByTicker="message.get.ticker"}(o||(o={}));class s extends i.mA{static get avgDelta(){return 0===this.putDeltaTimes?0:this.totalDelta/this.putDeltaTimes}static putTimeDelta(e,t,n,o){if(n===undefined||o===undefined)return;const r=o-((t-e-(n-o))/2+e);s.putDeltaTimes++,s.totalDelta+=r}get avgDelta(){return s.avgDelta}static performanceNow(){return"object"==typeof performance&&"function"==typeof performance.now&&"number"==typeof performance.timeOrigin?performance.now()+performance.timeOrigin:Date.now()}invoke(e,...t){if(this.ctx.option.monitor===undefined)return!1;let n=this.ctx.option.monitor;Array.isArray(n)||(n=[n]),n.forEach((n=>{const o=n[e];return"function"==typeof o&&setTimeout((()=>{o.apply(n,t)}),0)}))}fillKv(e){const t=Object.assign(Object.assign(Object.assign({},e),this.ctx.option.monitorTagKv),{sdk_version:r.HF.sdkVersion,sdk_type:this.ctx.option.sdkType||"im-web-sdk",build_number:r.HF.buildNumber,app_id:this.ctx.option.appId.toString(),user_id:this.ctx.option.userId});return this.ctx.option.versionCode&&(t.version_code=this.ctx.option.versionCode),t}emitMetrics(e,t={},n={}){const o=`imsdk.${e}`;this.invoke("emitMetrics",o,t,this.fillKv(n))}emitCounter(e,t=1,n={}){if(0===t)return;const o=`imsdk.${e}`;this.invoke("emitMetrics",o,{count:t},this.fillKv(n))}emitDuration(e,t,n={}){const o=s.performanceNow()-t,r=`imsdk.${e}`;return this.invoke("emitMetrics",r,{duration:o},this.fillKv(n)),o}emitLatencyDuration(e,t,n={}){const o=this.ctx.option.timeCalibration?this.avgDelta:0,r=s.performanceNow()+o-t;r<0||this.invoke("emitMetrics",e,{duration:r},this.fillKv(n))}emitError(e){this.invoke("emitError",e,this.fillKv({}))}emitNetwork(e,t,n={}){this.invoke("emitNetwork",e,t,this.fillKv(n))}emitEvent(e,t,n){this.invoke("emitEvent",e,t,n)}emitLog(e,...t){this.invoke("emitLog",e,t[0])}emitTracker(e,t){this.invoke("emitTracker",e,this.fillKv(t))}}s.putDeltaTimes=0,s.totalDelta=0},74110:function(e,t,n){"use strict";n.d(t,{r:function(){return p}});var o=n(9267),r=n(69071),i=n(29938),s=n(86384),a=n(57822),c=n(6884),d=n.n(c),u=n(39805),l=n(3539),_=n(9453);class p extends l.mA{constructor(){super(...arguments),this.isMember=!0,this._badgeCount=0,this.muteBadgeCountInfos=[],this.__internal_pullCursor=o.MAX_VALUE,this.cacheUnreadCountCalc=undefined,this.cacheUnreadCountWithWhiteListCalc=undefined}get type(){return 15&this.bizType}set type(e){this.bizType=e}get inboxType(){return this.coreInfo.inboxType}mergeMuteBadgeCountInfos(e){e&&e.forEach((e=>{const t=this.muteBadgeCountInfos.findIndex((t=>t.message_type===e.message_type));t>-1?this.muteBadgeCountInfos[t]=e:this.muteBadgeCountInfos.push(e)}))}get badgeCount(){return this._badgeCount}set badgeCount(e){e!==undefined&&(this._badgeCount!==undefined?e>this._badgeCount&&(this._badgeCount=e):this._badgeCount=e)}get partMuteBadgeCount(){var e,t,n,o;return null!==(o=null===(n=null===(t=null===(e=this.muteBadgeCountInfos)||void 0===e?void 0:e.find)||void 0===t?void 0:t.call(e,(e=>e.message_type===r.m.MuteMessageType.TYPE_PART_MUTE)))||void 0===n?void 0:n.badge_count)&&void 0!==o?o:0}get mode(){return 0}get isStrangerConversation(){return 0!==this.mode}get isMuted(){return this.pushStatus!==i.Bs.Unknown?this.pushStatus===i.Bs.Disable:this.settingInfo!==undefined&&this.settingInfo.mute===i.I7.On}get pushStatus(){var e;return null!==(e=this.settingInfo.pushStatus)&&void 0!==e?e:i.Bs.Unknown}get weakMuteInfo(){return this.settingInfo.weakMuteInfo}get isStickOnTop(){return this.settingInfo!==undefined&&this.settingInfo.stickTop===i.uX.On}get isFavorite(){return this.settingInfo!==undefined&&this.settingInfo.favor===i.Lk.On}get ext(){let e={};return this.coreInfo&&this.coreInfo.ext&&(e=Object.assign(e,this.coreInfo.ext)),this.settingInfo&&this.settingInfo.ext&&(e=Object.assign(e,this.settingInfo.ext)),e}get rankScore(){var e,t,n,r,i;return this.isStickOnTop?(null!==(e=this.settingInfo.setTopTime)&&void 0!==e?e:o.ZERO).add(8e15).toNumber():null!==(i=null===(r=null===(n=null===(t=this.lastPopVisibleMessage)||void 0===t?void 0:t.createdAt)||void 0===n?void 0:n.getTime)||void 0===r?void 0:r.call(n))&&void 0!==i?i:-1}get lastMessage(){return this.filterLastMessage()}get lastVisibleMessage(){return this.filterLastMessage((e=>e.visible))}get lastPopVisibleMessage(){return this.filterLastMessage((e=>!e.unpop))}get firstMessage(){return this.filterFirstMessage()}get readIndex(){return this.settingInfo.readIndex}get readIndexV2(){return this.settingInfo.readIndexV2}get minIndex(){return this.settingInfo.minIndex}get version(){return this.coreInfo.version}get unreadCount(){return this.ctx.option.useBadgeCountForUnread&&this.settingInfo.readBadgeCount?this.unreadCountFromReadBadge:this.unreadCountFromReadIndex}get unreadCountFromReadBadge(){return Math.max(this.badgeCount-this.settingInfo.readBadgeCount,0)}get unreadCountFromReadIndex(){var e,t,n;return this.cacheUnreadCountCalc===undefined&&(this.cacheUnreadCountCalc=d()((e=>this.unreadMessageList.length),{maxSize:1})),this.cacheUnreadCountCalc(`${null===(t=null===(e=this.updatedAt)||void 0===e?void 0:e.getTime)||void 0===t?void 0:t.call(e)}:${null===(n=this.readIndex)||void 0===n?void 0:n.toString()}`)}get unreadCountWithWhiteList(){return this.ctx.option.useBadgeCountForUnread&&this.settingInfo.partMuteReadBadgeCount?this.unreadCountWithWhiteListFromReadBadge:this.unreadCountWithWhiteListFromReadIndex}get unreadCountWithWhiteListFromReadBadge(){const e=this.partMuteBadgeCount;return Math.max(e-this.settingInfo.partMuteReadBadgeCount,0)}get unreadCountWithWhiteListFromReadIndex(){var e,t,n;return this.cacheUnreadCountWithWhiteListCalc===undefined&&(this.cacheUnreadCountWithWhiteListCalc=d()((e=>this.unreadMessageListWithWhiteList.length),{maxSize:1})),this.cacheUnreadCountWithWhiteListCalc(`${null===(t=null===(e=this.updatedAt)||void 0===e?void 0:e.getTime)||void 0===t?void 0:t.call(e)}:${null===(n=this.readIndex)||void 0===n?void 0:n.toString()}`)}forceRefreshUnreadCount(){var e;const t=this.unreadMessageList.length;t!==this.unreadCount&&this.cacheUnreadCountCalc!==undefined&&this.cacheUnreadCountCalc.clear!==undefined&&(u.Y.ctxDebug(this.ctx,`force refresh unread count: ${this.id}, value: ${t}`),null===(e=this.cacheUnreadCountCalc)||void 0===e||e.clear())}get unreadMessageList(){if(!this.readIndex)return[];return this.resolve(l.Uk.MessageManager).getList(this.id).filter((e=>e.indexInConversation.gt(this.readIndex)&&e.indexInConversation.gt(this.minIndex)&&e.increaseUnread))}get unreadMessageListWithWhiteList(){return this.unreadMessageList.filter((e=>this.isMsgInWeakMuteWhiteList(e)))}isMsgInWeakMuteWhiteList(e){var t,n,o;return(null===(t=e.ext)||void 0===t?void 0:t[i.v9.MustNotify])||(null===(n=this.settingInfo.weakMuteInfo.whiteUids)||void 0===n?void 0:n.find((t=>t.toString()===e.sender)))||(null===(o=this.settingInfo.weakMuteInfo.whiteMsgTypes)||void 0===o?void 0:o.find((t=>t===e.type)))}getLocalMessageRangeList(e,t){return this.resolve(l.Uk.MessageManager).getList(this.id).filter((n=>n.indexInConversation.lte(t)&&n.indexInConversation.gt(e)&&n.indexInConversation.gt(this.minIndex)&&n.increaseUnread))}get updatedAt(){return this.lastMessage?this.lastMessage.createdAt:new Date(0)}get firstMessageIndex(){var e,t;return null!==(t=null===(e=this.filterFirstMessage((e=>e.indexInConversation&&e.indexInConversation.gt(0))))||void 0===e?void 0:e.indexInConversation)&&void 0!==t?t:o.ZERO}get lastMessageIndex(){var e,t;return null!==(t=null===(e=this.filterLastMessage((e=>e.indexInConversation&&e.indexInConversation.gt(0))))||void 0===e?void 0:e.indexInConversation)&&void 0!==t?t:o.ZERO}get lastMessageIndexV2(){var e,t;return null!==(t=null===(e=this.filterLastMessage((e=>e.indexInConversation&&e.indexInConversation.gt(0))))||void 0===e?void 0:e.indexInConversationV2)&&void 0!==t?t:o.ZERO}get lastMessageOrder(){var e,t;return null!==(t=null===(e=this.filterLastMessage((e=>e.orderInConversation&&e.orderInConversation.gt(0))))||void 0===e?void 0:e.orderInConversation)&&void 0!==t?t:o.ZERO}getMessageList(e=(e=>e.visible)){return this.resolve(l.Uk.MessageManager).getList(this.id).filter(e)}getParticipantList(){return this.resolve(l.Uk.ParticipantManager).get(this.id)}get toParticipantUserId(){if(this.type===r.m.ConversationType.GROUP_CHAT)return undefined;const e=this.id.split(":");return e[2]===this.ctx.option.userId?e[3]:e[2]}get isBlocked(){return(0,_.vP)(this.ext,i.v9.RelationIsMuted)}get isServerBlocked(){return(0,_.vP)(this.ext,i.v9.RelationIsMutedServer)}get isBlockNormalOnly(){return this.isBlocked&&(0,_.vP)(this.ext,i.v9.RelationNormalOnly)}get tagIds(){const e=this.ext[i.v9.ConversationTags]||"";return""===e?[]:e.split(",")}get userTagIds(){const e=this.ext[i.v9.UserCustomConversationTags]||"";return""===e?[]:e.split(",")}static fromServerConversation(e,t,n){var o;const r=new p(e);r.id=t.conversation_id,r.shortId=t.conversation_short_id.toString(),r.type=t.conversation_type,r.ticket=t.ticket,r.participantCount=t.participants_count,r.isMember=t.is_participant,r.isOffline=!1,r.firstPageParticipant=t.first_page_participants,r.badgeCount=t.badge_count,r.muteBadgeCountInfos=null!==(o=t.mute_badge_count_infos)&&void 0!==o?o:[],r.coreInfo=new s._(r,t.conversation_core_info),r.settingInfo=new a.H(r,t.conversation_setting_info);const c=Object.keys(r.coreInfo.ext);for(const i of Object.keys(r.settingInfo.ext))c.includes(i)&&u.Y.ctxDebug(r.ctx,`conversation: ${r.shortId} ext duplicate key: ${i}`);return n!==undefined&&r.ctx.option.debug&&(r.coreInfo.ext[i.v9.LocalLogId]=n),r}filterLastMessage(e){const t=this.getMessageList((()=>!0));let n=null;if(0===t.length)return null;if(e===undefined)return t[t.length-1];for(let o=t.length-1;o>=0;o--)if(e(t[o])){n=t[o];break}return n}filterFirstMessage(e){const t=this.getMessageList((()=>!0));let n=null;if(0===t.length)return null;if(e===undefined)return t[0];for(const o of t)if(e(o)){n=o;break}return n}}},86384:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var o=n(9267),r=n(39805),i=n(3539);class s extends i.mA{constructor(e,t){var n,r;super(e.ctx),this.version=o.ZERO,this.parent=e,t!==undefined&&(this.desc=t.desc,this.ext=t.ext,this.icon=t.icon,this.name=t.name,this.notice=t.notice,this.owner=null!==(r=null===(n=t.owner)||void 0===n?void 0:n.toString())&&void 0!==r?r:"",this.version=t.info_version,this.secOwner=t.sec_owner,this.inboxType=t.inbox_type),this.inboxType===undefined&&(this.inboxType=this.resolve(i.Uk.InboxType).getDefaultInboxWithoutCheck())}get conversationId(){return this.parent.id}get ext(){return this.innerExt||(this.innerExt={}),this.innerExt}set ext(e){this.innerExt=null!=e?e:{}}mergeCore(e){return e.version.lt(this.version)?(r.Y.ctxDebug(this.ctx,"core info version local > online, local: ",this.version.toString(),"new: ",e.version.toString()),this):e.conversationId!==this.conversationId?(r.Y.ctxDebug(this.ctx,"core info conversation not match, local:",this.conversationId.toString(),"new: ",e.conversationId.toString()),this):(this.version=e.version,this.name=e.name,this.desc=e.desc,this.icon=e.icon,this.notice=e.notice,this.owner=e.owner,this.secOwner=e.owner,this.innerExt=Object.assign(Object.assign({},this.innerExt),e.innerExt),this.inboxType=e.inboxType,this)}}},57822:function(e,t,n){"use strict";n.d(t,{H:function(){return d}});var o=n(9267),r=n(39805),i=n(69071),s=n(29938),a=n(3539),c=n(26919);class d extends a.mA{constructor(e,t){var n,r;super(e.ctx),this.version=o.ZERO,this._pushStatus=s.Bs.Allow,this.minIndex=o.ZERO,this._readIndex=o.ZERO,this._readIndexV2=o.ZERO,this._readBadgeCount=0,this.muteReadBadgeCountInfos=[],this.parent=e,t!==undefined&&(this.ext=t.ext,this.favor=t.favorite,this.mute=t.mute,this.stickTop=t.stick_on_top,this.version=o.fromValue(null!==(n=t.setting_version)&&void 0!==n?n:o.ZERO),this.readIndex=t.read_index,this.readIndexV2=t.read_index_v2,this.minIndex=t.min_index,this.setFavoriteTime=t.set_favorite_time,this.setTopTime=t.set_top_time,this.pushStatus=t.push_status,this.readBadgeCount=t.read_badge_count,this.mergeMuteReadBadgeCountInfos(null!==(r=t.mute_read_badge_count_infos)&&void 0!==r?r:[]))}get conversationId(){return this.parent.id}get pushStatus(){return this._pushStatus}set pushStatus(e){[s.Bs.Allow,s.Bs.PartAllow,s.Bs.Disable].includes(e)?this._pushStatus=e:this._pushStatus=s.Bs.Unknown}get readIndex(){return this._readIndex}set readIndex(e){if(e===undefined)return;const t=o.fromValue(e);this._readIndex!==undefined?t.gt(this._readIndex)&&(this._readIndex=t):this._readIndex=t}get readIndexV2(){return this._readIndexV2}set readIndexV2(e){if(e===undefined)return;const t=o.fromValue(e);this._readIndexV2!==undefined?t.gt(this._readIndex)&&(this._readIndexV2=t):this._readIndexV2=t}get readBadgeCount(){return this._readBadgeCount}set readBadgeCount(e){e!==undefined&&(this.parent.badgeCount&&e>this.parent.badgeCount&&(e=this.parent.badgeCount),this._readBadgeCount!==undefined?e>this._readBadgeCount&&(this._readBadgeCount=e):this._readBadgeCount=e)}mergeMuteReadBadgeCountInfos(e){e&&e.forEach((e=>{const t=this.muteReadBadgeCountInfos.findIndex((t=>t.message_type===e.message_type));t>-1?this.muteReadBadgeCountInfos[t]=e:this.muteReadBadgeCountInfos.push(e)}))}get partMuteReadBadgeCount(){var e,t,n,o;return null!==(o=null===(n=null===(t=null===(e=this.muteReadBadgeCountInfos)||void 0===e?void 0:e.find)||void 0===t?void 0:t.call(e,(e=>e.message_type===i.m.MuteMessageType.TYPE_PART_MUTE)))||void 0===n?void 0:n.read_badge_count)&&void 0!==o?o:0}get ext(){return this.innerExt||(this.innerExt={}),this.innerExt}set ext(e){this.innerExt=null!=e?e:{}}mergeSetting(e){return e.version.lt(this.version)?(r.Y.ctxDebug(this.ctx,"setting info version local > online, local: ",this.version.toString(),"new: ",e.version.toString()),this):e.conversationId!==this.conversationId?(r.Y.ctxDebug(this.ctx,"setting info conversation not match, local:",this.conversationId.toString(),"new: ",e.conversationId.toString()),this):(this.stickTop=e.stickTop,this.setTopTime=e.setTopTime,this.mute=e.mute,this.favor=e.favor,this.setFavoriteTime=e.setFavoriteTime,this.innerExt=Object.assign(Object.assign({},this.innerExt),e.ext),this.readIndex=e.readIndex,this.readIndexV2=e.readIndexV2,this.minIndex=e.minIndex,this.version=e.version,this.pushStatus=e.pushStatus,this.readBadgeCount=e.readBadgeCount,this.mergeMuteReadBadgeCountInfos(e.muteReadBadgeCountInfos),this)}get weakMuteInfo(){var e,t,n;const i={whiteUids:[],whiteMsgTypes:[]};if(!this.innerExt[s.v9.PushPartDisableConfig])return i;try{const r=c.parse(this.innerExt[s.v9.PushPartDisableConfig]),i=null==r?void 0:r[s.O9],a=null!==(t=null===(e=null==i?void 0:i.white_uids)||void 0===e?void 0:e.map(o.fromValue))&&void 0!==t?t:[];return{whiteUids:a,whiteMsgTypes:null!==(n=null==i?void 0:i.white_msg_types)&&void 0!==n?n:[]}}catch(a){return r.Y.ctxWarn(this.ctx,"conversation setting weak mute info parse error: ",a),i}}}},67466:function(e,t,n){"use strict";n.d(t,{v:function(){return l},R:function(){return o}});var o,r=n(9267),i=n(39805),s=n(29938),a=n(69071),c=n(3539),d=n(9453),u=n(26919);!function(e){e[e.Sending=0]="Sending",e[e.Success=1]="Success",e[e.Failed=2]="Failed"}(o||(o={}));class l extends c.mA{constructor(){super(...arguments),this.indexInConversation=r.ZERO,this.indexInConversationV2=r.ZERO,this.orderInConversation=r.ZERO,this.property={},this.source=s.v$.Unknown}get conversationType(){return 15&this.conversationBizType}set conversationType(e){this.conversationBizType=e}get clientId(){var e;return this.ext&&null!==(e=this.ext[s.v9.ClientMessageId])&&void 0!==e?e:""}set clientId(e){this.ext||(this.ext={}),this.ext[s.v9.ClientMessageId]=e}static createClientMessage(e,t){var n;const o=new l(e);o.conversationId=t.conversationId,o.type=t.type,o.conversationType=t.conversationType,o.conversationShortId=t.conversationShortId,o.sender=e.option.userId,o.content=t.content,o.createdAt=new Date(Date.now());const c=Object.assign({},t.ext);for(const r of Object.keys(c))r.startsWith("s:")&&(i.Y.ctxDebug(o.ctx,`delete s: prefix ext key: '${r}: ${c[r]}'`),delete c[r]);if(o.ext=c,o.mentionedUsers=t.mentionedUsers,o.clientId=t.id,o.version=r.ZERO,o.serverStatus=s.P6.Enable,o.isOffline=!0,t.referenceMessage){let e=a.m.MessageStatus.AVAILABLE;t.referenceMessage.isRecalled?e=a.m.MessageStatus.RECALLED:t.referenceMessage.visible||(e=a.m.MessageStatus.INVISIBLE),o.referenceInfo={referenced_message_id:r.fromValue(t.referenceMessage.serverId),hint:null!==(n=t.referenceHint)&&void 0!==n?n:"",ref_message_type:r.fromValue(t.referenceMessage.type),referenced_message_status:e,ext:{[s.v9.RefContent]:t.referenceMessage.content,[s.v9.RefIsEdited]:String(t.referenceMessage.isEdited)}},t.referenceMessage.referenceInfo!==undefined?(o.referenceInfo.root_message_id=t.referenceMessage.referenceInfo.root_message_id,o.referenceInfo.root_message_conv_index=t.referenceMessage.referenceInfo.root_message_conv_index):(o.referenceInfo.root_message_id=r.fromValue(t.referenceMessage.serverId),o.referenceInfo.root_message_conv_index=t.referenceMessage.indexInConversation)}return o.ctx.option.secUid&&(o.secSender=o.ctx.option.secUid),o}static fromServerMessage(e,t,n){var o;const i=new l(e);return i.serverId=t.server_message_id.toString(),i.type=t.message_type,i.ext=Object.assign({},t.ext),i.conversationId=t.conversation_id,i.content=t.content,i.sender=t.sender.toString(),i.createdAt=new Date(t.create_time.toNumber()),i.indexInConversation=t.index_in_conversation,i.indexInConversationV2=null!==(o=t.index_in_conversation_v2)&&void 0!==o?o:r.ZERO,i.orderInConversation=t.order_in_conversation,i.serverStatus=t.status,i.conversationShortId=t.conversation_short_id.toString(),i.conversationType=t.conversation_type,i.version=t.version,i.secSender=t.sec_sender,i.isOffline=!1,i.property=l.fromServerProperty(t),t.reference_info&&(i.referenceInfo=t.reference_info),n!==undefined&&i.ctx.option.debug&&(i.ext[s.v9.LocalLogId]=n),i}static fromServerProperty(e){const t={};if(!e.property_list)return t;for(const n of Object.keys(e.property_list)){const r=e.property_list[n];r&&r.Items&&(t[n]=r.Items.map((t=>{var r,i,a,c,d;return{messageId:null!==(r=e.ext[s.v9.ClientMessageId])&&void 0!==r?r:"",conversationId:e.conversation_id,key:n,userId:null===(i=t.uid)||void 0===i?void 0:i.toString(),secUid:null!==(a=t.sec_uid)&&void 0!==a?a:"",createTime:new Date(1e3*(null!==(d=null===(c=t.create_time)||void 0===c?void 0:c.toNumber())&&void 0!==d?d:0)),idempotentId:t.idempotent_id,value:t.value,version:e.version,status:o.Success}})))}return t}merge(e){if(e&&this.type===e.type){if(e.ext=Object.assign(this.ext||{},e.ext),""===e.content&&this.content&&(i.Y.ctxDebug(this.ctx,"ignore empty content replace:",e),e.content=this.content),e.clientId===this.clientId){if(e.indexInConversation.lt(this.indexInConversation))return this.indexInConversation=e.indexInConversation,this;if(e.indexInConversationV2.lt(this.indexInConversationV2))return this.indexInConversationV2=e.indexInConversationV2,this}Object.assign(this,e)}return this}get isNormalMsg(){return this.type<5e4}get isCommandMsg(){return this.type===a.m.MessageType.MESSAGE_TYPE_COMMAND}get isSpecialMessage(){return this.type>=5e4}get visible(){return this.serverStatus!==s.P6.Disable&&(!this.isSpecialMessage&&(!this.ctx.option.userId||!this.ext||(this.ext[s.v9.MessageVisible]&&this.ext[s.v9.MessageVisible].length>0?-1!==this.ext[s.v9.MessageVisible].split(",").indexOf(this.ctx.option.userId):!(this.ext[s.v9.MessageInvisible]&&this.ext[s.v9.MessageInvisible].length>0)||-1===this.ext[s.v9.MessageInvisible].split(",").indexOf(this.ctx.option.userId))))}get unpop(){return!!this.ext&&!(this.visible&&!(0,d.vP)(this.ext,s.v9.DoNotPopConversation))}get increaseUnread(){return!(this.isFromMe||!this.visible||this.isSpecialMessage)&&!(0,d.vP)(this.ext,s.v9.DoNotIncreaseUnread)}get isFromMe(){return this.sender===this.ctx.option.userId}get isRecalled(){return this.ext&&Boolean(this.ext[s.v9.IsRecalled])}get isMentioned(){return this.visible&&(this.mentionedUsers.includes(this.ctx.option.userId)||this.mentionedUsers.includes("0")&&!this.isFromMe)}get mentionedUsers(){return this.ext&&this.ext[s.v9.MentionedUser]?this.ext[s.v9.MentionedUser].split(","):[]}set mentionedUsers(e){this.ext||(this.ext={}),this.ext[s.v9.MentionedUser]=e.join(",")}get isStrangerMessage(){return!this.ext||["1","2","3"].includes(this.ext[s.v9.MessageMode])}get isRootReference(){return!!this.ext&&(0,d.vP)(this.ext,s.v9.IsRootReference)}get moveReadIndex(){return!this.ext||!(!this.visible||this.isFromMe||this.isSpecialMessage)&&!(0,d.vP)(this.ext,s.v9.DoNotMoveReadIndex)}get updateLastMessage(){return!(!this.visible||this.isSpecialMessage)&&!(0,d.vP)(this.ext,s.v9.DoNotUpdateLastMessage)}getReadReceipt(){return this.resolve(c.Uk.CoreInstance).getMessageReadReceipt({message:this})}get editInfo(){var e;if(!this.ext[s.v9.EditInfo])return null;try{const t=u.parse(this.ext[s.v9.EditInfo]),n=(null==t?void 0:t.content_edit_time)?new Date(null==t?void 0:t.content_edit_time):undefined;return{isEdited:Boolean(null==t?void 0:t.content_is_edited),editTime:n,editorUid:null===(e=null==t?void 0:t.content_editor)||void 0===e?void 0:e.toString()}}catch(t){return null}}get isEdited(){var e;return Boolean(null===(e=this.editInfo)||void 0===e?void 0:e.isEdited)}}},66145:function(e,t,n){"use strict";n.d(t,{Q:function(){return c}});var o=n(9267),r=n(29938),i=n(69071),s=n(3539),a=n(9453);class c extends s.mA{constructor(){super(...arguments),this.minIndex=o.ZERO,this._readIndex=o.ZERO,this._readOrder=o.ZERO}get isServerBlocked(){return(0,a.vP)(this.ext,r.v9.RelationIsMutedServer)}get readIndex(){return this._readIndex}set readIndex(e){e&&e.gt(this._readIndex)&&(this._readIndex=e)}get readOrder(){return this._readOrder}set readOrder(e){e&&e.gt(this._readOrder)&&(this._readOrder=e)}get isSelf(){return this.userId===this.ctx.option.userId}get ext(){return this.innerExt||(this.innerExt={}),this.innerExt}set ext(e){this.innerExt=e}static featLocalParticipant(e,t){var n,o,r,i,s,a,c,d;return e.userId!==t.userId||(e.secUid=null!==(n=t.secUid)&&void 0!==n?n:e.secUid,e.role=null!==(o=t.role)&&void 0!==o?o:e.role,e.alias=null!==(r=t.alias)&&void 0!==r?r:e.alias,e.sortOrder=null!==(i=t.sortOrder)&&void 0!==i?i:e.sortOrder,e.blocked=null!==(s=t.blocked)&&void 0!==s?s:e.blocked,e.leftBlockTime=null!==(a=t.leftBlockTime)&&void 0!==a?a:e.leftBlockTime,e.readIndex=null!==(c=t.readIndex)&&void 0!==c?c:e.readIndex,e.readOrder=null!==(d=t.readOrder)&&void 0!==d?d:e.readOrder,e.ext=Object.assign(e.ext,t.ext)),e}static fromServerParticipant(e,t,n,o){var s,a,d,u,l;const _=new c(e);return _.userId=t.user_id.toString(),_.secUid=t.sec_uid,_.role=null!==(s=t.role)&&void 0!==s?s:undefined,_.alias=null!==(a=t.alias)&&void 0!==a?a:undefined,_.sortOrder=null!==(d=t.sort_order)&&void 0!==d?d:undefined,_.blocked=t.blocked===i.m.BlockStatus.BLOCK,_.leftBlockTime=null!==(u=t.left_block_time)&&void 0!==u?u:undefined,_.ext=null!==(l=t.ext)&&void 0!==l?l:{},_.conversationId=n.id,_.conversationType=n.type,o!==undefined&&_.ctx.option.debug&&(_.ext[r.v9.LocalLogId]=o),_}static fakeParticipant(e,t,n){const r=new c(e);return r.conversationId=n.id,r.conversationType=n.type,r.readIndex=o.ZERO,r.minIndex=o.ZERO,r.userId=t,r}}},56329:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var o=n(15727),r=n(69071),i=n(9267),s=n(29938);const a={[r.m.IMCMD.SEND_MESSAGE]:"v1/message/send",200:"v1/message/get_by_user",203:"v2/message/get_by_user_init",300:"v1/conversation/get_list",301:"v1/message/get_by_conversation",400:"v1/account/online",401:"v1/account/offline",410:"v1/client/user_action",411:"v1/client/input_status",603:"v1/conversation/delete",608:"v2/conversation/get_info",609:"v2/conversation/create",610:"v2/conversation/get_info_list",611:"v2/conversation/get_by_favorite",612:"v2/conversation/get_by_top",614:"v1/conversation/dissolve",605:"v1/conversation/participants_list",650:"v1/conversation/add_participants",651:"v1/conversation/remove_participants",652:"v1/conversation/leave",655:"v1/conversation/update_participant",701:"v1/message/delete",702:"v1/message/recall",705:"v1/message/set_property",902:"v1/conversation/set_core_info",904:"v1/conversation/upsert_core_ext_info",921:"v1/conversation/set_setting_info",922:"v1/conversation/upsert_settings_ext",1001:"v1/stranger/get_conversation_list",1002:"v1/stranger/get_messages",1003:"v1/stranger/delete_message",1004:"v1/stranger/delete_conversation",1005:"v1/stranger/delete_all_conversations",1006:"v1/stranger/mark_read_conversation",1007:"v1/stranger/mark_read_all_conversations",2e3:"v3/conversation/get_read_index",2001:"v3/conversation/get_min_index",2002:"v3/conversation/mark_read",2003:"v1/media/get_upload_token",2004:"v1/media/get_urls",2006:"v1/conversation/list",2007:"v1/broadcast/send_message",2008:"v1/broadcast/recv_message",2009:"v1/broadcast/user_counter",2010:"v1/client/ack",2011:"v1/voip/create",2012:"v1/voip/call",2013:"v1/voip/update",2014:"v1/channel/heartbeat",2015:"v1/profile/get_info",2016:"v1/client/report_metrics",2017:"v1/config/get",[r.m.IMCMD.GET_MESSAGE_BY_INIT]:"v1/message/get_message_by_init",[r.m.IMCMD.MODIFY_MESSAGE_EXT]:"v1/message/modify_ext",[r.m.IMCMD.UNREAD_COUNT_REPORT]:"v1/client/unread_count",[r.m.IMCMD.SEND_MESSAGE_P2P]:"v1/send_message/p2p",[r.m.IMCMD.BATCH_GAT_CONVERSATION_PARTICIPANTS_READINDEX]:"v1/conversation/batch_get_conversation_participants_readindex",[r.m.IMCMD.GET_CONVERSATIONS_CHECKINFO]:"v1/conversation/get_checkinfo",[r.m.IMCMD.GET_MESSAGES_CHECKINFO_IN_CONVERSATION]:"v1/message/get_checkinfo",[r.m.IMCMD.MARK_MESSAGE]:"v1/message/mark",[r.m.IMCMD.PULL_MARK_MESSAGE]:"v1/message/pull_mark",[r.m.IMCMD.GET_CONVERSATION_CORE_INFO]:"v1/conversation/get_core_info",[r.m.IMCMD.GET_UNREAD_COUNT]:"v1/client/get_unread_count",[r.m.IMCMD.BLOCK_MEMBERS]:"v1/conversation/block_member",[r.m.IMCMD.BLOCK_CONVERSATION]:"v1/conversation/block_conversation",[r.m.IMCMD.CHECK_IN_BLOCKLIST]:"v1/blocklist/check",[r.m.IMCMD.SET_BLOCKLIST]:"v1/blocklist/set",[r.m.IMCMD.GET_BLOCKLIST]:"v1/blocklist/get",[r.m.IMCMD.BATCH_UNMARK_MESSAGE]:"v1/message/batch_unmark",[r.m.IMCMD.MARK_MSG_UNREAD_COUNT_REPORT]:"v1/message/report_mark_count",[r.m.IMCMD.MARK_MSG_GET_UNREAD_COUNT]:"v1/message/get_mark_count",[r.m.IMCMD.GET_MESSAGE_INFO_BY_SERVER_ID]:"v1/message/get_by_id",[r.m.IMCMD.CLIENT_BATCH_ACK]:"v1/client/batch_ack",[r.m.IMCMD.AUDIO_RECOGNITION]:"v1/message/audio_recognition",[r.m.IMCMD.BATCH_MARK_CONVERSATION_READ_V3]:"v3/conversation/batch_mark_read",[r.m.IMCMD.GET_USER_MESSAGE]:"v1/message/get_user_message",[r.m.IMCMD.GET_TAG_META_INFO]:"v1/tag/get_meta_info",[r.m.IMCMD.SET_CONVERSATION_TAG]:"v1/conversation/set_tag",[r.m.IMCMD.MANAGE_TAG_META_INFO]:"v1/tag/manage_meta_info",[r.m.IMCMD.GET_CONVERSATIONS_BY_TAG]:"v1/conversation/get_by_tag"};var c,d=n(3539);!function(e){e[e.RequestCreate=0]="RequestCreate",e[e.RequestSerialize=1]="RequestSerialize",e[e.BeforeSend=2]="BeforeSend",e[e.BeforeSendSingleFlight=3]="BeforeSendSingleFlight",e[e.AfterSendSingleFlight=4]="AfterSendSingleFlight",e[e.AfterSend=5]="AfterSend",e[e.ResponseDeserialize=6]="ResponseDeserialize",e[e.SendMethod=7]="SendMethod"}(c||(c={}));const u=function(){let e=1e4;return()=>(e+=1,e)}();class l extends d.mA{constructor(e,t,n,o){super(e),this._retryTimes=0,this.seqId=null!=o?o:u(),this.reqBody=n,this.cmd=t;const r=function(e){var t;return null!==(t=a[e])&&void 0!==t?t:""}(t);let i=this.ctx.option.apiUrl;i.endsWith("/")||(i=`${i}/`),this.url=i+r}get retryTimes(){return this._retryTimes}set retryTimes(e){this._retryTimes=e,this.request&&(this.request.headers=Object.assign(Object.assign({},this.request.headers),this.isRetryHeader))}get isRetryHeader(){return{"is-retry":this.retryTimes>1?"1":"0"}}get logid(){var e,t;return null!==(t=null===(e=this.response)||void 0===e?void 0:e.log_id)&&void 0!==t?t:""}prepareRequest(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){let t=r.m.Request.create({body:this.reqBody,cmd:this.cmd,sequence_id:i.fromNumber(this.seqId),refer:s.HF.refer,token:this.ctx.cachedToken,headers:this.ctx.option.headers,device_id:this.ctx.option.deviceId,sdk_version:s.HF.sdkVersion,build_number:s.HF.buildNumber,inbox_type:e,device_platform:this.ctx.option.devicePlatform,channel:this.ctx.option.channel,device_type:this.ctx.option.deviceType,os_version:this.ctx.option.osVersion,version_code:this.ctx.option.versionCode,auth_type:this.ctx.option.authType,biz:this.ctx.option.biz,access:s.HF.requestAccessName});for(const e of this.ctx.plugin)t=yield e.sendPacket(t);this.request=t}))}}},28862:function(e,t,n){"use strict";n.d(t,{fC:function(){return d},KQ:function(){return u},u_:function(){return _},RQ:function(){return c}});var o=n(69071),r=n(39805),i=n(29938);const s={appId:0,token:"",deviceId:"",userId:"",biz:"",apiUrl:"",frontierUrl:"",fpId:89,appKey:"e0f82475ab9dbf5717d18b4a9c0d7fd0",service:2,method:1,authType:o.m.AuthType.TOKEN_AUTH,inboxType:[0],headers:{},httpHeaders:{},devicePlatform:"web",timeout:2e3,pullInterval:3e4,throttle:100,triggerStrategy:{[i.c5.ConversationChange]:i.zn.Debounce,[i.c5.MessageUpsert]:i.zn.Debounce,[i.c5.ConversationUpsert]:i.zn.ThrottleWithArgs},maxMessageCount:1e3,enableServerConfig:!1};function a(e,t,n){for(const o of Object.keys(n))"string"!=typeof n[o]&&r.Y.ctxError(e,`${t}[${o}] is not a string!`)}function c(e,t){"number"!=typeof t.appId&&r.Y.ctxError(e,"opt.appId is not a number! did you pass a string?"),"string"!=typeof t.deviceId&&r.Y.ctxError(e,"opt.deviceId is not a string! did you pass a number?"),"string"!=typeof t.userId&&r.Y.ctxError(e,"opt.userId is not a string! did you pass a number?"),"string"==typeof t.apiUrl&&0!==t.apiUrl.length||r.Y.ctxError(e,"opt.apiUrl invalid"),"string"==typeof t.frontierUrl&&0!==t.frontierUrl.length||r.Y.ctxError(e,"opt.frontierUrl invalid"),"object"==typeof t.headers&&a(e,"opt.headers",t.headers),"object"==typeof t.httpHeaders&&a(e,"opt.httpHeaders",t.httpHeaders),"object"==typeof t.monitorTagKv&&a(e,"opt.monitorTagKv",t.monitorTagKv),(Array.isArray(t.inboxType)&&(0===t.inboxType.length||t.inboxType.some((e=>e<0)))||"number"==typeof t.inboxType&&t.inboxType<0)&&r.Y.ctxError(e,"opt.inboxType invalid"),"number"==typeof t.pullInterval&&t.pullInterval<5e3&&r.Y.ctxDebug(e,"opt.pullInterval too short")}function d(e){return Object.assign(Object.assign(Object.assign({},s),e),{triggerStrategy:Object.assign(Object.assign({},s.triggerStrategy),e.triggerStrategy)})}function u(e){return Object.assign(Object.assign(Object.assign({debug:!0,boe:!0},s),e),{triggerStrategy:Object.assign(Object.assign({},s.triggerStrategy),e.triggerStrategy)})}var l;!function(e){e.sharkEnabled="sharkEnabled",e.autoFetchMsgEnabled="autoFetchMsgEnabled",e.autoFetchMsgInterval="autoFetchMsgInterval",e.conversationMsgRepairInterval="conversationMsgRepairInterval",e.conversationMsgRepairStart="conversationMsgRepairStart",e.conversationMsgRepairCount="conversationMsgRepairCount",e.conversationMsgRepairRatio="conversationMsgRepairRatio",e.UnreadCountReport="UnreadCountReport",e.autoPollingMsgEnabled="autoPollingMsgEnabled",e.triggerPollingMsgEnabled="triggerPollingMsgEnabled",e.defaultPollingMsgInterval="defaultPollingMsgInterval",e.unmuteWhiteUidsLen="unmuteWhiteUidsLen"}(l||(l={}));const _=[[l.conversationMsgRepairCount,100],[l.conversationMsgRepairInterval,864e5]]},20710:function(e,t,n){"use strict";n.d(t,{W:function(){return l}});var o=n(15727),r=n(69071),i=n(29938),s=n(63090),a=n(39805),c=n(77166),d=n(56329),u=n(3539);class l extends u.mA{constructor(e){super(e)}send(e,t,n={}){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return(yield this.sendWithRawBody(e,t,n)).body}))}sendWithRawBody(e,t,n={}){var l,_,p,v,g,h,f,y,m,b,k,O,x,w,I,C,M,T,R,P,S,E,B,j,A,U,L,N;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=c.u.performanceNow(),D=this.getReqTrackerContext(e);let q;try{if(n.inboxType===undefined&&(n.inboxType=this.resolve(u.Uk.InboxType).getDefaultInboxWithoutCheck()),this.ctx.option.webSocketLevel===i._.PushOnly&&(n.forceHttp=!0),this.ctx.option.webSocketLevel===i._.All&&(n.forceHttp=!1),q=new d.F(this.ctx,t,e),yield q.prepareRequest(n.inboxType),yield this.resolve(u.Uk.NetworkManager).send(q,{maxHttpRetryTimes:!0===n.forceHttp?n.maxRetryTimes:undefined,maxWsRetryTimes:!0===n.forceHttp?0:n.maxRetryTimes,useBeacon:n.useBeacon}),n.useBeacon||q.response===undefined)return r.m.Response.create({});const T=q.response;if(0!==T.status_code){const d=T.status_code;switch(d){case i.NI.Degradation:throw new s.G({ctx:this.ctx,msg:"server degradation",type:i.NI.Degradation,sender:this,logid:null==T?void 0:T.log_id,args:{req:e,resp:T}});case i.NI.InvalidTicket:if(t===r.m.IMCMD.SEND_MESSAGE){const o=e.send_message_body.conversation_id,r=this.resolve(u.Uk.ConversationManager).get(o),c=r.ticket;yield this.resolve(u.Uk.ConversationManager).refreshTicket(r.id);if(c===r.ticket||n.isRetryReq)throw new s.G({ctx:this.ctx,msg:`invalid ticket for conv: ${o}`,type:i.NI.InvalidTicket,sender:this,logid:null==T?void 0:T.log_id,args:{req:e,resp:T}});return a.Y.ctxDebug(this.ctx,"refresh ticket due to invalid"),this.sendWithRawBody(e,t,Object.assign(Object.assign({},n),{isRetryReq:!0}))}break;case i.NI.InvalidToken:case i.NI.ExpiredToken:const x=this.ctx.cachedToken;try{if(this.resolve(u.Uk.NetworkManager).closeWs(!0),""===x||this.ctx.option.authType===r.m.AuthType.SESSION_AUTH){if(n.isRetryReq)throw new s.G({ctx:this.ctx,msg:"invalid session",type:i.NI.TokenFuncError,sender:this,logid:null==T?void 0:T.log_id,args:{req:e,resp:T}});return a.Y.ctxDebug(this.ctx,"http retry due to invalid session"),this.sendWithRawBody(e,t,Object.assign(Object.assign({},n),{isRetryReq:!0,forceHttp:!0}))}{yield this.ctx.resolve(u.Uk.AuthManager).refreshToken();const o=this.ctx.cachedToken;if(x===o||n.isRetryReq)throw new s.G({ctx:this.ctx,msg:`token refresh fail: ${o}`,type:i.NI.TokenFuncError,sender:this,logid:null==T?void 0:T.log_id,args:{req:e,resp:T}});return a.Y.ctxDebug(this.ctx,"refresh token due to invalid"),this.sendWithRawBody(e,t,Object.assign(Object.assign({},n),{isRetryReq:!0}))}}catch(G){throw G.type!==undefined?(G.args=Object.assign(Object.assign({},G.args),{req:e,resp:T}),G):new s.G({ctx:this.ctx,msg:"token refresh func error",type:i.NI.TokenFuncError,innerError:G,sender:this,logid:null==T?void 0:T.log_id,args:{req:e,resp:T}})}default:if(n.ignoreBizError)return this.resolve(u.Uk.Monitor).emitMetrics(c.U.NetworkRequest,{duration:Math.round(c.u.performanceNow()-o),retry_times:null!==(l=null==q?void 0:q.retryTimes)&&void 0!==l?l:0},{imsdk_cmd:t.toString(),imsdk_result:"0",seq_id:null!==(_=null==q?void 0:q.seqId.toString())&&void 0!==_?_:"",conversation_id:D.conversationId,uuid:D.uuid,error_msg:null!==(v=null===(p=null==q?void 0:q.response)||void 0===p?void 0:p.error_desc)&&void 0!==v?v:"",error_code:null!==(f=null===(h=null===(g=null==q?void 0:q.response)||void 0===g?void 0:g.status_code)||void 0===h?void 0:h.toString())&&void 0!==f?f:"",url_path:null!==(y=null==q?void 0:q.url)&&void 0!==y?y:"",net_type:null!==(b=null===(m=null==q?void 0:q.method)||void 0===m?void 0:m.toString())&&void 0!==b?b:"",logid:null!==(k=null==q?void 0:q.logid)&&void 0!==k?k:"",is_retry_req:n.isRetryReq?"1":"0"}),T;throw new s.G({ctx:this.ctx,msg:`${null!==(O=i.NI[d])&&void 0!==O?O:"unknown"}:${T.error_desc}`,type:d,sender:this,logid:null==T?void 0:T.log_id,args:{req:e,resp:T}})}}if(T.body)return this.resolve(u.Uk.Monitor).emitMetrics(c.U.NetworkRequest,{duration:Math.round(c.u.performanceNow()-o),retry_times:null!==(x=q.retryTimes)&&void 0!==x?x:0},{imsdk_cmd:t.toString(),imsdk_result:"1",seq_id:q.seqId.toString(),conversation_id:D.conversationId,uuid:D.uuid,error_msg:"",error_code:"0",url_path:null!==(w=q.url)&&void 0!==w?w:"",net_type:null!==(C=null===(I=q.method)||void 0===I?void 0:I.toString())&&void 0!==C?C:"",logid:null!==(M=T.log_id)&&void 0!==M?M:"",is_retry_req:n.isRetryReq?"1":"0"}),T;throw new s.G({ctx:this.ctx,msg:"no response body",type:i.NI.Unknown,sender:this,logid:null==T?void 0:T.log_id,args:{req:e,resp:T}})}catch(V){if(this.resolve(u.Uk.Monitor).emitMetrics(c.U.NetworkRequest,{duration:Math.round(c.u.performanceNow()-o),retry_times:null!==(T=null==q?void 0:q.retryTimes)&&void 0!==T?T:0},{imsdk_cmd:t.toString(),imsdk_result:"0",seq_id:null!==(R=null==q?void 0:q.seqId.toString())&&void 0!==R?R:"",conversation_id:D.conversationId,uuid:D.uuid,error_msg:null!==(S=null===(P=null==q?void 0:q.response)||void 0===P?void 0:P.error_desc)&&void 0!==S?S:"",error_code:null!==(j=null===(B=null===(E=null==q?void 0:q.response)||void 0===E?void 0:E.status_code)||void 0===B?void 0:B.toString())&&void 0!==j?j:"",url_path:null!==(A=null==q?void 0:q.url)&&void 0!==A?A:"",net_type:null!==(L=null===(U=null==q?void 0:q.method)||void 0===U?void 0:U.toString())&&void 0!==L?L:"",logid:null!==(N=null==q?void 0:q.logid)&&void 0!==N?N:"",is_retry_req:n.isRetryReq?"1":"0"}),V===undefined)throw new s.G({ctx:this.ctx,msg:"unknown error",type:i.NI.Unknown,sender:this,args:{req:e}});throw V.type!==undefined?(V.args=Object.assign(Object.assign({},V.args),{req:e}),V):new s.G({ctx:this.ctx,msg:"request unknown error",type:i.NI.Unknown,innerError:V,sender:this,args:{req:e}})}}))}getReqTrackerContext(e){var t,n,o,r;for(const i of Object.keys(e)){const s=e[i];if(s!==undefined)return{conversationId:null!==(n=null===(t=s.conversation_id)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",uuid:null!==(r=null===(o=s.client_message_id)||void 0===o?void 0:o.toString())&&void 0!==r?r:""}}return{conversationId:"",uuid:""}}}},17390:function(e,t,n){"use strict";n.d(t,{v:function(){return i}});var o=n(15727),r=n(3539);class i extends r.mA{constructor(e){super(e),this.name="BasePlugin"}get instance(){return this.resolve(r.Uk.CoreInstance)}init(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){}))}sendPacket(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e}))}receivePacket(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){}))}ticker(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){}))}extendFunc(e){return e.bind(this)}dispose(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){}))}}},30048:function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var o=n(3539);class r extends o.mA{}},3539:function(e,t,n){"use strict";n.d(t,{mA:function(){return c},jO:function(){return a},hi:function(){return s},Uk:function(){return o}});var o,r=n(28862),i=n(21302);!function(e){e.CoreInstance="coreInstance",e.NetworkManager="netManager",e.ConversationManager="conversationManger",e.MessageManager="messageManager",e.ParticipantManager="participantManager",e.AuthManager="authManager",e.EventBus="eventBus",e.Monitor="montior",e.DbProxy="dbProxy",e.SecurityProxy="securityProxy",e.CoreApi="coreApi",e.InboxType="inboxType",e.HybridLink="hybridLink",e.ExtensionPlugin="extensionPlugin",e.ExtensionApi="extensionApi",e.BroadcastManager="broadcastManager",e.EmojiPlugin="emojiPlugin",e.MetricsPlugin="metricsPlugin",e.MetricsApi="metricsApi",e.MultimediaPlugin="multimediaPlugin",e.MultimediaApi="multimediaApi",e.SharkPlugin="sharkPlugin",e.StoragePlugin="storagePlugin",e.StorageApi="storageApi",e.StrangerPlugin="strangerPlugin",e.StrangerApi="strangerApi"}(o||(o={}));class s{constructor(){this.services=new Map,this.plugins=new Map}register(e,t,n){this.services.has(e)||this.services.set(e,new Map),this.services.get(e).set(t,n)}resolve(e,t){var n;return null===(n=this.services.get(e))||void 0===n?void 0:n.get(t)}get instanceCount(){return this.services.size}}s.Instance=new s;class a{constructor(){this.initResult=0,this.cachedToken="",this.id="",this.config=new Map(r.u_),this.id=(0,i.k)()}get plugin(){var e;return null!==(e=s.Instance.plugins.get(this.id))&&void 0!==e?e:[]}set plugin(e){s.Instance.plugins.set(this.id,e)}register(e,t){let n=t;return"function"==typeof t&&(n=new t(this)),s.Instance.register(this.id,e,n),n}resolve(e){return s.Instance.resolve(this.id,e)}}class c{constructor(e){this.__internal_ctx=e}get ctx(){return this.getContext()}bindContext(e){this.__internal_ctx=e}getContext(){return this.__internal_ctx}resolve(e){return this.getContext().resolve(e)}register(e,t){return this.getContext().register(e,t)}}},65066:function(e,t,n){"use strict";n.d(t,{f:function(){return i}});var o=n(15727),r=n(3539);class i extends r.mA{execute(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){let t=e;return t=yield this.before(t),t=yield this.process(t),t=yield this.after(t),t}))}before(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e}))}after(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e}))}}},9453:function(e,t,n){"use strict";n.d(t,{F3:function(){return r},sS:function(){return s},vM:function(){return i},vP:function(){return c},w9:function(){return a}});var o=n(9267);function r(e,t){return e.length>t?[e.slice(0,t),...r(e.slice(t),t)]:[e]}function i(e,t){const n={};for(const o of e){const e=t(o);n[e]===undefined&&(n[e]=[]),n[e].push(o)}return n}function s(e,t){return Array.isArray(e)?e:e!==undefined?[e]:t!==undefined?[t]:[]}function a(e){return o.fromNumber(e.charCodeAt(0)).add(o.fromNumber(e.charCodeAt(1)).shiftLeft(8)).add(o.fromNumber(e.charCodeAt(2)).shiftLeft(16)).add(o.fromNumber(e.charCodeAt(3)).shiftLeft(24)).add(o.fromNumber(e.charCodeAt(4)).shiftLeft(32)).add(o.fromNumber(e.charCodeAt(5)).shiftLeft(40)).add(o.fromNumber(e.charCodeAt(6)).shiftLeft(48)).add(o.fromNumber(e.charCodeAt(7)).shiftLeft(56))}function c(e,t){return e!==undefined&&t!==undefined&&("true"===e[t]||"1"===e[t])}},21302:function(e,t,n){"use strict";n.d(t,{k:function(){return i}});const o=[];for(let s=0;s<256;++s)o[s]=(s+256).toString(16).substr(1);const r=new Array(16);function i(){const e=function(){for(let e=0,t=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,function(e){let t=0;const n=o;return[n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]]].join("")}(r)}},32137:function(e,t,n){"use strict";n.d(t,{D:function(){return A}});var o=n(15727),r=n(9267),i=n(69071),s=n(29938),a=n(39805),c=n(63090),d=n(3539),u=n(74110),l=n(67466),_=(n(82201),n(21302)),p=n(66145),v=n(17390),g=n(26919),h=n(9453);class f{static fromOp(e,t){var n;const o=new f;return o.conversationId=e.conversationId,o.messageId=e.clientId,o.key=t.key,o.userId=e.ctx.option.userId,o.secUid=e.ctx.option.secUid,o.createTime=new Date(Date.now()),o.idempotentId=t.idempotentId,o.value=null!==(n=t.value)&&void 0!==n?n:"",o.version=e.version,o.status=l.R.Sending,o}static mergeOperationToCurrent(e,t){var n;const o=(0,h.vM)(t,(e=>e.key));for(const r of Object.keys(o))for(const t of o[r]){e.property[r]||(e.property[r]=[]);const o=null===(n=e.property[r])||void 0===n?void 0:n.findIndex((e=>e.idempotentId===t.idempotentId));switch(t.operation){case i.m.OPERATION_TYPE.ADD_PROPERTY_ITEM:-1===o&&e.property[r].push(f.fromOp(e,t));break;case i.m.OPERATION_TYPE.REMOVE_PROPERTY_ITEM:-1!==o&&e.property[r].splice(o,1),0===e.property[r].length&&delete e.property[r];break;case i.m.OPERATION_TYPE.SET_PROPERTY:e.property[r]=[f.fromOp(e,t)];break;case i.m.OPERATION_TYPE.DEL_PROPERTY:delete e.property[r]}}}}var y=n(20710);class m extends y.W{LeaveConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({leave_conversation_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType}});return this.send(t,i.m.IMCMD.LEAVE_CONVERSATION,{inboxType:e.inboxType})}))}DeleteMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({delete_message_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,message_id:e.serverId}});return this.send(t,i.m.IMCMD.DELETE_MESSAGE,{inboxType:e.inboxType})}))}GetMessageByServerId(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_message_by_id_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,server_message_id:e.serverId}});return this.sendWithRawBody(t,i.m.IMCMD.GET_MESSAGE_INFO_BY_SERVER_ID,{inboxType:e.inboxType})}))}MarkConversationDelete(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({delete_conversation_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,last_message_index:e.lastPullIndex,badge_count:e.badgeCount,mute_badge_count_infos:e.muteBadgeCountInfos}});return this.send(t,i.m.IMCMD.MARK_CONVERSATION_DELETE,{inboxType:e.inboxType})}))}AddConversationParticipants(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({conversation_add_participants_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,participants:e.participants,biz_ext:e.bizExt}});return(yield this.send(t,i.m.IMCMD.ADD_CONVERSATION_PARTICIPANTS,{inboxType:e.inboxType})).conversation_add_participants_body}))}GetConversationInfoListByFavoriteV2(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_conversation_info_list_by_favorite_v2_body:{cursor:e.cursor,limit:e.limit}});return this.sendWithRawBody(t,i.m.IMCMD.GET_CONVERSATION_INFO_LIST_BY_FAVORITE_V2,{inboxType:e.inboxType})}))}GetConversationInfoListByTopV2(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_conversation_info_list_by_top_v2_body:{cursor:e.cursor,limit:e.limit}});return this.sendWithRawBody(t,i.m.IMCMD.GET_CONVERSATION_INFO_LIST_BY_TOP_V2,{inboxType:e.inboxType})}))}GetConversationInfoListByTag(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_conversations_by_tag_body:{cursor:e.cursor,limit:e.limit,tag_id:e.tagIds,user_custom_tag_id:e.userCustomTagIds,inbox_type:e.inboxType}});return this.sendWithRawBody(t,i.m.IMCMD.GET_CONVERSATIONS_BY_TAG,{inboxType:e.inboxType})}))}UpdateConversationParticipant(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({update_conversation_participant_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,user_id:e.userId,role:e.role,alias:e.alias,biz_ext:e.bizExt,is_alias_set:Boolean(e.alias)}});return this.sendWithRawBody(t,i.m.IMCMD.UPDATE_CONVERSATION_PARTICIPANT,{inboxType:e.inboxType})}))}SetConversationCoreInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({set_conversation_core_info_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,name:e.name,desc:e.desc,icon:e.icon,notice:e.notice,ext:e.ext,biz_ext:e.bizExt}});return(yield this.send(t,i.m.IMCMD.SET_CONVERSATION_CORE_INFO,{inboxType:e.inboxType})).set_conversation_core_info_body}))}RemoveConversationParticipants(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({conversation_remove_participants_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,participants:e.participants,biz_ext:e.bizExt}});return(yield this.send(t,i.m.IMCMD.REMOVE_CONVERSATION_PARTICIPANTS,{inboxType:e.inboxType})).conversation_remove_participants_body}))}UpsertConversationCoreExtInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({upsert_conversation_core_ext_info_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,ext:e.ext}});return(yield this.send(t,i.m.IMCMD.UPSERT_CONVERSATION_CORE_EXT_INFO,{inboxType:e.inboxType})).upsert_conversation_core_ext_info_body}))}SetConversationSettingInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({set_conversation_setting_info_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,set_stick_on_top:e.stickOnTop,set_mute:e.mute,set_favorite:e.favorite,push_status:e.pushStatus}});return(yield this.send(t,i.m.IMCMD.SET_CONVERSATION_SETTING_INFO,{inboxType:e.inboxType})).set_conversation_setting_info_body}))}UpsertConversationSettingExtInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({upsert_conversation_setting_ext_info_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,ext:e.ext}});return(yield this.send(t,i.m.IMCMD.UPSERT_CONVERSATION_SETTING_EXT_INFO,{inboxType:e.inboxType})).upsert_conversation_setting_ext_info_body}))}GetConversationParticipantsList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({conversation_participants_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,cursor:e.cursor,limit:e.limit}});return this.sendWithRawBody(t,i.m.IMCMD.CONVERSATION_PARTICIPANTS_LIST,{inboxType:e.inboxType})}))}SendUserAction(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({send_user_action_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,action_type:e.actionType,extra:e.extra}});return this.send(t,i.m.IMCMD.SEND_USER_ACTION,{inboxType:e.inboxType})}))}SendInputStatus(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({send_input_status_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,status:e.status,extra:e.extra}});return this.send(t,i.m.IMCMD.SEND_INPUT_STATUS,{inboxType:e.inboxType})}))}DissolveConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({dissolve_conversation_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType}});return this.send(t,i.m.IMCMD.DISSOLVE_CONVERSATION,{inboxType:e.inboxType})}))}ModifyMessageExt(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({modify_message_ext_body:{conversation_short_id:e.conversationShortId,message_id:e.messageId,ticket:e.ticket,ext:e.ext,is_edited:e.isEdit,content:e.content,conversation_type:e.conversationType,message_type:e.messageType,conversation_id:e.conversationId}});return this.send(t,i.m.IMCMD.MODIFY_MESSAGE_EXT,{inboxType:e.inboxType})}))}GetUserConversationList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_conversation_list_body:{con_type:e.type,cursor:e.cursor,limit:e.limit,sort_type:e.sortType,include_role:e.includeRole,exclude_role:e.excludeRole,with_cold:e.withCold,push_status:e.pushStatus}});return this.sendWithRawBody(t,i.m.IMCMD.GET_USER_CONVERSATION_LIST,{inboxType:e.inboxType})}))}UnreadCountReport(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({unread_count_report_body:{conv_unread_count:e.conv.map((e=>({conv_short_id:e.shortId,conversation_type:e.type,unread_count:e.count}))),total_unread_count:e.total}});return this.send(t,i.m.IMCMD.UNREAD_COUNT_REPORT,{inboxType:e.inboxType})}))}BlockConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({block_conversation_body:{conversation_id:e.conversationId,conv_short_id:e.conversationShortId,conversation_type:e.conversationType,block_status:e.status,block_normal_only:e.normalOnly}});return this.send(t,i.m.IMCMD.BLOCK_CONVERSATION,{inboxType:e.inboxType})}))}BlockMember(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({block_members_body:{conversation_id:e.conversationId,conv_short_id:e.conversationShortId,conversation_type:e.conversationType,block_time:e.time,block_status:e.status,biz_ext:e.bizExt}});return(yield this.send(t,i.m.IMCMD.BLOCK_MEMBERS,{inboxType:e.inboxType})).block_members_body}))}GetBlockList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_blocklist_body:{cursor:e.cursor,limit:e.limit}});return(yield this.send(t,i.m.IMCMD.GET_BLOCKLIST,{inboxType:e.inboxType})).get_blocklist_body}))}SetBlockList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({set_blocklist_body:{set_block_list:e.applySet,blocklist:e.blocklist}});return this.send(t,i.m.IMCMD.SET_BLOCKLIST,{inboxType:e.inboxType})}))}CheckInBlockList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({check_in_blocklist_body:{user_to_check:e.userToCheck}});return(yield this.send(t,i.m.IMCMD.CHECK_IN_BLOCKLIST,{inboxType:e.inboxType})).check_in_blocklist_body}))}BroadcastSendMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({broadcast_send_message_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,ticket:e.ticket,message_type:e.type,content:e.content,client_message_id:e.clientId,mentioned_users:e.mentionedUsers,ext:e.ext}});return this.sendWithRawBody(t,i.m.IMCMD.BROADCAST_SEND_MESSAGE,{inboxType:e.inboxType})}))}BroadcastReceiveMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({broadcast_recv_message_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,cursor:e.cursor,limit:e.limit,reverse:e.reverse,pull_type:e.pullType}});return this.sendWithRawBody(t,i.m.IMCMD.BROADCAST_RECV_MESSAGE,{inboxType:e.inboxType})}))}BroadcastUserCounter(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({broadcast_user_counter_body:{conversations:e.conversations.map((e=>({conversation_short_id:e.shortId,conversation_type:e.type})))}});return(yield this.send(t,i.m.IMCMD.BROADCAST_USER_COUNTER)).broadcast_user_counter_body}))}SendP2PMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({send_message_p2p_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,send_type:e.sendType,message_type:e.msgType,content:e.content,client_message_id:e.clientId,ext:e.ext,visible_user:e.visibleUser,invisible_user:e.invisibleUser}});return this.send(t,i.m.IMCMD.SEND_MESSAGE_P2P,{useBeacon:!0,maxRetryTimes:1})}))}ModifyMessageProperty(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({modify_message_property_body:{property_list:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,server_message_id:e.serverId,client_message_id:e.clientId,modify_property_content:e.modifyContent.map((e=>({operation:e.operation,key:e.key,value:e.value,idempotent_id:e.idempotentId})))},ticket:e.ticket}});return(yield this.send(t,i.m.IMCMD.SET_MESSAGE_PROPERTY,{inboxType:e.inboxType})).modify_message_property_body}))}GetUnreadCount(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_unread_count_body:{get_total:e.total,conv_short_id:e.shortIds}});return(yield this.send(t,i.m.IMCMD.GET_UNREAD_COUNT,{inboxType:e.inboxType})).get_unread_count_body}))}MarkMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({mark_message_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,server_message_id:e.serverMessageId,do_action:e.doAction,action_type:e.actionType,sort_time:e.sortTime,tag:e.tag}});return this.send(t,i.m.IMCMD.MARK_MESSAGE,{inboxType:e.inboxType})}))}PullMarkMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({pull_mark_message_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,cursor:e.cursor,limit:e.limit,asc:e.asc,action_type:e.actionType,tag:e.tag}});return this.sendWithRawBody(t,i.m.IMCMD.PULL_MARK_MESSAGE,{inboxType:e.inboxType})}))}GetConversationCoreInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_conversation_core_info_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType}});return this.send(t,i.m.IMCMD.GET_CONVERSATION_CORE_INFO,{inboxType:e.inboxType})}))}BatchUnmarkMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({batch_unmark_message:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,server_message_ids:e.serverMessageIds,action_type:e.actionType,tag:e.tag}});return(yield this.send(t,i.m.IMCMD.BATCH_UNMARK_MESSAGE)).batch_unmark_message}))}MarkMsgUnreadCountReport(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({mark_msg_unread_count_report:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,total_unread_count:e.totalUnreadCount,tag_unread_count:e.tagUnreadCount}});return(yield this.send(t,i.m.IMCMD.MARK_MSG_UNREAD_COUNT_REPORT)).mark_msg_unread_count_report}))}MarkMsgGetUnreadCount(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({mark_msg_get_unread_count:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,get_total:e.getTotal,tags:e.tags}});return(yield this.send(t,i.m.IMCMD.MARK_MSG_GET_UNREAD_COUNT)).mark_msg_get_unread_count}))}ConvertVoiceToText(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({audio_recognition_body:{audio:{content:e.content,uid:e.uid,server_message_id:e.server_message_id,audio_option:e.audioOptions,conv_short_id:e.conv_short_id}}});return this.send(t,i.m.IMCMD.AUDIO_RECOGNITION)}))}GetTagMetaInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const{filterDeletedTag:t}=e,n=i.m.RequestBody.create({get_tag_meta_info_body:{filter_deleted_tag:t}});return this.send(n,i.m.IMCMD.GET_TAG_META_INFO)}))}SetConversationTag(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const{tagIds:t,shortIds:n,isRemove:o,userCustomTagIds:r}=e,s=i.m.RequestBody.create({set_conversation_tag_body:{tag_ids:t,conv_short_ids:n,is_unset:o,user_custom_tag_ids:r,inbox_type:e.inboxType}});return this.send(s,i.m.IMCMD.SET_CONVERSATION_TAG,{})}))}ManageTagMetaInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({manage_tag_meta_info_body:{add_tag_meta_infos:e.addTagMetaInfos,delete_tag_ids:e.deleteTagIds,update_tag_meta_infos:e.updateTagMetaInfos,inbox_type:e.inboxType}});return this.send(t,i.m.IMCMD.MANAGE_TAG_META_INFO,{inboxType:e.inboxType,maxRetryTimes:1})}))}}var b=n(86384);class k extends u.r{constructor(){super(...arguments),this.localIndex=r.ZERO}get isMuted(){return!1}get isStickOnTop(){return!1}get isFavorite(){return!1}get toParticipantUserId(){return undefined}static fromServerConversation(e,t,n){const o=new k(e);return o.id=t.conversation_id,o.shortId=t.conversation_short_id.toString(),o.type=t.conversation_type,o.isOffline=!1,o.coreInfo=new b._(o,t),o}setConversationCursor(e){e>this.localIndex&&(this.localIndex=e),this.localIndex=e}getMessageList(e=(e=>e.visible)){return this.resolve(d.Uk.BroadcastManager).getList(this.id).filter(e)}get unreadCount(){return 0}}class O extends d.mA{constructor(e){super(e),this.messages=new Map,this.conversation=new Map}upsertOnline(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.resolve(d.Uk.ExtensionApi).GetConversationCoreInfo({conversationId:e.id,conversationShortId:r.fromString(e.shortId),conversationType:e.type,inboxType:e.inboxType})).get_conversation_core_info_body;if(!t||!t.conversation_core_info)throw new c.G({ctx:this.ctx,type:s.NI.ConversationNotExist,msg:`local conversation: ${e.id} not found online`,sender:this,args:{conversationId:e.id}});const n=k.fromServerConversation(this.ctx,t.conversation_core_info);return this.conversation.set(e.id,n),n}))}getWithOnline(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function*(){let o=this.conversation.get(e);if(!o||o.isOffline){if(!t||!n)throw new c.G({ctx:this.ctx,type:s.NI.InvalidParam,msg:"no shortId and type provided",sender:this});o||(o=new k(this.ctx),o.id=e,o.shortId=t,o.type=i.m.ConversationType.BROADCAST_CHAT,o.isOffline=!0,o.coreInfo=new b._(o)),o=yield this.upsertOnline(o)}return o}))}upsert(e){const t=this.getConversationMsgs(e.conversationId),n=t.msgs.findIndex((t=>t&&t.clientId===e.clientId));let o;n>=0&&(o=t.msgs[n]),o?o.type===e.type?(e=o.merge(e),t.msgs[n]=e):(a.Y.ctxWarn(this.ctx,"try to merge different msg:",o,e),t.msgs[n]=e):this.insertMsg(t,e),this.resolve(d.Uk.EventBus).emit(s.c5.MessageUpsert,this,e)}getList(e){const t=this.getConversationMsgs(e),n=t.tail;if(t.front<n)return t.msgs.slice(t.front,n);const o=t.msgs.slice(0,n);return t.msgs.slice(t.front,O.MaxMsgSize).concat(o)}insertMsg(e,t){const n=e.tail;e.tail=(e.tail+1)%O.MaxMsgSize,e.tail===e.front&&(e.front=(e.front+1)%O.MaxMsgSize),e.msgs[n]=t}get(e,t){const n=this.getRaw(e,t);if(!n)throw new c.G({ctx:this.ctx,type:s.NI.MessageNotExist,msg:`message ${t} @ ${e} not exist in local`,sender:this});return n}getConversation(e){const t=this.conversation.get(e);if(!t)throw new c.G({ctx:this.ctx,msg:`broadcast conversation ${e} not exist in local`,type:s.NI.ConversationNotExist,sender:this,args:{conversationId:e}});return t}getRaw(e,t){const n=this.getConversationMsgs(e),o=n.msgs.findIndex((e=>e&&e.clientId===t));let r;return o>=0&&(r=n.msgs[o]),r}getByServerId(e,t){const n=this.getConversationMsgs(e),o=n.msgs.findIndex((e=>e&&e.serverId===t));if(o<0)throw new c.G({ctx:this.ctx,type:s.NI.MessageNotExist,msg:`message ${t} @ ${e} not exist in local`,sender:this});return n.msgs[o]}getConversationMsgs(e){let t=this.messages.get(e);return t||(t={msgs:new Array(O.MaxMsgSize),front:0,tail:0},this.messages.set(e,t)),t}processNewMessagesFromPull(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function*(){for(const n of e)n.ext||(n.ext={}),yield this.processNewMessage(n,t)}))}processNewMessage(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(e.ext||(e.ext={}),e.source=t,e.type>=0)return this.processTextMessage(e);throw new c.G({ctx:this.ctx,type:s.NI.UnknownMessageType,msg:`unknown message type: ${e.type} for msg:${e.clientId}`,sender:this})}))}dispose(){this.conversation.clear(),this.messages.clear()}processTextMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!e.isNormalMsg)return e;const t=e.source!==undefined&&(e.source===s.v$.Online||e.source===s.v$.BroadcastLoadMore),n=this.getRaw(e.conversationId,e.clientId),o=(null==n?void 0:n.flightStatus)!==undefined&&t;this.upsert(e);const r=this.getRaw(e.conversationId,e.clientId);return n?o&&r.flightStatus!==s.b3.Received&&(r.flightStatus=s.b3.Received,this.resolve(d.Uk.EventBus).emit(s.c5.ReceiveBroadcastSelfMessage,this,r),this.upsert(r)):t&&(e.sender!==this.ctx.option.userId?this.resolve(d.Uk.EventBus).emit(s.c5.ReceiveBroadcastNewMessage,this,e):this.resolve(d.Uk.EventBus).emit(s.c5.ReceiveBroadcastSelfMessage,this,e)),e}))}}O.MaxMsgSize=1001;var x,w,I,C,M,T=n(65066);class R extends T.f{process(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e.data.type===i.m.MessageType.MESSAGE_TYPE_UPDATE_MESSAGE_PROPERTY&&(e.needContinue=!1,yield this.handlePropertyCmd(e.data)),e}))}handlePropertyCmd(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=this.resolve(d.Uk.MessageManager).getRaw(e.conversationId,e.clientId);t?(t.version=e.version,a.Y.ctxDebug(this.ctx,"merge property, local:",t.property,"server:",e.property),t.property=e.property,this.resolve(d.Uk.MessageManager).upsert(t),this.resolve(d.Uk.EventBus).emit(s.c5.MessagePropertyUpsert,this,t)):a.Y.ctxDebug(this.ctx,"modify property cmd msg not exist in local",e)}))}}!function(e){e[e.BlockUser=1]="BlockUser",e[e.BlockConvNormalOnly=2]="BlockConvNormalOnly",e[e.BlockConvAll=3]="BlockConvAll"}(x||(x={}));class P extends T.f{process(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e.data.type===i.m.MessageType.MESSAGE_TYPE_BLOCK_COMMAND&&(e.needContinue=!1,this.handleBlockCmd(e.data,e.conv)),e}))}handleBlockCmd(e,t){const n=g.parse(e.content),o=n.block_status;if(n.type===x.BlockUser){const{userID:i}=n;if(null===i||i===undefined||0===i.length)return;const a=this.resolve(d.Uk.ParticipantManager).getMapRaw(t.id);if(!a)return;for(const c of i){const i=null==c?void 0:c.toString();if(!a.has(i))continue;const u=a.get(i);u.blocked=Boolean(o);const l=n.blockTime[i];u.leftBlockTime=l?r.fromValue(l):undefined,this.resolve(d.Uk.ParticipantManager).upsert(t.id,u),this.resolve(d.Uk.EventBus).emit(s.c5.ParticipantBlock,this,{participant:u,message:e})}}else this.resolve(d.Uk.ConversationManager).refreshAsync(t).then((t=>{t.map((t=>this.resolve(d.Uk.EventBus).emit(s.c5.ConversationBlock,this,{conversation:t,message:e})))}))}}class S extends T.f{process(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e.data.type===i.m.MessageType.MESSAGE_TYPE_MARK_COMMAND?(e.needContinue=!1,this.handlePinCmd(e.data,e.conv)):e.data.type===i.m.MessageType.MESSAGE_TYPE_BATCH_UNMARK_COMMAND&&(e.needContinue=!1,this.handleBatchUnmarkCmd(e.data,e.conv)),e}))}handlePinCmd(e,t){const n=g.parse(e.content).server_message_id.toString(),o=this.resolve(d.Uk.MessageManager).getByServerIdRaw(t.id,n);o?o.version.gt(e.version)?a.Y.ctxWarn(this.ctx,"server message is older, localMsg=",o,"serverMsg=",e):(o.ext=e.ext,o.version=e.version,this.resolve(d.Uk.MessageManager).upsert(o)):a.Y.ctxWarn(this.ctx,"local message not exist, serverMsg=",e)}handleBatchUnmarkCmd(e,t){var n,o;const r=g.parse(null!==(o=null===(n=null==e?void 0:e.ext)||void 0===n?void 0:n[s.v9.MarkMessageNewExt])&&void 0!==o?o:"{}");for(const i of Object.keys(r)){const n=this.resolve(d.Uk.MessageManager).getByServerIdRaw(t.id,i.toString());n?(n.ext=Object.assign(n.ext,r[i]),n.version=e.version,this.resolve(d.Uk.MessageManager).upsert(n)):a.Y.ctxWarn(this.ctx,"local message not exist, serverMsg=",e)}}}class E{}!function(e){e.Image="image",e.Video="video",e.Audio="audio",e.CommonFile="object"}(w||(w={})),function(e){e.Uri="s:file_ext_key_uri",e.Type="s:file_ext_key_type",e.AppId="s:file_ext_key_source_app_id",e.NeedEncrypt="s:file_ext_key_need_encrypt",e.EncryptUri="s:file_ext_key_encrypt_uri",e.Vid="s:file_ext_key_vid",e.FileName="s:file_ext_key_file_name",e.ImgHeight="s:file_ext_key_original_height",e.ImgWidth="s:file_ext_key_original_width",e.ImgThumbHeight="s:file_ext_key_thumb_height",e.ImgThumbWidth="s:file_ext_key_thumb_width",e.ImgThumbUrl="s:file_ext_key_thumb_url",e.ImgPreviewUrl="s:file_ext_key_preview_url",e.ImgPreviewHeight="s:file_ext_key_preview_height",e.ImgPreviewWidth="s:file_ext_key_preview_width",e.ImgPreviewEncryptUrl="s:file_ext_key_preview_encrypt_url",e.ImgThumbEncryptUrl="s:file_ext_key_thumb_encrypt_url",e.ImgUseImageX="s:file_ext_key_use_imagex",e.ImgSuffix="s:file_ext_key_img_suffix",e.VideoCoverUri="s:file_ext_key_video_cover_uri",e.VideoCoverUrl="s:file_ext_key_video_cover_url",e.VideoDuration="s:file_ext_key_video_duration",e.VideoWidth="s:file_ext_key_video_width",e.VideoHeight="s:file_ext_key_video_height",e.AudioDuration="s:file_ext_key_audio_duration"}(I||(I={})),function(e){e.Image="file_ext_value_type_image",e.Video="file_ext_value_type_video",e.Audio="file_ext_value_type_audio",e.Object="file_ext_value_type_object",e.File="file_ext_value_type_file"}(C||(C={})),function(e){e.Obj="tplv-obj",e.Resize="tplv-resize"}(M||(M={}));class B{static fromServerTag(e){var t;const n=new B;return n.id=e.tag_id.toString(),n.name=e.tag_name,n.ext=null!==(t=e.ext)&&void 0!==t?t:{},n.isDeleted=Boolean(e.status),n}}class j extends T.f{process(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e.data.type===i.m.MessageType.MESSAGE_TYPE_NOTIFY_USER_CUSTOM_CONVERSATION_TAG_UPDATE_COMMAND&&(e.needContinue=!1,this.handle(e)),e}))}handle(e){var t,n;const o=g.parse(e.data.content);this.resolve(d.Uk.EventBus).emit(s.c5.TagListUpdate,this,null!==(n=null===(t=o.user_custom_tag)||void 0===t?void 0:t.map((e=>B.fromServerTag(e))))&&void 0!==n?n:[])}}class A extends v.v{constructor(){super(...arguments),this.name="ExtensionPlugin"}leaveConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.LeaveConversation({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,inboxType:e.conversation.inboxType}),this.resolve(d.Uk.ParticipantManager).delete(e.conversation.id,[this.ctx.option.userId])}))}deleteMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!e.message.serverId)throw new c.G({ctx:this.ctx,type:s.NI.MessageNotReady,msg:`message ${e.message} is not ready`,reachServer:!1,sender:this});try{if(this.resolve(d.Uk.MessageManager).delete(e.message.conversationId,e.message.serverId),e.localOnly)return;const t=this.resolve(d.Uk.ConversationManager).get(e.message.conversationId);yield this.api.DeleteMessage({conversationId:e.message.conversationId,conversationShortId:r.fromString(e.message.conversationShortId),conversationType:e.message.conversationType,serverId:r.fromString(e.message.serverId),inboxType:t.inboxType})}catch(t){a.Y.ctxWarn(this.ctx,"delete message error, may lost server operation",t)}}))}deleteConversation(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){try{const n=e.conversation.lastMessageIndex;if(this.resolve(d.Uk.ConversationManager).delete(e.conversation.id),e.localOnly)return;yield this.api.MarkConversationDelete({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,lastPullIndex:n,inboxType:e.conversation.inboxType,badgeCount:e.conversation.badgeCount,muteBadgeCountInfos:null===(t=e.conversation.muteBadgeCountInfos)||void 0===t?void 0:t.map((e=>({message_type:e.message_type,badge_count:e.badge_count})))})}catch(n){a.Y.ctxWarn(this.ctx,"delete conversation error, may lost server operation",n)}}))}getConversationListByTop(e={}){var t,n,i;return(0,o.__awaiter)(this,void 0,void 0,(function*(){e.inboxType===undefined&&(e.inboxType=this.resolve(d.Uk.InboxType).getDefaultInbox());let o=[];const s=yield this.api.GetConversationInfoListByTopV2({cursor:r.fromValue(null!==(t=e.cursor)&&void 0!==t?t:"0"),limit:null!==(n=e.limit)&&void 0!==n?n:10,inboxType:e.inboxType}),a=null===(i=s.body)||void 0===i?void 0:i.get_conversation_info_list_by_top_v2_body,c=a.conversation_info_list.map((e=>u.r.fromServerConversation(this.ctx,e,s.log_id))).map((e=>this.resolve(d.Uk.ConversationManager).upsert(e)));return o=o.concat(c),{conversation:o,hasMore:null==a?void 0:a.has_more,cursor:null==a?void 0:a.next_cursor}}))}getConversationListByFavorite(e={}){var t,n,i;return(0,o.__awaiter)(this,void 0,void 0,(function*(){e.inboxType===undefined&&(e.inboxType=this.resolve(d.Uk.InboxType).getDefaultInbox());let o=[];const s=yield this.api.GetConversationInfoListByFavoriteV2({cursor:r.fromValue(null!==(t=e.cursor)&&void 0!==t?t:"0"),limit:null!==(n=e.limit)&&void 0!==n?n:10,inboxType:e.inboxType}),a=null===(i=s.body)||void 0===i?void 0:i.get_conversation_info_list_by_favorite_v2_body,c=(null==a?void 0:a.conversation_info_list).map((e=>u.r.fromServerConversation(this.ctx,e,s.log_id))).map((e=>this.resolve(d.Uk.ConversationManager).upsert(e)));return o=o.concat(c),{conversation:o,hasMore:null==a?void 0:a.has_more,cursor:null==a?void 0:a.next_cursor}}))}getConversationListByTag(e={}){var t,n,i,s;return(0,o.__awaiter)(this,void 0,void 0,(function*(){let o=[];const{tagIds:a}=e,{userCustomTagIds:c}=e,l=Array.isArray(a)?a:a?[a]:[],_=Array.isArray(c)?c:c?[c]:[],p=yield this.api.GetConversationInfoListByTag({cursor:r.fromValue(null!==(t=e.cursor)&&void 0!==t?t:"0"),limit:r.fromValue(null!==(n=e.limit)&&void 0!==n?n:10),inboxType:null!==(i=e.inboxType)&&void 0!==i?i:this.resolve(d.Uk.InboxType).getDefaultInbox(),tagIds:l.map((e=>r.fromString(e))),userCustomTagIds:_.map((e=>r.fromString(e)))}),v=null===(s=p.body)||void 0===s?void 0:s.get_conversations_by_tag_body,g=(null==v?void 0:v.conversation_info_list).map((e=>u.r.fromServerConversation(this.ctx,e,p.log_id))).map((e=>this.resolve(d.Uk.ConversationManager).upsert(e)));return o=o.concat(g),{conversation:o,hasMore:null==v?void 0:v.has_more,cursor:null==v?void 0:v.next_cursor}}))}addParticipants(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=Array.isArray(e.participant)?e.participant:[e.participant],i=yield this.api.AddConversationParticipants({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,participants:o.map((e=>r.fromValue(e))),bizExt:e.bizExt,inboxType:e.conversation.inboxType});if(0!==(null==i?void 0:i.status))return{success:!1,failedParticipant:o,payload:e.conversation,checkCode:i.check_code,checkMsg:i.check_message,statusCode:i.status,statusMsg:i.extra_info};return{success:!0,failedParticipant:null!==(n=null===(t=i.failed_participants)||void 0===t?void 0:t.map((e=>e.toString())))&&void 0!==n?n:[],payload:e.conversation,checkCode:i.check_code,checkMsg:i.check_message,statusCode:i.status,statusMsg:i.extra_info}}))}removeParticipants(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){Array.isArray(e.participant)||(e.participant=[e.participant]);const o=e.participant.map((e=>r.fromString("string"==typeof e?e:e.userId))),i=yield this.api.RemoveConversationParticipants({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,participants:o,bizExt:e.bizExt,inboxType:e.conversation.inboxType});if(0!==(null==i?void 0:i.status))return{success:!1,failedParticipant:o.map((e=>e.toString())),body:i,payload:e.conversation,checkCode:i.check_code,checkMsg:i.check_message,statusCode:i.status,statusMsg:i.extra_info};const s=[],a=null!==(n=null===(t=i.failed_participants)||void 0===t?void 0:t.map((e=>e.toString())))&&void 0!==n?n:[];return o.forEach((e=>{a.includes(e.toString())||s.push(e.toString())})),{success:!0,body:i,failedParticipant:a,payload:e.conversation,checkCode:i.check_code,checkMsg:i.check_message,statusCode:i.status,statusMsg:i.extra_info}}))}updateParticipant(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.api.UpdateConversationParticipant({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,role:e.role,alias:e.alias,bizExt:e.bizExt,inboxType:e.conversation.inboxType,userId:r.fromValue(e.userId)}),i=null===(t=null==o?void 0:o.body)||void 0===t?void 0:t.update_conversation_participant_body;if(0===(null==o?void 0:o.status_code)&&(null===(n=null==i?void 0:i.participant)||void 0===n?void 0:n.user_id)&&(null==o?void 0:o.log_id)){return{success:!0,payload:p.Q.fromServerParticipant(this.ctx,i.participant,e.conversation,o.log_id),checkCode:i.check_code,checkMsg:i.check_message,statusCode:o.status_code,statusMsg:i.extra_info,body:i}}return{success:!1,payload:null,checkCode:i.check_code,checkMsg:i.check_message,statusCode:o.status_code,statusMsg:i.extra_info,body:i}}))}setConversationSettingInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.api.SetConversationSettingInfo({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,stickOnTop:e.stickOnTop,mute:e.mute,favorite:e.favorite,inboxType:e.conversation.inboxType,pushStatus:e.pushStatus});return 0!==(null==t?void 0:t.status)?{success:!1,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info}:(yield this.resolve(d.Uk.ConversationManager).refreshAsync(e.conversation),{success:!0,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info})}))}setConversationCoreInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.api.SetConversationCoreInfo({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,name:e.name,desc:e.desc,icon:e.icon,notice:e.notice,ext:e.ext,bizExt:e.bizExt,inboxType:e.conversation.inboxType});return 0!==(null==t?void 0:t.status)?{success:!1,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info}:(yield this.resolve(d.Uk.ConversationManager).refreshAsync(e.conversation),{success:!0,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info})}))}upsertConversationSettingExtInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.api.UpsertConversationSettingExtInfo({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,ext:e.ext,inboxType:e.conversation.inboxType});return 0!==(null==t?void 0:t.status)?{success:!1,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info}:(yield this.resolve(d.Uk.ConversationManager).refreshAsync(e.conversation),{success:!0,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info})}))}setConversationWeakMuteConfig(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=g.stringify({[s.O9]:{white_uids:null!==(t=e.config.whiteUids)&&void 0!==t?t:[],white_msg_types:null!==(n=e.config.whiteMsgTypes)&&void 0!==n?n:[]}});return this.upsertConversationSettingExtInfo({conversation:e.conversation,ext:{[s.v9.PushPartDisableConfig]:o}})}))}upsertConversationCoreExtInfo(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.api.UpsertConversationCoreExtInfo({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,ext:e.ext,inboxType:e.conversation.inboxType});return 0!==(null==t?void 0:t.status)?{success:!1,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info}:(yield this.resolve(d.Uk.ConversationManager).refreshAsync(e.conversation),{success:!0,payload:e.conversation,checkCode:t.check_code,checkMsg:t.check_message,statusCode:t.status,statusMsg:t.extra_info})}))}getConversationParticipants(e){return this.resolve(d.Uk.ParticipantManager).getParticipants(e.conversation)}getConversationParticipantsAsync(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){let o=!0,i=r.ZERO;for(;o;){const s=yield this.getConversationParticipantsByPage({cursor:i,limit:50,conversation:e.conversation});o=null!==(t=null==s?void 0:s.hasMore)&&void 0!==t&&t,i=null!==(n=null==s?void 0:s.cursor)&&void 0!==n?n:r.ZERO}return this.resolve(d.Uk.ParticipantManager).get(e.conversation.id)}))}getConversationParticipantsByPage(e){var t,n,i,s,a,c;return(0,o.__awaiter)(this,void 0,void 0,(function*(){let o=null!==(t=e.cursor)&&void 0!==t?t:r.ZERO;const u=null!==(n=e.limit)&&void 0!==n?n:50,l=yield this.api.GetConversationParticipantsList({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,cursor:o?r.fromValue(o):r.ZERO,limit:u,inboxType:e.conversation.inboxType}),_=null===(s=null===(i=l.body)||void 0===i?void 0:i.conversation_participants_body)||void 0===s?void 0:s.participants_page,v=null!==(a=null==_?void 0:_.has_more)&&void 0!==a&&a;o=null!==(c=null==_?void 0:_.cursor)&&void 0!==c?c:r.ZERO;const g=[];return null==_||_.participants.forEach((t=>{g.push(p.Q.fromServerParticipant(this.ctx,t,e.conversation,l.log_id))})),this.resolve(d.Uk.ParticipantManager).upsertBatch(e.conversation.id,g),this.resolve(d.Uk.ConversationManager).upsert(e.conversation),{participants:g,hasMore:v,cursor:o}}))}sendUserAction(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.SendUserAction({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,extra:e.ext,actionType:e.actionType,inboxType:e.conversation.inboxType})}))}sendInputStatus(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.SendInputStatus({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,extra:e.ext,status:e.status,inboxType:e.conversation.inboxType})}))}sendP2PMessage(e){var t,n,i,s,a;return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.SendP2PMessage({conversationId:e.conversation.id,conversationShortId:r.fromValue(e.conversation.shortId),conversationType:e.conversation.type,sendType:e.sendType,msgType:e.msgType,content:e.content,clientId:(0,_.k)(),ext:null!==(t=e.ext)&&void 0!==t?t:{},visibleUser:null!==(i=null===(n=e.visibleUser)||void 0===n?void 0:n.map((e=>r.fromValue(e))))&&void 0!==i?i:[],invisibleUser:null!==(a=null===(s=e.invisibleUser)||void 0===s?void 0:s.map((e=>r.fromValue(e))))&&void 0!==a?a:[],inboxType:e.conversation.inboxType})}))}dissolveConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.DissolveConversation({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,inboxType:e.conversation.inboxType}),this.resolve(d.Uk.ConversationManager).delete(e.conversation.id),this.resolve(d.Uk.EventBus).emit(s.c5.ConversationDissolve,this,e.conversation),this.resolve(d.Uk.EventBus).emitEmpty(s.c5.ConversationChange,this)}))}upsertMessageExt(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!e.message.serverId)throw new c.G({ctx:this.ctx,type:s.NI.MessageOffline,msg:"message is offline",reachServer:!1,sender:this});for(const n of Object.keys(e.ext))n.startsWith("s:")&&delete e.ext[n];const t=this.resolve(d.Uk.ConversationManager).get(e.message.conversationId);return yield this.api.ModifyMessageExt({conversationShortId:r.fromValue(e.message.conversationShortId),messageId:r.fromValue(e.message.serverId),ext:e.ext,ticket:t.ticket,inboxType:t.inboxType,isEdit:!1}),e.message.ext=Object.assign(e.message.ext,e.ext),this.resolve(d.Uk.MessageManager).upsert(e.message),e.message}))}modifyMessageContent(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!e.message.serverId)throw new c.G({ctx:this.ctx,type:s.NI.MessageOffline,msg:"message is offline",reachServer:!1,sender:this});const o=this.resolve(d.Uk.ConversationManager).get(e.message.conversationId),i=yield this.api.ModifyMessageExt({conversationShortId:r.fromValue(e.message.conversationShortId),messageId:r.fromValue(e.message.serverId),ticket:o.ticket,inboxType:o.inboxType,content:e.content,isEdit:!0,conversationType:o.type,messageType:e.message.type,conversationId:o.id});return(null===(t=null==i?void 0:i.modify_message_ext_body)||void 0===t?void 0:t.ext)&&(e.message.ext=Object.assign(e.message.ext,null===(n=null==i?void 0:i.modify_message_ext_body)||void 0===n?void 0:n.ext)),e.message.content=e.content,this.resolve(d.Uk.MessageManager).upsert(e.message),{message:e.message}}))}modifyMessage(e){var t,n,i;return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!e.message.serverId)throw new c.G({ctx:this.ctx,type:s.NI.MessageOffline,msg:"message is offline",reachServer:!1,sender:this});const o=null!==(t=e.ext)&&void 0!==t?t:{};for(const e of Object.keys(o))e.startsWith("s:")&&delete o[e];e.mentionedUsers&&(o[s.v9.MentionedUser]=e.mentionedUsers.join(","));const a=this.resolve(d.Uk.ConversationManager).get(e.message.conversationId),u=yield this.api.ModifyMessageExt(Object.assign({conversationShortId:r.fromValue(e.message.conversationShortId),conversationType:a.type,messageType:e.message.type,conversationId:a.id,messageId:r.fromValue(e.message.serverId),ticket:a.ticket,inboxType:a.inboxType,ext:o},e.content?{content:e.content,isEdit:!0}:{isEdit:!1}));return(null===(n=null==u?void 0:u.modify_message_ext_body)||void 0===n?void 0:n.ext)&&(e.message.ext=Object.assign(e.message.ext,null===(i=null==u?void 0:u.modify_message_ext_body)||void 0===i?void 0:i.ext)),e.content&&(e.message.content=e.content),this.resolve(d.Uk.MessageManager).upsert(e.message),{message:e.message}}))}getUserConversationList(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(e.inboxType===undefined&&(e.inboxType=this.resolve(d.Uk.InboxType).getDefaultInbox()),e.type!==i.m.ConversationType.GROUP_CHAT&&(e.includeRole!==undefined||e.excludeRole!==undefined))throw new c.G({ctx:this.ctx,type:s.NI.InvalidParam,msg:"role filter only available in group chat",sender:this,reachServer:!1});if(e.includeRole!==undefined&&e.excludeRole!==undefined)throw new c.G({ctx:this.ctx,type:s.NI.InvalidParam,msg:"conflict include and exclude",sender:this,reachServer:!1});const o=yield this.api.GetUserConversationList({type:e.type,cursor:e.cursor?r.fromValue(e.cursor):r.ZERO,limit:e.limit?r.fromValue(e.limit):r.fromNumber(20),sortType:null!==(t=e.sortType)&&void 0!==t?t:i.m.SortType.JOIN_TIME,includeRole:e.includeRole,excludeRole:e.excludeRole,withCold:e.withCold,inboxType:e.inboxType}),a=null===(n=o.body)||void 0===n?void 0:n.get_conversation_list_body,l=a.list.map((e=>u.r.fromServerConversation(this.ctx,e,o.log_id)));return l.forEach((e=>this.resolve(d.Uk.ConversationManager).upsert(e))),{conversation:l,hasMore:null==a?void 0:a.has_more,cursor:null==a?void 0:a.next_cursor}}))}unreadCountReport(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!this.ctx.option.unreadCountReport)throw new c.G({ctx:this.ctx,msg:"unread count report not enabled",sender:this,type:s.NI.InvalidParam,reachServer:!1});const e=this.resolve(d.Uk.ConversationManager).getConversationArray(),t=(0,h.vM)(e,(e=>e.inboxType.toString()));for(const o of Object.keys(t)){const e=t[o],i=[];let s=0;e.forEach((e=>{const t=this.getNormalMsgUnreadCount(e);s+=t,i.push({shortId:r.fromString(e.shortId),count:r.fromNumber(t),type:e.type})}));const c=(0,h.F3)(i,30);for(const t of c)try{yield this.api.UnreadCountReport({total:r.fromValue(s),conv:t,inboxType:Number.parseInt(o,10)})}catch(n){a.Y.ctxWarn(this.ctx,"report unread error:",n,"conv:",e)}}0===e.length&&(yield this.api.UnreadCountReport({total:r.fromValue(0),conv:[],inboxType:this.resolve(d.Uk.InboxType).getDefaultInbox()}))}))}getServerUnreadCountByUser(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){e.inboxType===undefined&&(e.inboxType=this.resolve(d.Uk.InboxType).getDefaultInbox());const o=yield this.api.GetUnreadCount({total:!0,inboxType:e.inboxType,shortIds:[]});return null!==(n=null===(t=null==o?void 0:o.total_unread_count)||void 0===t?void 0:t.toNumber())&&void 0!==n?n:0}))}getServerUnreadCountByConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=new Map,n=(0,h.vM)(e.conversation,(e=>e.inboxType.toString()));for(const e of Object.keys(n)){const o=n[e].map((e=>r.fromString(e.shortId))),i=new Map(n[e].map((e=>[e.shortId,e]))),s=yield this.api.GetUnreadCount({total:!1,shortIds:o,inboxType:Number.parseInt(e,10)});for(const[e,n]of Object.entries(s.conv_unread_count)){const o=(0,h.w9)(e).toString();i.has(o)&&t.set(i.get(o),n.toNumber())}}return t}))}blockConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return e.normalOnly===undefined&&(e.normalOnly=!1),yield this.api.BlockConversation({conversationId:e.conversation.id,conversationShortId:r.fromValue(e.conversation.shortId),conversationType:e.conversation.type,status:e.block?i.m.BlockStatus.BLOCK:i.m.BlockStatus.UNBLOCK,normalOnly:e.normalOnly,inboxType:e.conversation.inboxType}),yield this.resolve(d.Uk.ConversationManager).refreshAsync(e.conversation),e.conversation}))}blockMember(e){var t,n,s;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o={};e.blockDuration!==undefined&&Object.keys(e.blockDuration).forEach((t=>{o[t]=r.fromValue(e.blockDuration[t])}));const a=yield this.api.BlockMember({conversationId:e.conversation.id,conversationShortId:r.fromValue(e.conversation.shortId),conversationType:e.conversation.type,status:e.block?i.m.BlockStatus.BLOCK:i.m.BlockStatus.UNBLOCK,time:o,bizExt:null!==(t=e.bizExt)&&void 0!==t?t:{},inboxType:e.conversation.inboxType}),c=this.resolve(d.Uk.ParticipantManager).getMap(e.conversation.id);for(const t of Object.keys(null!==(n=e.blockDuration)&&void 0!==n?n:{}))if(!(null===(s=null==a?void 0:a.failed_members)||void 0===s?void 0:s.find((e=>r.fromValue(t).eq(e))))&&c.has(t)){const n=c.get(t);n.blocked=e.block,this.resolve(d.Uk.ParticipantManager).upsert(e.conversation.id,n)}return e.conversation}))}getBlockList(e={}){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){e.inboxType===undefined&&(e.inboxType=this.resolve(d.Uk.InboxType).getDefaultInbox());const n=yield this.api.GetBlockList({cursor:e.cursor?r.fromValue(e.cursor):r.ZERO,limit:null!==(t=e.limit)&&void 0!==t?t:20,inboxType:e.inboxType});return{blockList:n.user_info.map((e=>({userId:e.user_id.toString(),createTime:e.create_time.toString()}))),hasMore:null==n?void 0:n.has_more,cursor:null==n?void 0:n.next_cursor}}))}setBlockList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){e.inboxType===undefined&&(e.inboxType=this.resolve(d.Uk.InboxType).getDefaultInbox()),yield this.api.SetBlockList({applySet:e.value,blocklist:e.userId.map((e=>r.fromValue(e))),inboxType:e.inboxType})}))}checkInBlockList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){e.inboxType===undefined&&(e.inboxType=this.resolve(d.Uk.InboxType).getDefaultInbox());return(yield this.api.CheckInBlockList({userToCheck:r.fromValue(e.userId),inboxType:e.inboxType})).in_blocklist}))}broadcastCreateMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=Object.assign({},e.ext),n=l.v.createClientMessage(this.ctx,{type:e.type,content:e.content,ext:t,id:(0,_.k)(),conversationId:e.conversation.id,mentionedUsers:e.mentionedUsers||[],conversationShortId:e.conversation.shortId,conversationType:e.conversation.type});return n.flightStatus=s.b3.Created,n.indexInConversation=e.conversation.lastMessageIndex.add(1),n.orderInConversation=e.conversation.lastMessageOrder.add(1),(e.insert===undefined||e.insert)&&(yield this.resolve(d.Uk.BroadcastManager).processNewMessage(n,s.v$.Offline)),n.sendFunc=this.broadcastSendMessage.bind(this),n}))}broadcastReceiveMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.broadcastReceiveMessageWithType(e);return{msgs:t.msgs,hasMore:t.hasMore,cursor:t.cursor}}))}broadcastUserCounter(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=e.conversation.map((e=>({shortId:r.fromString(e.shortId),type:e.type}))),n=yield this.api.BroadcastUserCounter({conversations:t}),o={};for(const e of n.infos)o[e.conversation_short_id.toString()]=e.counter;return o}))}broadcastGetConversationOnline(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return this.resolve(d.Uk.BroadcastManager).getWithOnline(e.conversationId,e.conversationId,i.m.ConversationType.BROADCAST_CHAT)}))}broadcastGetConversation(e){return this.resolve(d.Uk.BroadcastManager).getConversation(e.conversationId)}modifyMessageProperty(e){var t,n,a,c;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o={success:!1,payload:e.message},u=this.resolve(d.Uk.ConversationManager).getRaw(e.message.conversationId);if(!u)return o;for(const r of e.modifyContent){const o=null!==(n=null===(t=e.message.property[r.key])||void 0===t?void 0:t.findIndex((e=>{var t;return e.idempotentId===(null!==(t=r.idempotentId)&&void 0!==t?t:this.ctx.option.userId)})))&&void 0!==n?n:-1;r.operation||(r.operation=-1===o?i.m.OPERATION_TYPE.ADD_PROPERTY_ITEM:i.m.OPERATION_TYPE.REMOVE_PROPERTY_ITEM)}const _=e.modifyContent.map((e=>{var t;return Object.assign(Object.assign({},e),{idempotentId:null!==(t=e.idempotentId)&&void 0!==t?t:this.ctx.option.userId,operation:e.operation})}));let p;f.mergeOperationToCurrent(e.message,_),this.resolve(d.Uk.MessageManager).upsert(e.message),this.resolve(d.Uk.EventBus).emit(s.c5.MessagePropertyUpsert,this,e.message);try{p=yield this.api.ModifyMessageProperty({conversationId:u.id,conversationShortId:r.fromValue(u.shortId),conversationType:u.type,serverId:r.fromValue(e.message.serverId),clientId:e.message.clientId,ticket:u.ticket,modifyContent:_,inboxType:u.inboxType})}catch(v){o.success=!1,o.statusCode=null==p?void 0:p.status,o.statusMsg=v.msg,o.body=p;for(const t of e.modifyContent){const n=null!==(c=null===(a=e.message.property[t.key])||void 0===a?void 0:a.findIndex((e=>{var n;return e.idempotentId===(null!==(n=t.idempotentId)&&void 0!==n?n:this.ctx.option.userId)})))&&void 0!==c?c:-1;-1!==n&&(e.message.property[t.key][n].status=l.R.Failed)}return this.resolve(d.Uk.MessageManager).upsert(e.message),this.resolve(d.Uk.EventBus).emit(s.c5.MessagePropertyUpsert,this,e.message),o}return[i.m.ModifyMessagePropertyStatus.MODIFY_PROPERTY_SUCCESS,i.m.ModifyMessagePropertyStatus.MODIFY_PROPERTY_REPEAT_REQUEST].includes(null==p?void 0:p.status)&&(o.success=!0),e.message.version=null==p?void 0:p.version,this.resolve(d.Uk.MessageManager).upsert(e.message),this.resolve(d.Uk.EventBus).emit(s.c5.MessagePropertyUpsert,this,e.message),o.checkCode=r.ZERO,o.checkMsg="",o.statusCode=p.status,o.statusMsg="",o.body=p,o}))}markMessage(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=this.resolve(d.Uk.ConversationManager).get(e.message.conversationId);if(e.message.isOffline)throw new c.G({ctx:this.ctx,type:s.NI.InvalidParam,sender:this,msg:"offline message cant be marked",reachServer:!1});yield this.api.MarkMessage({conversationId:e.message.conversationId,conversationShortId:r.fromValue(e.message.conversationShortId),conversationType:e.message.conversationType,serverMessageId:r.fromValue(e.message.serverId),actionType:e.actionType,doAction:null===(t=e.doAction)||void 0===t||t,sortTime:r.fromValue(null!==(n=e.sortTime)&&void 0!==n?n:r.ZERO),tag:e.tag!==undefined?r.fromValue(e.tag):undefined,inboxType:o.inboxType})}))}pullMarkMessage(e){var t,n,i,s,a,c,d,u;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.api.PullMarkMessage({conversationId:null===(t=e.conversation)||void 0===t?void 0:t.id,conversationShortId:(null===(n=e.conversation)||void 0===n?void 0:n.shortId)===undefined?undefined:r.fromValue(e.conversation.shortId),conversationType:null===(i=e.conversation)||void 0===i?void 0:i.type,cursor:r.fromValue(null!==(s=e.cursor)&&void 0!==s?s:r.ZERO),asc:null!==(a=e.ascending)&&void 0!==a&&a,limit:r.fromValue(null!==(c=e.limit)&&void 0!==c?c:50),actionType:e.actionType,tag:e.tag!==undefined?r.fromValue(e.tag):undefined,inboxType:null!==(u=null===(d=e.conversation)||void 0===d?void 0:d.inboxType)&&void 0!==u?u:0}),_=o.body.pull_mark_message_body,p=[];return _.messages.forEach((e=>{const t=l.v.fromServerMessage(this.ctx,e,o.log_id);p.push(t)})),{message:p,msgExtras:_.msg_extras,hasMore:_.has_more,cursor:_.next_cursor}}))}batchUnmarkMessage(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(e.messages===undefined||0===e.messages.length)throw new c.G({ctx:this.ctx,type:s.NI.InvalidParam,msg:"invalid message list",sender:this});const n=yield this.api.BatchUnmarkMessage({conversationId:e.messages[0].conversationId,conversationShortId:r.fromValue(e.messages[0].conversationShortId),conversationType:e.messages[0].conversationType,serverMessageIds:e.messages.map((e=>r.fromValue(e.serverId))),actionType:e.actionType,tag:e.tag!==undefined?r.fromValue(e.tag):undefined});return{success:0===n.status,checkCode:n.check_code,checkMsg:n.check_message,statusCode:null!==(t=n.status)&&void 0!==t?t:-1,body:n,payload:e.messages}}))}markMessageUnreadCountReport(e){var t,n,i;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o={};if(e.tagUnreadCount!==undefined)for(const t of Object.keys(e.tagUnreadCount))o[t]=r.fromNumber(e.tagUnreadCount[t]);const s=yield this.api.MarkMsgUnreadCountReport({conversationId:null===(t=null==e?void 0:e.conversation)||void 0===t?void 0:t.id,conversationShortId:(null===(n=null==e?void 0:e.conversation)||void 0===n?void 0:n.shortId)===undefined?undefined:r.fromValue(null==e?void 0:e.conversation.shortId),conversationType:null===(i=null==e?void 0:e.conversation)||void 0===i?void 0:i.type,totalUnreadCount:e.totalUnreadCount!==undefined?r.fromNumber(e.totalUnreadCount):undefined,tagUnreadCount:o});return{setTotalStatus:s.set_total_status,failedTagList:s.failed_tag_list}}))}markMessageGetUnreadCount(e){var t,n,i,s,a,c;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.api.MarkMsgGetUnreadCount({conversationId:null===(t=null==e?void 0:e.conversation)||void 0===t?void 0:t.id,conversationShortId:(null===(n=null==e?void 0:e.conversation)||void 0===n?void 0:n.shortId)===undefined?undefined:r.fromValue(null==e?void 0:e.conversation.shortId),conversationType:null===(i=null==e?void 0:e.conversation)||void 0===i?void 0:i.type,getTotal:null!==(s=e.getTotal)&&void 0!==s&&s,tags:null===(a=e.tags)||void 0===a?void 0:a.map((e=>r.fromValue(e)))}),d=null!==(c=o.tag_unread_count)&&void 0!==c?c:{},u={};for(const e of Object.keys(d))u[(0,h.w9)(e).toString()]=d[e].toNumber();return{tagUnreadCount:u,totalCount:o.total_count,failedTagList:o.failed_tag_list}}))}getMessageByServerId(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=this.resolve(d.Uk.MessageManager).getByServerIdRaw(e.conversation.id,e.serverMessageId);if(o)return o;try{const o=yield this.api.GetMessageByServerId({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,serverId:r.fromString(e.serverMessageId),inboxType:e.conversation.inboxType}),i=null===(n=null===(t=o.body)||void 0===t?void 0:t.get_message_by_id_body)||void 0===n?void 0:n.msg_info;return i.body?l.v.fromServerMessage(this.ctx,i.body,o.log_id):null}catch(i){return null}}))}getMessageReferenceList(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){let o;if(e.message.isRootReference)o=e.message;else{const r=this.resolve(d.Uk.ConversationManager).get(e.message.conversationId),i=null===(n=null===(t=e.message.referenceInfo)||void 0===t?void 0:t.root_message_id)||void 0===n?void 0:n.toString();if(i===undefined)return[];const s=yield this.getMessageByServerId({conversation:r,serverMessageId:i});if(!s)return[];o=s}const r=[o];return r.push(...this.resolve(d.Uk.MessageManager).getList(o.conversationId).filter((e=>{var t,n;return(null===(n=null===(t=e.referenceInfo)||void 0===t?void 0:t.root_message_id)||void 0===n?void 0:n.toString())===o.serverId}))),r}))}convertVoiceToText(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.serverId))throw new c.G({ctx:this.ctx,type:s.NI.MPInvalidArgument,msg:"message is offline",reachServer:!1,sender:this});if((null==e?void 0:e.type)!==i.m.MessageType.MESSAGE_TYPE_AUDIO)throw new c.G({ctx:this.ctx,type:s.NI.InvalidParam,msg:"message is not audio",reachServer:!1,sender:this});const n=null===(t=JSON.parse(null==e?void 0:e.content))||void 0===t?void 0:t.__files,o=Object.keys(n),{type:a,ext:u}=n[o[0]];if("wav"!==a)throw new c.G({ctx:this.ctx,type:s.NI.InvalidParam,msg:"audio content is not wav",reachServer:!1,sender:this});if(u[s.v9.FileExtKeyAudioAsrText])return e;try{const t=yield this.api.ConvertVoiceToText({content:null==e?void 0:e.content,uid:r.fromValue(this.ctx.option.userId),server_message_id:r.fromValue(null==e?void 0:e.serverId),audioOptions:{vid:u[I.Vid]},conv_short_id:r.fromValue(null==e?void 0:e.conversationShortId)}),{audio:n,check_code:o,check_message:i}=null==t?void 0:t.audio_recognition_body;return o&&i&&(e.ext[s.v9.RecognitionResponseCheckCode]=null==o?void 0:o.toString(),e.ext[s.v9.RecognitionResponseCheckMsg]=null==i?void 0:i.toString()),e.content=null==n?void 0:n.content,this.resolve(d.Uk.MessageManager).upsert(e),e}catch(l){throw new c.G({ctx:this.ctx,type:s.NI.ServerError,msg:"Voice conversion failed",reachServer:!1,sender:this})}}))}getTagList(e={}){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const{filterDeletedTag:t=!0}=e,n=yield this.api.GetTagMetaInfo({filterDeletedTag:t}),{tag_meta_info_list:o,user_conv_tag_limit:r,user_custom_tag_meta_info_list:i,user_conv_custom_tag_limit:s,user_custom_tag_meta_info_limit:a}=n.get_tag_meta_info_body;return{tagList:(o||[]).map((e=>B.fromServerTag(e))),tagLimit:r.toNumber(),userCustomTagList:(i||[]).map((e=>B.fromServerTag(e))),userCustomTagLimit:s.toNumber(),userCustomTagCreateLimit:a.toNumber()}}))}setConversationTag(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const{shortIds:t,tagIds:n,isRemove:o=!1,userCustomTagIds:i}=e,s=Array.isArray(t)?t:[t],a=Array.isArray(n)?n:n?[n]:[],c=Array.isArray(i)?i:i?[i]:[],u=(yield this.api.SetConversationTag({shortIds:s.map((e=>r.fromString(e))),tagIds:a.map((e=>r.fromString(e))),isRemove:o,userCustomTagIds:c.map((e=>r.fromString(e))),inboxType:this.resolve(d.Uk.InboxType).getDefaultInbox()})).set_conversation_tag_body,l=u.failed_conv_short_ids||[],_=[];for(const e of s)if(!l.includes(r.fromString(e))){const t=this.resolve(d.Uk.ConversationManager).getWithShortIdRaw(e);t&&_.push(t)}return yield this.resolve(d.Uk.ConversationManager).refreshAsync(_),{success:!0,payload:null,body:u,failedConversationShortIds:l.map((e=>String(e)))}}))}manageTagMetaInfo(e){var t,n,i,s,a,c,u,l,_,p;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=(yield this.api.ManageTagMetaInfo({addTagMetaInfos:null===(t=e.add)||void 0===t?void 0:t.map((e=>{var t;return{tag_name:e.name,ext:e.ext,init_conv_short_ids:null===(t=e.initConvShortIds)||void 0===t?void 0:t.map((e=>r.fromValue(e)))}})),updateTagMetaInfos:null===(n=e.update)||void 0===n?void 0:n.map((e=>({tag_id:r.fromString(e.id),tag_name:e.name,upsert_ext:e.upsertExt,delete_ext:e.deleteExt}))),deleteTagIds:null===(i=e.delete)||void 0===i?void 0:i.map((e=>r.fromValue(e))),inboxType:null!==(s=e.inboxType)&&void 0!==s?s:this.resolve(d.Uk.InboxType).getDefaultInbox()})).manage_tag_meta_info_body;return{success:!0,payload:null,body:o,addResults:null!==(c=null===(a=o.add_results)||void 0===a?void 0:a.map((e=>{var t,n;return{tagId:e.tag_id.toString(),createSuccess:e.tag_id.neq(r.NEG_ONE),failedConversationShortIds:null!==(n=null===(t=e.failed_conversation_ids)||void 0===t?void 0:t.map((e=>e.toString())))&&void 0!==n?n:[]}})))&&void 0!==c?c:[],deleteFailed:null!==(l=null===(u=o.delete_failed_tag_ids)||void 0===u?void 0:u.map((e=>e.toString())))&&void 0!==l?l:[],updateFailed:null!==(p=null===(_=o.update_failed_tag_ids)||void 0===_?void 0:_.map((e=>e.toString())))&&void 0!==p?p:[]}}))}install(){this.api=new m(this.getContext()),this.ctx.register(d.Uk.BroadcastManager,new O(this.ctx)),this.ctx.register(d.Uk.ExtensionApi,this.api),this.ctx.register(d.Uk.ExtensionPlugin,this),this.instance.deleteConversation=this.extendFunc(this.deleteConversation),this.instance.deleteMessage=this.extendFunc(this.deleteMessage),this.instance.leaveConversation=this.extendFunc(this.leaveConversation),this.instance.getConversationListByTop=this.extendFunc(this.getConversationListByTop),this.instance.getConversationListByFavorite=this.extendFunc(this.getConversationListByFavorite),this.instance.getConversationListByTag=this.extendFunc(this.getConversationListByTag),this.instance.addParticipants=this.extendFunc(this.addParticipants),this.instance.removeParticipants=this.extendFunc(this.removeParticipants),this.instance.updateParticipant=this.extendFunc(this.updateParticipant),this.instance.setConversationSettingInfo=this.extendFunc(this.setConversationSettingInfo),this.instance.setConversationCoreInfo=this.extendFunc(this.setConversationCoreInfo),this.instance.upsertConversationSettingExtInfo=this.extendFunc(this.upsertConversationSettingExtInfo),this.instance.upsertConversationCoreExtInfo=this.extendFunc(this.upsertConversationCoreExtInfo),this.instance.setConversationWeakMuteConfig=this.extendFunc(this.setConversationWeakMuteConfig),this.instance.getConversationParticipants=this.extendFunc(this.getConversationParticipants),this.instance.getConversationParticipantsAsync=this.extendFunc(this.getConversationParticipantsAsync),this.instance.getConversationParticipantsByPage=this.extendFunc(this.getConversationParticipantsByPage),this.instance.sendUserAction=this.extendFunc(this.sendUserAction),this.instance.sendInputStatus=this.extendFunc(this.sendInputStatus),this.instance.upsertMessageExt=this.extendFunc(this.upsertMessageExt),this.instance.modifyMessageContent=this.extendFunc(this.modifyMessageContent),this.instance.modifyMessage=this.extendFunc(this.modifyMessage),this.instance.dissolveConversation=this.extendFunc(this.dissolveConversation),this.instance.modifyMessageProperty=this.extendFunc(this.modifyMessageProperty),this.instance.unreadCountReport=this.extendFunc(this.unreadCountReport),this.instance.getServerUnreadCountByConversation=this.extendFunc(this.getServerUnreadCountByConversation),this.instance.getServerUnreadCountByUser=this.extendFunc(this.getServerUnreadCountByUser),this.instance.getUserConversationList=this.extendFunc(this.getUserConversationList),this.instance.blockConversation=this.extendFunc(this.blockConversation),this.instance.blockMember=this.extendFunc(this.blockMember),this.instance.sendP2PMessage=this.extendFunc(this.sendP2PMessage),this.instance.setBlockList=this.extendFunc(this.setBlockList),this.instance.getBlockList=this.extendFunc(this.getBlockList),this.instance.checkInBlockList=this.extendFunc(this.checkInBlockList),this.instance.broadcastCreateMessage=this.extendFunc(this.broadcastCreateMessage),this.instance.broadcastReceiveMessage=this.extendFunc(this.broadcastReceiveMessage),this.instance.broadcastUserCounter=this.extendFunc(this.broadcastUserCounter),this.instance.broadcastGetConversationOnline=this.extendFunc(this.broadcastGetConversationOnline),this.instance.broadcastGetConversation=this.extendFunc(this.broadcastGetConversation),this.instance.markMessage=this.extendFunc(this.markMessage),this.instance.pullMarkMessage=this.extendFunc(this.pullMarkMessage),this.instance.getMessageByServerId=this.extendFunc(this.getMessageByServerId),this.instance.batchUnmarkMessage=this.extendFunc(this.batchUnmarkMessage),this.instance.markMessageUnreadCountReport=this.extendFunc(this.markMessageUnreadCountReport),this.instance.markMessageGetUnreadCount=this.extendFunc(this.markMessageGetUnreadCount),this.instance.getMessageReferenceList=this.extendFunc(this.getMessageReferenceList),this.instance.convertVoiceToText=this.extendFunc(this.convertVoiceToText),this.instance.getTagList=this.extendFunc(this.getTagList),this.instance.setConversationTag=this.extendFunc(this.setConversationTag),this.instance.manageTagMetaInfo=this.extendFunc(this.manageTagMetaInfo),this.addEventHandler(),this.resolve(d.Uk.MessageManager).injectProcessor(new R(this.ctx)),this.resolve(d.Uk.MessageManager).injectProcessor(new P(this.ctx)),this.resolve(d.Uk.MessageManager).injectProcessor(new S(this.ctx)),this.resolve(d.Uk.MessageManager).injectProcessorBefore(new j(this.ctx))}receivePacket(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){e.cmd===i.m.IMCMD.NEW_BROADCAST_MSG_NOTIFY&&(yield this.receiveBroadcastPacket(e)),e.cmd===i.m.IMCMD.NEW_P2P_MSG_NOTIFY&&(yield this.receiveP2PMessage(e))}))}receiveP2PMessage(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(null===(t=e.body)||void 0===t?void 0:t.has_new_p2p_message_notify){const t=e.body.has_new_p2p_message_notify,n=new E;n.sendType=t.send_type,n.sender=t.sender.toString(),n.secSender=t.sec_sender,n.conversationId=t.conversation_id,n.conversationShortId=t.conversation_short_id.toString(),n.conversationType=t.conversation_type,n.type=t.message_type,n.content=t.content,n.ext=t.ext,n.createTime=new Date(t.create_time.toNumber()),this.resolve(d.Uk.EventBus).emit(s.c5.ReceiveNewP2PMessage,this,n)}}))}receiveBroadcastPacket(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const n=e.body.has_new_message_notify,o=n.message,i=l.v.fromServerMessage(this.ctx,o,e.log_id);i.ext||(i.ext={}),yield this.resolve(d.Uk.BroadcastManager).processNewMessage(i,s.v$.Online);const a=this.resolve(d.Uk.BroadcastManager).getConversation(i.conversationId),c=a.localIndex;if(a.setConversationCursor(n.next_cursor),c.gt(r.ZERO)&&(null===(t=n.previous_cursor)||void 0===t?void 0:t.gt(c))){let e=!0,t=c,n=0;const o=5;for(;e&&n<o;){const o=yield this.broadcastReceiveMessageWithType({conversation:a,cursor:t,limit:50,reverse:!1,pullType:1});e=o.hasMore,t=o.cursor,yield this.resolve(d.Uk.BroadcastManager).processNewMessagesFromPull(o.msgs,s.v$.BroadcastLoadMore,o.log_id),n++}}}))}dispose(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){this.resolve(d.Uk.ParticipantManager).dispose(),this.resolve(d.Uk.BroadcastManager).dispose()}))}addEventHandler(){this.ctx.option.autoReadIndex&&this.resolve(d.Uk.EventBus).subscribe(s.c5.MessageUpsert,(e=>(0,o.__awaiter)(this,void 0,void 0,(function*(){if(e.flightStatus===s.b3.Inflight)return;const t=this.resolve(d.Uk.ConversationManager).getRaw(e.conversationId);if(!t)return;if(0===this.resolve(d.Uk.ParticipantManager).getRaw(t.id).length)return;const n=this.resolve(d.Uk.ParticipantManager).getByUserIdRaw(t.id,e.sender);n&&e.moveReadIndex&&(n.readIndex=e.indexInConversation,n.readOrder=e.orderInConversation,this.resolve(d.Uk.ParticipantManager).upsert(t.id,n),a.Y.ctxDebug(this.ctx,`auto readindex with read:${n.readIndex.toString()} & order:${n.readOrder.toString()}`))})))),this.resolve(d.Uk.EventBus).subscribe(s.c5.ReceiveNewP2PMessage,(e=>(0,o.__awaiter)(this,void 0,void 0,(function*(){if(e.type===i.m.MessageType.MESSAGE_TYPE_READ_COMMAND){const t=this.resolve(d.Uk.ConversationManager).getWithShortIdRaw(e.conversationShortId);if(!t)return;const n=g.parse(e.content),o=r.fromValue(n.P2PSender).toString(),i=this.resolve(d.Uk.ParticipantManager).getByUserIdRaw(t.id,o);if(!i)return;const c=i.readIndex,u=r.fromValue(n.P2PSenderReadIndex);if(c.gte(u))return;i.readIndex=u,this.resolve(d.Uk.ParticipantManager).upsert(t.id,i),this.resolve(d.Uk.EventBus).emit(s.c5.ConversationUpsert,this,t),this.resolve(d.Uk.EventBus).emitEmpty(s.c5.ConversationChange,this),a.Y.ctxDebug(this.ctx,`p2p update ${i.userId} readindex: ${c.toString()} to ${u.toString()}`)}}))))}broadcastReceiveMessageWithType(e){var t,n,i,a,c;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.api.BroadcastReceiveMessage({conversationId:e.conversation.id,conversationShortId:r.fromString(e.conversation.shortId),conversationType:e.conversation.type,cursor:e.cursor?r.fromValue(e.cursor):e.conversation.localIndex,limit:e.limit?r.fromValue(e.limit):r.fromNumber(20),reverse:null!==(t=e.reverse)&&void 0!==t&&t,pullType:null!==(n=e.pullType)&&void 0!==n?n:0,inboxType:e.conversation.inboxType}),u=null===(i=o.body)||void 0===i?void 0:i.broadcast_recv_message_body,_=null!==(c=null===(a=u.messages)||void 0===a?void 0:a.map((e=>l.v.fromServerMessage(this.ctx,e,o.log_id))))&&void 0!==c?c:[];return yield this.resolve(d.Uk.BroadcastManager).processNewMessagesFromPull(_,s.v$.BroadcastLoadMore,o.log_id),u.next_cursor&&e.conversation.setConversationCursor(u.next_cursor),{msgs:_,hasMore:u.has_more,cursor:u.next_cursor,log_id:o.log_id}}))}broadcastSendMessage(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const n=this.resolve(d.Uk.BroadcastManager).getConversation(e.conversationId),o={success:!1,payload:e};e.flightStatus=s.b3.Inflight;try{const a=yield this.api.BroadcastSendMessage({conversationId:e.conversationId,conversationShortId:r.fromString(e.conversationShortId),conversationType:e.conversationType,clientId:e.clientId,content:e.content,ticket:n.ticket,ext:e.ext,type:e.type,mentionedUsers:e.mentionedUsers.map((e=>r.fromString(e))),inboxType:n.inboxType}),c=null===(t=a.body)||void 0===t?void 0:t.broadcast_send_message_body;if(o.body=c,o.checkCode=c.check_code,o.checkMsg=c.check_message,o.statusCode=c.status,o.statusMsg=c.extra_info,this.ctx.option.debug&&(e.ext[s.v9.LocalLogId]=a.log_id),0===c.status){const t=c.server_message_id.toString();e.serverId=t,e.flightStatus=s.b3.Succeeded,o.success=!0,e.isOffline=!1}else e.flightStatus=s.b3.Rejected,c.status===i.m.SendMessageStatus.CHECK_MSG_NOT_PASS_BUT_SELF_VISIBLE&&(e.flightStatus=s.b3.SelfVisible)}catch(a){e.flightStatus=s.b3.Failed}return o}))}getNormalMsgUnreadCount(e){return e.isMuted?0:e.pushStatus===s.Bs.PartAllow?e.unreadCountWithWhiteList:e.unreadCount}}},62586:function(e,t,n){"use strict";n.d(t,{n:function(){return _}});var o=n(17390),r=n(3539),i=n(15727),s=n(30048),a=n(39805),c=n(63090),d=n(29938),u=n(9267);class l extends s.v{constructor(){super(...arguments),this.hasHybridLinkFunction=!0,this.name="AwemeHybridLinkPlugin",this.innerConvListVersion=[],this.innerNextCmdIndex=[],this.innerReadConvListVersion=[]}get coreApi(){return this.resolve(r.Uk.CoreApi)}get inboxType(){return this.resolve(r.Uk.InboxType)}get instance(){return this.resolve(r.Uk.CoreInstance)}getConvListVersion(e){var t;return null!==(t=this.innerConvListVersion[null!=e?e:this.inboxType.getDefaultInbox()])&&void 0!==t?t:u.ZERO}setConvListVersion(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=null!=t?t:this.inboxType.getDefaultInbox(),i=this.innerConvListVersion[o];i&&!i.lt(e)||(a.Y.ctxDebug(this.ctx,`update conv list version for inbox:${o} from ${null==i?void 0:i.toString()} to ${e.toString()}`),this.innerConvListVersion[o]=e,yield null===(n=this.resolve(r.Uk.DbProxy))||void 0===n?void 0:n.saveUserCursor(o,e))}))}getNextCmdIndex(e){var t;return null!==(t=this.innerNextCmdIndex[null!=e?e:this.inboxType.getDefaultInbox()])&&void 0!==t?t:u.ZERO}setNextCmdIndex(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=null!=t?t:this.inboxType.getDefaultInbox(),i=this.innerNextCmdIndex[o];i&&!i.lt(e)||(a.Y.ctxDebug(this.ctx,`update cmd index for inbox:${o} from ${null==i?void 0:i.toString()} to ${e.toString()}`),this.innerNextCmdIndex[o]=e,yield null===(n=this.resolve(r.Uk.DbProxy))||void 0===n?void 0:n.saveUserCursor(o,e))}))}getReadConvListVersion(e){var t;return null!==(t=this.innerReadConvListVersion[null!=e?e:this.inboxType.getDefaultInbox()])&&void 0!==t?t:u.ZERO}setReadConvListVersion(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=null!=t?t:this.inboxType.getDefaultInbox(),i=this.innerReadConvListVersion[o];i&&!i.lt(e)||(a.Y.ctxDebug(this.ctx,`update read conv list version for inbox:${o} from ${null==i?void 0:i.toString()} to ${e.toString()}`),this.innerReadConvListVersion[o]=e,yield null===(n=this.resolve(r.Uk.DbProxy))||void 0===n?void 0:n.saveUserCursor(o,e))}))}getMessagesByUserInit(e={}){var t,n,o,s,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=null!==(t=e.inboxType)&&void 0!==t?t:this.inboxType.getDefaultInbox(),l=e.page;if(!this.inboxType.isValidInbox(i))throw new c.G({ctx:this.ctx,msg:"invalid inbox",type:d.NI.InvalidInboxType,sender:this});const _=yield this.coreApi.GetMessagesByInit({inboxType:i,convLimit:e.convLimit,msgLimit:e.msgLimit,page:l,version:e.versionForNextQuery}),p=null===(n=_.body)||void 0===n?void 0:n.message_by_init,v=null===(o=p.messages)||void 0===o?void 0:o.map((e=>e.conversations)),g=[];null===(s=p.messages)||void 0===s||s.forEach((e=>e.messages&&(null==g?void 0:g.push(...e.messages))));const h=p.has_more,f=p.next_init_version,y=_.log_id;return this.instance.processInitConversation(v,y),yield this.instance.processInitMessage(g,y),e.versionForNextQuery||(yield this.setConvListVersion(p.version,i),yield this.setNextCmdIndex(null!==(a=p.cmd_index)&&void 0!==a?a:u.ZERO,i),yield this.setReadConvListVersion(p.readconv_version,i)),this.resolve(r.Uk.EventBus).emitEmpty(d.c5.InitLoadPage,this),{hasMore:h,page:(null!=l?l:0)+1,versionForNextQuery:f}}))}getMessagesByUser({inboxType:e,source:t,convVersion:n,cmdIndex:o,readVersion:s}={}){var l,_,p;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e===undefined&&(e=this.inboxType.getDefaultInbox()),!this.inboxType.isValidInbox(e))throw new c.G({ctx:this.ctx,msg:"invalid inbox",type:d.NI.InvalidInboxType,sender:this});if(!0===this.ctx.option.disableInitPull&&0===this.instance.getConversationList().length&&this.getConvListVersion(e).eq(u.ZERO))return void a.Y.ctxWarn(this.ctx,"try to pull history from 0, preventing");let i=void 0!==n?u.fromValue(n):this.getConvListVersion(e),v=void 0!==o?u.fromValue(o):this.getNextCmdIndex(e),g=void 0!==s?u.fromValue(s):this.getReadConvListVersion(e);for(;i||v||g;){const n=yield this.coreApi.GetUserMessage({inboxType:e,version:i,cmdIndex:v,readVersion:g,source:null!=t?t:""}),o=null===(l=n.body)||void 0===l?void 0:l.get_user_message,s=o.messages,a=o.cmd_messages,c=o.read_info;if(s){if(i=s.has_more?s.next_conversation_version:undefined,s.messages)for(const e of s.messages){yield this.resolve(r.Uk.MessageManager).processNewMessagesFromPull(e.messages,d.v$.UserInbox,n.log_id);const t=this.resolve(r.Uk.ConversationManager).getRaw(e.conversation_id.toString());this.instance.handleBadgeCount({badge_count:e.badge_count,mute_badge_count_info:e.mute_badge_count_infos},t)}yield this.setConvListVersion(s.next_conversation_version,e)}else i=undefined;if(a?(v=a.has_more&&a.next_cmd_index?a.next_cmd_index:undefined,(null===(_=a.messages)||void 0===_?void 0:_.length)&&(yield this.instance.processInitMessage(a.messages,n.log_id),a.next_cmd_index&&(yield this.setNextCmdIndex(a.next_cmd_index,e)))):v=undefined,c){if(g=c.has_more?c.next_version:undefined,c.read_info)for(const e of c.read_info)this.resolve(r.Uk.ConversationManager).markRead(e.ConversationShortId.toString(),e.read_index,e.read_badge_count.toNumber(),null!==(p=e.mute_read_badge_count_infos)&&void 0!==p?p:[]);yield this.setReadConvListVersion(c.next_version,e)}else g=undefined;this.instance.initResult===d.rb.Start&&this.resolve(r.Uk.EventBus).emitEmpty(d.c5.InitLoadPage,this)}this.resolve(r.Uk.ConversationManager).refreshLocal()}))}prepareHistoryForInbox({inboxType:e,convLimit:t,msgLimit:n,convTotal:o}){var s,c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{if(this.ctx.option.disableInitPull){a.Y.ctxDebug(this.ctx,`load history for inbox ${e} by disable init`);const o=yield this.coreApi.GetMessagesByInit({inboxType:e,convLimit:t,msgLimit:n}),r=null===(s=o.body)||void 0===s?void 0:s.message_by_init;return yield this.setConvListVersion(r.version,e),yield this.setNextCmdIndex(null!==(c=r.cmd_index)&&void 0!==c?c:u.ZERO,e),yield this.setReadConvListVersion(r.readconv_version,e),!0}a.Y.ctxDebug(this.ctx,`load history for inbox ${e} by full init`);let i={hasMore:!0,page:0,versionForNextQuery:undefined};for(;i.hasMore&&(i=yield this.getMessagesByUserInit(Object.assign({inboxType:e,convLimit:t,msgLimit:n},i)),!(o&&this.resolve(r.Uk.ConversationManager).getConversationArray().length>=o)););return yield this.getMessagesByUser({inboxType:e,source:"init"}),!0}catch(i){return a.Y.ctxError(this.ctx,`load history failed for inbox:${e}`,i),!1}}))}receivePacket(e){var t,n,o,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e;let c=!1;const d=e.inbox_type,l=null===(t=i.body)||void 0===t?void 0:t.has_new_message_notify;this.resolve(r.Uk.InboxType).getInboxTypeArray().includes(d)?(l?(null===(n=null==l?void 0:l.conversation_version)||void 0===n?void 0:n.neq(u.ZERO))?c||(c=yield this.parseConvVersion(l,d,i)):(null===(o=null==l?void 0:l.cmd_message_index)||void 0===o?void 0:o.neq(u.ZERO))?c||(c=yield this.parseCmdIndex(l,d,i)):(null===(s=null==l?void 0:l.readconv_version)||void 0===s?void 0:s.neq(u.ZERO))?c||(c=yield this.parseReadConvVersion(l,d,i)):a.Y.ctxWarn(this.ctx,`push body doesn't match any link, skip, logid:${i.log_id}`):(c=!0,a.Y.ctxWarn(this.ctx,`push body is missing, logid:${i.log_id}`)),c&&(yield this.getMessagesByUser({inboxType:i.inbox_type,source:"cursor"}))):a.Y.ctxDebug(this.ctx,`inbox type ${d} mismatch, drop, logid:${i.log_id}`)}))}parseConvVersion(e,t,n){var o,r,s,c,d,l;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=null!==(o=null==e?void 0:e.conversation_version)&&void 0!==o?o:u.ZERO,_=null!==(r=null==e?void 0:e.previous_conversation_version)&&void 0!==r?r:u.ZERO,p=this.getConvListVersion(t);let v=!1;return(null==p?void 0:p.lt(_))||(null==_?void 0:_.eq(u.ZERO))?(v=!0,a.Y.ctxWarn(this.ctx,`inbox ${t} push previousConvVersion is greater than local clientConvVersion, push:${_}, local:${p}, msgid:${null===(s=e.message)||void 0===s?void 0:s.server_message_id}, logid:${n.log_id}`)):this.ctx.option.triggerPullWhenReceiveEmptyContent&&!(null===(c=e.message)||void 0===c?void 0:c.content)?(v=!0,a.Y.ctxWarn(this.ctx,`receive empty content push, msgid:${null===(d=e.message)||void 0===d?void 0:d.server_message_id}, logid:${n.log_id}`)):((null==p?void 0:p.gt(_))&&a.Y.ctxWarn(this.ctx,`inbox ${t} push previousConvVersion is lower than local clientConvVersion, push:${_}, local:${p}, msgid:${null===(l=e.message)||void 0===l?void 0:l.server_message_id}, logid:${n.log_id}`),yield this.instance.processPushMessage(e,n),yield this.setConvListVersion(i,t)),v}))}parseCmdIndex(e,t,n){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.cmd_message_index;if(!i)return!1;const s=this.getNextCmdIndex(t);let c=!1;return i&&i.gt(s)?(c=!0,a.Y.ctxWarn(this.ctx,`inbox ${t} push serverCmdIndex is greater than expected , push:${i}, expect:${s}, msgid:${null===(o=e.message)||void 0===o?void 0:o.server_message_id}, logid:${n.log_id}`)):(null==s?void 0:s.eq(i))?(yield this.instance.processPushMessage(e,n),yield this.setNextCmdIndex(i.add(1),t)):a.Y.ctxWarn(this.ctx,`inbox ${t} push serverCmdIndex is lower than expected , push:${i}, local:${s}, msgid:${null===(r=e.message)||void 0===r?void 0:r.server_message_id}, logid:${n.log_id}`),c}))}parseReadConvVersion(e,t,n){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const r=e.readconv_version,i=e.pre_readconv_version;if(!r||!i)return!1;const s=this.getReadConvListVersion(t);let c=!1;return i.eq(s)||(a.Y.ctxWarn(this.ctx,`inbox ${t} push serverPreReadConvVersion is not equal clientReadConvVersion , push:${i}, local:${s}, msgid:${null===(o=e.message)||void 0===o?void 0:o.server_message_id}, logid:${n.log_id}`),c=!0),yield this.setReadConvListVersion(r,t),c}))}getReportParams(e){return Object.assign({hybrid_type:"aweme"},void 0!==e?{conv_list_version:this.getConvListVersion(e).toString(),cmd_index:this.getNextCmdIndex(e).toString(),read_conv_list_version:this.getReadConvListVersion(e).toString()}:{})}}class _ extends o.v{constructor(){super(...arguments),this.name="AwemeHybridLinkPlugin"}install(){this.hybridLinkInstance=new l(this.ctx),this.register(r.Uk.HybridLink,this.hybridLinkInstance)}}},75303:function(e,t,n){"use strict";n.d(t,{b:function(){return u}});var o,r=n(15727),i=(n(9267),n(29938)),s=n(39805),a=n(77166),c=n(3539),d=(n(26919),n(82201),n(17390));!function(e){e.MultimediaMessageUpload="imsdk_upload_msg",e.InitHandler="imsdk_init_handler",e.Exception="imsdk_exception",e.SaveMessageError="imsdk_save_msg_error",e.MessageAck="imsdk_message_ack"}(o||(o={}));class u extends d.v{constructor(){super(...arguments),this.name="MetricsPlugin",this.ignoreMethods=["getStrangerTotalUnread","getLocalStrangerConversation","checkRtcRequirements","parseContent","unreadCountReport","getMessageReferencedInfo","initAdapter","getConversationParticipants","broadcastGetConversation","getConversationMessages","createMessage","createTextMessage","createFileMessage","sendMessage","getMessageReadReceipt","createConversation","getConversationOnline","getConversationListOnline","getStrangerPreview","emojify","randomEmoji","getAllEmoji","constructor","getUserCursor","setUserCursor","init","getConversation","getConversationList","dispose","intervalFunc","receivePacket","messageFilter","sendMessageObject","tickerUpdate","prepareHistoryForInbox","prepareToken","clearCache","resolve","getContext","processInitMessage","processInitConversation","patchMessage","clientAck","handleBadgeCount","calcBadgeCount","processPushMessage"]}beforeHook(e,t){if(this.ctx.option.aspectBefore)return this.ctx.option.aspectBefore({name:e,params:t})}afterHook(e,t,n,o){const r=this.resolve(c.Uk.Monitor).emitDuration(a.U.BizApiInvoke+a.U.SuccessSuffix,n,{name:e});this.ctx.option.aspectAfter&&this.ctx.option.aspectAfter({name:e,params:t,duration:r,result:o})}errorHook(e,t,n,o){const r=this.resolve(c.Uk.Monitor).emitDuration(a.U.BizApiInvoke+a.U.ErrorSuffix,o,{name:e,error:n.type?`${n.type}:${i.NI[n.type]}`:"unknown"});if(this.ctx.option.aspectError){const o=this.ctx.option.aspectError({name:e,params:t,duration:r,error:n});return o===undefined||Boolean(o)}return!0}wrapMetricsAsync(e,t){let n=0;return o=>(0,r.__awaiter)(this,void 0,void 0,(function*(){try{if(!1===this.beforeHook(e,o))return;n=a.u.performanceNow();const r=yield t.call(this.instance,o);return this.afterHook(e,o,n,r),r}catch(r){const t=this.errorHook(e,o,r,n);if(t)throw r}}))}getFuncs(){let e=[];const{instance:t}=this,n=Object.getOwnPropertyNames(t);e=e.concat(n);const o=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(o);e=e.concat(r);const i=Object.getOwnPropertyNames(Object.getPrototypeOf(o));return e=e.concat(i),e.filter((e=>"function"==typeof this.instance[e]&&!this.ignoreMethods.includes(e)&&!e.startsWith("__internal")))}install(){this.register(c.Uk.MetricsPlugin,this),this.ctx.option.monitor=this.unifyMonitorConfig();const e=this.instance,t=this.getFuncs();for(const n of t){const t=e[n];s.Y.ctxDebug(this.ctx,`wrapping metrics for ${n}`),e[n]=this.wrapMetricsAsync(n,t)}this.subscribeTrackerEvent()}receivePacket(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){}))}subscribeTrackerEvent(){this.resolve(c.Uk.EventBus).subscribe(i.c5.Error,(e=>{this.resolve(c.Uk.Monitor).emitTracker(o.Exception,{error_stack:e.stack})})),this.resolve(c.Uk.EventBus).subscribe(i.c5.InitFinish,(e=>{const t=this.instance.getConversationList(),n=t.map((e=>e.getMessageList().length)).reduce(((e,t)=>e+t),0);this.resolve(c.Uk.Monitor).emitTracker(o.InitHandler,{conv_count:t.length,total_msg_count:n,is_success:"1"})}))}unifyMonitorConfig(){const e=this.ctx.option.monitor;return Array.isArray(e)?e:e!==undefined?(this.ctx.option.monitor=[e],this.ctx.option.monitor):(this.ctx.option.monitor=[],this.ctx.option.monitor)}}},26276:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});n(9267);var o=n(29938),r=n(39805);n(26919),n(82201);class i{constructor(e){this.errorTypeBlacklist=[o.NI.NetworkError],this.slardar=e}emitError(e,t){"function"==typeof this.slardar.captureException&&(this.errorTypeBlacklist.includes(e.type)||this.slardar.captureException(e,Object.assign(Object.assign({},t),{type:`${e.type}:${o.NI[e.type]}`,msg:e.msg,logid:e.logid,args:e.args})))}emitNetwork(e,t,n){t!==undefined&&0!==t.status_code&&this.slardar.sendLog({level:"error",content:`Response Error:${t.status_code}, cmd: ${t.cmd} msg: ${t.error_desc}, logid: ${t.log_id}`,extra:Object.assign({cmd:`${t.cmd}`},n)})}emitEvent(e,t,n){}emitLog(e,t){if(e===r.h.debug)return;const n={};t.forEach(((e,t)=>{n[t]=e})),this.slardar.sendLog({level:r.h[e],content:t.join(","),extra:Object.assign({},n)})}emitTracker(e,t){this.slardar.sendLog({level:"debug",content:e,extra:t})}emitMetrics(e,t={},n={}){}}},638:function(e,t,n){"use strict";n.d(t,{Dp:function(){return s},Cu:function(){return c},af:function(){return i}});n(9267);var o=n(77166);n(26919),n(82201);class r{constructor(e=[],t){this.metricsToReport=[],this.sampleRate={},this.call=e=>{if(!this.metricsToReport.includes(e))return!1;const t=this.sampleRate[e],n=this.sampleRate[r.globalSampleRate],o=Math.random();return void 0!==t?o<t:void 0===n||o<n},this.metricsToReport=e,t&&(this.sampleRate=t)}}function i(e){return(e.startsWith("imsdk")?e:`imsdk_${e}`).replace(/\./g,"_")}r.globalSampleRate="__globalSampleRate";const s=[o.U.CreateConversation,o.U.SendMessage,o.U.ReceiveMessage,o.U.WsConnect,o.U.NetworkRequest].map((e=>i(e))),a={[i(o.U.NetworkRequest)]:.05,[r.globalSampleRate]:1};class c{constructor(e,t){var n,o;this.sampleCallback=()=>!0,this.collector=e,(null==t?void 0:t.sampleCallback)?this.sampleCallback=t.sampleCallback:this.sampleCallback=new r(null!==(n=null==t?void 0:t.metricsToReport)&&void 0!==n?n:s,null!==(o=null==t?void 0:t.sampleRate)&&void 0!==o?o:a).call}emitCounter(e,t,n){}emitDuration(e,t,n){}emitError(e){}emitNetwork(e,t,n){}emitEvent(e,t,n){}emitLog(e,t){}emitTracker(e,t){}emitMetrics(e,t,n){var o;const r=i(e);(null===(o=this.sampleCallback)||void 0===o?void 0:o.call(this,r))&&this.collector.event(r,Object.assign(Object.assign({},t),n))}}c.globalSampleRate=r.globalSampleRate},69071:function(e,t,n){"use strict";n.d(t,{m:function(){return u}});var o=n(40818),r=n(9267),i=n.n(r);o.util.Long=i(),o.configure();const s=o.Reader,a=o.Writer,c=o.util,d=o.roots.default||(o.roots.default={}),u=d.im_proto=(()=>{const e={};return e.Frame=function(){function e(e){if(this.headers=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seqid=c.Long?c.Long.fromBits(0,0,!0):0,e.prototype.logid=c.Long?c.Long.fromBits(0,0,!0):0,e.prototype.service=0,e.prototype.method=0,e.prototype.headers=c.emptyArray,e.prototype.payload_encoding="",e.prototype.payload_type="",e.prototype.payload=c.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).uint64(e.seqid),t.uint32(16).uint64(e.logid),t.uint32(24).int32(e.service),t.uint32(32).int32(e.method),null!=e.headers&&e.headers.length)for(var n=0;n<e.headers.length;++n)d.im_proto.Frame.ExtendedEntry.encode(e.headers[n],t.uint32(42).fork()).ldelim();return null!=e.payload_encoding&&Object.hasOwnProperty.call(e,"payload_encoding")&&t.uint32(50).string(e.payload_encoding),null!=e.payload_type&&Object.hasOwnProperty.call(e,"payload_type")&&t.uint32(58).string(e.payload_type),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(66).bytes(e.payload),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.Frame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.seqid=e.uint64();break;case 2:o.logid=e.uint64();break;case 3:o.service=e.int32();break;case 4:o.method=e.int32();break;case 5:o.headers&&o.headers.length||(o.headers=[]),o.headers.push(d.im_proto.Frame.ExtendedEntry.decode(e,e.uint32()));break;case 6:o.payload_encoding=e.string();break;case 7:o.payload_type=e.string();break;case 8:o.payload=e.bytes();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("seqid"))throw c.ProtocolError("missing required 'seqid'",{instance:o});if(!o.hasOwnProperty("logid"))throw c.ProtocolError("missing required 'logid'",{instance:o});if(!o.hasOwnProperty("service"))throw c.ProtocolError("missing required 'service'",{instance:o});if(!o.hasOwnProperty("method"))throw c.ProtocolError("missing required 'method'",{instance:o});return o},e.ExtendedEntry=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(10).string(e.key),t.uint32(18).string(e.value),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.Frame.ExtendedEntry;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.key=e.string();break;case 2:o.value=e.string();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("key"))throw c.ProtocolError("missing required 'key'",{instance:o});if(!o.hasOwnProperty("value"))throw c.ProtocolError("missing required 'value'",{instance:o});return o},e}(),e}(),e.IMCMD=function(){const e={},t=Object.create(e);return t[e[100]="SEND_MESSAGE"]=100,t[e[200]="GET_MESSAGES_BY_USER"]=200,t[e[203]="GET_MESSAGES_BY_USER_INIT_V2"]=203,t[e[211]="GET_MESSAGE_INFO_BY_SERVER_ID"]=211,t[e[301]="GET_MESSAGES_BY_CONVERSATION"]=301,t[e[302]="GET_MESSAGES_CHECKINFO_IN_CONVERSATION"]=302,t[e[410]="SEND_USER_ACTION"]=410,t[e[411]="SEND_INPUT_STATUS"]=411,t[e[500]="NEW_MSG_NOTIFY"]=500,t[e[504]="NEW_P2P_MSG_NOTIFY"]=504,t[e[505]="NEW_BROADCAST_MSG_NOTIFY"]=505,t[e[603]="MARK_CONVERSATION_DELETE"]=603,t[e[609]="CREATE_CONVERSATION_V2"]=609,t[e[610]="GET_CONVERSATION_INFO_LIST_V2"]=610,t[e[611]="GET_CONVERSATION_INFO_LIST_BY_FAVORITE_V2"]=611,t[e[612]="GET_CONVERSATION_INFO_LIST_BY_TOP_V2"]=612,t[e[614]="DISSOLVE_CONVERSATION"]=614,t[e[615]="GET_CONVERSATIONS_CHECKINFO"]=615,t[e[605]="CONVERSATION_PARTICIPANTS_LIST"]=605,t[e[650]="ADD_CONVERSATION_PARTICIPANTS"]=650,t[e[651]="REMOVE_CONVERSATION_PARTICIPANTS"]=651,t[e[652]="LEAVE_CONVERSATION"]=652,t[e[654]="MGET_CONVERSATION_PARTICIPANTS"]=654,t[e[655]="UPDATE_CONVERSATION_PARTICIPANT"]=655,t[e[701]="DELETE_MESSAGE"]=701,t[e[702]="RECALL_MESSAGE"]=702,t[e[705]="SET_MESSAGE_PROPERTY"]=705,t[e[901]="GET_CONVERSATION_CORE_INFO"]=901,t[e[902]="SET_CONVERSATION_CORE_INFO"]=902,t[e[904]="UPSERT_CONVERSATION_CORE_EXT_INFO"]=904,t[e[921]="SET_CONVERSATION_SETTING_INFO"]=921,t[e[922]="UPSERT_CONVERSATION_SETTING_EXT_INFO"]=922,t[e[1001]="GET_STRANGER_CONVERSATION_LIST"]=1001,t[e[1002]="GET_STRANGER_MESSAGES_IN_CONVERSATION"]=1002,t[e[1003]="DELETE_STRANGER_MESSAGE"]=1003,t[e[1004]="DELETE_STRANGER_CONVERSATION"]=1004,t[e[1005]="DELETE_ALL_STRANGER_CONVERSATIONS"]=1005,t[e[1006]="MARK_STRANGER_CONVERSATION_READ"]=1006,t[e[1007]="MARK_ALL_STRANGER_CONVERSATIONS_READ"]=1007,t[e[1099]="STRANGER_NEW_MSG_NOTIFY"]=1099,t[e[2e3]="GET_CONVERSATION_PARTICIPANTS_READ_INDEX_V3"]=2e3,t[e[2001]="GET_CONVERSATION_PARTICIPANTS_MIN_INDEX_V3"]=2001,t[e[2002]="MARK_CONVERSATION_READ_V3"]=2002,t[e[2003]="GET_MEDIA_UPLOAD_TOKEN"]=2003,t[e[2004]="GET_MEDIA_URLS"]=2004,t[e[2005]="GET_TICKET"]=2005,t[e[2006]="GET_USER_CONVERSATION_LIST"]=2006,t[e[2007]="BROADCAST_SEND_MESSAGE"]=2007,t[e[2008]="BROADCAST_RECV_MESSAGE"]=2008,t[e[2009]="BROADCAST_USER_COUNTER"]=2009,t[e[2010]="CLIENT_ACK"]=2010,t[e[2011]="CREATE_VOIP"]=2011,t[e[2012]="CALL_VOIP"]=2012,t[e[2013]="UPDATE_VOIP"]=2013,t[e[2014]="HEARTBEAT_CHANNEL"]=2014,t[e[2015]="PROFILE_GET_INFO"]=2015,t[e[2016]="REPORT_CLIENT_METRICS"]=2016,t[e[2017]="GET_CONFIGS"]=2017,t[e[2021]="MODIFY_MESSAGE_EXT"]=2021,t[e[2018]="UNREAD_COUNT_REPORT"]=2018,t[e[2019]="BLOCK_MEMBERS"]=2019,t[e[2020]="BLOCK_CONVERSATION"]=2020,t[e[2030]="GET_UNREAD_COUNT"]=2030,t[e[2031]="SEND_MESSAGE_P2P"]=2031,t[e[2032]="GET_BLOCKLIST"]=2032,t[e[2033]="SET_BLOCKLIST"]=2033,t[e[2034]="CHECK_IN_BLOCKLIST"]=2034,t[e[2036]="MARK_MESSAGE"]=2036,t[e[2037]="PULL_MARK_MESSAGE"]=2037,t[e[2038]="BATCH_GAT_CONVERSATION_PARTICIPANTS_READINDEX"]=2038,t[e[2043]="GET_MESSAGE_BY_INIT"]=2043,t[e[2048]="GET_USER_MESSAGE"]=2048,t[e[2054]="MARK_MSG_UNREAD_COUNT_REPORT"]=2054,t[e[2055]="MARK_MSG_GET_UNREAD_COUNT"]=2055,t[e[2056]="BATCH_UNMARK_MESSAGE"]=2056,t[e[2057]="CLIENT_BATCH_ACK"]=2057,t[e[2059]="AUDIO_RECOGNITION"]=2059,t[e[2105]="BATCH_MARK_CONVERSATION_READ_V3"]=2105,t[e[2200]="GET_TAG_META_INFO"]=2200,t[e[2201]="SET_CONVERSATION_TAG"]=2201,t[e[2202]="MANAGE_TAG_META_INFO"]=2202,t[e[2203]="GET_CONVERSATIONS_BY_TAG"]=2203,t}(),e.StatusCode=function(){const e={},t=Object.create(e);return t[e[0]="OK"]=0,t[e[1]="INVALID_TOKEN"]=1,t[e[100]="EXPIRED_TOKEN"]=100,t[e[2]="INVALID_TICKET"]=2,t[e[4]="INVALID_REQUEST"]=4,t[e[5]="INVALID_CMD"]=5,t[e[6]="SERVER_ERR"]=6,t[e[11]="USER_FORBIDDEN"]=11,t[e[500]="INTERNAL_ERROR"]=500,t[e[15]="MESSAGE_TARGET_CONVERSATION_NOT_EXIST"]=15,t[e[16]="DEGRADATION_ERROR"]=16,t[e[17]="RECALL_TIMEOUT"]=17,t[e[19]="CALLBACK_DENY"]=19,t}(),e.SendMessageStatus=function(){const e={},t=Object.create(e);return t[e[0]="SEND_SUCCEED"]=0,t[e[1]="USER_NOT_IN_CONVERSATION"]=1,t[e[2]="CHECK_CONV_NOT_PASS"]=2,t[e[3]="CHECK_MSG_NOT_PASS"]=3,t[e[4]="CHECK_MSG_NOT_PASS_BUT_SELF_VISIBLE"]=4,t}(),e.Refer=function(){const e={},t=Object.create(e);return t[e[1]="ANDROID"]=1,t[e[2]="IOS"]=2,t[e[3]="PC"]=3,t[e[4]="SERVER"]=4,t}(),e.ConversationType=function(){const e={},t=Object.create(e);return t[e[1]="ONE_TO_ONE_CHAT"]=1,t[e[2]="GROUP_CHAT"]=2,t[e[3]="LIVE_CHAT"]=3,t[e[4]="BROADCAST_CHAT"]=4,t}(),e.MessageType=function(){const e={},t=Object.create(e);return t[e[1]="LEGACY_MESSAGE_TYPE_SYSTEM"]=1,t[e[2]="LEGACY_MESSAGE_TYPE_IMAGE"]=2,t[e[3]="LEGACY_MESSAGE_TYPE_AUDIO"]=3,t[e[4]="LEGACY_MESSAGE_TYPE_VIDEO"]=4,t[e[5]="LEGACY_MESSAGE_TYPE_EMOJI"]=5,t[e[6]="LEGACY_MESSAGE_TYPE_FILE"]=6,t[e[7]="LEGACY_MESSAGE_TYPE_TEXT"]=7,t[e[8]="LEGACY_MESSAGE_TYPE_USER_CARD"]=8,t[e[9]="LEGACY_MESSAGE_TYPE_TOAST"]=9,t[e[10]="LEGACY_MESSAGE_TYPE_GROUP_CARD"]=10,t[e[10001]="MESSAGE_TYPE_TEXT"]=10001,t[e[10002]="MESSAGE_TYPE_STICKER"]=10002,t[e[10003]="MESSAGE_TYPE_IMAGE"]=10003,t[e[10004]="MESSAGE_TYPE_VIDEO"]=10004,t[e[10005]="MESSAGE_TYPE_FILE"]=10005,t[e[10006]="MESSAGE_TYPE_AUDIO"]=10006,t[e[10007]="MESSAGE_TYPE_LOCATION"]=10007,t[e[10008]="MESSAGE_TYPE_SYSTEM"]=10008,t[e[10009]="MESSAGE_TYPE_LINK"]=10009,t[e[50001]="MESSAGE_TYPE_COMMAND"]=50001,t[e[50002]="MESSAGE_TYPE_UPDATE_MESSAGE_EXT"]=50002,t[e[50010]="MESSAGE_TYPE_MODE_CHANGE"]=50010,t[e[50003]="MESSAGE_TYPE_UPDATE_MIN_INDEX"]=50003,t[e[50004]="MESSAGE_TYPE_USER_ACTION"]=50004,t[e[50005]="MESSAGE_TYPE_CONVERSATION_DESTROY"]=50005,t[e[50011]="MESSAGE_TYPE_BLOCK_COMMAND"]=50011,t[e[50012]="MESSAGE_TYPE_MARK_COMMAND"]=50012,t[e[50013]="MESSAGE_TYPE_READ_COMMAND"]=50013,t[e[50016]="MESSAGE_TYPE_BATCH_UNMARK_COMMAND"]=50016,t[e[50022]="MESSAGE_TYPE_NOTIFY_USER_CUSTOM_CONVERSATION_TAG_UPDATE_COMMAND"]=50022,t[e[60001]="MESSAGE_TYPE_NOTIFY_COMMAND"]=60001,t[e[70001]="MESSAGE_TYPE_MESSAGE_PROPERTY"]=70001,t[e[70002]="MESSAGE_TYPE_UPDATE_MESSAGE_PROPERTY"]=70002,t[e[80001]="MESSAGE_TYPE_VOIP_COMMAND"]=80001,t[e[80002]="MESSAGE_TYPE_VOIP_CARD_COMMAND"]=80002,t[e[80003]="MESSAGE_TYPE_VOIP_SINGLE_CHAT_STATUS_COMMAND"]=80003,t[e[80004]="MESSAGE_TYPE_VOIP_CALLEE_LIST_UPDATE_NOTIFY"]=80004,t}(),e.GroupRole=function(){const e={},t=Object.create(e);return t[e[0]="ORDINARY"]=0,t[e[1]="OWNER"]=1,t[e[2]="MANAGER"]=2,t[e[3]="VISITOR"]=3,t}(),e.TicketType=function(){const e={},t=Object.create(e);return t[e[1]="TICKET_TYPE_APP"]=1,t[e[2]="TICKET_TYPE_PC"]=2,t[e[3]="TICKET_TYPE_WEB"]=3,t}(),e.MuteMessageType=function(){const e={},t=Object.create(e);return t[e[50]="TYPE_PART_MUTE"]=50,t}(),e.MuteBadgeCountInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.message_type=50,e.prototype.badge_count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(8).int32(e.message_type),t.uint32(16).int32(e.badge_count),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MuteBadgeCountInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.message_type=e.int32();break;case 2:o.badge_count=e.int32();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("message_type"))throw c.ProtocolError("missing required 'message_type'",{instance:o});if(!o.hasOwnProperty("badge_count"))throw c.ProtocolError("missing required 'badge_count'",{instance:o});return o},e}(),e.PropertyItem=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.uid=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.prototype.create_time=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.idempotent_id="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.uid&&Object.hasOwnProperty.call(e,"uid")&&t.uint32(8).int64(e.uid),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(24).int64(e.create_time),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(34).string(e.idempotent_id),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(42).string(e.value),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.PropertyItem;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.uid=e.int64();break;case 2:o.sec_uid=e.string();break;case 3:o.create_time=e.int64();break;case 4:o.idempotent_id=e.string();break;case 5:o.value=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.PropertyItemList=function(){function e(e){if(this.Items=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.Items=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var n=0;n<e.Items.length;++n)d.im_proto.PropertyItem.encode(e.Items[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.PropertyItemList;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.Items&&o.Items.length||(o.Items=[]),o.Items.push(d.im_proto.PropertyItem.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.MessageBody=function(){function e(e){if(this.ext={},this.property_list={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.index_in_conversation=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.message_type=0,e.prototype.sender=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.content="",e.prototype.ext=c.emptyObject,e.prototype.create_time=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.status=0,e.prototype.order_in_conversation=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sec_sender="",e.prototype.property_list=c.emptyObject,e.prototype.index_in_conversation_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.reference_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(24).int64(e.server_message_id),null!=e.index_in_conversation&&Object.hasOwnProperty.call(e,"index_in_conversation")&&t.uint32(32).int64(e.index_in_conversation),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(40).int64(e.conversation_short_id),null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(48).int32(e.message_type),null!=e.sender&&Object.hasOwnProperty.call(e,"sender")&&t.uint32(56).int64(e.sender),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(66).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(74).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();if(null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(80).int64(e.create_time),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(88).int64(e.version),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(96).int32(e.status),null!=e.order_in_conversation&&Object.hasOwnProperty.call(e,"order_in_conversation")&&t.uint32(104).int64(e.order_in_conversation),null!=e.sec_sender&&Object.hasOwnProperty.call(e,"sec_sender")&&t.uint32(114).string(e.sec_sender),null!=e.property_list&&Object.hasOwnProperty.call(e,"property_list"))for(n=Object.keys(e.property_list),o=0;o<n.length;++o)t.uint32(122).fork().uint32(10).string(n[o]),d.im_proto.PropertyItemList.encode(e.property_list[n[o]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.index_in_conversation_v2&&Object.hasOwnProperty.call(e,"index_in_conversation_v2")&&t.uint32(136).int64(e.index_in_conversation_v2),null!=e.reference_info&&Object.hasOwnProperty.call(e,"reference_info")&&d.im_proto.ReferenceInfo.encode(e.reference_info,t.uint32(146).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.MessageBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_type=e.int32();break;case 3:i.server_message_id=e.int64();break;case 4:i.index_in_conversation=e.int64();break;case 5:i.conversation_short_id=e.int64();break;case 6:i.message_type=e.int32();break;case 7:i.sender=e.int64();break;case 8:i.content=e.string();break;case 9:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){switch((l=e.uint32())>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 10:i.create_time=e.int64();break;case 11:i.version=e.int64();break;case 12:i.status=e.int32();break;case 13:i.order_in_conversation=e.int64();break;case 14:i.sec_sender=e.string();break;case 15:i.property_list===c.emptyObject&&(i.property_list={});u=e.uint32()+e.pos;for(n="",o=null;e.pos<u;){var l;switch((l=e.uint32())>>>3){case 1:n=e.string();break;case 2:o=d.im_proto.PropertyItemList.decode(e,e.uint32());break;default:e.skipType(7&l)}}i.property_list[n]=o;break;case 17:i.index_in_conversation_v2=e.int64();break;case 18:i.reference_info=d.im_proto.ReferenceInfo.decode(e,e.uint32());break;default:e.skipType(7&a)}}return i},e}(),e.ReferenceInfo=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.referenced_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.hint="",e.prototype.ref_message_type=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.referenced_message_status=0,e.prototype.root_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.root_message_conv_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.referenced_message_id),t.uint32(18).string(e.hint),t.uint32(24).int64(e.ref_message_type),t.uint32(32).int32(e.referenced_message_status),null!=e.root_message_id&&Object.hasOwnProperty.call(e,"root_message_id")&&t.uint32(40).int64(e.root_message_id),null!=e.root_message_conv_index&&Object.hasOwnProperty.call(e,"root_message_conv_index")&&t.uint32(48).int64(e.root_message_conv_index),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(58).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ReferenceInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.referenced_message_id=e.int64();break;case 2:i.hint=e.string();break;case 3:i.ref_message_type=e.int64();break;case 4:i.referenced_message_status=e.int32();break;case 5:i.root_message_id=e.int64();break;case 6:i.root_message_conv_index=e.int64();break;case 7:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}if(!i.hasOwnProperty("referenced_message_id"))throw c.ProtocolError("missing required 'referenced_message_id'",{instance:i});if(!i.hasOwnProperty("hint"))throw c.ProtocolError("missing required 'hint'",{instance:i});if(!i.hasOwnProperty("ref_message_type"))throw c.ProtocolError("missing required 'ref_message_type'",{instance:i});if(!i.hasOwnProperty("referenced_message_status"))throw c.ProtocolError("missing required 'referenced_message_status'",{instance:i});return i},e}(),e.ParticipantRole=function(){const e={},t=Object.create(e);return t[e[0]="PARTICIPANT_ROLE_NORMAL"]=0,t[e[1]="PARTICIPANT_ROLE_OWNER"]=1,t[e[2]="PARTICIPANT_ROLE_ADMIN"]=2,t[e[3]="PARTICIPANT_ROLE_VISITOR"]=3,t}(),e.Participant=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.user_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sort_order=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.role=0,e.prototype.alias="",e.prototype.sec_uid="",e.prototype.blocked=0,e.prototype.left_block_time=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.sort_order&&Object.hasOwnProperty.call(e,"sort_order")&&t.uint32(16).int64(e.sort_order),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).int32(e.role),null!=e.alias&&Object.hasOwnProperty.call(e,"alias")&&t.uint32(34).string(e.alias),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(42).string(e.sec_uid),null!=e.blocked&&Object.hasOwnProperty.call(e,"blocked")&&t.uint32(48).int32(e.blocked),null!=e.left_block_time&&Object.hasOwnProperty.call(e,"left_block_time")&&t.uint32(56).int64(e.left_block_time),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(66).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.Participant;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.user_id=e.int64();break;case 2:i.sort_order=e.int64();break;case 3:i.role=e.int32();break;case 4:i.alias=e.string();break;case 5:i.sec_uid=e.string();break;case 6:i.blocked=e.int32();break;case 7:i.left_block_time=e.int64();break;case 8:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.ParticipantsPage=function(){function e(e){if(this.participants=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.participants=c.emptyArray,e.prototype.has_more=!1,e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.participants&&e.participants.length)for(var n=0;n<e.participants.length;++n)d.im_proto.Participant.encode(e.participants[n],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(24).int64(e.cursor),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ParticipantsPage;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.participants&&o.participants.length||(o.participants=[]),o.participants.push(d.im_proto.Participant.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.cursor=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationInfoV2=function(){function e(e){if(this.mute_badge_count_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.ticket="",e.prototype.first_page_participants=null,e.prototype.participants_count=0,e.prototype.is_participant=!1,e.prototype.inbox_type=0,e.prototype.badge_count=0,e.prototype.mute_badge_count_infos=c.emptyArray,e.prototype.user_info=null,e.prototype.conversation_core_info=null,e.prototype.conversation_setting_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(34).string(e.ticket),null!=e.first_page_participants&&Object.hasOwnProperty.call(e,"first_page_participants")&&d.im_proto.ParticipantsPage.encode(e.first_page_participants,t.uint32(50).fork()).ldelim(),null!=e.participants_count&&Object.hasOwnProperty.call(e,"participants_count")&&t.uint32(56).int32(e.participants_count),null!=e.is_participant&&Object.hasOwnProperty.call(e,"is_participant")&&t.uint32(64).bool(e.is_participant),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(72).int32(e.inbox_type),null!=e.badge_count&&Object.hasOwnProperty.call(e,"badge_count")&&t.uint32(80).int32(e.badge_count),null!=e.mute_badge_count_infos&&e.mute_badge_count_infos.length)for(var n=0;n<e.mute_badge_count_infos.length;++n)d.im_proto.MuteBadgeCountInfo.encode(e.mute_badge_count_infos[n],t.uint32(90).fork()).ldelim();return null!=e.user_info&&Object.hasOwnProperty.call(e,"user_info")&&d.im_proto.Participant.encode(e.user_info,t.uint32(162).fork()).ldelim(),null!=e.conversation_core_info&&Object.hasOwnProperty.call(e,"conversation_core_info")&&d.im_proto.ConversationCoreInfo.encode(e.conversation_core_info,t.uint32(402).fork()).ldelim(),null!=e.conversation_setting_info&&Object.hasOwnProperty.call(e,"conversation_setting_info")&&d.im_proto.ConversationSettingInfo.encode(e.conversation_setting_info,t.uint32(410).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationInfoV2;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.ticket=e.string();break;case 6:o.first_page_participants=d.im_proto.ParticipantsPage.decode(e,e.uint32());break;case 7:o.participants_count=e.int32();break;case 8:o.is_participant=e.bool();break;case 9:o.inbox_type=e.int32();break;case 10:o.badge_count=e.int32();break;case 11:o.mute_badge_count_infos&&o.mute_badge_count_infos.length||(o.mute_badge_count_infos=[]),o.mute_badge_count_infos.push(d.im_proto.MuteBadgeCountInfo.decode(e,e.uint32()));break;case 20:o.user_info=d.im_proto.Participant.decode(e,e.uint32());break;case 50:o.conversation_core_info=d.im_proto.ConversationCoreInfo.decode(e,e.uint32());break;case 51:o.conversation_setting_info=d.im_proto.ConversationSettingInfo.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e}(),e.ConversationCoreInfo=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.info_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.name="",e.prototype.desc="",e.prototype.icon="",e.prototype.inbox_type=0,e.prototype.notice="",e.prototype.ext=c.emptyObject,e.prototype.owner=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sec_owner="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.info_version&&Object.hasOwnProperty.call(e,"info_version")&&t.uint32(32).int64(e.info_version),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(42).string(e.name),null!=e.desc&&Object.hasOwnProperty.call(e,"desc")&&t.uint32(50).string(e.desc),null!=e.icon&&Object.hasOwnProperty.call(e,"icon")&&t.uint32(58).string(e.icon),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(64).int32(e.inbox_type),null!=e.notice&&Object.hasOwnProperty.call(e,"notice")&&t.uint32(74).string(e.notice),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(90).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return null!=e.owner&&Object.hasOwnProperty.call(e,"owner")&&t.uint32(96).int64(e.owner),null!=e.sec_owner&&Object.hasOwnProperty.call(e,"sec_owner")&&t.uint32(106).string(e.sec_owner),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ConversationCoreInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:i.info_version=e.int64();break;case 5:i.name=e.string();break;case 6:i.desc=e.string();break;case 7:i.icon=e.string();break;case 8:i.inbox_type=e.int32();break;case 9:i.notice=e.string();break;case 11:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 12:i.owner=e.int64();break;case 13:i.sec_owner=e.string();break;default:e.skipType(7&a)}}return i},e}(),e.ConversationSettingInfo=function(){function e(e){if(this.ext={},this.mute_read_badge_count_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.min_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.mute=0,e.prototype.stick_on_top=0,e.prototype.inbox_type=0,e.prototype.ext=c.emptyObject,e.prototype.setting_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.favorite=0,e.prototype.set_top_time=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.set_favorite_time=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_index_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.min_index_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_badge_count=0,e.prototype.mute_read_badge_count_infos=c.emptyArray,e.prototype.push_status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.min_index&&Object.hasOwnProperty.call(e,"min_index")&&t.uint32(32).int64(e.min_index),null!=e.read_index&&Object.hasOwnProperty.call(e,"read_index")&&t.uint32(40).int64(e.read_index),null!=e.mute&&Object.hasOwnProperty.call(e,"mute")&&t.uint32(48).int32(e.mute),null!=e.stick_on_top&&Object.hasOwnProperty.call(e,"stick_on_top")&&t.uint32(56).int32(e.stick_on_top),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(64).int32(e.inbox_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(74).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();if(null!=e.setting_version&&Object.hasOwnProperty.call(e,"setting_version")&&t.uint32(80).int64(e.setting_version),null!=e.favorite&&Object.hasOwnProperty.call(e,"favorite")&&t.uint32(88).int32(e.favorite),null!=e.set_top_time&&Object.hasOwnProperty.call(e,"set_top_time")&&t.uint32(96).int64(e.set_top_time),null!=e.set_favorite_time&&Object.hasOwnProperty.call(e,"set_favorite_time")&&t.uint32(104).int64(e.set_favorite_time),null!=e.read_index_v2&&Object.hasOwnProperty.call(e,"read_index_v2")&&t.uint32(112).int64(e.read_index_v2),null!=e.min_index_v2&&Object.hasOwnProperty.call(e,"min_index_v2")&&t.uint32(120).int64(e.min_index_v2),null!=e.read_badge_count&&Object.hasOwnProperty.call(e,"read_badge_count")&&t.uint32(128).int32(e.read_badge_count),null!=e.mute_read_badge_count_infos&&e.mute_read_badge_count_infos.length)for(o=0;o<e.mute_read_badge_count_infos.length;++o)d.im_proto.MuteReadBadgeCountInfo.encode(e.mute_read_badge_count_infos[o],t.uint32(138).fork()).ldelim();return null!=e.push_status&&Object.hasOwnProperty.call(e,"push_status")&&t.uint32(240).int32(e.push_status),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ConversationSettingInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:i.min_index=e.int64();break;case 5:i.read_index=e.int64();break;case 6:i.mute=e.int32();break;case 7:i.stick_on_top=e.int32();break;case 8:i.inbox_type=e.int32();break;case 9:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 10:i.setting_version=e.int64();break;case 11:i.favorite=e.int32();break;case 12:i.set_top_time=e.int64();break;case 13:i.set_favorite_time=e.int64();break;case 14:i.read_index_v2=e.int64();break;case 15:i.min_index_v2=e.int64();break;case 16:i.read_badge_count=e.int32();break;case 17:i.mute_read_badge_count_infos&&i.mute_read_badge_count_infos.length||(i.mute_read_badge_count_infos=[]),i.mute_read_badge_count_infos.push(d.im_proto.MuteReadBadgeCountInfo.decode(e,e.uint32()));break;case 30:i.push_status=e.int32();break;default:e.skipType(7&a)}}return i},e}(),e.MessagesPerUserRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=50,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessagesPerUserRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.cursor=e.int64();break;case 2:o.limit=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.MessagesPerUserResponseBody=function(){function e(e){if(this.messages=[],this.conversation_badge_count=[],this.hasmore_message_conv_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.prototype.next_interval=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.next_conversation_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_badge_count=c.emptyArray,e.prototype.next_cmd_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.hasmore_message_conv_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(10).fork()).ldelim();if(null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(16).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(24).bool(e.has_more),null!=e.next_interval&&Object.hasOwnProperty.call(e,"next_interval")&&t.uint32(32).int64(e.next_interval),null!=e.next_conversation_version&&Object.hasOwnProperty.call(e,"next_conversation_version")&&t.uint32(40).int64(e.next_conversation_version),null!=e.conversation_badge_count&&e.conversation_badge_count.length)for(n=0;n<e.conversation_badge_count.length;++n)d.im_proto.ConversationBadgeCountInfo.encode(e.conversation_badge_count[n],t.uint32(50).fork()).ldelim();if(null!=e.next_cmd_index&&Object.hasOwnProperty.call(e,"next_cmd_index")&&t.uint32(56).int64(e.next_cmd_index),null!=e.hasmore_message_conv_list&&e.hasmore_message_conv_list.length)for(n=0;n<e.hasmore_message_conv_list.length;++n)t.uint32(64).int64(e.hasmore_message_conv_list[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessagesPerUserResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:o.next_cursor=e.int64();break;case 3:o.has_more=e.bool();break;case 4:o.next_interval=e.int64();break;case 5:o.next_conversation_version=e.int64();break;case 6:o.conversation_badge_count&&o.conversation_badge_count.length||(o.conversation_badge_count=[]),o.conversation_badge_count.push(d.im_proto.ConversationBadgeCountInfo.decode(e,e.uint32()));break;case 7:o.next_cmd_index=e.int64();break;case 8:if(o.hasmore_message_conv_list&&o.hasmore_message_conv_list.length||(o.hasmore_message_conv_list=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.hasmore_message_conv_list.push(e.int64());else o.hasmore_message_conv_list.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.ConversationBadgeCountInfo=function(){function e(e){if(this.mute_badge_count_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.badge_count=0,e.prototype.conversation_index_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_id="",e.prototype.mute_badge_count_infos=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.conversation_short_id),t.uint32(16).int32(e.badge_count),t.uint32(24).int64(e.conversation_index_v2),t.uint32(34).string(e.conversation_id),null!=e.mute_badge_count_infos&&e.mute_badge_count_infos.length)for(var n=0;n<e.mute_badge_count_infos.length;++n)d.im_proto.MuteBadgeCountInfo.encode(e.mute_badge_count_infos[n],t.uint32(42).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationBadgeCountInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.badge_count=e.int32();break;case 3:o.conversation_index_v2=e.int64();break;case 4:o.conversation_id=e.string();break;case 5:o.mute_badge_count_infos&&o.mute_badge_count_infos.length||(o.mute_badge_count_infos=[]),o.mute_badge_count_infos.push(d.im_proto.MuteBadgeCountInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("conversation_short_id"))throw c.ProtocolError("missing required 'conversation_short_id'",{instance:o});if(!o.hasOwnProperty("badge_count"))throw c.ProtocolError("missing required 'badge_count'",{instance:o});if(!o.hasOwnProperty("conversation_index_v2"))throw c.ProtocolError("missing required 'conversation_index_v2'",{instance:o});if(!o.hasOwnProperty("conversation_id"))throw c.ProtocolError("missing required 'conversation_id'",{instance:o});return o},e}(),e.MessagesPerUserInitV2RequestBody=function(){function e(e){if(this.biz_tag_ids=[],this.user_custom_tag_ids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.new_user=0,e.prototype.init_sub_type=0,e.prototype.conv_limit=0,e.prototype.msg_limit=0,e.prototype.biz_tag_ids=c.emptyArray,e.prototype.user_custom_tag_ids=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.new_user&&Object.hasOwnProperty.call(e,"new_user")&&t.uint32(16).int32(e.new_user),null!=e.init_sub_type&&Object.hasOwnProperty.call(e,"init_sub_type")&&t.uint32(24).int32(e.init_sub_type),null!=e.conv_limit&&Object.hasOwnProperty.call(e,"conv_limit")&&t.uint32(32).int32(e.conv_limit),null!=e.msg_limit&&Object.hasOwnProperty.call(e,"msg_limit")&&t.uint32(40).int32(e.msg_limit),null!=e.biz_tag_ids&&e.biz_tag_ids.length)for(var n=0;n<e.biz_tag_ids.length;++n)t.uint32(56).int64(e.biz_tag_ids[n]);if(null!=e.user_custom_tag_ids&&e.user_custom_tag_ids.length)for(n=0;n<e.user_custom_tag_ids.length;++n)t.uint32(64).int64(e.user_custom_tag_ids[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessagesPerUserInitV2RequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.cursor=e.int64();break;case 2:o.new_user=e.int32();break;case 3:o.init_sub_type=e.int32();break;case 4:o.conv_limit=e.int32();break;case 5:o.msg_limit=e.int32();break;case 7:if(o.biz_tag_ids&&o.biz_tag_ids.length||(o.biz_tag_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.biz_tag_ids.push(e.int64());else o.biz_tag_ids.push(e.int64());break;case 8:if(o.user_custom_tag_ids&&o.user_custom_tag_ids.length||(o.user_custom_tag_ids=[]),2==(7&r))for(i=e.uint32()+e.pos;e.pos<i;)o.user_custom_tag_ids.push(e.int64());else o.user_custom_tag_ids.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.MessagesPerUserInitV2ResponseBody=function(){function e(e){if(this.messages=[],this.conversations=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.prototype.conversations=c.emptyArray,e.prototype.per_user_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(10).fork()).ldelim();if(null!=e.conversations&&e.conversations.length)for(n=0;n<e.conversations.length;++n)d.im_proto.ConversationInfoV2.encode(e.conversations[n],t.uint32(18).fork()).ldelim();return null!=e.per_user_cursor&&Object.hasOwnProperty.call(e,"per_user_cursor")&&t.uint32(24).int64(e.per_user_cursor),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(32).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(40).bool(e.has_more),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessagesPerUserInitV2ResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:o.conversations&&o.conversations.length||(o.conversations=[]),o.conversations.push(d.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 3:o.per_user_cursor=e.int64();break;case 4:o.next_cursor=e.int64();break;case 5:o.has_more=e.bool();break;default:e.skipType(7&r)}}return o},e}(),e.MessageDirection=function(){const e={},t=Object.create(e);return t[e[1]="OLDER"]=1,t[e[2]="NEWER"]=2,t[e[3]="FROM_LATEST"]=3,t}(),e.MessagesInConversationRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.direction=1,e.prototype.anchor_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=50,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.direction&&Object.hasOwnProperty.call(e,"direction")&&t.uint32(32).int32(e.direction),null!=e.anchor_index&&Object.hasOwnProperty.call(e,"anchor_index")&&t.uint32(40).int64(e.anchor_index),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(48).int32(e.limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessagesInConversationRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.direction=e.int32();break;case 5:o.anchor_index=e.int64();break;case 6:o.limit=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.MessagesInConversationResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(10).fork()).ldelim();return null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(16).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(24).bool(e.has_more),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessagesInConversationResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:o.next_cursor=e.int64();break;case 3:o.has_more=e.bool();break;default:e.skipType(7&r)}}return o},e}(),e.CreateConversationV2RequestBody=function(){function e(e){if(this.participants=[],this.biz_ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_type=0,e.prototype.participants=c.emptyArray,e.prototype.persistent=!1,e.prototype.idempotent_id="",e.prototype.name="",e.prototype.avatar_url="",e.prototype.description="",e.prototype.biz_ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(8).int32(e.conversation_type),null!=e.participants&&e.participants.length)for(var n=0;n<e.participants.length;++n)t.uint32(16).int64(e.participants[n]);if(null!=e.persistent&&Object.hasOwnProperty.call(e,"persistent")&&t.uint32(24).bool(e.persistent),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(34).string(e.idempotent_id),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(50).string(e.name),null!=e.avatar_url&&Object.hasOwnProperty.call(e,"avatar_url")&&t.uint32(58).string(e.avatar_url),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(66).string(e.description),null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext")){var o=Object.keys(e.biz_ext);for(n=0;n<o.length;++n)t.uint32(90).fork().uint32(10).string(o[n]).uint32(18).string(e.biz_ext[o[n]]).ldelim()}return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.CreateConversationV2RequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_type=e.int32();break;case 2:if(i.participants&&i.participants.length||(i.participants=[]),2==(7&a))for(var u=e.uint32()+e.pos;e.pos<u;)i.participants.push(e.int64());else i.participants.push(e.int64());break;case 3:i.persistent=e.bool();break;case 4:i.idempotent_id=e.string();break;case 6:i.name=e.string();break;case 7:i.avatar_url=e.string();break;case 8:i.description=e.string();break;case 11:i.biz_ext===c.emptyObject&&(i.biz_ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.biz_ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.CreateConversationV2ResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation=null,e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.prototype.status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation&&Object.hasOwnProperty.call(e,"conversation")&&d.im_proto.ConversationInfoV2.encode(e.conversation,t.uint32(10).fork()).ldelim(),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(16).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(26).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(34).string(e.extra_info),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(40).int32(e.status),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.CreateConversationV2ResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation=d.im_proto.ConversationInfoV2.decode(e,e.uint32());break;case 2:o.check_code=e.int64();break;case 3:o.check_message=e.string();break;case 4:o.extra_info=e.string();break;case 5:o.status=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.UserActionType=function(){const e={},t=Object.create(e);return t[e[1]="ENTER_CONVERSATION"]=1,t[e[2]="EXIT_CONVERSATION"]=2,t}(),e.SendUserActionRequestBody=function(){function e(e){if(this.extra={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.action_type=1,e.prototype.extra=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(32).int32(e.action_type),null!=e.extra&&Object.hasOwnProperty.call(e,"extra"))for(var n=Object.keys(e.extra),o=0;o<n.length;++o)t.uint32(42).fork().uint32(10).string(n[o]).uint32(18).string(e.extra[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.SendUserActionRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_type=e.int32();break;case 3:i.conversation_short_id=e.int64();break;case 4:i.action_type=e.int32();break;case 5:i.extra===c.emptyObject&&(i.extra={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.extra[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.InputStatus=function(){const e={},t=Object.create(e);return t[e[3]="TYPING"]=3,t[e[4]="CLEAR_INPUT"]=4,t}(),e.SendInputStatusRequestBody=function(){function e(e){if(this.extra={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.status=3,e.prototype.extra=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(32).int32(e.status),null!=e.extra&&Object.hasOwnProperty.call(e,"extra"))for(var n=Object.keys(e.extra),o=0;o<n.length;++o)t.uint32(42).fork().uint32(10).string(n[o]).uint32(18).string(e.extra[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.SendInputStatusRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_type=e.int32();break;case 3:i.conversation_short_id=e.int64();break;case 4:i.status=e.int32();break;case 5:i.extra===c.emptyObject&&(i.extra={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.extra[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.DeleteConversationRequestBody=function(){function e(e){if(this.mute_badge_count_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.last_message_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.badge_count=0,e.prototype.mute_badge_count_infos=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.last_message_index&&Object.hasOwnProperty.call(e,"last_message_index")&&t.uint32(32).int64(e.last_message_index),null!=e.badge_count&&Object.hasOwnProperty.call(e,"badge_count")&&t.uint32(48).int32(e.badge_count),null!=e.mute_badge_count_infos&&e.mute_badge_count_infos.length)for(var n=0;n<e.mute_badge_count_infos.length;++n)d.im_proto.MuteBadgeCountInfo.encode(e.mute_badge_count_infos[n],t.uint32(58).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.DeleteConversationRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.last_message_index=e.int64();break;case 6:o.badge_count=e.int32();break;case 7:o.mute_badge_count_infos&&o.mute_badge_count_infos.length||(o.mute_badge_count_infos=[]),o.mute_badge_count_infos.push(d.im_proto.MuteBadgeCountInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.DissolveConversationRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.DissolveConversationRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.DeleteMessageRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.message_id&&Object.hasOwnProperty.call(e,"message_id")&&t.uint32(32).int64(e.message_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.DeleteMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.message_id=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.MarkConversationReadRequestBody=function(){function e(e){if(this.mute_read_badge_count_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.read_message_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conv_unread_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.total_unread_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_message_index_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_badge_count=0,e.prototype.mute_read_badge_count_infos=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.read_message_index&&Object.hasOwnProperty.call(e,"read_message_index")&&t.uint32(32).int64(e.read_message_index),null!=e.conv_unread_count&&Object.hasOwnProperty.call(e,"conv_unread_count")&&t.uint32(40).int64(e.conv_unread_count),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(48).int64(e.total_unread_count),null!=e.read_message_index_v2&&Object.hasOwnProperty.call(e,"read_message_index_v2")&&t.uint32(56).int64(e.read_message_index_v2),null!=e.read_badge_count&&Object.hasOwnProperty.call(e,"read_badge_count")&&t.uint32(64).int32(e.read_badge_count),null!=e.mute_read_badge_count_infos&&e.mute_read_badge_count_infos.length)for(var n=0;n<e.mute_read_badge_count_infos.length;++n)d.im_proto.MuteReadBadgeCountInfo.encode(e.mute_read_badge_count_infos[n],t.uint32(90).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MarkConversationReadRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.read_message_index=e.int64();break;case 5:o.conv_unread_count=e.int64();break;case 6:o.total_unread_count=e.int64();break;case 7:o.read_message_index_v2=e.int64();break;case 8:o.read_badge_count=e.int32();break;case 11:o.mute_read_badge_count_infos&&o.mute_read_badge_count_infos.length||(o.mute_read_badge_count_infos=[]),o.mute_read_badge_count_infos.push(d.im_proto.MuteReadBadgeCountInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.MuteReadBadgeCountInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.message_type=50,e.prototype.read_badge_count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(8).int32(e.message_type),t.uint32(16).int32(e.read_badge_count),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MuteReadBadgeCountInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.message_type=e.int32();break;case 2:o.read_badge_count=e.int32();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("message_type"))throw c.ProtocolError("missing required 'message_type'",{instance:o});if(!o.hasOwnProperty("read_badge_count"))throw c.ProtocolError("missing required 'read_badge_count'",{instance:o});return o},e}(),e.BatchMarkConversationReadRequestBody=function(){function e(e){if(this.mark_read_requests=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.mark_read_requests=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.mark_read_requests&&e.mark_read_requests.length)for(var n=0;n<e.mark_read_requests.length;++n)d.im_proto.MarkConversationReadRequestBody.encode(e.mark_read_requests[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BatchMarkConversationReadRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.mark_read_requests&&o.mark_read_requests.length||(o.mark_read_requests=[]),o.mark_read_requests.push(d.im_proto.MarkConversationReadRequestBody.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.BatchMarkConversationReadResponseBody=function(){function e(e){if(this.failed_requests=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.failed_requests=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.failed_requests&&e.failed_requests.length)for(var n=0;n<e.failed_requests.length;++n)d.im_proto.MarkConversationReadRequestBody.encode(e.failed_requests[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BatchMarkConversationReadResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.failed_requests&&o.failed_requests.length||(o.failed_requests=[]),o.failed_requests.push(d.im_proto.MarkConversationReadRequestBody.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.GetConversationParticipantsReadIndexV3RequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.conversation_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(26).string(e.conversation_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationParticipantsReadIndexV3RequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_id=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationParticipantsReadIndexV3ResponseBody=function(){function e(e){if(this.indexes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.indexes=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.indexes&&e.indexes.length)for(var n=0;n<e.indexes.length;++n)d.im_proto.ParticipantReadIndex.encode(e.indexes[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationParticipantsReadIndexV3ResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.indexes&&o.indexes.length||(o.indexes=[]),o.indexes.push(d.im_proto.ParticipantReadIndex.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.ParticipantReadIndex=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.user_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.prototype.index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.index_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.index_min=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&t.uint32(24).int64(e.index),null!=e.index_v2&&Object.hasOwnProperty.call(e,"index_v2")&&t.uint32(32).int64(e.index_v2),null!=e.index_min&&Object.hasOwnProperty.call(e,"index_min")&&t.uint32(40).int64(e.index_min),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ParticipantReadIndex;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.user_id=e.int64();break;case 2:o.sec_uid=e.string();break;case 3:o.index=e.int64();break;case 4:o.index_v2=e.int64();break;case 5:o.index_min=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.BatchGetConversationParticipantsReadIndexRequestBody=function(){function e(e){if(this.conversation_id=[],this.conversation_short_id=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id=c.emptyArray,e.prototype.conversation_short_id=c.emptyArray,e.prototype.request_from="",e.prototype.min_index_required=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&e.conversation_id.length)for(var n=0;n<e.conversation_id.length;++n)t.uint32(10).string(e.conversation_id[n]);if(null!=e.conversation_short_id&&e.conversation_short_id.length)for(n=0;n<e.conversation_short_id.length;++n)t.uint32(16).int64(e.conversation_short_id[n]);return null!=e.request_from&&Object.hasOwnProperty.call(e,"request_from")&&t.uint32(26).string(e.request_from),null!=e.min_index_required&&Object.hasOwnProperty.call(e,"min_index_required")&&t.uint32(32).bool(e.min_index_required),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BatchGetConversationParticipantsReadIndexRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id&&o.conversation_id.length||(o.conversation_id=[]),o.conversation_id.push(e.string());break;case 2:if(o.conversation_short_id&&o.conversation_short_id.length||(o.conversation_short_id=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.conversation_short_id.push(e.int64());else o.conversation_short_id.push(e.int64());break;case 3:o.request_from=e.string();break;case 4:o.min_index_required=e.bool();break;default:e.skipType(7&r)}}return o},e}(),e.BatchGetConversationParticipantsReadIndexResponseBody=function(){function e(e){if(this.conversationParticipantsReadIndex=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversationParticipantsReadIndex=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversationParticipantsReadIndex&&e.conversationParticipantsReadIndex.length)for(var n=0;n<e.conversationParticipantsReadIndex.length;++n)d.im_proto.ConversationParticipantReadIndex.encode(e.conversationParticipantsReadIndex[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BatchGetConversationParticipantsReadIndexResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversationParticipantsReadIndex&&o.conversationParticipantsReadIndex.length||(o.conversationParticipantsReadIndex=[]),o.conversationParticipantsReadIndex.push(d.im_proto.ConversationParticipantReadIndex.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.ConversationParticipantReadIndex=function(){function e(e){if(this.participantReadIndex=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.participantReadIndex=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.participantReadIndex&&e.participantReadIndex.length)for(var n=0;n<e.participantReadIndex.length;++n)d.im_proto.ParticipantReadIndex.encode(e.participantReadIndex[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationParticipantReadIndex;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.participantReadIndex&&o.participantReadIndex.length||(o.participantReadIndex=[]),o.participantReadIndex.push(d.im_proto.ParticipantReadIndex.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationParticipantsMinIndexV3RequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.conversation_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(26).string(e.conversation_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationParticipantsMinIndexV3RequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_id=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationParticipantsMinIndexV3ResponseBody=function(){function e(e){if(this.indexes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.indexes=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.indexes&&e.indexes.length)for(var n=0;n<e.indexes.length;++n)d.im_proto.ParticipantMinIndex.encode(e.indexes[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationParticipantsMinIndexV3ResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.indexes&&o.indexes.length||(o.indexes=[]),o.indexes.push(d.im_proto.ParticipantMinIndex.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.ParticipantMinIndex=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.user_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.prototype.index=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&t.uint32(24).int64(e.index),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ParticipantMinIndex;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.user_id=e.int64();break;case 2:o.sec_uid=e.string();break;case 3:o.index=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.SendMessageRequestBody=function(){function e(e){if(this.ext={},this.mentioned_users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.content="",e.prototype.ext=c.emptyObject,e.prototype.message_type=0,e.prototype.ticket="",e.prototype.client_message_id="",e.prototype.mentioned_users=c.emptyArray,e.prototype.ignore_badge_count=!1,e.prototype.ref_msg_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(34).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(42).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();if(null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(48).int32(e.message_type),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(58).string(e.ticket),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(66).string(e.client_message_id),null!=e.mentioned_users&&e.mentioned_users.length)for(o=0;o<e.mentioned_users.length;++o)t.uint32(72).int64(e.mentioned_users[o]);return null!=e.ignore_badge_count&&Object.hasOwnProperty.call(e,"ignore_badge_count")&&t.uint32(80).bool(e.ignore_badge_count),null!=e.ref_msg_info&&Object.hasOwnProperty.call(e,"ref_msg_info")&&d.im_proto.ReferencedMessageInfo.encode(e.ref_msg_info,t.uint32(90).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.SendMessageRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_type=e.int32();break;case 3:i.conversation_short_id=e.int64();break;case 4:i.content=e.string();break;case 5:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 6:i.message_type=e.int32();break;case 7:i.ticket=e.string();break;case 8:i.client_message_id=e.string();break;case 9:if(i.mentioned_users&&i.mentioned_users.length||(i.mentioned_users=[]),2==(7&a))for(u=e.uint32()+e.pos;e.pos<u;)i.mentioned_users.push(e.int64());else i.mentioned_users.push(e.int64());break;case 10:i.ignore_badge_count=e.bool();break;case 11:i.ref_msg_info=d.im_proto.ReferencedMessageInfo.decode(e,e.uint32());break;default:e.skipType(7&a)}}return i},e}(),e.ReferencedMessageInfo=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.referenced_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.hint="",e.prototype.root_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.root_message_conv_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.referenced_message_id),t.uint32(18).string(e.hint),null!=e.root_message_id&&Object.hasOwnProperty.call(e,"root_message_id")&&t.uint32(24).int64(e.root_message_id),null!=e.root_message_conv_index&&Object.hasOwnProperty.call(e,"root_message_conv_index")&&t.uint32(32).int64(e.root_message_conv_index),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(42).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ReferencedMessageInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.referenced_message_id=e.int64();break;case 2:i.hint=e.string();break;case 3:i.root_message_id=e.int64();break;case 4:i.root_message_conv_index=e.int64();break;case 5:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}if(!i.hasOwnProperty("referenced_message_id"))throw c.ProtocolError("missing required 'referenced_message_id'",{instance:i});if(!i.hasOwnProperty("hint"))throw c.ProtocolError("missing required 'hint'",{instance:i});return i},e}(),e.SendMessageResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.extra_info="",e.prototype.status=0,e.prototype.client_message_id="",e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(18).string(e.extra_info),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(34).string(e.client_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SendMessageResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.server_message_id=e.int64();break;case 2:o.extra_info=e.string();break;case 3:o.status=e.int32();break;case 4:o.client_message_id=e.string();break;case 5:o.check_code=e.int64();break;case 6:o.check_message=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.NewMessageNotifyType=function(){const e={},t=Object.create(e);return t[e[1]="PER_USER"]=1,t[e[2]="PER_CONVERSATION"]=2,t}(),e.MsgTracePath=function(){const e={},t=Object.create(e);return t[e[0]="FROM_UNKNOWN"]=0,t[e[1]="FROM_FRONTIER"]=1,t[e[2]="FROM_HTTP"]=2,t[e[3]="FROM_SERVER"]=3,t}(),e.MsgTrace=function(){function e(e){if(this.metrics={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.metrics=c.emptyObject,e.prototype.path=0,e.prototype.connStatus=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.metrics&&Object.hasOwnProperty.call(e,"metrics"))for(var n=Object.keys(e.metrics),o=0;o<n.length;++o)t.uint32(10).fork().uint32(8).int32(n[o]).uint32(16).int64(e.metrics[n[o]]).ldelim();return null!=e.path&&Object.hasOwnProperty.call(e,"path")&&t.uint32(16).int32(e.path),null!=e.connStatus&&Object.hasOwnProperty.call(e,"connStatus")&&t.uint32(24).int32(e.connStatus),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.MsgTrace;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.metrics===c.emptyObject&&(i.metrics={});var u=e.uint32()+e.pos;for(n=0,o=0;e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.int32();break;case 2:o=e.int64();break;default:e.skipType(7&l)}}i.metrics[n]=o;break;case 2:i.path=e.int32();break;case 3:i.connStatus=e.int32();break;default:e.skipType(7&a)}}return i},e}(),e.NewMessageNotify=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.notify_type=1,e.prototype.message=null,e.prototype.previous_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.index_in_conversation=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.index_in_conversation_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.previous_conversation_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.cmd_message_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.badge_count=0,e.prototype.trace=null,e.prototype.ref_msg_info=null,e.prototype.previous_msg_index_in_conv=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.readconv_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.pre_readconv_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.mute_badge_count_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(18).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.notify_type&&Object.hasOwnProperty.call(e,"notify_type")&&t.uint32(32).int32(e.notify_type),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&d.im_proto.MessageBody.encode(e.message,t.uint32(42).fork()).ldelim(),null!=e.previous_cursor&&Object.hasOwnProperty.call(e,"previous_cursor")&&t.uint32(48).int64(e.previous_cursor),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(56).int64(e.next_cursor),null!=e.index_in_conversation&&Object.hasOwnProperty.call(e,"index_in_conversation")&&t.uint32(64).int64(e.index_in_conversation),null!=e.index_in_conversation_v2&&Object.hasOwnProperty.call(e,"index_in_conversation_v2")&&t.uint32(72).int64(e.index_in_conversation_v2),null!=e.conversation_version&&Object.hasOwnProperty.call(e,"conversation_version")&&t.uint32(80).int64(e.conversation_version),null!=e.previous_conversation_version&&Object.hasOwnProperty.call(e,"previous_conversation_version")&&t.uint32(88).int64(e.previous_conversation_version),null!=e.cmd_message_index&&Object.hasOwnProperty.call(e,"cmd_message_index")&&t.uint32(96).int64(e.cmd_message_index),null!=e.badge_count&&Object.hasOwnProperty.call(e,"badge_count")&&t.uint32(104).int32(e.badge_count),null!=e.trace&&Object.hasOwnProperty.call(e,"trace")&&d.im_proto.MsgTrace.encode(e.trace,t.uint32(114).fork()).ldelim(),null!=e.ref_msg_info&&Object.hasOwnProperty.call(e,"ref_msg_info")&&d.im_proto.ReferenceInfo.encode(e.ref_msg_info,t.uint32(122).fork()).ldelim(),null!=e.previous_msg_index_in_conv&&Object.hasOwnProperty.call(e,"previous_msg_index_in_conv")&&t.uint32(128).int64(e.previous_msg_index_in_conv),null!=e.readconv_version&&Object.hasOwnProperty.call(e,"readconv_version")&&t.uint32(136).int64(e.readconv_version),null!=e.pre_readconv_version&&Object.hasOwnProperty.call(e,"pre_readconv_version")&&t.uint32(144).int64(e.pre_readconv_version),null!=e.mute_badge_count_info&&Object.hasOwnProperty.call(e,"mute_badge_count_info")&&d.im_proto.MuteBadgeCountInfo.encode(e.mute_badge_count_info,t.uint32(154).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.NewMessageNotify;e.pos<n;){var r=e.uint32();switch(r>>>3){case 2:o.conversation_id=e.string();break;case 3:o.conversation_type=e.int32();break;case 4:o.notify_type=e.int32();break;case 5:o.message=d.im_proto.MessageBody.decode(e,e.uint32());break;case 6:o.previous_cursor=e.int64();break;case 7:o.next_cursor=e.int64();break;case 8:o.index_in_conversation=e.int64();break;case 9:o.index_in_conversation_v2=e.int64();break;case 10:o.conversation_version=e.int64();break;case 11:o.previous_conversation_version=e.int64();break;case 12:o.cmd_message_index=e.int64();break;case 13:o.badge_count=e.int32();break;case 14:o.trace=d.im_proto.MsgTrace.decode(e,e.uint32());break;case 15:o.ref_msg_info=d.im_proto.ReferenceInfo.decode(e,e.uint32());break;case 16:o.previous_msg_index_in_conv=e.int64();break;case 17:o.readconv_version=e.int64();break;case 18:o.pre_readconv_version=e.int64();break;case 19:o.mute_badge_count_info=d.im_proto.MuteBadgeCountInfo.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e}(),e.ConversationsPerUserByFavoriteV2RequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=500,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationsPerUserByFavoriteV2RequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.cursor=e.int64();break;case 2:o.limit=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationsPerUserByTopV2RequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=500,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationsPerUserByTopV2RequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.cursor=e.int64();break;case 2:o.limit=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationInfoV2RequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationInfoV2RequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationInfoListV2RequestBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_info_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var n=0;n<e.conversation_info_list.length;++n)d.im_proto.GetConversationInfoV2RequestBody.encode(e.conversation_info_list[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationInfoListV2RequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversation_info_list&&o.conversation_info_list.length||(o.conversation_info_list=[]),o.conversation_info_list.push(d.im_proto.GetConversationInfoV2RequestBody.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.GetConversationInfoListV2ResponseBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_info_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var n=0;n<e.conversation_info_list.length;++n)d.im_proto.ConversationInfoV2.encode(e.conversation_info_list[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationInfoListV2ResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversation_info_list&&o.conversation_info_list.length||(o.conversation_info_list=[]),o.conversation_info_list.push(d.im_proto.ConversationInfoV2.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.GetConversationInfoListByFavoriteV2ResponseBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_info_list=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var n=0;n<e.conversation_info_list.length;++n)d.im_proto.ConversationInfoV2.encode(e.conversation_info_list[n],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationInfoListByFavoriteV2ResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_info_list&&o.conversation_info_list.length||(o.conversation_info_list=[]),o.conversation_info_list.push(d.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cursor=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationInfoListByTopV2ResponseBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_info_list=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var n=0;n<e.conversation_info_list.length;++n)d.im_proto.ConversationInfoV2.encode(e.conversation_info_list[n],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationInfoListByTopV2ResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_info_list&&o.conversation_info_list.length||(o.conversation_info_list=[]),o.conversation_info_list.push(d.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cursor=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.RecallMessageRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.RecallMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.server_message_id=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationAddParticipantsRequestBody=function(){function e(e){if(this.participants=[],this.biz_ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.participants=c.emptyArray,e.prototype.biz_ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.participants&&e.participants.length)for(var n=0;n<e.participants.length;++n)t.uint32(32).int64(e.participants[n]);if(null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext")){var o=Object.keys(e.biz_ext);for(n=0;n<o.length;++n)t.uint32(42).fork().uint32(10).string(o[n]).uint32(18).string(e.biz_ext[o[n]]).ldelim()}return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ConversationAddParticipantsRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:if(i.participants&&i.participants.length||(i.participants=[]),2==(7&a))for(var u=e.uint32()+e.pos;e.pos<u;)i.participants.push(e.int64());else i.participants.push(e.int64());break;case 5:i.biz_ext===c.emptyObject&&(i.biz_ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.biz_ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.SecUidPair=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.uid=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.uid&&Object.hasOwnProperty.call(e,"uid")&&t.uint32(8).int64(e.uid),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SecUidPair;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.uid=e.int64();break;case 2:o.sec_uid=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationAddParticipantsResponseBody=function(){function e(e){if(this.success_participants=[],this.failed_participants=[],this.sec_success_participants=[],this.sec_failed_participants=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.success_participants=c.emptyArray,e.prototype.failed_participants=c.emptyArray,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.sec_success_participants=c.emptyArray,e.prototype.sec_failed_participants=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.success_participants&&e.success_participants.length)for(var n=0;n<e.success_participants.length;++n)t.uint32(8).int64(e.success_participants[n]);if(null!=e.failed_participants&&e.failed_participants.length)for(n=0;n<e.failed_participants.length;++n)t.uint32(16).int64(e.failed_participants[n]);if(null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(34).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),null!=e.sec_success_participants&&e.sec_success_participants.length)for(n=0;n<e.sec_success_participants.length;++n)d.im_proto.SecUidPair.encode(e.sec_success_participants[n],t.uint32(58).fork()).ldelim();if(null!=e.sec_failed_participants&&e.sec_failed_participants.length)for(n=0;n<e.sec_failed_participants.length;++n)d.im_proto.SecUidPair.encode(e.sec_failed_participants[n],t.uint32(66).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationAddParticipantsResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:if(o.success_participants&&o.success_participants.length||(o.success_participants=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.success_participants.push(e.int64());else o.success_participants.push(e.int64());break;case 2:if(o.failed_participants&&o.failed_participants.length||(o.failed_participants=[]),2==(7&r))for(i=e.uint32()+e.pos;e.pos<i;)o.failed_participants.push(e.int64());else o.failed_participants.push(e.int64());break;case 3:o.status=e.int32();break;case 4:o.extra_info=e.string();break;case 5:o.check_code=e.int64();break;case 6:o.check_message=e.string();break;case 7:o.sec_success_participants&&o.sec_success_participants.length||(o.sec_success_participants=[]),o.sec_success_participants.push(d.im_proto.SecUidPair.decode(e,e.uint32()));break;case 8:o.sec_failed_participants&&o.sec_failed_participants.length||(o.sec_failed_participants=[]),o.sec_failed_participants.push(d.im_proto.SecUidPair.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.ConversationRemoveParticipantsRequestBody=function(){function e(e){if(this.participants=[],this.biz_ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.participants=c.emptyArray,e.prototype.biz_ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.participants&&e.participants.length)for(var n=0;n<e.participants.length;++n)t.uint32(32).int64(e.participants[n]);if(null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext")){var o=Object.keys(e.biz_ext);for(n=0;n<o.length;++n)t.uint32(42).fork().uint32(10).string(o[n]).uint32(18).string(e.biz_ext[o[n]]).ldelim()}return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ConversationRemoveParticipantsRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:if(i.participants&&i.participants.length||(i.participants=[]),2==(7&a))for(var u=e.uint32()+e.pos;e.pos<u;)i.participants.push(e.int64());else i.participants.push(e.int64());break;case 5:i.biz_ext===c.emptyObject&&(i.biz_ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.biz_ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.ConversationRemoveParticipantsResponseBody=function(){function e(e){if(this.failed_participants=[],this.failed_sec_participants=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.failed_participants=c.emptyArray,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.failed_sec_participants=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.failed_participants&&e.failed_participants.length)for(var n=0;n<e.failed_participants.length;++n)t.uint32(8).int64(e.failed_participants[n]);if(null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(26).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(32).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(42).string(e.check_message),null!=e.failed_sec_participants&&e.failed_sec_participants.length)for(n=0;n<e.failed_sec_participants.length;++n)d.im_proto.SecUidPair.encode(e.failed_sec_participants[n],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationRemoveParticipantsResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:if(o.failed_participants&&o.failed_participants.length||(o.failed_participants=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_participants.push(e.int64());else o.failed_participants.push(e.int64());break;case 2:o.status=e.int32();break;case 3:o.extra_info=e.string();break;case 4:o.check_code=e.int64();break;case 5:o.check_message=e.string();break;case 6:o.failed_sec_participants&&o.failed_sec_participants.length||(o.failed_sec_participants=[]),o.failed_sec_participants.push(d.im_proto.SecUidPair.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.ConversationLeaveRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationLeaveRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationParticipantsListRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=100,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(32).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(40).int32(e.limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationParticipantsListRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.cursor=e.int64();break;case 5:o.limit=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationParticipantsListResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.participants_page=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.participants_page&&Object.hasOwnProperty.call(e,"participants_page")&&d.im_proto.ParticipantsPage.encode(e.participants_page,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationParticipantsListResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.participants_page=d.im_proto.ParticipantsPage.decode(e,e.uint32());else e.skipType(7&r)}return o},e}(),e.MgetConversationParticipantsRequestBody=function(){function e(e){if(this.participants=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.participants=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.participants&&e.participants.length)for(var n=0;n<e.participants.length;++n)t.uint32(32).int64(e.participants[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MgetConversationParticipantsRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:if(o.participants&&o.participants.length||(o.participants=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.participants.push(e.int64());else o.participants.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.MgetConversationParticipantsResponseBody=function(){function e(e){if(this.participants=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.participants=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.participants&&e.participants.length)for(var n=0;n<e.participants.length;++n)d.im_proto.Participant.encode(e.participants[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MgetConversationParticipantsResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.participants&&o.participants.length||(o.participants=[]),o.participants.push(d.im_proto.Participant.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.UpdateConversationParticipantRequestBody=function(){function e(e){if(this.biz_ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.user_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.role=0,e.prototype.alias="",e.prototype.is_alias_set=!1,e.prototype.biz_ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(32).int64(e.user_id),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(40).int32(e.role),null!=e.alias&&Object.hasOwnProperty.call(e,"alias")&&t.uint32(50).string(e.alias),null!=e.is_alias_set&&Object.hasOwnProperty.call(e,"is_alias_set")&&t.uint32(56).bool(e.is_alias_set),null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext"))for(var n=Object.keys(e.biz_ext),o=0;o<n.length;++o)t.uint32(90).fork().uint32(10).string(n[o]).uint32(18).string(e.biz_ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.UpdateConversationParticipantRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:i.user_id=e.int64();break;case 5:i.role=e.int32();break;case 6:i.alias=e.string();break;case 7:i.is_alias_set=e.bool();break;case 11:i.biz_ext===c.emptyObject&&(i.biz_ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.biz_ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.UpdateConversationParticipantResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.participant=null,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.participant&&Object.hasOwnProperty.call(e,"participant")&&d.im_proto.Participant.encode(e.participant,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(26).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(32).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(42).string(e.check_message),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.UpdateConversationParticipantResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.participant=d.im_proto.Participant.decode(e,e.uint32());break;case 2:o.status=e.int32();break;case 3:o.extra_info=e.string();break;case 4:o.check_code=e.int64();break;case 5:o.check_message=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationCoreInfoRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationCoreInfoRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationCoreInfoResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_core_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_core_info&&Object.hasOwnProperty.call(e,"conversation_core_info")&&d.im_proto.ConversationCoreInfo.encode(e.conversation_core_info,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationCoreInfoResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversation_core_info=d.im_proto.ConversationCoreInfo.decode(e,e.uint32());else e.skipType(7&r)}return o},e}(),e.SetConversationCoreInfoRequestBody=function(){function e(e){if(this.ext={},this.biz_ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.name="",e.prototype.desc="",e.prototype.icon="",e.prototype.notice="",e.prototype.is_name_set=!1,e.prototype.is_desc_set=!1,e.prototype.is_icon_set=!1,e.prototype.is_notice_set=!1,e.prototype.ext=c.emptyObject,e.prototype.biz_ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(34).string(e.name),null!=e.desc&&Object.hasOwnProperty.call(e,"desc")&&t.uint32(42).string(e.desc),null!=e.icon&&Object.hasOwnProperty.call(e,"icon")&&t.uint32(50).string(e.icon),null!=e.notice&&Object.hasOwnProperty.call(e,"notice")&&t.uint32(58).string(e.notice),null!=e.is_name_set&&Object.hasOwnProperty.call(e,"is_name_set")&&t.uint32(64).bool(e.is_name_set),null!=e.is_desc_set&&Object.hasOwnProperty.call(e,"is_desc_set")&&t.uint32(72).bool(e.is_desc_set),null!=e.is_icon_set&&Object.hasOwnProperty.call(e,"is_icon_set")&&t.uint32(80).bool(e.is_icon_set),null!=e.is_notice_set&&Object.hasOwnProperty.call(e,"is_notice_set")&&t.uint32(88).bool(e.is_notice_set),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(98).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();if(null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext"))for(n=Object.keys(e.biz_ext),o=0;o<n.length;++o)t.uint32(186).fork().uint32(10).string(n[o]).uint32(18).string(e.biz_ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.SetConversationCoreInfoRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:i.name=e.string();break;case 5:i.desc=e.string();break;case 6:i.icon=e.string();break;case 7:i.notice=e.string();break;case 8:i.is_name_set=e.bool();break;case 9:i.is_desc_set=e.bool();break;case 10:i.is_icon_set=e.bool();break;case 11:i.is_notice_set=e.bool();break;case 12:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){switch((l=e.uint32())>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 23:i.biz_ext===c.emptyObject&&(i.biz_ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l;switch((l=e.uint32())>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.biz_ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.SetConversationCoreInfoResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_core_info=null,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_core_info&&Object.hasOwnProperty.call(e,"conversation_core_info")&&d.im_proto.ConversationCoreInfo.encode(e.conversation_core_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(26).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(32).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(42).string(e.check_message),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SetConversationCoreInfoResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_core_info=d.im_proto.ConversationCoreInfo.decode(e,e.uint32());break;case 2:o.status=e.int32();break;case 3:o.extra_info=e.string();break;case 4:o.check_code=e.int64();break;case 5:o.check_message=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.UpsertConversationCoreExtInfoRequestBody=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(34).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.UpsertConversationCoreExtInfoRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.UpsertConversationCoreExtInfoResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.core_info=null,e.prototype.status=0,e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.core_info&&Object.hasOwnProperty.call(e,"core_info")&&d.im_proto.ConversationCoreInfo.encode(e.core_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(24).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(34).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).string(e.extra_info),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.UpsertConversationCoreExtInfoResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.core_info=d.im_proto.ConversationCoreInfo.decode(e,e.uint32());break;case 2:o.status=e.int32();break;case 3:o.check_code=e.int64();break;case 4:o.check_message=e.string();break;case 5:o.extra_info=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.SetConversationSettingInfoRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.set_stick_on_top=!1,e.prototype.set_mute=!1,e.prototype.set_favorite=!1,e.prototype.push_status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.set_stick_on_top&&Object.hasOwnProperty.call(e,"set_stick_on_top")&&t.uint32(32).bool(e.set_stick_on_top),null!=e.set_mute&&Object.hasOwnProperty.call(e,"set_mute")&&t.uint32(40).bool(e.set_mute),null!=e.set_favorite&&Object.hasOwnProperty.call(e,"set_favorite")&&t.uint32(48).bool(e.set_favorite),null!=e.push_status&&Object.hasOwnProperty.call(e,"push_status")&&t.uint32(56).int32(e.push_status),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SetConversationSettingInfoRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.set_stick_on_top=e.bool();break;case 5:o.set_mute=e.bool();break;case 6:o.set_favorite=e.bool();break;case 7:o.push_status=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.SetConversationSettingInfoResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.setting_info=null,e.prototype.status=0,e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.setting_info&&Object.hasOwnProperty.call(e,"setting_info")&&d.im_proto.ConversationSettingInfo.encode(e.setting_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(24).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(34).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).string(e.extra_info),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SetConversationSettingInfoResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.setting_info=d.im_proto.ConversationSettingInfo.decode(e,e.uint32());break;case 2:o.status=e.int32();break;case 3:o.check_code=e.int64();break;case 4:o.check_message=e.string();break;case 5:o.extra_info=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.UpsertConversationSettingExtInfoRequestBody=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(34).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.UpsertConversationSettingExtInfoRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_short_id=e.int64();break;case 3:i.conversation_type=e.int32();break;case 4:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.UpsertConversationSettingExtInfoResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.setting_info=null,e.prototype.status=0,e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.setting_info&&Object.hasOwnProperty.call(e,"setting_info")&&d.im_proto.ConversationSettingInfo.encode(e.setting_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(24).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(34).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).string(e.extra_info),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.UpsertConversationSettingExtInfoResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.setting_info=d.im_proto.ConversationSettingInfo.decode(e,e.uint32());break;case 2:o.status=e.int32();break;case 3:o.check_code=e.int64();break;case 4:o.check_message=e.string();break;case 5:o.extra_info=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.StrangerConversation=function(){function e(e){if(this.participants=[],this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.unread=0,e.prototype.last_message=null,e.prototype.conversation_id="",e.prototype.participants=c.emptyArray,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.unread&&Object.hasOwnProperty.call(e,"unread")&&t.uint32(16).int32(e.unread),null!=e.last_message&&Object.hasOwnProperty.call(e,"last_message")&&d.im_proto.MessageBody.encode(e.last_message,t.uint32(26).fork()).ldelim(),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(34).string(e.conversation_id),null!=e.participants&&e.participants.length)for(var n=0;n<e.participants.length;++n)d.im_proto.Participant.encode(e.participants[n],t.uint32(42).fork()).ldelim();if(null!=e.ext&&Object.hasOwnProperty.call(e,"ext")){var o=Object.keys(e.ext);for(n=0;n<o.length;++n)t.uint32(58).fork().uint32(10).string(o[n]).uint32(18).string(e.ext[o[n]]).ldelim()}return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.StrangerConversation;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_short_id=e.int64();break;case 2:i.unread=e.int32();break;case 3:i.last_message=d.im_proto.MessageBody.decode(e,e.uint32());break;case 4:i.conversation_id=e.string();break;case 5:i.participants&&i.participants.length||(i.participants=[]),i.participants.push(d.im_proto.Participant.decode(e,e.uint32()));break;case 7:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.GetStrangerConversationListRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.count=c.Long?c.Long.fromBits(50,0,!1):50,e.prototype.show_total_unread=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.count&&Object.hasOwnProperty.call(e,"count")&&t.uint32(16).int64(e.count),null!=e.show_total_unread&&Object.hasOwnProperty.call(e,"show_total_unread")&&t.uint32(24).bool(e.show_total_unread),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetStrangerConversationListRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.cursor=e.int64();break;case 2:o.count=e.int64();break;case 3:o.show_total_unread=e.bool();break;default:e.skipType(7&r)}}return o},e}(),e.GetStrangerConversationListResponseBody=function(){function e(e){if(this.conversation_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.prototype.total_unread=0,e.prototype.conversation_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(8).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.total_unread&&Object.hasOwnProperty.call(e,"total_unread")&&t.uint32(24).int32(e.total_unread),null!=e.conversation_list&&e.conversation_list.length)for(var n=0;n<e.conversation_list.length;++n)d.im_proto.StrangerConversation.encode(e.conversation_list[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetStrangerConversationListResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.next_cursor=e.int64();break;case 2:o.has_more=e.bool();break;case 3:o.total_unread=e.int32();break;case 4:o.conversation_list&&o.conversation_list.length||(o.conversation_list=[]),o.conversation_list.push(d.im_proto.StrangerConversation.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.GetStrangerMessagesRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.reset_unread_count=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.reset_unread_count&&Object.hasOwnProperty.call(e,"reset_unread_count")&&t.uint32(16).bool(e.reset_unread_count),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetStrangerMessagesRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.reset_unread_count=e.bool();break;default:e.skipType(7&r)}}return o},e}(),e.GetStrangerMessagesResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetStrangerMessagesResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==3)o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.DeleteStrangerMessageRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.DeleteStrangerMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.server_message_id=e.int64();break;case 2:o.conversation_short_id=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.DeleteStrangerConversationRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.DeleteStrangerConversationRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversation_short_id=e.int64();else e.skipType(7&r)}return o},e}(),e.DeleteStrangerAllConversationRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.DeleteStrangerAllConversationRequestBody;e.pos<n;){var r=e.uint32();e.skipType(7&r)}return o},e}(),e.MarkStrangerConversationReadRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MarkStrangerConversationReadRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversation_short_id=e.int64();else e.skipType(7&r)}return o},e}(),e.MarkStrangerAllConversationReadRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MarkStrangerAllConversationReadRequestBody;e.pos<n;){var r=e.uint32();e.skipType(7&r)}return o},e}(),e.OPERATION_TYPE=function(){const e={},t=Object.create(e);return t[e[0]="ADD_PROPERTY_ITEM"]=0,t[e[1]="REMOVE_PROPERTY_ITEM"]=1,t[e[2]="SET_PROPERTY"]=2,t[e[3]="DEL_PROPERTY"]=3,t}(),e.ModifyPropertyContent=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.operation=0,e.prototype.key="",e.prototype.value="",e.prototype.idempotent_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.operation&&Object.hasOwnProperty.call(e,"operation")&&t.uint32(8).int32(e.operation),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(18).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(34).string(e.idempotent_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ModifyPropertyContent;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.operation=e.int32();break;case 2:o.key=e.string();break;case 3:o.value=e.string();break;case 4:o.idempotent_id=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.ModifyPropertyBody=function(){function e(e){if(this.modify_property_content=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.client_message_id="",e.prototype.modify_property_content=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(42).string(e.client_message_id),null!=e.modify_property_content&&e.modify_property_content.length)for(var n=0;n<e.modify_property_content.length;++n)d.im_proto.ModifyPropertyContent.encode(e.modify_property_content[n],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ModifyPropertyBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.server_message_id=e.int64();break;case 5:o.client_message_id=e.string();break;case 6:o.modify_property_content&&o.modify_property_content.length||(o.modify_property_content=[]),o.modify_property_content.push(d.im_proto.ModifyPropertyContent.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.ModifyMessagePropertyRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.property_list=null,e.prototype.ticket="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.property_list&&Object.hasOwnProperty.call(e,"property_list")&&d.im_proto.ModifyPropertyBody.encode(e.property_list,t.uint32(10).fork()).ldelim(),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(18).string(e.ticket),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ModifyMessagePropertyRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.property_list=d.im_proto.ModifyPropertyBody.decode(e,e.uint32());break;case 2:o.ticket=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.ModifyMessagePropertyStatus=function(){const e={},t=Object.create(e);return t[e[0]="MODIFY_PROPERTY_SUCCESS"]=0,t[e[1]="MODIFY_PROPERTY_REPEAT_REQUEST"]=1,t[e[2]="MODIFY_PROPERTY_INVALID_LENGTH"]=2,t[e[3]="MODIFY_PROPERTY_INVALID_REQUEST"]=3,t[e[4]="MODIFY_PROPERTY_CALLBACK_ERROR"]=4,t[e[500]="MODIFY_PROPERTY_INTERNAL_ERROR"]=500,t}(),e.ModifyMessagePropertyResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.status=0,e.prototype.version=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(8).int32(e.status),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ModifyMessagePropertyResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.status=e.int32();break;case 2:o.version=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.MediaType=function(){const e={},t=Object.create(e);return t[e[1]="IMG"]=1,t[e[2]="VIDEO"]=2,t[e[3]="AUDIO"]=3,t[e[4]="FILE"]=4,t[e[10]="OTHER"]=10,t}(),e.MediaTokenType=function(){const e={},t=Object.create(e);return t[e[1]="VSDK"]=1,t[e[2]="IMAGEX"]=2,t[e[3]="VSDK_V5"]=3,t[e[4]="IMAGEX_V5"]=4,t}(),e.GetUploadTokenRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.vsdk_version="",e.prototype.token_type=1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.vsdk_version&&Object.hasOwnProperty.call(e,"vsdk_version")&&t.uint32(10).string(e.vsdk_version),null!=e.token_type&&Object.hasOwnProperty.call(e,"token_type")&&t.uint32(16).int32(e.token_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetUploadTokenRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.vsdk_version=e.string();break;case 2:o.token_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetUploadTokenResponseBody=function(){function e(e){if(this.hosts=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.access_key="",e.prototype.hosts=c.emptyArray,e.prototype.token="",e.prototype.token_type=1,e.prototype.secret_access_key="",e.prototype.space_name="",e.prototype.service_id="",e.prototype.expire_time="",e.prototype.current_time="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.access_key&&Object.hasOwnProperty.call(e,"access_key")&&t.uint32(10).string(e.access_key),null!=e.hosts&&e.hosts.length)for(var n=0;n<e.hosts.length;++n)t.uint32(18).string(e.hosts[n]);return null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(26).string(e.token),null!=e.token_type&&Object.hasOwnProperty.call(e,"token_type")&&t.uint32(32).int32(e.token_type),null!=e.secret_access_key&&Object.hasOwnProperty.call(e,"secret_access_key")&&t.uint32(42).string(e.secret_access_key),null!=e.space_name&&Object.hasOwnProperty.call(e,"space_name")&&t.uint32(50).string(e.space_name),null!=e.service_id&&Object.hasOwnProperty.call(e,"service_id")&&t.uint32(58).string(e.service_id),null!=e.expire_time&&Object.hasOwnProperty.call(e,"expire_time")&&t.uint32(66).string(e.expire_time),null!=e.current_time&&Object.hasOwnProperty.call(e,"current_time")&&t.uint32(74).string(e.current_time),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetUploadTokenResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.access_key=e.string();break;case 2:o.hosts&&o.hosts.length||(o.hosts=[]),o.hosts.push(e.string());break;case 3:o.token=e.string();break;case 4:o.token_type=e.int32();break;case 5:o.secret_access_key=e.string();break;case 6:o.space_name=e.string();break;case 7:o.service_id=e.string();break;case 8:o.expire_time=e.string();break;case 9:o.current_time=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.ImgOption=function(){function e(e){if(this.params=[],this.urls=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tplv="",e.prototype.params=c.emptyArray,e.prototype.format="",e.prototype.urls=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.tplv&&Object.hasOwnProperty.call(e,"tplv")&&t.uint32(10).string(e.tplv),null!=e.params&&e.params.length)for(var n=0;n<e.params.length;++n)t.uint32(18).string(e.params[n]);if(null!=e.format&&Object.hasOwnProperty.call(e,"format")&&t.uint32(26).string(e.format),null!=e.urls&&e.urls.length)for(n=0;n<e.urls.length;++n)t.uint32(802).string(e.urls[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ImgOption;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.tplv=e.string();break;case 2:o.params&&o.params.length||(o.params=[]),o.params.push(e.string());break;case 3:o.format=e.string();break;case 100:o.urls&&o.urls.length||(o.urls=[]),o.urls.push(e.string());break;default:e.skipType(7&r)}}return o},e}(),e.VideoOption=function(){function e(e){if(this.urls=[],this.cover_urls=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.vid="",e.prototype.cover_uri="",e.prototype.urls=c.emptyArray,e.prototype.cover_urls=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.vid&&Object.hasOwnProperty.call(e,"vid")&&t.uint32(10).string(e.vid),null!=e.cover_uri&&Object.hasOwnProperty.call(e,"cover_uri")&&t.uint32(18).string(e.cover_uri),null!=e.urls&&e.urls.length)for(var n=0;n<e.urls.length;++n)t.uint32(802).string(e.urls[n]);if(null!=e.cover_urls&&e.cover_urls.length)for(n=0;n<e.cover_urls.length;++n)t.uint32(810).string(e.cover_urls[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.VideoOption;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.vid=e.string();break;case 2:o.cover_uri=e.string();break;case 100:o.urls&&o.urls.length||(o.urls=[]),o.urls.push(e.string());break;case 101:o.cover_urls&&o.cover_urls.length||(o.cover_urls=[]),o.cover_urls.push(e.string());break;default:e.skipType(7&r)}}return o},e}(),e.AudioOption=function(){function e(e){if(this.urls=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.vid="",e.prototype.urls=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.vid&&Object.hasOwnProperty.call(e,"vid")&&t.uint32(10).string(e.vid),null!=e.urls&&e.urls.length)for(var n=0;n<e.urls.length;++n)t.uint32(802).string(e.urls[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.AudioOption;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.vid=e.string();break;case 100:o.urls&&o.urls.length||(o.urls=[]),o.urls.push(e.string());break;default:e.skipType(7&r)}}return o},e}(),e.FileOption=function(){function e(e){if(this.urls=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.urls=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.urls&&e.urls.length)for(var n=0;n<e.urls.length;++n)t.uint32(802).string(e.urls[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.FileOption;e.pos<n;){var r=e.uint32();if(r>>>3==100)o.urls&&o.urls.length||(o.urls=[]),o.urls.push(e.string());else e.skipType(7&r)}return o},e}(),e.ReadURLFrom=function(){const e={},t=Object.create(e);return t[e[1]="URL_VSDK"]=1,t[e[2]="URL_IMAGEX"]=2,t}(),e.GetMediaUrlsRequestBody=function(){function e(e){if(this.img_options=[],this.video_options=[],this.audio_options=[],this.file_options=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.source_appid=0,e.prototype.uri="",e.prototype.media_type=0,e.prototype.encrypted=!1,e.prototype.img_options=c.emptyArray,e.prototype.video_options=c.emptyArray,e.prototype.audio_options=c.emptyArray,e.prototype.file_options=c.emptyArray,e.prototype.encrypted_uri="",e.prototype.read_url_from=1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.source_appid&&Object.hasOwnProperty.call(e,"source_appid")&&t.uint32(8).int32(e.source_appid),null!=e.uri&&Object.hasOwnProperty.call(e,"uri")&&t.uint32(18).string(e.uri),null!=e.media_type&&Object.hasOwnProperty.call(e,"media_type")&&t.uint32(24).int32(e.media_type),null!=e.encrypted&&Object.hasOwnProperty.call(e,"encrypted")&&t.uint32(32).bool(e.encrypted),null!=e.img_options&&e.img_options.length)for(var n=0;n<e.img_options.length;++n)d.im_proto.ImgOption.encode(e.img_options[n],t.uint32(42).fork()).ldelim();if(null!=e.video_options&&e.video_options.length)for(n=0;n<e.video_options.length;++n)d.im_proto.VideoOption.encode(e.video_options[n],t.uint32(50).fork()).ldelim();if(null!=e.audio_options&&e.audio_options.length)for(n=0;n<e.audio_options.length;++n)d.im_proto.AudioOption.encode(e.audio_options[n],t.uint32(58).fork()).ldelim();if(null!=e.file_options&&e.file_options.length)for(n=0;n<e.file_options.length;++n)d.im_proto.FileOption.encode(e.file_options[n],t.uint32(66).fork()).ldelim();return null!=e.encrypted_uri&&Object.hasOwnProperty.call(e,"encrypted_uri")&&t.uint32(74).string(e.encrypted_uri),null!=e.read_url_from&&Object.hasOwnProperty.call(e,"read_url_from")&&t.uint32(80).int32(e.read_url_from),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetMediaUrlsRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.source_appid=e.int32();break;case 2:o.uri=e.string();break;case 3:o.media_type=e.int32();break;case 4:o.encrypted=e.bool();break;case 5:o.img_options&&o.img_options.length||(o.img_options=[]),o.img_options.push(d.im_proto.ImgOption.decode(e,e.uint32()));break;case 6:o.video_options&&o.video_options.length||(o.video_options=[]),o.video_options.push(d.im_proto.VideoOption.decode(e,e.uint32()));break;case 7:o.audio_options&&o.audio_options.length||(o.audio_options=[]),o.audio_options.push(d.im_proto.AudioOption.decode(e,e.uint32()));break;case 8:o.file_options&&o.file_options.length||(o.file_options=[]),o.file_options.push(d.im_proto.FileOption.decode(e,e.uint32()));break;case 9:o.encrypted_uri=e.string();break;case 10:o.read_url_from=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetMediaUrlsResponseBody=function(){function e(e){if(this.img_options=[],this.video_options=[],this.audio_options=[],this.file_options=[],this.encrypted_urls=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.uri="",e.prototype.media_type=0,e.prototype.img_options=c.emptyArray,e.prototype.video_options=c.emptyArray,e.prototype.audio_options=c.emptyArray,e.prototype.file_options=c.emptyArray,e.prototype.encrypted_urls=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.uri&&Object.hasOwnProperty.call(e,"uri")&&t.uint32(10).string(e.uri),null!=e.media_type&&Object.hasOwnProperty.call(e,"media_type")&&t.uint32(16).int32(e.media_type),null!=e.img_options&&e.img_options.length)for(var n=0;n<e.img_options.length;++n)d.im_proto.ImgOption.encode(e.img_options[n],t.uint32(26).fork()).ldelim();if(null!=e.video_options&&e.video_options.length)for(n=0;n<e.video_options.length;++n)d.im_proto.VideoOption.encode(e.video_options[n],t.uint32(34).fork()).ldelim();if(null!=e.audio_options&&e.audio_options.length)for(n=0;n<e.audio_options.length;++n)d.im_proto.AudioOption.encode(e.audio_options[n],t.uint32(42).fork()).ldelim();if(null!=e.file_options&&e.file_options.length)for(n=0;n<e.file_options.length;++n)d.im_proto.FileOption.encode(e.file_options[n],t.uint32(50).fork()).ldelim();if(null!=e.encrypted_urls&&e.encrypted_urls.length)for(n=0;n<e.encrypted_urls.length;++n)t.uint32(58).string(e.encrypted_urls[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetMediaUrlsResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.uri=e.string();break;case 2:o.media_type=e.int32();break;case 3:o.img_options&&o.img_options.length||(o.img_options=[]),o.img_options.push(d.im_proto.ImgOption.decode(e,e.uint32()));break;case 4:o.video_options&&o.video_options.length||(o.video_options=[]),o.video_options.push(d.im_proto.VideoOption.decode(e,e.uint32()));break;case 5:o.audio_options&&o.audio_options.length||(o.audio_options=[]),o.audio_options.push(d.im_proto.AudioOption.decode(e,e.uint32()));break;case 6:o.file_options&&o.file_options.length||(o.file_options=[]),o.file_options.push(d.im_proto.FileOption.decode(e,e.uint32()));break;case 7:o.encrypted_urls&&o.encrypted_urls.length||(o.encrypted_urls=[]),o.encrypted_urls.push(e.string());break;default:e.skipType(7&r)}}return o},e}(),e.GetTicketRequestBody=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.ticket_type=1,e.prototype.conversation_type=1,e.prototype.to_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.ticket_type&&Object.hasOwnProperty.call(e,"ticket_type")&&t.uint32(8).int32(e.ticket_type),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.to_id&&Object.hasOwnProperty.call(e,"to_id")&&t.uint32(32).int64(e.to_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(40).int64(e.conversation_short_id),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(82).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.GetTicketRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.ticket_type=e.int32();break;case 2:i.conversation_type=e.int32();break;case 4:i.to_id=e.int64();break;case 5:i.conversation_short_id=e.int64();break;case 10:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.GetTicketResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.ticket="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(10).string(e.ticket),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetTicketResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.ticket=e.string();else e.skipType(7&r)}return o},e}(),e.SortType=function(){const e={},t=Object.create(e);return t[e[1]="JOIN_TIME"]=1,t[e[2]="CREATED_TIME"]=2,t[e[3]="GROUP_NAME"]=3,t[e[4]="ACTIVE_TIME"]=4,t}(),e.GetUserConversationListRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sort_type=1,e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.con_type=1,e.prototype.limit=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.include_role=0,e.prototype.exclude_role=0,e.prototype.with_cold=!1,e.prototype.push_status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.sort_type&&Object.hasOwnProperty.call(e,"sort_type")&&t.uint32(8).int32(e.sort_type),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(16).int64(e.cursor),null!=e.con_type&&Object.hasOwnProperty.call(e,"con_type")&&t.uint32(24).int32(e.con_type),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(32).int64(e.limit),null!=e.include_role&&Object.hasOwnProperty.call(e,"include_role")&&t.uint32(40).int32(e.include_role),null!=e.exclude_role&&Object.hasOwnProperty.call(e,"exclude_role")&&t.uint32(48).int32(e.exclude_role),null!=e.with_cold&&Object.hasOwnProperty.call(e,"with_cold")&&t.uint32(64).bool(e.with_cold),null!=e.push_status&&Object.hasOwnProperty.call(e,"push_status")&&t.uint32(80).int32(e.push_status),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetUserConversationListRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.sort_type=e.int32();break;case 2:o.cursor=e.int64();break;case 3:o.con_type=e.int32();break;case 4:o.limit=e.int64();break;case 5:o.include_role=e.int32();break;case 6:o.exclude_role=e.int32();break;case 8:o.with_cold=e.bool();break;case 10:o.push_status=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetUserConversationListResponseBody=function(){function e(e){if(this.list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.list=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.list&&e.list.length)for(var n=0;n<e.list.length;++n)d.im_proto.ConversationInfoV2.encode(e.list[n],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetUserConversationListResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.list&&o.list.length||(o.list=[]),o.list.push(d.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cursor=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.ModifyMessageExtRequestBody=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ticket="",e.prototype.ext=c.emptyObject,e.prototype.is_edited=!1,e.prototype.content="",e.prototype.conversation_type=0,e.prototype.message_type=0,e.prototype.conversation_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.conversation_short_id),t.uint32(16).int64(e.message_id),t.uint32(26).string(e.ticket),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(34).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return null!=e.is_edited&&Object.hasOwnProperty.call(e,"is_edited")&&t.uint32(40).bool(e.is_edited),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(50).string(e.content),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(56).int32(e.conversation_type),null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(64).int32(e.message_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(74).string(e.conversation_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ModifyMessageExtRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_short_id=e.int64();break;case 2:i.message_id=e.int64();break;case 3:i.ticket=e.string();break;case 4:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 5:i.is_edited=e.bool();break;case 6:i.content=e.string();break;case 7:i.conversation_type=e.int32();break;case 8:i.message_type=e.int32();break;case 9:i.conversation_id=e.string();break;default:e.skipType(7&a)}}if(!i.hasOwnProperty("conversation_short_id"))throw c.ProtocolError("missing required 'conversation_short_id'",{instance:i});if(!i.hasOwnProperty("message_id"))throw c.ProtocolError("missing required 'message_id'",{instance:i});if(!i.hasOwnProperty("ticket"))throw c.ProtocolError("missing required 'ticket'",{instance:i});return i},e}(),e.ModifyMessageExtResponseBody=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.ext=c.emptyObject,e.prototype.version=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(10).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ModifyMessageExtResponseBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 2:i.version=e.int64();break;default:e.skipType(7&a)}}return i},e}(),e.RequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.send_message_body=null,e.prototype.messages_per_user_body=null,e.prototype.messages_per_user_init_v2_body=null,e.prototype.get_message_by_id_body=null,e.prototype.messages_in_conversation_body=null,e.prototype.get_messages_checkinfo_in_conversation_body=null,e.prototype.send_user_action_body=null,e.prototype.send_input_status_body=null,e.prototype.delete_conversation_body=null,e.prototype.mark_conversation_read_body=null,e.prototype.conversation_participants_body=null,e.prototype.batch_mark_read_body=null,e.prototype.dissolve_conversation_body=null,e.prototype.create_conversation_v2_body=null,e.prototype.get_conversation_info_list_v2_body=null,e.prototype.get_conversation_info_list_by_favorite_v2_body=null,e.prototype.get_conversation_info_list_by_top_v2_body=null,e.prototype.conversation_add_participants_body=null,e.prototype.conversation_remove_participants_body=null,e.prototype.leave_conversation_body=null,e.prototype.mget_conversation_participants_body=null,e.prototype.update_conversation_participant_body=null,e.prototype.delete_message_body=null,e.prototype.recall_message_body=null,e.prototype.modify_message_property_body=null,e.prototype.audio_recognition_body=null,e.prototype.get_conversation_core_info_body=null,e.prototype.set_conversation_core_info_body=null,e.prototype.upsert_conversation_core_ext_info_body=null,e.prototype.set_conversation_setting_info_body=null,e.prototype.upsert_conversation_setting_ext_info_body=null,e.prototype.get_stranger_conversation_body=null,e.prototype.get_stranger_messages_body=null,e.prototype.delete_stranger_message_body=null,e.prototype.delete_stranger_conversation_body=null,e.prototype.delete_stranger_all_conversation_body=null,e.prototype.mark_stranger_conversation_read_body=null,e.prototype.mark_stranger_all_conversation_read_body=null,e.prototype.participants_read_index_body=null,e.prototype.participants_min_index_body=null,e.prototype.get_upload_token_body=null,e.prototype.get_media_urls_body=null,e.prototype.get_ticket_body=null,e.prototype.get_conversation_list_body=null,e.prototype.broadcast_send_message_body=null,e.prototype.broadcast_recv_message_body=null,e.prototype.broadcast_user_counter_body=null,e.prototype.client_ack_body=null,e.prototype.create_voip_body=null,e.prototype.call_voip_body=null,e.prototype.update_voip_body=null,e.prototype.channel_heartbeat_body=null,e.prototype.profile_get_info=null,e.prototype.report_client_metrics_body=null,e.prototype.get_configs_body=null,e.prototype.modify_message_ext_body=null,e.prototype.unread_count_report_body=null,e.prototype.block_members_body=null,e.prototype.block_conversation_body=null,e.prototype.get_unread_count_body=null,e.prototype.send_message_p2p_body=null,e.prototype.get_blocklist_body=null,e.prototype.set_blocklist_body=null,e.prototype.check_in_blocklist_body=null,e.prototype.mark_message_body=null,e.prototype.pull_mark_message_body=null,e.prototype.batch_get_conversation_participants_readindex=null,e.prototype.message_by_init=null,e.prototype.get_user_message=null,e.prototype.mark_msg_unread_count_report=null,e.prototype.mark_msg_get_unread_count=null,e.prototype.batch_unmark_message=null,e.prototype.client_batch_ack_body=null,e.prototype.get_tag_meta_info_body=null,e.prototype.set_conversation_tag_body=null,e.prototype.manage_tag_meta_info_body=null,e.prototype.get_conversations_by_tag_body=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.send_message_body&&Object.hasOwnProperty.call(e,"send_message_body")&&d.im_proto.SendMessageRequestBody.encode(e.send_message_body,t.uint32(802).fork()).ldelim(),null!=e.messages_per_user_body&&Object.hasOwnProperty.call(e,"messages_per_user_body")&&d.im_proto.MessagesPerUserRequestBody.encode(e.messages_per_user_body,t.uint32(1602).fork()).ldelim(),null!=e.messages_per_user_init_v2_body&&Object.hasOwnProperty.call(e,"messages_per_user_init_v2_body")&&d.im_proto.MessagesPerUserInitV2RequestBody.encode(e.messages_per_user_init_v2_body,t.uint32(1626).fork()).ldelim(),null!=e.get_message_by_id_body&&Object.hasOwnProperty.call(e,"get_message_by_id_body")&&d.im_proto.GetMessageByIdRequestBody.encode(e.get_message_by_id_body,t.uint32(1690).fork()).ldelim(),null!=e.messages_in_conversation_body&&Object.hasOwnProperty.call(e,"messages_in_conversation_body")&&d.im_proto.MessagesInConversationRequestBody.encode(e.messages_in_conversation_body,t.uint32(2410).fork()).ldelim(),null!=e.get_messages_checkinfo_in_conversation_body&&Object.hasOwnProperty.call(e,"get_messages_checkinfo_in_conversation_body")&&d.im_proto.GetMessagesCheckInfoInConversationRequestBody.encode(e.get_messages_checkinfo_in_conversation_body,t.uint32(2418).fork()).ldelim(),null!=e.send_user_action_body&&Object.hasOwnProperty.call(e,"send_user_action_body")&&d.im_proto.SendUserActionRequestBody.encode(e.send_user_action_body,t.uint32(3282).fork()).ldelim(),null!=e.send_input_status_body&&Object.hasOwnProperty.call(e,"send_input_status_body")&&d.im_proto.SendInputStatusRequestBody.encode(e.send_input_status_body,t.uint32(3290).fork()).ldelim(),null!=e.delete_conversation_body&&Object.hasOwnProperty.call(e,"delete_conversation_body")&&d.im_proto.DeleteConversationRequestBody.encode(e.delete_conversation_body,t.uint32(4826).fork()).ldelim(),null!=e.mark_conversation_read_body&&Object.hasOwnProperty.call(e,"mark_conversation_read_body")&&d.im_proto.MarkConversationReadRequestBody.encode(e.mark_conversation_read_body,t.uint32(4834).fork()).ldelim(),null!=e.conversation_participants_body&&Object.hasOwnProperty.call(e,"conversation_participants_body")&&d.im_proto.ConversationParticipantsListRequestBody.encode(e.conversation_participants_body,t.uint32(4842).fork()).ldelim(),null!=e.create_conversation_v2_body&&Object.hasOwnProperty.call(e,"create_conversation_v2_body")&&d.im_proto.CreateConversationV2RequestBody.encode(e.create_conversation_v2_body,t.uint32(4874).fork()).ldelim(),null!=e.get_conversation_info_list_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_v2_body")&&d.im_proto.GetConversationInfoListV2RequestBody.encode(e.get_conversation_info_list_v2_body,t.uint32(4882).fork()).ldelim(),null!=e.get_conversation_info_list_by_favorite_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_favorite_v2_body")&&d.im_proto.ConversationsPerUserByFavoriteV2RequestBody.encode(e.get_conversation_info_list_by_favorite_v2_body,t.uint32(4890).fork()).ldelim(),null!=e.get_conversation_info_list_by_top_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_top_v2_body")&&d.im_proto.ConversationsPerUserByTopV2RequestBody.encode(e.get_conversation_info_list_by_top_v2_body,t.uint32(4898).fork()).ldelim(),null!=e.batch_mark_read_body&&Object.hasOwnProperty.call(e,"batch_mark_read_body")&&d.im_proto.BatchMarkConversationReadRequestBody.encode(e.batch_mark_read_body,t.uint32(4906).fork()).ldelim(),null!=e.dissolve_conversation_body&&Object.hasOwnProperty.call(e,"dissolve_conversation_body")&&d.im_proto.DissolveConversationRequestBody.encode(e.dissolve_conversation_body,t.uint32(4914).fork()).ldelim(),null!=e.conversation_add_participants_body&&Object.hasOwnProperty.call(e,"conversation_add_participants_body")&&d.im_proto.ConversationAddParticipantsRequestBody.encode(e.conversation_add_participants_body,t.uint32(5202).fork()).ldelim(),null!=e.conversation_remove_participants_body&&Object.hasOwnProperty.call(e,"conversation_remove_participants_body")&&d.im_proto.ConversationRemoveParticipantsRequestBody.encode(e.conversation_remove_participants_body,t.uint32(5210).fork()).ldelim(),null!=e.leave_conversation_body&&Object.hasOwnProperty.call(e,"leave_conversation_body")&&d.im_proto.ConversationLeaveRequestBody.encode(e.leave_conversation_body,t.uint32(5218).fork()).ldelim(),null!=e.mget_conversation_participants_body&&Object.hasOwnProperty.call(e,"mget_conversation_participants_body")&&d.im_proto.MgetConversationParticipantsRequestBody.encode(e.mget_conversation_participants_body,t.uint32(5234).fork()).ldelim(),null!=e.update_conversation_participant_body&&Object.hasOwnProperty.call(e,"update_conversation_participant_body")&&d.im_proto.UpdateConversationParticipantRequestBody.encode(e.update_conversation_participant_body,t.uint32(5242).fork()).ldelim(),null!=e.delete_message_body&&Object.hasOwnProperty.call(e,"delete_message_body")&&d.im_proto.DeleteMessageRequestBody.encode(e.delete_message_body,t.uint32(5610).fork()).ldelim(),null!=e.recall_message_body&&Object.hasOwnProperty.call(e,"recall_message_body")&&d.im_proto.RecallMessageRequestBody.encode(e.recall_message_body,t.uint32(5618).fork()).ldelim(),null!=e.modify_message_property_body&&Object.hasOwnProperty.call(e,"modify_message_property_body")&&d.im_proto.ModifyMessagePropertyRequestBody.encode(e.modify_message_property_body,t.uint32(5642).fork()).ldelim(),null!=e.get_conversation_core_info_body&&Object.hasOwnProperty.call(e,"get_conversation_core_info_body")&&d.im_proto.GetConversationCoreInfoRequestBody.encode(e.get_conversation_core_info_body,t.uint32(7210).fork()).ldelim(),null!=e.set_conversation_core_info_body&&Object.hasOwnProperty.call(e,"set_conversation_core_info_body")&&d.im_proto.SetConversationCoreInfoRequestBody.encode(e.set_conversation_core_info_body,t.uint32(7218).fork()).ldelim(),null!=e.upsert_conversation_core_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_core_ext_info_body")&&d.im_proto.UpsertConversationCoreExtInfoRequestBody.encode(e.upsert_conversation_core_ext_info_body,t.uint32(7234).fork()).ldelim(),null!=e.set_conversation_setting_info_body&&Object.hasOwnProperty.call(e,"set_conversation_setting_info_body")&&d.im_proto.SetConversationSettingInfoRequestBody.encode(e.set_conversation_setting_info_body,t.uint32(7370).fork()).ldelim(),null!=e.upsert_conversation_setting_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_setting_ext_info_body")&&d.im_proto.UpsertConversationSettingExtInfoRequestBody.encode(e.upsert_conversation_setting_ext_info_body,t.uint32(7378).fork()).ldelim(),null!=e.get_stranger_conversation_body&&Object.hasOwnProperty.call(e,"get_stranger_conversation_body")&&d.im_proto.GetStrangerConversationListRequestBody.encode(e.get_stranger_conversation_body,t.uint32(8002).fork()).ldelim(),null!=e.get_stranger_messages_body&&Object.hasOwnProperty.call(e,"get_stranger_messages_body")&&d.im_proto.GetStrangerMessagesRequestBody.encode(e.get_stranger_messages_body,t.uint32(8010).fork()).ldelim(),null!=e.delete_stranger_message_body&&Object.hasOwnProperty.call(e,"delete_stranger_message_body")&&d.im_proto.DeleteStrangerMessageRequestBody.encode(e.delete_stranger_message_body,t.uint32(8018).fork()).ldelim(),null!=e.delete_stranger_conversation_body&&Object.hasOwnProperty.call(e,"delete_stranger_conversation_body")&&d.im_proto.DeleteStrangerConversationRequestBody.encode(e.delete_stranger_conversation_body,t.uint32(8026).fork()).ldelim(),null!=e.delete_stranger_all_conversation_body&&Object.hasOwnProperty.call(e,"delete_stranger_all_conversation_body")&&d.im_proto.DeleteStrangerAllConversationRequestBody.encode(e.delete_stranger_all_conversation_body,t.uint32(8034).fork()).ldelim(),null!=e.mark_stranger_conversation_read_body&&Object.hasOwnProperty.call(e,"mark_stranger_conversation_read_body")&&d.im_proto.MarkStrangerConversationReadRequestBody.encode(e.mark_stranger_conversation_read_body,t.uint32(8042).fork()).ldelim(),null!=e.mark_stranger_all_conversation_read_body&&Object.hasOwnProperty.call(e,"mark_stranger_all_conversation_read_body")&&d.im_proto.MarkStrangerAllConversationReadRequestBody.encode(e.mark_stranger_all_conversation_read_body,t.uint32(8050).fork()).ldelim(),null!=e.participants_read_index_body&&Object.hasOwnProperty.call(e,"participants_read_index_body")&&d.im_proto.GetConversationParticipantsReadIndexV3RequestBody.encode(e.participants_read_index_body,t.uint32(16002).fork()).ldelim(),null!=e.participants_min_index_body&&Object.hasOwnProperty.call(e,"participants_min_index_body")&&d.im_proto.GetConversationParticipantsMinIndexV3RequestBody.encode(e.participants_min_index_body,t.uint32(16010).fork()).ldelim(),null!=e.get_upload_token_body&&Object.hasOwnProperty.call(e,"get_upload_token_body")&&d.im_proto.GetUploadTokenRequestBody.encode(e.get_upload_token_body,t.uint32(16026).fork()).ldelim(),null!=e.get_media_urls_body&&Object.hasOwnProperty.call(e,"get_media_urls_body")&&d.im_proto.GetMediaUrlsRequestBody.encode(e.get_media_urls_body,t.uint32(16034).fork()).ldelim(),null!=e.get_ticket_body&&Object.hasOwnProperty.call(e,"get_ticket_body")&&d.im_proto.GetTicketRequestBody.encode(e.get_ticket_body,t.uint32(16042).fork()).ldelim(),null!=e.get_conversation_list_body&&Object.hasOwnProperty.call(e,"get_conversation_list_body")&&d.im_proto.GetUserConversationListRequestBody.encode(e.get_conversation_list_body,t.uint32(16050).fork()).ldelim(),null!=e.broadcast_send_message_body&&Object.hasOwnProperty.call(e,"broadcast_send_message_body")&&d.im_proto.BroadcastSendMessageRequestBody.encode(e.broadcast_send_message_body,t.uint32(16058).fork()).ldelim(),null!=e.broadcast_recv_message_body&&Object.hasOwnProperty.call(e,"broadcast_recv_message_body")&&d.im_proto.BroadcastRecvMessageRequestBody.encode(e.broadcast_recv_message_body,t.uint32(16066).fork()).ldelim(),null!=e.broadcast_user_counter_body&&Object.hasOwnProperty.call(e,"broadcast_user_counter_body")&&d.im_proto.BroadcastUserCounterRequestBody.encode(e.broadcast_user_counter_body,t.uint32(16074).fork()).ldelim(),null!=e.client_ack_body&&Object.hasOwnProperty.call(e,"client_ack_body")&&d.im_proto.ClientACKRequestBody.encode(e.client_ack_body,t.uint32(16082).fork()).ldelim(),null!=e.create_voip_body&&Object.hasOwnProperty.call(e,"create_voip_body")&&d.im_proto.CreateVoipRequestBody.encode(e.create_voip_body,t.uint32(16090).fork()).ldelim(),null!=e.call_voip_body&&Object.hasOwnProperty.call(e,"call_voip_body")&&d.im_proto.CallVoipRequestBody.encode(e.call_voip_body,t.uint32(16098).fork()).ldelim(),null!=e.update_voip_body&&Object.hasOwnProperty.call(e,"update_voip_body")&&d.im_proto.UpdateVoipRequestBody.encode(e.update_voip_body,t.uint32(16106).fork()).ldelim(),null!=e.channel_heartbeat_body&&Object.hasOwnProperty.call(e,"channel_heartbeat_body")&&d.im_proto.ChannelHeartBeatRequestBody.encode(e.channel_heartbeat_body,t.uint32(16114).fork()).ldelim(),null!=e.profile_get_info&&Object.hasOwnProperty.call(e,"profile_get_info")&&d.im_proto.ProfileGetInfoRequestBody.encode(e.profile_get_info,t.uint32(16122).fork()).ldelim(),null!=e.report_client_metrics_body&&Object.hasOwnProperty.call(e,"report_client_metrics_body")&&d.im_proto.ReportClientMetricsRequestBody.encode(e.report_client_metrics_body,t.uint32(16130).fork()).ldelim(),null!=e.get_configs_body&&Object.hasOwnProperty.call(e,"get_configs_body")&&d.im_proto.GetConfigsRequestBody.encode(e.get_configs_body,t.uint32(16138).fork()).ldelim(),null!=e.unread_count_report_body&&Object.hasOwnProperty.call(e,"unread_count_report_body")&&d.im_proto.UnReadCountReportRequestBody.encode(e.unread_count_report_body,t.uint32(16146).fork()).ldelim(),null!=e.block_members_body&&Object.hasOwnProperty.call(e,"block_members_body")&&d.im_proto.BlockMembersRequestBody.encode(e.block_members_body,t.uint32(16154).fork()).ldelim(),null!=e.block_conversation_body&&Object.hasOwnProperty.call(e,"block_conversation_body")&&d.im_proto.BlockConversationRequestBody.encode(e.block_conversation_body,t.uint32(16162).fork()).ldelim(),null!=e.modify_message_ext_body&&Object.hasOwnProperty.call(e,"modify_message_ext_body")&&d.im_proto.ModifyMessageExtRequestBody.encode(e.modify_message_ext_body,t.uint32(16170).fork()).ldelim(),null!=e.get_unread_count_body&&Object.hasOwnProperty.call(e,"get_unread_count_body")&&d.im_proto.GetUnreadCountRequestBody.encode(e.get_unread_count_body,t.uint32(16242).fork()).ldelim(),null!=e.send_message_p2p_body&&Object.hasOwnProperty.call(e,"send_message_p2p_body")&&d.im_proto.SendMessageP2PRequestBody.encode(e.send_message_p2p_body,t.uint32(16250).fork()).ldelim(),null!=e.get_blocklist_body&&Object.hasOwnProperty.call(e,"get_blocklist_body")&&d.im_proto.GetBlockListRequestBody.encode(e.get_blocklist_body,t.uint32(16258).fork()).ldelim(),null!=e.set_blocklist_body&&Object.hasOwnProperty.call(e,"set_blocklist_body")&&d.im_proto.SetBlocklistRequestBody.encode(e.set_blocklist_body,t.uint32(16266).fork()).ldelim(),null!=e.check_in_blocklist_body&&Object.hasOwnProperty.call(e,"check_in_blocklist_body")&&d.im_proto.CheckInBlockListRequestBody.encode(e.check_in_blocklist_body,t.uint32(16274).fork()).ldelim(),null!=e.mark_message_body&&Object.hasOwnProperty.call(e,"mark_message_body")&&d.im_proto.MarkMessageRequestBody.encode(e.mark_message_body,t.uint32(16290).fork()).ldelim(),null!=e.pull_mark_message_body&&Object.hasOwnProperty.call(e,"pull_mark_message_body")&&d.im_proto.PullMarkMessageRequestBody.encode(e.pull_mark_message_body,t.uint32(16298).fork()).ldelim(),null!=e.batch_get_conversation_participants_readindex&&Object.hasOwnProperty.call(e,"batch_get_conversation_participants_readindex")&&d.im_proto.BatchGetConversationParticipantsReadIndexRequestBody.encode(e.batch_get_conversation_participants_readindex,t.uint32(16306).fork()).ldelim(),null!=e.message_by_init&&Object.hasOwnProperty.call(e,"message_by_init")&&d.im_proto.MessageByInitRequestBody.encode(e.message_by_init,t.uint32(16346).fork()).ldelim(),null!=e.get_user_message&&Object.hasOwnProperty.call(e,"get_user_message")&&d.im_proto.GetUserMessageRequestBody.encode(e.get_user_message,t.uint32(16386).fork()).ldelim(),null!=e.mark_msg_unread_count_report&&Object.hasOwnProperty.call(e,"mark_msg_unread_count_report")&&d.im_proto.MarkMsgUnreadCountReportRequestBody.encode(e.mark_msg_unread_count_report,t.uint32(16434).fork()).ldelim(),null!=e.mark_msg_get_unread_count&&Object.hasOwnProperty.call(e,"mark_msg_get_unread_count")&&d.im_proto.MarkMsgGetUnreadCountRequestBody.encode(e.mark_msg_get_unread_count,t.uint32(16442).fork()).ldelim(),null!=e.batch_unmark_message&&Object.hasOwnProperty.call(e,"batch_unmark_message")&&d.im_proto.BatchUnmarkMessageRequestBody.encode(e.batch_unmark_message,t.uint32(16450).fork()).ldelim(),null!=e.client_batch_ack_body&&Object.hasOwnProperty.call(e,"client_batch_ack_body")&&d.im_proto.ClientBatchACKRequestBody.encode(e.client_batch_ack_body,t.uint32(16458).fork()).ldelim(),null!=e.audio_recognition_body&&Object.hasOwnProperty.call(e,"audio_recognition_body")&&d.im_proto.AudioRecognitionRequestBody.encode(e.audio_recognition_body,t.uint32(16474).fork()).ldelim(),null!=e.get_tag_meta_info_body&&Object.hasOwnProperty.call(e,"get_tag_meta_info_body")&&d.im_proto.GetTagMetaInfoRequestBody.encode(e.get_tag_meta_info_body,t.uint32(17602).fork()).ldelim(),null!=e.set_conversation_tag_body&&Object.hasOwnProperty.call(e,"set_conversation_tag_body")&&d.im_proto.SetConversationTagRequestBody.encode(e.set_conversation_tag_body,t.uint32(17610).fork()).ldelim(),null!=e.manage_tag_meta_info_body&&Object.hasOwnProperty.call(e,"manage_tag_meta_info_body")&&d.im_proto.ManageTagMetaInfoRequestBody.encode(e.manage_tag_meta_info_body,t.uint32(17618).fork()).ldelim(),null!=e.get_conversations_by_tag_body&&Object.hasOwnProperty.call(e,"get_conversations_by_tag_body")&&d.im_proto.GetConversationsByTagRequestBody.encode(e.get_conversations_by_tag_body,t.uint32(17626).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.RequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 100:o.send_message_body=d.im_proto.SendMessageRequestBody.decode(e,e.uint32());break;case 200:o.messages_per_user_body=d.im_proto.MessagesPerUserRequestBody.decode(e,e.uint32());break;case 203:o.messages_per_user_init_v2_body=d.im_proto.MessagesPerUserInitV2RequestBody.decode(e,e.uint32());break;case 211:o.get_message_by_id_body=d.im_proto.GetMessageByIdRequestBody.decode(e,e.uint32());break;case 301:o.messages_in_conversation_body=d.im_proto.MessagesInConversationRequestBody.decode(e,e.uint32());break;case 302:o.get_messages_checkinfo_in_conversation_body=d.im_proto.GetMessagesCheckInfoInConversationRequestBody.decode(e,e.uint32());break;case 410:o.send_user_action_body=d.im_proto.SendUserActionRequestBody.decode(e,e.uint32());break;case 411:o.send_input_status_body=d.im_proto.SendInputStatusRequestBody.decode(e,e.uint32());break;case 603:o.delete_conversation_body=d.im_proto.DeleteConversationRequestBody.decode(e,e.uint32());break;case 604:o.mark_conversation_read_body=d.im_proto.MarkConversationReadRequestBody.decode(e,e.uint32());break;case 605:o.conversation_participants_body=d.im_proto.ConversationParticipantsListRequestBody.decode(e,e.uint32());break;case 613:o.batch_mark_read_body=d.im_proto.BatchMarkConversationReadRequestBody.decode(e,e.uint32());break;case 614:o.dissolve_conversation_body=d.im_proto.DissolveConversationRequestBody.decode(e,e.uint32());break;case 609:o.create_conversation_v2_body=d.im_proto.CreateConversationV2RequestBody.decode(e,e.uint32());break;case 610:o.get_conversation_info_list_v2_body=d.im_proto.GetConversationInfoListV2RequestBody.decode(e,e.uint32());break;case 611:o.get_conversation_info_list_by_favorite_v2_body=d.im_proto.ConversationsPerUserByFavoriteV2RequestBody.decode(e,e.uint32());break;case 612:o.get_conversation_info_list_by_top_v2_body=d.im_proto.ConversationsPerUserByTopV2RequestBody.decode(e,e.uint32());break;case 650:o.conversation_add_participants_body=d.im_proto.ConversationAddParticipantsRequestBody.decode(e,e.uint32());break;case 651:o.conversation_remove_participants_body=d.im_proto.ConversationRemoveParticipantsRequestBody.decode(e,e.uint32());break;case 652:o.leave_conversation_body=d.im_proto.ConversationLeaveRequestBody.decode(e,e.uint32());break;case 654:o.mget_conversation_participants_body=d.im_proto.MgetConversationParticipantsRequestBody.decode(e,e.uint32());break;case 655:o.update_conversation_participant_body=d.im_proto.UpdateConversationParticipantRequestBody.decode(e,e.uint32());break;case 701:o.delete_message_body=d.im_proto.DeleteMessageRequestBody.decode(e,e.uint32());break;case 702:o.recall_message_body=d.im_proto.RecallMessageRequestBody.decode(e,e.uint32());break;case 705:o.modify_message_property_body=d.im_proto.ModifyMessagePropertyRequestBody.decode(e,e.uint32());break;case 2059:o.audio_recognition_body=d.im_proto.AudioRecognitionRequestBody.decode(e,e.uint32());break;case 901:o.get_conversation_core_info_body=d.im_proto.GetConversationCoreInfoRequestBody.decode(e,e.uint32());break;case 902:o.set_conversation_core_info_body=d.im_proto.SetConversationCoreInfoRequestBody.decode(e,e.uint32());break;case 904:o.upsert_conversation_core_ext_info_body=d.im_proto.UpsertConversationCoreExtInfoRequestBody.decode(e,e.uint32());break;case 921:o.set_conversation_setting_info_body=d.im_proto.SetConversationSettingInfoRequestBody.decode(e,e.uint32());break;case 922:o.upsert_conversation_setting_ext_info_body=d.im_proto.UpsertConversationSettingExtInfoRequestBody.decode(e,e.uint32());break;case 1e3:o.get_stranger_conversation_body=d.im_proto.GetStrangerConversationListRequestBody.decode(e,e.uint32());break;case 1001:o.get_stranger_messages_body=d.im_proto.GetStrangerMessagesRequestBody.decode(e,e.uint32());break;case 1002:o.delete_stranger_message_body=d.im_proto.DeleteStrangerMessageRequestBody.decode(e,e.uint32());break;case 1003:o.delete_stranger_conversation_body=d.im_proto.DeleteStrangerConversationRequestBody.decode(e,e.uint32());break;case 1004:o.delete_stranger_all_conversation_body=d.im_proto.DeleteStrangerAllConversationRequestBody.decode(e,e.uint32());break;case 1005:o.mark_stranger_conversation_read_body=d.im_proto.MarkStrangerConversationReadRequestBody.decode(e,e.uint32());break;case 1006:o.mark_stranger_all_conversation_read_body=d.im_proto.MarkStrangerAllConversationReadRequestBody.decode(e,e.uint32());break;case 2e3:o.participants_read_index_body=d.im_proto.GetConversationParticipantsReadIndexV3RequestBody.decode(e,e.uint32());break;case 2001:o.participants_min_index_body=d.im_proto.GetConversationParticipantsMinIndexV3RequestBody.decode(e,e.uint32());break;case 2003:o.get_upload_token_body=d.im_proto.GetUploadTokenRequestBody.decode(e,e.uint32());break;case 2004:o.get_media_urls_body=d.im_proto.GetMediaUrlsRequestBody.decode(e,e.uint32());break;case 2005:o.get_ticket_body=d.im_proto.GetTicketRequestBody.decode(e,e.uint32());break;case 2006:o.get_conversation_list_body=d.im_proto.GetUserConversationListRequestBody.decode(e,e.uint32());break;case 2007:o.broadcast_send_message_body=d.im_proto.BroadcastSendMessageRequestBody.decode(e,e.uint32());break;case 2008:o.broadcast_recv_message_body=d.im_proto.BroadcastRecvMessageRequestBody.decode(e,e.uint32());break;case 2009:o.broadcast_user_counter_body=d.im_proto.BroadcastUserCounterRequestBody.decode(e,e.uint32());break;case 2010:o.client_ack_body=d.im_proto.ClientACKRequestBody.decode(e,e.uint32());break;case 2011:o.create_voip_body=d.im_proto.CreateVoipRequestBody.decode(e,e.uint32());break;case 2012:o.call_voip_body=d.im_proto.CallVoipRequestBody.decode(e,e.uint32());break;case 2013:o.update_voip_body=d.im_proto.UpdateVoipRequestBody.decode(e,e.uint32());break;case 2014:o.channel_heartbeat_body=d.im_proto.ChannelHeartBeatRequestBody.decode(e,e.uint32());break;case 2015:o.profile_get_info=d.im_proto.ProfileGetInfoRequestBody.decode(e,e.uint32());break;case 2016:o.report_client_metrics_body=d.im_proto.ReportClientMetricsRequestBody.decode(e,e.uint32());break;case 2017:o.get_configs_body=d.im_proto.GetConfigsRequestBody.decode(e,e.uint32());break;case 2021:o.modify_message_ext_body=d.im_proto.ModifyMessageExtRequestBody.decode(e,e.uint32());break;case 2018:o.unread_count_report_body=d.im_proto.UnReadCountReportRequestBody.decode(e,e.uint32());break;case 2019:o.block_members_body=d.im_proto.BlockMembersRequestBody.decode(e,e.uint32());break;case 2020:o.block_conversation_body=d.im_proto.BlockConversationRequestBody.decode(e,e.uint32());break;case 2030:o.get_unread_count_body=d.im_proto.GetUnreadCountRequestBody.decode(e,e.uint32());break;case 2031:o.send_message_p2p_body=d.im_proto.SendMessageP2PRequestBody.decode(e,e.uint32());break;case 2032:o.get_blocklist_body=d.im_proto.GetBlockListRequestBody.decode(e,e.uint32());break;case 2033:o.set_blocklist_body=d.im_proto.SetBlocklistRequestBody.decode(e,e.uint32());break;case 2034:o.check_in_blocklist_body=d.im_proto.CheckInBlockListRequestBody.decode(e,e.uint32());break;case 2036:o.mark_message_body=d.im_proto.MarkMessageRequestBody.decode(e,e.uint32());break;case 2037:o.pull_mark_message_body=d.im_proto.PullMarkMessageRequestBody.decode(e,e.uint32());break;case 2038:o.batch_get_conversation_participants_readindex=d.im_proto.BatchGetConversationParticipantsReadIndexRequestBody.decode(e,e.uint32());break;case 2043:o.message_by_init=d.im_proto.MessageByInitRequestBody.decode(e,e.uint32());break;case 2048:o.get_user_message=d.im_proto.GetUserMessageRequestBody.decode(e,e.uint32());break;case 2054:o.mark_msg_unread_count_report=d.im_proto.MarkMsgUnreadCountReportRequestBody.decode(e,e.uint32());break;case 2055:o.mark_msg_get_unread_count=d.im_proto.MarkMsgGetUnreadCountRequestBody.decode(e,e.uint32());break;case 2056:o.batch_unmark_message=d.im_proto.BatchUnmarkMessageRequestBody.decode(e,e.uint32());break;case 2057:o.client_batch_ack_body=d.im_proto.ClientBatchACKRequestBody.decode(e,e.uint32());break;case 2200:o.get_tag_meta_info_body=d.im_proto.GetTagMetaInfoRequestBody.decode(e,e.uint32());break;case 2201:o.set_conversation_tag_body=d.im_proto.SetConversationTagRequestBody.decode(e,e.uint32());break;case 2202:o.manage_tag_meta_info_body=d.im_proto.ManageTagMetaInfoRequestBody.decode(e,e.uint32());break;case 2203:o.get_conversations_by_tag_body=d.im_proto.GetConversationsByTagRequestBody.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e}(),e.Request=function(){function e(e){if(this.headers={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cmd=0,e.prototype.sequence_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sdk_version="",e.prototype.token="",e.prototype.refer=1,e.prototype.inbox_type=0,e.prototype.build_number="",e.prototype.body=null,e.prototype.device_id="",e.prototype.channel="",e.prototype.device_platform="",e.prototype.device_type="",e.prototype.os_version="",e.prototype.version_code="",e.prototype.headers=c.emptyObject,e.prototype.config_id=0,e.prototype.token_info=null,e.prototype.auth_type=0,e.prototype.biz="",e.prototype.access="",e.prototype.ts_sign="",e.prototype.sdk_cert="",e.prototype.reuqest_sign="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.cmd&&Object.hasOwnProperty.call(e,"cmd")&&t.uint32(8).int32(e.cmd),null!=e.sequence_id&&Object.hasOwnProperty.call(e,"sequence_id")&&t.uint32(16).int64(e.sequence_id),null!=e.sdk_version&&Object.hasOwnProperty.call(e,"sdk_version")&&t.uint32(26).string(e.sdk_version),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(34).string(e.token),null!=e.refer&&Object.hasOwnProperty.call(e,"refer")&&t.uint32(40).int32(e.refer),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(48).int32(e.inbox_type),null!=e.build_number&&Object.hasOwnProperty.call(e,"build_number")&&t.uint32(58).string(e.build_number),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&d.im_proto.RequestBody.encode(e.body,t.uint32(66).fork()).ldelim(),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(74).string(e.device_id),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(82).string(e.channel),null!=e.device_platform&&Object.hasOwnProperty.call(e,"device_platform")&&t.uint32(90).string(e.device_platform),null!=e.device_type&&Object.hasOwnProperty.call(e,"device_type")&&t.uint32(98).string(e.device_type),null!=e.os_version&&Object.hasOwnProperty.call(e,"os_version")&&t.uint32(106).string(e.os_version),null!=e.version_code&&Object.hasOwnProperty.call(e,"version_code")&&t.uint32(114).string(e.version_code),null!=e.headers&&Object.hasOwnProperty.call(e,"headers"))for(var n=Object.keys(e.headers),o=0;o<n.length;++o)t.uint32(122).fork().uint32(10).string(n[o]).uint32(18).string(e.headers[n[o]]).ldelim();return null!=e.config_id&&Object.hasOwnProperty.call(e,"config_id")&&t.uint32(128).int32(e.config_id),null!=e.token_info&&Object.hasOwnProperty.call(e,"token_info")&&d.im_proto.TokenInfo.encode(e.token_info,t.uint32(138).fork()).ldelim(),null!=e.auth_type&&Object.hasOwnProperty.call(e,"auth_type")&&t.uint32(144).int32(e.auth_type),null!=e.biz&&Object.hasOwnProperty.call(e,"biz")&&t.uint32(170).string(e.biz),null!=e.access&&Object.hasOwnProperty.call(e,"access")&&t.uint32(178).string(e.access),null!=e.ts_sign&&Object.hasOwnProperty.call(e,"ts_sign")&&t.uint32(186).string(e.ts_sign),null!=e.sdk_cert&&Object.hasOwnProperty.call(e,"sdk_cert")&&t.uint32(194).string(e.sdk_cert),null!=e.reuqest_sign&&Object.hasOwnProperty.call(e,"reuqest_sign")&&t.uint32(202).string(e.reuqest_sign),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.Request;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.cmd=e.int32();break;case 2:i.sequence_id=e.int64();break;case 3:i.sdk_version=e.string();break;case 4:i.token=e.string();break;case 5:i.refer=e.int32();break;case 6:i.inbox_type=e.int32();break;case 7:i.build_number=e.string();break;case 8:i.body=d.im_proto.RequestBody.decode(e,e.uint32());break;case 9:i.device_id=e.string();break;case 10:i.channel=e.string();break;case 11:i.device_platform=e.string();break;case 12:i.device_type=e.string();break;case 13:i.os_version=e.string();break;case 14:i.version_code=e.string();break;case 15:i.headers===c.emptyObject&&(i.headers={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.headers[n]=o;break;case 16:i.config_id=e.int32();break;case 17:i.token_info=d.im_proto.TokenInfo.decode(e,e.uint32());break;case 18:i.auth_type=e.int32();break;case 21:i.biz=e.string();break;case 22:i.access=e.string();break;case 23:i.ts_sign=e.string();break;case 24:i.sdk_cert=e.string();break;case 25:i.reuqest_sign=e.string();break;default:e.skipType(7&a)}}return i},e}(),e.AuthType=function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_AUTH"]=0,t[e[1]="SESSION_AUTH"]=1,t[e[2]="TOKEN_AUTH"]=2,t[e[3]="CERT_AUTH"]=3,t[e[4]="PASSPORT_CERT_AUTH"]=4,t}(),e.TokenType=function(){const e={},t=Object.create(e);return t[e[0]="DEFAULT_TOKEN"]=0,t[e[1]="APP_TOKEN"]=1,t[e[2]="SERVER_TOKEN"]=2,t}(),e.TokenInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.mark_id=0,e.prototype.type=0,e.prototype.app_id=0,e.prototype.user_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.timestamp=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.mark_id&&Object.hasOwnProperty.call(e,"mark_id")&&t.uint32(8).int32(e.mark_id),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(24).int32(e.app_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(32).int64(e.user_id),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(40).int64(e.timestamp),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.TokenInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.mark_id=e.int32();break;case 2:o.type=e.int32();break;case 3:o.app_id=e.int32();break;case 4:o.user_id=e.int64();break;case 5:o.timestamp=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.SendType=function(){const e={},t=Object.create(e);return t[e[0]="BY_CONVERSATION"]=0,t[e[1]="BY_USER"]=1,t}(),e.NewP2PMessageNotify=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.send_type=0,e.prototype.sender=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sec_sender="",e.prototype.conversation_id="",e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.message_type=0,e.prototype.content="",e.prototype.ext=c.emptyObject,e.prototype.create_time=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.send_type&&Object.hasOwnProperty.call(e,"send_type")&&t.uint32(8).int32(e.send_type),null!=e.sender&&Object.hasOwnProperty.call(e,"sender")&&t.uint32(16).int64(e.sender),null!=e.sec_sender&&Object.hasOwnProperty.call(e,"sec_sender")&&t.uint32(26).string(e.sec_sender),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(34).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(40).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(48).int32(e.conversation_type),null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(56).int32(e.message_type),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(66).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(74).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(80).int64(e.create_time),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.NewP2PMessageNotify;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.send_type=e.int32();break;case 2:i.sender=e.int64();break;case 3:i.sec_sender=e.string();break;case 4:i.conversation_id=e.string();break;case 5:i.conversation_short_id=e.int64();break;case 6:i.conversation_type=e.int32();break;case 7:i.message_type=e.int32();break;case 8:i.content=e.string();break;case 9:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 10:i.create_time=e.int64();break;default:e.skipType(7&a)}}return i},e}(),e.MessageInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.status=0,e.prototype.body=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(8).int32(e.status),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&d.im_proto.MessageBody.encode(e.body,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessageInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.status=e.int32();break;case 2:o.body=d.im_proto.MessageBody.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e}(),e.GetMessageByIdRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetMessageByIdRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.server_message_id=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.GetMessageByIdResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.msg_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.msg_info&&Object.hasOwnProperty.call(e,"msg_info")&&d.im_proto.MessageInfo.encode(e.msg_info,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetMessageByIdResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.msg_info=d.im_proto.MessageInfo.decode(e,e.uint32());else e.skipType(7&r)}return o},e}(),e.ResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.send_message_body=null,e.prototype.messages_per_user_body=null,e.prototype.messages_per_user_init_v2_body=null,e.prototype.get_message_by_id_body=null,e.prototype.messages_in_conversation_body=null,e.prototype.get_messages_checkinfo_in_conversation_body=null,e.prototype.has_new_message_notify=null,e.prototype.has_new_p2p_message_notify=null,e.prototype.get_conversations_checkinfo_body=null,e.prototype.create_conversation_v2_body=null,e.prototype.get_conversation_info_list_v2_body=null,e.prototype.get_conversation_info_list_by_favorite_v2_body=null,e.prototype.get_conversation_info_list_by_top_v2_body=null,e.prototype.conversation_participants_body=null,e.prototype.conversation_add_participants_body=null,e.prototype.conversation_remove_participants_body=null,e.prototype.mget_conversation_participants_body=null,e.prototype.update_conversation_participant_body=null,e.prototype.modify_message_property_body=null,e.prototype.audio_recognition_body=null,e.prototype.get_conversation_core_info_body=null,e.prototype.set_conversation_core_info_body=null,e.prototype.upsert_conversation_core_ext_info_body=null,e.prototype.set_conversation_setting_info_body=null,e.prototype.upsert_conversation_setting_ext_info_body=null,e.prototype.get_stranger_conversation_body=null,e.prototype.get_stranger_messages_body=null,e.prototype.participants_read_index_body=null,e.prototype.participants_min_index_body=null,e.prototype.get_upload_token_body=null,e.prototype.get_media_urls_body=null,e.prototype.batch_get_conversation_participants_readindex=null,e.prototype.get_ticket_body=null,e.prototype.get_conversation_list_body=null,e.prototype.broadcast_send_message_body=null,e.prototype.broadcast_recv_message_body=null,e.prototype.broadcast_user_counter_body=null,e.prototype.create_voip_body=null,e.prototype.call_voip_body=null,e.prototype.update_voip_body=null,e.prototype.profile_get_info=null,e.prototype.get_configs_body=null,e.prototype.unread_count_report_body=null,e.prototype.block_members_body=null,e.prototype.modify_message_ext_body=null,e.prototype.get_unread_count_body=null,e.prototype.send_message_p2p_body=null,e.prototype.get_blocklist_body=null,e.prototype.set_blocklist_body=null,e.prototype.check_in_blocklist_body=null,e.prototype.mark_message_body=null,e.prototype.pull_mark_message_body=null,e.prototype.message_by_init=null,e.prototype.get_user_message=null,e.prototype.mark_msg_unread_count_report=null,e.prototype.mark_msg_get_unread_count=null,e.prototype.batch_unmark_message=null,e.prototype.get_tag_meta_info_body=null,e.prototype.set_conversation_tag_body=null,e.prototype.manage_tag_meta_info_body=null,e.prototype.get_conversations_by_tag_body=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.send_message_body&&Object.hasOwnProperty.call(e,"send_message_body")&&d.im_proto.SendMessageResponseBody.encode(e.send_message_body,t.uint32(802).fork()).ldelim(),null!=e.messages_per_user_body&&Object.hasOwnProperty.call(e,"messages_per_user_body")&&d.im_proto.MessagesPerUserResponseBody.encode(e.messages_per_user_body,t.uint32(1602).fork()).ldelim(),null!=e.messages_per_user_init_v2_body&&Object.hasOwnProperty.call(e,"messages_per_user_init_v2_body")&&d.im_proto.MessagesPerUserInitV2ResponseBody.encode(e.messages_per_user_init_v2_body,t.uint32(1626).fork()).ldelim(),null!=e.get_message_by_id_body&&Object.hasOwnProperty.call(e,"get_message_by_id_body")&&d.im_proto.GetMessageByIdResponseBody.encode(e.get_message_by_id_body,t.uint32(1690).fork()).ldelim(),null!=e.messages_in_conversation_body&&Object.hasOwnProperty.call(e,"messages_in_conversation_body")&&d.im_proto.MessagesInConversationResponseBody.encode(e.messages_in_conversation_body,t.uint32(2410).fork()).ldelim(),null!=e.get_messages_checkinfo_in_conversation_body&&Object.hasOwnProperty.call(e,"get_messages_checkinfo_in_conversation_body")&&d.im_proto.GetMessagesCheckInfoInConversationResponseBody.encode(e.get_messages_checkinfo_in_conversation_body,t.uint32(2418).fork()).ldelim(),null!=e.has_new_message_notify&&Object.hasOwnProperty.call(e,"has_new_message_notify")&&d.im_proto.NewMessageNotify.encode(e.has_new_message_notify,t.uint32(4002).fork()).ldelim(),null!=e.has_new_p2p_message_notify&&Object.hasOwnProperty.call(e,"has_new_p2p_message_notify")&&d.im_proto.NewP2PMessageNotify.encode(e.has_new_p2p_message_notify,t.uint32(4034).fork()).ldelim(),null!=e.conversation_participants_body&&Object.hasOwnProperty.call(e,"conversation_participants_body")&&d.im_proto.ConversationParticipantsListResponseBody.encode(e.conversation_participants_body,t.uint32(4842).fork()).ldelim(),null!=e.create_conversation_v2_body&&Object.hasOwnProperty.call(e,"create_conversation_v2_body")&&d.im_proto.CreateConversationV2ResponseBody.encode(e.create_conversation_v2_body,t.uint32(4874).fork()).ldelim(),null!=e.get_conversation_info_list_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_v2_body")&&d.im_proto.GetConversationInfoListV2ResponseBody.encode(e.get_conversation_info_list_v2_body,t.uint32(4882).fork()).ldelim(),null!=e.get_conversation_info_list_by_favorite_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_favorite_v2_body")&&d.im_proto.GetConversationInfoListByFavoriteV2ResponseBody.encode(e.get_conversation_info_list_by_favorite_v2_body,t.uint32(4890).fork()).ldelim(),null!=e.get_conversation_info_list_by_top_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_top_v2_body")&&d.im_proto.GetConversationInfoListByTopV2ResponseBody.encode(e.get_conversation_info_list_by_top_v2_body,t.uint32(4898).fork()).ldelim(),null!=e.get_conversations_checkinfo_body&&Object.hasOwnProperty.call(e,"get_conversations_checkinfo_body")&&d.im_proto.GetConversationsCheckInfoResponseBody.encode(e.get_conversations_checkinfo_body,t.uint32(4922).fork()).ldelim(),null!=e.conversation_add_participants_body&&Object.hasOwnProperty.call(e,"conversation_add_participants_body")&&d.im_proto.ConversationAddParticipantsResponseBody.encode(e.conversation_add_participants_body,t.uint32(5202).fork()).ldelim(),null!=e.conversation_remove_participants_body&&Object.hasOwnProperty.call(e,"conversation_remove_participants_body")&&d.im_proto.ConversationRemoveParticipantsResponseBody.encode(e.conversation_remove_participants_body,t.uint32(5210).fork()).ldelim(),null!=e.mget_conversation_participants_body&&Object.hasOwnProperty.call(e,"mget_conversation_participants_body")&&d.im_proto.MgetConversationParticipantsResponseBody.encode(e.mget_conversation_participants_body,t.uint32(5234).fork()).ldelim(),null!=e.update_conversation_participant_body&&Object.hasOwnProperty.call(e,"update_conversation_participant_body")&&d.im_proto.UpdateConversationParticipantResponseBody.encode(e.update_conversation_participant_body,t.uint32(5242).fork()).ldelim(),null!=e.modify_message_property_body&&Object.hasOwnProperty.call(e,"modify_message_property_body")&&d.im_proto.ModifyMessagePropertyResponseBody.encode(e.modify_message_property_body,t.uint32(5642).fork()).ldelim(),null!=e.get_conversation_core_info_body&&Object.hasOwnProperty.call(e,"get_conversation_core_info_body")&&d.im_proto.GetConversationCoreInfoResponseBody.encode(e.get_conversation_core_info_body,t.uint32(7210).fork()).ldelim(),null!=e.set_conversation_core_info_body&&Object.hasOwnProperty.call(e,"set_conversation_core_info_body")&&d.im_proto.SetConversationCoreInfoResponseBody.encode(e.set_conversation_core_info_body,t.uint32(7218).fork()).ldelim(),null!=e.upsert_conversation_core_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_core_ext_info_body")&&d.im_proto.UpsertConversationCoreExtInfoResponseBody.encode(e.upsert_conversation_core_ext_info_body,t.uint32(7234).fork()).ldelim(),null!=e.set_conversation_setting_info_body&&Object.hasOwnProperty.call(e,"set_conversation_setting_info_body")&&d.im_proto.SetConversationSettingInfoResponseBody.encode(e.set_conversation_setting_info_body,t.uint32(7370).fork()).ldelim(),null!=e.upsert_conversation_setting_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_setting_ext_info_body")&&d.im_proto.UpsertConversationSettingExtInfoResponseBody.encode(e.upsert_conversation_setting_ext_info_body,t.uint32(7378).fork()).ldelim(),null!=e.get_stranger_conversation_body&&Object.hasOwnProperty.call(e,"get_stranger_conversation_body")&&d.im_proto.GetStrangerConversationListResponseBody.encode(e.get_stranger_conversation_body,t.uint32(8002).fork()).ldelim(),null!=e.get_stranger_messages_body&&Object.hasOwnProperty.call(e,"get_stranger_messages_body")&&d.im_proto.GetStrangerMessagesResponseBody.encode(e.get_stranger_messages_body,t.uint32(8010).fork()).ldelim(),null!=e.participants_read_index_body&&Object.hasOwnProperty.call(e,"participants_read_index_body")&&d.im_proto.GetConversationParticipantsReadIndexV3ResponseBody.encode(e.participants_read_index_body,t.uint32(16002).fork()).ldelim(),null!=e.participants_min_index_body&&Object.hasOwnProperty.call(e,"participants_min_index_body")&&d.im_proto.GetConversationParticipantsMinIndexV3ResponseBody.encode(e.participants_min_index_body,t.uint32(16010).fork()).ldelim(),null!=e.get_upload_token_body&&Object.hasOwnProperty.call(e,"get_upload_token_body")&&d.im_proto.GetUploadTokenResponseBody.encode(e.get_upload_token_body,t.uint32(16026).fork()).ldelim(),null!=e.get_media_urls_body&&Object.hasOwnProperty.call(e,"get_media_urls_body")&&d.im_proto.GetMediaUrlsResponseBody.encode(e.get_media_urls_body,t.uint32(16034).fork()).ldelim(),null!=e.get_ticket_body&&Object.hasOwnProperty.call(e,"get_ticket_body")&&d.im_proto.GetTicketResponseBody.encode(e.get_ticket_body,t.uint32(16042).fork()).ldelim(),null!=e.get_conversation_list_body&&Object.hasOwnProperty.call(e,"get_conversation_list_body")&&d.im_proto.GetUserConversationListResponseBody.encode(e.get_conversation_list_body,t.uint32(16050).fork()).ldelim(),null!=e.broadcast_send_message_body&&Object.hasOwnProperty.call(e,"broadcast_send_message_body")&&d.im_proto.BroadcastSendMessageResponseBody.encode(e.broadcast_send_message_body,t.uint32(16058).fork()).ldelim(),null!=e.broadcast_recv_message_body&&Object.hasOwnProperty.call(e,"broadcast_recv_message_body")&&d.im_proto.BroadcastRecvMessageResponseBody.encode(e.broadcast_recv_message_body,t.uint32(16066).fork()).ldelim(),null!=e.broadcast_user_counter_body&&Object.hasOwnProperty.call(e,"broadcast_user_counter_body")&&d.im_proto.BroadcastUserCounterResponseBody.encode(e.broadcast_user_counter_body,t.uint32(16074).fork()).ldelim(),null!=e.create_voip_body&&Object.hasOwnProperty.call(e,"create_voip_body")&&d.im_proto.CreateVoipResponseBody.encode(e.create_voip_body,t.uint32(16090).fork()).ldelim(),null!=e.call_voip_body&&Object.hasOwnProperty.call(e,"call_voip_body")&&d.im_proto.CallVoipResponseBody.encode(e.call_voip_body,t.uint32(16098).fork()).ldelim(),null!=e.update_voip_body&&Object.hasOwnProperty.call(e,"update_voip_body")&&d.im_proto.UpdateVoipResponseBody.encode(e.update_voip_body,t.uint32(16106).fork()).ldelim(),null!=e.profile_get_info&&Object.hasOwnProperty.call(e,"profile_get_info")&&d.im_proto.ProfileGetInfoResponseBody.encode(e.profile_get_info,t.uint32(16122).fork()).ldelim(),null!=e.get_configs_body&&Object.hasOwnProperty.call(e,"get_configs_body")&&d.im_proto.GetConfigsResponseBody.encode(e.get_configs_body,t.uint32(16138).fork()).ldelim(),null!=e.unread_count_report_body&&Object.hasOwnProperty.call(e,"unread_count_report_body")&&d.im_proto.UnReadCountReportResponseBody.encode(e.unread_count_report_body,t.uint32(16146).fork()).ldelim(),null!=e.block_members_body&&Object.hasOwnProperty.call(e,"block_members_body")&&d.im_proto.BlockMembersResponseBody.encode(e.block_members_body,t.uint32(16154).fork()).ldelim(),null!=e.modify_message_ext_body&&Object.hasOwnProperty.call(e,"modify_message_ext_body")&&d.im_proto.ModifyMessageExtResponseBody.encode(e.modify_message_ext_body,t.uint32(16170).fork()).ldelim(),null!=e.get_unread_count_body&&Object.hasOwnProperty.call(e,"get_unread_count_body")&&d.im_proto.GetUnreadCountResponseBody.encode(e.get_unread_count_body,t.uint32(16242).fork()).ldelim(),null!=e.send_message_p2p_body&&Object.hasOwnProperty.call(e,"send_message_p2p_body")&&d.im_proto.SendMessageP2PResponseBody.encode(e.send_message_p2p_body,t.uint32(16250).fork()).ldelim(),null!=e.get_blocklist_body&&Object.hasOwnProperty.call(e,"get_blocklist_body")&&d.im_proto.GetBlockListResponseBody.encode(e.get_blocklist_body,t.uint32(16258).fork()).ldelim(),null!=e.set_blocklist_body&&Object.hasOwnProperty.call(e,"set_blocklist_body")&&d.im_proto.SetBlocklistResponseBody.encode(e.set_blocklist_body,t.uint32(16266).fork()).ldelim(),null!=e.check_in_blocklist_body&&Object.hasOwnProperty.call(e,"check_in_blocklist_body")&&d.im_proto.CheckInBlockListResponseBody.encode(e.check_in_blocklist_body,t.uint32(16274).fork()).ldelim(),null!=e.mark_message_body&&Object.hasOwnProperty.call(e,"mark_message_body")&&d.im_proto.MarkMessageResponseBody.encode(e.mark_message_body,t.uint32(16290).fork()).ldelim(),null!=e.pull_mark_message_body&&Object.hasOwnProperty.call(e,"pull_mark_message_body")&&d.im_proto.PullMarkMessageResponseBody.encode(e.pull_mark_message_body,t.uint32(16298).fork()).ldelim(),null!=e.batch_get_conversation_participants_readindex&&Object.hasOwnProperty.call(e,"batch_get_conversation_participants_readindex")&&d.im_proto.BatchGetConversationParticipantsReadIndexResponseBody.encode(e.batch_get_conversation_participants_readindex,t.uint32(16306).fork()).ldelim(),null!=e.message_by_init&&Object.hasOwnProperty.call(e,"message_by_init")&&d.im_proto.MessageByInitResponseBody.encode(e.message_by_init,t.uint32(16346).fork()).ldelim(),null!=e.get_user_message&&Object.hasOwnProperty.call(e,"get_user_message")&&d.im_proto.GetUserMessageResponseBody.encode(e.get_user_message,t.uint32(16386).fork()).ldelim(),null!=e.mark_msg_unread_count_report&&Object.hasOwnProperty.call(e,"mark_msg_unread_count_report")&&d.im_proto.MarkMsgUnreadCountReportResponseBody.encode(e.mark_msg_unread_count_report,t.uint32(16434).fork()).ldelim(),null!=e.mark_msg_get_unread_count&&Object.hasOwnProperty.call(e,"mark_msg_get_unread_count")&&d.im_proto.MarkMsgGetUnreadCountResponseBody.encode(e.mark_msg_get_unread_count,t.uint32(16442).fork()).ldelim(),null!=e.batch_unmark_message&&Object.hasOwnProperty.call(e,"batch_unmark_message")&&d.im_proto.BatchUnmarkMessageResponseBody.encode(e.batch_unmark_message,t.uint32(16450).fork()).ldelim(),null!=e.audio_recognition_body&&Object.hasOwnProperty.call(e,"audio_recognition_body")&&d.im_proto.AudioRecognitionResponseBody.encode(e.audio_recognition_body,t.uint32(16474).fork()).ldelim(),null!=e.get_tag_meta_info_body&&Object.hasOwnProperty.call(e,"get_tag_meta_info_body")&&d.im_proto.GetTagMetaInfoResponseBody.encode(e.get_tag_meta_info_body,t.uint32(17602).fork()).ldelim(),null!=e.set_conversation_tag_body&&Object.hasOwnProperty.call(e,"set_conversation_tag_body")&&d.im_proto.SetConversationTagResponseBody.encode(e.set_conversation_tag_body,t.uint32(17610).fork()).ldelim(),null!=e.manage_tag_meta_info_body&&Object.hasOwnProperty.call(e,"manage_tag_meta_info_body")&&d.im_proto.ManageTagMetaInfoResponseBody.encode(e.manage_tag_meta_info_body,t.uint32(17618).fork()).ldelim(),null!=e.get_conversations_by_tag_body&&Object.hasOwnProperty.call(e,"get_conversations_by_tag_body")&&d.im_proto.GetConversationsByTagResponseBody.encode(e.get_conversations_by_tag_body,t.uint32(17626).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 100:o.send_message_body=d.im_proto.SendMessageResponseBody.decode(e,e.uint32());break;case 200:o.messages_per_user_body=d.im_proto.MessagesPerUserResponseBody.decode(e,e.uint32());break;case 203:o.messages_per_user_init_v2_body=d.im_proto.MessagesPerUserInitV2ResponseBody.decode(e,e.uint32());break;case 211:o.get_message_by_id_body=d.im_proto.GetMessageByIdResponseBody.decode(e,e.uint32());break;case 301:o.messages_in_conversation_body=d.im_proto.MessagesInConversationResponseBody.decode(e,e.uint32());break;case 302:o.get_messages_checkinfo_in_conversation_body=d.im_proto.GetMessagesCheckInfoInConversationResponseBody.decode(e,e.uint32());break;case 500:o.has_new_message_notify=d.im_proto.NewMessageNotify.decode(e,e.uint32());break;case 504:o.has_new_p2p_message_notify=d.im_proto.NewP2PMessageNotify.decode(e,e.uint32());break;case 615:o.get_conversations_checkinfo_body=d.im_proto.GetConversationsCheckInfoResponseBody.decode(e,e.uint32());break;case 609:o.create_conversation_v2_body=d.im_proto.CreateConversationV2ResponseBody.decode(e,e.uint32());break;case 610:o.get_conversation_info_list_v2_body=d.im_proto.GetConversationInfoListV2ResponseBody.decode(e,e.uint32());break;case 611:o.get_conversation_info_list_by_favorite_v2_body=d.im_proto.GetConversationInfoListByFavoriteV2ResponseBody.decode(e,e.uint32());break;case 612:o.get_conversation_info_list_by_top_v2_body=d.im_proto.GetConversationInfoListByTopV2ResponseBody.decode(e,e.uint32());break;case 605:o.conversation_participants_body=d.im_proto.ConversationParticipantsListResponseBody.decode(e,e.uint32());break;case 650:o.conversation_add_participants_body=d.im_proto.ConversationAddParticipantsResponseBody.decode(e,e.uint32());break;case 651:o.conversation_remove_participants_body=d.im_proto.ConversationRemoveParticipantsResponseBody.decode(e,e.uint32());break;case 654:o.mget_conversation_participants_body=d.im_proto.MgetConversationParticipantsResponseBody.decode(e,e.uint32());break;case 655:o.update_conversation_participant_body=d.im_proto.UpdateConversationParticipantResponseBody.decode(e,e.uint32());break;case 705:o.modify_message_property_body=d.im_proto.ModifyMessagePropertyResponseBody.decode(e,e.uint32());break;case 2059:o.audio_recognition_body=d.im_proto.AudioRecognitionResponseBody.decode(e,e.uint32());break;case 901:o.get_conversation_core_info_body=d.im_proto.GetConversationCoreInfoResponseBody.decode(e,e.uint32());break;case 902:o.set_conversation_core_info_body=d.im_proto.SetConversationCoreInfoResponseBody.decode(e,e.uint32());break;case 904:o.upsert_conversation_core_ext_info_body=d.im_proto.UpsertConversationCoreExtInfoResponseBody.decode(e,e.uint32());break;case 921:o.set_conversation_setting_info_body=d.im_proto.SetConversationSettingInfoResponseBody.decode(e,e.uint32());break;case 922:o.upsert_conversation_setting_ext_info_body=d.im_proto.UpsertConversationSettingExtInfoResponseBody.decode(e,e.uint32());break;case 1e3:o.get_stranger_conversation_body=d.im_proto.GetStrangerConversationListResponseBody.decode(e,e.uint32());break;case 1001:o.get_stranger_messages_body=d.im_proto.GetStrangerMessagesResponseBody.decode(e,e.uint32());break;case 2e3:o.participants_read_index_body=d.im_proto.GetConversationParticipantsReadIndexV3ResponseBody.decode(e,e.uint32());break;case 2001:o.participants_min_index_body=d.im_proto.GetConversationParticipantsMinIndexV3ResponseBody.decode(e,e.uint32());break;case 2003:o.get_upload_token_body=d.im_proto.GetUploadTokenResponseBody.decode(e,e.uint32());break;case 2004:o.get_media_urls_body=d.im_proto.GetMediaUrlsResponseBody.decode(e,e.uint32());break;case 2038:o.batch_get_conversation_participants_readindex=d.im_proto.BatchGetConversationParticipantsReadIndexResponseBody.decode(e,e.uint32());break;case 2005:o.get_ticket_body=d.im_proto.GetTicketResponseBody.decode(e,e.uint32());break;case 2006:o.get_conversation_list_body=d.im_proto.GetUserConversationListResponseBody.decode(e,e.uint32());break;case 2007:o.broadcast_send_message_body=d.im_proto.BroadcastSendMessageResponseBody.decode(e,e.uint32());break;case 2008:o.broadcast_recv_message_body=d.im_proto.BroadcastRecvMessageResponseBody.decode(e,e.uint32());break;case 2009:o.broadcast_user_counter_body=d.im_proto.BroadcastUserCounterResponseBody.decode(e,e.uint32());break;case 2011:o.create_voip_body=d.im_proto.CreateVoipResponseBody.decode(e,e.uint32());break;case 2012:o.call_voip_body=d.im_proto.CallVoipResponseBody.decode(e,e.uint32());break;case 2013:o.update_voip_body=d.im_proto.UpdateVoipResponseBody.decode(e,e.uint32());break;case 2015:o.profile_get_info=d.im_proto.ProfileGetInfoResponseBody.decode(e,e.uint32());break;case 2017:o.get_configs_body=d.im_proto.GetConfigsResponseBody.decode(e,e.uint32());break;case 2018:o.unread_count_report_body=d.im_proto.UnReadCountReportResponseBody.decode(e,e.uint32());break;case 2019:o.block_members_body=d.im_proto.BlockMembersResponseBody.decode(e,e.uint32());break;case 2021:o.modify_message_ext_body=d.im_proto.ModifyMessageExtResponseBody.decode(e,e.uint32());break;case 2030:o.get_unread_count_body=d.im_proto.GetUnreadCountResponseBody.decode(e,e.uint32());break;case 2031:o.send_message_p2p_body=d.im_proto.SendMessageP2PResponseBody.decode(e,e.uint32());break;case 2032:o.get_blocklist_body=d.im_proto.GetBlockListResponseBody.decode(e,e.uint32());break;case 2033:o.set_blocklist_body=d.im_proto.SetBlocklistResponseBody.decode(e,e.uint32());break;case 2034:o.check_in_blocklist_body=d.im_proto.CheckInBlockListResponseBody.decode(e,e.uint32());break;case 2036:o.mark_message_body=d.im_proto.MarkMessageResponseBody.decode(e,e.uint32());break;case 2037:o.pull_mark_message_body=d.im_proto.PullMarkMessageResponseBody.decode(e,e.uint32());break;case 2043:o.message_by_init=d.im_proto.MessageByInitResponseBody.decode(e,e.uint32());break;case 2048:o.get_user_message=d.im_proto.GetUserMessageResponseBody.decode(e,e.uint32());break;case 2054:o.mark_msg_unread_count_report=d.im_proto.MarkMsgUnreadCountReportResponseBody.decode(e,e.uint32());break;case 2055:o.mark_msg_get_unread_count=d.im_proto.MarkMsgGetUnreadCountResponseBody.decode(e,e.uint32());break;case 2056:o.batch_unmark_message=d.im_proto.BatchUnmarkMessageResponseBody.decode(e,e.uint32());break;case 2200:o.get_tag_meta_info_body=d.im_proto.GetTagMetaInfoResponseBody.decode(e,e.uint32());break;case 2201:o.set_conversation_tag_body=d.im_proto.SetConversationTagResponseBody.decode(e,e.uint32());break;case 2202:o.manage_tag_meta_info_body=d.im_proto.ManageTagMetaInfoResponseBody.decode(e,e.uint32());break;case 2203:o.get_conversations_by_tag_body=d.im_proto.GetConversationsByTagResponseBody.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e}(),e.Response=function(){function e(e){if(this.headers={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cmd=0,e.prototype.sequence_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.status_code=0,e.prototype.error_desc="",e.prototype.inbox_type=0,e.prototype.body=null,e.prototype.log_id="",e.prototype.headers=c.emptyObject,e.prototype.start_time_stamp=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.request_arrived_time=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_execution_end_time=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.cmd&&Object.hasOwnProperty.call(e,"cmd")&&t.uint32(8).int32(e.cmd),null!=e.sequence_id&&Object.hasOwnProperty.call(e,"sequence_id")&&t.uint32(16).int64(e.sequence_id),null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(24).int32(e.status_code),null!=e.error_desc&&Object.hasOwnProperty.call(e,"error_desc")&&t.uint32(34).string(e.error_desc),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(40).int32(e.inbox_type),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&d.im_proto.ResponseBody.encode(e.body,t.uint32(50).fork()).ldelim(),null!=e.log_id&&Object.hasOwnProperty.call(e,"log_id")&&t.uint32(58).string(e.log_id),null!=e.headers&&Object.hasOwnProperty.call(e,"headers"))for(var n=Object.keys(e.headers),o=0;o<n.length;++o)t.uint32(66).fork().uint32(10).string(n[o]).uint32(18).string(e.headers[n[o]]).ldelim();return null!=e.start_time_stamp&&Object.hasOwnProperty.call(e,"start_time_stamp")&&t.uint32(72).int64(e.start_time_stamp),null!=e.request_arrived_time&&Object.hasOwnProperty.call(e,"request_arrived_time")&&t.uint32(80).int64(e.request_arrived_time),null!=e.server_execution_end_time&&Object.hasOwnProperty.call(e,"server_execution_end_time")&&t.uint32(88).int64(e.server_execution_end_time),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.Response;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.cmd=e.int32();break;case 2:i.sequence_id=e.int64();break;case 3:i.status_code=e.int32();break;case 4:i.error_desc=e.string();break;case 5:i.inbox_type=e.int32();break;case 6:i.body=d.im_proto.ResponseBody.decode(e,e.uint32());break;case 7:i.log_id=e.string();break;case 8:i.headers===c.emptyObject&&(i.headers={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.headers[n]=o;break;case 9:i.start_time_stamp=e.int64();break;case 10:i.request_arrived_time=e.int64();break;case 11:i.server_execution_end_time=e.int64();break;default:e.skipType(7&a)}}return i},e}(),e.BroadcastSendMessageRequestBody=function(){function e(e){if(this.ext={},this.mentioned_users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.content="",e.prototype.ext=c.emptyObject,e.prototype.message_type=0,e.prototype.ticket="",e.prototype.client_message_id="",e.prototype.mentioned_users=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(34).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(42).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();if(null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(48).int32(e.message_type),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(58).string(e.ticket),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(66).string(e.client_message_id),null!=e.mentioned_users&&e.mentioned_users.length)for(o=0;o<e.mentioned_users.length;++o)t.uint32(72).int64(e.mentioned_users[o]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.BroadcastSendMessageRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_type=e.int32();break;case 3:i.conversation_short_id=e.int64();break;case 4:i.content=e.string();break;case 5:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 6:i.message_type=e.int32();break;case 7:i.ticket=e.string();break;case 8:i.client_message_id=e.string();break;case 9:if(i.mentioned_users&&i.mentioned_users.length||(i.mentioned_users=[]),2==(7&a))for(u=e.uint32()+e.pos;e.pos<u;)i.mentioned_users.push(e.int64());else i.mentioned_users.push(e.int64());break;default:e.skipType(7&a)}}return i},e}(),e.BroadcastSendMessageResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.extra_info="",e.prototype.status=0,e.prototype.client_message_id="",e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(18).string(e.extra_info),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(34).string(e.client_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BroadcastSendMessageResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.server_message_id=e.int64();break;case 2:o.extra_info=e.string();break;case 3:o.status=e.int32();break;case 4:o.client_message_id=e.string();break;case 5:o.check_code=e.int64();break;case 6:o.check_message=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.BroadcastRecvMessageRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.reverse=!1,e.prototype.pull_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(32).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(40).int64(e.limit),null!=e.reverse&&Object.hasOwnProperty.call(e,"reverse")&&t.uint32(48).bool(e.reverse),null!=e.pull_type&&Object.hasOwnProperty.call(e,"pull_type")&&t.uint32(56).int32(e.pull_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BroadcastRecvMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.cursor=e.int64();break;case 5:o.limit=e.int64();break;case 6:o.reverse=e.bool();break;case 7:o.pull_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.BroadcastRecvMessageResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BroadcastRecvMessageResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cursor=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.BroadcastUserCounterRequestBody=function(){function e(e){if(this.conversations=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversations=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversations&&e.conversations.length)for(var n=0;n<e.conversations.length;++n)d.im_proto.ConversationRequest.encode(e.conversations[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BroadcastUserCounterRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversations&&o.conversations.length||(o.conversations=[]),o.conversations.push(d.im_proto.ConversationRequest.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.BroadcastUserInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.counter=0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.counter&&Object.hasOwnProperty.call(e,"counter")&&t.uint32(16).int32(e.counter),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BroadcastUserInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.counter=e.int32();break;case 3:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.BroadcastUserCounterResponseBody=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.infos=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.infos&&e.infos.length)for(var n=0;n<e.infos.length;++n)d.im_proto.BroadcastUserInfo.encode(e.infos[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BroadcastUserCounterResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.infos&&o.infos.length||(o.infos=[]),o.infos.push(d.im_proto.BroadcastUserInfo.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.NetworkType=function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="WIFI"]=1,t[e[2]="MOBILE_2G"]=2,t[e[3]="MOBILE_3G"]=3,t[e[4]="MOBILE_4G"]=4,t[e[5]="MOBILE_5G"]=5,t}(),e.MsgReportType=function(){const e={},t=Object.create(e);return t[e[0]="NOT_USE"]=0,t[e[1]="MSG_RECEIVE_BY_WS"]=1,t[e[2]="MSG_RECEIVE_BY_USER"]=2,t[e[3]="MSG_RECEIVE_BY_INIT"]=3,t[e[4]="MSG_RECEIVE_BY_LOAD_HISTORY"]=4,t[e[5]="MSG_RECEIVE_BY_LOAD_NEWER"]=5,t[e[6]="MSG_RECEIVE_BY_CHECK_MSG_V1"]=6,t[e[7]="MSG_RECEIVE_BY_CHECK_MSG_V2"]=7,t[e[8]="MSG_RECEIVE_BY_STRANGER"]=8,t[e[9]="MSG_SHOW"]=9,t}(),e.ClientACKRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.start_time_stamp=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.cmd=0,e.prototype.network_type=0,e.prototype.logid="",e.prototype.client_time_stamp=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(8).int64(e.start_time_stamp),t.uint32(16).int32(e.cmd),null!=e.network_type&&Object.hasOwnProperty.call(e,"network_type")&&t.uint32(24).int32(e.network_type),null!=e.logid&&Object.hasOwnProperty.call(e,"logid")&&t.uint32(34).string(e.logid),null!=e.client_time_stamp&&Object.hasOwnProperty.call(e,"client_time_stamp")&&t.uint32(40).int64(e.client_time_stamp),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(48).int64(e.server_message_id),t.uint32(56).int32(e.type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ClientACKRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.start_time_stamp=e.int64();break;case 2:o.cmd=e.int32();break;case 3:o.network_type=e.int32();break;case 4:o.logid=e.string();break;case 5:o.client_time_stamp=e.int64();break;case 6:o.server_message_id=e.int64();break;case 7:o.type=e.int32();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("start_time_stamp"))throw c.ProtocolError("missing required 'start_time_stamp'",{instance:o});if(!o.hasOwnProperty("cmd"))throw c.ProtocolError("missing required 'cmd'",{instance:o});if(!o.hasOwnProperty("type"))throw c.ProtocolError("missing required 'type'",{instance:o});return o},e}(),e.ClientBatchACKRequestBody=function(){function e(e){if(this.ack_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.ack_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.ack_list&&e.ack_list.length)for(var n=0;n<e.ack_list.length;++n)d.im_proto.ClientACKRequestBody.encode(e.ack_list[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ClientBatchACKRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.ack_list&&o.ack_list.length||(o.ack_list=[]),o.ack_list.push(d.im_proto.ClientACKRequestBody.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.VoipMode=function(){const e={},t=Object.create(e);return t[e[0]="VOIP_MODE_DOUBLE"]=0,t[e[1]="VOIP_MODE_MULTIPLAYER"]=1,t}(),e.VoipStatusCode=function(){const e={},t=Object.create(e);return t[e[0]="SUCCESS"]=0,t[e[4]="VOIP_PARAMS_ERROR"]=4,t[e[18]="VOIP_STATUS_ERROR"]=18,t[e[19]="VOIP_CANCEL_ERROR"]=19,t[e[20]="VOIP_OTHER_RESPONSE_ERROR"]=20,t[e[21]="VOIP_CALLBACK_ERROR"]=21,t}(),e.VoipStatus=function(){const e={},t=Object.create(e);return t[e[0]="IDLE"]=0,t[e[1]="CALLING"]=1,t[e[2]="RINGING"]=2,t[e[3]="ACCEPTED"]=3,t[e[4]="ONTHECALL"]=4,t[e[101]="TERMINATED"]=101,t[e[102]="OCCUPIED"]=102,t[e[103]="REFUSED"]=103,t[e[104]="CANCELLED"]=104,t[e[105]="UNAVAILABLE"]=105,t[e[106]="RTCERROR"]=106,t[e[107]="RTC_ENGINE_MISMATCH"]=107,t}(),e.VoipType=function(){const e={},t=Object.create(e);return t[e[0]="VOIP_TYPE_NOT_USED"]=0,t[e[1]="VOIP_TYPE_ALL"]=1,t[e[2]="VOIP_TYPE_VIDEOONLY"]=2,t[e[3]="VOIP_TYPE_AUDIOONLY"]=3,t}(),e.VoipInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.user_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.device_id="",e.prototype.channel_id="",e.prototype.token="",e.prototype.status=0,e.prototype.caller_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.created_time_ms=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.updated_time_ms=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.con_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.v_type=0,e.prototype.srv_msg_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(18).string(e.device_id),null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(26).string(e.channel_id),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(34).string(e.token),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(40).int32(e.status),null!=e.caller_id&&Object.hasOwnProperty.call(e,"caller_id")&&t.uint32(48).int64(e.caller_id),null!=e.created_time_ms&&Object.hasOwnProperty.call(e,"created_time_ms")&&t.uint32(56).int64(e.created_time_ms),null!=e.updated_time_ms&&Object.hasOwnProperty.call(e,"updated_time_ms")&&t.uint32(64).int64(e.updated_time_ms),null!=e.con_short_id&&Object.hasOwnProperty.call(e,"con_short_id")&&t.uint32(72).int64(e.con_short_id),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(80).int32(e.v_type),null!=e.srv_msg_id&&Object.hasOwnProperty.call(e,"srv_msg_id")&&t.uint32(88).int64(e.srv_msg_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.VoipInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.user_id=e.int64();break;case 2:o.device_id=e.string();break;case 3:o.channel_id=e.string();break;case 4:o.token=e.string();break;case 5:o.status=e.int32();break;case 6:o.caller_id=e.int64();break;case 7:o.created_time_ms=e.int64();break;case 8:o.updated_time_ms=e.int64();break;case 9:o.con_short_id=e.int64();break;case 10:o.v_type=e.int32();break;case 11:o.srv_msg_id=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.CreateVoipRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.idempotent_id="",e.prototype.v_type=0,e.prototype.con_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.srv_msg_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ref_channel_id="",e.prototype.voip_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(10).string(e.idempotent_id),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(16).int32(e.v_type),null!=e.con_short_id&&Object.hasOwnProperty.call(e,"con_short_id")&&t.uint32(24).int64(e.con_short_id),null!=e.srv_msg_id&&Object.hasOwnProperty.call(e,"srv_msg_id")&&t.uint32(32).int64(e.srv_msg_id),null!=e.ref_channel_id&&Object.hasOwnProperty.call(e,"ref_channel_id")&&t.uint32(42).string(e.ref_channel_id),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(48).int32(e.voip_mode),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.CreateVoipRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.idempotent_id=e.string();break;case 2:o.v_type=e.int32();break;case 3:o.con_short_id=e.int64();break;case 4:o.srv_msg_id=e.int64();break;case 5:o.ref_channel_id=e.string();break;case 6:o.voip_mode=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.CreateVoipResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.info=null,e.prototype.status_code=0,e.prototype.voip_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.info&&Object.hasOwnProperty.call(e,"info")&&d.im_proto.VoipInfo.encode(e.info,t.uint32(10).fork()).ldelim(),null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(16).int32(e.status_code),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(24).int32(e.voip_mode),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.CreateVoipResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.info=d.im_proto.VoipInfo.decode(e,e.uint32());break;case 2:o.status_code=e.int32();break;case 3:o.voip_mode=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.CallVoipRequestBody=function(){function e(e){if(this.callee_ids=[],this.ext={},this.ref_channel_users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.callee_ids=c.emptyArray,e.prototype.channel_id="",e.prototype.v_type=0,e.prototype.ext=c.emptyObject,e.prototype.ref_channel_users=c.emptyArray,e.prototype.con_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.callee_ids&&e.callee_ids.length)for(var n=0;n<e.callee_ids.length;++n)t.uint32(8).int64(e.callee_ids[n]);if(null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(18).string(e.channel_id),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(24).int32(e.v_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext")){var o=Object.keys(e.ext);for(n=0;n<o.length;++n)t.uint32(34).fork().uint32(10).string(o[n]).uint32(18).string(e.ext[o[n]]).ldelim()}if(null!=e.ref_channel_users&&e.ref_channel_users.length)for(n=0;n<e.ref_channel_users.length;++n)t.uint32(40).int64(e.ref_channel_users[n]);return null!=e.con_id&&Object.hasOwnProperty.call(e,"con_id")&&t.uint32(50).string(e.con_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.CallVoipRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:if(i.callee_ids&&i.callee_ids.length||(i.callee_ids=[]),2==(7&a))for(var u=e.uint32()+e.pos;e.pos<u;)i.callee_ids.push(e.int64());else i.callee_ids.push(e.int64());break;case 2:i.channel_id=e.string();break;case 3:i.v_type=e.int32();break;case 4:i.ext===c.emptyObject&&(i.ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 5:if(i.ref_channel_users&&i.ref_channel_users.length||(i.ref_channel_users=[]),2==(7&a))for(u=e.uint32()+e.pos;e.pos<u;)i.ref_channel_users.push(e.int64());else i.ref_channel_users.push(e.int64());break;case 6:i.con_id=e.string();break;default:e.skipType(7&a)}}return i},e}(),e.CallVoipResponseBody=function(){function e(e){if(this.callee_ids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.info=null,e.prototype.callee_ids=c.emptyArray,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.ref_channel_id="",e.prototype.voip_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.info&&Object.hasOwnProperty.call(e,"info")&&d.im_proto.VoipInfo.encode(e.info,t.uint32(10).fork()).ldelim(),null!=e.callee_ids&&e.callee_ids.length)for(var n=0;n<e.callee_ids.length;++n)t.uint32(16).int64(e.callee_ids[n]);return null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(34).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),null!=e.ref_channel_id&&Object.hasOwnProperty.call(e,"ref_channel_id")&&t.uint32(58).string(e.ref_channel_id),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(64).int32(e.voip_mode),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.CallVoipResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.info=d.im_proto.VoipInfo.decode(e,e.uint32());break;case 2:if(o.callee_ids&&o.callee_ids.length||(o.callee_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.callee_ids.push(e.int64());else o.callee_ids.push(e.int64());break;case 3:o.status=e.int32();break;case 4:o.extra_info=e.string();break;case 5:o.check_code=e.int64();break;case 6:o.check_message=e.string();break;case 7:o.ref_channel_id=e.string();break;case 8:o.voip_mode=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.UpdateVoipRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.channel_id="",e.prototype.status=0,e.prototype.v_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(10).string(e.channel_id),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(24).int32(e.v_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.UpdateVoipRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.channel_id=e.string();break;case 2:o.status=e.int32();break;case 3:o.v_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.UpdateVoipResponseBody=function(){function e(e){if(this.callees=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.info=null,e.prototype.status_code=0,e.prototype.voip_mode=0,e.prototype.callees=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.info&&Object.hasOwnProperty.call(e,"info")&&d.im_proto.VoipInfo.encode(e.info,t.uint32(10).fork()).ldelim(),null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(16).int32(e.status_code),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(24).int32(e.voip_mode),null!=e.callees&&e.callees.length)for(var n=0;n<e.callees.length;++n)t.uint32(32).int64(e.callees[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.UpdateVoipResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.info=d.im_proto.VoipInfo.decode(e,e.uint32());break;case 2:o.status_code=e.int32();break;case 3:o.voip_mode=e.int32();break;case 4:if(o.callees&&o.callees.length||(o.callees=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.callees.push(e.int64());else o.callees.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.ChannelStatus=function(){const e={},t=Object.create(e);return t[e[0]="CHANNEL_STATUS_NOT_USED"]=0,t[e[1]="ONLINE"]=1,t[e[2]="OFFLINE"]=2,t}(),e.ChannelHeartBeatRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.channel_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(10).string(e.channel_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ChannelHeartBeatRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.channel_id=e.string();else e.skipType(7&r)}return o},e}(),e.Profile=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.nick_name="",e.prototype.protrait="",e.prototype.basic_ext_info="",e.prototype.detail_ext_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(10).string(e.nick_name),null!=e.protrait&&Object.hasOwnProperty.call(e,"protrait")&&t.uint32(18).string(e.protrait),null!=e.basic_ext_info&&Object.hasOwnProperty.call(e,"basic_ext_info")&&t.uint32(26).string(e.basic_ext_info),null!=e.detail_ext_info&&Object.hasOwnProperty.call(e,"detail_ext_info")&&t.uint32(34).string(e.detail_ext_info),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.Profile;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.nick_name=e.string();break;case 2:o.protrait=e.string();break;case 3:o.basic_ext_info=e.string();break;case 4:o.detail_ext_info=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.ProfileGetInfoRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.userid=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(8).int64(e.userid),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ProfileGetInfoRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.userid=e.int64();else e.skipType(7&r)}if(!o.hasOwnProperty("userid"))throw c.ProtocolError("missing required 'userid'",{instance:o});return o},e}(),e.ProfileGetInfoResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.profile=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.profile&&Object.hasOwnProperty.call(e,"profile")&&d.im_proto.Profile.encode(e.profile,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ProfileGetInfoResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.profile=d.im_proto.Profile.decode(e,e.uint32());else e.skipType(7&r)}return o},e}(),e.ClientMetricType=function(){const e={},t=Object.create(e);return t[e[0]="COUNTER"]=0,t[e[1]="TIMER"]=1,t}(),e.ClientMetric=function(){function e(e){if(this.tags={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.metric_type=0,e.prototype.k="",e.prototype.v=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.tags=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.metric_type&&Object.hasOwnProperty.call(e,"metric_type")&&t.uint32(8).int32(e.metric_type),null!=e.k&&Object.hasOwnProperty.call(e,"k")&&t.uint32(18).string(e.k),null!=e.v&&Object.hasOwnProperty.call(e,"v")&&t.uint32(24).int64(e.v),null!=e.tags&&Object.hasOwnProperty.call(e,"tags"))for(var n=Object.keys(e.tags),o=0;o<n.length;++o)t.uint32(34).fork().uint32(10).string(n[o]).uint32(18).string(e.tags[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.ClientMetric;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.metric_type=e.int32();break;case 2:i.k=e.string();break;case 3:i.v=e.int64();break;case 4:i.tags===c.emptyObject&&(i.tags={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.tags[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.ReportClientMetricsRequestBody=function(){function e(e){if(this.report_metrics_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.report_metrics_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.report_metrics_list&&e.report_metrics_list.length)for(var n=0;n<e.report_metrics_list.length;++n)d.im_proto.ClientMetric.encode(e.report_metrics_list[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ReportClientMetricsRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.report_metrics_list&&o.report_metrics_list.length||(o.report_metrics_list=[]),o.report_metrics_list.push(d.im_proto.ClientMetric.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.GetConfigsRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConfigsRequestBody;e.pos<n;){var r=e.uint32();e.skipType(7&r)}return o},e}(),e.GetConfigsResponseBody=function(){function e(e){if(this.configs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.version=0,e.prototype.configs=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).int32(e.version),null!=e.configs&&e.configs.length)for(var n=0;n<e.configs.length;++n)d.im_proto.Config.encode(e.configs[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConfigsResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.version=e.int32();break;case 2:o.configs&&o.configs.length||(o.configs=[]),o.configs.push(d.im_proto.Config.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.Config=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conf_name="",e.prototype.conf_value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conf_name&&Object.hasOwnProperty.call(e,"conf_name")&&t.uint32(10).string(e.conf_name),null!=e.conf_value&&Object.hasOwnProperty.call(e,"conf_value")&&t.uint32(18).string(e.conf_value),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.Config;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conf_name=e.string();break;case 2:o.conf_value=e.string();break;default:e.skipType(7&r)}}return o},e}(),e.SendMessageP2PRequestBody=function(){function e(e){if(this.visible_user=[],this.invisible_user=[],this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.send_type=0,e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.visible_user=c.emptyArray,e.prototype.invisible_user=c.emptyArray,e.prototype.message_type=0,e.prototype.content="",e.prototype.ext=c.emptyObject,e.prototype.client_message_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.send_type&&Object.hasOwnProperty.call(e,"send_type")&&t.uint32(8).int32(e.send_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(18).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(32).int64(e.conversation_short_id),null!=e.visible_user&&e.visible_user.length)for(var n=0;n<e.visible_user.length;++n)t.uint32(40).int64(e.visible_user[n]);if(null!=e.invisible_user&&e.invisible_user.length)for(n=0;n<e.invisible_user.length;++n)t.uint32(48).int64(e.invisible_user[n]);if(null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(56).int32(e.message_type),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(66).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext")){var o=Object.keys(e.ext);for(n=0;n<o.length;++n)t.uint32(74).fork().uint32(10).string(o[n]).uint32(18).string(e.ext[o[n]]).ldelim()}return null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(82).string(e.client_message_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.SendMessageP2PRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.send_type=e.int32();break;case 2:i.conversation_id=e.string();break;case 3:i.conversation_type=e.int32();break;case 4:i.conversation_short_id=e.int64();break;case 5:if(i.visible_user&&i.visible_user.length||(i.visible_user=[]),2==(7&a))for(var u=e.uint32()+e.pos;e.pos<u;)i.visible_user.push(e.int64());else i.visible_user.push(e.int64());break;case 6:if(i.invisible_user&&i.invisible_user.length||(i.invisible_user=[]),2==(7&a))for(u=e.uint32()+e.pos;e.pos<u;)i.invisible_user.push(e.int64());else i.invisible_user.push(e.int64());break;case 7:i.message_type=e.int32();break;case 8:i.content=e.string();break;case 9:i.ext===c.emptyObject&&(i.ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 10:i.client_message_id=e.string();break;default:e.skipType(7&a)}}return i},e}(),e.SendMessageP2PResponseBody=function(){function e(e){if(this.failed_user=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.failed_user=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.failed_user&&e.failed_user.length)for(var n=0;n<e.failed_user.length;++n)t.uint32(8).int64(e.failed_user[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SendMessageP2PResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)if(o.failed_user&&o.failed_user.length||(o.failed_user=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_user.push(e.int64());else o.failed_user.push(e.int64());else e.skipType(7&r)}return o},e}(),e.ConvCountReport=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conv_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.unread_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conv_short_id&&Object.hasOwnProperty.call(e,"conv_short_id")&&t.uint32(8).int64(e.conv_short_id),null!=e.unread_count&&Object.hasOwnProperty.call(e,"unread_count")&&t.uint32(16).int64(e.unread_count),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConvCountReport;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conv_short_id=e.int64();break;case 2:o.unread_count=e.int64();break;case 3:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.UnReadCountReportRequestBody=function(){function e(e){if(this.conv_unread_count=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.total_unread_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conv_unread_count=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(8).int64(e.total_unread_count),null!=e.conv_unread_count&&e.conv_unread_count.length)for(var n=0;n<e.conv_unread_count.length;++n)d.im_proto.ConvCountReport.encode(e.conv_unread_count[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.UnReadCountReportRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.total_unread_count=e.int64();break;case 2:o.conv_unread_count&&o.conv_unread_count.length||(o.conv_unread_count=[]),o.conv_unread_count.push(d.im_proto.ConvCountReport.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.UnReadCountReportResponseBody=function(){function e(e){if(this.failed_conv_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.set_total_status=!1,e.prototype.failed_conv_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).bool(e.set_total_status),null!=e.failed_conv_list&&e.failed_conv_list.length)for(var n=0;n<e.failed_conv_list.length;++n)t.uint32(16).int64(e.failed_conv_list[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.UnReadCountReportResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.set_total_status=e.bool();break;case 2:if(o.failed_conv_list&&o.failed_conv_list.length||(o.failed_conv_list=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_conv_list.push(e.int64());else o.failed_conv_list.push(e.int64());break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("set_total_status"))throw c.ProtocolError("missing required 'set_total_status'",{instance:o});return o},e}(),e.GetUnreadCountRequestBody=function(){function e(e){if(this.conv_short_id=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.get_total=!1,e.prototype.conv_short_id=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.get_total&&Object.hasOwnProperty.call(e,"get_total")&&t.uint32(8).bool(e.get_total),null!=e.conv_short_id&&e.conv_short_id.length)for(var n=0;n<e.conv_short_id.length;++n)t.uint32(16).int64(e.conv_short_id[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetUnreadCountRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.get_total=e.bool();break;case 2:if(o.conv_short_id&&o.conv_short_id.length||(o.conv_short_id=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.conv_short_id.push(e.int64());else o.conv_short_id.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.GetUnreadCountResponseBody=function(){function e(e){if(this.conv_unread_count={},this.failed_conv_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.total_unread_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conv_unread_count=c.emptyObject,e.prototype.failed_conv_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(8).int64(e.total_unread_count),null!=e.conv_unread_count&&Object.hasOwnProperty.call(e,"conv_unread_count"))for(var n=Object.keys(e.conv_unread_count),o=0;o<n.length;++o)t.uint32(18).fork().uint32(8).int64(n[o]).uint32(16).int64(e.conv_unread_count[n[o]]).ldelim();if(null!=e.failed_conv_list&&e.failed_conv_list.length)for(o=0;o<e.failed_conv_list.length;++o)t.uint32(24).int64(e.failed_conv_list[o]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.GetUnreadCountResponseBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.total_unread_count=e.int64();break;case 2:i.conv_unread_count===c.emptyObject&&(i.conv_unread_count={});var u=e.uint32()+e.pos;for(n=0,o=0;e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.int64();break;case 2:o=e.int64();break;default:e.skipType(7&l)}}i.conv_unread_count["object"==typeof n?c.longToHash(n):n]=o;break;case 3:if(i.failed_conv_list&&i.failed_conv_list.length||(i.failed_conv_list=[]),2==(7&a))for(u=e.uint32()+e.pos;e.pos<u;)i.failed_conv_list.push(e.int64());else i.failed_conv_list.push(e.int64());break;default:e.skipType(7&a)}}return i},e}(),e.GetBlockListRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetBlockListRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.cursor=e.int64();break;case 2:o.limit=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.BlockUserInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.user_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.create_time=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(16).int64(e.create_time),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BlockUserInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.user_id=e.int64();break;case 2:o.create_time=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.GetBlockListResponseBody=function(){function e(e){if(this.user_info=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.user_info=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.user_info&&e.user_info.length)for(var n=0;n<e.user_info.length;++n)d.im_proto.BlockUserInfo.encode(e.user_info[n],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetBlockListResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.user_info&&o.user_info.length||(o.user_info=[]),o.user_info.push(d.im_proto.BlockUserInfo.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cursor=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.SetBlocklistRequestBody=function(){function e(e){if(this.blocklist=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.set_block_list=!1,e.prototype.blocklist=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.set_block_list&&Object.hasOwnProperty.call(e,"set_block_list")&&t.uint32(8).bool(e.set_block_list),null!=e.blocklist&&e.blocklist.length)for(var n=0;n<e.blocklist.length;++n)t.uint32(16).int64(e.blocklist[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SetBlocklistRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.set_block_list=e.bool();break;case 2:if(o.blocklist&&o.blocklist.length||(o.blocklist=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.blocklist.push(e.int64());else o.blocklist.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.SetBlocklistResponseBody=function(){function e(e){if(this.failed_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.failed_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.failed_list&&e.failed_list.length)for(var n=0;n<e.failed_list.length;++n)t.uint32(8).int64(e.failed_list[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SetBlocklistResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)if(o.failed_list&&o.failed_list.length||(o.failed_list=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_list.push(e.int64());else o.failed_list.push(e.int64());else e.skipType(7&r)}return o},e}(),e.CheckInBlockListRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.user_to_check=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.user_to_check&&Object.hasOwnProperty.call(e,"user_to_check")&&t.uint32(8).int64(e.user_to_check),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.CheckInBlockListRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.user_to_check=e.int64();else e.skipType(7&r)}return o},e}(),e.CheckInBlockListResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.in_blocklist=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.in_blocklist&&Object.hasOwnProperty.call(e,"in_blocklist")&&t.uint32(8).bool(e.in_blocklist),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.CheckInBlockListResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.in_blocklist=e.bool();else e.skipType(7&r)}return o},e}(),e.BlockStatus=function(){const e={},t=Object.create(e);return t[e[0]="UNBLOCK"]=0,t[e[1]="BLOCK"]=1,t}(),e.BlockMembersRequestBody=function(){function e(e){if(this.block_time={},this.biz_ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.block_status=0,e.prototype.block_time=c.emptyObject,e.prototype.conv_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.conversation_id="",e.prototype.biz_ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.block_status&&Object.hasOwnProperty.call(e,"block_status")&&t.uint32(8).int32(e.block_status),null!=e.block_time&&Object.hasOwnProperty.call(e,"block_time"))for(var n=Object.keys(e.block_time),o=0;o<n.length;++o)t.uint32(18).fork().uint32(8).int64(n[o]).uint32(16).int64(e.block_time[n[o]]).ldelim();if(null!=e.conv_short_id&&Object.hasOwnProperty.call(e,"conv_short_id")&&t.uint32(24).int64(e.conv_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(32).int32(e.conversation_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(42).string(e.conversation_id),null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext"))for(n=Object.keys(e.biz_ext),o=0;o<n.length;++o)t.uint32(90).fork().uint32(10).string(n[o]).uint32(18).string(e.biz_ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.BlockMembersRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.block_status=e.int32();break;case 2:i.block_time===c.emptyObject&&(i.block_time={});var u=e.uint32()+e.pos;for(n=0,o=0;e.pos<u;){switch((l=e.uint32())>>>3){case 1:n=e.int64();break;case 2:o=e.int64();break;default:e.skipType(7&l)}}i.block_time["object"==typeof n?c.longToHash(n):n]=o;break;case 3:i.conv_short_id=e.int64();break;case 4:i.conversation_type=e.int32();break;case 5:i.conversation_id=e.string();break;case 11:i.biz_ext===c.emptyObject&&(i.biz_ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l;switch((l=e.uint32())>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.biz_ext[n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.BlockMembersResponseBody=function(){function e(e){if(this.failed_members=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.failed_members=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.failed_members&&e.failed_members.length)for(var n=0;n<e.failed_members.length;++n)t.uint32(8).int64(e.failed_members[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BlockMembersResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)if(o.failed_members&&o.failed_members.length||(o.failed_members=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_members.push(e.int64());else o.failed_members.push(e.int64());else e.skipType(7&r)}return o},e}(),e.BlockConversationRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conv_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.block_status=0,e.prototype.block_normal_only=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conv_short_id&&Object.hasOwnProperty.call(e,"conv_short_id")&&t.uint32(16).int64(e.conv_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.block_status&&Object.hasOwnProperty.call(e,"block_status")&&t.uint32(32).int32(e.block_status),null!=e.block_normal_only&&Object.hasOwnProperty.call(e,"block_normal_only")&&t.uint32(40).bool(e.block_normal_only),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BlockConversationRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conv_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.block_status=e.int32();break;case 5:o.block_normal_only=e.bool();break;default:e.skipType(7&r)}}return o},e}(),e.GetMessagesCheckInfoInConversationRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.cursor_reverse_begin=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.cursor_reverse_end=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.expect_msg_total_count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.cursor_reverse_begin&&Object.hasOwnProperty.call(e,"cursor_reverse_begin")&&t.uint32(24).int64(e.cursor_reverse_begin),null!=e.expect_msg_total_count&&Object.hasOwnProperty.call(e,"expect_msg_total_count")&&t.uint32(32).int32(e.expect_msg_total_count),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(42).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(48).int32(e.conversation_type),null!=e.cursor_reverse_end&&Object.hasOwnProperty.call(e,"cursor_reverse_end")&&t.uint32(56).int64(e.cursor_reverse_end),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetMessagesCheckInfoInConversationRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 2:o.conversation_short_id=e.int64();break;case 5:o.conversation_id=e.string();break;case 6:o.conversation_type=e.int32();break;case 3:o.cursor_reverse_begin=e.int64();break;case 7:o.cursor_reverse_end=e.int64();break;case 4:o.expect_msg_total_count=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.MessagesCheckInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.head_msg_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.tail_msg_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.msg_count=0,e.prototype.indexes_checksum=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.head_msg_index&&Object.hasOwnProperty.call(e,"head_msg_index")&&t.uint32(8).int64(e.head_msg_index),null!=e.tail_msg_index&&Object.hasOwnProperty.call(e,"tail_msg_index")&&t.uint32(16).int64(e.tail_msg_index),null!=e.msg_count&&Object.hasOwnProperty.call(e,"msg_count")&&t.uint32(24).int32(e.msg_count),null!=e.indexes_checksum&&Object.hasOwnProperty.call(e,"indexes_checksum")&&t.uint32(32).uint32(e.indexes_checksum),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessagesCheckInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.head_msg_index=e.int64();break;case 2:o.tail_msg_index=e.int64();break;case 3:o.msg_count=e.int32();break;case 4:o.indexes_checksum=e.uint32();break;default:e.skipType(7&r)}}return o},e}(),e.GetMessagesCheckInfoInConversationResponseBody=function(){function e(e){if(this.msgs_checkinfo_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.msgs_checkinfo_list=c.emptyArray,e.prototype.real_msg_total_count=0,e.prototype.cursor_reverse_next=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.msgs_checkinfo_list&&e.msgs_checkinfo_list.length)for(var n=0;n<e.msgs_checkinfo_list.length;++n)d.im_proto.MessagesCheckInfo.encode(e.msgs_checkinfo_list[n],t.uint32(10).fork()).ldelim();return null!=e.real_msg_total_count&&Object.hasOwnProperty.call(e,"real_msg_total_count")&&t.uint32(16).int32(e.real_msg_total_count),null!=e.cursor_reverse_next&&Object.hasOwnProperty.call(e,"cursor_reverse_next")&&t.uint32(32).int64(e.cursor_reverse_next),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetMessagesCheckInfoInConversationResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.msgs_checkinfo_list&&o.msgs_checkinfo_list.length||(o.msgs_checkinfo_list=[]),o.msgs_checkinfo_list.push(d.im_proto.MessagesCheckInfo.decode(e,e.uint32()));break;case 2:o.real_msg_total_count=e.int32();break;case 4:o.cursor_reverse_next=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationCheckInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.conversation_id="",e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(18).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationCheckInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.conversation_id=e.string();break;case 3:o.conversation_type=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationsCheckInfoResponseBody=function(){function e(e){if(this.conversation_checkinfo_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_checkinfo_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_checkinfo_list&&e.conversation_checkinfo_list.length)for(var n=0;n<e.conversation_checkinfo_list.length;++n)d.im_proto.ConversationCheckInfo.encode(e.conversation_checkinfo_list[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationsCheckInfoResponseBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.conversation_checkinfo_list&&o.conversation_checkinfo_list.length||(o.conversation_checkinfo_list=[]),o.conversation_checkinfo_list.push(d.im_proto.ConversationCheckInfo.decode(e,e.uint32()));else e.skipType(7&r)}return o},e}(),e.MessageExtraInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sort_time=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.sort_time&&Object.hasOwnProperty.call(e,"sort_time")&&t.uint32(8).int64(e.sort_time),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessageExtraInfo;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.sort_time=e.int64();else e.skipType(7&r)}return o},e}(),e.ActionType=function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_ACTION"]=0,t[e[1]="FAVORITE"]=1,t[e[2]="PIN"]=2,t[e[3]="UNREAD"]=3,t[e[4]="CONV_TOP_MSG"]=4,t}(),e.MarkMessageRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.do_action=!1,e.prototype.action_type=0,e.prototype.sort_time=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.tag=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),null!=e.do_action&&Object.hasOwnProperty.call(e,"do_action")&&t.uint32(40).bool(e.do_action),null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(48).int32(e.action_type),null!=e.sort_time&&Object.hasOwnProperty.call(e,"sort_time")&&t.uint32(56).int64(e.sort_time),null!=e.tag&&Object.hasOwnProperty.call(e,"tag")&&t.uint32(64).int64(e.tag),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MarkMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.server_message_id=e.int64();break;case 5:o.do_action=e.bool();break;case 6:o.action_type=e.int32();break;case 7:o.sort_time=e.int64();break;case 8:o.tag=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.MarkMessageResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(16).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(26).string(e.check_message),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(32).int32(e.status),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MarkMessageResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.server_message_id=e.int64();break;case 2:o.check_code=e.int64();break;case 3:o.check_message=e.string();break;case 4:o.status=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.PullMarkMessageRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.asc=!1,e.prototype.action_type=0,e.prototype.tag=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.clear_unread_count=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(32).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(40).int64(e.limit),null!=e.asc&&Object.hasOwnProperty.call(e,"asc")&&t.uint32(48).bool(e.asc),null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(56).int32(e.action_type),null!=e.tag&&Object.hasOwnProperty.call(e,"tag")&&t.uint32(64).int64(e.tag),null!=e.clear_unread_count&&Object.hasOwnProperty.call(e,"clear_unread_count")&&t.uint32(72).bool(e.clear_unread_count),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.PullMarkMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.cursor=e.int64();break;case 5:o.limit=e.int64();break;case 6:o.asc=e.bool();break;case 7:o.action_type=e.int32();break;case 8:o.tag=e.int64();break;case 9:o.clear_unread_count=e.bool();break;default:e.skipType(7&r)}}return o},e}(),e.PullMarkMessageResponseBody=function(){function e(e){if(this.messages=[],this.msg_extras=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.msg_extras=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(10).fork()).ldelim();if(null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),null!=e.msg_extras&&e.msg_extras.length)for(n=0;n<e.msg_extras.length;++n)d.im_proto.MessageExtraInfo.encode(e.msg_extras[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.PullMarkMessageResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cursor=e.int64();break;case 4:o.msg_extras&&o.msg_extras.length||(o.msg_extras=[]),o.msg_extras.push(d.im_proto.MessageExtraInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.MessageByInitRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.page=0,e.prototype.conv_limit=0,e.prototype.msg_limit=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).int64(e.version),null!=e.page&&Object.hasOwnProperty.call(e,"page")&&t.uint32(16).int32(e.page),null!=e.conv_limit&&Object.hasOwnProperty.call(e,"conv_limit")&&t.uint32(24).int32(e.conv_limit),null!=e.msg_limit&&Object.hasOwnProperty.call(e,"msg_limit")&&t.uint32(32).int32(e.msg_limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessageByInitRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.version=e.int64();break;case 2:o.page=e.int32();break;case 3:o.conv_limit=e.int32();break;case 4:o.msg_limit=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.MessageByInitResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_init_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.user_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.cmd_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.readconv_version=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.ConversationMessage.encode(e.messages[n],t.uint32(10).fork()).ldelim();return t.uint32(16).bool(e.has_more),t.uint32(24).int64(e.next_init_version),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(32).int64(e.version),null!=e.user_cursor&&Object.hasOwnProperty.call(e,"user_cursor")&&t.uint32(40).int64(e.user_cursor),null!=e.cmd_index&&Object.hasOwnProperty.call(e,"cmd_index")&&t.uint32(48).int64(e.cmd_index),null!=e.readconv_version&&Object.hasOwnProperty.call(e,"readconv_version")&&t.uint32(56).int64(e.readconv_version),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MessageByInitResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.ConversationMessage.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_init_version=e.int64();break;case 4:o.version=e.int64();break;case 5:o.user_cursor=e.int64();break;case 6:o.cmd_index=e.int64();break;case 7:o.readconv_version=e.int64();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("has_more"))throw c.ProtocolError("missing required 'has_more'",{instance:o});if(!o.hasOwnProperty("next_init_version"))throw c.ProtocolError("missing required 'next_init_version'",{instance:o});return o},e}(),e.ConversationMessage=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversations=null,e.prototype.messages=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),d.im_proto.ConversationInfoV2.encode(e.conversations,t.uint32(10).fork()).ldelim(),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationMessage;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversations=d.im_proto.ConversationInfoV2.decode(e,e.uint32());break;case 2:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("conversations"))throw c.ProtocolError("missing required 'conversations'",{instance:o});return o},e}(),e.MessageStatus=function(){const e={},t=Object.create(e);return t[e[0]="AVAILABLE"]=0,t[e[1]="NOT_EXIST"]=1,t[e[2]="INVISIBLE"]=2,t[e[3]="RECALLED"]=3,t[e[4]="DELETED"]=4,t}(),e.BatchUnmarkMessageRequestBody=function(){function e(e){if(this.server_message_ids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_message_ids=c.emptyArray,e.prototype.action_type=0,e.prototype.tag=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_ids&&e.server_message_ids.length)for(var n=0;n<e.server_message_ids.length;++n)t.uint32(32).int64(e.server_message_ids[n]);return null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(40).int32(e.action_type),null!=e.tag&&Object.hasOwnProperty.call(e,"tag")&&t.uint32(48).int64(e.tag),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BatchUnmarkMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:if(o.server_message_ids&&o.server_message_ids.length||(o.server_message_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.server_message_ids.push(e.int64());else o.server_message_ids.push(e.int64());break;case 5:o.action_type=e.int32();break;case 6:o.tag=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.BatchUnmarkMessageResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(16).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(26).string(e.check_message),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(32).int32(e.status),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.BatchUnmarkMessageResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.server_message_id=e.int64();break;case 2:o.check_code=e.int64();break;case 3:o.check_message=e.string();break;case 4:o.status=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.MarkMsgUnreadCountReportRequestBody=function(){function e(e){if(this.tag_unread_count={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.total_unread_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.tag_unread_count=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(32).int64(e.total_unread_count),null!=e.tag_unread_count&&Object.hasOwnProperty.call(e,"tag_unread_count"))for(var n=Object.keys(e.tag_unread_count),o=0;o<n.length;++o)t.uint32(42).fork().uint32(8).int64(n[o]).uint32(16).int64(e.tag_unread_count[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.MarkMsgUnreadCountReportRequestBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.conversation_id=e.string();break;case 2:i.conversation_type=e.int32();break;case 3:i.conversation_short_id=e.int64();break;case 4:i.total_unread_count=e.int64();break;case 5:i.tag_unread_count===c.emptyObject&&(i.tag_unread_count={});var u=e.uint32()+e.pos;for(n=0,o=0;e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.int64();break;case 2:o=e.int64();break;default:e.skipType(7&l)}}i.tag_unread_count["object"==typeof n?c.longToHash(n):n]=o;break;default:e.skipType(7&a)}}return i},e}(),e.MarkMsgUnreadCountReportResponseBody=function(){function e(e){if(this.failed_tag_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.set_total_status=!1,e.prototype.failed_tag_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.set_total_status&&Object.hasOwnProperty.call(e,"set_total_status")&&t.uint32(8).bool(e.set_total_status),null!=e.failed_tag_list&&e.failed_tag_list.length)for(var n=0;n<e.failed_tag_list.length;++n)t.uint32(16).int64(e.failed_tag_list[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MarkMsgUnreadCountReportResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.set_total_status=e.bool();break;case 2:if(o.failed_tag_list&&o.failed_tag_list.length||(o.failed_tag_list=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_tag_list.push(e.int64());else o.failed_tag_list.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.MarkMsgGetUnreadCountRequestBody=function(){function e(e){if(this.tags=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.get_total=!1,e.prototype.tags=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.get_total&&Object.hasOwnProperty.call(e,"get_total")&&t.uint32(32).bool(e.get_total),null!=e.tags&&e.tags.length)for(var n=0;n<e.tags.length;++n)t.uint32(40).int64(e.tags[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.MarkMsgGetUnreadCountRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.get_total=e.bool();break;case 5:if(o.tags&&o.tags.length||(o.tags=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.tags.push(e.int64());else o.tags.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e.MarkMsgGetUnreadCountResponseBody=function(){function e(e){if(this.tag_unread_count={},this.failed_tag_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.total_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.tag_unread_count=c.emptyObject,e.prototype.failed_tag_list=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.total_count&&Object.hasOwnProperty.call(e,"total_count")&&t.uint32(8).int64(e.total_count),null!=e.tag_unread_count&&Object.hasOwnProperty.call(e,"tag_unread_count"))for(var n=Object.keys(e.tag_unread_count),o=0;o<n.length;++o)t.uint32(18).fork().uint32(8).int64(n[o]).uint32(16).int64(e.tag_unread_count[n[o]]).ldelim();if(null!=e.failed_tag_list&&e.failed_tag_list.length)for(o=0;o<e.failed_tag_list.length;++o)t.uint32(24).int64(e.failed_tag_list[o]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.MarkMsgGetUnreadCountResponseBody;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.total_count=e.int64();break;case 2:i.tag_unread_count===c.emptyObject&&(i.tag_unread_count={});var u=e.uint32()+e.pos;for(n=0,o=0;e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.int64();break;case 2:o=e.int64();break;default:e.skipType(7&l)}}i.tag_unread_count["object"==typeof n?c.longToHash(n):n]=o;break;case 3:if(i.failed_tag_list&&i.failed_tag_list.length||(i.failed_tag_list=[]),2==(7&a))for(u=e.uint32()+e.pos;e.pos<u;)i.failed_tag_list.push(e.int64());else i.failed_tag_list.push(e.int64());break;default:e.skipType(7&a)}}return i},e}(),e.AudioRecognitionRequestInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.content="",e.prototype.uid=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.audio_option=null,e.prototype.conv_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(10).string(e.content),t.uint32(16).int64(e.uid),t.uint32(24).int64(e.server_message_id),d.im_proto.AudioOption.encode(e.audio_option,t.uint32(42).fork()).ldelim(),t.uint32(48).int64(e.conv_short_id),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.AudioRecognitionRequestInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.content=e.string();break;case 2:o.uid=e.int64();break;case 3:o.server_message_id=e.int64();break;case 5:o.audio_option=d.im_proto.AudioOption.decode(e,e.uint32());break;case 6:o.conv_short_id=e.int64();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("content"))throw c.ProtocolError("missing required 'content'",{instance:o});if(!o.hasOwnProperty("uid"))throw c.ProtocolError("missing required 'uid'",{instance:o});if(!o.hasOwnProperty("server_message_id"))throw c.ProtocolError("missing required 'server_message_id'",{instance:o});if(!o.hasOwnProperty("audio_option"))throw c.ProtocolError("missing required 'audio_option'",{instance:o});if(!o.hasOwnProperty("conv_short_id"))throw c.ProtocolError("missing required 'conv_short_id'",{instance:o});return o},e}(),e.AudioRecognitionRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.audio=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),d.im_proto.AudioRecognitionRequestInfo.encode(e.audio,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.AudioRecognitionRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.audio=d.im_proto.AudioRecognitionRequestInfo.decode(e,e.uint32());else e.skipType(7&r)}if(!o.hasOwnProperty("audio"))throw c.ProtocolError("missing required 'audio'",{instance:o});return o},e}(),e.AudioRecognitionResponseInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.uid=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.audio_text="",e.prototype.content="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(8).int64(e.uid),t.uint32(16).int64(e.server_message_id),t.uint32(26).string(e.audio_text),t.uint32(34).string(e.content),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.AudioRecognitionResponseInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.uid=e.int64();break;case 2:o.server_message_id=e.int64();break;case 3:o.audio_text=e.string();break;case 4:o.content=e.string();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("uid"))throw c.ProtocolError("missing required 'uid'",{instance:o});if(!o.hasOwnProperty("server_message_id"))throw c.ProtocolError("missing required 'server_message_id'",{instance:o});if(!o.hasOwnProperty("audio_text"))throw c.ProtocolError("missing required 'audio_text'",{instance:o});if(!o.hasOwnProperty("content"))throw c.ProtocolError("missing required 'content'",{instance:o});return o},e}(),e.AudioRecognitionResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.check_code=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.audio=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(8).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(18).string(e.check_message),d.im_proto.AudioRecognitionResponseInfo.encode(e.audio,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.AudioRecognitionResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.check_code=e.int64();break;case 2:o.check_message=e.string();break;case 3:o.audio=d.im_proto.AudioRecognitionResponseInfo.decode(e,e.uint32());break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("audio"))throw c.ProtocolError("missing required 'audio'",{instance:o});return o},e}(),e.GetTagMetaInfoRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.filter_deleted_tag=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.filter_deleted_tag&&Object.hasOwnProperty.call(e,"filter_deleted_tag")&&t.uint32(8).bool(e.filter_deleted_tag),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetTagMetaInfoRequestBody;e.pos<n;){var r=e.uint32();if(r>>>3==1)o.filter_deleted_tag=e.bool();else e.skipType(7&r)}return o},e}(),e.TagMetaInfo=function(){function e(e){if(this.ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tag_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.tag_name="",e.prototype.status=0,e.prototype.ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.tag_id),t.uint32(18).string(e.tag_name),t.uint32(24).int32(e.status),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(34).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.TagMetaInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.tag_id=e.int64();break;case 2:i.tag_name=e.string();break;case 3:i.status=e.int32();break;case 4:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;default:e.skipType(7&a)}}if(!i.hasOwnProperty("tag_id"))throw c.ProtocolError("missing required 'tag_id'",{instance:i});if(!i.hasOwnProperty("tag_name"))throw c.ProtocolError("missing required 'tag_name'",{instance:i});if(!i.hasOwnProperty("status"))throw c.ProtocolError("missing required 'status'",{instance:i});return i},e}(),e.GetTagMetaInfoResponseBody=function(){function e(e){if(this.tag_meta_info_list=[],this.user_custom_tag_meta_info_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tag_meta_info_list=c.emptyArray,e.prototype.user_conv_tag_limit=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.user_custom_tag_meta_info_list=c.emptyArray,e.prototype.user_conv_custom_tag_limit=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.user_custom_tag_meta_info_limit=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.tag_meta_info_list&&e.tag_meta_info_list.length)for(var n=0;n<e.tag_meta_info_list.length;++n)d.im_proto.TagMetaInfo.encode(e.tag_meta_info_list[n],t.uint32(10).fork()).ldelim();if(t.uint32(16).int64(e.user_conv_tag_limit),null!=e.user_custom_tag_meta_info_list&&e.user_custom_tag_meta_info_list.length)for(n=0;n<e.user_custom_tag_meta_info_list.length;++n)d.im_proto.TagMetaInfo.encode(e.user_custom_tag_meta_info_list[n],t.uint32(26).fork()).ldelim();return t.uint32(32).int64(e.user_conv_custom_tag_limit),t.uint32(40).int64(e.user_custom_tag_meta_info_limit),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetTagMetaInfoResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.tag_meta_info_list&&o.tag_meta_info_list.length||(o.tag_meta_info_list=[]),o.tag_meta_info_list.push(d.im_proto.TagMetaInfo.decode(e,e.uint32()));break;case 2:o.user_conv_tag_limit=e.int64();break;case 3:o.user_custom_tag_meta_info_list&&o.user_custom_tag_meta_info_list.length||(o.user_custom_tag_meta_info_list=[]),o.user_custom_tag_meta_info_list.push(d.im_proto.TagMetaInfo.decode(e,e.uint32()));break;case 4:o.user_conv_custom_tag_limit=e.int64();break;case 5:o.user_custom_tag_meta_info_limit=e.int64();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("user_conv_tag_limit"))throw c.ProtocolError("missing required 'user_conv_tag_limit'",{instance:o});if(!o.hasOwnProperty("user_conv_custom_tag_limit"))throw c.ProtocolError("missing required 'user_conv_custom_tag_limit'",{instance:o});if(!o.hasOwnProperty("user_custom_tag_meta_info_limit"))throw c.ProtocolError("missing required 'user_custom_tag_meta_info_limit'",{instance:o});return o},e}(),e.SetConversationTagRequestBody=function(){function e(e){if(this.tag_ids=[],this.conv_short_ids=[],this.user_custom_tag_ids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tag_ids=c.emptyArray,e.prototype.conv_short_ids=c.emptyArray,e.prototype.is_unset=!1,e.prototype.user_custom_tag_ids=c.emptyArray,e.prototype.inbox_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.tag_ids&&e.tag_ids.length)for(var n=0;n<e.tag_ids.length;++n)t.uint32(8).int64(e.tag_ids[n]);if(null!=e.conv_short_ids&&e.conv_short_ids.length)for(n=0;n<e.conv_short_ids.length;++n)t.uint32(16).int64(e.conv_short_ids[n]);if(t.uint32(24).bool(e.is_unset),null!=e.user_custom_tag_ids&&e.user_custom_tag_ids.length)for(n=0;n<e.user_custom_tag_ids.length;++n)t.uint32(32).int64(e.user_custom_tag_ids[n]);return t.uint32(40).int32(e.inbox_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SetConversationTagRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:if(o.tag_ids&&o.tag_ids.length||(o.tag_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.tag_ids.push(e.int64());else o.tag_ids.push(e.int64());break;case 2:if(o.conv_short_ids&&o.conv_short_ids.length||(o.conv_short_ids=[]),2==(7&r))for(i=e.uint32()+e.pos;e.pos<i;)o.conv_short_ids.push(e.int64());else o.conv_short_ids.push(e.int64());break;case 3:o.is_unset=e.bool();break;case 4:if(o.user_custom_tag_ids&&o.user_custom_tag_ids.length||(o.user_custom_tag_ids=[]),2==(7&r))for(i=e.uint32()+e.pos;e.pos<i;)o.user_custom_tag_ids.push(e.int64());else o.user_custom_tag_ids.push(e.int64());break;case 5:o.inbox_type=e.int32();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("is_unset"))throw c.ProtocolError("missing required 'is_unset'",{instance:o});if(!o.hasOwnProperty("inbox_type"))throw c.ProtocolError("missing required 'inbox_type'",{instance:o});return o},e}(),e.SetConversationTagResponseBody=function(){function e(e){if(this.failed_conv_short_ids=[],this.settings=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.failed_conv_short_ids=c.emptyArray,e.prototype.settings=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.failed_conv_short_ids&&e.failed_conv_short_ids.length)for(var n=0;n<e.failed_conv_short_ids.length;++n)t.uint32(8).int64(e.failed_conv_short_ids[n]);if(null!=e.settings&&e.settings.length)for(n=0;n<e.settings.length;++n)d.im_proto.ConversationSettingInfo.encode(e.settings[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.SetConversationTagResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:if(o.failed_conv_short_ids&&o.failed_conv_short_ids.length||(o.failed_conv_short_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_conv_short_ids.push(e.int64());else o.failed_conv_short_ids.push(e.int64());break;case 2:o.settings&&o.settings.length||(o.settings=[]),o.settings.push(d.im_proto.ConversationSettingInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return o},e}(),e.GetConversationsByTagRequestBody=function(){function e(e){if(this.tag_id=[],this.user_custom_tag_id=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tag_id=c.emptyArray,e.prototype.user_custom_tag_id=c.emptyArray,e.prototype.cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.limit=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.inbox_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.tag_id&&e.tag_id.length)for(var n=0;n<e.tag_id.length;++n)t.uint32(8).int64(e.tag_id[n]);if(null!=e.user_custom_tag_id&&e.user_custom_tag_id.length)for(n=0;n<e.user_custom_tag_id.length;++n)t.uint32(16).int64(e.user_custom_tag_id[n]);return t.uint32(24).int64(e.cursor),t.uint32(32).int64(e.limit),t.uint32(40).int32(e.inbox_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationsByTagRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:if(o.tag_id&&o.tag_id.length||(o.tag_id=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.tag_id.push(e.int64());else o.tag_id.push(e.int64());break;case 2:if(o.user_custom_tag_id&&o.user_custom_tag_id.length||(o.user_custom_tag_id=[]),2==(7&r))for(i=e.uint32()+e.pos;e.pos<i;)o.user_custom_tag_id.push(e.int64());else o.user_custom_tag_id.push(e.int64());break;case 3:o.cursor=e.int64();break;case 4:o.limit=e.int64();break;case 5:o.inbox_type=e.int32();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("cursor"))throw c.ProtocolError("missing required 'cursor'",{instance:o});if(!o.hasOwnProperty("limit"))throw c.ProtocolError("missing required 'limit'",{instance:o});if(!o.hasOwnProperty("inbox_type"))throw c.ProtocolError("missing required 'inbox_type'",{instance:o});return o},e}(),e.GetConversationsByTagResponseBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_info_list=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var n=0;n<e.conversation_info_list.length;++n)d.im_proto.ConversationInfoV2.encode(e.conversation_info_list[n],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetConversationsByTagResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_info_list&&o.conversation_info_list.length||(o.conversation_info_list=[]),o.conversation_info_list.push(d.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cursor=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.GetUserMessageRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.cmd_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.stranger_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.source="",e.prototype.consult_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.notify_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.get_recent_conv_and_msg=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).int64(e.version),null!=e.cmd_index&&Object.hasOwnProperty.call(e,"cmd_index")&&t.uint32(16).int64(e.cmd_index),null!=e.stranger_version&&Object.hasOwnProperty.call(e,"stranger_version")&&t.uint32(24).int64(e.stranger_version),null!=e.read_version&&Object.hasOwnProperty.call(e,"read_version")&&t.uint32(32).int64(e.read_version),null!=e.source&&Object.hasOwnProperty.call(e,"source")&&t.uint32(42).string(e.source),null!=e.consult_version&&Object.hasOwnProperty.call(e,"consult_version")&&t.uint32(48).int64(e.consult_version),null!=e.notify_version&&Object.hasOwnProperty.call(e,"notify_version")&&t.uint32(136).int64(e.notify_version),null!=e.get_recent_conv_and_msg&&Object.hasOwnProperty.call(e,"get_recent_conv_and_msg")&&d.im_proto.GetRecentConvAndMsgRequestBody.encode(e.get_recent_conv_and_msg,t.uint32(146).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetUserMessageRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.version=e.int64();break;case 2:o.cmd_index=e.int64();break;case 3:o.stranger_version=e.int64();break;case 4:o.read_version=e.int64();break;case 5:o.source=e.string();break;case 6:o.consult_version=e.int64();break;case 17:o.notify_version=e.int64();break;case 18:o.get_recent_conv_and_msg=d.im_proto.GetRecentConvAndMsgRequestBody.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e}(),e.GetRecentConvAndMsgRequestBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.left_side=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.right_side=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.direction=1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.left_side&&Object.hasOwnProperty.call(e,"left_side")&&t.uint32(8).int64(e.left_side),null!=e.right_side&&Object.hasOwnProperty.call(e,"right_side")&&t.uint32(16).int64(e.right_side),null!=e.direction&&Object.hasOwnProperty.call(e,"direction")&&t.uint32(24).int32(e.direction),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetRecentConvAndMsgRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.left_side=e.int64();break;case 2:o.right_side=e.int64();break;case 3:o.direction=e.int32();break;default:e.skipType(7&r)}}return o},e}(),e.GetUserMessageResponseBody=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=null,e.prototype.cmd_messages=null,e.prototype.has_stranger_message=!1,e.prototype.read_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.messages&&Object.hasOwnProperty.call(e,"messages")&&d.im_proto.GetRecentMessageRespBody.encode(e.messages,t.uint32(10).fork()).ldelim(),null!=e.cmd_messages&&Object.hasOwnProperty.call(e,"cmd_messages")&&d.im_proto.GetCmdMessageRespBody.encode(e.cmd_messages,t.uint32(18).fork()).ldelim(),null!=e.has_stranger_message&&Object.hasOwnProperty.call(e,"has_stranger_message")&&t.uint32(24).bool(e.has_stranger_message),null!=e.read_info&&Object.hasOwnProperty.call(e,"read_info")&&d.im_proto.ConversationReadInfoRespBody.encode(e.read_info,t.uint32(34).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetUserMessageResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages=d.im_proto.GetRecentMessageRespBody.decode(e,e.uint32());break;case 2:o.cmd_messages=d.im_proto.GetCmdMessageRespBody.decode(e,e.uint32());break;case 3:o.has_stranger_message=e.bool();break;case 4:o.read_info=d.im_proto.ConversationReadInfoRespBody.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e}(),e.GetRecentMessageRespBody=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.next_conversation_version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.messages=c.emptyArray,e.prototype.has_more=!1,e.prototype.range=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.next_conversation_version),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.ConversationRecentMessage.encode(e.messages[n],t.uint32(18).fork()).ldelim();return t.uint32(24).bool(e.has_more),null!=e.range&&Object.hasOwnProperty.call(e,"range")&&d.im_proto.GetRecentMsgVersionRange.encode(e.range,t.uint32(34).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetRecentMessageRespBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.next_conversation_version=e.int64();break;case 2:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.ConversationRecentMessage.decode(e,e.uint32()));break;case 3:o.has_more=e.bool();break;case 4:o.range=d.im_proto.GetRecentMsgVersionRange.decode(e,e.uint32());break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("next_conversation_version"))throw c.ProtocolError("missing required 'next_conversation_version'",{instance:o});if(!o.hasOwnProperty("has_more"))throw c.ProtocolError("missing required 'has_more'",{instance:o});return o},e}(),e.GetCmdMessageRespBody=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_cmd_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.next_user_message_cursor=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.readconv_version=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(10).fork()).ldelim();return t.uint32(16).bool(e.has_more),null!=e.next_cmd_index&&Object.hasOwnProperty.call(e,"next_cmd_index")&&t.uint32(24).int64(e.next_cmd_index),null!=e.next_user_message_cursor&&Object.hasOwnProperty.call(e,"next_user_message_cursor")&&t.uint32(32).int64(e.next_user_message_cursor),null!=e.readconv_version&&Object.hasOwnProperty.call(e,"readconv_version")&&t.uint32(40).int64(e.readconv_version),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetCmdMessageRespBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_cmd_index=e.int64();break;case 4:o.next_user_message_cursor=e.int64();break;case 5:o.readconv_version=e.int64();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("has_more"))throw c.ProtocolError("missing required 'has_more'",{instance:o});return o},e}(),e.ConversationReadInfoRespBody=function(){function e(e){if(this.read_info=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.read_info=c.emptyArray,e.prototype.has_more=!1,e.prototype.next_version=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.read_info&&e.read_info.length)for(var n=0;n<e.read_info.length;++n)d.im_proto.ConversationReadInfo.encode(e.read_info[n],t.uint32(10).fork()).ldelim();return t.uint32(16).bool(e.has_more),t.uint32(24).int64(e.next_version),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationReadInfoRespBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.read_info&&o.read_info.length||(o.read_info=[]),o.read_info.push(d.im_proto.ConversationReadInfo.decode(e,e.uint32()));break;case 2:o.has_more=e.bool();break;case 3:o.next_version=e.int64();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("has_more"))throw c.ProtocolError("missing required 'has_more'",{instance:o});if(!o.hasOwnProperty("next_version"))throw c.ProtocolError("missing required 'next_version'",{instance:o});return o},e}(),e.ConversationRecentMessage=function(){function e(e){if(this.messages=[],this.ext_messages=[],this.mute_badge_count_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversation_short_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.messages=c.emptyArray,e.prototype.version=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.badge_count=0,e.prototype.conversation_id="",e.prototype.ext_messages=c.emptyArray,e.prototype.mute_badge_count_infos=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.conversation_short_id),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)d.im_proto.MessageBody.encode(e.messages[n],t.uint32(18).fork()).ldelim();if(t.uint32(24).int64(e.version),null!=e.badge_count&&Object.hasOwnProperty.call(e,"badge_count")&&t.uint32(32).int32(e.badge_count),t.uint32(42).string(e.conversation_id),null!=e.ext_messages&&e.ext_messages.length)for(n=0;n<e.ext_messages.length;++n)d.im_proto.MessageBody.encode(e.ext_messages[n],t.uint32(50).fork()).ldelim();if(null!=e.mute_badge_count_infos&&e.mute_badge_count_infos.length)for(n=0;n<e.mute_badge_count_infos.length;++n)d.im_proto.MuteBadgeCountInfo.encode(e.mute_badge_count_infos[n],t.uint32(74).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationRecentMessage;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.messages&&o.messages.length||(o.messages=[]),o.messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 3:o.version=e.int64();break;case 4:o.badge_count=e.int32();break;case 5:o.conversation_id=e.string();break;case 6:o.ext_messages&&o.ext_messages.length||(o.ext_messages=[]),o.ext_messages.push(d.im_proto.MessageBody.decode(e,e.uint32()));break;case 9:o.mute_badge_count_infos&&o.mute_badge_count_infos.length||(o.mute_badge_count_infos=[]),o.mute_badge_count_infos.push(d.im_proto.MuteBadgeCountInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("conversation_short_id"))throw c.ProtocolError("missing required 'conversation_short_id'",{instance:o});if(!o.hasOwnProperty("version"))throw c.ProtocolError("missing required 'version'",{instance:o});if(!o.hasOwnProperty("conversation_id"))throw c.ProtocolError("missing required 'conversation_id'",{instance:o});return o},e}(),e.GetRecentMsgVersionRange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.left_side=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.right_side=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.left_side&&Object.hasOwnProperty.call(e,"left_side")&&t.uint32(8).int64(e.left_side),null!=e.right_side&&Object.hasOwnProperty.call(e,"right_side")&&t.uint32(16).int64(e.right_side),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.GetRecentMsgVersionRange;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.left_side=e.int64();break;case 2:o.right_side=e.int64();break;default:e.skipType(7&r)}}return o},e}(),e.ConversationReadInfo=function(){function e(e){if(this.mute_read_badge_count_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.read_index=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_badge_count=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.read_index_v2=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ConversationShortId=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.ConversationId="",e.prototype.mute_read_badge_count_infos=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.read_index),t.uint32(16).int64(e.read_badge_count),t.uint32(24).int64(e.read_index_v2),t.uint32(32).int64(e.ConversationShortId),null!=e.ConversationId&&Object.hasOwnProperty.call(e,"ConversationId")&&t.uint32(42).string(e.ConversationId),null!=e.mute_read_badge_count_infos&&e.mute_read_badge_count_infos.length)for(var n=0;n<e.mute_read_badge_count_infos.length;++n)d.im_proto.MuteReadBadgeCountInfo.encode(e.mute_read_badge_count_infos[n],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ConversationReadInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.read_index=e.int64();break;case 2:o.read_badge_count=e.int64();break;case 3:o.read_index_v2=e.int64();break;case 4:o.ConversationShortId=e.int64();break;case 5:o.ConversationId=e.string();break;case 6:o.mute_read_badge_count_infos&&o.mute_read_badge_count_infos.length||(o.mute_read_badge_count_infos=[]),o.mute_read_badge_count_infos.push(d.im_proto.MuteReadBadgeCountInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("read_index"))throw c.ProtocolError("missing required 'read_index'",{instance:o});if(!o.hasOwnProperty("read_badge_count"))throw c.ProtocolError("missing required 'read_badge_count'",{instance:o});if(!o.hasOwnProperty("read_index_v2"))throw c.ProtocolError("missing required 'read_index_v2'",{instance:o});if(!o.hasOwnProperty("ConversationShortId"))throw c.ProtocolError("missing required 'ConversationShortId'",{instance:o});return o},e}(),e.AddUserCustomTagMetaInfo=function(){function e(e){if(this.ext={},this.init_conv_short_ids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tag_name="",e.prototype.ext=c.emptyObject,e.prototype.init_conv_short_ids=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(10).string(e.tag_name),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var n=Object.keys(e.ext),o=0;o<n.length;++o)t.uint32(18).fork().uint32(10).string(n[o]).uint32(18).string(e.ext[n[o]]).ldelim();if(null!=e.init_conv_short_ids&&e.init_conv_short_ids.length)for(o=0;o<e.init_conv_short_ids.length;++o)t.uint32(24).int64(e.init_conv_short_ids[o]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.AddUserCustomTagMetaInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.tag_name=e.string();break;case 2:i.ext===c.emptyObject&&(i.ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l=e.uint32();switch(l>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.ext[n]=o;break;case 3:if(i.init_conv_short_ids&&i.init_conv_short_ids.length||(i.init_conv_short_ids=[]),2==(7&a))for(u=e.uint32()+e.pos;e.pos<u;)i.init_conv_short_ids.push(e.int64());else i.init_conv_short_ids.push(e.int64());break;default:e.skipType(7&a)}}if(!i.hasOwnProperty("tag_name"))throw c.ProtocolError("missing required 'tag_name'",{instance:i});return i},e}(),e.AddUserCustomTagMetaInfoResult=function(){function e(e){if(this.failed_conversation_ids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tag_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.failed_conversation_ids=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.tag_id),null!=e.failed_conversation_ids&&e.failed_conversation_ids.length)for(var n=0;n<e.failed_conversation_ids.length;++n)t.uint32(16).int64(e.failed_conversation_ids[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.AddUserCustomTagMetaInfoResult;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.tag_id=e.int64();break;case 2:if(o.failed_conversation_ids&&o.failed_conversation_ids.length||(o.failed_conversation_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.failed_conversation_ids.push(e.int64());else o.failed_conversation_ids.push(e.int64());break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("tag_id"))throw c.ProtocolError("missing required 'tag_id'",{instance:o});return o},e}(),e.UpdateUserCustomTagMetaInfo=function(){function e(e){if(this.upsert_ext={},this.delete_ext={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tag_id=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.tag_name="",e.prototype.upsert_ext=c.emptyObject,e.prototype.delete_ext=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),t.uint32(8).int64(e.tag_id),null!=e.tag_name&&Object.hasOwnProperty.call(e,"tag_name")&&t.uint32(18).string(e.tag_name),null!=e.upsert_ext&&Object.hasOwnProperty.call(e,"upsert_ext"))for(var n=Object.keys(e.upsert_ext),o=0;o<n.length;++o)t.uint32(26).fork().uint32(10).string(n[o]).uint32(18).string(e.upsert_ext[n[o]]).ldelim();if(null!=e.delete_ext&&Object.hasOwnProperty.call(e,"delete_ext"))for(n=Object.keys(e.delete_ext),o=0;o<n.length;++o)t.uint32(34).fork().uint32(10).string(n[o]).uint32(18).string(e.delete_ext[n[o]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n,o,r=t===undefined?e.len:e.pos+t,i=new d.im_proto.UpdateUserCustomTagMetaInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:i.tag_id=e.int64();break;case 2:i.tag_name=e.string();break;case 3:i.upsert_ext===c.emptyObject&&(i.upsert_ext={});var u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){switch((l=e.uint32())>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.upsert_ext[n]=o;break;case 4:i.delete_ext===c.emptyObject&&(i.delete_ext={});u=e.uint32()+e.pos;for(n="",o="";e.pos<u;){var l;switch((l=e.uint32())>>>3){case 1:n=e.string();break;case 2:o=e.string();break;default:e.skipType(7&l)}}i.delete_ext[n]=o;break;default:e.skipType(7&a)}}if(!i.hasOwnProperty("tag_id"))throw c.ProtocolError("missing required 'tag_id'",{instance:i});return i},e}(),e.ManageTagMetaInfoRequestBody=function(){function e(e){if(this.add_tag_meta_infos=[],this.delete_tag_ids=[],this.update_tag_meta_infos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.add_tag_meta_infos=c.emptyArray,e.prototype.delete_tag_ids=c.emptyArray,e.prototype.update_tag_meta_infos=c.emptyArray,e.prototype.inbox_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.add_tag_meta_infos&&e.add_tag_meta_infos.length)for(var n=0;n<e.add_tag_meta_infos.length;++n)d.im_proto.AddUserCustomTagMetaInfo.encode(e.add_tag_meta_infos[n],t.uint32(10).fork()).ldelim();if(null!=e.delete_tag_ids&&e.delete_tag_ids.length)for(n=0;n<e.delete_tag_ids.length;++n)t.uint32(16).int64(e.delete_tag_ids[n]);if(null!=e.update_tag_meta_infos&&e.update_tag_meta_infos.length)for(n=0;n<e.update_tag_meta_infos.length;++n)d.im_proto.UpdateUserCustomTagMetaInfo.encode(e.update_tag_meta_infos[n],t.uint32(26).fork()).ldelim();return t.uint32(32).int32(e.inbox_type),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ManageTagMetaInfoRequestBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.add_tag_meta_infos&&o.add_tag_meta_infos.length||(o.add_tag_meta_infos=[]),o.add_tag_meta_infos.push(d.im_proto.AddUserCustomTagMetaInfo.decode(e,e.uint32()));break;case 2:if(o.delete_tag_ids&&o.delete_tag_ids.length||(o.delete_tag_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.delete_tag_ids.push(e.int64());else o.delete_tag_ids.push(e.int64());break;case 3:o.update_tag_meta_infos&&o.update_tag_meta_infos.length||(o.update_tag_meta_infos=[]),o.update_tag_meta_infos.push(d.im_proto.UpdateUserCustomTagMetaInfo.decode(e,e.uint32()));break;case 4:o.inbox_type=e.int32();break;default:e.skipType(7&r)}}if(!o.hasOwnProperty("inbox_type"))throw c.ProtocolError("missing required 'inbox_type'",{instance:o});return o},e}(),e.ManageTagMetaInfoResponseBody=function(){function e(e){if(this.add_results=[],this.delete_failed_tag_ids=[],this.update_failed_tag_ids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.add_results=c.emptyArray,e.prototype.delete_failed_tag_ids=c.emptyArray,e.prototype.update_failed_tag_ids=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.add_results&&e.add_results.length)for(var n=0;n<e.add_results.length;++n)d.im_proto.AddUserCustomTagMetaInfoResult.encode(e.add_results[n],t.uint32(10).fork()).ldelim();if(null!=e.delete_failed_tag_ids&&e.delete_failed_tag_ids.length)for(n=0;n<e.delete_failed_tag_ids.length;++n)t.uint32(16).int64(e.delete_failed_tag_ids[n]);if(null!=e.update_failed_tag_ids&&e.update_failed_tag_ids.length)for(n=0;n<e.update_failed_tag_ids.length;++n)t.uint32(24).int64(e.update_failed_tag_ids[n]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var n=t===undefined?e.len:e.pos+t,o=new d.im_proto.ManageTagMetaInfoResponseBody;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.add_results&&o.add_results.length||(o.add_results=[]),o.add_results.push(d.im_proto.AddUserCustomTagMetaInfoResult.decode(e,e.uint32()));break;case 2:if(o.delete_failed_tag_ids&&o.delete_failed_tag_ids.length||(o.delete_failed_tag_ids=[]),2==(7&r))for(var i=e.uint32()+e.pos;e.pos<i;)o.delete_failed_tag_ids.push(e.int64());else o.delete_failed_tag_ids.push(e.int64());break;case 3:if(o.update_failed_tag_ids&&o.update_failed_tag_ids.length||(o.update_failed_tag_ids=[]),2==(7&r))for(i=e.uint32()+e.pos;e.pos<i;)o.update_failed_tag_ids.push(e.int64());else o.update_failed_tag_ids.push(e.int64());break;default:e.skipType(7&r)}}return o},e}(),e})()},77062:function(e,t,n){"use strict";n.d(t,{v:function(){return a}});var o=n(15727),r=(n(9267),n(39805)),i=n(3539),s=(n(26919),n(82201),n(17390));class a extends s.v{constructor(){super(...arguments),this.name="SharkPlugin",this.enabled=!0}install(){this.register(i.Uk.SharkPlugin,this);try{this.ctx.option.sharkAppName!==undefined&&this.ctx.option.sharkPriorityRegion!==undefined||(r.Y.ctxWarn(this.ctx,"shark required field not provided, ignore shark params"),this.enabled=!1),"undefined"==typeof navigator&&r.Y.ctxWarn(this.ctx,"window.navigator not available, may missing param"),"undefined"==typeof screen&&r.Y.ctxWarn(this.ctx,"window.screen not available, may missing param"),"undefined"==typeof document&&r.Y.ctxWarn(this.ctx,"window.document not available, may missing param"),"undefined"!=typeof Intl&&"undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat&&"function"==typeof Intl.DateTimeFormat().resolvedOptions||r.Y.ctxWarn(this.ctx,"window.Intl not available, may missing param")}catch(e){r.Y.ctxError(this.ctx,"shark init error:",e),this.enabled=!1}}sendPacket(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return this.enabled&&this.fillSharkParam(e),e}))}fillSharkParam(e){var t,n,o,i,s,a,c,d,u,l,_,p,v,g,h,f,y;const m={};try{m.session_aid=null!==(t=this.ctx.option.appId.toString())&&void 0!==t?t:"",m.session_did=null!==(n=this.ctx.option.deviceId.toString())&&void 0!==n?n:"",m.app_name=this.ctx.option.sharkAppName,m.priority_region=this.ctx.option.sharkPriorityRegion,"undefined"!=typeof navigator&&(m.user_agent=null!==(o=navigator.userAgent)&&void 0!==o?o:"",m.cookie_enabled=null!==(s=null===(i=navigator.cookieEnabled)||void 0===i?void 0:i.toString())&&void 0!==s?s:"",m.browser_language=null!==(a=navigator.language)&&void 0!==a?a:"",m.browser_platform=null!==(c=navigator.platform)&&void 0!==c?c:"",m.browser_name=null!==(d=navigator.appCodeName)&&void 0!==d?d:"",m.browser_version=null!==(u=navigator.appVersion)&&void 0!==u?u:"",m.browser_online=null!==(_=null===(l=navigator.onLine)||void 0===l?void 0:l.toString())&&void 0!==_?_:""),"undefined"!=typeof screen&&(m.screen_width=null!==(v=null===(p=screen.width)||void 0===p?void 0:p.toString())&&void 0!==v?v:"",m.screen_height=null!==(h=null===(g=screen.height)||void 0===g?void 0:g.toString())&&void 0!==h?h:""),"undefined"!=typeof document&&(m.referer=null!==(f=document.referrer)&&void 0!==f?f:""),"undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat&&"function"==typeof Intl.DateTimeFormat().resolvedOptions&&(m.timezone_name=null!==(y=Intl.DateTimeFormat().resolvedOptions().timeZone)&&void 0!==y?y:"")}catch(b){r.Y.ctxWarn(this.ctx,"load shark param error, may missing param",b)}e.headers=Object.assign(Object.assign({},e.headers),m)}}},64595:function(e,t,n){"use strict";n.d(t,{l:function(){return m}});var o=n(15727),r=n(9267),i=n(69071),s=n(29938),a=n(39805),c=n(3539),d=n(86384),u=n(57822),l=n(67466),_=(n(82201),n(17390)),p=n(20710);n(26919);class v extends p.W{GetStrangerConversationList(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_stranger_conversation_body:{cursor:e.cursor,count:r.fromValue(e.limit),show_total_unread:!0}});return this.sendWithRawBody(t,i.m.IMCMD.GET_STRANGER_CONVERSATION_LIST)}))}GetStrangerConversationMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({get_stranger_messages_body:{conversation_short_id:e.shortId,reset_unread_count:e.resetUnreadCount}});return this.sendWithRawBody(t,i.m.IMCMD.GET_STRANGER_MESSAGES_IN_CONVERSATION)}))}DeleteStrangerMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({delete_stranger_message_body:{conversation_short_id:e.shortId,server_message_id:e.serverId}});return this.send(t,i.m.IMCMD.DELETE_STRANGER_MESSAGE)}))}DeleteStrangerConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({delete_stranger_conversation_body:{conversation_short_id:e.shortId}});return this.send(t,i.m.IMCMD.DELETE_STRANGER_CONVERSATION)}))}MarkStrangerConversationRead(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=i.m.RequestBody.create({mark_stranger_conversation_read_body:{conversation_short_id:e.shortId}});return this.send(t,i.m.IMCMD.MARK_STRANGER_CONVERSATION_READ)}))}MarkAllStrangerConversationRead(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const e=i.m.RequestBody.create({mark_stranger_all_conversation_read_body:{}});return this.send(e,i.m.IMCMD.MARK_ALL_STRANGER_CONVERSATIONS_READ)}))}DeleteAllStrangerConversation(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const e=i.m.RequestBody.create({delete_stranger_all_conversation_body:{}});return this.send(e,i.m.IMCMD.DELETE_ALL_STRANGER_CONVERSATIONS)}))}}var g=n(74110);class h extends g.r{get unreadCount(){return this.internalUnreadCount}set unreadCount(e){this.internalUnreadCount=e}get mode(){const e=this.toParticipantUserId,t=this.id.split(":");return t[2]===e?1:t[3]===e?2:3}get ext(){return this.coreInfo.ext}set ext(e){this.coreInfo.ext=e}}var f=n(65066);class y extends f.f{process(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(e.data.type===i.m.MessageType.MESSAGE_TYPE_MODE_CHANGE){const t=this.resolve(c.Uk.ConversationManager).getRaw(e.data.conversationId);if(!t)return a.Y.ctxDebug(this.ctx,`conversation ${e.data.conversationId} not exist, ignore upgrade`),e;if(!t.isStrangerConversation)return a.Y.ctxDebug(this.ctx,`conversation ${e.data.conversationId} not stranger, ignore upgrade`),e;this.resolve(c.Uk.ConversationManager).delete(e.data.conversationId);const n=yield this.resolve(c.Uk.ConversationManager).getWithOnline(e.data.conversationId,e.data.conversationShortId,e.data.conversationType);this.resolve(c.Uk.ConversationManager).markRead(n.id,n.lastMessageIndex,n.badgeCount,[]),a.Y.ctxDebug(this.ctx,"stranger upgrade,",n),this.resolve(c.Uk.EventBus).emit(s.c5.StrangerUpgrade,this,n),e.needContinue=!1}return e}))}}class m extends _.v{constructor(){super(...arguments),this.name="StrangerPlugin",this.internalUnreadCount=0}getStrangerConversationList(e={}){var t,n,s,a,_,p,v;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.api.GetStrangerConversationList({cursor:e.cursor?r.fromValue(e.cursor):r.ZERO,limit:null!==(t=e.limit)&&void 0!==t?t:10}),g=null===(n=o.body)||void 0===n?void 0:n.get_stranger_conversation_body,f=g.conversation_list;this.internalUnreadCount=g.total_unread;let y=!1;if("0"===(null===(s=e.cursor)||void 0===s?void 0:s.toString())&&1===e.limit){const e=yield this.getStrangerPreview({sync:!1});f&&1===f.length&&(null===(a=null==e?void 0:e.conversation)||void 0===a?void 0:a.id)===f[0].conversation_id&&(null===(_=null==e?void 0:e.message)||void 0===_?void 0:_.serverId)===(null===(v=null===(p=f[0].last_message)||void 0===p?void 0:p.server_message_id)||void 0===v?void 0:v.toString())&&(null==e?void 0:e.unreadCount)===(null==g?void 0:g.total_unread)&&(y=!0)}const m=f.map((e=>{var t;const n=new h(this.ctx);if(n.coreInfo=new d._(n),n.settingInfo=new u.H(n),n.id=e.conversation_id,n.shortId=e.conversation_short_id.toString(),n.type=i.m.ConversationType.ONE_TO_ONE_CHAT,n.unreadCount=e.unread,n.isOffline=!1,n.firstPageParticipant=i.m.ParticipantsPage.create({participants:e.participants}),n.ext=null!==(t=e.ext)&&void 0!==t?t:{},!y){this.resolve(c.Uk.ConversationManager).upsert(n);const t=l.v.fromServerMessage(this.ctx,e.last_message,o.log_id);this.resolve(c.Uk.MessageManager).upsert(t)}return n}));return{conversation:m,unreadCount:null==g?void 0:g.total_unread,hasMore:null==g?void 0:g.has_more,cursor:null==g?void 0:g.next_cursor}}))}getStrangerConversationMessage(e){var t,n;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.api.GetStrangerConversationMessage({shortId:r.fromString(e.conversation.shortId),resetUnreadCount:null!==(t=e.resetUnreadCount)&&void 0!==t&&t});return(null===(n=o.body)||void 0===n?void 0:n.get_stranger_messages_body).messages.forEach((e=>this.resolve(c.Uk.MessageManager).upsert(l.v.fromServerMessage(this.ctx,e,o.log_id)))),this.resolve(c.Uk.MessageManager).getList(e.conversation.id)}))}deleteStrangerMessage(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.DeleteStrangerMessage({serverId:r.fromString(e.message.serverId),shortId:r.fromString(e.conversation.shortId)}),this.resolve(c.Uk.MessageManager).delete(e.conversation.id,e.message.serverId)}))}deleteStrangerConversation(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.DeleteStrangerConversation({shortId:r.fromString(e.conversation.shortId)}),this.resolve(c.Uk.ConversationManager).delete(e.conversation.id)}))}deleteAllStrangerConversation(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.DeleteAllStrangerConversation();this.resolve(c.Uk.ConversationManager).getConversationArray((e=>0!==e.mode)).forEach((e=>this.resolve(c.Uk.ConversationManager).delete(e.id))),this.internalUnreadCount=0}))}markStrangerConversationRead(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.MarkStrangerConversationRead({shortId:r.fromString(e.conversation.shortId)}),this.internalUnreadCount-=e.conversation.unreadCount,e.conversation.unreadCount=0,this.resolve(c.Uk.ConversationManager).upsert(e.conversation)}))}markAllStrangerConversationRead(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.api.MarkAllStrangerConversationRead();this.resolve(c.Uk.ConversationManager).getConversationArray((e=>0!==e.mode)).forEach((e=>{e.unreadCount=0,this.resolve(c.Uk.ConversationManager).upsert(e)})),this.internalUnreadCount=0}))}getStrangerTotalUnread(){return this.internalUnreadCount}getStrangerPreview(e={}){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.refreshStrangerPreviewConversation(null!==(t=null==e?void 0:e.sync)&&void 0!==t&&t);return n?{conversation:n,message:n.lastVisibleMessage,unreadCount:this.internalUnreadCount}:null}))}getLocalStrangerConversation(){return this.resolve(c.Uk.ConversationManager).getConversationArray((e=>0!==e.mode))}install(){this.api=this.register(c.Uk.StrangerApi,v),this.register(c.Uk.StrangerPlugin,this),this.instance.getStrangerConversationList=this.extendFunc(this.getStrangerConversationList),this.instance.getStrangerConversationMessage=this.extendFunc(this.getStrangerConversationMessage),this.instance.deleteStrangerMessage=this.extendFunc(this.deleteStrangerMessage),this.instance.deleteStrangerConversation=this.extendFunc(this.deleteStrangerConversation),this.instance.deleteAllStrangerConversation=this.extendFunc(this.deleteAllStrangerConversation),this.instance.markStrangerConversationRead=this.extendFunc(this.markStrangerConversationRead),this.instance.markAllStrangerConversationRead=this.extendFunc(this.markAllStrangerConversationRead),this.instance.getStrangerTotalUnread=this.extendFunc(this.getStrangerTotalUnread),this.instance.getStrangerPreview=this.extendFunc(this.getStrangerPreview),this.instance.getLocalStrangerConversation=this.extendFunc(this.getLocalStrangerConversation),this.resolve(c.Uk.MessageManager).injectProcessor(new y(this.ctx)),this.resolve(c.Uk.EventBus).subscribe(s.c5.StrangerUpgrade,(e=>(0,o.__awaiter)(this,void 0,void 0,(function*(){yield this.resolve(c.Uk.CoreInstance).getMessagesByUser({inboxType:e.inboxType})}))))}init(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){try{yield this.getStrangerPreview({sync:!0})}catch(e){a.Y.ctxWarn(this.ctx,"stranger plugin init error:",e)}}))}receivePacket(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){if(e.cmd===i.m.IMCMD.STRANGER_NEW_MSG_NOTIFY){const n=null===(t=e.body)||void 0===t?void 0:t.has_new_message_notify.message;if(!this.resolve(c.Uk.ConversationManager).getRaw(n.conversation_id))return;const o=l.v.fromServerMessage(this.ctx,n,e.log_id);this.resolve(c.Uk.MessageManager).upsert(o),this.internalUnreadCount++,this.resolve(c.Uk.EventBus).emit(s.c5.ReceiveNewStrangerMessage,this,o)}}))}ticker(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){this.ctx.option.pullInterval&&(yield this.refreshStrangerPreviewConversation(!0))}))}refreshStrangerPreviewConversation(e=!1){return(0,o.__awaiter)(this,void 0,void 0,(function*(){e&&(yield this.getStrangerConversationList({cursor:r.ZERO,limit:1}));const t=this.resolve(c.Uk.ConversationManager).getConversationArray((e=>0!==e.mode));for(const e of t)if(e.lastVisibleMessage)return e;return null}))}}},58908:function(e,t){"use strict";var n,o,r,i,s,a=new Blob(["var fakeIdToID={};addEventListener(\"message\",function(event){try{var{data={}}=event;var{action,fakeId,time}=data;switch(action){case'setInterval':fakeIdToID[fakeId]=setInterval(function(){postMessage({fakeId});},time);break;case'clearInterval':if(fakeIdToID.hasOwnProperty(fakeId)){clearInterval(fakeIdToID[fakeId]);delete fakeIdToID[fakeId];}\nbreak;case'setTimeout':fakeIdToID[fakeId]=setTimeout(function(){postMessage({fakeId});if(fakeIdToID.hasOwnProperty(fakeId)){delete fakeIdToID[fakeId];}},time);break;case'clearTimeout':if(fakeIdToID.hasOwnProperty(fakeId)){clearTimeout(fakeIdToID[fakeId]);delete fakeIdToID[fakeId];}\nbreak;default:break;}}catch(error){postMessage({error})}})"]),c=window.URL.createObjectURL(a),d={},u=0;function l(){do{2147483647===u?u=0:u++}while(u in d);return u}window.HACK_TIMER_WORKER&&"setIntervalWarp"in window.HACK_TIMER_WORKER&&"setTimeoutWarp"in window.HACK_TIMER_WORKER&&"clearIntervalWarp"in window.HACK_TIMER_WORKER&&"clearTimeoutWarp"in window.HACK_TIMER_WORKER?(o=window.HACK_TIMER_WORKER.setIntervalWarp,r=window.HACK_TIMER_WORKER.setTimeoutWarp,i=window.HACK_TIMER_WORKER.clearIntervalWarp,s=window.HACK_TIMER_WORKER.clearTimeoutWarp):window.Worker?(o=function(e,t){var o=!(arguments.length>2&&arguments[2]!==undefined)||arguments[2];if(!e||"function"!=typeof e)throw new Error("cb must be a function");for(var r=l(),i=arguments.length,s=new Array(i>3?i-3:0),a=3;a<i;a++)s[a-3]=arguments[a];return d[r]={cb:e,param:s,keepAlive:!!o,type:"setInterval"},n.postMessage({action:"setInterval",fakeId:r,time:t}),r},i=function(e){"number"==typeof e&&e in d&&(delete d[e],n.postMessage({action:"clearInterval",fakeId:e}))},r=function(e,t){var o=!(arguments.length>2&&arguments[2]!==undefined)||arguments[2];if(!e||"function"!=typeof e)throw new Error("cb must be a function");for(var r=l(),i=arguments.length,s=new Array(i>3?i-3:0),a=3;a<i;a++)s[a-3]=arguments[a];return d[r]={cb:e,param:s,keepAlive:!!o,type:"setTimeout"},n.postMessage({action:"setTimeout",fakeId:r,time:t}),r},s=function(e){"number"==typeof e&&e in d&&(delete d[e],n.postMessage({action:"clearTimeout",fakeId:e}))},(n=new Worker(c)).addEventListener("message",(function(e){var t=e.data.fakeId;if(t in d){var n=d[t]||{},o=n.cb,r=n.param,i=n.keepAlive;if("setInterval"!==n.type&&delete d[t],!i&&document.hidden)return;if("function"==typeof o)try{o.apply(window,r)}catch(s){}}})),n.addEventListener("error",(function(e){}))):(o=setInterval,r=setTimeout,i=clearInterval,s=clearTimeout);var _={setIntervalWarp:o,setTimeoutWarp:r,clearIntervalWarp:i,clearTimeoutWarp:s};t.Z=_},27769:function(e,t,n){"use strict";n.d(t,{A:function(){return Ge}});var o=n(19049),r=n(95508),i=n(6670),s=n(78034),a=n(15727),c=n(9267),d=n(69071),u=n(29938),l=n(39805),_=n(20710);class p extends _.W{SendMessage(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({send_message_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,content:e.content,mentioned_users:e.mentionedUsers,client_message_id:e.clientId,ticket:e.ticket,message_type:e.messageType,ext:e.ext,ref_msg_info:e.referenceInfo}});return this.sendWithRawBody(t,d.m.IMCMD.SEND_MESSAGE,{inboxType:e.inboxType,maxRetryTimes:this.ctx.option.maxSendMsgRetryTimes})}))}GetMessagesByUser(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({messages_per_user_body:{cursor:e.cursor,limit:e.limit}});try{return yield this.sendWithRawBody(t,d.m.IMCMD.GET_MESSAGES_BY_USER,{inboxType:e.inboxType,maxRetryTimes:1})}catch(n){return l.Y.ctxWarn(this.ctx,`pull user error:${n}, ignore`),d.m.Response.create({body:d.m.ResponseBody.create({messages_per_user_body:d.m.MessagesPerUserResponseBody.create({next_cursor:e.cursor,has_more:!1,messages:[]})})})}}))}GetMessagesByUserInitV2(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({messages_per_user_init_v2_body:{cursor:e.cursor,init_sub_type:e.initSubType,conv_limit:e.convLimit,msg_limit:e.msgLimit,biz_tag_ids:e.tagIds,user_custom_tag_ids:e.userCustomTagIds}});return this.sendWithRawBody(t,d.m.IMCMD.GET_MESSAGES_BY_USER_INIT_V2,{inboxType:e.inboxType,forceHttp:!0,maxRetryTimes:10})}))}GetMessagesByInit(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({message_by_init:{version:e.version,page:e.page,conv_limit:e.convLimit,msg_limit:e.msgLimit}});return this.sendWithRawBody(t,d.m.IMCMD.GET_MESSAGE_BY_INIT,{inboxType:e.inboxType,forceHttp:!0,maxRetryTimes:10})}))}GetMessagesByConversation(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({messages_in_conversation_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,anchor_index:e.anchorIndex,limit:e.limit,direction:e.direction}});return this.sendWithRawBody(t,d.m.IMCMD.GET_MESSAGES_BY_CONVERSATION,{inboxType:e.inboxType,forceHttp:!0})}))}CreateConversationV2(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({create_conversation_v2_body:{conversation_type:e.type,participants:e.participants,persistent:e.persistent,idempotent_id:e.idempotentId,name:e.name,avatar_url:e.avatarUrl,description:e.desc,biz_ext:e.bizExt}});return this.sendWithRawBody(t,d.m.IMCMD.CREATE_CONVERSATION_V2,{inboxType:e.inboxType})}))}GetConversationInfoListV2(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({get_conversation_info_list_v2_body:{conversation_info_list:e.conversations.map((e=>({conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType})))}});return this.sendWithRawBody(t,d.m.IMCMD.GET_CONVERSATION_INFO_LIST_V2,{inboxType:e.inboxType})}))}MarkConversationReadV3(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({mark_conversation_read_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,read_message_index:e.readIndex,conv_unread_count:e.unreadCount,total_unread_count:e.totalUnreadCount,mute_read_badge_count_infos:e.muteReadBadgeCountInfos,read_badge_count:e.readBadgeCount}});return this.send(t,d.m.IMCMD.MARK_CONVERSATION_READ_V3,{inboxType:e.inboxType,maxRetryTimes:1})}))}BatchMarkConversationReadV3(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!e.batch.length)return;const t=d.m.RequestBody.create({batch_mark_read_body:{mark_read_requests:e.batch.map((e=>({conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,read_message_index:e.readIndex,conv_unread_count:e.unreadCount,total_unread_count:e.totalUnreadCount,read_message_index_v2:e.readIndexV2,mute_read_badge_count_infos:e.muteReadBadgeCountInfos,read_badge_count:e.readBadgeCount})))}});return this.send(t,d.m.IMCMD.BATCH_MARK_CONVERSATION_READ_V3,{inboxType:e.batch[0].inboxType,maxRetryTimes:1})}))}RecallMessage(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({recall_message_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,server_message_id:e.serverId}});return this.sendWithRawBody(t,d.m.IMCMD.RECALL_MESSAGE,{inboxType:e.inboxType})}))}GetTicket(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({get_ticket_body:{ticket_type:u.HF.ticketType,conversation_type:e.conversationType,conversation_short_id:e.shortId,to_id:e.toId,ext:e.ext}});return(yield this.send(t,d.m.IMCMD.GET_TICKET,{inboxType:e.inboxType})).get_ticket_body}))}GetConversationParticipantsList(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({conversation_participants_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,cursor:e.cursor,limit:e.limit}});return this.sendWithRawBody(t,d.m.IMCMD.CONVERSATION_PARTICIPANTS_LIST,{inboxType:e.inboxType})}))}GetConversationParticipantByUserId(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({mget_conversation_participants_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType,participants:e.participants}});return this.sendWithRawBody(t,d.m.IMCMD.MGET_CONVERSATION_PARTICIPANTS,{inboxType:e.inboxType})}))}ClientAck(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){try{const t=d.m.RequestBody.create({client_ack_body:{start_time_stamp:e.startTimeStamp,cmd:e.cmd,network_type:e.NetworkType,logid:e.logid,client_time_stamp:e.clientTimeStamp,server_message_id:e.serverId,type:e.type}});yield this.send(t,d.m.IMCMD.CLIENT_ACK,{useBeacon:!0,inboxType:e.inboxType})}catch(t){l.Y.ctxWarn(this.ctx,`send ack error: ${t}, ignore`)}}))}ClientBatchAck(e){var t,n;return(0,a.__awaiter)(this,void 0,void 0,(function*(){try{const o=null===(t=null==e?void 0:e.map)||void 0===t?void 0:t.call(e,(e=>({start_time_stamp:e.startTimeStamp,cmd:e.cmd,network_type:e.NetworkType,logid:e.logid,client_time_stamp:e.clientTimeStamp,server_message_id:e.serverId,type:e.type}))),r=d.m.RequestBody.create({client_batch_ack_body:{ack_list:o}});yield this.send(r,d.m.IMCMD.CLIENT_BATCH_ACK,{useBeacon:!0,inboxType:null===(n=null==e?void 0:e[0])||void 0===n?void 0:n.inboxType})}catch(o){l.Y.ctxWarn(this.ctx,`send batch ack error: ${o}, ignore`)}}))}BatchGetConversationParticipantsReadIndex(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({batch_get_conversation_participants_readindex:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,request_from:e.request_from,min_index_required:e.min_index_required}});return(yield this.send(t,d.m.IMCMD.BATCH_GAT_CONVERSATION_PARTICIPANTS_READINDEX)).batch_get_conversation_participants_readindex}))}GetConversationParticipantsReadIndexV3(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({participants_read_index_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType}});return(yield this.send(t,d.m.IMCMD.GET_CONVERSATION_PARTICIPANTS_READ_INDEX_V3,{inboxType:e.inboxType})).participants_read_index_body}))}GetConversationParticipantsMinIndexV3(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({participants_min_index_body:{conversation_id:e.conversationId,conversation_short_id:e.conversationShortId,conversation_type:e.conversationType}});return(yield this.send(t,d.m.IMCMD.GET_CONVERSATION_PARTICIPANTS_MIN_INDEX_V3,{inboxType:e.inboxType})).participants_min_index_body}))}GetConfigs(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const e=d.m.RequestBody.create();return(yield this.send(e,d.m.IMCMD.GET_CONFIGS)).get_configs_body}))}GetUserMessage(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=d.m.RequestBody.create({get_user_message:{version:e.version,cmd_index:e.cmdIndex,read_version:e.readVersion,source:e.source}});try{return yield this.sendWithRawBody(t,d.m.IMCMD.GET_USER_MESSAGE,{inboxType:e.inboxType,maxRetryTimes:1,forceHttp:!0})}catch(n){return l.Y.ctxWarn(this.ctx,`pull user error:${n}, ignore`),d.m.Response.create({body:d.m.ResponseBody.create({get_user_message:d.m.GetUserMessageResponseBody.create({})})})}}))}}var v=n(63090),g=n(3539);class h{constructor(e,t,n){this.index=e,this.subject=t,this.handler=n}unsubscribe(){this.subject.unsubscribe(this)}}class f extends g.mA{constructor(){super(...arguments),this.subscriptions=new Map,this.idx=0}subscribe(e){const t=this.subscriptions.values();for(const o of t)if(e===o.handler)return l.Y.ctxDebug(this.ctx,"ignore duplicate handler:",e),o;const n=new h(this.idx,this,e);return this.subscriptions.set(this.idx,n),this.idx++,n}nextEmpty(e){for(const n of this.subscriptions.values())if(n&&n.handler)try{n.handler({},e)}catch(t){l.Y.ctxWarn(this.ctx,"error in event handler:",t)}}next(e,t){for(const o of this.subscriptions.values())if(o&&o.handler)try{o.handler(e,t)}catch(n){l.Y.ctxWarn(this.ctx,"error in event handler:",n)}}unsubscribe(e){e&&this.subscriptions.delete(e.index)}unsubscribeAll(){this.subscriptions.clear()}}function y(e,t,n=!1){let o,r,i,s=0;const a=function(){e.apply(r,i),s=Date.now()};return function(){const e=Date.now();if(r=this,i=arguments,o&&(clearTimeout(o),o=null),n&&0===s)return o=setTimeout((()=>{a()}),t),a();const c=t-(e-s);if(c>0)o=setTimeout((()=>{a()}),c);else{if(n)return a();o=setTimeout((()=>{a()}),t)}}}class m extends g.mA{constructor(){super(...arguments),this.subscriptions=new Map}subscribe(e,t){var n;if(!Object.values(u.c5).includes(e))throw new v.G({ctx:this.ctx,type:u.NI.InvalidParam,msg:`unknown event: ${e}`,sender:this});this.subscriptions.has(e)||this.subscriptions.set(e,new f(this.ctx));const o=this.subscriptions.get(e),r="number"==typeof this.ctx.option.throttle?this.ctx.option.throttle:100,i=null!==(n=this.ctx.option.triggerStrategy)&&void 0!==n?n:{};if(!1===this.ctx.option.throttle)return o.subscribe(t);if(i[e]===undefined)return o.subscribe(t);switch(l.Y.ctxDebug(this.ctx,`apply strategy: ${u.zn[i[e]]} to event: ${e}`),i[e]){case u.zn.Throttle:return o.subscribe(function(e,t,n){let o,r;return function(){const i=this,s=+new Date,a=arguments;clearTimeout(o),r||(r=s),s-r>=n?(e.apply(i,a),r=s):o=setTimeout((()=>{e.apply(i,a)}),t)}}(t,r,r));case u.zn.Debounce:return o.subscribe(y(t,r));case u.zn.ThrottleWithArgs:return o.subscribe(function(e,t,n){const o={},r={},i=new Map;let s=0;return function(){const a=this,c=+new Date,d=arguments,u=d[0];let l=i.get(u);i.has(u)||(l=s++,i.set(u,l)),clearTimeout(o[l]),r[l]||(r[l]=c),c-r[l]>=n?(r[l]=c,e.apply(a,d)):o[l]=setTimeout((()=>{e.apply(a,d),delete r[l],delete o[l],i.delete(u)}),t)}}(t,r,r));case u.zn.DebounceWithArgs:return o.subscribe(function(e,t){const n=new Map,o={},r={};let i=0;return function(){const s=Date.now(),a=arguments,c=a[0];let d=n.get(c);n.has(c)||(d=i++,n.set(c,d));const u=()=>{e.apply(this,a),delete r[d],delete o[d],n.delete(c)};r[d]===undefined&&(r[d]=0),o[d]&&(clearTimeout(o[d]),delete o[d]);const l=s-r[d],_=t-l;o[d]=_>0?setTimeout((()=>{u()}),_):setTimeout((()=>{u()}),t)}}(t,r));case u.zn.Immediate:default:return o.subscribe(t)}}unsubscribe(e,t){this.subscriptions.has(e)&&this.subscriptions.get(e).unsubscribe(t)}unsubscribeAll(){for(const e of Object.values(this.subscriptions))e.unsubscribeAll();this.subscriptions.clear()}emitEmpty(e,t){return this.emit(e,t,undefined)}emit(e,t,n){this.resolve(g.Uk.Monitor).emitEvent(e,t,n);const o=this.subscriptions.get(e);o&&(n?l.Y.ctxDebug(this.ctx,`emit event "${e}" with sender:`,t,", eventArgs:",n):l.Y.ctxDebug(this.ctx,`emit event "${e}" with sender:`,t),o.next(n,t))}}var b=n(74110),k=n(67466),O=n(82201),x=n.n(O);function w(e,t,n,o){let r=n=n||0,i=o=o||e.length-n,s=0;for(r=n,i=o;r<i;){const n=e[r++];let o=n>>4;if(o>0){let n=o+240;for(;255===n;)n=e[r++],o+=n;const a=r+o;for(;r<a;)t[s++]=e[r++];if(r===i)return s}const a=e[r++]|e[r++]<<8;if(0===a||a>s)return-(r-2);let c=15&n,d=c+240;for(;255===d;)d=e[r++],c+=d;let u=s-a;const l=s+c+4;for(;s<l;)t[s++]=t[u++]}return s}Math.imul||(Math.imul=function(e,t){const n=65535&e,o=65535&t;return n*o+((e>>>16)*o+n*(t>>>16)<<16)|0});const I=d.m.Request,C=d.m.Response,M=d.m.Frame;function T(e){return"undefined"!=typeof btoa?btoa(String.fromCharCode.apply(null,new Uint8Array(e))):""}function R(e){const t=I.encode(e).finish();return new Uint8Array(t)}function P(e,t){const n=new Uint8Array(t);try{return C.decode(n)}catch(o){const t=T(n);throw l.Y.ctxWarn(e,"decode response error: ",o),l.Y.ctxDebug(e,"hex dump: ",t),t}}var S=n(77166),E=n(56329);class B extends g.mA{constructor(e){super(e),this.wsLastReceiveTime=0,this.reqMap=new Map,this.manuallyClosed=!1;const{webSocketLevel:t,heartbeatInterval:n,maxHeartbeatEmptyWindow:o}=this.ctx.option;this.heartbeatInterval=null!=n?n:u.HF.heartbeatInterval,this.maxEmptyWindow=null!=o?o:u.HF.maxHeartbeatEmptyWindow,this.net=this.ctx.resolve(g.Uk.CoreInstance).net,this.http=this.ctx.resolve(g.Uk.CoreInstance).http,t!==u._.Disable&&(this.ws=this.ctx.resolve(g.Uk.CoreInstance).websocket,this.prepareWs()),this.onMessage=new f(e)}inSignCommandList(e){return[d.m.IMCMD.SEND_MESSAGE,d.m.IMCMD.CREATE_CONVERSATION_V2,d.m.IMCMD.CALL_VOIP,d.m.IMCMD.ADD_CONVERSATION_PARTICIPANTS,d.m.IMCMD.REMOVE_CONVERSATION_PARTICIPANTS,d.m.IMCMD.UPDATE_CONVERSATION_PARTICIPANT,d.m.IMCMD.SET_CONVERSATION_SETTING_INFO,d.m.IMCMD.SET_CONVERSATION_CORE_INFO,d.m.IMCMD.UPSERT_CONVERSATION_CORE_EXT_INFO,d.m.IMCMD.UPSERT_CONVERSATION_SETTING_EXT_INFO,d.m.IMCMD.DISSOLVE_CONVERSATION,d.m.IMCMD.MARK_MESSAGE,d.m.IMCMD.BATCH_UNMARK_MESSAGE,d.m.IMCMD.SET_MESSAGE_PROPERTY,d.m.IMCMD.MODIFY_MESSAGE_EXT].includes(e)}frontierSign(e){const t={"X-MS-STUB":x()(e)};if("undefined"!=typeof window&&"undefined"!=typeof window.byted_acrawler&&"function"==typeof window.byted_acrawler.frontierSign){const e=window.byted_acrawler.frontierSign(t);return null!=e?e:{}}return{}}sendByBeacon(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return e.method="beacon",l.Y.ctxDebug(this.ctx,`Beacon Request SeqId -> ${e.seqId}`,e.request),this.http.sendBeacon(e.url,e.request),e}))}sendByHttp(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){e.method="http",l.Y.ctxDebug(this.ctx,`Http Request SeqId -> ${e.seqId}`,e.request);try{this.reqMap.set(e.seqId,e);const t=yield this.http.sendRequest(e.url,e.request);return e.response=t,0!==t.status_code?l.Y.ctxError(this.ctx,`Http Response SeqId -> ${e.seqId}`,e.response):l.Y.ctxDebug(this.ctx,`Http Response SeqId -> ${e.seqId}`,e.response),e}catch(t){throw new v.G({ctx:this.ctx,msg:"network error",type:u.NI.NetworkError,innerError:t,allowRetry:!0,sender:this,ignoreEvent:!0})}finally{this.reqMap.delete(e.seqId)}}))}sendByWs(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){e.method="ws";const t=R(e.request),n=this.inSignCommandList(e.cmd)?this.frontierSign(t):{},o=Object.assign(Object.assign({},n),this.ctx.option.headers),r=d.m.Frame.create({service:this.ctx.option.service,method:this.ctx.option.method,headers:Object.entries(o).map((([e,t])=>({key:e,value:t}))),seqid:c.fromNumber(e.seqId),logid:c.fromNumber(Date.now()),payload_type:"pb",payload:t});e.frame=r;try{this.reqMap.set(e.seqId,e),l.Y.ctxDebug(this.ctx,`WS Request SeqId -> ${e.seqId}`,e.request),this.ws.send(function(e){const t=M.encode(e).finish();return new Uint8Array(t)}(r))}catch(i){throw this.reqMap.delete(e.seqId),new v.G({ctx:this.ctx,msg:"network error",type:u.NI.NetworkError,innerError:i,allowRetry:!0,sender:this})}return new Promise(((t,n)=>{e.wsPromise={resolve:t,reject:n}}))}))}receiveRaw(e){var t,n,o;if(this.resetWsHeartbeat(),"hi"!==e.toString())try{const i=function(e,t){const n=new Uint8Array(t);try{return M.decode(n)}catch(o){const t=T(n);throw l.Y.ctxWarn(e,"decode frame error: ",o),l.Y.ctxDebug(e,"hex dump: ",t),t}}(this.ctx,e);if(i.service!==this.ctx.option.service&&!this.ctx.option.acceptIncorrectFrame)return l.Y.ctxDebug(this.ctx,`WS Response dropped, local serviceId=${this.ctx.option.service}, message=${i.service}`),void this.resolve(g.Uk.EventBus).emit(u.c5.WebSocketReceiveUnexpectedFrame,this,i);let{payload:s}=i;if(s===undefined||null===s)return void l.Y.ctxWarn(this.ctx,"payload undefined or null");if("__lz4"===i.payload_encoding){let e=new Uint8Array(10*s.length),t=0;if(t=w(s,e),(t<0||t>e.length||t<s.length)&&(l.Y.ctxDebug(this.ctx,"WS response with lz4 compress, but first time decompressed failed, try second time"),e=new Uint8Array(1024e3),t=w(s,e),t<0||t>e.length||t<s.length))return void l.Y.ctxWarn(this.ctx,"WS response with lz4 compress, try second time fail.");s=e.slice(0,t)}try{const e=P(this.ctx,s),r=d.m.Response.create(e);if(!this.resolve(g.Uk.InboxType).isValidInbox(r.inbox_type)&&r.sequence_id.eq(0))return void l.Y.ctxWarn(this.ctx,`WS Push dropped, local inboxType=${this.ctx.option.inboxType}, message=${r.inbox_type}`,"resp:",r);const a=r.sequence_id.toNumber();let c=this.reqMap.get(a);c?(0!==r.status_code?l.Y.ctxError(this.ctx,`WS Response SeqId -> ${r.sequence_id}`,r):l.Y.ctxDebug(this.ctx,`WS Response SeqId -> ${r.sequence_id}`,r),c.response=r,c.wsPromise.resolve(c),this.reqMap.delete(a)):r.sequence_id.eq(0)?(l.Y.ctxDebug(this.ctx,"WS Push",null===(o=null===(n=null===(t=r.body)||void 0===t?void 0:t.has_new_message_notify)||void 0===n?void 0:n.message)||void 0===o?void 0:o.message_type,r),c=new E.F(this.ctx,r.cmd),c.frame=i,c.response=r,c.seqId=r.sequence_id.toNumber(),this.receive(c)):l.Y.ctxWarn(this.ctx,"WS Response dropped, no handler",r)}catch(r){l.Y.ctxWarn(this.ctx,"WS Response dropped, IM Response deserialize fail, hex dump:",r,"frame:",i)}}catch(i){l.Y.ctxWarn(this.ctx,"WS Response dropped, Frame deserialize fail, hex dump: ",i)}}send(e,t){var n,o,r,i,s,c,_,p,h,f;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(t.useBeacon)return yield this.sendByBeacon(e),e.response=d.m.Response.create({}),e;let y=null!==(n=t.maxWsRetryTimes)&&void 0!==n?n:3,m=0===y?null!==(o=t.maxHttpRetryTimes)&&void 0!==o?o:3:(null!==(r=t.maxHttpRetryTimes)&&void 0!==r?r:null===(i=this.ws)||void 0===i?void 0:i.isOpen())?1:3;0===m&&(m=1);S.u.performanceNow()-this.wsLastReceiveTime-1.5*this.heartbeatInterval>this.maxEmptyWindow&&(null===(s=this.ws)||void 0===s?void 0:s.isOpen())&&(y=0,m=null!==(c=t.maxHttpRetryTimes)&&void 0!==c?c:3,l.Y.ctxWarn(this.ctx,"ws idle too long, fallback to http"));let b=0,k=0;const O=()=>{let t=!1;const n=new Promise(((n,o)=>{setTimeout((()=>{t||(this.reqMap.delete(e.seqId),o(new v.G({ctx:this.ctx,msg:"request timeout",type:u.NI.NetworkError,allowRetry:!0,ignoreEvent:!0,sender:this})))}),this.ctx.option.timeout)}));return Promise.race([n,(()=>(0,a.__awaiter)(this,void 0,void 0,(function*(){var n;let o,r=!1;if(b<y&&(null===(n=this.ws)||void 0===n?void 0:n.isOpen())&&(r=!0),0!==y&&b>=y&&0===k&&this.ws!==undefined&&(l.Y.ctxWarn(this.ctx,`Request ${e.seqId} fallback to http (wsRetryTimes)`),r=!1),k>=m)throw new v.G({ctx:this.ctx,msg:"http retry times limit exceeded",type:u.NI.NetworkError,sender:this,args:{cmd:e.cmd,seqId:e.seqId}});r?(b++,o=this.sendByWs(e)):(k++,o=this.sendByHttp(e));try{const n=yield o;t=!0,this.reqMap.delete(e.seqId);const{request:r,response:i}=n;if(this.resolve(g.Uk.Monitor).emitNetwork(r,i),i.status_code===u.NI.ResourceExhausted)throw new v.G({ctx:this.ctx,msg:"demotion enabled",type:u.NI.ResourceExhausted,allowRetry:!1,sender:this,logid:null==i?void 0:i.log_id});if(i.status_code===u.NI.InternalError&&(i.error_desc.includes("i/o timeout")||i.error_desc.includes("rpc timeout")||i.error_desc.includes("RPC timeout"))||i.error_desc.includes("connection timeout")||i.error_desc.includes("request timeout"))throw new v.G({ctx:this.ctx,msg:"request timeout",type:u.NI.NetworkError,allowRetry:!0,ignoreEvent:!0,sender:this,logid:null==i?void 0:i.log_id});return n.retryTimes=b+k,n}catch(i){throw i.type?i:new v.G({ctx:this.ctx,msg:"request error",type:u.NI.NetworkError,allowRetry:i.allowRetry,innerError:i,sender:this})}finally{this.reqMap.delete(e.seqId)}})))()])};let x;for(;;){if(e.retryTimes++,e.retryTimes>=10){e.error=new v.G({ctx:this.ctx,msg:"too much retry",type:u.NI.NetworkError,sender:this});break}try{if(e.startTime=Date.now(),x=yield O(),e.endTime=Date.now(),"function"==typeof(null===(p=null===(_=null==x?void 0:x.response)||void 0===_?void 0:_.server_execution_end_time)||void 0===p?void 0:p.toNumber)&&"function"==typeof(null===(f=null===(h=null==x?void 0:x.response)||void 0===h?void 0:h.request_arrived_time)||void 0===f?void 0:f.toNumber)&&S.u.putTimeDelta(e.startTime,e.endTime,x.response.server_execution_end_time.toNumber(),x.response.request_arrived_time.toNumber()),x!==undefined)break}catch(w){if(e.error=w,!0===(null==w?void 0:w.allowRetry)){let t=500+100*e.retryTimes+100*Math.random();t>2e3&&(t=2e3),l.Y.ctxDebug(this.ctx,`req ${e.seqId} failed, retrying @ attempt ${e.retryTimes}, inner err:`,w),yield new Promise((e=>setTimeout(e,t)));continue}break}}if(x===undefined)throw e.error===undefined&&(e.error=new v.G({ctx:this.ctx,msg:"unknown error",type:u.NI.NetworkError,sender:this})),e.error;return x}))}get isWsOnline(){var e;if(null===(e=this.ws)||void 0===e?void 0:e.isOpen()){const e=S.u.performanceNow()-this.wsLastReceiveTime-1.5*this.heartbeatInterval;return Boolean(e<=this.maxEmptyWindow)}return!1}sendByHttpTo(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return"undefined"!=typeof fetch?(yield fetch(e)).arrayBuffer():this.http.send(e,t,n)}))}receive(e){this.resolve(g.Uk.Monitor).emitNetwork(null,e.response),this.onMessage.next(e.response,this)}onWsClose(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){l.Y.ctxDebug(this.ctx,"ws closed"),this.resolve(g.Uk.EventBus).emit(u.c5.WebSocketDisconnected,this,this.ws)}))}prepareWs(){this.ctx.option.webSocketLevel!==u._.Disable&&(this.ws.onMessage.subscribe((e=>this.receiveRaw(e))),this.ws.onClose.subscribe((()=>this.onWsClose())),this.ws.onError.subscribe((()=>this.onWsClose())),this.ws.onOpen.subscribe((()=>{l.Y.ctxDebug(this.ctx,"ws connected"),this.resolve(g.Uk.EventBus).emit(u.c5.WebSocketConnected,this,this.ws),this.manuallyClosed=!1})),this.wsCheckTicker=this.ctx.resolve(g.Uk.CoreInstance).createTicker(this.ctx,this.heartbeatInterval),this.wsCheckTicker.onTick.subscribe((()=>{var e,t,n,o,r;const i=S.u.performanceNow()-this.wsLastReceiveTime+this.heartbeatInterval/1.5;(null===(e=this.ws)||void 0===e?void 0:e.isOpen())?i>this.maxEmptyWindow?(l.Y.ctxDebug(this.ctx,"not receive any packet in window, ws close connection"),this.resolve(g.Uk.Monitor).emitMetrics(S.U.WebSocketConnectNoHeartbeat,{count:1},{url:null!==(r=null===(o=this.ws)||void 0===o?void 0:o.url)&&void 0!==r?r:"unknown"}),this.connectWs(!0)):i>this.heartbeatInterval&&this.sendWsHeartbeat():(l.Y.ctxDebug(this.ctx,"ws try connect if closed"),this.resolve(g.Uk.Monitor).emitMetrics(S.U.WebSocketConnectAfterClose,{count:1},{url:null!==(n=null===(t=this.ws)||void 0===t?void 0:t.url)&&void 0!==n?n:"unknown"}),this.connectWs(!0))})))}closeWs(e){var t,n;this.ctx.option.webSocketLevel!==u._.Disable&&(null===(t=this.ws)||void 0===t||t.close(),this.manuallyClosed=!e,this.manuallyClosed&&(null===(n=this.wsCheckTicker)||void 0===n||n.stop()))}connectWs(e){var t,n,o;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.ctx.option.webSocketLevel===u._.Disable)return;if(this.manuallyClosed&&e)return void l.Y.ctxDebug(this.ctx,"ignore connect since manually closed");this.closeWs(!0);const r=S.u.performanceNow();try{yield this.ws.performOpen(),this.resolve(g.Uk.Monitor).emitMetrics(S.U.WsConnect,{ws_cost:Math.round(S.u.performanceNow()-r)},{error_code:"0",url:null!==(t=this.ws.option.frontierUrl)&&void 0!==t?t:"unknown"}),this.resetWsHeartbeat(),null===(n=this.wsCheckTicker)||void 0===n||n.start()}catch(i){this.resolve(g.Uk.Monitor).emitMetrics(S.U.WsConnect,{ws_cost:Math.round(S.u.performanceNow()-r)},{error_code:"1",url:null!==(o=this.ws.option.frontierUrl)&&void 0!==o?o:"unknown"})}}))}sendWsHeartbeat(){var e;(null===(e=this.ws)||void 0===e?void 0:e.isOpen())?this.ws.send("hi"):l.Y.ctxWarn(this.ctx,"ws not connect but try to send heartbeat")}resetWsHeartbeat(){this.wsLastReceiveTime=S.u.performanceNow()}}var j=n(28862),A=n(21302),U=n(86384),L=n(57822),N=n(9453);class D extends g.mA{constructor(e){super(e),this.refreshBuffer=[],this.refreshDebounce=y((()=>{this.triggerRefresh()}),1e3,!0),this.conversations=new Map}applyLocal(e){e.forEach((e=>{this.conversations.set(e.id,e)}))}clearAll(){this.conversations.clear()}getWithCreateLocal(e,t,n,o){let r=this.getRaw(e);if(!r){const i=new b.r(this.ctx);i.coreInfo=new U._(i),i.settingInfo=new L.H(i),i.id=e,i.shortId=t,i.type=n,i.isOffline=!0,r=i,o!==undefined?i.coreInfo.inboxType=o:o===undefined&&n===d.m.ConversationType.ONE_TO_ONE_CHAT&&4===e.split(":").length&&(i.coreInfo.inboxType=Number.parseInt(e.split(":")[0],10)),l.Y.ctxDebug(this.ctx,"create local conv:",i),this.upsert(r)}return r}upsert(e){var t;if(e===undefined)throw new v.G({ctx:this.ctx,msg:"upsert undefined conv",type:u.NI.InvalidParam,sender:this});if(!this.resolve(g.Uk.InboxType).isValidInbox(e.inboxType))throw new v.G({ctx:this.ctx,msg:`invalid inbox: ${e.inboxType}`,type:u.NI.InvalidParam,sender:this});let n=this.conversations.get(e.id);if(n&&e.isOffline&&(l.Y.ctxDebug(this.ctx,`local exist, try to use offline upsert, ignore, short id: ${n.shortId} with offline:${e.shortId}`),!n.isOffline))return l.Y.ctxDebug(this.ctx,"local is online, ignore update"),n;if(n){l.Y.ctxDebug(this.ctx,`merge conversation local=${n.version.toString()}:`,n,`new=${e.version.toString()}:`,e);const t=n.coreInfo||new U._(n),o=n.settingInfo||new L.H(n);n=Object.assign(n,e),n.coreInfo=t.mergeCore(e.coreInfo),n.settingInfo=o.mergeSetting(e.settingInfo),n.forceRefreshUnreadCount()}return this.conversations.set(e.id,null!=n?n:e),null===(t=this.resolve(g.Uk.DbProxy))||void 0===t||t.upsertConversation(null!=n?n:e),this.ctx.initResult===u.rb.Succeeded&&(this.resolve(g.Uk.EventBus).emit(u.c5.ConversationUpsert,this,null!=n?n:e),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this)),e}refreshLocalAsync(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const e=this.getConversationArray().filter((e=>e.isOffline));if(0!==e.length)return this.refreshAsync(e)}))}refreshLocal(){const e=this.getConversationArray().filter((e=>e.isOffline));0!==e.length&&this.refresh(e)}triggerRefresh(){if(0===this.refreshBuffer.length)return;l.Y.ctxDebug(this.ctx,"clear refresh buffer:",this.refreshBuffer);const e=[...this.refreshBuffer];this.refreshBuffer=[],this.refreshAsync(e)}refresh(e){var t;const n=(0,N.sS)(e),o=[];if(0===this.refreshBuffer.length)o.push(...n);else{const e={};this.refreshBuffer.forEach((t=>e[t.id]=!0)),n.forEach((t=>{e[t.id]||o.push(t)}))}o.length>0&&this.refreshBuffer.push(...o);const r=null!==(t=this.ctx.option.conversationRefreshCount)&&void 0!==t?t:u.HF.conversationRefreshCount;this.refreshBuffer.length>=r?this.triggerRefresh():this.refreshDebounce()}refreshAsync(e){var t,n,o;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const r=null!==(t=(0,N.sS)(e))&&void 0!==t?t:this.refreshBuffer;if(0===r.length)return[];l.Y.ctxDebug(this.ctx,"refresh conv: ",r);const i=[],s=(0,N.vM)(r,(e=>e.inboxType.toString()));for(const e of Object.keys(s)){const t=(0,N.F3)(s[e],5);for(const r of t)try{const t=yield this.resolve(g.Uk.CoreApi).GetConversationInfoListV2({conversations:r.map((e=>({conversationId:e.id,conversationShortId:c.fromString(e.shortId),conversationType:e.type}))),inboxType:Number.parseInt(e,10)}),o=(null===(n=null==t?void 0:t.body)||void 0===n?void 0:n.get_conversation_info_list_v2_body).conversation_info_list;r.forEach((e=>{0===o.filter((t=>t.conversation_id===e.id)).length&&(l.Y.ctxDebug(this.ctx,"delete local conv, may not exist online: ",e),this.delete(e.id))})),o.forEach((e=>{const n=this.upsert(b.r.fromServerConversation(this.ctx,e,null==t?void 0:t.log_id));i.push(n)}))}catch(a){a&&(null==a?void 0:a.type)===u.NI.InternalError&&(null===(o=null==a?void 0:a.message)||void 0===o?void 0:o.includes("request.MGet empty"))?r.forEach((e=>{l.Y.ctxDebug(this.ctx,"delete local conv, may not exist online: ",e),this.delete(e.id)})):l.Y.ctxError(this.ctx,"unknown refresh error:",a)}}return i}))}get(e){let t=this.getRaw(e);if(t||(t=this.getWithShortIdRaw(e)),!t)throw new v.G({ctx:this.ctx,msg:`conversation ${e} not exist in local`,type:u.NI.ConversationNotExist,sender:this,args:{conversationId:e}});return t}getWithShortIdRaw(e){for(const t of this.conversations.values())if(t.shortId===e)return t;return undefined}getWithOnline(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let o=this.getRaw(e);if(!o||o.isOffline){if(!t||!n)throw new v.G({ctx:this.ctx,type:u.NI.InvalidParam,msg:"no shortId and type provided",sender:this});o=this.getWithCreateLocal(e,t,n)}return yield this.refreshAsync(o),this.get(e)}))}getRaw(e){return this.conversations.get(e)}getConversationArray(e=D.conversationFilter){return Array.from(this.conversations.values()).filter(e).map((e=>({conv:e,rankScore:e.rankScore}))).sort(D.conversationComparator).map((e=>e.conv))}withConversation(e){return t=>t(this.get(e))}delete(e,t=!1){var n;const o=this.getRaw(e);o&&(t||this.getContext().resolve(g.Uk.MessageManager).clearConversation(e),this.conversations.delete(e),null===(n=this.resolve(g.Uk.DbProxy))||void 0===n||n.deleteConversation(o),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this),this.resolve(g.Uk.EventBus).emit(u.c5.ConversationDelete,this,o))}markRead(e,t,n,o){const r=this.get(e);return r.settingInfo.readIndex=t,n&&(r.settingInfo.readBadgeCount=n),(null==o?void 0:o.length)&&r.settingInfo.mergeMuteReadBadgeCountInfos(o),this.upsert(r)}join(e){var t;const n=this.get(e);n&&(n.isMember=!0,null===(t=this.resolve(g.Uk.DbProxy))||void 0===t||t.upsertConversation(n),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this),this.resolve(g.Uk.EventBus).emit(u.c5.ConversationJoin,this,n))}leave(e){var t;const n=this.get(e);n&&(n.isMember=!1,null===(t=this.resolve(g.Uk.DbProxy))||void 0===t||t.upsertConversation(n),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this),this.resolve(g.Uk.EventBus).emit(u.c5.ConversationLeave,this,n))}refreshTicket(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=this.get(e),n=yield this.resolve(g.Uk.CoreApi).GetTicket({conversationType:t.type,shortId:c.fromString(t.shortId),toId:c.fromString(t.type===d.m.ConversationType.ONE_TO_ONE_CHAT?t.toParticipantUserId:t.shortId),inboxType:t.inboxType});t.ticket=null==n?void 0:n.ticket,this.upsert(t),l.Y.ctxDebug(this.ctx,"refresh ticket for conv:",t)}))}static conversationFilter(e){return 0===e.mode&&e.isMember}dispose(){this.clearAll()}}D.conversationComparator=(e,t)=>t.rankScore-e.rankScore;var q,G=n(26919);!function(e){e[e.MarkConversationRead=1]="MarkConversationRead",e[e.DeleteMessage=2]="DeleteMessage",e[e.DeleteConversation=3]="DeleteConversation",e[e.SettingInfoUpdate=4]="SettingInfoUpdate",e[e.CoreInfoUpdate=6]="CoreInfoUpdate",e[e.ParticipantUpdate=7]="ParticipantUpdate",e[e.FirstMessage=8]="FirstMessage",e[e.NewMarkConversationRead=14]="NewMarkConversationRead"}(q||(q={}));class V extends k.v{static fromMessage(e){const t=e;return t.contentObj=G.parse(e.content),t.commandSubType=t.contentObj.command_type,t}}var F,Y,H,W=n(65066),$=n(66145);class K extends W.f{process(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return e.data.isCommandMsg&&(e.needContinue=!1,yield this.parseCommand(e.data)),e}))}parseCommand(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=V.fromMessage(e);switch(t.contentObj.command_type){case q.DeleteConversation:this.handleDeleteConversationCMD(t);break;case q.DeleteMessage:this.handleDeleteMessageCMD(t);break;case q.MarkConversationRead:case q.NewMarkConversationRead:this.handleMarkConversationRead(t);break;case q.SettingInfoUpdate:yield this.handleUpdateSettingInfo(t);break;case q.CoreInfoUpdate:yield this.handleUpdateCoreInfo(t);break;case q.ParticipantUpdate:yield this.handleUpdateParticipant(t)}this.resolve(g.Uk.EventBus).emit(u.c5.ReceiveCommandMessage,this,t)}))}handleDeleteConversationCMD(e){const{conversation_id:t}=e.contentObj;this.resolve(g.Uk.ConversationManager).delete(t)}handleDeleteMessageCMD(e){const{conversation_id:t,message_id:n}=e.contentObj;this.resolve(g.Uk.MessageManager).delete(t,n.toString())}handleMarkConversationRead(e){var t;if(this.ctx.initResult===u.rb.Succeeded){const{conversation_id:n,read_index:o,read_badge_count:r,mute_read_badge_count_info:i}=e.contentObj;this.resolve(g.Uk.ConversationManager).markRead(n,c.fromValue(o),r,null!==(t=null==i?void 0:i.map((e=>({message_type:e.type,read_badge_count:e.read_badge_count}))))&&void 0!==t?t:[])}}handleUpdateSettingInfo(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.ctx.initResult===u.rb.Succeeded){const{conversation_version:t}=e.contentObj,n=c.fromValue(null!=t?t:c.MAX_VALUE),o=this.resolve(g.Uk.ConversationManager).getWithCreateLocal(e.conversationId,e.conversationShortId.toString(),e.conversationType);o.settingInfo.version.lte(n)?this.resolve(g.Uk.ConversationManager).refresh(o):l.Y.ctxWarn(this.ctx,"ignore online update setting info cmd, local version: ",o.settingInfo.version.toString(),"online: ",n.toString())}}))}handleUpdateCoreInfo(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.ctx.initResult===u.rb.Succeeded){const{group_version:t}=e.contentObj,n=c.fromValue(t),o=this.resolve(g.Uk.ConversationManager).getWithCreateLocal(e.conversationId,e.conversationShortId.toString(),e.conversationType);o.coreInfo.version.lte(n)?this.resolve(g.Uk.ConversationManager).refresh(o):l.Y.ctxWarn(this.ctx,"ignore online update core info cmd, local version: ",o.coreInfo.version.toString(),"online: ",t.toString())}}))}handleUpdateParticipant(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.ctx.initResult===u.rb.Succeeded){const{added_participant:t,modified_participant:n,removed_participant:o}=e.contentObj;if((null==t?void 0:t.length)>0){const n=t.map(String),o=[];n.forEach((t=>{const n=$.Q.fakeParticipant(this.ctx,t,{type:e.conversationType,id:e.conversationId});o.push(n)})),n.includes(this.ctx.option.userId)&&this.resolve(g.Uk.ConversationManager).join(e.conversationId),this.resolve(g.Uk.ParticipantManager).upsertBatch(e.conversationId,o)}if((null==n?void 0:n.length)>0){const t=this.resolve(g.Uk.ConversationManager).get(e.conversationId),o=n.map(String);this.resolve(g.Uk.ParticipantManager).updateWithUserIdAsync(t,o)}if((null==o?void 0:o.length)>0){const t=o.map(String);t.includes(this.ctx.option.userId)&&this.resolve(g.Uk.ConversationManager).leave(e.conversationId),this.resolve(g.Uk.ParticipantManager).delete(e.conversationId,t)}}}))}}class z extends W.f{process(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=e.data.conversationId;if(!t)return l.Y.ctxWarn(this.ctx,"no conversation provided in message, ignore",e.data),e.needContinue=!1,e;const n=this.resolve(g.Uk.ConversationManager).getRaw(t);if(e.data.type===d.m.MessageType.MESSAGE_TYPE_CONVERSATION_DESTROY&&n)return this.resolve(g.Uk.ConversationManager).delete(t),this.resolve(g.Uk.EventBus).emit(u.c5.ConversationDissolve,this,n),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this),e.needContinue=!1,e;if(!e.data.isNormalMsg&&n===undefined)return e.needContinue=!1,this.ctx.initResult===u.rb.Succeeded&&l.Y.ctxDebug(this.ctx,`ignore process, conv: ${e.data.conversationId} not exist for cmd msg`,e.data),e;const o=e.data,r=this.resolve(g.Uk.ConversationManager).getWithCreateLocal(o.conversationId,o.conversationShortId,o.conversationType);return e.conv=r,e}))}}class Z extends W.f{process(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!e.data.isNormalMsg)return e;const n=this.resolve(g.Uk.MessageManager).getRaw(null===(t=e.conv)||void 0===t?void 0:t.id,e.data.clientId),o=e.data.source!==undefined&&(e.data.source===u.v$.Online||e.data.source===u.v$.UserInbox),r=(null==n?void 0:n.flightStatus)!==undefined&&o;this.resolve(g.Uk.MessageManager).upsert(e.data);const i=this.resolve(g.Uk.MessageManager).getRaw(e.data.conversationId,e.data.clientId);return n?r&&i.flightStatus!==u.b3.Received&&(i.flightStatus=u.b3.Received,this.ctx.initResult===u.rb.Succeeded&&this.resolve(g.Uk.EventBus).emit(u.c5.ReceiveSelfMessage,this,i),this.resolve(g.Uk.MessageManager).upsert(i)):o&&!e.data.isStrangerMessage&&(e.data.sender!==this.ctx.option.userId?this.ctx.initResult===u.rb.Succeeded&&this.resolve(g.Uk.EventBus).emit(u.c5.ReceiveNewMessage,this,i):this.ctx.initResult===u.rb.Succeeded&&this.resolve(g.Uk.EventBus).emit(u.c5.ReceiveSelfMessage,this,i)),e}))}}class X extends W.f{process(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return e.data.type===d.m.MessageType.MESSAGE_TYPE_UPDATE_MESSAGE_EXT&&(e.needContinue=!1,this.handleUpdateExt(e)),e}))}handleUpdateExt(e){var t,n,o,r,i,s,a;const c=null===(t=e.data)||void 0===t?void 0:t.ext[u.v9.ServerMessageId];if(!c)throw new v.G({ctx:this.ctx,type:u.NI.InvalidServerId,msg:`message ${e.data} has no s:server_message_id`,sender:this});const _=this.resolve(g.Uk.MessageManager).getByServerIdRaw(null===(n=e.conv)||void 0===n?void 0:n.id,c);if(_)if(_.version.gt(e.data.version))l.Y.ctxWarn(this.ctx,`local msg version: ${_.version.toString()} > online msg version: ${e.data.version.toString()}, ignore, local msg:`,_,"online msg:",e.data);else{if(_.ext=e.data.ext,_.version=e.data.version,e.data.content&&(_.content=e.data.content),this.resolve(g.Uk.MessageManager).upsert(_),!_.visible){const t=this.resolve(g.Uk.MessageManager).getList(e.conv.id);for(const e of t)(null===(r=null===(o=e.referenceInfo)||void 0===o?void 0:o.referenced_message_id)||void 0===r?void 0:r.toString())===_.serverId&&(e.referenceInfo.referenced_message_status=d.m.MessageStatus.INVISIBLE,this.resolve(g.Uk.MessageManager).upsert(e))}if(_.isEdited){const t=this.resolve(g.Uk.MessageManager).getList(e.conv.id);for(const e of t)(null===(s=null===(i=e.referenceInfo)||void 0===i?void 0:i.referenced_message_id)||void 0===s?void 0:s.toString())===_.serverId&&(e.referenceInfo=Object.assign(Object.assign({},e.referenceInfo),{ext:Object.assign(Object.assign({},null!==(a=e.referenceInfo.ext)&&void 0!==a?a:{}),{[u.v9.RefIsEdited]:"true",[u.v9.RefContent]:_.content})}),this.resolve(g.Uk.MessageManager).upsert(e))}this.resolve(g.Uk.EventBus).emit(u.c5.ReceiveNewUpdateExtMessage,this,e.data),"true"===e.data.ext[u.v9.IsRecalled]&&this.resolve(g.Uk.MessageManager).markRecalled(e.conv.id,_.serverId)}}}class J extends g.mA{constructor(e){super(e),this.messages=new Map,this.processors=[new z(this.ctx),new K(this.ctx),new X(this.ctx),new Z(this.ctx)]}applyLocal(e){e.forEach((e=>{this.messages.has(e.conversationId)||this.messages.set(e.conversationId,new Map);this.messages.get(e.conversationId).set(e.clientId,e)}))}clearAll(){this.messages.clear()}get(e,t){const n=this.getRaw(e,t);if(!n)throw new v.G({ctx:this.ctx,type:u.NI.MessageNotExist,msg:`message ${t} @ ${e} not exist in local`,sender:this});return n}getRaw(e,t){return this.getConversationMap(e).get(t)}getRawMap(){return this.messages}getByServerIdRaw(e,t){const n=this.getConversationMap(e),o=Array.from(n.values()).filter((e=>e.serverId===t));return 0===o.length?undefined:this.get(e,o[0].clientId)}getByServerId(e,t){const n=this.getConversationMap(e),o=Array.from(n.values()).filter((e=>e.serverId===t));if(0===o.length)throw new v.G({ctx:this.ctx,type:u.NI.MessageNotExist,msg:`message ${t} @ ${e} not exist in local`,sender:this});return this.get(e,o[0].clientId)}getList(e){const t=this.getConversationMap(e);return Array.from(t.values()).sort(J.messageComparator)}upsert(e){var t;if(e.isSpecialMessage)return void l.Y.ctxWarn(this.ctx,"unexpected special message to upsert:",e);if(!e.clientId)return void l.Y.ctxDebug(this.ctx,"not found message clientId:",e);const n=this.getConversationMap(e.conversationId);if(this.ctx.option.maxMessageCount){const e=Math.max(200,Math.min(this.ctx.option.maxMessageCount,2e3));if(n.size>=e){let t=~~(e/5);for(const e of n.keys()){if(t<=0)break;n.delete(e),t--}}}const o=n.get(e.clientId);if(o&&o.type===e.type){["referenceInfo"].forEach((t=>{e[t]===undefined&&delete o[t]})),e=o.merge(e)}else o&&o.type!==e.type&&l.Y.ctxWarn(this.ctx,"try to merge different msg:",o,e);if(n.set(e.clientId,e),null===(t=this.resolve(g.Uk.DbProxy))||void 0===t||t.upsertMessage(e),this.resolve(g.Uk.EventBus).emit(u.c5.MessageUpsert,this,e),this.ctx.initResult===u.rb.Succeeded){this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this);const t=this.getContext().resolve(g.Uk.ConversationManager).getRaw(e.conversationId);this.resolve(g.Uk.EventBus).emit(u.c5.ConversationUpsert,this,t),o!==undefined&&(null==t||t.forceRefreshUnreadCount())}}getConversationMap(e){let t=this.messages.get(e);return t||(t=new Map,this.messages.set(e,t)),t}processNewMessage(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(e.ext||(e.ext={}),e.source=t,e.type>=0)return this.processMessage(e);throw new v.G({ctx:this.ctx,type:u.NI.UnknownMessageType,msg:`unknown message type: ${e.type} for msg:${e.clientId}`,sender:this})}))}processNewMessagesFromPull(e,t,n){var o;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const r=e.map((e=>k.v.fromServerMessage(this.ctx,e,n))),i=new Map;for(const e of r){e.ext||(e.ext={});const n=null===(o=i.get(e.conversationShortId))||void 0===o?void 0:o.indexInConversation;n&&!e.indexInConversation.lt(n)||i.set(e.conversationShortId,e),yield this.processNewMessage(e,t)}return{msgs:r,conMap:i}}))}delete(e,t){var n,o,r;const i=this.getConversationMap(e),s=Array.from(i.values()).filter((e=>e.serverId===t));if(0===s.length)return void l.Y.ctxDebug(this.ctx,`delete not exist msg: ${e}::${t}`);i.delete(s[0].clientId),null===(n=this.resolve(g.Uk.DbProxy))||void 0===n||n.deleteMessage(s[0]);const a=this.getList(e);for(const c of a)(null===(r=null===(o=c.referenceInfo)||void 0===o?void 0:o.referenced_message_id)||void 0===r?void 0:r.toString())===t&&(c.referenceInfo.referenced_message_status=d.m.MessageStatus.DELETED,this.upsert(c));this.getContext().resolve(g.Uk.ConversationManager).get(e),this.resolve(g.Uk.EventBus).emit(u.c5.MessageUpsert,this,s[0]),this.resolve(g.Uk.EventBus).emit(u.c5.MessageDelete,this,s[0])}markRecalled(e,t,n){var o,r;const i=this.getByServerId(e,t);i.ext||(i.ext={}),i.ext[u.v9.IsRecalled]="true",n&&this.ctx.option.debug&&(i.ext[u.v9.LocalLogId]=n),this.upsert(i);const s=this.getList(e);for(const a of s)(null===(r=null===(o=a.referenceInfo)||void 0===o?void 0:o.referenced_message_id)||void 0===r?void 0:r.toString())===t&&(a.referenceInfo.referenced_message_status=d.m.MessageStatus.RECALLED,this.upsert(a));this.getContext().resolve(g.Uk.ConversationManager).get(e),this.resolve(g.Uk.EventBus).emit(u.c5.MessageRecall,this,i)}clearConversation(e){var t;const n=this.getContext().resolve(g.Uk.ConversationManager).get(e);this.messages.set(e,new Map),null===(t=this.resolve(g.Uk.DbProxy))||void 0===t||t.clearConversation(n),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this),this.resolve(g.Uk.EventBus).emit(u.c5.ConversationUpsert,this,n)}injectProcessorBefore(e){this.processors.unshift(e)}injectProcessor(e){this.processors.push(e)}processMessage(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let t={needContinue:!0,data:e};for(const e of this.processors)if(t=yield e.process(t),!t.needContinue)break;return t.data}))}dispose(){this.messages.clear(),this.processors=[]}}J.messageComparator=(e,t)=>e.orderInConversation.gt(t.orderInConversation)?1:-1;class Q extends g.mA{constructor(e){super(e),this.participants=new Map}applyLocal(e){e.forEach((e=>{this.participants.has(e.conversationId)||this.participants.set(e.conversationId,new Map);this.participants.get(e.conversationId).set(e.userId.toString(),e)}))}clearAll(){this.participants.clear()}updateWithUserIdAsync(e,t){var n,o,r,i;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const s=t.map((e=>c.fromValue(e))),a=yield this.resolve(g.Uk.CoreApi).GetConversationParticipantByUserId({conversationId:e.id,conversationShortId:c.fromString(e.shortId),conversationType:e.type,inboxType:e.inboxType,participants:s}),d=null!==(i=null===(r=null===(o=null===(n=null==a?void 0:a.body)||void 0===n?void 0:n.mget_conversation_participants_body)||void 0===o?void 0:o.participants)||void 0===r?void 0:r.map((t=>$.Q.fromServerParticipant(this.ctx,t,e,a.log_id))))&&void 0!==i?i:[];this.upsertBatch(e.id,d)}))}upsert(e,t,n=!1){var o;let r=this.participants.get(e.toString());r||(r=new Map);let i=t;return i.userId=i.userId.toString(),r.has(t.userId.toString())&&(i=$.Q.featLocalParticipant(r.get(t.userId.toString()),i)),r.set(t.userId.toString(),i),this.participants.set(e,r),n||(this.resolve(g.Uk.EventBus).emit(u.c5.ParticipantUpsert,this,i),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ParticipantChange,this)),null===(o=this.resolve(g.Uk.DbProxy))||void 0===o||o.upsertParticipant(i),Array.from(r.values())}upsertBatch(e,t,n=!1){return t.forEach((t=>this.upsert(e,t,n))),this.get(e)}delete(e,t){const n=this.participants.get(e);n&&t.forEach((e=>{var t;const o=n.get(e.toString());o!==undefined&&(n.delete(e.toString()),this.resolve(g.Uk.EventBus).emit(u.c5.ParticipantLeave,this,o),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ParticipantChange,this),null===(t=this.resolve(g.Uk.DbProxy))||void 0===t||t.deleteParticipant(o))}))}get(e){const t=this.participants.get(e);if(t)return Array.from(t.values());{const t=this.resolve(g.Uk.ConversationManager).get(e);return this.getParticipants(t)}}getParticipants(e){var t,n,o;const r=[],i=this.getRaw(e.id);if((null==i?void 0:i.length)>0)return i;if(Number(null===(n=null===(t=null==e?void 0:e.firstPageParticipant)||void 0===t?void 0:t.participants)||void 0===n?void 0:n.length)>0)((null===(o=null==e?void 0:e.firstPageParticipant)||void 0===o?void 0:o.participants)||[]).forEach((t=>{r.push($.Q.fromServerParticipant(this.ctx,t,e,e.ext[u.v9.LocalLogId]))}));else if(e.type===d.m.ConversationType.ONE_TO_ONE_CHAT){l.Y.ctxDebug(this.ctx,"no first page participant found, fallback to local");[e.toParticipantUserId,this.ctx.option.userId].forEach((t=>{if(t){const n=$.Q.fakeParticipant(this.ctx,t,e);r.push(n)}}))}return this.upsertBatch(e.id,r,!0),this.resolve(g.Uk.EventBus).emit(u.c5.InitParticipant,this,e),r}getMap(e){const t=this.participants.get(e);if(t)return t;throw new v.G({ctx:this.ctx,type:u.NI.ConversationNotExist,msg:`conversation ${e} participants is not loaded`,sender:this,args:{conversationId:e}})}getMapRaw(e){return this.participants.get(e)}getRaw(e){const t=this.participants.get(e);return t?Array.from(t.values()):[]}getByUserIdRaw(e,t){const n=this.participants.get(e);return n?n.get(t.toString()):undefined}dispose(){this.clearAll()}}class ee extends g.mA{isValidInbox(e){return e!==undefined&&(!!this.getContext().option.acceptIncorrectInboxType||this.getInboxTypeArray().includes(e))}needSpecifyInbox(){const e=this.ctx.option.inboxType;return!(e===undefined||"number"==typeof e&&e>=0)&&!!(Array.isArray(e)&&e.length>2)}getDefaultInboxWithoutCheck(){return this.getInboxTypeArray()[0]}getDefaultInbox(){if(this.needSpecifyInbox())throw new v.G({ctx:this.ctx,msg:"no available inboxType is provided",type:u.NI.InvalidInboxType,sender:this});return this.getDefaultInboxWithoutCheck()}getInboxTypeArray(){const e=this.ctx.option.inboxType;return Array.isArray(e)?e:e!==undefined?[e]:[0]}}!function(e){e[e.Unknown=0]="Unknown",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected"}(F||(F={})),function(e){e[e.Unknown=0]="Unknown",e[e.Cellular_2G=1]="Cellular_2G",e[e.Cellular_3G=2]="Cellular_3G",e[e.Cellular_4G=3]="Cellular_4G",e[e.Cellular_5G=4]="Cellular_5G",e[e.Wifi=5]="Wifi",e[e.Other=6]="Other",e[e.None=7]="None"}(Y||(Y={}));class te extends g.mA{}!function(e){e.SdkVersion="sdk.version",e.DbVersion="sdk.db.version",e.DbLastOpen="sdk.db.last_open",e.DbEncyption="sdk.db.encryption",e.UserToken="user.token",e.ConversationCheckTime="sdk.db.conversation.check.time",e.ConversationMsgCheckTime="sdk.db.conversation.msg.check.time"}(H||(H={}));class ne extends g.mA{constructor(e){super(e)}prepareToken(){var e,t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=yield null===(e=this.resolve(g.Uk.DbProxy))||void 0===e?void 0:e.loadConfig(H.UserToken);if(n)if(this.isCertAuth){!1===(yield null===(t=this.resolve(g.Uk.SecurityProxy))||void 0===t?void 0:t.getCert())?yield this.refreshToken():this.ctx.cachedToken=n}else this.ctx.cachedToken=n;else yield this.refreshToken()}))}refreshToken(){var e,t,n;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{token:o,authType:r}=this.ctx.option;if(r===d.m.AuthType.PASSPORT_CERT_AUTH){let t="";try{t=(yield null===(e=this.resolve(g.Uk.SecurityProxy))||void 0===e?void 0:e.getTicket())||"",this.ctx.cachedToken=t}catch(i){throw new v.G({ctx:this.ctx,msg:"failed to get ticket",type:u.NI.TokenFuncError,sender:this})}return t}if("function"==typeof o){const e=S.u.performanceNow();let n,i=null;if(r===d.m.AuthType.CERT_AUTH?i=yield this.handleCertAuthToken(o):(n=o(),i=n instanceof Promise?yield n:n),null!==i)return this.ctx.cachedToken=i,yield null===(t=this.resolve(g.Uk.DbProxy))||void 0===t?void 0:t.saveConfig(H.UserToken,i),this.resolve(g.Uk.Monitor).emitDuration(S.U.BizRefreshToken,e),l.Y.ctxDebug(this.ctx,"token cached from function: ",this.ctx.cachedToken),i;throw new v.G({ctx:this.ctx,msg:"token is null",type:u.NI.TokenFuncError,sender:this})}return this.ctx.cachedToken=o,l.Y.ctxDebug(this.ctx,"token cached from const: ",this.ctx.cachedToken),yield null===(n=this.resolve(g.Uk.DbProxy))||void 0===n?void 0:n.saveConfig(H.UserToken,this.ctx.cachedToken),o}))}handleCertAuthToken(e){var t,n;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const o=yield null===(t=this.resolve(g.Uk.SecurityProxy))||void 0===t?void 0:t.getCertSignRequest(),{tsSign:r,token:i,sdkCert:s}=yield e(o),a={ts_sign:r,ticket:i,client_cert:s};return null===(n=this.resolve(g.Uk.SecurityProxy))||void 0===n||n.setSignValue(a),i}))}get isCertAuth(){return this.ctx.option.authType&&[d.m.AuthType.CERT_AUTH,d.m.AuthType.PASSPORT_CERT_AUTH].includes(this.ctx.option.authType)}}function oe(e,t){return e.gt(t)?e:t}function re(e,t){return e.lt(t)?e:t}function ie(e,t,n){var o,r;const i=re(t.readIndex,null!==(o=t.readOrder)&&void 0!==o?o:t.readIndex),s=oe(n.readIndex,null!==(r=n.readOrder)&&void 0!==r?r:n.readIndex);return e.getMessageList().filter((e=>e.indexInConversation.gte(i)&&e.indexInConversation.lte(s)))}function se(e,t){const n=[],o=ae(e.minIndex,t.minIndex),r=ae(e.readIndex,t.readIndex);return o!==undefined&&n.push(o),r!==undefined&&n.push(r),n}function ae(e,t){if(e.neq(t)){return{minIndex:re(e,t),readIndex:oe(e,t)}}}var ce=n(17390),de=n(30048);class ue extends de.v{constructor(){super(...arguments),this.innerCursor=[]}get coreApi(){return this.resolve(g.Uk.CoreApi)}get inboxType(){return this.resolve(g.Uk.InboxType)}get instance(){return this.resolve(g.Uk.CoreInstance)}getUserCursor(e){var t;return null!==(t=this.innerCursor[null!=e?e:this.inboxType.getDefaultInbox()])&&void 0!==t?t:c.ZERO}setUserCursor(e,t){var n;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const o=null!=t?t:this.inboxType.getDefaultInbox(),r=this.innerCursor[o];r&&!r.lt(e)||(l.Y.ctxDebug(this.ctx,`update cursor for inbox:${o} from ${null==r?void 0:r.toString()} to ${e.toString()}`),this.innerCursor[o]=e,yield null===(n=this.resolve(g.Uk.DbProxy))||void 0===n?void 0:n.saveUserCursor(o,e))}))}getMessagesByUserInit(e={}){var t,n,o,r,i,s,d,_,p,h;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const a=null!==(t=e.inboxType)&&void 0!==t?t:this.inboxType.getDefaultInbox(),f=null!==(n=e.cursor)&&void 0!==n?n:c.ZERO,y=e.page;if(!this.inboxType.isValidInbox(a))throw new v.G({ctx:this.ctx,msg:"invalid inbox",type:u.NI.InvalidInboxType,sender:this});let m,b,k,O,x,w=c.ZERO,I=c.ZERO;if(e.mode===u.k5.AwemeMode){const t=yield this.coreApi.GetMessagesByInit({inboxType:a,convLimit:e.convLimit,msgLimit:e.msgLimit,page:y,version:e.version}),n=null===(o=t.body)||void 0===o?void 0:o.message_by_init;m=null===(r=n.messages)||void 0===r?void 0:r.map((e=>e.conversations)),b=[],null===(i=n.messages)||void 0===i||i.forEach((e=>e.messages&&(null==b?void 0:b.push(...e.messages)))),k=null==n?void 0:n.user_cursor,O=n.has_more,I=n.next_init_version,x=t.log_id}else{const t=yield this.coreApi.GetMessagesByUserInitV2({cursor:c.fromValue(f),inboxType:a,initSubType:e.initSubType,convLimit:e.convLimit,msgLimit:e.msgLimit,tagIds:null===(s=e.tagIds)||void 0===s?void 0:s.map((e=>c.fromValue(e))),userCustomTagIds:null===(d=e.userCustomTagIds)||void 0===d?void 0:d.map((e=>c.fromValue(e)))}),n=null===(_=t.body)||void 0===_?void 0:_.messages_per_user_init_v2_body;m=n.conversations,b=n.messages,k=null==n?void 0:n.per_user_cursor,O=n.has_more,w=n.next_cursor,x=t.log_id}return this.instance.processInitConversation(m,x),yield this.instance.processInitMessage(b,x),this.getUserCursor(a).neq(c.ZERO)&&(null==k?void 0:k.neq(c.ZERO))&&(null===(p=this.getUserCursor(a))||void 0===p?void 0:p.neq(k))&&(l.Y.ctxWarn(this.ctx,`cursor not match: before:${null===(h=this.getUserCursor(a))||void 0===h?void 0:h.toString()}, after:${null==k?void 0:k.toString()}, pull user, logid:${x}`),yield this.getMessagesByUser({inboxType:a})),k&&(yield this.setUserCursor(k,a)),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.InitLoadPage,this),{hasMore:O,cursor:w,page:(null!=y?y:0)+1,version:I}}))}getMessagesByUser(e={}){var t,n,o,r,i;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(e.cursor instanceof Date&&(e.cursor=`${e.cursor.getTime()}000`),e.inboxType===undefined&&(e.inboxType=this.inboxType.getDefaultInbox()),!this.inboxType.isValidInbox(e.inboxType))throw new v.G({ctx:this.ctx,msg:"invalid inbox",type:u.NI.InvalidInboxType,sender:this});if(!0===this.ctx.option.disableInitPull&&0===this.instance.getConversationList().length&&this.getUserCursor(e.inboxType).eq(c.ZERO)&&e.cursor===undefined)return void l.Y.ctxWarn(this.ctx,"try to pull history from 0, preventing");let s=!0,a=e.cursor!==undefined?c.fromValue(e.cursor):this.getUserCursor(e.inboxType);for(;s;){const c=yield this.coreApi.GetMessagesByUser({cursor:a,limit:null!==(t=e.limit)&&void 0!==t?t:50,inboxType:e.inboxType}),d=null===(n=c.body)||void 0===n?void 0:n.messages_per_user_body;s=d.has_more,a=d.next_cursor;const _=new Map;null===(o=d.hasmore_message_conv_list)||void 0===o||o.forEach((e=>{const t=e.toString(),n=this.resolve(g.Uk.ConversationManager).getWithShortIdRaw(t);_.set(t,null==n?void 0:n.lastMessageIndex)}));const{conMap:p}=yield this.resolve(g.Uk.MessageManager).processNewMessagesFromPull(d.messages,u.v$.UserInbox,c.log_id);null===(r=d.hasmore_message_conv_list)||void 0===r||r.forEach((e=>{const t=e.toString(),n=p.get(t);if(n){const e=this.resolve(g.Uk.ConversationManager).getRaw(n.conversationId);this.patchMessage({cursor:n,conversation:e,limitindex:_.get(t)})}else l.Y.ctxWarn(this.ctx,`not found message of conversation in hasmore_message_conv_list, conversationid:${t}, logid:${c.log_id}`)})),null===(i=d.conversation_badge_count)||void 0===i||i.map((e=>{const t=this.resolve(g.Uk.ConversationManager).getRaw(e.conversation_id.toString());t&&this.instance.handleBadgeCount(e,t)})),this.instance.initResult===u.rb.Start&&this.resolve(g.Uk.EventBus).emitEmpty(u.c5.InitLoadPage,this)}yield this.setUserCursor(a,e.inboxType),this.resolve(g.Uk.ConversationManager).refreshLocal()}))}prepareHistoryForInbox({inboxType:e,convLimit:t,msgLimit:n,mode:o,convTotal:r,tagIds:i,userCustomTagIds:s}){var d,_,p;return(0,a.__awaiter)(this,void 0,void 0,(function*(){try{const a=yield null===(d=this.resolve(g.Uk.DbProxy))||void 0===d?void 0:d.loadUserCursor(e);if(a!==undefined)return l.Y.ctxDebug(this.ctx,`load history for inbox ${e} by db`),yield this.setUserCursor(a,e),yield this.getMessagesByUser({inboxType:e,cursor:a}),!0;if(this.ctx.option.disableInitPull){let r;if(l.Y.ctxDebug(this.ctx,`load history for inbox ${e} by disable init`),o===u.k5.AwemeMode){const o=yield this.coreApi.GetMessagesByInit({inboxType:e,convLimit:t,msgLimit:n});r=(null===(_=o.body)||void 0===_?void 0:_.message_by_init).user_cursor}else{const o=yield this.coreApi.GetMessagesByUserInitV2({inboxType:e,convLimit:t,msgLimit:n,cursor:c.ZERO});r=(null===(p=o.body)||void 0===p?void 0:p.messages_per_user_init_v2_body).per_user_cursor}return yield this.setUserCursor(r,e),!0}l.Y.ctxDebug(this.ctx,`load history for inbox ${e} by full init`);let v={hasMore:!0,cursor:c.ZERO,page:0,version:undefined};for(;v.hasMore&&(v=yield this.getMessagesByUserInit(Object.assign({inboxType:e,initSubType:this.ctx.option.initSubType,convLimit:t,msgLimit:n,mode:o,tagIds:i,userCustomTagIds:s},v)),!(r&&this.resolve(g.Uk.ConversationManager).getConversationArray().length>=r)););return!0}catch(a){return l.Y.ctxError(this.ctx,`load history failed for inbox:${e}`,a),!1}}))}patchMessage(e){var t,n;return(0,a.__awaiter)(this,void 0,void 0,(function*(){let{cursor:o}=e;if(!e.limitindex)return;o instanceof k.v&&(o=o.indexInConversation),o===undefined&&(o=e.conversation.firstMessageIndex);const r=yield this.coreApi.GetMessagesByConversation({conversationId:e.conversation.id,conversationShortId:c.fromString(e.conversation.shortId),conversationType:e.conversation.type,anchorIndex:c.fromValue(o),direction:d.m.MessageDirection.OLDER,limit:null!==(t=e.limit)&&void 0!==t?t:20,inboxType:e.conversation.inboxType});this.resolve(g.Uk.Monitor).emitMetrics(S.U.GetMessagesByConversation,{count:1},{log_id:r.log_id,from:"patch",conversationId:e.conversation.shortId,cursor:c.fromValue(o).toString()});const i=null===(n=r.body)||void 0===n?void 0:n.messages_in_conversation_body,{conMap:s}=yield this.resolve(g.Uk.MessageManager).processNewMessagesFromPull(i.messages,u.v$.UserInbox,r.log_id),a=s.get(e.conversation.shortId);(null==i?void 0:i.has_more)&&a&&!e.limitindex.gt((null==a?void 0:a.indexInConversation)||c.ZERO)?this.patchMessage({conversation:e.conversation,limit:e.limit||20,cursor:null==i?void 0:i.next_cursor,limitindex:e.limitindex}):e.conversation.forceRefreshUnreadCount()}))}receivePacket(e){var t,n,o,r,i,s,d;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const a=e;let u=!1;const _=this.getUserCursor(a.inbox_type),p=null===(t=a.body)||void 0===t?void 0:t.has_new_message_notify;p?_.lt(null!==(n=p.previous_cursor)&&void 0!==n?n:c.ZERO)||(null===(o=p.previous_cursor)||void 0===o?void 0:o.eq(c.ZERO))?(u=!0,l.Y.ctxWarn(this.ctx,`push cursour is greater than local cursor, push:${null!==(r=p.previous_cursor)&&void 0!==r?r:c.ZERO}, local:${_.toString()}, msgid:${null===(i=p.message)||void 0===i?void 0:i.server_message_id}, logid:${a.log_id}`)):(null===(s=p.previous_cursor)||void 0===s?void 0:s.eq(_))?yield this.instance.processPushMessage(p,a):(u=!0,l.Y.ctxWarn(this.ctx,`push cursour is less than local cursor, push:${p.previous_cursor}, local:${_}, msgid:${null===(d=p.message)||void 0===d?void 0:d.server_message_id}, logid:${a.log_id}`)):(u=!0,l.Y.ctxWarn(this.ctx,`push body is missing, logid:${a.log_id}`)),u&&(yield this.getMessagesByUser({inboxType:a.inbox_type,cursor:_}))}))}getReportParams(e){return Object.assign({hybrid_type:"imcloud"},void 0!==e?{cursor:this.getUserCursor(e).toString()}:{})}}class le extends ce.v{constructor(){super(...arguments),this.name="IMCloudHybridLinkPlugin"}install(){this.hybridLinkInstance=new ue(this.ctx),this.register(g.Uk.HybridLink,this.hybridLinkInstance)}}class _e{constructor(e,t){this.disposed=!1,this.plugins=[],this.isProcessing=!1;const n=new g.jO;this.ctx=n,n.register(g.Uk.Monitor,S.u),n.register(g.Uk.CoreInstance,this),e.headers||(e.headers={}),e.httpHeaders||(e.httpHeaders={}),e.extended||(e.extended={}),e.boe?("string"==typeof(e=(0,j.KQ)(e)).boe&&(e.headers[u.HF.envKey]=e.boe,e.headers[u.HF.boeHeaderKey]="1",e.httpHeaders[u.HF.envKey]=e.boe,e.httpHeaders[u.HF.boeHeaderKey]="1"),"boolean"==typeof e.boe&&(e.headers[u.HF.boeHeaderKey]="1",e.httpHeaders[u.HF.boeHeaderKey]="1")):"string"==typeof(e=(0,j.fC)(e)).ppe?(e.headers[u.HF.envKey]=e.ppe,e.headers[u.HF.ppeHeaderKey]="1",e.httpHeaders[u.HF.envKey]=e.ppe,e.httpHeaders[u.HF.ppeHeaderKey]="1"):e.canary&&(e.headers[u.HF.envKey]="canary",e.httpHeaders[u.HF.envKey]="canary"),e.timeCalibration===undefined&&(e.timeCalibration=!0),this.initPlatformOptions(e),n.option=e,(0,j.RQ)(this.ctx,e),this.net=e.network(n),this.http=e.http(n),this.websocket=e.webSocket(n);const o=!1===this.ctx.option.pullInterval||this.ctx.option.pullInterval===undefined?3e4:this.ctx.option.pullInterval;if(l.Y.ctxDebug(this.ctx,"use ticker interval:",o),this.ticker=this.createTicker(this.ctx,o),n.register(g.Uk.AuthManager,ne),n.register(g.Uk.ConversationManager,D),n.register(g.Uk.MessageManager,J),n.register(g.Uk.ParticipantManager,Q),n.register(g.Uk.EventBus,m),n.register(g.Uk.NetworkManager,B),n.register(g.Uk.CoreApi,p),n.register(g.Uk.InboxType,ee),e.debug){let t="undefined"!=typeof window?window:e.injectContext,o=`__imsdk_context_${this.ctx.id.split("-")[0]}`;if("object"==typeof e.injectContext&&(t=e.injectContext,e.injectContext=!0),"string"==typeof e.injectContext&&(o=e.injectContext,e.injectContext=!0),"undefined"==typeof e.injectContext&&(e.injectContext=!0),"boolean"==typeof e.injectContext&&e.injectContext)try{Object.defineProperty(t,o,{enumerable:!1,configurable:!0,get:()=>n})}catch(r){l.Y.ctxDebug(n,"inject ctx:",n,`with name: ${o} to`,t,"failed: ",r)}}if(Array.isArray(t)&&(t.forEach((e=>{const t=new e(n);t.install(),this.plugins.push(t)})),this.ctx.plugin=this.plugins),!this.ctx.resolve(g.Uk.HybridLink)){l.Y.ctxDebug(this.ctx,"Service HybridLink is not registered, load internal IMCloudHybridLinkPlugin");const e=new le(n);e.install(),this.plugins.push(e)}l.Y.ctxDebug(this.ctx,"loaded plugin:",this.plugins),e.boe?l.Y.ctxDebug(this.ctx,`using boe env: ${!0===e.boe?"default":e.boe}`):e.ppe&&l.Y.ctxDebug(this.ctx,`using ppe env: ${e.ppe}`),this.initEventHandler(),Object.seal&&(Object.seal(this),Object.seal(n))}getContext(){return this.ctx}resolve(e){return this.ctx.resolve(e)}get initResult(){return this.ctx.initResult}set initResult(e){this.ctx.initResult=e}get event(){return this.resolve(g.Uk.EventBus)}get api(){return this.resolve(g.Uk.CoreApi)}get network(){return this.resolve(g.Uk.NetworkManager)}get inboxType(){return this.resolve(g.Uk.InboxType)}get id(){return this.ctx.id}get option(){return this.ctx.option}init(e){var t,n,o,r,i,s,c,_,p,v,h;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{userId:a,enableServerConfig:f,authType:y,webSocketLevel:m}=this.ctx.option;if(y&&[d.m.AuthType.CERT_AUTH,d.m.AuthType.PASSPORT_CERT_AUTH].includes(y))try{null===(t=this.resolve(g.Uk.SecurityProxy))||void 0===t||t.init(),this.ctx.option.cert=yield null===(n=this.resolve(g.Uk.SecurityProxy))||void 0===n?void 0:n.getCert(),this.ctx.option.tsSign=yield null===(o=this.resolve(g.Uk.SecurityProxy))||void 0===o?void 0:o.getTsSign()}catch(O){l.Y.ctxWarn(this.ctx,"get cert and tsSign error")}const b=S.u.performanceNow();this.initResult=u.rb.Start;const k=null!==(i=yield null===(r=this.resolve(g.Uk.DbProxy))||void 0===r?void 0:r.init(a))&&void 0!==i&&i;try{yield this.resolve(g.Uk.AuthManager).prepareToken()}catch(x){return this.initResult=u.rb.Error,l.Y.ctxError(this.ctx,"prepare token error:",x),this.resolve(g.Uk.Monitor).emitDuration(S.U.BizSdkInit+S.U.ErrorSuffix,b,Object.assign(Object.assign({use_db:null!==(s=k.toString())&&void 0!==s?s:"unknown"},this.resolve(g.Uk.HybridLink).getReportParams()),{reason:"token"})),this.initResult}if(f)try{yield this.initConfig()}catch(x){l.Y.ctxWarn(this.ctx,"init server config error:",x)}for(const t of this.inboxType.getInboxTypeArray()){if(!(yield this.prepareHistoryForInbox({inboxType:t,convLimit:null==e?void 0:e.convLimit,msgLimit:null==e?void 0:e.msgLimit,mode:null==e?void 0:e.mode,convTotal:null==e?void 0:e.convTotal,tagIds:null==e?void 0:e.tagIds,userCustomTagIds:null==e?void 0:e.userCustomTagIds})))return this.initResult=u.rb.Error,l.Y.ctxError(this.ctx,"init history error for inbox",t),this.resolve(g.Uk.Monitor).emitDuration(S.U.BizSdkInit+S.U.ErrorSuffix,b,Object.assign(Object.assign({use_db:null!==(c=k.toString())&&void 0!==c?c:"unknown"},this.resolve(g.Uk.HybridLink).getReportParams(t)),{reason:"history"})),this.initResult}yield this.resolve(g.Uk.ConversationManager).refreshLocalAsync(),this.resolve(g.Uk.EventBus).emitEmpty(u.c5.ConversationChange,this);try{for(const e of this.plugins)yield e.init()}catch(x){return this.initResult=u.rb.Error,l.Y.ctxError(this.ctx,"init plugin error:",x),this.resolve(g.Uk.Monitor).emitDuration(S.U.BizSdkInit+S.U.ErrorSuffix,b,Object.assign(Object.assign({use_db:null!==(_=k.toString())&&void 0!==_?_:"unknown"},this.resolve(g.Uk.HybridLink).getReportParams()),{reason:"plugin"})),this.initResult}if(m!==u._.Disable)try{this.resolve(g.Uk.Monitor).emitCounter(S.U.WebSocketConnectFirst,1,{url:null!==(v=null===(p=this.network.ws)||void 0===p?void 0:p.url)&&void 0!==v?v:"unknown"}),yield this.network.connectWs(!0)}catch(x){l.Y.ctxWarn(this.ctx,"skip websocket, init open fail:",x)}return this.ticker.onTick.subscribe((()=>{this.tickerUpdate()})),this.ticker.restart(),this.initResult=u.rb.Succeeded,this.resolve(g.Uk.Monitor).emitDuration(S.U.BizSdkInit+S.U.SuccessSuffix,b,Object.assign({use_db:null!==(h=k.toString())&&void 0!==h?h:"unknown"},this.resolve(g.Uk.HybridLink).getReportParams())),this.resolve(g.Uk.EventBus).emit(u.c5.InitFinish,this,this.initResult),this.initResult}))}getMessagesByUser(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.resolve(g.Uk.HybridLink).getMessagesByUser(e)}))}getMessagesByConversation(e){var t,n,o,r;return(0,a.__awaiter)(this,void 0,void 0,(function*(){let{cursor:i}=e;const{direction:s}=e;i instanceof k.v&&(i=i.indexInConversation),i===undefined&&(i=e.conversation.firstMessageIndex,e.conversation.firstMessageIndex.gt(null!==(t=e.conversation.__internal_pullCursor)&&void 0!==t?t:c.ZERO)&&(i=e.conversation.__internal_pullCursor,l.Y.ctxDebug(this.ctx,`using internal cursor: ${i.toString()} < ${e.conversation.firstMessageIndex.toString()} for conversation:`,e.conversation)));const a=yield this.api.GetMessagesByConversation({conversationId:e.conversation.id,conversationShortId:c.fromString(e.conversation.shortId),conversationType:e.conversation.type,anchorIndex:c.fromValue(i),direction:s||d.m.MessageDirection.OLDER,limit:null!==(n=e.limit)&&void 0!==n?n:20,inboxType:e.conversation.inboxType});this.resolve(g.Uk.Monitor).emitMetrics(S.U.GetMessagesByConversation,{count:1},{log_id:a.log_id,from:"user",conversation_id:e.conversation.shortId,cursor:c.fromValue(i).toString()});const _=null===(o=a.body)||void 0===o?void 0:o.messages_in_conversation_body;e.conversation.__internal_pullCursor=null!==(r=_.next_cursor)&&void 0!==r?r:e.conversation.__internal_pullCursor;const{msgs:p}=yield this.resolve(g.Uk.MessageManager).processNewMessagesFromPull(_.messages,u.v$.LoadMore,a.log_id);return{messages:p,hasMore:null==_?void 0:_.has_more,cursor:null==_?void 0:_.next_cursor}}))}markConversationRead(e){var t,n;return(0,a.__awaiter)(this,void 0,void 0,(function*(){let{readIndex:o,readIndexV2:r}=e;const{conversation:i}=e;o===undefined?o=i.lastMessageIndex:o instanceof k.v&&(o=o.indexInConversation),r===undefined?r=i.lastMessageIndexV2:r instanceof k.v&&(r=r.indexInConversationV2);const s=c.fromValue(o),a=c.fromValue(r),u=i.readIndex;if(!e.force&&s.lt(u))return;const{newReadBadgeCount:l,newMuteReadBadgeCount:_}=this.calcBadgeCount(i,s,u),p=[{message_type:d.m.MuteMessageType.TYPE_PART_MUTE,read_badge_count:_}];let v,h;if(this.resolve(g.Uk.ConversationManager).markRead(i.id,s,l,p),this.ctx.option.unreadCountReport){const o=this.getConversationList({filter:e=>e.inboxType===i.inboxType&&e.isMember&&0===e.mode}).reduce(((e,t)=>e+t.unreadCount),0);h=null!==(t=e.totalUnreadCount)&&void 0!==t?t:o,v=null!==(n=e.convUnreadCount)&&void 0!==n?n:i.unreadCount}yield this.api.MarkConversationReadV3({conversationId:i.id,conversationShortId:c.fromString(i.shortId),conversationType:i.type,readIndex:s,readIndexV2:a.gt(0)?a:c.ONE,inboxType:i.inboxType,unreadCount:v!==undefined?c.fromValue(v):undefined,totalUnreadCount:h!==undefined?c.fromValue(h):undefined,readBadgeCount:l,muteReadBadgeCountInfos:p})}))}calcBadgeCount(e,t,n){let o,r;return e.lastMessageIndex.eq(t)?(o=e.badgeCount,r=e.partMuteBadgeCount):(o=Math.min(e.badgeCount,e.settingInfo.readBadgeCount+e.getLocalMessageRangeList(n,t).length),r=Math.min(e.partMuteBadgeCount,e.settingInfo.partMuteReadBadgeCount+e.getLocalMessageRangeList(n,t).filter((t=>e.isMsgInWeakMuteWhiteList(t))).length)),{newReadBadgeCount:o,newMuteReadBadgeCount:r}}batchClearConversationRead(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=null!==(t=e.messageTypes)&&void 0!==t?t:[d.m.MuteMessageType.TYPE_PART_MUTE,0],o=e.conversations.map((e=>{const t=n.includes(d.m.MuteMessageType.TYPE_PART_MUTE),o=n.includes(0),r={muteReadBadgeCountInfos:t?[{message_type:d.m.MuteMessageType.TYPE_PART_MUTE,read_badge_count:e.partMuteBadgeCount}]:[{message_type:d.m.MuteMessageType.TYPE_PART_MUTE,read_badge_count:e.settingInfo.partMuteReadBadgeCount}],readBadgeCount:o?t?e.badgeCount:Math.max(e.badgeCount-e.unreadCountWithWhiteList,0):t?Math.min(e.settingInfo.readBadgeCount+e.unreadCountWithWhiteList,e.badgeCount):e.settingInfo.readBadgeCount},i=c.fromValue(e.settingInfo.readIndexV2);return Object.assign({conversationId:e.id,conversationShortId:c.fromString(e.shortId),conversationType:e.type,readIndex:c.fromValue(e.settingInfo.readIndex),readIndexV2:i.gt(0)?i:c.ONE,inboxType:e.inboxType,unreadCount:c.fromValue(0),totalUnreadCount:c.fromValue(0)},r)}));yield this.api.BatchMarkConversationReadV3({batch:o})}))}get noticeUnreadCount(){return this.getConversationList().filter((e=>e.pushStatus===u.Bs.Allow||e.pushStatus===u.Bs.Unknown)).reduce(((e,t)=>e+t.unreadCount),0)+this.getConversationList().filter((e=>e.pushStatus===u.Bs.PartAllow)).reduce(((e,t)=>e+t.unreadCountWithWhiteList),0)}get mutedUnreadCount(){return this.getConversationList().filter((e=>e.pushStatus===u.Bs.Disable)).reduce(((e,t)=>e+t.unreadCount),0)+this.getConversationList().filter((e=>e.pushStatus===u.Bs.PartAllow)).reduce(((e,t)=>e+Math.max(0,t.unreadCount-t.unreadCountWithWhiteList)),0)}recallMessage(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!e.message.serverId)throw new v.G({ctx:this.ctx,type:u.NI.MessageNotReady,msg:`message ${e.message} is not ready`,sender:this});const t=this.resolve(g.Uk.ConversationManager).get(e.message.conversationId),n=yield this.api.RecallMessage({conversationId:e.message.conversationId,conversationShortId:c.fromString(e.message.conversationShortId),conversationType:e.message.conversationType,serverId:c.fromString(e.message.serverId),inboxType:t.inboxType});this.resolve(g.Uk.MessageManager).markRecalled(e.message.conversationId,e.message.serverId,n.log_id)}))}createConversation(e){var t,n,o,r,i;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const s=S.u.performanceNow();let a=[];const l={success:!1,payload:null};if(e.inboxType===undefined&&(e.inboxType=this.inboxType.getDefaultInbox()),!this.inboxType.isValidInbox(e.inboxType))throw new v.G({ctx:this.ctx,msg:"invalid inbox",type:u.NI.InvalidInboxType,sender:this});if(e.type===undefined&&(Array.isArray(e.participants)?e.participants.length<=1?e.type=d.m.ConversationType.ONE_TO_ONE_CHAT:e.type=d.m.ConversationType.GROUP_CHAT:e.type=d.m.ConversationType.ONE_TO_ONE_CHAT),a=Array.isArray(e.participants)?-1===e.participants.indexOf(this.ctx.option.userId)?e.participants.concat(this.ctx.option.userId):e.participants:[e.participants,this.ctx.option.userId],a.length>2&&e.type===d.m.ConversationType.ONE_TO_ONE_CHAT)return l.statusCode=u.NI.InvalidParam,l.statusMsg="one to one chat can only has 2 participants",l;e.persistent===undefined&&e.idempotentId!==undefined&&e.idempotentId.length>0&&(e.persistent=!0);try{const t=yield this.api.CreateConversationV2({type:e.type,participants:a.map((e=>c.fromValue(e))),persistent:e.persistent,idempotentId:e.idempotentId,name:e.name,avatarUrl:e.avatarUrl,desc:e.desc,bizExt:e.bizExt,inboxType:e.inboxType}),n=t.body.create_conversation_v2_body;if(l.checkCode=n.check_code,l.checkMsg=n.check_message,l.statusCode=n.status,l.statusMsg=n.extra_info,l.body=n,0===(null==n?void 0:n.status)){const e=b.r.fromServerConversation(this.ctx,null==n?void 0:n.conversation,t.log_id);this.resolve(g.Uk.ConversationManager).upsert(e),yield this.resolve(g.Uk.ConversationManager).refreshAsync(e);const o=this.resolve(g.Uk.ConversationManager).get(e.id);l.success=!0,l.payload=o,this.resolve(g.Uk.EventBus).emit(u.c5.ConversationCreate,this,o)}}catch(_){l.statusCode=null!==(t=_.type)&&void 0!==t?t:u.NI.NetworkError,l.innerError=_}return this.resolve(g.Uk.Monitor).emitMetrics(S.U.CreateConversation,{create_cost:Math.round(S.u.performanceNow()-s)},{type:null!==(o=null===(n=e.type)||void 0===n?void 0:n.toString())&&void 0!==o?o:"unknown",error_code:null!==(i=null===(r=l.statusCode)||void 0===r?void 0:r.toString())&&void 0!==i?i:"unknown"}),l}))}getConversation(e){return this.resolve(g.Uk.ConversationManager).get(e.conversationId)}getConversationOnline(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.resolve(g.Uk.ConversationManager).getWithOnline(e.conversationId,e.shortId,e.type)}))}getConversationList(e={}){const{filter:t,tagIds:n,userCustomTagIds:o}=e;let r=this.resolve(g.Uk.ConversationManager).getConversationArray(t);if(n||o){const e=Array.isArray(n)?n:[n].filter(Boolean),t=Array.isArray(o)?o:[o].filter(Boolean);if(e.length>0||t.length>0){const n=new Set(e),o=new Set(t);r=r.filter((e=>e.tagIds.find((e=>n.has(e)))||e.userTagIds.find((e=>o.has(e)))))}}return r}getConversationListOnline(e={}){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.resolve(g.Uk.ConversationManager).refreshLocalAsync(),this.getConversationList(e)}))}getConversationMessages(e){var t;const{conversation:n}=e;if(e.isCheckMsg)try{null===(t=this.resolve(g.Uk.DbProxy))||void 0===t||t.checkMessages(n)}catch(o){l.Y.ctxWarn(this.ctx,`check msgs error, conv id: ${n.id}`)}return e.filter||(e.filter=e=>e.visible),this.resolve(g.Uk.MessageManager).getList(n.id).filter(e.filter)}createMessage(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){e.insert===undefined&&(e.insert=!0);const n=Object.assign({},e.ext),o=k.v.createClientMessage(this.ctx,{type:e.type,content:e.content,ext:n,id:null!==(t=e.clientId)&&void 0!==t?t:(0,A.k)(),conversationId:e.conversation.id,mentionedUsers:e.mentionedUsers||[],conversationShortId:e.conversation.shortId,conversationType:e.conversation.type,referenceMessage:e.referenceMessage,referenceHint:e.referenceHint});return o.flightStatus=u.b3.Created,o.sendFunc=this.__internal_sendMessageObject.bind(this),o.indexInConversation=e.conversation.lastMessageIndex.add(1),o.orderInConversation=e.conversation.lastMessageOrder.add(1),e.insert&&(yield this.resolve(g.Uk.MessageManager).processNewMessage(o,u.v$.Offline)),o}))}sendMessage(e){var t,n,o,r;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{message:i}=e,s=Date.now(),a=yield i.sendFunc(i);this.resolve(g.Uk.EventBus).emit(u.c5.MessageSend,this,i);try{const e=Date.now(),c=this.resolve(g.Uk.ConversationManager).get(i.conversationId);this.resolve(g.Uk.Monitor).emitMetrics(S.U.SendMessage,{con_member_count:c.participantCount-1,send_cost_time:e-s},{con_type:i.conversationType.toString(),conversation_id:i.conversationId,msg_uuid:i.serverId,msg_type:i.type.toString(),send_start_time:s.toString(),send_end_time:e.toString(),error_code:null!==(n=null===(t=a.statusCode)||void 0===t?void 0:t.toString())&&void 0!==n?n:"unknown",is_ws:(null===(o=this.network.ws)||void 0===o?void 0:o.isOpen())?"1":"0",logid:null!==(r=a.logid)&&void 0!==r?r:""})}catch(c){l.Y.ctxWarn(this.ctx,"Fail to report data after send message",c)}return a}))}fetchConversation(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let t=null;if(e.shortId!==undefined){const t=this.resolve(g.Uk.ConversationManager).getWithShortIdRaw(e.shortId);if(t!==undefined&&!t.isOffline)return t}if(e.inboxType===undefined&&(e.inboxType=this.inboxType.getDefaultInbox()),!this.inboxType.isValidInbox(e.inboxType))throw new v.G({ctx:this.ctx,msg:"invalid inbox",type:u.NI.InvalidInboxType,sender:this});if(e.idempotentId!==undefined&&e.participantId===undefined){const n=yield this.createConversation({type:d.m.ConversationType.GROUP_CHAT,participants:[],inboxType:e.inboxType,idempotentId:e.idempotentId});n.success&&(t=n.payload,null!==t&&(yield this.getConversationOnline({conversationId:t.id,shortId:t.shortId,type:d.m.ConversationType.ONE_TO_ONE_CHAT})))}else if(e.participantId!==undefined){const n=yield this.createConversation({type:d.m.ConversationType.ONE_TO_ONE_CHAT,participants:e.participantId,inboxType:e.inboxType});n.success&&(t=n.payload,null!==t&&(yield this.resolve(g.Uk.ConversationManager).refreshAsync(t)))}else{if(e.shortId===undefined)throw new v.G({ctx:this.ctx,type:u.NI.InvalidParam,msg:"no valid param provided",reachServer:!1,sender:this});t=yield this.getConversationOnline({conversationId:e.shortId,shortId:e.shortId,type:d.m.ConversationType.GROUP_CHAT})}if(null===t||t.isOffline)throw new v.G({ctx:this.ctx,type:u.NI.ConversationNotExist,msg:"fetch failed, conv is null or offline",reachServer:!1,sender:this});return yield this.getMessagesByConversation({conversation:t}),t}))}getMessageReadReceipt(e){if(!e.message.isFromMe||e.message.isOffline)return{finishedParticipants:[],expectedParticipants:[]};const t=this.resolve(g.Uk.ConversationManager).get(e.message.conversationId);if(0===t.getParticipantList().length)return{finishedParticipants:[],expectedParticipants:[]};const n=e.message.__internal_cachedReadReceipt;let o=!0;if(n!==undefined&&(0!==n.expectedParticipants.length&&n.expectedParticipants.length===n.finishedParticipants.length&&(o=!1),e.message.__internal_receiptClean&&(o=!1)),o){const n=[],o=[],r=t.getParticipantList();0!==r.length&&r.forEach((t=>{t.minIndex.gt(e.message.indexInConversation)||t.userId!==this.ctx.option.userId&&(o.push(t),(t.readOrder.gte(e.message.orderInConversation)||t.readIndex.gte(e.message.indexInConversation))&&n.push(t))})),e.message.__internal_cachedReadReceipt={finishedParticipants:n,expectedParticipants:o},e.message.__internal_receiptClean=!0}return e.message.__internal_cachedReadReceipt}updateConversationReadReceipt(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{conversation:t}=e,n=this.resolve(g.Uk.ParticipantManager).getRaw(t.id);if(!n.length)return void this.resolve(g.Uk.ParticipantManager).getParticipants(t);const o={},{readIndexs:r,minIndexs:i}=yield this.getParticipantsReadAndMinIndex({conversation:e.conversation,batchFetch:e.batchFetch});i.forEach((e=>{o[e.user_id.toString()]={minIndex:e.index,readIndex:e.index}})),r.forEach((e=>{o[e.user_id.toString()]!==undefined?o[e.user_id.toString()].readIndex=e.index:o[e.user_id.toString()]={readIndex:e.index,minIndex:c.ZERO}}));const s=[];for(const e of Object.keys(o)){const r=o[e],i=n.find((t=>t.userId===e)),a=se(i?{readIndex:i.readIndex,minIndex:i.minIndex}:{readIndex:c.ZERO,minIndex:c.ZERO},r);s.push(...a),i!==undefined&&(i.readIndex=r.readIndex,i.readOrder=r.readIndex,i.minIndex=r.minIndex,this.resolve(g.Uk.ParticipantManager).upsert(t.id,i))}const a=function(e){const t=[];e.sort(((e,t)=>e.minIndex.sub(t.minIndex).toNumber()));for(const n of e){const e=0!==t.length?t[t.length-1]:undefined;0===t.length||(null==e?void 0:e.readIndex.lt(n.minIndex))?t.push(n):e.readIndex=oe(e.readIndex,n.readIndex)}return t}(s),d=[];for(const e of a)d.push(...ie(t,{readIndex:e.minIndex},{readIndex:e.readIndex}));0!==d.length&&(d.forEach((e=>e.__internal_receiptClean=!1)),this.resolve(g.Uk.EventBus).emit(u.c5.ReadReceiptChange,this,{conversation:t,messages:d}))}))}dispose(){var e,t;this.resolve(g.Uk.EventBus).unsubscribeAll(),null===(e=this.ticker)||void 0===e||e.stop(),this.network.closeWs(),null===(t=this.network.ws)||void 0===t||t.dispose(),this.network.onMessage.unsubscribeAll(),this.plugins.forEach((e=>e.dispose())),this.plugins.length=0,this.resolve(g.Uk.ConversationManager).dispose(),this.resolve(g.Uk.MessageManager).dispose(),this.resolve(g.Uk.ParticipantManager).dispose(),this.ctx.option.monitor=undefined,this.ctx.option.aspectBefore=()=>(l.Y.ctxError(this.ctx,"do not invoke a disposed instance"),!1),this.disposed=!0,l.Y.ctxDebug(this.ctx,"sdk unloaded, do not invoke this instance")}prepareHistoryForInbox(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.resolve(g.Uk.HybridLink).prepareHistoryForInbox(e)}))}tickerUpdate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if((yield this.network.net.getConnectionStatus())!==F.Disconnected&&this.initResult===u.rb.Succeeded){if(this.ctx.option.pullInterval&&!this.isProcessing&&(!this.ctx.option.disablePullIntervalWhenWsIsOnline||!this.network.isWsOnline))for(const t of this.inboxType.getInboxTypeArray())try{yield this.getMessagesByUser({inboxType:t}),this.resolve(g.Uk.Monitor).emitMetrics(S.U.GetMessagesByTicker,{count:1},Object.assign({tick_timer:this.ticker.getTickTimer(),time:Math.round(Date.now()/1e3).toString(),inbox:t.toString()},this.resolve(g.Uk.HybridLink).getReportParams(t)))}catch(e){l.Y.ctxWarn(this.ctx,"ticker running in pull user err:",e)}for(const t of this.plugins)try{yield t.ticker()}catch(e){l.Y.ctxWarn(this.ctx,"ticker running in plugin err:",e)}}}))}__internal_sendMessageObject(e){var t,n,o,r,i;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const s={success:!1,payload:e};if(e.serverId)return s.statusCode=0,s;const a=this.resolve(g.Uk.ConversationManager).getRaw(e.conversationId);if(a===undefined)return s.statusCode=u.NI.ConversationNotExist,s.statusMsg=`conversation ${e.conversationId} not exist in local`,s;e.flightStatus=u.b3.Inflight,yield this.resolve(g.Uk.MessageManager).processNewMessage(e,u.v$.Offline);try{a.ticket||(yield this.resolve(g.Uk.ConversationManager).refreshTicket(a.id))}catch(l){return e.flightStatus=u.b3.Failed,s.statusCode=null!==(t=l.type)&&void 0!==t?t:u.NI.InvalidTicket,s.innerError=l,this.resolve(g.Uk.MessageManager).upsert(e),s}try{if(this.ctx.option.timeCalibration){const t=this.ctx.resolve(g.Uk.Monitor).avgDelta,n=Date.now();e.ext[u.v9.SendTime]=(n+t).toString()}const t=yield this.api.SendMessage({conversationType:a.type,conversationId:a.id,conversationShortId:c.fromString(a.shortId),content:e.content,ticket:a.ticket,ext:e.ext,messageType:e.type,clientId:e.clientId,mentionedUsers:e.mentionedUsers.map((e=>c.fromString(e))),inboxType:a.inboxType,referenceInfo:e.referenceInfo}),i=null===(n=t.body)||void 0===n?void 0:n.send_message_body;if(e.ext[u.v9.SendResponseCheckCode]=null!==(o=null==i?void 0:i.check_code.toString())&&void 0!==o?o:"",e.ext[u.v9.SendResponseCheckMessage]=null==i?void 0:i.check_message,e.ext[u.v9.SendResponseExtraInfo]=null==i?void 0:i.extra_info,e.ext[u.v9.SendResponseStatus]=null!==(r=null==i?void 0:i.status.toString())&&void 0!==r?r:"",this.ctx.option.debug&&(e.ext[u.v9.LocalLogId]=t.log_id),s.body=i,s.checkCode=i.check_code,s.checkMsg=i.check_message,s.statusCode=i.status,s.statusMsg=i.extra_info,s.logid=t.log_id,0===i.status){const t=i.server_message_id.toString();e.serverId=t,e.flightStatus=u.b3.Succeeded,e.isOffline=!1,yield this.resolve(g.Uk.MessageManager).processNewMessage(e,u.v$.Offline),s.success=!0}else e.flightStatus!==u.b3.Received?(e.flightStatus=u.b3.Rejected,i.status===d.m.SendMessageStatus.CHECK_MSG_NOT_PASS_BUT_SELF_VISIBLE&&(e.flightStatus=u.b3.SelfVisible)):s.success=!0}catch(l){e.flightStatus!==u.b3.Received&&(e.flightStatus=u.b3.Failed),s.innerError=l,s.statusCode=null!==(i=l.type)&&void 0!==i?i:u.NI.NetworkError}return this.resolve(g.Uk.MessageManager).upsert(e),s}))}receivePacket(e){var t,n;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.initResult===u.rb.Succeeded){this.isProcessing=!0;try{if(e.cmd===d.m.IMCMD.NEW_MSG_NOTIFY){const o=null===(t=e.body)||void 0===t?void 0:t.has_new_message_notify;if(o){const t=this.resolve(g.Uk.ConversationManager).getRaw(o.conversation_id);yield this.clientAck({packet:e,inboxType:null!==(n=null==t?void 0:t.inboxType)&&void 0!==n?n:null==e?void 0:e.inbox_type,type:d.m.MsgReportType.MSG_RECEIVE_BY_WS}),this.handleBadgeCount(o,t)}yield this.resolve(g.Uk.HybridLink).receivePacket(e),this.resolve(g.Uk.ConversationManager).refreshLocal();for(const t of this.plugins)yield t.receivePacket(e)}}catch(o){throw o}finally{this.isProcessing=!1}}}))}handleBadgeCount(e,t){try{t&&(e.badge_count&&(t.badgeCount=e.badge_count),Array.isArray(e.mute_badge_count_info)?t.mergeMuteBadgeCountInfos(e.mute_badge_count_info):e.mute_badge_count_info&&t.mergeMuteBadgeCountInfos([e.mute_badge_count_info]),this.resolve(g.Uk.ConversationManager).upsert(t))}catch(n){l.Y.ctxWarn(this.ctx,"handle badge count data error",n)}}clientAck({packet:e,inboxType:t,type:n}){var o,r,i,s,u,l;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!(null===(o=e.body)||void 0===o?void 0:o.has_new_message_notify)||!e.start_time_stamp||e.start_time_stamp.lte(0))return;let a;switch(yield this.network.net.getNetworkType()){case Y.Cellular_2G:a=d.m.NetworkType.MOBILE_2G;break;case Y.Cellular_3G:a=d.m.NetworkType.MOBILE_3G;break;case Y.Cellular_4G:a=d.m.NetworkType.MOBILE_4G;break;case Y.Cellular_5G:a=d.m.NetworkType.MOBILE_5G;break;case Y.Wifi:a=d.m.NetworkType.WIFI;break;default:a=d.m.NetworkType.UNKNOWN}this.resolve(g.Uk.Monitor).emitMetrics(S.U.MessageAck,{count:1},{start_timestamp:e.start_time_stamp.toString(),cmd:e.cmd.toString(),network_type:a.toString(),logid:e.log_id,client_timestamp:(new Date).getTime().toString(),server_message_id:null!==(s=null===(i=null===(r=e.body.has_new_message_notify.message)||void 0===r?void 0:r.server_message_id)||void 0===i?void 0:i.toString())&&void 0!==s?s:"0",report_net_type:n.toString()}),yield this.api.ClientAck({startTimeStamp:e.start_time_stamp,cmd:e.cmd,NetworkType:a,logid:e.log_id,clientTimeStamp:c.fromNumber((new Date).getTime()),serverId:null!==(l=null===(u=e.body.has_new_message_notify.message)||void 0===u?void 0:u.server_message_id)&&void 0!==l?l:c.ZERO,inboxType:t,type:n})}))}reportMessageDelayTime(e,t){var n,o,r,i,s,a,c,d,_;const p=null===(n=e.create_time)||void 0===n?void 0:n.toNumber();if(!p)return;const v=this.ctx.option.timeCalibration?this.resolve(g.Uk.Monitor).avgDelta:0,h=Date.now(),f=Math.round(h+v-p);if(f<=0)return void l.Y.ctxDebug(this.ctx,`message reception delay is less than 0, serverId:${e.server_message_id}, current:${h}, createTime:${p}, timeDelta:${v}`);let y;const m=Number(null===(o=e.ext)||void 0===o?void 0:o[u.v9.SendTime]);if(Number.isFinite(m)){const t=Math.round(h+v-m);t>0?y=t:l.Y.ctxDebug(this.ctx,`end_end_cost is less than 0, serverId:${e.server_message_id}, current:${h}, sendTimeFromClient:${m}, timeDelta:${v}`)}this.resolve(g.Uk.Monitor).emitMetrics(S.U.ReceiveMessage,Object.assign({receive_cost_time:f},y?{end_end_cost:y}:{}),Object.assign({con_type:null!==(i=null===(r=e.conversation_type)||void 0===r?void 0:r.toString())&&void 0!==i?i:"",conversation_id:null!==(s=e.conversation_id)&&void 0!==s?s:"",msg_uuid:null!==(c=null===(a=e.server_message_id)||void 0===a?void 0:a.toString())&&void 0!==c?c:"",receive_end_time:h.toString(),receive_start_time:p.toString(),time_delta:v.toString(),msg_type:null!==(_=null===(d=e.message_type)||void 0===d?void 0:d.toString())&&void 0!==_?_:"",error_code:"0",ntp_ready:this.ctx.option.timeCalibration?"1":"0",is_ws:"1",logid:t},this.resolve(g.Uk.HybridLink).getReportParams()))}processInitMessage(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){e&&(yield this.resolve(g.Uk.MessageManager).processNewMessagesFromPull(e,u.v$.Init,t))}))}processInitConversation(e,t){e&&e.map((e=>b.r.fromServerConversation(this.ctx,e,t))).forEach((e=>this.resolve(g.Uk.ConversationManager).upsert(e)))}processPushMessage(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=e.message;if(n){this.reportMessageDelayTime(n,t.log_id);const e=k.v.fromServerMessage(this.ctx,n,t.log_id);e.ext||(e.ext={}),this.ctx.option.debug&&(e.ext[u.v9.LocalLogId]=t.log_id),yield this.resolve(g.Uk.MessageManager).processNewMessage(e,u.v$.Online)}else l.Y.ctxWarn(this.ctx,"msg body is empty:",e)}))}getParticipantsReadAndMinIndex(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(e.batchFetch){const{conversation:n}=e,o=(yield this.api.BatchGetConversationParticipantsReadIndex({conversationId:[n.id],conversationShortId:[c.fromString(n.shortId)],min_index_required:!0})).conversationParticipantsReadIndex,r=(null===(t=null==o?void 0:o[0])||void 0===t?void 0:t.participantReadIndex)||[],i=[],s=[];return r.forEach((e=>{e.index&&i.push({user_id:c.fromString(e.user_id.toString()),index:c.fromString(e.index.toString())}),s.push({user_id:c.fromString(e.user_id.toString()),index:c.fromString(e.index_min.toString())})})),{readIndexs:i,minIndexs:s}}{const t=yield this.api.GetConversationParticipantsReadIndexV3({conversationId:e.conversation.id,conversationShortId:c.fromString(e.conversation.shortId),conversationType:e.conversation.type,inboxType:e.conversation.inboxType}),n=yield this.api.GetConversationParticipantsMinIndexV3({conversationId:e.conversation.id,conversationShortId:c.fromString(e.conversation.shortId),conversationType:e.conversation.type,inboxType:e.conversation.inboxType});return{readIndexs:(null==t?void 0:t.indexes)||[],minIndexs:n.indexes||[]}}}))}initEventHandler(){this.network.onMessage.subscribe((e=>this.receivePacket(e))),this.resolve(g.Uk.EventBus).subscribe(u.c5.InitParticipant,(e=>{this.updateConversationReadReceipt({conversation:e,batchFetch:!0})}))}initConfig(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this.api.GetConfigs();null===(e=null==t?void 0:t.configs)||void 0===e||e.forEach((e=>{let t=e.conf_value;t!==undefined&&null!==t&&("true"===e.conf_value?t=!0:"false"===e.conf_value?t=!1:isNaN(Number(e.conf_value))||(t=Number(e.conf_value)),this.ctx.config.set(e.conf_name,t))})),l.Y.ctxDebug(this.ctx,"load server config",this.ctx.config)}catch(t){l.Y.ctxWarn(this.ctx,"fail to load server config")}}))}}var pe=n(5594),ve=n.n(pe),ge=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"getConnectionStatus",value:function(){return(0,a.__awaiter)(this,void 0,void 0,ve().mark((function e(){return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof navigator||navigator.onLine===undefined){e.next=8;break}if(!navigator.onLine){e.next=5;break}return e.abrupt("return",F.Connected);case 5:return e.abrupt("return",F.Disconnected);case 6:e.next=9;break;case 8:return e.abrupt("return",F.Unknown);case 9:case"end":return e.stop()}}),e)})))}},{key:"getNetworkType",value:function(){return(0,a.__awaiter)(this,void 0,void 0,ve().mark((function e(){return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getConnectionStatus();case 2:if(e.sent!==F.Disconnected){e.next=5;break}return e.abrupt("return",Y.None);case 5:if("undefined"==typeof navigator||!navigator.connection||!navigator.connection.type){e.next=27;break}e.t0=navigator.connection.type,e.next="cellular"===e.t0?9:"wifi"===e.t0?21:"other"===e.t0?22:"none"===e.t0?23:24;break;case 9:if(!navigator.connection.effectiveType){e.next=20;break}e.t1=navigator.connection.effectiveType,e.next="2g"===e.t1||"slow-2g"===e.t1?13:"3g"===e.t1?14:"4g"===e.t1?15:"5g"===e.t1?16:17;break;case 13:return e.abrupt("return",Y.Cellular_2G);case 14:return e.abrupt("return",Y.Cellular_3G);case 15:return e.abrupt("return",Y.Cellular_4G);case 16:return e.abrupt("return",Y.Cellular_5G);case 17:case 20:case 24:case 27:return e.abrupt("return",Y.Unknown);case 18:e.next=21;break;case 21:return e.abrupt("return",Y.Wifi);case 22:return e.abrupt("return",Y.Other);case 23:return e.abrupt("return",Y.None);case 25:e.next=28;break;case 28:case"end":return e.stop()}}),e,this)})))}}]),n}(te),he=n(77386),fe=n.n(he);class ye extends g.mA{constructor(e){super(e),this.option=e.option}sendByBeacon(e,t){return!1}sendBeacon(e,t){setTimeout((()=>{this.sendByBeacon(e,R(t))||this.sendRequest(e,t)}),0)}sendRequest(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.send(e,"POST",this.encode(t));return this.decode(n)}))}encode(e){return R(e).buffer}decode(e){return d.m.Response.create(P(this.ctx,e))}get headers(){return Object.assign({Accept:this.mime,"Content-Type":this.mime},this.option.httpHeaders)}get mime(){return"application/x-protobuf"}get dataType(){return"arraybuffer"}get method(){return"POST"}}var me=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).instance=fe().create({timeout:r.option.timeout,withCredentials:Boolean(r.option.withCredentials),headers:r.headers,responseType:r.dataType,method:r.method}),r}return(0,r.Z)(n,[{key:"send",value:function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,ve().mark((function o(){var r;return ve().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.instance.request({url:e,data:n,method:t});case 2:return r=o.sent,o.abrupt("return",r.data);case 4:case"end":return o.stop()}}),o,this)})))}},{key:"sendByBeacon",value:function(e,t){return navigator.sendBeacon!==undefined&&navigator.sendBeacon(e,t)}}]),n}(ye),be=n(68493),ke=n.n(be);class Oe extends g.mA{constructor(e){super(e),this.openTime=0,this.createTime=0,this.option=e.option,this.url=this.option.frontierUrl,this.onClose=new f(e),this.onOpen=new f(e),this.onError=new f(e),this.onMessage=new f(e),this.onOpen.subscribe((()=>{var e;this.openTime=S.u.performanceNow(),this.resolve(g.Uk.Monitor).emitMetrics(S.U.FrontierOpen,{duration:this.openTime-this.createTime},{url:null!==(e=this.url)&&void 0!==e?e:"unknown"})})),this.onClose.subscribe((e=>{var t,n,o,r;"undefined"!=typeof CloseEvent&&e instanceof CloseEvent?this.resolve(g.Uk.Monitor).emitMetrics(S.U.FrontierClose,{count:1},{url:null!==(t=this.url)&&void 0!==t?t:"unknown",code:null===(n=e.code)||void 0===n?void 0:n.toString(),reason:e.reason}):this.resolve(g.Uk.Monitor).emitMetrics(S.U.FrontierClose,{count:1},{url:null!==(o=this.url)&&void 0!==o?o:"unknown"}),0===this.openTime||Number.isNaN(this.openTime)||this.resolve(g.Uk.Monitor).emitMetrics(S.U.FrontierLive,{duration:S.u.performanceNow()-this.openTime},{url:null!==(r=this.url)&&void 0!==r?r:"unknown"}),this.openTime=0})),this.onMessage.subscribe((e=>{var t;"hi"!==e.toString()&&this.resolve(g.Uk.Monitor).emitMetrics(S.U.FrontierReceive,{count:1},{url:null!==(t=this.url)&&void 0!==t?t:"unknown"})})),this.onError.subscribe((()=>{var e;this.resolve(g.Uk.Monitor).emitMetrics(S.U.FrontierError,{count:1},{url:null!==(e=this.url)&&void 0!==e?e:"unknown"})}))}get paramUrl(){const{headers:e,authType:t,cert:n,tsSign:o}=this.option,r={};(null==e?void 0:e[u.HF.envKey])!==undefined&&(r[u.HF.envKey]=e[u.HF.envKey]),(null==e?void 0:e[u.HF.boeHeaderKey])!==undefined&&(r[u.HF.boeHeaderKey]=e[u.HF.boeHeaderKey]),(null==e?void 0:e[u.HF.ppeHeaderKey])!==undefined&&(r[u.HF.ppeHeaderKey]=e[u.HF.ppeHeaderKey]);const i=Object.assign(Object.assign({token:this.ctx.cachedToken,sid:this.option.sessionId,aid:this.option.appId,fpid:this.option.fpId,device_id:this.option.deviceId,access_key:x()(`${this.option.fpId+this.option.appKey+this.option.deviceId}f8a69f1719916z`),device_platform:this.option.devicePlatform,version_code:this.option.versionCode},this.option.extended),r);return d.m.AuthType.CERT_AUTH===t&&(i.sdk_cert=encodeURIComponent(null!=n?n:""),i.ts_sign=encodeURIComponent(null!=o?o:"")),`${this.url}?${function(e){const t=[];for(const n of Object.keys(e))e[n]!==undefined&&""!==e[n]&&t.push(`${n}=${e[n]}`);return t.join("&")}(i)}`}performOpen(){let e=!1;this.createTime=S.u.performanceNow();const t=new Promise(((t,n)=>{setTimeout((()=>{e||n(new v.G({ctx:this.ctx,msg:"frontier connect timeout",type:u.NI.NetworkError,sender:this}))}),this.ctx.option.timeout)}));return Promise.race([t,(()=>(0,a.__awaiter)(this,void 0,void 0,(function*(){try{yield this.open()}catch(t){throw new v.G({ctx:this.ctx,msg:"ws connect error",innerError:t,sender:this,type:u.NI.NetworkError})}finally{e=!0}})))()])}dispose(){this.onOpen.unsubscribeAll(),this.onClose.unsubscribeAll(),this.onError.unsubscribeAll(),this.onMessage.unsubscribeAll()}}var xe,we=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"registerEvents",value:function(){var e=this;this.ws.onclose=function(t){e.onClose.next(t,e)},this.ws.onopen=function(){e.onOpen.nextEmpty(e)},this.ws.onmessage=function(t){e.onMessage.next(t.data,e)},this.ws.onerror=function(t){e.onError.next(t,e)}}},{key:"open",value:function(){var e,t,n=this;if(this.isOpen())return l.Y.ctxWarn(this.ctx,"ws already open, close first"),ke().resolve(!0);this.ws=new WebSocket(this.paramUrl,u.HF.wsProtocols),this.ws.binaryType="arraybuffer",this.registerEvents();var o=this.onOpen.subscribe((function(){e(!0),n.onOpen.unsubscribe(o)})),r=this.onError.subscribe((function(e){t(e),n.onError.unsubscribe(r)}));return new(ke())((function(n,o){e=n,t=o}))}},{key:"close",value:function(){this.ws&&(this.ws.onmessage=null,this.ws.close()),this.ws=undefined}},{key:"send",value:function(e){this.ws.send(e)}},{key:"isOpen",value:function(){return this.ws!==undefined&&this.ws.readyState===WebSocket.OPEN}}]),n}(Oe),Ie=n(54343),Ce=n.n(Ie),Me=n(85792),Te=n.n(Me),Re=n(26447),Pe=n.n(Re),Se=n(58908);!function(e){e[e.Stopped=0]="Stopped",e[e.Running=1]="Running"}(xe||(xe={}));class Ee extends g.mA{constructor(e,t,n){return super(e),this.state=xe.Stopped,this.refreshRate=0,this.doneDuration=0,this.refreshRate=t,this.doneDuration=n,this.onTick=new f(this.ctx),this.onDone=new f(this.ctx),this.onStop=new f(this.ctx),this}get duration(){return this.state===xe.Stopped&&0!==this.lastStopTime?this.lastStopTime-this.startTime:this.state===xe.Running?Date.now()-this.startTime:0}start(){this.state!==xe.Running&&this.restart()}getTickTimer(){return this.tickTimer}update(){this.onTick.nextEmpty(this)}done(){this.stop(),this.onDone.nextEmpty()}}var Be=Se.Z.setIntervalWarp,je=Se.Z.clearIntervalWarp,Ae=Se.Z.setTimeoutWarp,Ue=Se.Z.clearTimeoutWarp,Le=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"restart",value:function(){var e=this;this.tickTimer&&this.stop(),this.state=xe.Running;var t=this.ctx.option.enableHackTimer,n=t?Be:Ce(),o=t?Ae:Te();this.tickTimer=n((function(){e.update()}),this.refreshRate),this.doneDuration!==undefined&&(this.doneTimer=o((function(){e.done()}),this.doneDuration)),this.startTime=Pe()(),this.lastStopTime=0,this.update()}},{key:"stop",value:function(){if(this.state!==xe.Stopped){var e=this.ctx.option.enableHackTimer,t=e?je:clearInterval,n=e?Ue:clearTimeout;t(this.tickTimer),n(this.doneTimer),this.state=xe.Stopped,this.lastStopTime=Pe()(),this.onStop.nextEmpty()}}}]),n}(Ee),Ne=function(e){return new ge(e)},De=function(e){return new me(e)},qe=function(e){return new we(e)},Ge=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"initPlatformOptions",value:function(e){e.network=e.network||Ne,e.http=e.http||De,e.webSocket=e.webSocket||qe,e.sdkType=e.sdkType||"im-web-sdk"}},{key:"createTicker",value:function(e,t,n){return new Le(e,t,n)}}]),n}(_e)},17028:function(e,t,n){"use strict";n.d(t,{f:function(){return A}});var o=n(19049),r=n(95508),i=n(6670),s=n(78034),a=n(5594),c=n.n(a),d=n(67624),u=n.n(d),l=n(56442),_=n.n(l),p=n(82766),v=n.n(p),g=n(21155),h=n.n(g),f=n(19672),y=n.n(f),m=n(34346),b=n.n(m),k=n(94090),O=n.n(k),x=n(11227),w=n.n(x),I=n(15727),C=n(9267),M=n(69071),T=n(3539),R=n(39805),P=n(17390);class S extends T.mA{}var E=n(69955),B=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,e)}return(0,r.Z)(n,[{key:"init",value:function(){var e=this.ctx.option,t=e.appId,n=e.securityStoreType,o=void 0===n?"local":n,r=e.securitySignVersion,i=e.securityCertType,s=void 0===i?"request":i,a=e.securityScene,c=void 0===a?"":a;this.sdk=E.SecureSDK,this.sdk.setStorageType(o),this.sdk.setConfig({aid:t,scene:c,certType:s,signVersion:r}),this.sdk.start(),this.securityCertType=s,this.securityScene=c}},{key:"sign",value:function(e){return(0,I.__awaiter)(this,void 0,void 0,c().mark((function t(){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.cryptoSDK.sign({sign_data:e,certType:this.securityCertType,scene:this.securityScene});case 2:return n=t.sent,o=this.sdk.convertBase64ToString(n),t.abrupt("return",JSON.parse(o));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getCert",value:function(){return(0,I.__awaiter)(this,void 0,void 0,c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sdk.cryptoSDK.getCertificate({certType:this.securityCertType,scene:this.securityScene}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getTsSign",value:function(){return(0,I.__awaiter)(this,void 0,void 0,c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sdk.cryptoSDK.getTSSign({certType:this.securityCertType,scene:this.securityScene}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getTicket",value:function(){return(0,I.__awaiter)(this,void 0,void 0,c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sdk.cryptoSDK.getTicket({certType:this.securityCertType,scene:this.securityScene}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"setSignValue",value:function(e){return(0,I.__awaiter)(this,void 0,void 0,c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.sdk.cryptoSDK.setSignValue({sign:e,scene:this.securityScene});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getCertSignRequest",value:function(){return(0,I.__awaiter)(this,void 0,void 0,c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sdk.cryptoSDK.getCertSignRequest());case 1:case"end":return e.stop()}}),e,this)})))}}]),n}(S),j=new(u())([[M.m.IMCMD.SEND_MESSAGE,["send_message_body","content","conversation_id","conversation_short_id"]],[M.m.IMCMD.CREATE_CONVERSATION_V2,["create_conversation_v2_body","avatar_url","idempotent_id","name","participants"]],[M.m.IMCMD.ADD_CONVERSATION_PARTICIPANTS,["conversation_add_participants_body","conversation_id","conversation_short_id","participants"]]]),A=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"install",value:function(){this.isCertAuth&&this.register(T.Uk.SecurityProxy,new B(this.ctx))}},{key:"sendPacket",value:function(e){return(0,I.__awaiter)(this,void 0,void 0,c().mark((function t(){var n,o,r,i,s,a,d,u,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isCertAuth){t.next=22;break}if(n=this.ctx.option,o=n.cert,r=n.tsSign,e.sdk_cert=o||"",e.ts_sign=r||"",!j.has(e.cmd)){t.next=22;break}return i=j.get(e.cmd),s=i[0],a=_()(i).call(i,1),v()(a).call(a),d=[],h()(a).call(a,(function(t){var n,o,r,i=null===(o=e.body)||void 0===o?void 0:o[s],a=null!==(r=null==i?void 0:i[t])&&void 0!==r?r:"",c=y()(a)?b()(a).call(a,String).join(","):C.isLong(a)?String(a):a;d.push(O()(n="".concat(t,"=")).call(n,c))})),t.prev=11,t.next=14,this.resolve(T.Uk.SecurityProxy).sign(d.join("&"));case 14:u=t.sent,l=u.req_sign,e.reuqest_sign=l,t.next=22;break;case 19:t.prev=19,t.t0=t.catch(11),R.Y.ctxWarn(this.ctx,"request sign fail",t.t0);case 22:return t.abrupt("return",e);case 23:case"end":return t.stop()}}),t,this,[[11,19]])})))}},{key:"isCertAuth",get:function(){var e;return this.ctx.option.authType&&w()(e=[M.m.AuthType.CERT_AUTH,M.m.AuthType.PASSPORT_CERT_AUTH]).call(e,this.ctx.option.authType)}}]),n}(P.v)},44304:function(e,t){!function(e){"use strict";var t="function"==typeof WeakMap,n=Object.keys;function o(e,t){return e===t||e!=e&&t!=t}function r(e){return e.constructor===Object||null==e.constructor}function i(e){return!!e&&"function"==typeof e.then}function s(e){return!(!e||!e.$$typeof)}function a(){var e=[];return{delete:function(t){for(var n=0;n<e.length;++n)if(e[n][0]===t)return void e.splice(n,1)},get:function(t){for(var n=0;n<e.length;++n)if(e[n][0]===t)return e[n][1]},set:function(t,n){for(var o=0;o<e.length;++o)if(e[o][0]===t)return void(e[o][1]=n);e.push([t,n])}}}var c=t?function(){return new WeakMap}:a;function d(e){return function(t){var n=e||t;return function(e,t,o,r,i,s,a){void 0===a&&(a=c());var d=!!e&&"object"==typeof e,u=!!t&&"object"==typeof t;if(d!==u)return!1;if(!d&&!u)return n(e,t,a);var l=a.get(e);if(l&&a.get(t))return l===t;a.set(e,t),a.set(t,e);var _=n(e,t,a);return a.delete(e),a.delete(t),_}}}function u(e,t,n,o){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n(e[r],t[r],r,r,e,t,o))return!1;return!0}function l(e,t,n,o){var r=e.size===t.size;if(r&&e.size){var i={},s=0;e.forEach((function(a,c){if(r){var d=!1,u=0;t.forEach((function(r,l){d||i[u]||(d=n(c,l,s,u,e,t,o)&&n(a,r,c,l,e,t,o))&&(i[u]=!0),u++})),s++,r=d}}))}return r}var _="_owner",p=Function.prototype.bind.call(Function.prototype.call,Object.prototype.hasOwnProperty);function v(e,t,o,r){var i=n(e),a=i.length;if(n(t).length!==a)return!1;if(a)for(var c=void 0;a-- >0;){if((c=i[a])===_){var d=s(e),u=s(t);if((d||u)&&d!==u)return!1}if(!p(t,c)||!o(e[c],t[c],c,c,e,t,r))return!1}return!0}var g="g"===/foo/g.flags?function(e,t){return e.source===t.source&&e.flags===t.flags}:function(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex};function h(e,t,n,o){var r=e.size===t.size;if(r&&e.size){var i={};e.forEach((function(s,a){if(r){var c=!1,d=0;t.forEach((function(r,u){c||i[d]||(c=n(s,r,a,u,e,t,o))&&(i[d]=!0),d++})),r=c}}))}return r}var f="function"==typeof Map,y="function"==typeof Set,m=Object.prototype.valueOf;function b(e){var t="function"==typeof e?e(n):function(e,t,o,r,i,s,a){return n(e,t,a)};function n(e,n,s){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(r(e)&&r(n))return v(e,n,t,s);var a=Array.isArray(e),c=Array.isArray(n);return a||c?a===c&&u(e,n,t,s):(a=e instanceof Date,c=n instanceof Date,a||c?a===c&&o(e.getTime(),n.getTime()):(a=e instanceof RegExp,c=n instanceof RegExp,a||c?a===c&&g(e,n):i(e)||i(n)?e===n:f&&(a=e instanceof Map,c=n instanceof Map,a||c)?a===c&&l(e,n,t,s):y&&(a=e instanceof Set,c=n instanceof Set,a||c)?a===c&&h(e,n,t,s):e.valueOf!==m||n.valueOf!==m?o(e.valueOf(),n.valueOf()):v(e,n,t,s)))}return e!=e&&n!=n}return n}var k=b(),O=b((function(){return o})),x=b(d()),w=b(d(o));e.circularDeepEqual=x,e.circularShallowEqual=w,e.createCustomEqual=b,e.deepEqual=k,e.sameValueZeroEqual=o,e.shallowEqual=O,Object.defineProperty(e,"__esModule",{value:!0})}(t)},82201:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=window:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&module.exports,AMD=__webpack_require__.amdO,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e){return function(t){return new Md5(!0).update(t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.create=function(){return new Md5},e.update=function(t){return e.create().update(t)};for(var t=0;t<OUTPUT_TYPES.length;++t){var n=OUTPUT_TYPES[t];e[n]=createOutputMethod(n)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("md5").update(e,"utf8").digest("hex");if(null===e||e===undefined)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){if(e)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw ERROR;if(null===e)throw ERROR;if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw ERROR;t=!0}for(var o,r,i=0,s=e.length,a=this.blocks,c=this.buffer8;i<s;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),t)if(ARRAY_BUFFER)for(r=this.start;i<s&&r<64;++i)c[r++]=e[i];else for(r=this.start;i<s&&r<64;++i)a[r>>2]|=e[i]<<SHIFT[3&r++];else if(ARRAY_BUFFER)for(r=this.start;i<s&&r<64;++i)(o=e.charCodeAt(i))<128?c[r++]=o:o<2048?(c[r++]=192|o>>6,c[r++]=128|63&o):o<55296||o>=57344?(c[r++]=224|o>>12,c[r++]=128|o>>6&63,c[r++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++i)),c[r++]=240|o>>18,c[r++]=128|o>>12&63,c[r++]=128|o>>6&63,c[r++]=128|63&o);else for(r=this.start;i<s&&r<64;++i)(o=e.charCodeAt(i))<128?a[r>>2]|=o<<SHIFT[3&r++]:o<2048?(a[r>>2]|=(192|o>>6)<<SHIFT[3&r++],a[r>>2]|=(128|63&o)<<SHIFT[3&r++]):o<55296||o>=57344?(a[r>>2]|=(224|o>>12)<<SHIFT[3&r++],a[r>>2]|=(128|o>>6&63)<<SHIFT[3&r++],a[r>>2]|=(128|63&o)<<SHIFT[3&r++]):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++i)),a[r>>2]|=(240|o>>18)<<SHIFT[3&r++],a[r>>2]|=(128|o>>12&63)<<SHIFT[3&r++],a[r>>2]|=(128|o>>6&63)<<SHIFT[3&r++],a[r>>2]|=(128|63&o)<<SHIFT[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=EXTRA[3&t],t>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var e,t,n,o,r,i,s=this.blocks;this.first?t=((t=((e=((e=s[0]-680876937)<<7|e>>>25)-271733879<<0)^(n=((n=(-271733879^(o=((o=(-1732584194^2004318071&e)+s[1]-117830708)<<12|o>>>20)+e<<0)&(-271733879^e))+s[2]-1126478375)<<17|n>>>15)+o<<0)&(o^e))+s[3]-1316259209)<<22|t>>>10)+n<<0:(e=this.h0,t=this.h1,n=this.h2,t=((t+=((e=((e+=((o=this.h3)^t&(n^o))+s[0]-680876936)<<7|e>>>25)+t<<0)^(n=((n+=(t^(o=((o+=(n^e&(t^n))+s[1]-389564586)<<12|o>>>20)+e<<0)&(e^t))+s[2]+606105819)<<17|n>>>15)+o<<0)&(o^e))+s[3]-1044525330)<<22|t>>>10)+n<<0),t=((t+=((e=((e+=(o^t&(n^o))+s[4]-176418897)<<7|e>>>25)+t<<0)^(n=((n+=(t^(o=((o+=(n^e&(t^n))+s[5]+1200080426)<<12|o>>>20)+e<<0)&(e^t))+s[6]-1473231341)<<17|n>>>15)+o<<0)&(o^e))+s[7]-45705983)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(o^t&(n^o))+s[8]+1770035416)<<7|e>>>25)+t<<0)^(n=((n+=(t^(o=((o+=(n^e&(t^n))+s[9]-1958414417)<<12|o>>>20)+e<<0)&(e^t))+s[10]-42063)<<17|n>>>15)+o<<0)&(o^e))+s[11]-1990404162)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(o^t&(n^o))+s[12]+1804603682)<<7|e>>>25)+t<<0)^(n=((n+=(t^(o=((o+=(n^e&(t^n))+s[13]-40341101)<<12|o>>>20)+e<<0)&(e^t))+s[14]-1502002290)<<17|n>>>15)+o<<0)&(o^e))+s[15]+1236535329)<<22|t>>>10)+n<<0,t=((t+=((o=((o+=(t^n&((e=((e+=(n^o&(t^n))+s[1]-165796510)<<5|e>>>27)+t<<0)^t))+s[6]-1069501632)<<9|o>>>23)+e<<0)^e&((n=((n+=(e^t&(o^e))+s[11]+643717713)<<14|n>>>18)+o<<0)^o))+s[0]-373897302)<<20|t>>>12)+n<<0,t=((t+=((o=((o+=(t^n&((e=((e+=(n^o&(t^n))+s[5]-701558691)<<5|e>>>27)+t<<0)^t))+s[10]+38016083)<<9|o>>>23)+e<<0)^e&((n=((n+=(e^t&(o^e))+s[15]-660478335)<<14|n>>>18)+o<<0)^o))+s[4]-405537848)<<20|t>>>12)+n<<0,t=((t+=((o=((o+=(t^n&((e=((e+=(n^o&(t^n))+s[9]+568446438)<<5|e>>>27)+t<<0)^t))+s[14]-1019803690)<<9|o>>>23)+e<<0)^e&((n=((n+=(e^t&(o^e))+s[3]-187363961)<<14|n>>>18)+o<<0)^o))+s[8]+1163531501)<<20|t>>>12)+n<<0,t=((t+=((o=((o+=(t^n&((e=((e+=(n^o&(t^n))+s[13]-1444681467)<<5|e>>>27)+t<<0)^t))+s[2]-51403784)<<9|o>>>23)+e<<0)^e&((n=((n+=(e^t&(o^e))+s[7]+1735328473)<<14|n>>>18)+o<<0)^o))+s[12]-1926607734)<<20|t>>>12)+n<<0,t=((t+=((i=(o=((o+=((r=t^n)^(e=((e+=(r^o)+s[5]-378558)<<4|e>>>28)+t<<0))+s[8]-2022574463)<<11|o>>>21)+e<<0)^e)^(n=((n+=(i^t)+s[11]+1839030562)<<16|n>>>16)+o<<0))+s[14]-35309556)<<23|t>>>9)+n<<0,t=((t+=((i=(o=((o+=((r=t^n)^(e=((e+=(r^o)+s[1]-1530992060)<<4|e>>>28)+t<<0))+s[4]+1272893353)<<11|o>>>21)+e<<0)^e)^(n=((n+=(i^t)+s[7]-155497632)<<16|n>>>16)+o<<0))+s[10]-1094730640)<<23|t>>>9)+n<<0,t=((t+=((i=(o=((o+=((r=t^n)^(e=((e+=(r^o)+s[13]+681279174)<<4|e>>>28)+t<<0))+s[0]-358537222)<<11|o>>>21)+e<<0)^e)^(n=((n+=(i^t)+s[3]-722521979)<<16|n>>>16)+o<<0))+s[6]+76029189)<<23|t>>>9)+n<<0,t=((t+=((i=(o=((o+=((r=t^n)^(e=((e+=(r^o)+s[9]-640364487)<<4|e>>>28)+t<<0))+s[12]-421815835)<<11|o>>>21)+e<<0)^e)^(n=((n+=(i^t)+s[15]+530742520)<<16|n>>>16)+o<<0))+s[2]-995338651)<<23|t>>>9)+n<<0,t=((t+=((o=((o+=(t^((e=((e+=(n^(t|~o))+s[0]-198630844)<<6|e>>>26)+t<<0)|~n))+s[7]+1126891415)<<10|o>>>22)+e<<0)^((n=((n+=(e^(o|~t))+s[14]-1416354905)<<15|n>>>17)+o<<0)|~e))+s[5]-57434055)<<21|t>>>11)+n<<0,t=((t+=((o=((o+=(t^((e=((e+=(n^(t|~o))+s[12]+1700485571)<<6|e>>>26)+t<<0)|~n))+s[3]-1894986606)<<10|o>>>22)+e<<0)^((n=((n+=(e^(o|~t))+s[10]-1051523)<<15|n>>>17)+o<<0)|~e))+s[1]-2054922799)<<21|t>>>11)+n<<0,t=((t+=((o=((o+=(t^((e=((e+=(n^(t|~o))+s[8]+1873313359)<<6|e>>>26)+t<<0)|~n))+s[15]-30611744)<<10|o>>>22)+e<<0)^((n=((n+=(e^(o|~t))+s[6]-1560198380)<<15|n>>>17)+o<<0)|~e))+s[13]+1309151649)<<21|t>>>11)+n<<0,t=((t+=((o=((o+=(t^((e=((e+=(n^(t|~o))+s[4]-145523070)<<6|e>>>26)+t<<0)|~n))+s[11]-1120210379)<<10|o>>>22)+e<<0)^((n=((n+=(e^(o|~t))+s[2]+718787259)<<15|n>>>17)+o<<0)|~e))+s[9]-343485551)<<21|t>>>11)+n<<0,this.first?(this.h0=e+1732584193<<0,this.h1=t-271733879<<0,this.h2=n-1732584194<<0,this.h3=o+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+o<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,o=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,o=this.h3;return[255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&o,o>>8&255,o>>16&255,o>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,t,n,o="",r=this.array(),i=0;i<15;)e=r[i++],t=r[i++],n=r[i++],o+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[63&(e<<4|t>>>4)]+BASE64_ENCODE_CHAR[63&(t<<2|n>>>6)]+BASE64_ENCODE_CHAR[63&n];return e=r[i],o+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))})()},34007:function(e,t,n){"use strict";function o(e,t,n){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),n}n.d(t,{Z:function(){return o}})}}]);