"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([[258],{59771:function(e,t,n){n.d(t,{C:function(){return c}});var o=n(79705),r=n.n(o),a=n(53864),l={role:"TbVeDr9X",roleName:"ykTmvqic",badgePersonel:"W5goZpRf",badgeBusiness:"RyFr3fZ_"},i={Personal:a.createElement("div",{className:l.badgePersonel}),Enterprise:a.createElement("div",{className:l.badgeBusiness})};function c(e){var t=e.className,n=e.userInfo,o=n.customVerify,c=n.enterpriseVerifyReason,s=e.isRoleNameShow,u=void 0===s||s;return a.createElement(a.Fragment,null,(o||c)&&a.createElement("div",{className:r()(l.role,t)},c?i.Enterprise:i.Personal,u&&a.createElement("span",{className:l.roleName,"data-e2e":"badge-role-name"},c||o)))}},52458:function(e,t,n){n.d(t,{X:function(){return u}});var o=n(53864),r=n(85011),a=n(18193),l=n(9909),i=n(20502),c=n(79705),s=n.n(c),u={Close:0,None:1,Divide:2},m=o.memo((function(e){var t=e.onCloseClick,n=e.commentCount,c=e.headerSearchInfo,m=e.tipTextAfter;return o.createElement("div",{className:s()(a.Z.commentHeaderWithSearch,"comment-header-inner-container")},o.createElement("div",{className:s()(a.Z.otherDividWrap,a.Z.searchDividWrap,"comment-header-with-search")},o.createElement(i.Z,c),o.createElement(l.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(r.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:36,height:36,viewBox:"0 0 36 36",className:s()(a.Z.closeSvg,"comment-header-close-btn"),onClick:t})),o.createElement("div",{style:{display:"flex",alignItems:"center"}},o.createElement("span",{className:a.Z.title},"\u5168\u90e8\u8bc4\u8bba(",n,")"),o.createElement("div",{style:{flex:"1",marginBottom:"8px"}},m===u.Divide&&o.createElement("div",{className:a.Z.textDivider}))))})),d=o.memo((function(e){var t=e.onCloseClick,n=e.commentCount,i=e.headerSearchInfo,c=e.tipTextAfter,d=void 0===c?u.Close:c;return(0,o.useMemo)((function(){return!!i&&Boolean(i.text)}),[i])?o.createElement(m,{onCloseClick:t,commentCount:n,headerSearchInfo:i,tipTextAfter:d}):o.createElement("div",{className:s()(a.Z.otherDividWrap,a.Z.oneDividWrap,"comment-header-inner-container")},o.createElement("span",{className:a.Z.title},"\u5168\u90e8\u8bc4\u8bba(",n,")"),d===u.Close&&o.createElement(l.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(r.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:36,height:36,viewBox:"0 0 36 36",className:a.Z.closeSvg,onClick:t}),d===u.Divide&&o.createElement("div",{className:a.Z.textDivider}))}));t.Z=d},20502:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(53864),r=n(94116),a=n(18193),l=n(82109),i=function(e){var t=e.searchHideWords,n=e.searchText,o=e.searchQueryId,r=e.start,a=e.end;return{type:l.w.Search,searchHideWords:t,searchQueryId:o,searchText:n,start:r,end:a,secUid:"",userId:"",hashtagId:"",hashtagName:"",awemeId:"",isCommerce:!1,searchRank:0}},c=o.memo((function(e){var t=e.hintText,n=e.text,l=e.id,c=e.getSearchTextUrl,s=e.onSearchTextClick,u=e.onSearchTextMounted;return o.createElement("div",{className:a.Z.searchInfoTip},o.createElement("span",{className:a.Z.hitText},t),o.createElement(r.Z,{showSearchHighlight:!0,text:n,className:a.Z.actionableText,wrapperClassName:a.Z.actionableTextWrapper,textExtra:[i({searchText:n,searchQueryId:l,start:0,end:n.length})],searchTextClass:a.Z.searchText,getSearchTextUrl:function(e,t){return c({searchText:e,searchId:t,type:"comment-header"})},onSearchTextClick:function(e,t,n,o){return s({searchText:e,searchId:t,searchTextPos:n,type:"comment-header"},o)},onSearchTextMounted:function(e,t,n){u({type:"comment-header",searchId:t,searchText:e,searchTextPos:n})}}))}))},76743:function(e,t,n){n.d(t,{Z:function(){return po}});var o=n(65146),r=n(30673),a=n(64408),l=n(32781),i=n(60260),c=n.n(i),s=n(5594),u=n.n(s),m=n(26447),d=n.n(m),f=n(58144),p=n.n(f),v=n(8e3),g=n.n(v),h=n(94090),y=n.n(h),C=n(11227),E=n.n(C),_=n(8369),w=n.n(_),x=n(34346),k=n.n(x),S=n(56442),b=n.n(S),T=n(53864),N=n(79705),I=n.n(N),Z=n(8761),M=n(92267),D=n(22912),L=n(353),R=n(54867),B=n(36177),A=n(97876),O=n(72603),P=n(56462),U=n(45921),j=n(68393),F=n(13971),W=n(16016),V=n(28712),H=n(25902),K=n(23860),G=n(16591),q=n(88987),z=n(65906),X=n(52458),Q=n(18193),Y=n(20502),J=n(14392),$=n(77060),ee=T.memo((function(e){var t=e.keywordList;return T.createElement("div",{className:Q.Z.searchInfoTip},T.createElement("span",{className:Q.Z.hitText},"\u5927\u5bb6\u90fd\u5728\u641c\uff1a"),k()(t).call(t,(function(e,t){return T.createElement(T.Fragment,null,e&&!(0,J.y2)(e,5)?T.createElement($.a,{className:Q.Z.seoSearchText,href:globalThis.xssNamespace.douyin_web.filterUrl("".concat("https://www.douyin.com/search/").concat(e),null,{logType:"js.href/src",mode:"black",reportOnly:!1}),target:"_blank",isNeedSeoOpt:!0,key:t},T.createElement("span",{className:Q.Z.text},e)):T.createElement("span",{className:Q.Z.seoSearchText},T.createElement("span",{className:Q.Z.text},e)))})))})),te=n(67161),ne=n(30906),oe=n(83400),re=n(83901),ae=n(68060),le=n(50799),ie=n(5277),ce=n(9191),se=n(71116),ue=n(44833),me=n(67495),de=n(15909),fe=n(38660),pe=n(30978),ve=n(70580),ge=n(57915),he=n(67623),ye=n(41522),Ce={dark:"bVJhtjCU",commentMessage:"xkODIK7R",message:"Yu2LMuqT",close:"H1BjGCYc",container:"Npz7CPXj",noRadius:"UBgfYMF_",inputContainer:"pOcGUDMb",input:"_3c299taS",rightCt:"ZYKj4kJN",exceedNum:"j5Vhnijd",icons:"XAze1wis",emojiIcon:"NuhOyNYu",publishBtn:"OGIa7O6a",isSelected:"hinmVnRg",disable:"_xUFVG14",publishRedBtn:"ZUkCSg5u",atBox:"f6Bc2F0w",isSwiper:"qVgLwbVH",isSearch:"QcLQkzJO",emoticonsBox:"a9x8J4le",selectedEmoticons:"leiWQS3W",hidden:"CUNjlBqO"},Ee=n(17291),_e=n(21155),we=n.n(_e),xe=n(88743),ke=n.n(xe),Se=n(32487),be={container:"gETXElOH",imgWrap:"dXGx1zv9"},Te=function(e){var t,n=[],o={};return we()(t=ke()(e)).call(t,(function(e){o[e.originUri]||1===e.hide||(n.push(e),o[e.originUri]=!0)})),n},Ne=Te((0,Se.kv)());function Ie(e){var t=e.onClick,n=(0,T.useState)(Te(Ne)),o=(0,l.Z)(n,2),r=o[0],i=o[1],c=function(e){return function(n){t(e,n)}};return(0,T.useEffect)((function(){(0,a.Z)(u().mark((function e(){var t,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Se.zk)();case 2:t=e.sent,n=t.statusCode,o=t.data,0===n&&(Ne=Te(o),i(Ne));case 6:case"end":return e.stop()}}),e)})))()}),[]),T.createElement("div",{className:be.container},k()(r).call(r,(function(e){return T.createElement("span",{className:be.imgWrap,onClick:c({name:e.name}),key:e.name},T.createElement("img",{src:globalThis.xssNamespace.douyin_web.filterUrl(e.img,null,{logType:"js.href/src",mode:"black",reportOnly:!1})}))})))}var Ze="Czj8kLDK",Me="oYaAD_fv";function De(e,t){var n=e.className,o=e.onEmojiClick,r=e.isActive,a=(e.refOuterContainer,(0,T.useRef)(null));return(0,T.useEffect)((function(){r&&(0,Ee.X)({top:0,left:0},a.current)}),[r]),T.createElement("div",{className:I()(Ze,n,"emoji-card-outer-container"),ref:t},T.createElement("div",{className:Me,ref:a},T.createElement(Ie,{onClick:o})))}var Le=(0,T.forwardRef)(De),Re=n(30974),Be=n(42223),Ae=n(33120);var Oe=n(94116),Pe=n(9909),Ue=n(19909),je=n(7786),Fe=n(12827),We=A.EVENT,Ve="\u7559\u4e0b\u4f60\u7684\u7cbe\u5f69\u8bc4\u8bba\u5427",He="\u7559\u4e0b\u4f60\u7684\u8bc4\u8bba\u5427",Ke=100;function Ge(e){var t,n,i,c,s,m,f=e.placeHolder,p=e.className,v=e.puhlishCommentItem,g=e.fetchCommentMetionList,h=e.level,C=e.levelOneCid,_=e.cid,w=e.publishComment,x=e.isSwiper,k=void 0!==x&&x,S=e.isSearch,b=void 0!==S&&S,N=e.isCollapse,Z=void 0!==N&&N,M=e.awemeInfo,D=e.isShowComment,L=void 0===D||D,R=e.commentLoadedTime,B=void 0===R?d()():R,P=e.shortcutDisable,U=e.reportExtraParams,j=void 0===U?{}:U,F=e.replyText,W=e.cancelReplyFn,V=e.setShowTrayPushGuide,H=(0,T.useRef)(null),K=(0,T.useRef)(null),G=(0,T.useRef)(!1),q=(0,T.useState)(!1),z=(0,l.Z)(q,2),X=z[0],Q=z[1],Y=(0,T.useState)(!1),J=(0,l.Z)(Y,2),$=J[0],ee=J[1],te=(0,T.useState)(!1),Ee=(0,l.Z)(te,2),_e=Ee[0],xe=Ee[1],ke=(0,T.useState)(0),Se=(0,l.Z)(ke,2),be=Se[0],Te=Se[1],Ne=(0,T.useState)(!1),Ie=(0,l.Z)(Ne,2),Ze=Ie[0],Me=Ie[1],De=(0,T.useState)(!1),Ge=(0,l.Z)(De,2),qe=Ge[0],ze=Ge[1],Xe=(0,T.useRef)(be>0),Qe=F!==undefined&&f,Ye=(0,T.useRef)(0),Je=(0,T.useRef)(!1),$e=f||(b||Z?He:Ve);Qe&&($e=b||Z?He:Ve),(0,T.useEffect)((function(){be>0&&(ze(!0),A.emit(We.videoStopPlayNext)),0===be&&qe&&A.emit(We.videoRemoveStopPlayNext),Xe.current=be>0}),[be>0]),(0,T.useEffect)((function(){return function(){return Xe.current&&A.emit(We.videoRemoveStopPlayNext)}}),[]);var et=(0,T.useContext)(Ue.X),tt=et.toast,nt=et.isActive,ot=et.abtestData,rt=(0,T.useState)(!1),at=(0,l.Z)(rt,2),lt=at[0],it=at[1],ct=(0,T.useCallback)((0,a.Z)(u().mark((function e(){var t,n,o,r,a,l,i,c,s,m,f,p,g,y,x,k,S,b;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=H.current.getCommentInfo(),n=t.text,o=t.textExtra,$){e.next=4;break}return(null==n?void 0:n.length)>Ke&&tt("\u5b57\u6570\u8d85\u8fc7\u9650\u5236"),e.abrupt("return");case 4:if(!/^\s+$/.test(n)){e.next=7;break}return tt("\u8868\u8fbe\u4f60\u7684\u6001\u5ea6\u518d\u8bc4\u8bba\u5427"),e.abrupt("return");case 7:if(!G.current){e.next=9;break}return e.abrupt("return");case 9:return G.current=!0,(r=(0,ie.G6)())?null===(a=H.current)||void 0===a||null===(l=a.clearInput)||void 0===l||l.call(a):it(!0),e.next=14,v({text:n,textExtra:o,replyId:1===h&&_||2===h&&C||undefined,replyToReplyId:2===h&&_||undefined,commentSendCelltime:d()()-Ye.current,commentVideoCelltime:Ye.current-B});case 14:i=e.sent,c=i.statusCode,s=i.comment,m=i.statusMsg,Je.current=!1,r||it(!1),c?tt(E()(f=ae.statusMsg).call(f,m)?m:"\u53d1\u5e03\u8bc4\u8bba\u5931\u8d25"):(null==V||V(!0),tt("\u5df2\u53d1\u5e03"),r||(null===(y=H.current)||void 0===y||null===(x=y.clearInput)||void 0===x||x.call(y),null===(k=H.current)||void 0===k||null===(S=k.blur)||void 0===S||S.call(k)),A.emit(A.EVENT.videoRemoveStopPlayNext),null==w||w(s),Ae.Z.sendLog("postComment",(0,ne.Z)((0,ne.Z)({urlParamList:["previous_page","enter_method"],author_id:"".concat(null==M?void 0:M.authorUserId),group_id:null==M?void 0:M.awemeId,log_pb:null==M?void 0:M.logPb,enter_from:(0,O.mo)(),reply_comment_id:_||"",is_full_webscreen:je.s.getIsPageFullscreen()?"1":"0",tab_name:le.getTabName()||(0,ce.Rs)("tab_name")||"",from_follow_list:null!==(p=se.Le.getConfig(se.gI.FromFollowList))&&void 0!==p&&p.tag?"1":"0",aweme_type:null==M?void 0:M.awemeType,reply_to_comment_id:1===h&&_||2===h&&C||"",item_duration_ms:(null==M||null===(g=M.video)||void 0===g?void 0:g.duration)||0},(0,ue.t)()),j)),(0,oe.Jt)(M)&&(b=(0,oe.Rx)(M),(0,re.E)("comment",{tag:(0,me.f)(),value:b.creative_id,log_extra:b.log_extra}))),G.current=!1;case 22:case"end":return e.stop()}}),e)}))),[$,h,_,C,w,j,M,v,B,tt]);(0,T.useEffect)((function(){var e=function(){Q(!1),xe(!1)};return document.addEventListener("click",e,!1),function(){document.removeEventListener("click",e,!1)}}),[]);var st=(0,T.useCallback)((function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),xe(!1)}),[]);(0,T.useEffect)((function(){var e;return _&&(null===(e=H.current)||void 0===e?void 0:e.focus())}),[_]);var ut=(0,T.useCallback)((function(){Ae.Z.sendLog("inputText",{author_id:"".concat(null==M?void 0:M.authorUserId),group_id:null==M?void 0:M.awemeId,log_pb:null==M?void 0:M.logPb,enter_from:(0,O.vM)(),click_position:_?"reply":"comment"}),Je.current||(Ye.current=d()(),Je.current=!0)}),[_,M]);(0,T.useEffect)((function(){return(0,de.vP)((function(){var e,t;return null===(e=H.current)||void 0===e||null===(t=e.blur)||void 0===t?void 0:t.call(e)})),function(){return(0,de.xC)(blur)}}),[]),(0,T.useEffect)((function(){var e;!L&&null!==(e=H.current)&&void 0!==e&&e.blur()}),[L]),(0,T.useEffect)((function(){var e=function(e){var t;"video_detail"!==(0,O.yW)()&&nt&&("Enter"!==e.code||!L&&k||(null===(t=H.current)||void 0===t||t.focus(),(0,fe.hB)(),!k&&A.emit(A.EVENT.commentFocus)))};return!P&&!_&&document.addEventListener("keydown",e),function(){return!P&&!_&&document.removeEventListener("keydown",e)}}),[_,L,k,P,nt]);var mt=function(e){var t=e.fetchCommentMetionList,n=e.setIsAtIconSelected,o=e.isEmojiIconSelected,i=e.setIsEmojiIconSelected,c=e.awemeInfo,s=e.editorRef,m=e.focusInputTimeRef,f=e.isInputFocusRef,p=(0,T.useRef)([]),v=(0,T.useState)(!1),g=(0,l.Z)(v,2),h=g[0],C=g[1],E=(0,T.useState)({statusCode:0,hasMore:!0,hasFetchData:!1,data:[],preQueryIds:"",searchText:""}),_=(0,l.Z)(E,2),w=_[0],x=_[1],k=(0,T.useState)({statusCode:0,cursor:0,hasMore:!0,hasFetchData:!1,data:[]}),S=(0,l.Z)(k,2),b=S[0],N=S[1],I=(0,T.useCallback)((0,a.Z)(u().mark((function e(){var n,o,a,l,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b.hasMore){e.next=10;break}return e.next=3,t({needPage:!0,cursor:b.cursor,count:20});case 3:n=e.sent,o=n.statusCode,a=n.userList,l=n.cursor,i=n.hasMore,we()(a).call(a,(function(e){e.name=e.nickname})),N(0===o?function(e){var t;return e.cursor!==b.cursor?(0,ne.Z)({},e):{statusCode:0,cursor:l,hasMore:i,hasFetchData:!0,data:y()(t=[]).call(t,(0,r.Z)(e.data),(0,r.Z)(a))}}:function(e){return e.cursor!==b.cursor?(0,ne.Z)({},e):(0,ne.Z)((0,ne.Z)({},e),{},{statusCode:o,data:(0,r.Z)(e.data)})});case 10:case"end":return e.stop()}}),e)}))),[b]),Z=(0,T.useCallback)(function(){var e=(0,a.Z)(u().mark((function e(t){var n,o,r,a,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Be.nf)({cursor:20,query:t,penetrateParams:(null==w?void 0:w.searchText)===t?{pre_query_ids:p.current.join()}:null});case 2:n=e.sent,o=n.statusCode,r=n.userList,a=[],we()(r).call(r,(function(e){a.push(e.uid)})),(null==w?void 0:w.searchText)===t?(l=p.current).push.apply(l,a):p.current=a,x((function(e){var n;return{statusCode:o,searchText:t,hasMore:20===(null==r?void 0:r.length),hasFetchData:!1,data:(null==e?void 0:e.searchText)!==t?r:y()(n=[]).call(n,null==e?void 0:e.data,r)}}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[w]),M=function(){var e=(0,a.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.stopPropagation(),o&&i(!1),Ae.Z.sendLog("atPanelClick",{group_id:null==c?void 0:c.awemeId,enter_from:(0,O.vM)()}),n((function(e){var t,n;return null===(t=s.current)||void 0===t||t.focus(),null===(n=s.current)||void 0===n||n.addAtIcon(),A.emit(A.EVENT.videoStopPlayNext),!0})),C(!0),f.current||(m.current=d()(),f.current=!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{loadMoreDefaultAtData:I,loadSearchAtData:Z,handleAtIconClick:M,atUserDefaultData:b,atUserSearchData:w,isAtIconPoint:h,setIsAtIconPoint:C}}({fetchCommentMetionList:g,setIsAtIconSelected:Q,isEmojiIconSelected:_e,setIsEmojiIconSelected:xe,awemeInfo:M,editorRef:H,focusInputTimeRef:Ye,isInputFocusRef:Je}),dt=mt.loadMoreDefaultAtData,ft=mt.loadSearchAtData,pt=mt.handleAtIconClick,vt=mt.atUserDefaultData,gt=mt.atUserSearchData,ht=mt.isAtIconPoint,yt=mt.setIsAtIconPoint,Ct=function(e){var t=e.isAtIconSelected,n=e.setIsAtIconSelected,o=e.awemeInfo,r=e.setIsEmojiIconSelected,l=e.isInputFocusRef,i=e.focusInputTimeRef,c=e.editorRef,s=function(){var e=(0,a.Z)(u().mark((function e(a){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==a||a.stopPropagation(),t&&n(!1),r((function(e){return e||Ae.Z.sendLog("emojiTabShow",{author_id:"".concat(null==o?void 0:o.authorUserId),group_id:null==o?void 0:o.awemeId,log_pb:null==o?void 0:o.logPb,enter_from:(0,O.vM)(),tab_name:"system"}),!e})),l.current||(i.current=d()(),l.current=!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=(0,T.useCallback)((function(e,t){null==t||t.preventDefault(),c.current.addEmoji({text:e.name}),Ae.Z.sendLog("clickEmoji",{author_id:"".concat(null==o?void 0:o.authorUserId),group_id:null==o?void 0:o.awemeId,log_pb:null==o?void 0:o.logPb,enter_from:(0,O.vM)(),tab_name:"system"})}),[]);return{handleEmojiIconClick:s,handleEmojiSelected:m}}({isAtIconSelected:X,setIsAtIconSelected:Q,awemeInfo:M,setIsEmojiIconSelected:xe,isInputFocusRef:Je,focusInputTimeRef:Ye,editorRef:H}),Et=Ct.handleEmojiIconClick,_t=Ct.handleEmojiSelected;return T.createElement("div",{className:I()(p),style:{height:"100%"},ref:K,onClick:st},Qe&&T.createElement("div",{className:Ce.commentMessage},T.createElement("div",{className:Ce.message},T.createElement(Oe.Z,{text:y()(t="".concat(f,": ")).call(t,(0,pe.LT)(F)),className:Ce.message})),T.createElement(Pe.Z,{width:12,height:12,src:globalThis.xssNamespace.douyin_web.filterUrl(ye.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),viewBox:"0 0 12 12",className:Ce.close,onClick:W})),T.createElement("div",{className:I()(Ce.container,"comment-input-inner-container",(n={},(0,o.Z)(n,Ce.inputFocusContainer,Ze),(0,o.Z)(n,Ce.noRadius,Qe),(0,o.Z)(n,"comment-input-container-focus",Ze),n))},T.createElement("div",{className:Ce.inputContainer,onKeyDown:function(e){var t;A.emit(A.EVENT.golbalEventPrevented),e.stopPropagation(),E()(t=["Tab","PageUp","PageDown"]).call(t,e.code)&&!window.a11ySwitch&&e.preventDefault()}},T.createElement(Re.Z,{placeholder:$e,ref:H,onChange:function(e){H.current&&(Te(e.length),0<e.length&&e.length<=Ke?$||ee(!0):$&&ee(!1))},loadSearchAtData:ft,atUserDefaultData:vt,loadMoreDefaultAtData:dt,atUserSearchData:gt,onEditFocus:function(){Me(!0),xe(!1),ut()},handlePublishClick:ct,onEditBlur:function(){return Me(!1)},awemeInfo:M,isAtIconSelected:X,setIsAtIconSelected:Q,refOuterContainer:K,isAtIconPoint:ht,setIsAtIconPoint:yt,readOnly:lt||!nt})),T.createElement("div",{className:I()(Ce.rightCt,"commentInput-right-ct")},T.createElement("div",{className:Ce.icons},Ke<be&&T.createElement("p",{className:Ce.exceedNum},"-",be-Ke),T.createElement("span",{className:I()((i={},(0,o.Z)(i,Ce.isSelected,X),(0,o.Z)(i,Ce.disable,lt),i)),onClick:function(e){lt||pt(e)}},T.createElement(Pe.Z,{width:36,height:36,src:globalThis.xssNamespace.douyin_web.filterUrl(ve.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1})})),T.createElement("span",{className:I()((c={},(0,o.Z)(c,Ce.isSelected,_e),(0,o.Z)(c,Ce.disable,lt),c)),onClick:function(e){lt||Et(e)}},T.createElement(Pe.Z,{width:36,height:36,src:globalThis.xssNamespace.douyin_web.filterUrl(ge.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1})})),T.createElement("span",{className:I()(Ce.publishBtn,(0,o.Z)({},Ce.publishRedBtn,$)),onClick:ct},T.createElement(Pe.Z,{width:36,height:36,src:globalThis.xssNamespace.douyin_web.filterUrl(he.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1})})))),T.createElement(Fe.r,null,null!=ot&&ot.rightCardOpt?_e&&T.createElement(Le,{className:I()(Ce.emoticonsBox,(s={},(0,o.Z)(s,Ce.isSwiper,k),(0,o.Z)(s,Ce.isSearch,b),(0,o.Z)(s,Ce.hidden,!_e),s)),onEmojiClick:_t,isActive:_e,refOuterContainer:K}):T.createElement(Le,{className:I()(Ce.emoticonsBox,(m={},(0,o.Z)(m,Ce.isSwiper,k),(0,o.Z)(m,Ce.isSearch,b),(0,o.Z)(m,Ce.hidden,!_e),m)),onEmojiClick:_t,isActive:_e,refOuterContainer:K}))))}var qe={container:"UG3Qllwi",textContainer:"bEbuPqHn",loginText:"E8KC3l73"},ze=n(31554);function Xe(e){var t=e.cid,n=e.fullScreenTarget,o=e.changeLoginStatus;return T.createElement("div",{className:I()(qe.container,"comment-input-un-login-container"),onClick:function(e){var r,l,i,c;null==e||null===(r=e.preventDefault)||void 0===r||r.call(e),(0,ze.default)({success:(c=(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o?o():window.location.reload();case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)}),enterMethod:t?"reply":"comment",headerText:"\u767b\u5f55\u5373\u53ef\u53d1\u8868\u8bc4\u8bba",next:"https://".concat(null===(l=window)||void 0===l||null===(i=l.location)||void 0===i?void 0:i.host)},(0,H.r)()&&n)}},T.createElement("div",{className:qe.textContainer},"\u8bf7\u5148",T.createElement("span",{className:qe.loginText},"\xa0\u767b\u5f55\xa0"),"\u540e\u53d1\u8868\u8bc4\u8bba"))}var Qe={container:"rrc1h__I",textContainer:"q9UYeCXb",loginText:"lAErgjuQ"};function Ye(e){var t=e.awemeInfo;return T.createElement("div",{className:Qe.container,onClick:function(){A.emit(A.EVENT.videoPause),Ae.Z.sendLog("xiguaPostCommentClick",{author_id:null==t?void 0:t.authorUserId,group_id:null==t?void 0:t.awemeId}),window.open((0,W.Tl)({videoid:null==t?void 0:t.awemeId,param:"comment_focus",value:"1"}))}},T.createElement("div",{className:Qe.textContainer},"\u524d\u5f80",T.createElement("span",{className:Qe.loginText},"\xa0\u897f\u74dc\u89c6\u9891\xa0"),"\u53d1\u5e03\u8bc4\u8bba"))}var Je=["isLogin"];function $e(e){var t,n,o=e.isLogin,r=void 0===o||o,a=(0,te.Z)(e,Je);return r?(null==a||null===(t=a.awemeInfo)||void 0===t?void 0:t.awemeType)===B.ed.XgVideo?T.createElement(Ye,{awemeInfo:null==a?void 0:a.awemeInfo}):T.createElement(Ge,a):(null==a||null===(n=a.awemeInfo)||void 0===n?void 0:n.awemeType)===B.ed.XgVideo?T.createElement(Ye,{awemeInfo:null==a?void 0:a.awemeInfo}):T.createElement(Xe,a)}var et=n(85792),tt=n.n(et),nt=n(77386),ot=n.n(nt),rt=n(95138),at=n(33389),lt=n(80704),it=n(4836),ct=n(13795),st={loginButtonShow:{eventName:"login_button_show",params:{enter_from:(0,O.vM)(),page_type:(0,O.yW)()}},loginButtonClick:{eventName:"login_button_click",params:{enter_from:(0,O.vM)(),page_type:(0,O.yW)(),action:""}},commentLoginGuideShow:{eventName:"comment_login_guide_show",params:{enter_from:(0,O.yW)(),page_type:(0,O.yW)()}},commentLoginGuideClick:{eventName:"comment_login_guide_click",params:{enter_from:(0,O.yW)(),action:""}}},ut=new ct.hD(st),mt=n(76335),dt=function(e){var t=e.success,n=void 0===t?null:t,o=e.host,r=void 0===o?null:o,i=e.next,c=void 0===i?null:i,s=e.enterMethod,m=void 0===s?"comment_login_guide":s,d=e.destroy,f=void 0===d?null:d,p=e.change,v=void 0===p?null:p,g=e.commentLoginType,h=void 0===g?"":g,y=(0,T.useRef)(null),C=(0,T.useRef)(null),E=(0,T.useState)(!1),_=(0,l.Z)(E,2),w=_[0],x=_[1],k=function(){var e;v("none"),null===(e=C.current)||void 0===e||e.call(C),null==f||f()},S=function(){var e=(0,a.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt.h.getVar({name:"short_link_login_new",defaultValue:0});case 2:t=e.sent,x(Boolean(!t));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(e){e.stopPropagation()};(0,T.useEffect)((function(){return function(){var e,t;null===(e=C.current)||void 0===e||e.call(C),null==y||null===(t=y.current)||void 0===t||t.remove(),null==f||f()}}),[]),(0,T.useEffect)((function(){ut.sendLog("commentLoginGuideShow"),S()}),[]);var N=T.useCallback(function(){var e=(0,a.Z)(u().mark((function e(t){var o,a,l,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return o=function(){return T.createElement("div",{className:"scan"},T.createElement("div",{className:"scan__title",onClick:b},"\u6253\u5f00\u3010\u6296\u97f3APP\u3011\u626b\u63cf\u4e8c\u7ef4\u7801"),T.createElement("div",{className:"scan__desc",onClick:b},"\u767b\u5f55\u540e\u5373\u53ef\u53c2\u4e0e\u53d1\u5e03\u8ba8\u8bba\uff0c\u89c6\u9891\u63a8\u8350\u66f4\u4e2a\u6027\u5316\u54e6"),T.createElement(rt.zx,{className:"scan__button",onClick:function(e){var t,n;e.stopPropagation(),ut.sendLog("commentLoginGuideClick",{action:"login"}),"force_login"!==h&&k(),(0,ze.default)({headerText:"\u767b\u5f55\u5373\u53ef\u53d1\u8868\u8bc4\u8bba",success:function(e){var t;tt()(k,0),null==a||null===(t=a.success)||void 0===t||t.call(a,e),null==v||v("none")},enterMethod:"comment_login_guide",next:"https://".concat(null===(t=window)||void 0===t||null===(n=t.location)||void 0===n?void 0:n.host),isActive:"1"}),ut.sendLog("loginButtonClick",{action:"login"})}},"\u7acb\u5373\u767b\u5f55"),"force_login"!==h?T.createElement(rt.zx,{className:"scan__button scan__button-continue",onClick:function(){k(),ut.sendLog("commentLoginGuideClick",{action:"continue"})}},"\u7ee7\u7eed\u770b\u8bc4\u8bba"):null)},e.next=5,(0,it.gE)({success:n,host:r,next:c,ScanCodeDescription:o,enterMethod:m});case 5:return a=e.sent,e.next=8,(0,it.j1)();case 8:l=e.sent,null!==at.n&&void 0!==at.n&&at.n.loginGuideShowed&&at.n.destroy(),i=new l((0,ne.Z)((0,ne.Z)({},a),{},{success:function(e){null!=e&&e.redirect_url?ot().get(null==e?void 0:e.redirect_url).then((function(){var t;tt()(k,0),null==a||null===(t=a.success)||void 0===t||t.call(a,e),null==v||v("none"),(0,lt.ev)()})).catch((function(){k()})):k()},ele:t})),C.current=i.init();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return T.createElement("div",{className:I()("recommend-comment-login",{"recommend-comment-login-mask":"login_guide"===h,"show-icon":w}),ref:y,onClick:function(e){e.stopPropagation()}},T.createElement("div",{className:"recommend-comment-login__contain",ref:N}))},ft=function(e){var t=e.success,n=void 0===t?null:t,o=(e.enterMethod,e.destroy),r=void 0===o?null:o,a=e.change,l=void 0===a?null:a,i=(0,T.useRef)(null),c=function(){var e;null==i||null===(e=i.current)||void 0===e||e.remove(),null==r||r()};return(0,T.useEffect)((function(){ut.sendLog("loginButtonShow")}),[]),T.createElement("div",{className:"video-comment-high",ref:i},T.createElement("div",{className:"video-comment-high__contain"},T.createElement("div",{className:"video-comment-high__contain__desc"},"\u767b\u5f55\u540e\u5373\u53ef\u67e5\u770b\u6240\u6709\u7cbe\u5f69\u8bc4\u8bba\uff0c\u8fd8\u53ef\u4ee5\u53c2\u4e0e\u89c6\u9891\u8ba8\u8bba\u54e6"),T.createElement(rt.zx,{className:"video-comment-high__contain__btn",children:"\u7acb\u5373\u767b\u5f55",onClick:function(){var e,t;(0,ze.default)({success:function(){tt()(c,0),null==n||n(),null==l||l("")},enterMethod:"comment_login_button",next:"https://".concat(null===(e=window)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.host)}),ut.sendLog("loginButtonClick")}})))},pt=function(e){var t=e.success,n=void 0===t?null:t,o=(e.enterMethod,e.destroy),r=void 0===o?null:o,a=e.change,l=void 0===a?null:a,i=(e.commentLoginType,(0,T.useRef)(null)),c=function(){var e;null==i||null===(e=i.current)||void 0===e||e.remove(),null==r||r()};return(0,T.useEffect)((function(){ut.sendLog("commentLoginGuideShow")}),[]),T.createElement("div",{className:"video-comment-cover",ref:i,onClick:c},T.createElement("div",{className:"video-comment-cover__desc"},"\u767b\u5f55\u540e\u5373\u53ef\u53c2\u4e0e\u53d1\u5e03\u8ba8\u8bba\uff0c\u89c6\u9891\u63a8\u8350\u66f4\u4e2a\u6027\u5316\u54e6"),T.createElement("div",null,T.createElement(rt.zx,{className:"video-comment-cover__btn",onClick:function(e){var t,o;e.stopPropagation(),ut.sendLog("commentLoginGuideClick",{action:"login"}),(0,ze.default)({success:function(){tt()(c,0),null==n||n(),null==l||l("none")},enterMethod:"comment_login_button",next:"https://".concat(null===(t=window)||void 0===t||null===(o=t.location)||void 0===o?void 0:o.host)})}},"\u7acb\u5373\u767b\u5f55"),T.createElement(rt.zx,{className:"video-comment-cover__btn video-comment-cover__btn-no",onClick:function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),ut.sendLog("commentLoginGuideClick",{action:"continue"}),c()}},"\u6682\u4e0d\u767b\u5f55")))},vt=n(75450),gt=n(75422),ht=n(3543),yt=n(51508),Ct=n(51078),Et=n(15272),_t=n(76569),wt=n.n(_t),xt=n(68493),kt=n.n(xt),St=n(67330),bt=n(77679),Tt=n(26895),Nt=n(96716),It=n(43897),Zt=n(66213),Mt={dark:"aLCjn9JR",commentItemContainer:"CDx534Ub",tag:"CxuuPCgG",defaultTag:"Ih3RNQqk",avatar:"V3cGkKvu",contentContainer:"RHiEl2d8",contentMain:"YzbzCgxU",highlight:"xbNYtQnD",highlightDisappear:"GtBKzALz",isReplyItem:"nIN1f9ZQ",hoverShowMoreBtn:"Q7m2YYn9",more:"PDN14l01",activeComment:"Ps732q6l",infoWrap:"AMzEzRWv",nickWrap:"Uvaas5kD",nickname:"nEg6zlpW",nicknameInner:"NCRZnxVF",triggle:"TSOTB1p4",tagWrap:"HzpUp5ZK",timeWrap:"dn67MYhq",contentText:"a9uirtCT",stepOnContainer:"nDA1qEW5",stepOnText:"ApVPdgJQ",warningSvg:"W_sPsvNp",diggAndStepOn:"jtyFqENC",stats:"eJuDTubq",stepOn:"B4ZrPi5y",columnDivider:"z8UmWwH2",reply:"NvTzAVts",noMarginLeft:"BcxjcqYg",isSelected:"lQkE7GWA",moreInfo:"P_2lyP5T",actionText:"VD5Aa1A1",forward:"Hxqn9mhu",hoverRed:"VQCdkeKT",changeColor:"eZlES4jV",timeAndLocation:"L4ozKLf7",opContainer:"rJFDwdFI",statsContainer:"o8AFb5q0",containerOpt:"d1zD0Kmj",diggAndStepOnOpt:"mJhk_9et",shareContainer:"BKLKHmO9",noDivider:"RAKzbn1t",shareButtonLabel:"aTEi6yMl",shareSvg:"Oitt_hzE",shareBox:"BII14pY4",commentInputWrapper:"yBfAEOf6",replyExpandBtn:"zeyRYM2J",replyLine:"_4PgyyVLT",hoverStyle:"SIAdR40d",moreInfoText:"mo3iq7h_",hidden:"LfvV4We8",replyTip:"aZy009E7",replyTipContainer:"ylYMpwSs",replyTipIcon:"oh2Zza5o",stepOnTip:"B5SxNO3v",stepOnTipIcon:"TpNOMqdO",commentAvatar:"GtDHT_OF",replyCommentAvatar:"gxA19W4f",diggSvg:"UGHpJg4D",commentSvg:"gAHTLYk3",replySvg:"fHhcJedC",commentImageList:"dZNywHd7",stickyImageWrapper:"ncpUSdtV",stickyImage:"kVBp1Jf5",commentImageWrapper:"sGlUiqDX",commentImage:"fBRnW2qB"};var Dt=function(e){var t,n,r,a,l,i=e.commentInfo,c=e.awemeInfo,s=e.awemelogPb,u=e.level,m=e.isSpider,d=void 0!==m&&m,f=i.user,p=f.nickname,v=f.avatarUri,g=f.secUid,h=(null==c?void 0:c.awemeType)===B.ed.XgVideo,y=(0,T.useContext)(Ue.X).reportExtraParams;return T.createElement(T.Fragment,null,T.createElement("div",{className:I()(Mt.avatar,"comment-item-avatar")},T.createElement($.a,{href:globalThis.xssNamespace.douyin_web.filterUrl(h?(0,W.GN)(null==i||null===(t=i.user)||void 0===t?void 0:t.uid):(n=s,r=y,l={author_id:null==c||null===(a=c.authorInfo)||void 0===a?void 0:a.uid,group_id:null==c?void 0:c.awemeId,log_pb:n,from_gid:null==c?void 0:c.groupId,enter_from:null==r?void 0:r.enter_from,tab_name:null==r?void 0:r.tab_name},(0,W.HC)(g,"enter_method=comment&".concat((0,St.stringify)(l)))),null,{logType:"js.href/src",mode:"black",reportOnly:!1}),target:"_blank",rel:"noopener noreferrer nofollow",isNeedSeoOpt:!0},T.createElement(Ct.q,{src:globalThis.xssNamespace.douyin_web.filterUrl(v,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),className:I()(Mt.commentAvatar,(0,o.Z)({},Mt.replyCommentAvatar,2===u)),type:2===u?"extraExtraSmall":"extraSmall",alt:"".concat(p,"\u5934\u50cf"),isSpider:d}))))},Lt=n(4668),Rt=n(70609),Bt=n(38518),At=n(85457),Ot=n(9058);var Pt=function(e){var t=e.isSpider,n=e.isDigged,r=e.otherDiggCount,a=e.diggClick,i=e.stepOnClick,c=e.isXgVideo,s=(0,T.useState)(!1),u=(0,l.Z)(s,2),m=u[0],d=u[1],f=(0,T.useRef)(0);return T.createElement(T.Fragment,null,T.createElement("div",{className:Mt.stepOnContainer},T.createElement("div",{className:Mt.stepOnText,onClick:function(){d(!0),f.current&&clearTimeout(f.current),f.current=tt()((function(){d(!1),f.current=0}),2e3)},onMouseOut:function(){d(!1)}},T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(Lt.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:12,height:12,viewBox:"0 0 12 12",className:Mt.warningSvg}),T.createElement("span",null,"\u8be5\u8bc4\u8bba\u88ab\u6298\u53e0")),T.createElement("div",{className:Mt.diggAndStepOn},T.createElement("p",{className:I()(Mt.stats,(0,o.Z)({},Mt.isSelected,n)),onClick:a},!t&&T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(n?Bt.Z:Rt.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:20,height:20,viewBox:"0 0 20 20",className:Mt.diggSvg}),T.createElement("span",null,(0,pe.qe)(r+Number(n)||0))),!c&&T.createElement(Ot.C,{type:"bottom",tipClassName:Mt.stepOnTip,iconClassName:Mt.stepOnTipIcon,showTip:m,setShowTip:d,hoverShow:!1,content:T.createElement("div",null,"\u53d6\u6d88\u70b9\u8e29\u5c55\u5f00\u8bc4\u8bba"),otherHide:!1},T.createElement("p",{className:I()(Mt.stepOn,Mt.isSelected),onClick:i},!t&&T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(At.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:20,height:20,viewBox:"0 0 20 20",className:Mt.diggSvg}))))))},Ut=n(15985),jt=n(19462),Ft=n(78384),Wt=n(84641),Vt=n(30758),Ht=1,Kt=5;var Gt,qt=function(e){var t=e.isLogin,n=e.handleUnLoginClick,r=e.commentInfo,a=e.abtestData,i=e.toast,c=e.awemelogPb,s=e.awemeInfo,u=e.divider,m=(0,T.useRef)(null),d=(0,T.useRef)(-240),f=(0,T.useRef)(0),p=(0,T.useRef)(0),v=(0,T.useRef)(300),g=(0,T.useState)(!1),h=(0,l.Z)(g,2),y=h[0],C=h[1];return(0,T.useEffect)((function(){try{var e,t,n=null===(e=m.current)||void 0===e?void 0:e.closest(".comment-mainContent");if(y&&n)n.style.overflow="hidden",n.style.paddingRight="Windows"===(null===(t=(0,Ft.fV)())||void 0===t?void 0:t.os)?"16px":"";return function(){n&&(n.style.overflow="",n.style.paddingRight="")}}catch(o){}}),[y]),T.createElement("div",{className:I()(Mt.shareContainer,(0,o.Z)({},Mt.noDivider,!u)),ref:m,onClick:function(){var e;if(t){if("undefined"!=typeof r.status&&!E()(e=[Kt,Ht]).call(e,r.status))return i("\u6b64\u8bc4\u8bba\u4e0d\u652f\u6301\u5206\u4eab");if(C(!0),m.current){var o=t?407:295;(null==s?void 0:s.awemeType)===B.ed.XgVideo&&(o=116);var a=m.current.offsetHeight||0,l=m.current.closest(".comment-mainContent");if(l){var c,u,g,h,y=l.getBoundingClientRect(),_=y.x,w=y.y,x=y.bottom,k=null!==(c=null===(u=m.current.getBoundingClientRect())||void 0===u?void 0:u.x)&&void 0!==c?c:0,S=null!==(g=null===(h=m.current.getBoundingClientRect())||void 0===h?void 0:h.y)&&void 0!==g?g:0,b=m.current.getBoundingClientRect().bottom;v.current=Math.min(y.width-24,300),d.current=-Math.min(k-_-12,240);var T=Math.max(S-w-12,0),N=Math.max(x-b-12,0);T>o?(f.current=o,p.current=0):N>o?(f.current=-a,p.current=0):T>N?(f.current=T,p.current=T):(f.current=-a,p.current=N)}}}else n("share_comment")},onMouseLeave:function(){C(!1)}},y?T.createElement("div",{style:{position:"relative",left:"".concat(d.current,"px"),bottom:f.current?"".concat(f.current,"px"):"unset",alignSelf:"start"}},T.createElement(Vt.ZP,{shareShowMethod:"comment",abtestData:a,toast:i,awemelogPb:c,awemeInfo:s,commentInfo:r,hidden:!y,isLogin:Boolean(t),className:I()(Mt.shareBox),shareType:Vt.yw.Comment,handleClose:function(){C(!1)},hideShareContent:!0,shareeListHeight:p.current,width:v.current})):null,u&&T.createElement("div",{className:I()(Mt.columnDivider,"comment-item-stats-columnDivider")}),T.createElement("div",{className:I()(Mt.shareButtonLabel)},T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(Wt.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:20,height:20,className:Mt.shareSvg,viewBox:"0 0 20 20"}),T.createElement("div",null,"\u5206\u4eab")))},zt=n(19672),Xt=n.n(zt),Qt=n(76445),Yt="hTEXC_Q3",Jt="zmlQXx3G",$t=n(66737),en=n(42313),tn=n(3126),nn="JaBemdOZ",on="u2IXEEtg",rn="M3t5K8pF",an="LGbKOQVt",ln="On7uRTRn",cn="QBtVFM4I",sn=n(65902);function un(){return un=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},un.apply(this,arguments)}var mn=function(e){return T.createElement("svg",un({width:48,height:48,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Gt||(Gt=T.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 24c0-8.284 6.716-15 15-15 5.281 0 9.93 2.73 12.603 6.861l-4.015-.803a3 3 0 10-1.177 5.884l10 2a3 3 0 003.462-2.08l3-10a3 3 0 00-5.747-1.724l-.868 2.895C37.467 6.576 31.153 3 24 3 12.402 3 3 12.402 3 24s9.402 21 21 21c9.148 0 16.923-5.848 19.804-14a3 3 0 10-5.657-2c-2.06 5.83-7.62 10-14.147 10-8.284 0-15-6.716-15-15z",fill:"#fff",fillOpacity:.7})))},dn=n(68350),fn=function(e){var t=e.width,n=void 0===t?48:t,o=e.height,r=void 0===o?48:o,a=e.className,l=e.viewBox,i=void 0===l?"0 0 48 48":l;return T.createElement(dn.A,(0,sn.Z)({},e,{width:n,height:r,src:globalThis.xssNamespace.douyin_web.filterUrl(mn,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),id:"semi-icons-refresh",defaultWidth:48,defaultHeight:48,viewBox:i,className:a}))},pn=n(96647),vn=function(e){var t=e.width,n=void 0===t?48:t,o=e.height,r=void 0===o?48:o,a=e.className;return T.createElement(dn.A,(0,sn.Z)({},e,{width:n,height:r,src:globalThis.xssNamespace.douyin_web.filterUrl(pn.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),id:"svg_icon_ic_close",defaultWidth:38,defaultHeight:38,viewBox:"0 0 48 48",className:a}))},gn=["onClose","onRetry","originUrl","previewUrl","className"],hn=function(e){var t=e.onClose,n=e.onRetry,o=e.originUrl,r=e.previewUrl,a=e.className,i=(0,te.Z)(e,gn),c=(0,T.useState)(!0),s=(0,l.Z)(c,2),u=s[0],m=s[1],d=(0,T.useState)(!1),f=(0,l.Z)(d,2),p=f[0],v=f[1],g=(0,T.useState)(r),h=(0,l.Z)(g,2),y=h[0],C=h[1],E=function(){var e=Xt()(o)?o:[o],t=0,n=new Image;n.onload=function(){m(!1),v(!1),C(e[t])},n.onerror=function(){if((t+=1)===e.length)return v(!0),void m(!1);n.src=globalThis.xssNamespace.douyin_web.filterUrl(e[t],null,{logType:"js.href/src",mode:"black",reportOnly:!1})},n.src=globalThis.xssNamespace.douyin_web.filterUrl(e[t],null,{logType:"js.href/src",mode:"black",reportOnly:!1})};(0,T.useLayoutEffect)((function(){E()}),[o]);var _=(0,T.useRef)(null);return(0,T.useEffect)((function(){var e=_.current;if(e){var n=function(n){(0,en.T)(n.target,e)||(n.preventDefault(),n.stopPropagation()),(0,tn.j)(n.key,n.keyCode)&&(null==t||t())};return document.addEventListener("keydown",n,!0),function(){document.removeEventListener("keydown",n,!0)}}}),[t]),T.createElement($t.h,i,T.createElement("div",{className:I()(nn,a),ref:_,onClick:function(e){e.target===_.current&&(null==t||t())}},!p&&u&&T.createElement(gt.g,{className:I()(on,rn)}),p&&T.createElement(fn,{className:I()(on,rn,an),onClick:function(){null==n||n(),v(!1),m(!0),E()}}),T.createElement("img",{className:I()(on,cn),src:globalThis.xssNamespace.douyin_web.filterUrl(y,null,{logType:"js.href/src",mode:"black",reportOnly:!1})}),T.createElement("div",{className:ln,onClick:t},T.createElement(vn,null))))},yn="J14meo4y",Cn="VtLrz6ab",En="yh9_mJPj",_n=["url","onError","wrapperClassName","onRetry"],wn=function(e){var t,n=e.url,r=e.onError,a=e.wrapperClassName,i=e.onRetry,c=(0,te.Z)(e,_n),s=(0,T.useState)(0),u=(0,l.Z)(s,2),m=u[0],d=u[1],f=(0,T.useState)(!1),p=(0,l.Z)(f,2),v=p[0],g=p[1];(0,T.useLayoutEffect)((function(){d(0),g(!1)}),[n]);return T.createElement("div",{className:I()(yn,(t={},(0,o.Z)(t,Cn,v),(0,o.Z)(t,"error",v),t),a)},!v&&T.createElement("img",(0,sn.Z)({},c,{src:globalThis.xssNamespace.douyin_web.filterUrl(n[m],null,{logType:"js.href/src",mode:"black",reportOnly:!1}),onError:function(e){m<n.length-1?d(m+1):(g(!0),null==r||r(e))}})),v&&T.createElement(fn,{className:En,onClick:function(){null==i||i(),d(0),g(!1)}}))};var xn=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.imagePreview,n=e.imageOrigin,o=e.getImageViewerContainer,r=e.className,a=e.previewClassName,i=e.onClick,c=(0,T.useState)(!1),s=(0,l.Z)(c,2),u=s[0],m=s[1],d=(0,T.useState)(),f=(0,l.Z)(d,2),p=f[0],v=f[1],g="showImageViewer";return t&&n?T.createElement("div",{className:I()(Yt,r)},T.createElement(wn,{url:Xt()(t)?t:[t],onClick:function(e){(Xt()(n)&&n.length>0||n)&&(A.emit(A.EVENT.videoStopPlayNext),v(e.target.src),m(!0),(0,Qt.o)({pauseCustomShortcut:!0,pausePlayControlShortcut:!0,pauseGlobalShortcut:!0},g),null==i||i(e))},className:I()(Jt,a)}),u&&T.createElement(hn,{getContainer:o,previewUrl:p,onClose:function(){A.emit(A.EVENT.videoRemoveStopPlayNext),m(!1),(0,Qt.m)(g)},originUrl:n})):null},kn=n(21807),Sn=new ct.hD({cancelLikeComment:{eventName:"cancel_like_comment",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",comment_id:"",comment_user_id:""}},likeComment:{eventName:"like_comment",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",comment_id:"",comment_user_id:"",from_xigua:0,comment_category:"",post_time:"",relation:"",tab_name:""}},deleteComment:{eventName:"delete_comment",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",comment_id:"",comment_user_id:""}},clickReplyIcon:{eventName:"click_reply_icon",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",comment_id:"",comment_user_id:"",from_xigua:0}},enterPersonalHomepage:{eventName:"enter_personal_homepage",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",to_user_id:"",enter_method:""}},enterPersonalDetail:{eventName:"enter_personal_detail",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",to_user_id:"",enter_method:""}},trendingWordsShow:{eventName:"trending_words_show",params:{words_source:"",enter_group_id:"",group_id:"",words_content:"",words_position:0,enter_from:""}},trendingWordsClick:{eventName:"trending_words_click",params:{words_source:"",enter_group_id:"",group_id:"",words_content:"",words_position:0,enter_from:""}},dislikeComment:{eventName:"dislike_comment",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",comment_id:"",comment_user_id:"",from_xigua:0,comment_category:"",post_time:"",relation:"",tab_name:""}},cancelDislikeComment:{eventName:"cancel_dislike_comment",params:{enter_from:"",group_id:""}},commentListShow:{eventName:"comment_list_show",params:{enter_from:"",group_id:"",duration:0}},commentShow:{eventName:"comment_show",params:{enter_from:"",group_id:"",comment_time:"",comment_type:""}},unfoldReplyComment:{eventName:"unfold_reply_comment",params:{enter_from:"",group_id:"",count:0}},foldReplyComment:{eventName:"fold_reply_comment",params:{enter_from:"",group_id:""}},clickCommentPic:{eventName:"click_comment_pic",params:{comment_type:""}}});var bn=function(e){var t,n=e.isSpider,r=e.isDigged,a=e.otherDiggCount,i=e.diggClick,c=e.stepOnClick,s=e.awemeInfo,u=e.renderTextWithTag,m=e.abtestData,d=e.player,f=e.commentInfo,p=e.setIsShowCommentInput,v=e.userInfo,h=e.handleUnLoginClick,C=e.awemelogPb,E=e.isFirstShowCommentInput,_=e.isShowCommentInput,w=e.asyncPublishComment,x=e.level,S=e.levelOneCid,b=e.commentLoadedTime,N=e.setIsFirstShowCommentInput,Z=(0,T.useContext)(Ue.X),M=(0,T.useState)(!1),D=(0,l.Z)(M,2),L=D[0],R=D[1],P=Z.puhlishCommentItem,U=Z.fetchEmoticonGif,j=Z.fetchCommentMetionList,F=Z.setSelectedReply,V=Z.setCurrentReplyCid,H=Z.isDetail,K=Z.isNeedCommentInput,G=Z.changeLoginStatus,q=Z.toast,z=Z.getSearchTextUrl,X=Z.onSearchTextClick,Q=Z.onSearchTextMounted,Y=Z.isSearch,J=f.cid,$=f.user,ee=f.text,te=f.textExtra,ne=f.createTime,oe=f.isTop,re=f.labelList,ae=f.stickyInfo,le=f.forwardId,ie=f.ipLabel,ce=f.imageList,se=void 0===ce?[]:ce,ue=$.nickname,me=$.uid,de=!H,fe=Boolean(v),ve=(0,T.useMemo)((function(){var e;return g()(e=k()(se).call(se,(function(e){var t,n,o,r;return{previewUrl:g()(t=(null==e||null===(n=e.cropUrl)||void 0===n?void 0:n.urlList)||[]).call(t,(function(e){return Boolean(e)})),originUrl:g()(o=(null==e||null===(r=e.originUrl)||void 0===r?void 0:r.urlList)||[]).call(o,(function(e){return Boolean(e)}))}}))).call(e,(function(e){return Boolean(e.previewUrl.length)}))}),[se]),ge=se.length>0,he=ee,ye=Boolean(ae&&ae.url);if(ae&&ae.url){he=ee.replace(/\[\u56fe\u7247\u8868\u60c5\]$/,"");var Ce=ae.width,Ee=ae.height;ye=Ce>0&&Ee>0}var _e=ye||ge;return T.createElement(T.Fragment,null,T.createElement("div",{className:Mt.contentText},he&&T.createElement("span",{className:Mt.actionText},T.createElement(Oe.Z,{text:he,textExtra:te,awemeInfo:s,enterMethod:"comment_at",userTextClassName:Mt.hoverRed,showSearchHighlight:!0,seoInfo:{isSpider:n,awemeId:""},getSearchTextUrl:function(e,t){return z({searchId:t,searchText:e,type:"comment-item"})},onSearchTextClick:function(e,t,n,o){return X({searchId:t,searchText:e,searchTextPos:n,type:"comment-item"},o)},onSearchTextMounted:function(e,t,n){Q({searchId:t,searchText:e,searchTextPos:n,type:"comment-item"})},renderTextWithTag:u},le?T.createElement("span",null,"\u8f6c\u53d1 \xb7 "):"")),_e&&T.createElement("div",{className:Mt.commentImageList},ye&&T.createElement(xn,{imagePreview:ae.url,imageOrigin:ae.url,previewClassName:Mt.stickyImage,className:Mt.stickyImageWrapper,onClick:function(){Sn.sendLog("clickCommentPic",{comment_type:"gif"})}}),ge&&T.createElement(xn,{imagePreview:ve[0].previewUrl,imageOrigin:ve[0].originUrl,previewClassName:Mt.commentImage,className:Mt.commentImageWrapper,onClick:function(){Sn.sendLog("clickCommentPic",{comment_type:"pic"})}})),Boolean(re&&re[0])&&T.createElement(kn.Vp,{type:"default",className:I()(Mt.tag,"comment-item-tag",Mt.defaultTag)},T.createElement("span",{className:"comment-item-tag-text text-no-shadow"},re[0].text)),Boolean(oe)&&T.createElement(kn.Vp,{type:"default",className:I()(Mt.tag,"comment-item-tag",Mt.defaultTag)},T.createElement("span",{className:"comment-item-tag-text text-no-shadow"},"\u7f6e\u9876"))),T.createElement("div",{className:Mt.timeAndLocation},T.createElement("span",{suppressHydrationWarning:!0},y()(t="".concat((0,pe.YW)(1e3*ne))).call(t,ie?"\xb7".concat(ie):""))),T.createElement("div",{className:Mt.opContainer},T.createElement("div",{className:I()(Mt.statsContainer,Mt.containerOpt,"comment-item-stats-container")},T.createElement("div",{className:I()(Mt.diggAndStepOn,Mt.diggAndStepOnOpt)},T.createElement("p",{className:I()(Mt.stats,(0,o.Z)({},Mt.isSelected,r)),onClick:i},!n&&T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(r?Bt.Z:Rt.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:20,height:20,viewBox:"0 0 20 20",className:Mt.diggSvg}),T.createElement("span",null,(0,pe.qe)(a+Number(r)||0))),(null==s?void 0:s.awemeType)!==B.ed.XgVideo&&T.createElement("p",{className:I()(Mt.stepOn),onClick:c},!n&&T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(jt.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:20,height:20,viewBox:"0 0 20 20",className:Mt.diggSvg}))),T.createElement(qt,{isLogin:fe,handleUnLoginClick:h,commentInfo:f,abtestData:m,toast:q,awemelogPb:C,awemeInfo:s,divider:!1}),Boolean(K)&&T.createElement(Ot.C,{type:"bottom",tipClassName:Mt.replyTip,iconClassName:Mt.replyTipIcon,showTip:(null==s?void 0:s.awemeType)===B.ed.XgVideo&&L,setShowTip:R,hoverShow:!0,content:T.createElement("div",null,"\u524d\u5f80\u897f\u74dc\u89c6\u9891\u56de\u590d\u8bc4\u8bba"),className:Mt.replyTipContainer},T.createElement("div",{className:I()(Mt.reply,Mt.noMarginLeft,(0,o.Z)({},Mt.isSelected,E&&_)),onClick:function(e){var t,n;if(fe){if(E&&_)F({});else{var o=ee;ge&&(o=ee+k()(ve).call(ve,(function(){return"[\u56fe\u7247]"})).join("")),ae&&ae.url&&(o="".concat(ee,"[\u56fe\u7247\u8868\u60c5]")),F({cid:J,nickName:ue,level:x,levelOneCid:S,publishComment:w,setIsShowCommentInput:p,text:o}),V(J)}if(null==e||null===(t=e.preventDefault)||void 0===t||t.call(e),null==e||null===(n=e.stopPropagation)||void 0===n||n.call(e),Sn.sendLog("clickReplyIcon",{author_id:"".concat(null==s?void 0:s.authorUserId),group_id:null==s?void 0:s.awemeId,log_pb:null==s?void 0:s.logPb,enter_from:(0,O.vM)(),comment_id:J,comment_user_id:me,from_xigua:(null==s?void 0:s.awemeType)===B.ed.XgVideo?1:0}),(null==s?void 0:s.awemeType)===B.ed.XgVideo){var r;A.emit(A.EVENT.videoPause);var a=Math.floor(null==d?void 0:d.currentTime).toString();window.open(y()(r="".concat((0,W.Tl)({videoid:null==s?void 0:s.awemeId,param:"comment_focus",value:J}),"&start=")).call(r,a))}E?p((function(e){return!e})):N(!0)}else h("reply")}},T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(Ut.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:20,height:20,className:Mt.commentSvg,viewBox:"0 0 36 36"}),Y?T.createElement("span",null,"\u56de\u590d"):T.createElement("span",null,E&&_?"\u56de\u590d\u4e2d":"\u56de\u590d")))),!de&&K&&E&&T.createElement("div",{className:I()(Mt.commentInputWrapper,(0,o.Z)({},Mt.hidden,!_||de))},T.createElement($e,{isLogin:fe,changeLoginStatus:G,placeHolder:ue&&"\u56de\u590d@".concat(ue),puhlishCommentItem:P,fetchEmoticonGif:U,fetchCommentMetionList:j,publishComment:function(e){p(!1),w(e)},cid:J,level:x||0,levelOneCid:S,awemeInfo:s,commentLoadedTime:b}))))},Tn={container:"YzvAxxFb"};function Nn(e){var t=e.width,n=void 0===t?5:t,o=e.height,r=void 0===o?4:o,a=e.color,l=void 0===a?"rgba(255, 255, 255, 0.6)":a,i=e.className,c=void 0===i?"":i;return T.createElement("div",{className:I()(Tn.container,c),style:{borderTopWidth:r,borderBottomWidth:r,borderLeftWidth:n,borderLeftColor:l}})}var In=function(e,t,n,o){var r,a={author_id:null==t||null===(r=t.authorInfo)||void 0===r?void 0:r.uid,group_id:null==t?void 0:t.awemeId,log_pb:n,from_gid:null==t?void 0:t.groupId,enter_from:null==o?void 0:o.enter_from,tab_name:null==o?void 0:o.tab_name};return(0,W.HC)(e,"enter_method=comment&".concat((0,St.stringify)(a)))};function Zn(e,t){var n,r,i,c,s,m=e.type,d=void 0===m?"clarity":m,f=e.commentInfo,p=e.isNeedReply,v=void 0===p||p,g=e.children,h=e.awemeInfo,y=e.awemelogPb,C=e.userInfo,_=e.deleteComment,w=e.level,x=e.levelOneCid,k=e.publishComment,S=e.fullScreenTarget,b=e.isSpider,N=void 0!==b&&b,Z=e.commentLoadedTime,M=e.defaultCommentId,D=e.className,L=e.player,R=e.renderTextWithTag,P=e.abtestData,U=e.updateReplyList,j=e.dispatch,F=(0,T.useState)(1===(null==f?void 0:f.userDigged)),V=(0,l.Z)(F,2),H=V[0],G=V[1],q=(0,T.useState)(null==f?void 0:f.userBuried),z=(0,l.Z)(q,2),X=z[0],Q=z[1],Y=(0,T.useState)(Boolean(null==f||null===(n=f.replyComment)||void 0===n?void 0:n.length)),J=(0,l.Z)(Y,2),ee=J[0],te=J[1],oe=(0,T.useState)(!1),re=(0,l.Z)(oe,2),le=re[0],ie=re[1],ce=(0,T.useState)(!0),se=(0,l.Z)(ce,2),ue=se[0],me=se[1],de=f.cid,fe=f.user,ve=f.diggCount,ge=f.createTime,he=f.replyTotal,ye=f.labelText,Ce=f.labelType,Ee=f.replyToUserName,_e=f.replyToUserId,we=f.replySecUid,xe=function(){var e=f||{},t=e.imageList,n=e.stickyInfo,o="text";(null==t?void 0:t.length)>0?o="pic":null!=n&&n.url&&(o="gif"),Sn.sendLog("commentShow",{enter_from:(0,O.vM)(),group_id:null==h?void 0:h.awemeId,comment_time:(0,pe.MH)(1e3*ge),comment_type:o})},ke=(0,Nt.x)(wt()(xe).call(xe,null)),Se=fe.nickname,be=(fe.avatarUri,fe.secUid),Te=fe.uid,Ne=ve-(1===(null==f?void 0:f.userDigged)?1:0),Ie=(null==h?void 0:h.awemeType)===B.ed.XgVideo,Ze=(0,T.useContext)(Ue.X),Me=(null!==(r=(0,T.useContext)(K.v))&&void 0!==r?r:{}).setGlobalCommentCount,De=Ze.diggCommentItem,Le=Ze.deleteCommentItem,Re=Ze.currentReplyCid,Be=Ze.isDetail,Ae=Ze.scrollCid,je=Ze.container,Fe=Ze.changeLoginStatus,We=Ze.toast,Ve=Ze.reportExtraParams,He=T.useMemo((function(){return Boolean(C)}),[C]);(0,T.useImperativeHandle)(t,(function(){return{setShowReply:function(){te(!0)}}}),[]),(0,T.useEffect)((function(){Re!==de&&(le&&ie(!1),ue||me(!0))}),[Re]),(0,T.useEffect)((function(){if(Ae===de){for(var e,t=ke.current.offsetParent,n=ke.current.offsetTop;t!==je;)n+=t.offsetTop,t=t.offsetParent;if(!(je.scrollTop<n&&n<je.scrollTop+je.clientHeight))null==je||null===(e=je.scrollTo)||void 0===e||e.call(je,0,n)}}),[Ae]);var Ke=(0,T.useCallback)((function(e){return new(kt())((function(t){var n,o,r,l="\u767b\u5f55\u540e\u5373\u53ef\u64cd\u4f5c";switch(e){case"reply":l="\u767b\u5f55\u540e\u5373\u53ef\u56de\u590d\u559c\u6b22\u7684\u5185\u5bb9";break;case"like_comment":l="\u767b\u5f55\u540e\u53ef\u4ee5\u70b9\u8d5e\u8bc4\u8bba";break;case"step_on_comment":l="\u767b\u5f55\u540e\u53ef\u4ee5\u70b9\u8e29\u8bc4\u8bba";break;case"share_comment":l="\u767b\u5f55\u540e\u5373\u53ef\u5206\u4eab\u8bc4\u8bba"}(0,ze.default)({success:(r=(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Fe){e.next=5;break}return e.next=3,Fe();case 3:e.next=6;break;case 5:window.location.reload();case 6:t(!0);case 7:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)}),onClose:function(){t(!1)},headerText:l,enterMethod:e,next:"https://".concat(null===(n=window)||void 0===n||null===(o=n.location)||void 0===o?void 0:o.host)})}))}),[Fe]),Ge=(0,T.useCallback)((0,a.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(He){e.next=6;break}return e.next=3,Ke("like_comment");case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return G((function(e){return!e})),X&&Q(!1),null==U||U((0,ne.Z)((0,ne.Z)({},f),{},{userDigged:H?0:1,userBuried:!X&&f.userBuried,diggCount:f.diggCount+=H?-1:1})),e.next=11,De({diggType:H?2:1,cid:de,level:1===w?1:3});case 11:0!==(t=e.sent).statusCode?(null==U||U((0,ne.Z)((0,ne.Z)({},f),{},{userDigged:H?0:1,diggCount:f.diggCount+=H?-1:1})),G((function(e){return!e})),E()(n=ae.statusMsg).call(n,t.statusMsg)?We(t.statusMsg):We("\u70b9\u8d5e\u5931\u8d25")):H?Sn.sendLog("cancelLikeComment",{author_id:"".concat(null==h?void 0:h.authorUserId),group_id:null==h?void 0:h.awemeId,log_pb:null==h?void 0:h.logPb,enter_from:(0,O.vM)(),comment_id:de,comment_user_id:Te}):Sn.sendLog("likeComment",(0,ne.Z)({author_id:"".concat(null==h?void 0:h.authorUserId),group_id:null==h?void 0:h.awemeId,log_pb:null==h?void 0:h.logPb,enter_from:(0,O.vM)(),comment_id:de,comment_user_id:Te,from_xigua:(null==h?void 0:h.awemeType)===B.ed.XgVideo?1:0,comment_category:"0"===(null==f?void 0:f.replyId)?"original":"reply"},Ve));case 13:case"end":return e.stop()}}),e)}))),[H,He,Ke,X]),qe=(0,T.useCallback)((0,a.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(He){e.next=6;break}return e.next=3,Ke("step_on_comment");case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return Q((function(e){return!e})),H&&G(!1),null==U||U((0,ne.Z)((0,ne.Z)({},f),{},{userDigged:H?0:f.userDigged,userBuried:!X,diggCount:f.diggCount+=H?-1:0})),e.next=11,De({diggType:X?4:3,cid:de,level:1===w?1:3});case 11:0!==(t=e.sent).statusCode?(null==U||U((0,ne.Z)((0,ne.Z)({},f),{},{userBuried:!X})),Q((function(e){return!e})),E()(n=ae.statusMsg).call(n,t.statusMsg)?We(t.statusMsg):We("\u70b9\u8e29\u5931\u8d25")):X?Sn.sendLog("cancelDislikeComment",{group_id:null==h?void 0:h.awemeId,enter_from:(0,O.vM)()}):Sn.sendLog("dislikeComment",(0,ne.Z)({author_id:"".concat(null==h?void 0:h.authorUserId),group_id:null==h?void 0:h.awemeId,log_pb:null==h?void 0:h.logPb,enter_from:(0,O.vM)(),comment_id:de,comment_user_id:Te,from_xigua:(null==h?void 0:h.awemeType)===B.ed.XgVideo?1:0,comment_category:"0"===(null==f?void 0:f.replyId)?"original":"reply"},Ve));case 13:case"end":return e.stop()}}),e)}))),[H,He,Ke,X]),Xe=function(){var e=(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le({cid:de});case 2:0===e.sent.statusCode&&(_(de),We("\u8bc4\u8bba\u5220\u9664\u6210\u529f"),Sn.sendLog("deleteComment",(0,ne.Z)({author_id:"".concat(null==h?void 0:h.authorUserId),group_id:null==h?void 0:h.awemeId,log_pb:null==h?void 0:h.logPb,enter_from:(0,O.vM)(),comment_id:de,comment_user_id:Te},Ve)));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return T.createElement("div",{ref:ke,className:I()(Mt.commentItemContainer,D,(0,o.Z)({},Mt[d],Boolean(Mt[d]))),"data-e2e":"comment-item"},!N&&T.createElement(Dt,{commentInfo:f,awemeInfo:h,awemelogPb:y,level:w,isSpider:N}),T.createElement("div",{className:Mt.contentContainer},T.createElement("div",{className:I()(Mt.contentMain,Mt.hoverShowMoreBtn,(0,o.Z)({},Mt.activeComment,le&&ue))},de===M&&T.createElement("div",{className:I()((i={},(0,o.Z)(i,Mt.highlight,de===M),(0,o.Z)(i,Mt.isReplyItem,2===w),i))}),T.createElement("div",{className:I()(Mt.infoWrap,"comment-item-info-wrap")},T.createElement("div",{className:Mt.nickWrap},T.createElement("div",{className:Mt.nickname},T.createElement($.a,{href:globalThis.xssNamespace.douyin_web.filterUrl(Ie?(0,W.GN)(null==f||null===(c=f.user)||void 0===c?void 0:c.uid):In(be,h,y,Ve),null,{logType:"js.href/src",mode:"black",reportOnly:!1}),target:"_blank",rel:"noopener noreferrer",isNeedSeoOpt:!0},T.createElement(Oe.Z,{text:Se,className:Mt.nicknameInner,seoInfo:{isSpider:N,awemeId:""}})),Ee&&_e&&T.createElement(T.Fragment,null,T.createElement(Nn,{className:Mt.triggle}),T.createElement($.a,{href:globalThis.xssNamespace.douyin_web.filterUrl(In(we,h,y,Ve),null,{logType:"js.href/src",mode:"black",reportOnly:!1}),target:"_blank",rel:"noopener noreferrer"},T.createElement(Oe.Z,{text:Ee,className:Mt.nicknameInner,seoInfo:{isSpider:N,awemeId:""}})))),Boolean(ye)&&T.createElement(kn.Vp,{type:1===Ce?"label":"default",className:I()(Mt.tag,"comment-item-tag",(0,o.Z)({},Mt.defaultTag,1!==Ce))},T.createElement("span",{className:I()("comment-item-tag-text","text-no-shadow")},ye))),T.createElement("div",{className:Mt.more,"data-e2e":"video-comment-more"},T.createElement(Tt.e,{content:!C||C&&f.user.uid!==C.uid?T.createElement("div",{onClick:function(){var e,t;Ie?(A.emit(A.EVENT.videoPause),window.open((0,W.Tl)({videoid:null==h?void 0:h.awemeId,param:"envoke_comment_tipoff",value:f.cid}))):(0,bt.mJ)({title:"\u4e3e\u62a5\u8bc4\u8bba",type:"comment",object_id:f.cid,userInfo:C,loginDispatch:j,comment_with_emoji:null!=f&&null!==(e=f.stickyInfo)&&void 0!==e&&e.url?1:0,pipeline_id:"158",enter_from:(0,O.yW)(),owner_id:(null==f||null===(t=f.user)||void 0===t?void 0:t.uid)||"",video_id:null==h?void 0:h.awemeId,onClose:function(){A.emit(A.EVENT.videoRemoveStopPlayNext)},onShow:function(){A.emit(A.EVENT.videoStopPlayNext)}},S)},className:Mt.moreInfoText,"data-e2e":"video-comment-more-report"},"\u4e3e\u62a5\u8bc4\u8bba"):T.createElement("div",{onClick:Xe,className:Mt.moreInfoText},"\u5220\u9664\u8bc4\u8bba"),position:Be&&"left"},T.createElement("div",{className:Mt.moreInfo,id:"tooltip_".concat(f.cid)},"...")))),X?T.createElement(Pt,{isSpider:N,isDigged:H,otherDiggCount:Ne,diggClick:Ge,stepOnClick:qe,isXgVideo:Ie}):T.createElement(bn,{isSpider:N,isDigged:H,otherDiggCount:Ne,diggClick:Ge,stepOnClick:qe,awemeInfo:h,renderTextWithTag:R,abtestData:P,player:L,commentInfo:f,setIsShowCommentInput:me,userInfo:C,handleUnLoginClick:Ke,awemelogPb:y,isFirstShowCommentInput:le,isShowCommentInput:ue,asyncPublishComment:function(e){null==Me||Me((function(e){return e+1})),k(e)},level:w,levelOneCid:x,commentLoadedTime:Z,setIsFirstShowCommentInput:ie})),Boolean(v&&!ee&&he)&&T.createElement("button",{type:"button",className:I()(Mt.replyExpandBtn,"comment-reply-expand-btn")},T.createElement("div",{className:Mt.replyLine}),T.createElement("div",{className:Mt.hoverStyle,onClick:function(){te(!0),Sn.sendLog("unfoldReplyComment",{group_id:null==h?void 0:h.awemeId,enter_from:(0,O.vM)(),count:he})}},T.createElement("span",null,"\u5c55\u5f00",he,"\u6761\u56de\u590d"),!N&&T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(Zt.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),color:It.COLOR_TEXT_1,width:13,height:13,viewBox:"0 0 13 13",className:Mt.replySvg}))),v&&ee&&(he||(null==f||null===(s=f.replyComment)||void 0===s?void 0:s.length))&&g||null))}var Mn=(0,T.forwardRef)(Zn),Dn=n(90457),Ln=n.n(Dn),Rn=n(53361),Bn=n.n(Rn),An=n(66771),On=n(2416),Pn="nNNp3deF",Un="N10j3PcL",jn="_5i2jkUZH",Fn="utx_PqAX",Wn="iRduembj",Vn="ruZu1l6W",Hn="_H7kC7rM",Kn=D.WHALE_CUT_HEADER;function Gn(e){var t=e.replyInfo,n=e.userInfo,o=e.deleteComment,r=e.publishComment,a=e.levelOneCid,l=e.fullScreenTarget,i=e.awemeInfo,c=e.isSpider,s=e.commentLoadedTime,u=e.defaultCommentId,m=e.player,d=(e.isActive,e.abtestData),f=e.updateReplyList,p=e.dispatch;return T.createElement(Mn,{commentInfo:t,userInfo:n,deleteComment:o,level:2,publishComment:r,levelOneCid:a,fullScreenTarget:l,awemeInfo:i,isSpider:c,commentLoadedTime:s,defaultCommentId:u,player:m,abtestData:d,updateReplyList:f,dispatch:p})}function qn(e,t){var n,i,c,s=e.defaultReply,m=void 0===s?[]:s,f=e.userInfo,v=e.replyTotal,h=e.fetchReply,C=e.firstReplyCount,_=void 0===C?3:C,w=e.replyCount,x=void 0===w?10:w,S=e.scrollContainerEl,b=e.levelOneCid,N=e.newPublishTopReply,Z=e.setNewPublishTopReply,M=e.onClearNewPublishReply,D=e.publishComment,R=e.setNowComment,B=e.fullScreenTarget,A=e.awemeInfo,P=e.isSpider,U=e.originCommentInfo,j=e.commentLoadedTime,W=e.defaultCommentId,V=e.player,H=e.abtestData,G=e.dispatch,q=e.changeLoginStatus,z=e.isLogin,X=e.setBlockNum,Q=e.loginBlock,Y=e.actionCloseBlock,J=e.setActionCloseBlock,$=(null!==(n=(0,T.useContext)(K.v))&&void 0!==n?n:{}).setGlobalCommentCount,ee=(0,T.useState)(y()(i=[]).call(i,(0,r.Z)(m),(0,r.Z)(N))),te=(0,l.Z)(ee,2),ne=te[0],oe=te[1],re=(0,T.useMemo)((function(){return k()(ne).call(ne,(function(e){return e.cid}))}),[ne]),ae=v>((null==ne?void 0:ne.length)||0),le=(0,T.useState)([]),ie=(0,l.Z)(le,2),ce=ie[0],se=ie[1],ue=(0,T.useRef)(0);ue.current=ce.length;var me=(0,T.useRef)(0),de=(0,T.useRef)(ae),fe=(0,T.useRef)(null),pe=(0,T.useState)(!1),ve=(0,l.Z)(pe,2),ge=ve[0],he=ve[1],ye=(0,T.useState)(!0),Ce=(0,l.Z)(ye,2),Ee=Ce[0],_e=Ce[1],we=(0,T.useRef)(null),xe=(0,T.useRef)(!1),ke=(0,T.useRef)([]);(0,T.useEffect)((function(){ke.current=ce}),[ce]),(0,T.useEffect)((function(){var e;oe(y()(e=[]).call(e,(0,r.Z)(m),(0,r.Z)(N)))}),[m,N]);var Se=function(e){U.replyTotal-=1,Ln()(ce).call(ce,(function(t){return(null==t?void 0:t.cid)===e}))&&se((function(t){return g()(t).call(t,(function(t){return(null==t?void 0:t.cid)!==e}))})),Ln()(N).call(N,(function(t){return(null==t?void 0:t.cid)===e}))&&Z((function(t){return g()(t).call(t,(function(t){return(null==t?void 0:t.cid)!==e}))})),Ln()(ne).call(ne,(function(t){return(null==t?void 0:t.cid)===e}))&&oe((function(t){return g()(t).call(t,(function(t){return(null==t?void 0:t.cid)!==e}))})),R(U),null==$||$((function(e){return e?e-1:0}))};(0,T.useImperativeHandle)(t,(function(){return{getIsExpand:function(){return Ee},publishComment:D,setIsExpand:_e,unshiftReply:function(e){se((function(t){var n;return y()(n=[e]).call(n,(0,r.Z)(t))}))},pushReply:function(e){se((function(t){var n;return y()(n=[]).call(n,(0,r.Z)(t),[e])}))}}}),[Ee]),(0,T.useEffect)((function(){var e;Y&&2===(null==H||null===(e=H.commentBlock)||void 0===e?void 0:e.type)&&Q&&(xe.current=!1)}),[Y,H,Q]);var be=function(e,t){for(var n=[],o=function(o){p()(e).call(e,(function(e){var n;return(null==e?void 0:e.cid)===(null===(n=t[o])||void 0===n?void 0:n.cid)}))||n.push(t[o])},r=0;r<t.length;r++)o(r);return n},Te=T.useCallback((0,a.Z)(u().mark((function e(){var t,n,o,a,l,i,c,s,m,d,f,p=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&p[0]!==undefined&&p[0],ge||!de.current){e.next=17;break}return he(!0),e.next=5,h(me.current,t?_:x,fe.current);case 5:a=e.sent,l=a.statusCode,i=a.comments,c=a.cursor,s=a.hasMore,m=a.whaleInfo,fe.current=null==m?void 0:m.whaleCutToken,d=!1,ue.current+i.length>=3&&Q&&(1===(null==H||null===(n=H.commentBlock)||void 0===n?void 0:n.type)||2===(null==H||null===(o=H.commentBlock)||void 0===o?void 0:o.type)&&!Y)&&(d=!0),ge||(null==m?void 0:m.whaleDecisionCustom)!==Kn&&!d?xe.current=!1:xe.current=!0,0===l&&(de.current=!!xe.current||s,me.current=c,f=be(N,be(ke.current,i)),se((function(e){var t;return y()(t=[]).call(t,(0,r.Z)(e),(0,r.Z)(f))}))),he(!1);case 17:case"end":return e.stop()}}),e)}))),[_,x,ge,H,Y]),Ne=T.useCallback((function(){if(S=S||window,we.current&&S&&we.current.getBoundingClientRect().top<122){_e(!1);var e=we.current.clientHeight,t=(0,An.F)(S),n=t.x,o=t.y;S.scrollTo(n,Math.max(o-e-25,0))}else _e(!1);M(),Sn.sendLog("foldReplyComment",{group_id:null==A?void 0:A.awemeId,enter_from:(0,O.vM)()})}),[S]),Ie=0===ce.length&&0===ne.length;(0,T.useEffect)((function(){Ie&&Te(!0)}),[]);var Ze=v-ne.length,Me=null;if(ge)Me=T.createElement(gt.g,{text:""});else if(Ze>0){var De=!xe.current||z||Y?T.createElement("span",null,"\u5c55\u5f00\u66f4\u591a"):T.createElement("span",{className:Vn,onClick:function(e){var t,n,o,r,l;if(2===(null==H||null===(t=H.commentBlock)||void 0===t?void 0:t.type)&&Q){var i=0;X((function(e){return i=e+1,(0,F.qQ)(L.LocalStorageKeys.CommentBlock,{total:i,lastTimes:d()(),actionClose:i>1}),i})),i>1&&(Te(),J(!0))}null==e||null===(n=e.preventDefault)||void 0===n||n.call(e),(0,ze.default)({success:(l=(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q?null==q||q():window.location.reload();case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),enterMethod:"comment",headerText:"\u767b\u5f55\u540e\u5c55\u5f00\u66f4\u591a\u56de\u590d",next:"https://".concat(null===(o=window)||void 0===o||null===(r=o.location)||void 0===r?void 0:r.host)})}},"\u767b\u5f55\u540e\u5c55\u5f00\u66f4\u591a");Me=T.createElement(T.Fragment,null,(de.current||!Ee)&&T.createElement("button",{type:"button",className:I()(Un)},T.createElement("div",{className:jn}),T.createElement("div",{className:Wn,onClick:function(){if(ce.length>0&&!Ee)_e(!0);else{if(xe.current&&!z)return;Te(0===ce.length)}M(),Sn.sendLog("unfoldReplyComment",{group_id:null==A?void 0:A.awemeId,enter_from:(0,O.vM)(),count:ce.length>0&&Ee?0:Ze})}},ce.length>0&&Ee?De:T.createElement("span",null,"\u5c55\u5f00",Ze,"\u6761\u56de\u590d"),T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(Zt.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),color:It.COLOR_TEXT_1,className:Hn,width:13,height:13,viewBox:"0 0 13 13"}))),ce.length>0&&Ee&&T.createElement("button",{type:"button",className:I()(Un,Wn,(0,o.Z)({},Fn,de.current)),onClick:Ne},T.createElement("span",null,"\u6536\u8d77"),T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(On.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),color:It.COLOR_TEXT_1,className:Hn,width:13,height:13,viewBox:"0 0 13 13"})))}return T.createElement("div",{className:Pn,ref:we},k()(ne).call(ne,(function(e){return T.createElement(Gn,{replyInfo:e,userInfo:f,key:e.cid,deleteComment:Se,publishComment:D,levelOneCid:b,fullScreenTarget:B,awemeInfo:A,isSpider:P,commentLoadedTime:j,defaultCommentId:W,player:V,abtestData:H,dispatch:G})})),Ee&&k()(c=g()(ce).call(ce,(function(e){return!E()(re).call(re,e.cid)}))).call(c,(function(e){return T.createElement(Gn,{replyInfo:e,userInfo:f,key:e.cid,deleteComment:Se,publishComment:D,levelOneCid:b,fullScreenTarget:B,awemeInfo:A,commentLoadedTime:j,defaultCommentId:W,player:V,abtestData:H,dispatch:G,updateReplyList:function(e){se((function(t){var n=Bn()(t).call(t,(function(t){return t.cid===e.cid}));return-1!==n&&(t[n]=e),(0,r.Z)(t)}))}})})),ge?T.createElement(gt.g,{text:""}):Me)}var zn=(0,T.forwardRef)(qn);var Xn,Qn,Yn,Jn=function(e){var t=e.type,n=void 0===t?"clarity":t,o=e.commentInfo,a=e.fetchReply,i=void 0===a?null:a,c=e.isNeedReply,s=void 0===c||c,u=e.scrollContainerEl,m=e.awemeInfo,d=e.userInfo,f=e.awemelogPb,p=e.deleteComment,v=e.fullScreenTarget,g=e.isSpider,h=e.commentLoadedTime,C=e.defaultCommentId,E=e.player,_=(e.isActive,e.renderTextWithTag),w=e.abtestData,x=e.dispatch,k=e.changeLoginStatus,S=e.isLogin,b=e.setBlockNum,N=e.loginBlock,I=e.actionCloseBlock,Z=e.setActionCloseBlock,M=(0,T.useState)(o),D=(0,l.Z)(M,2),L=D[0],R=D[1],B=(0,T.useRef)(null),A=(0,T.useRef)(null),O=L.cid,P=T.useCallback((function(e,t,n){return null==i?void 0:i(O,e,t,n)}),[i,O]),U=(0,T.useState)([]),j=(0,l.Z)(U,2),F=j[0],W=j[1],V=function(e){var t,n,a,l;(o.replyTotal+=1,R(o),null!==(t=B.current)&&void 0!==t&&null!==(n=t.getIsExpand)&&void 0!==n&&n.call(t))?B.current.pushReply(e):(W((function(t){var n;return y()(n=[]).call(n,(0,r.Z)(t),[e])})),A.current.setShowReply(),null===(a=B.current)||void 0===a||null===(l=a.unshiftReply)||void 0===l||l.call(a,e))};return T.createElement("div",null,T.createElement(Mn,{ref:A,awemelogPb:f,type:n,commentInfo:L,isSpider:g,isNeedReply:s,awemeInfo:m,userInfo:d,isNeedDivid:!0,deleteComment:p,level:1,publishComment:V,fullScreenTarget:v,commentLoadedTime:h,defaultCommentId:C,player:E,renderTextWithTag:_,abtestData:w,dispatch:x},T.createElement(zn,{onClearNewPublishReply:function(){W([])},originCommentInfo:L,isSpider:g,userInfo:d,fetchReply:P,scrollContainerEl:u,replyTotal:(null==L?void 0:L.replyTotal)||0,defaultReply:(null==L?void 0:L.replyComment)||[],newPublishTopReply:F,setNewPublishTopReply:W,setNowComment:R,levelOneCid:O,ref:B,publishComment:V,fullScreenTarget:v,awemeInfo:m,commentLoadedTime:h,defaultCommentId:C,player:E,abtestData:w,dispatch:x,changeLoginStatus:k,isLogin:S,setBlockNum:b,loginBlock:N,actionCloseBlock:I,setActionCloseBlock:Z})))},$n=n(34590),eo=n(45380),to="nf2cnBFu",no="RCogDAGw",oo="MIa4JNUl",ro="DrSNaxuL",ao=(Yn={},(0,o.Z)(Yn,z.YY.Tray,(Xn={},(0,o.Z)(Xn,z.bu.Comment,"\u5f00\u542f\u300c\u5f00\u673a\u81ea\u542f\u52a8\u300d\uff0c\u53ca\u65f6\u63a5\u6536\u4e0e\u4f60\u76f8\u5173\u7684\u4e92\u52a8\u6d88\u606f\u3002"),(0,o.Z)(Xn,z.bu.CommentMentioned,"\u5f00\u542f\u300c\u5f00\u673a\u81ea\u542f\u52a8\u300d\uff0c\u53ca\u65f6\u63a5\u6536\u4e0e\u4f60\u76f8\u5173\u7684\u4e92\u52a8\u6d88\u606f\u3002"),Xn)),(0,o.Z)(Yn,z.YY.Push,(Qn={},(0,o.Z)(Qn,z.bu.Comment,"\u5f00\u542f\u300c\u8bc4\u8bba\u300d\u5f00\u5173\uff0c\u53ca\u65f6\u63a5\u6536\u8bc4\u8bba\u56de\u590d\u6d88\u606f\u3002"),(0,o.Z)(Qn,z.bu.CommentMentioned,"\u5f00\u542f\u300c\u63d0\u53ca\u300d\u5f00\u5173\uff0c\u53ca\u65f6\u63a5\u6536\u4e0e\u4f60\u76f8\u5173\u7684\u4e92\u52a8\u6d88\u606f\u3002"),Qn)),Yn),lo=function(e){var t,n=e.scene,o=e.isShowComment,r=e.setGlobalGuideType,l=e.commentGuideType,i=e.setShowTrayPushGuide;return(0,T.useEffect)((function(){o||(null==r||r(!1),null==i||i(!1))}),[o,r,i]),(0,T.useEffect)((function(){(0,a.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=6;break}return e.next=3,eo.Gq.getGuideType(n);case 3:(t=e.sent)&&(eo.Gq.onShow(n,t),r(t));case 6:case"end":return e.stop()}}),e)})))()}),[n,r,l]),l?T.createElement("div",{className:to},T.createElement("div",{className:no},T.createElement("span",{className:oo},null==ao||null===(t=ao[l])||void 0===t?void 0:t[n]),T.createElement("span",{onClick:function(){eo.Gq.onOpen(n,l),null==r||r(!1),null==i||i(!1)},className:ro},"\u70b9\u51fb\u5f00\u542f"))):null},io=n(56042),co=n(40107),so=n(82569),uo=D.WHALE_CUT_HEADER;function mo(e){var t=e.reload;return T.createElement("div",{className:Q.Z.noMoreText},"\u670d\u52a1\u5f02\u5e38\uff0c",T.createElement("span",{onClick:t,className:Q.Z.opBtn},"\u5237\u65b0"),"\u62c9\u53d6\u6570\u636e")}function fo(e,t){var n,i,s,m,f,v,h,C,_,x,S,N=e.isDetail,D=void 0===N||N,J=e.isSearch,te=void 0!==J&&J,ne=e.isCollapse,oe=void 0!==ne&&ne,re=e.defaultTotal,ae=void 0===re?0:re,le=e.onCloseCommentClick,ie=e.isShowComment,ce=void 0!==ie&&ie,se=e.isInit,ue=void 0!==se&&se,me=e.defaultCommentList,de=void 0===me?[]:me,fe=e.defaultCursor,pe=void 0===fe?0:fe,ve=e.defaultWhaleCutToken,ge=e.defaultWhaleDecisionCustom,he=e.defaultHotsoonHasMoreRef,ye=void 0===he?0:he,Ce=e.defaultHasMore,Ee=void 0===Ce||Ce,_e=e.defaultStatusCode,we=void 0===_e?0:_e,xe=e.defaultCommentId,ke=void 0===xe?"":xe,Se=e.count,be=void 0===Se?20:Se,Te=e.scrollContainerEl,Ne=void 0===Te?null:Te,Ie=e.fetchComment,Ze=e.fetchReply,Me=e.fetchEmoticonGif,De=e.fetchCommentMetionList,Le=e.diggCommentItem,Re=e.deleteCommentItem,Be=e.puhlishCommentItem,Ae=e.awemeInfo,Oe=e.userInfo,je=e.awemelogPb,Fe=e.needFirstPause,We=void 0!==Fe&&Fe,Ve=e.fullScreenTarget,He=e.isNeedCommentInput,Ke=e.changeLoginStatus,Ge=e.isSpider,qe=void 0!==Ge&&Ge,Xe=e.player,Qe=e.shortcutDisable,Ye=e.shortcutMode,Je=e.reportExtraParams,et=e.abtestData,tt=e.className,nt=void 0===tt?"":tt,ot=e.getSearchTextUrl,at=e.onSearchTextClick,lt=e.tipTextAfter,it=void 0===lt?X.X.Close:lt,ct=e.isActive,st=void 0===ct||ct,ut=(e.logParams,e.keywordList),mt=void 0===ut?[]:ut,_t=e.renderTextWithTag,wt=e.dispatch,xt=e.globalIsCommentTrayPushGuideShow,kt=e.globalCommentTrayPushGuideType,St=e.setCommentTrayPushGuideTypeFunc,bt=e.setIsCommentTrayPushGuideShowFunc,Tt=e.tab,Nt=void 0===Tt?"":Tt,It=(0,T.useState)(!0),Zt=(0,l.Z)(It,2),Mt=Zt[0],Dt=Zt[1],Lt=(0,T.useContext)(K.v)||{},Rt=Lt.globalCommentCount,Bt=Lt.setGlobalCommentCount,At=(0,T.useState)(!0),Ot=(0,l.Z)(At,2),Pt=Ot[0],Ut=Ot[1],jt=(0,T.useState)(de),Ft=(0,l.Z)(jt,2),Wt=Ft[0],Vt=Ft[1],Ht=(0,T.useState)({}),Kt=(0,l.Z)(Ht,2),Gt=Kt[0],qt=Kt[1],zt=(0,T.useState)(null),Xt=(0,l.Z)(zt,2),Qt=Xt[0],Yt=Xt[1],Jt=(0,T.useState)(we),$t=(0,l.Z)(Jt,2),en=$t[0],tn=$t[1],nn=(0,T.useState)(),on=(0,l.Z)(nn,2),rn=on[0],an=on[1],ln=(0,T.useState)(""),cn=(0,l.Z)(ln,2),sn=cn[0],un=cn[1],mn=(0,T.useState)(be),dn=(0,l.Z)(mn,2),fn=dn[0],pn=dn[1],vn=(0,T.useRef)(Ie),gn=(0,T.useRef)(pe),hn=(0,T.useRef)(ve),yn=(0,T.useRef)(Ee),Cn=(0,T.useRef)(ye),En=(0,T.useRef)(null),_n=(0,T.useRef)(ue),wn=(0,T.useRef)(!1),xn=(0,T.useRef)(null!=de&&de.length?1:0),kn=(0,T.useRef)(null);vn.current=Ie;var bn=Oe||{},Tn=bn.info,Nn=bn.isLogin,In=(0,T.useRef)(!Nn&&ge===uo),Zn=(0,T.useState)(!1),Mn=(0,l.Z)(Zn,2),Dn=Mn[0],Ln=Mn[1],Rn=(0,T.useRef)(0),Bn=(0,T.useRef)((null==de?void 0:de.length)||0);Bn.current=null==Wt?void 0:Wt.length;var An=(0,co._0)({effectiveTime:null==et||null===(n=et.commentBlock)||void 0===n?void 0:n.effective_time,type:null==et||null===(i=et.commentBlock)||void 0===i?void 0:i.type,abtestData:et,isLogin:Nn}),On=An.blockNum,Pn=An.setBlockNum,Un=An.actionCloseBlock,jn=An.setActionCloseBlock,Fn=An.refBlockShowMore,Wn=An.handleJumpBlock,Vn=An.refLoginBlock,Hn=An.getBlockNum,Kn=(An.transition,An.isShowDebounce,An.isHideDebounce,A),Gn=Kn.EVENT,qn=(0,T.useState)(Dn),zn=(0,l.Z)(qn,2),Xn=zn[0],Qn=zn[1],Yn=(0,T.useRef)(Dn),eo=(0,T.useRef)(d()()),to=(0,T.useRef)();to.current===undefined&&(to.current=d()());var no=!(!Nn&&(Fn.current&&!Un||In.current));(0,T.useEffect)((function(){Dn&&(Qn(!0),Kn.emit(Gn.videoStopPlayNext)),!Dn&&Xn&&Kn.emit(Gn.videoRemoveStopPlayNext),Yn.current=Dn}),[Dn]),(0,T.useEffect)((function(){return function(){var e;null===(e=kn.current)||void 0===e||e.call(kn),Yn.current&&Kn.emit(Gn.videoRemoveStopPlayNext)}}),[]);var oo=(0,vt.d)({canShowDownloadBar:!0,type:"comment"}),ro=oo.isShow,ao=oo.showBar,fo=oo.isHighlight,po=oo.canShowLightComment,vo=(0,T.useRef)(null),go=(0,T.useCallback)((function(e){var t=Q.Z.commentToast;return $n.F.info({text:e,className:t},vo.current)}),[vo.current]);(0,T.useEffect)((function(){null!=Wt&&Wt.length&&Ut(!1),wn.current=!1;var e=function(){Yt(""),qt({})};return document.addEventListener("click",e),function(){wn.current=!0,document.removeEventListener("click",e)}}),[]);var ho=(0,T.useCallback)((function(){Qt&&(Yt(""),qt({}))}),[Qt]);(0,T.useEffect)((function(){Nn&&(un("none"),pn(20))}),[Nn]),(0,T.useEffect)((function(){st&&ce&&!Rn.current&&(Rn.current=d()());var e=function(){Sn.sendLog("commentListShow",{enter_from:(0,O.vM)(),group_id:null==Ae?void 0:Ae.awemeId,duration:d()()-Rn.current}),Rn.current=0};return st&&ce||!Rn.current||e(),function(){Rn.current&&e()}}),[st,ce,Ae]),(0,T.useEffect)((function(){var e=function(){var e=(0,a.Z)(u().mark((function e(){var t,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Nn&&"video_detail"===(0,O.yW)()){e.next=3;break}return un("none"),e.abrupt("return");case 3:return e.prev=3,e.next=6,Z.d7(Z.Ap.COMMENT_DETAIL,et);case 6:(t=e.sent).shouldShow?((null===(n=t.extra)||void 0===n?void 0:n.intensity)!==Z.MO.FORCE&&un("login_guide"),(null===(o=t.extra)||void 0===o?void 0:o.intensity)===Z.MO.FORCE&&un("force_login")):un("none"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),un("none");case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,T.useEffect)((function(){var e=P.Q.getItem({sKey:L.CookieKeys.Theme}),t=(0,U.Dr)(e)===L.ThemeValues.Dark;Dt(t);var n=A.listen(A.EVENT.changeTheme,(function(e){var t=e.theme;Dt(t===L.ThemeValues.Dark)}));return function(){null==n||n()}}),[et]);var yo=function(e){var t=p()(Wt).call(Wt,(function(t){return t.cid===e})).replyTotal||0;Bt((function(e){return e-(1+t)>=0?e-(1+t):0})),Vt((function(t){return g()(t).call(t,(function(t){return(null==t?void 0:t.cid)!==e}))}))},Co=function(e){var t,n;Bt((function(e){return e+1})),Vt((function(t){var n;return y()(n=[e]).call(n,(0,r.Z)(t))})),null==En||null===(t=En.current)||void 0===t||null===(n=t.scrollTo)||void 0===n||n.call(t,0,0)},Eo=function(e){var t=e.awemeInfo,n=e.getSearchTextUrl,o=e.onSearchTextClick,r=(0,T.useCallback)((function(e){var o,r,a,l;if(n)return n(e);var i="comment-header"===e.type?"comment_related_search":"comment_named_entity_search";return y()(o=y()(r=y()(a=y()(l="https://www.douyin.com/search/".concat(encodeURIComponent(e.searchText),"?source=")).call(l,i,"&enter_from=")).call(a,(0,O.vM)(),"&gid=")).call(r,t.groupId,"&aweme_id=")).call(o,t.awemeId)}),[n,t]),a=(0,T.useCallback)((function(e,n){var r=e.type,a=e.searchText,l=e.searchId,i=e.searchTextPos;Sn.sendLog("trendingWordsClick",{words_source:"comment-header"===r?"comment_related_search":"comment_named_entity_search",enter_group_id:t.awemeId,words_content:a,group_id:l,words_position:i,enter_from:(0,O.yW)()}),A.emit(A.EVENT.videoPause),o&&o(e,n)}),[o,t]),l=(0,T.useCallback)((function(e){var n=e.type,o=e.searchId,r=e.searchText,a=e.searchTextPos;Sn.sendLog("trendingWordsShow",{words_source:"comment-header"===n?"comment_related_search":"comment_named_entity_search",enter_group_id:t.awemeId,words_content:r,group_id:o,words_position:a,enter_from:(0,O.yW)()})}),[t]);return{headerSearchInfo:(0,T.useMemo)((function(){var e,n=(t||{}).suggestWords;if(!n)return undefined;var o=p()(e=n).call(e,(function(e){return e.scene===B.gQ.CommentTopRec}));if(o){var i=o.hintText,c=o.words;if(c.length)return{hintText:i,text:c[0].word,id:c[0].wordId,getSearchTextUrl:r,onSearchTextClick:a,onSearchTextMounted:l}}return undefined}),[t,r,a,l]),onSearchTextclick:a,getSearchTextUrl:r,onSearchTextMounted:l}}({awemeInfo:Ae,getSearchTextUrl:ot,onSearchTextClick:at}),_o=Eo.onSearchTextclick,wo=Eo.getSearchTextUrl,xo=Eo.headerSearchInfo,ko=Eo.onSearchTextMounted,So={diggCommentItem:Le,deleteCommentItem:Re,puhlishCommentItem:Be,fetchEmoticonGif:Me,fetchCommentMetionList:De,setSelectedReply:qt,currentReplyCid:Qt,setCurrentReplyCid:Yt,isDetail:D,isSearch:te,isNeedCommentInput:He,scrollCid:rn,container:En.current,changeLoginStatus:Ke,toast:go,reportExtraParams:Je,getSearchTextUrl:wo,onSearchTextClick:_o,onSearchTextMounted:ko,isActive:st,abtestData:et,awemeInfo:Ae},bo=function(e){return function(t){var n,o,r,l;null==t||null===(n=t.preventDefault)||void 0===n||n.call(t),(0,ze.default)({success:(l=(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ke?Ke():window.location.reload();case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),enterMethod:"comment",headerText:e,next:"https://".concat(null===(o=window)||void 0===o||null===(r=o.location)||void 0===r?void 0:r.host)})}};(0,T.useImperativeHandle)(t,(function(){return{reset:function(){gn.current=0,yn.current=!0,Cn.current=0,_n.current=!1,xn.current=0,Vt([]),tn(0),No()}}}));var To=function(e,t){for(var n=[],o=function(o){p()(e).call(e,(function(e){var n;return(null==e?void 0:e.cid)===(null===(n=t[o])||void 0===n?void 0:n.cid)}))||n.push(t[o])},r=0;r<t.length;r++)o(r);return n},No=T.useCallback((0,a.Z)(u().mark((function e(){var t,n,o,a,l,i,c,s,m,f,v,g,h,C,_,x,k,S,b,T,N,I;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(1===xn.current&&We||(In.current||Fn.current)&&!Nn)){e.next=2;break}return e.abrupt("return");case 2:if(_n.current||!yn.current){e.next=30;break}return _n.current=!0,t=(0,j.sb)(),e.prev=5,e.next=8,vn.current(gn.current,t===j.CK.Auto?Math.min(10,fn):fn,t,kn,ke,hn.current);case 8:if(l=e.sent,c=(i=l||{}).statusCode,s=i.comments,m=i.cursor,f=i.hasMore,v=i.hotsoonHasMore,g=i.total,h=i.whaleInfo,C=Hn(L.LocalStorageKeys.CommentBlock),_=C.actionClose,x=_||Un,hn.current=null==h?void 0:h.whaleCutToken,Bn.current+s.length>=20&&Vn.current&&!Nn&&(1===(null==et||null===(n=et.commentBlock)||void 0===n?void 0:n.type)||E()(o=[2,3,4]).call(o,null==et||null===(a=et.commentBlock)||void 0===a?void 0:a.type)&&!x)&&(Fn.current=!0),Nn||(null==h?void 0:h.whaleDecisionCustom)!==uo||(In.current=!0),ke&&xn.current<1&&(0===(null==s?void 0:s.length)&&$n.F.info("\u6b64\u8bc4\u8bba\u5df2\u88ab\u5220\u9664"),S=null==s?void 0:s[0],b=null==s||null===(k=s[0])||void 0===k?void 0:k.replyComment,T=S&&(null==S?void 0:S.cid)!==ke,N=!(null!=b&&p()(b).call(b,(function(e){return e.cid===ke}))),T&&N&&$n.F.info("\u6b64\u8bc4\u8bba\u5df2\u88ab\u5220\u9664"),(null==S?void 0:S.cid)===ke&&"0"!==(null==S?void 0:S.replyId)&&($n.F.info("\u8bc4\u8bba\u5bf9\u8bdd\u5df2\u5220\u9664"),s.length>1&&w()(s).call(s,0,1))),xn.current<1&&xn.current++,!wn.current){e.next=19;break}return e.abrupt("return");case 19:tn(c),0===c&&(gn.current=m,yn.current=f,Cn.current=v,Vt((function(e){var t;return y()(t=[]).call(t,(0,r.Z)(e),(0,r.Z)(To(e,s)))})),Bt(g),eo.current=d()()),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),tn(-1);case 26:_n.current=!1,Ut(!1),I=io.cy.getPreloadCache(io.mM.COMMENT_BTN_CLICKED),Pt&&Nt===R.lT.Recommend&&I&&M.i.sendLog("webCommentLoadDuration",{load_duration:d()()-(null==to?void 0:to.current),is_ad:null!=Ae&&Ae.isAds?1:0});case 30:case"end":return e.stop()}}),e,null,[[5,23]])}))),[fn,ke,Bt,We,Nn,et,Un]);(0,T.useEffect)((function(){var e=c()((function(e){if(e&&(0,j.i0)(j.CK.User),En&&En.current){var t=En.current,n=t.clientHeight,o=t.scrollHeight;t.scrollTop+n+250>o&&No()}}),200);return(Ne=D?Ne||document:En.current)&&yn.current&&0===en&&(Ne.addEventListener("scroll",e),Ne.addEventListener("wheel",e),Ne.addEventListener("DOMMouseScroll",e),window.addEventListener("resize",e),e()),function(){Ne&&yn.current&&(Ne.removeEventListener("scroll",e),Ne.removeEventListener("wheel",e),Ne.removeEventListener("DOMMouseScroll",e),window.removeEventListener("resize",e))}}),[Ne,No,en,sn,En.current,et]),(0,T.useEffect)((function(){var e,t=c()((function(){((null==Xe?void 0:Xe.duration)-(null==Xe?void 0:Xe.currentTime)<=5||(null==Ae?void 0:Ae.awemeType)===B.ed.Note)&&Ln(!0)}),5e3),n=function(){return Ln(!1)};return null==Xe||Xe.on("replay",n),null===(e=En.current)||void 0===e||e.addEventListener("scroll",t),function(){var e;null==Xe||Xe.off("replay",n),null===(e=En.current)||void 0===e||e.removeEventListener("scroll",t)}}),[Xe,et]);var Io,Zo,Mo=null;if(0===en)if(yn.current)Mo=4!==(null==et||null===(Io=et.commentBlock)||void 0===Io?void 0:Io.type)||!Fn.current||Un||Nn?null!=et&&null!==(Zo=et.commentBlock)&&void 0!==Zo&&Zo.type&&Fn.current&&!Un&&!Nn?T.createElement(so.E,{isDetail:D,blockNum:On,refBlockShowMore:Fn.current,handleJumpBlock:Wn,handleUnLogin:function(e){var t,n,o,r;null==e||null===(t=e.preventDefault)||void 0===t||t.call(e),(0,ze.default)({success:(r=(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ke?Ke():window.location.reload();case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)}),enterMethod:"comment_force_click",headerText:"\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u8bc4\u8bba",next:"https://".concat(null===(n=window)||void 0===n||null===(o=n.location)||void 0===o?void 0:o.host)})},text:"\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u8bc4\u8bba",blockText:"\u8df3\u8fc7\u767b\u5f55\uff0c\u7ee7\u7eed\u770b\u8bc4\u8bba",enterMethod:"comment_force_click",onShow:function(){var e,t;E()(e=[2,3,4]).call(e,null==et||null===(t=et.commentBlock)||void 0===t?void 0:t.type)&&Vn.current&&Pn((function(e){var t=e<2?e+1:e;return(0,F.qQ)(L.LocalStorageKeys.CommentBlock,{total:t,lastTimes:d()()}),t}))}}):In.current&&!Nn?T.createElement("div",{className:I()(Q.Z.loginBtnWrapper,(0,o.Z)({},Q.Z.isDetail,D))},T.createElement("div",null,"\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u8bc4\u8bba"),T.createElement(rt.zx,{className:Q.Z.loginBtn,onClick:bo("\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u8bc4\u8bba")},"\u7acb\u5373\u767b\u5f55")):We&&1===xn.current?T.createElement("div",{className:Q.Z.firstReqBtnWrapper},T.createElement(rt.zx,{style:{width:"100%"},theme:"border",size:"small",type:"secondary",onClick:(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xn.current++,e.next=3,No();case 3:case"end":return e.stop()}}),e)})))},"\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a")):T.createElement(gt.g,{className:"",text:"\u52a0\u8f7d\u4e2d"}):T.createElement(so.w,{close:function(){Fn.current=!1,jn(!0),(0,F.qQ)(L.LocalStorageKeys.CommentBlock,{lastTimes:d()(),actionClose:!0})},blockNum:On,enterMethod:"comment_force_qrcode",change:function(){wt({type:"updateUserInfo"}),Fn.current=!1},onShow:function(){Pn((function(e){var t=e<2?e+1:e;return(0,F.qQ)(L.LocalStorageKeys.CommentBlock,{total:t,lastTimes:d()()}),t}))},text:"\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u8bc4\u8bba",notAnimate:!0});else if(Cn.current){var Do;Mo=T.createElement("p",{className:I()(Q.Z.noMoreText,(Do={},(0,o.Z)(Do,Q.Z.isDetail,D),(0,o.Z)(Do,Q.Z.isSwiper,!D),Do))},"\u90e8\u5206\u8bc4\u8bba\u56e0\u672a\u6388\u6743\u6296\u97f3\uff0c\u6682\u4e0d\u652f\u6301\u67e5\u770b")}else 0===Wt.length?(Pt&&Ut(!1),Mo=T.createElement("div",{className:I()(Q.Z.noMoreText,Q.Z.noText,(0,o.Z)({},Q.Z.isDetail,D))},T.createElement(ht.xH,{desc:"\u6682\u65e0\u8bc4\u8bba",title:"",className:I()(Q.Z.emptyComment,(0,o.Z)({},Q.Z.isDetail,D))})),!0):Mo=T.createElement("div",{className:I()(Q.Z.noMoreText,(0,o.Z)({},Q.Z.isDetail,D))},"\u6682\u65f6\u6ca1\u6709\u66f4\u591a\u8bc4\u8bba");else Mo=T.createElement(mo,{reload:function(){tn(0),No()}});return T.createElement(Ue.X.Provider,{value:So},T.createElement("div",{className:I()(Q.Z.commentContainer,nt,(0,o.Z)({},Q.Z.isDetail,D))},T.createElement("div",{className:Q.Z.commentToastContainer,ref:vo}),D?T.createElement("div",{className:I()(Q.Z.detailCommentHeader,(0,o.Z)({},Q.Z.hide,!D))},T.createElement("div",{className:Q.Z.detailDividWrap},T.createElement("span",{className:I()(Q.Z.title,"comment-title")},"\u5168\u90e8\u8bc4\u8bba"),T.createElement("div",{className:Q.Z.divider},T.createElement(yt.i,null))),T.createElement("div",{className:Q.Z.commentInputContainer},Nn?T.createElement(T.Fragment,null,T.createElement("div",{className:Q.Z.avatar},T.createElement($.a,{href:globalThis.xssNamespace.douyin_web.filterUrl((0,W.HC)(null==Tn?void 0:Tn.secUid,"enter_method=comment"),null,{logType:"js.href/src",mode:"black",reportOnly:!1}),target:"_blank",rel:"noopener noreferrer"},T.createElement(Ct.q,{src:globalThis.xssNamespace.douyin_web.filterUrl(null==Tn?void 0:Tn.avatarUrl,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),type:"extraSmall",alt:"".concat(null==Tn?void 0:Tn.nickname,"\u5934\u50cf")}))),T.createElement("div",{className:Q.Z.commentInput,onClickCapture:ho},T.createElement($e,{fullScreenTarget:Ve,isLogin:!0,puhlishCommentItem:Be,fetchEmoticonGif:Me,fetchCommentMetionList:De,publishComment:Co,awemeInfo:Ae,changeLoginStatus:Ke,shortcutDisable:Qe,shortcutMode:Ye,isShowComment:ce,isSwiper:!D,commentLoadedTime:eo.current,abtestData:et,reportExtraParams:Je}))):!qe&&T.createElement(T.Fragment,null,T.createElement("div",{className:Q.Z.avatar},T.createElement("div",{onClick:bo("\u767b\u5f55\u5373\u53ef\u53d1\u8868\u8bc4\u8bba")},T.createElement(Pe.Z,{src:globalThis.xssNamespace.douyin_web.filterUrl(Mt?q.Z:G.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),viewBox:"0 0 42 42",width:40,height:40}))),T.createElement("div",{className:Q.Z.commentInput},T.createElement($e,{fullScreenTarget:Ve,isLogin:!1,changeLoginStatus:Ke,commentLoadedTime:eo.current,abtestData:et})))),Boolean(qe)&&Boolean(xo||mt)&&T.createElement("div",{className:Q.Z.searchTip},T.createElement(ee,{keywordList:xo&&!p()(s=mt||[]).call(s,(function(e){return e===xo.text}))?y()(m=[xo.text]).call(m,(0,r.Z)(mt||[])):mt})),xo&&!qe&&T.createElement("div",{className:Q.Z.searchTip},T.createElement(Y.Z,xo))):T.createElement("div",{className:I()(Q.Z.relatedCommentHeader,(0,o.Z)({},Q.Z.hide,D))},T.createElement(Et.eD,{className:I()(Q.Z.enhanceDownloadBar,(0,o.Z)({},Q.Z.videoPageComment,po)),downloadHintClassName:Q.Z.enhanceDownloadHint,isShow:ro,hintText:"\u4e0b\u8f7d\u5ba2\u6237\u7aef\uff0c\u53ca\u65f6\u63a5\u6536\u8bc4\u8bba\u56de\u590d",style:{marginTop:"12px"},showDivider:!0,defaultHeighlight:fo,log:{enterFrom:(0,V.p)()?"":(0,O.vM)(),type:"comment"},showAnimation:!0}),!Nn&&E()(f=["login_guide"]).call(f,sn)&&0!==Wt.length&&!(null!=et&&null!==(v=et.commentBlock)&&void 0!==v&&v.type)&&T.createElement(dt,{change:function(e){un(e)},success:Ke,commentLoginType:sn}),Nn&&(xt||ke)&&T.createElement(lo,{scene:ke?z.bu.CommentMentioned:z.bu.Comment,isShowComment:ce,commentGuideType:kt,setGlobalGuideType:St,setShowTrayPushGuide:bt}),T.createElement(X.Z,{commentCount:Rt||ae,onCloseClick:le,headerSearchInfo:xo,tipTextAfter:it})),T.createElement("div",{ref:En,"data-e2e":"comment-list",className:I()(Q.Z.commentMainContent,"comment-mainContent",(h={},(0,o.Z)(h,Q.Z.mainContent,!D),(0,o.Z)(h,Q.Z.flex,Pt&&!D),h))},!Nn&&"force_login"===sn&&!D&&T.createElement(dt,{change:un,success:Ke,commentLoginType:sn}),E()(C=["force_login"]).call(C,sn)?null:T.createElement(T.Fragment,null,k()(_=b()(Wt).call(Wt,0,Un||!Fn.current||Nn?1e4:21)).call(_,(function(e){return T.createElement(Jn,{fullScreenTarget:Ve,userInfo:Tn,isSpider:qe,awemeInfo:Ae,key:e.cid,defaultCommentId:ke,commentInfo:e,fetchReply:Ze,scrollContainerEl:D?En.current:Ne,awemelogPb:je,deleteComment:yo,commentLoadedTime:eo.current,player:Xe,renderTextWithTag:_t,abtestData:et,dispatch:wt,isLogin:Nn,changeLoginStatus:Ke,setBlockNum:Pn,loginBlock:Vn.current,actionCloseBlock:Un,setActionCloseBlock:jn})})),!qe&&Mo),!Nn&&E()(x=["login_guide","force_login"]).call(x,sn)&&"video_detail"===(0,O.yW)()&&((0,V.p)()||!(0,H.r)())&&0!==Wt.length&&!In.current&&!Vn.current&&("force_login"===sn?T.createElement(ft,{change:un,success:function(){Ke(),pn(20)},commentLoginType:sn}):T.createElement(pt,{change:un,success:function(){Ke(),pn(20)},commentLoginType:sn}))),!D&&!E()(S=["login_guide","force_login"]).call(S,sn)&&He&&T.createElement("div",{className:I()(Q.Z.swiperInput,"comment-input-container")},T.createElement("div",{className:I()("comment-input-linear-bg",(0,o.Z)({},Q.Z.linearBG,no))}),T.createElement($e,{changeLoginStatus:Ke,fullScreenTarget:Ve,isLogin:Nn,puhlishCommentItem:Be,fetchEmoticonGif:Me,fetchCommentMetionList:De,placeHolder:(null==Gt?void 0:Gt.nickName)&&"\u56de\u590d@".concat(null==Gt?void 0:Gt.nickName),replyText:null==Gt?void 0:Gt.text,level:(null==Gt?void 0:Gt.level)||0,levelOneCid:null==Gt?void 0:Gt.levelOneCid,cid:null==Gt?void 0:Gt.cid,publishComment:function(e){var t;null==Gt||null===(t=Gt.setIsShowCommentInput)||void 0===t||t.call(Gt,!1),Gt.cid?(null==Gt||Gt.publishComment(e),an(null==e?void 0:e.cid)):Co(e),ao("comment"),qt({})},isSwiper:!D,isSearch:te,isCollapse:oe,awemeInfo:Ae,shortcutDisable:Qe,shortcutMode:Ye,isShowComment:ce,reportExtraParams:Je,commentLoadedTime:eo.current,abtestData:et,cancelReplyFn:function(){qt({}),Yt("")},setSelectedReply:qt,setShowTrayPushGuide:bt}))||null))}var po=T.forwardRef(fo)},19909:function(e,t,n){n.d(t,{X:function(){return o}});var o=(0,n(53864).createContext)(null)},30974:function(e,t,n){n.d(t,{Z:function(){return ut}});var o=n(32781),r=n(85792),a=n.n(r),l=n(53864),i=n(37128),c=n(82735),s=n(79705),u=n.n(s),m=n(97876),d=n(5277),f=n(94116),p=n(19478),v=n.n(p),g=(0,l.createContext)(null),h=n(64408),y=n(65146),C=n(5594),E=n.n(C),_=n(34346),w=n.n(_),x=n(41723),k={container:"uxFwVq1V",innerContainer:"nA8iIE7L",avatar:"ERJRUUeZ",isSearch:"mWkkadd_",atIcon:"tbZ5lMYz",middle:"_JigjYhg",reload:"iVUPnZpC"},S=n(75422),b=n(19909);function T(e){var t=e.searchText;return l.createElement("div",{className:k.middle},t?"\u6ca1\u6709\u641c\u7d22\u5230\u76f8\u5173\u7528\u6237":"\u6ca1\u6709\u6570\u636e")}function N(e){var t=e.isMiddle;return l.createElement("div",{className:u()((0,y.Z)({},k.middle,t))},l.createElement(S.g,null))}function I(e){var t=e.isMiddle,n=e.onLoadMoreData;return l.createElement("div",{className:u()((0,y.Z)({},k.middle,t))},"\u7528\u6237\u4fe1\u606f\u83b7\u53d6\u5931\u8d25\uff0c\u8bf7",l.createElement("span",{className:k.reload,onMouseDown:function(){n()}},"\u5237\u65b0"),"\u91cd\u8bd5")}function Z(e){var t,n,o=e.suggestData,r=e.searchText,a=e.onLoadMoreData,i=e.isLoading,c=null;if(0===(null==o?void 0:o.statusCode)||i)if(null!=o&&o.hasMore){var s;c=l.createElement(N,{isMiddle:0===(null==o||null===(s=o.data)||void 0===s?void 0:s.length)})}else null!=o&&o.hasFetchData&&0===(null==o||null===(t=o.data)||void 0===t?void 0:t.length)&&(c=l.createElement(T,{searchText:r}));else c=l.createElement(I,{isMiddle:0===(null==o||null===(n=o.data)||void 0===n?void 0:n.length),onLoadMoreData:a});return c}function M(e){var t=e.children,n=e.className,r=e.targetEl,a=e.isSearch,i=e.searchText,c=e.onLoadMoreData,s=e.suggestData,m=(0,l.useRef)(null),d=(0,l.useState)(null),f=(0,o.Z)(d,2),p=f[0],C=f[1],_=(0,l.useState)(!1),w=(0,o.Z)(_,2),S=w[0],T=w[1],N=(0,l.useRef)(null),I=(0,l.useRef)(!1),M=(0,l.useContext)(b.X),D=(null!=M?M:{}).isDetail,L=((0,l.useContext)(g)||{}).refOuterContainer,R=((0,x.D)(r,p,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,16]}}]}).styles,(0,l.useCallback)((function(){var e;return D?{}:{marginTop:-((null==L||null===(e=L.current)||void 0===e?void 0:e.offsetHeight)+176)}}),[]));N.current=c;var B=(0,l.useCallback)(v()((0,h.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}return e.abrupt("return");case 2:if(!I.current){e.next=4;break}return e.abrupt("return");case 4:if(!(p.scrollTop+p.clientHeight+100>p.scrollHeight)){e.next=7;break}return e.next=7,null===(t=N.current)||void 0===t?void 0:t.call(N);case 7:case"end":return e.stop()}}),e)}))),500),[p]);return(0,l.useEffect)((function(){p&&(p.scrollTop=0)}),[i,p]),(0,l.useEffect)((function(){return p&&0===(null==s?void 0:s.statusCode)&&null!=s&&s.hasMore?(I.current=!1,p.addEventListener("scroll",B),function(){I.current=!0,p&&p.removeEventListener("scroll",B)}):undefined}),[p,B,s]),l.createElement("div",{className:u()(k.container,n,"atBox-outside-container",k.atIcon),ref:C,style:R(),onMouseDown:function(e){e.preventDefault()}},l.createElement("div",{className:u()(k.innerContainer,"atBox-inner-container",(0,y.Z)({},k.isSearch,a)),ref:m},t),l.createElement(Z,{suggestData:s,searchText:i,isLoading:S,onLoadMoreData:(0,h.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,c();case 3:T(!1);case 4:case"end":return e.stop()}}),e)})))}))}function D(e){var t=e.children,n=e.store,o=(0,l.useContext)(g),r=o.onLoadMoreData,a=o.suggestData,i=o.searchText,c=o.isAtIconSelected;return l.createElement(M,{searchText:i,targetEl:null==n?void 0:n.getReferenceElement(),onLoadMoreData:r,suggestData:a,isAtIconSelected:c},t)}var L=n(67161),R=n(72603),B=n(33120),A=n(65902),O=n(96716),P=n(70378),U={container:"MQjBw4F0",userName:"nJneFzVg",innerContainer:"dyt4sciY",icon:"hH2pmaeY",mask:"M0xR1Ijf"},j=n(9909),F=n(51078),W=["className","mention","awemeInfo","selectOn","onClick"];function V(e){var t=e.className,n=e.mention,r=e.awemeInfo,a=e.selectOn,i=e.onClick,c=(0,L.Z)(e,W),s=(0,l.useState)(!1),m=(0,o.Z)(s,2),d=m[0],f=m[1],p=(0,O.x)((function(){B.Z.sendLog("commentAtShow",{author_id:"".concat(null==r?void 0:r.authorUserId),group_id:null==r?void 0:r.awemeId,log_pb:null==r?void 0:r.logPb,enter_from:(0,R.vM)(),to_user_id:null==n?void 0:n.uid})})),v=(0,l.useCallback)((function(e){null==i||i(e),a&&f((function(e){return!e}))}),[i,a]),g=(0,l.useCallback)((function(){return l.createElement("i",{className:U.mask})}),[]);return l.createElement("div",(0,A.Z)({className:u()(U.container,t),onClick:function(e){return v(e)}},c,{ref:p}),l.createElement("div",{className:U.innerContainer},d?l.createElement(j.Z,{width:14,height:14,viewBox:"0 0 14 14",src:globalThis.xssNamespace.douyin_web.filterUrl(P.Z,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),className:U.icon}):null,l.createElement(F.q,{src:globalThis.xssNamespace.douyin_web.filterUrl(n.avatarUri,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),type:"extraSmall",maskConf:{showMask:d,MaskItem:g}}),l.createElement("span",{className:U.userName},n.remarkName||n.nickname||"")))}var H=["children","mention","onMouseDown","onMouseUp","onMouseEnter"];function K(e){e.children;var t,n=e.mention,o=e.onMouseDown,r=e.onMouseUp,a=e.onMouseEnter,i=((0,L.Z)(e,H),(0,l.useContext)(g).awemeInfo);return l.createElement("div",(t={onMouseDown:o,onMouseUp:r,onMouseEnter:a},(0,y.Z)(t,"onMouseDown",(function(e){o(e)})),(0,y.Z)(t,"onMouseDownCapture",(function(e){o(e)})),(0,y.Z)(t,"onMouseUp",(function(e){B.Z.sendLog("commentAtClick",{author_id:"".concat(null==i?void 0:i.authorUserId),group_id:null==i?void 0:i.awemeId,log_pb:null==i?void 0:i.logPb,enter_from:(0,R.vM)(),to_user_id:null==n?void 0:n.uid}),r(e)})),(0,y.Z)(t,"onClick",(function(e){r(e)})),(0,y.Z)(t,"onMouseEnter",(function(){})),t),l.createElement(V,{mention:n,awemeInfo:i}))}function G(e){var t=e.SuggestionComponent,n=e.loadSearchAtData,r=e.loadMoreDefaultAtData,a=e.atUserDefaultData,i=e.atUserSearchData,c=e.awemeInfo,s=e.editorState,u=e.addUserMention,m=e.isAtIconSelected,d=e.setIsAtIconSelected,f=e.refOuterContainer,p=e.setIsAtIconPoint,h=(0,l.useState)(!1),y=(0,o.Z)(h,2),C=y[0],E=y[1],_=(0,l.useState)(null==i?void 0:i.searchText),w=(0,o.Z)(_,2),x=w[0],k=w[1],S=(0,l.useMemo)((function(){return(null==i?void 0:i.hasMore)&&m}),[i,m]),T=(0,l.useMemo)((function(){return x?i:a}),[i,a,x]),N=(0,l.useContext)(b.X),I=(null!=N?N:{}).isActive,Z=void 0===I||I;(0,l.useEffect)((function(){(C||m)&&0===a.data.length&&0===a.statusCode&&a.hasMore&&r()}),[C,a,r,m,Z]),(0,l.useEffect)((function(){Z||E(!1)}),[Z]),(0,l.useEffect)((function(){x&&n(x)}),[x]);var M={onLoadMoreData:(0,l.useCallback)((function(){return x?n(x):r()}),[x,n,r]),suggestData:T,searchText:x,awemeInfo:c,editorState:s,addUserMention:u,isAtIconSelected:m,setIsAtIconSelected:d,refOuterContainer:f,setIsAtIconPoint:p},L=(0,l.useCallback)(v()((function(e){k(e.value)}),300,{leading:!1,trailing:!0}),[]);return l.createElement(g.Provider,{value:M},l.createElement(t,{open:C,onOpenChange:function(e){E(e)},suggestions:T.data,onSearchChange:function(e){L(e)},renderEmptyPopup:S,popperOptions:{loadMoreDefaultAtData:r,loadSearchAtData:n,suggestData:T,searchText:x},popoverContainer:D,entryComponent:K,hasMore:null==T?void 0:T.hasMore,isActive:Z}))}var q=n(30673),z=n(30906),X=(n(11766),n(56442)),Q=n.n(X),Y=n(8e3),J=n.n(Y),$=n(82766),ee=n.n($),te=n(94090),ne=n.n(te),oe=n(77007),re=n(92942),ae=n.n(re),le=n(22700),ie=n.n(le);var ce=function(e,t,n){var o=t.getAnchorKey(),r=t.getAnchorOffset();return function(e,t,n){var o,r=e.substr(0,t),a=w()(n).call(n,(function(e){return ie()(e)})).join("|"),l=new RegExp("(".concat(a,")"),"g"),i=ae()(r).call(r,l),c=0,s=0,u=(0,oe.Z)(i);try{for(u.s();!(o=u.n()).done;){var m=o.value,d=m[1].length;s=(c=m.index||0)+d}}catch(p){u.e(p)}finally{u.f()}var f=Q()(r).call(r,s);return{begin:c,end:r.length,matchingString:f}}(e.getCurrentContent().getBlockForKey(o).getText(),r,n)};function se(e){return"@"===e?"mention":"".concat(e,"mention")}function ue(e,t,n,o,r){var a,l=e.getCurrentContent().createEntity(se(o),r,{mention:t}).getLastCreatedEntityKey(),c=e.getSelection(),s=ce(e,c,[o]),u=s.begin,m=s.end,d=c.merge({anchorOffset:u,focusOffset:m}),f=i.Modifier.replaceText(e.getCurrentContent(),d,ne()(a="".concat(n)).call(a,t.name),undefined,l),p=d.getAnchorKey();e.getCurrentContent().getBlockForKey(p).getLength()===m&&(f=i.Modifier.insertText(f,f.getSelectionAfter()," "));var v=i.EditorState.push(e,f,"insert-fragment");return i.EditorState.forceSelection(v,f.getSelectionAfter())}function me(e,t,n){var o=[],r=-1;return t.findEntityRanges((function(t){var a=t.getEntity();if(!a)return!1;var l=e.getEntity(a),i="mention"===l.getType();if(i){var c,s,u=l.getData();o[++r]={user_id:null===(c=u.mention)||void 0===c?void 0:c.uid,sec_uid:null===(s=u.mention)||void 0===s?void 0:s.secUid,type:0,start:n+0,end:n+0}}return i}),(function(e,t){o[r]=(0,z.Z)((0,z.Z)({},o[r]),{},{start:n+e,end:n+t})})),o}function de(e){var t=e.getCurrentContent(),n=t.getFirstBlock(),o=t.getLastBlock(),r=n.getKey();if(r===o.getKey())return me(t,n,0);for(var a=[],l=r,i=0;l;l=t.getKeyAfter(l)){var c=t.getBlockForKey(l);a.push.apply(a,(0,q.Z)(me(t,c,i))),i+=c.text.length+1}return a}var fe=function(e){for(var t=e.getCurrentContent().getBlocksAsArray(),n=[],o=0;o<t.length;o++)n.push(t[o].text);return n.join("\n")},pe=13,ve=n(50698),ge=n(92911);function he(e){var t=e.mention,n=e.children,o=e.className;return l.createElement("a",{href:globalThis.xssNamespace.douyin_web.filterUrl(t.link,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),className:o,spellCheck:!1,"data-testid":"mentionLink"},n)}function ye(e){var t=e.children,n=e.className;return l.createElement("span",{className:n,spellCheck:!1,"data-testid":"mentionText"},t)}function Ce(e){var t=e.entityKey,n=e.theme,o=void 0===n?{}:n,r=e.mentionComponent,a=e.children,i=e.decoratedText,c=e.className,s=e.contentState,u=(0,ge.Z)(o.mention,c),m=s.getEntity(t).getData().mention,d=r||(m.link?he:ye);return l.createElement(d,{entityKey:t,mention:m,theme:o,className:u,decoratedText:i},a)}var Ee=n(19049),_e=n(95508),we=n(73316),xe=n(6670),ke=n(78034),Se=n(95140),be=n.n(Se),Te=n(97951),Ne=n.n(Te),Ie=function(e){var t=e.onMentionSelect,n=e.mention,o=e.theme,r=e.index,a=e.onMentionFocus,i=e.isFocused,c=e.id,s=e.searchValue,u=e.entryComponent,m=(0,l.useRef)(!1),d=(0,l.useRef)(null);(0,l.useEffect)((function(){i&&requestAnimationFrame((function(){var e;return null===(e=d.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth",block:"nearest"})}))}),[i]),(0,l.useEffect)((function(){m.current=!1}));var f=i?o.mentionSuggestionsEntryFocused:o.mentionSuggestionsEntry;return l.createElement("div",{ref:d},l.createElement(u,{className:f,onMouseDown:function(e){e.preventDefault(),m.current=!0},onMouseUp:function(){m.current&&(t(n),m.current=!1)},onMouseEnter:function(){a(r)},role:"option",id:c,"aria-selected":i?"true":undefined,theme:o,mention:n,isFocused:i,searchValue:s}))};Ie.propTypes={entryComponent:Ne().any.isRequired,searchValue:Ne().string,onMentionSelect:Ne().func};var Ze=Ie;function Me(e){var t=e.mention,n=e.theme,o=void 0===n?{}:n;return t.avatar?l.createElement("img",{src:globalThis.xssNamespace.douyin_web.filterUrl(t.avatar,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),className:o.mentionSuggestionsEntryAvatar,role:"presentation"}):null}var De=["mention","theme","isFocused","searchValue"];function Le(e){var t=e.mention,n=e.theme,o=(e.isFocused,e.searchValue,(0,L.Z)(e,De));return l.createElement("div",o,l.createElement(Me,{mention:t,theme:n}),l.createElement("span",{className:null==n?void 0:n.mentionSuggestionsEntryText},t.name))}var Re=function e(t){return t?"static"!==window.getComputedStyle(t).getPropertyValue("position")?t:e(t.parentElement):null};function Be(e){var t,n=e.decoratorRect,o=e.popover,r=e.props,a=Re(o.parentElement);if(a){var l=a.getBoundingClientRect();t={scrollLeft:a.scrollLeft,scrollTop:a.scrollTop,left:n.left-l.left,top:n.bottom-l.top}}else t={scrollTop:window.pageYOffset||document.documentElement.scrollTop,scrollLeft:window.pageXOffset||document.documentElement.scrollLeft,top:n.bottom,left:n.left};var i,c,s=t.left+t.scrollLeft,u=t.top+t.scrollTop;return r.open&&(r.suggestions.length>0?(i="scale(1)",c="all 0.25s cubic-bezier(.3,1.2,.2,1)"):(i="scale(0)",c="all 0.35s cubic-bezier(.3,1,.2,1)")),{left:"".concat(s,"px"),top:"".concat(u,"px"),transform:i,transformOrigin:"1em 0%",transition:c}}var Ae=n(101),Oe=n.n(Ae),Pe=n(29809),Ue=n.n(Pe),je=function(e){var t=e.split("-"),n=(0,o.Z)(t,3),r=n[0],a=n[1],l=n[2];return{blockKey:r,decoratorKey:Ue()(a,10),leafKey:Ue()(l,10)}};function Fe(e){return e!==undefined}function We(e){var t=e.store,n=e.children,r=e.theme,a=e.popperOptions,i=void 0===a?{placement:"bottom-start"}:a,c=(0,l.useState)((function(){return(0,ge.Z)(r.mentionSuggestions,r.mentionSuggestionsPopup)})),s=(0,o.Z)(c,2),u=s[0],m=s[1],d=(0,l.useState)(null),f=(0,o.Z)(d,2),p=f[0],v=f[1],g=(0,x.D)(t.getReferenceElement(),p,i),h=g.styles,y=g.attributes;return(0,l.useEffect)((function(){requestAnimationFrame((function(){return m((0,ge.Z)(r.mentionSuggestions,r.mentionSuggestionsPopup,r.mentionSuggestionsPopupVisible))}))}),[r]),l.createElement("div",(0,A.Z)({ref:v,style:h.popper},y.popper,{className:u}),n)}var Ve=n(76277),He=n.n(Ve)()((function(e){0})),Ke=["entryComponent","popoverComponent","popperOptions","popoverContainer","onOpenChange","onAddMention","onSearchChange","suggestions","ariaProps","callbacks","theme","store","entityMutability","positionSuggestions","mentionTriggers","mentionPrefix"],Ge=function(e){(0,xe.Z)(n,e);var t=(0,ke.Z)(n);function n(e){var r;return(0,Ee.Z)(this,n),r=t.call(this,e),(0,y.Z)((0,we.Z)(r),"state",{focusedOptionIndex:0}),(0,y.Z)((0,we.Z)(r),"key",(0,i.genKey)()),(0,y.Z)((0,we.Z)(r),"lastActiveTrigger",""),(0,y.Z)((0,we.Z)(r),"onEditorStateChange",(function(e){var t=r.props.store.getAllSearches();if(0===t.size)return e;var n=function(e,t,n){var r,a,l,i=e.getSelection(),c=i.getAnchorKey(),s=i.getAnchorOffset();if(!i.isCollapsed()||!i.getHasFocus())return null;var u=w()(t).call(t,(function(e){return je(e)})),m=w()(r=J()(u).call(u,(function(e){return e.blockKey===c}))).call(r,(function(t){var n;return null==e||null===(n=e.getBlockTree(t.blockKey))||void 0===n?void 0:n.getIn([t.decoratorKey])}));if(Oe()(m).call(m,(function(e){return e===undefined})))return null;var d=e.getCurrentContent().getBlockForKey(c).getText(),f=J()(a=w()(l=J()(m).call(m,Fe)).call(l,(function(e){var t,o=e.start,r=e.end;return J()(t=w()(n).call(n,(function(e){return 0===o&&s>=o+e.length&&d.substr(0,e.length)===e&&s<=r||n.length>1&&s>=o+e.length&&(d.substr(o+1,e.length)===e||d.substr(o,e.length)===e)&&s<=r||1===n.length&&s>=o+e.length&&s<=r?e:undefined}))).call(t,Fe)[0]}))).call(a,Fe);if(f.isEmpty())return null;var p=f.entrySeq().first(),v=(0,o.Z)(p,2);return{activeOffsetKey:v[0],activeTrigger:v[1]}}(e,t,r.props.mentionTriggers);if(!n)return r.props.store.resetEscapedSearch(),r.closeDropdown(),e;var a=r.activeOffsetKey;return r.activeOffsetKey=n.activeOffsetKey,r.onSearchChange(e,e.getSelection(),r.activeOffsetKey,a,n.activeTrigger),r.props.store.isEscaped(r.activeOffsetKey||"")||r.props.store.resetEscapedSearch(),r.props.open||r.props.store.isEscaped(r.activeOffsetKey||"")||r.openDropdown(),a!==r.activeOffsetKey&&r.setState({focusedOptionIndex:0}),e})),(0,y.Z)((0,we.Z)(r),"onSearchChange",(function(e,t,n,o,a){var l=ce(e,t,[a]).matchingString;r.lastActiveTrigger===a&&r.lastSearchValue===l&&n===o||(r.lastActiveTrigger=a,r.lastSearchValue=l,r.props.onSearchChange({trigger:a,value:l}))})),(0,y.Z)((0,we.Z)(r),"onDownArrow",(function(e){e.preventDefault();var t=r.state.focusedOptionIndex+1;r.onMentionFocus(t>=r.props.suggestions.length?0:t)})),(0,y.Z)((0,we.Z)(r),"onTab",(function(e){e.preventDefault(),r.commitSelection()})),(0,y.Z)((0,we.Z)(r),"onUpArrow",(function(e){if(e.preventDefault(),r.props.suggestions.length>0){var t=r.state.focusedOptionIndex-1;r.onMentionFocus(t<0?r.props.suggestions.length-1:t)}})),(0,y.Z)((0,we.Z)(r),"onEscape",(function(e){e.preventDefault(),r.props.store.escapeSearch(r.activeOffsetKey||""),r.closeDropdown(),r.props.store.setEditorState(r.props.store.getEditorState())})),(0,y.Z)((0,we.Z)(r),"onMentionSelect",(function(e){if(e){r.props.onAddMention&&r.props.onAddMention(e),r.closeDropdown();var t=ue(r.props.store.getEditorState(),e,r.props.mentionPrefix,r.lastActiveTrigger||"",r.props.entityMutability);r.props.store.setEditorState(t)}})),(0,y.Z)((0,we.Z)(r),"onMentionFocus",(function(e){var t,n=ne()(t="mention-option-".concat(r.key,"-")).call(t,e);r.props.ariaProps.ariaActiveDescendantID=n,r.setState({focusedOptionIndex:e}),r.props.store.setEditorState(r.props.store.getEditorState())})),(0,y.Z)((0,we.Z)(r),"commitSelection",(function(){var e=r.props.suggestions[r.state.focusedOptionIndex];return r.props.store.getIsOpened()&&e?(r.onMentionSelect(e),"handled"):"not-handled"})),(0,y.Z)((0,we.Z)(r),"openDropdown",(function(){var e;r.props.callbacks.handleReturn=r.commitSelection,r.props.callbacks.keyBindingFn=function(e){return 40===e.keyCode&&r.onDownArrow(e),38===e.keyCode&&r.onUpArrow(e),27===e.keyCode&&r.onEscape(e),9===e.keyCode&&r.onTab(e),undefined};var t=ne()(e="mention-option-".concat(r.key,"-")).call(e,r.state.focusedOptionIndex);r.props.ariaProps.ariaActiveDescendantID=t,r.props.ariaProps.ariaOwneeID="mentions-list-".concat(r.key),r.props.ariaProps.ariaHasPopup="true",r.props.ariaProps.ariaExpanded=!0,r.props.onOpenChange(!0)})),(0,y.Z)((0,we.Z)(r),"closeDropdown",(function(){r.props.callbacks.handleReturn=undefined,r.props.callbacks.keyBindingFn=undefined,r.props.ariaProps.ariaHasPopup="false",r.props.ariaProps.ariaExpanded=!1,r.props.ariaProps.ariaActiveDescendantID=undefined,r.props.ariaProps.ariaOwneeID=undefined,r.props.onOpenChange(!1)})),r.props.callbacks.onChange=r.onEditorStateChange,r}return(0,_e.Z)(n,[{key:"componentDidUpdate",value:function(){if(this.popover){var e=this.props.suggestions.length;if(e>0&&this.state.focusedOptionIndex>=e&&this.setState({focusedOptionIndex:e-1}),!this.props.store.getAllSearches().has(this.activeOffsetKey))return;for(var t=this.props.store.getPortalClientRect(this.activeOffsetKey),n=(this.props.positionSuggestions||Be)({decoratorRect:t,props:this.props,popover:this.popover}),r=0,a=be()(n);r<a.length;r++){var l=(0,o.Z)(a[r],2),i=l[0],c=l[1];this.popover.style[i]=c}}}},{key:"componentWillUnmount",value:function(){this.props.callbacks.onChange=undefined}},{key:"render",value:function(){var e=this;if(!this.props.open)return null;var t=this.props,n=t.entryComponent,o=t.popoverComponent,r=t.popperOptions,a=t.popoverContainer,i=void 0===a?We:a,c=(t.onOpenChange,t.onAddMention,t.onSearchChange,t.suggestions),s=(t.ariaProps,t.callbacks,t.theme),u=void 0===s?{}:s,m=(t.store,t.entityMutability,t.positionSuggestions),d=(t.mentionTriggers,t.mentionPrefix,(0,L.Z)(t,Ke));return o||m?(He("The properties `popoverComponent` and `positionSuggestions` are deprecated and will be removed in @draft-js-plugins/mentions 6.0 . Use `popperOptions` instead"),l.cloneElement(o||l.createElement("div",null),(0,z.Z)((0,z.Z)({},d),{},{className:u.mentionSuggestions,role:"listbox",id:"mentions-list-".concat(this.key),ref:function(t){e.popover=t}}),null==c?void 0:w()(c).call(c,(function(t,o){var r;return l.createElement(Ze,{key:null!==t.id?t.id:t.name,onMentionSelect:e.onMentionSelect,onMentionFocus:e.onMentionFocus,isFocused:e.state.focusedOptionIndex===o,mention:t,index:o,id:ne()(r="mention-option-".concat(e.key,"-")).call(r,o),theme:u,searchValue:e.lastSearchValue,entryComponent:n||Le})})))):this.props.renderEmptyPopup||0!==c.length?l.createElement(i,{store:this.props.store,popperOptions:r,theme:u},null==c?void 0:w()(c).call(c,(function(t,o){var r;return l.createElement(Ze,{key:null!==t.id?t.id:t.uid,onMentionSelect:e.onMentionSelect,onMentionFocus:e.onMentionFocus,isFocused:e.state.focusedOptionIndex===o,mention:t,index:o,id:ne()(r="mention-option-".concat(e.key,"-")).call(r,o),theme:u,searchValue:e.lastSearchValue,entryComponent:n||Le})}))):null}}]),n}(l.Component);(0,y.Z)(Ge,"propTypes",{open:Ne().bool.isRequired,onOpenChange:Ne().func.isRequired,entityMutability:Ne().oneOf(["SEGMENTED","IMMUTABLE","MUTABLE"]),entryComponent:Ne().func,onAddMention:Ne().func,suggestions:Ne().array.isRequired});var qe=Ge,ze="undefined"!=typeof window?l.useLayoutEffect:l.useEffect;function Xe(e){var t=(0,l.useRef)(),n=function(e){e.store.updatePortalClientRect(e.offsetKey,(function(){return t.current.getBoundingClientRect()}))};return ze((function(){return e.store.register(e.offsetKey),e.store.setIsOpened(!0),n(e),e.store.setEditorState(e.store.getEditorState()),function(){e.store.unregister(e.offsetKey),e.store.setIsOpened(!1),e.store.setReferenceElement(null)}}),[]),(0,l.useEffect)((function(){n(e)})),l.createElement("span",{ref:function(n){t.current=n,e.store.setReferenceElement(n)}},e.children)}var Qe=n(90457),Ye=n.n(Qe),Je=function(e){return function(t,n,o){t.findEntityRanges((function(t){var n=t.getEntity();return null!==n&&Ye()(e).call(e,(function(e){return o.getEntity(n).getType()===se(e)}))}),n)}},$e=/\s/;var et=function(e,t,n,o){var r=t.getText();t.findEntityRanges((function(e){return!e.getEntity()}),(function(t,a){var l=Q()(r).call(r,t,a);n?function(e,t,n,o){for(var r,a,l=e.lastIndex;null!==(r=e.exec(t))&&e.lastIndex!==l;){l=e.lastIndex;var i=(a=n+r.index)+r[0].length;r.index,o(a,i)}}(e,l,t,o):function(e,t,n,o){for(var r,a,l=e.lastIndex;null!==(r=e.exec(t))&&e.lastIndex!==l;){l=e.lastIndex;var i=(a=n+r.index)+r[0].length;$e.test(t[a])&&(a+=1),o(a,i)}}(e,l,t,o)}))},tt=n(97609),nt=n.n(tt),ot=n(58144),rt=n.n(ot),at=n(92524),lt=n.n(at),it=n(7793),ct=function(e){var t=e.suggestions,n=e.onSearchChange,o=e.popoverContainer,r=e.hasMore,a=o,c=(0,l.useContext)(g),s=c.editorState,u=c.awemeInfo,m=c.addUserMention,d=c.isAtIconSelected,f=c.setIsAtIconSelected,p=c.setIsAtIconPoint;return(0,it.Z)((function(){var e,t,o,r,a,l=s.getCurrentContent(),c=l.getPlainText(),u=s.getSelection().getAnchorOffset(),m=null===(e=(0,i.convertToRaw)(l))||void 0===e||null===(t=e.blocks)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.entityRanges,d=null==m||null===(r=nt()(m))||void 0===r||null===(a=r.call(m))||void 0===a?void 0:rt()(a).call(a,(function(e){return e.offset<u}));if(c)if(d){var v=d.offset+d.length,g=c.substring(v-1,u),h=lt()(g).call(g,"@");if(h>-1){var y=Q()(g).call(g,h+1);n({value:y})}else f(!1)}else{var C=lt()(c).call(c,"@");if(C>-1){var E=Q()(c).call(c,C+1);n({value:E})}else f(!1)}else f(!1),p(!1),n({value:""})}),[s,n]),d&&(null!=t&&t.length||!1!==r)?l.createElement(a,null,null==t?void 0:w()(t).call(t,(function(e){return l.createElement("div",{key:"search_".concat(e.uid),id:"search_".concat(e.uid)},l.createElement(V,{mention:e,awemeInfo:u,onClick:function(t){t.stopPropagation(),B.Z.sendLog("commentAtClick",{author_id:"".concat(null==u?void 0:u.authorUserId),group_id:null==u?void 0:u.awemeId,log_pb:null==u?void 0:u.logPb,enter_from:(0,R.vM)(),to_user_id:null==e?void 0:e.uid}),m(e),n({value:""}),f(!1),p(!1)}}))}))):null};n(11779);function st(e,t){var n=e.placeholder,r=e.onChange,s=e.loadSearchAtData,p=e.loadMoreDefaultAtData,v=e.atUserDefaultData,g=e.atUserSearchData,h=e.onEditFocus,y=e.onEditBlur,C=e.awemeInfo,E=e.handlePublishClick,_=e.isAtIconSelected,x=e.setIsAtIconSelected,k=e.refOuterContainer,S=e.setIsAtIconPoint,b=e.isAtIconPoint,T=e.className,N=e.readOnly,I=(0,l.useRef)(null),Z=(0,l.useRef)(null),M=(0,l.useState)((function(){return i.EditorState.createEmpty()})),D=(0,o.Z)(M,2),L=D[0],R=D[1],B=(0,l.useState)(!1),O=(0,o.Z)(B,2),P=O[0],U=O[1],j=(0,l.useMemo)((function(){return function(){var e,t,n,o,r,a,i,c,s,u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},m={keyBindingFn:undefined,handleKeyCommand:undefined,handleReturn:undefined,onChange:undefined},d={ariaHasPopup:"false",ariaExpanded:!1,ariaOwneeID:undefined,ariaActiveDescendantID:undefined},f=(0,ve.Map)(),p=(0,ve.Map)(),v=!1,g={getEditorState:undefined,setEditorState:undefined,getPortalClientRect:function(e){return p.get(e)()},getAllSearches:function(){return f},isEscaped:function(t){return e===t},escapeSearch:function(t){e=t},resetEscapedSearch:function(){e=undefined},register:function(e){f=f.set(e,e)},updatePortalClientRect:function(e,t){p=p.set(e,t)},unregister:function(e){f=f.delete(e),p=p.delete(e)},getIsOpened:function(){return v},setIsOpened:function(e){v=e},getReferenceElement:function(){return t},setReferenceElement:function(e){t=e}},h=u.mentionPrefix,y=void 0===h?"":h,C=u.theme,E=void 0===C?{}:C,_=u.positionSuggestions,x=u.mentionComponent,k=u.mentionSuggestionsComponent,S=void 0===k?qe:k,b=u.entityMutability,T=void 0===b?"SEGMENTED":b,N=u.mentionTrigger,I=void 0===N?"@":N,Z=u.mentionRegExp,M=void 0===Z?"[\\w-\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u0148\u014a-\u017f\u0410-\u044f\u3040-\u309f\u30a0-\u30ff\u3130-\u318f\uac00-\ud7a3\u4e00-\u9fa5\u0600-\u06ff\xc0-\u1ef9\u3002.><\u300b\u300a+\u3002\u3002,\uff0c]":Z,D=u.supportWhitespace,L=void 0!==D&&D,R=u.popperOptions,B="string"==typeof I?[I]:I,O={ariaProps:d,callbacks:m,theme:E,store:g,entityMutability:T,positionSuggestions:_,mentionTriggers:B,mentionPrefix:y,popperOptions:R};return{MentionSuggestions:function(e){return l.createElement(S,(0,A.Z)({},e,O))},decorators:[{strategy:Je(B),component:function(e){return l.createElement(Ce,(0,A.Z)({},e,{theme:E,mentionComponent:x}))}},{strategy:(n=B,o=L,r=M,c="(".concat(w()(n).call(n,(function(e){return ie()(e)})).join("|"),")"),s=o?new RegExp(ne()(a="".concat(c,"(")).call(a,r,"|\\s)*"),"g"):new RegExp(ne()(i="(\\s|^)".concat(c)).call(i,r,"*"),"g"),function(e,t){et(s,e,o,t)}),component:function(e){return l.createElement(Xe,(0,A.Z)({},e,{store:g}))}}],getAccessibilityProps:function(){return{role:"combobox",ariaAutoComplete:"list",ariaHasPopup:d.ariaHasPopup,ariaExpanded:d.ariaExpanded,ariaActiveDescendantID:d.ariaActiveDescendantID,ariaOwneeID:d.ariaOwneeID}},initialize:function(e){var t=e.getEditorState,n=e.setEditorState;g.getEditorState=t,g.setEditorState=n},keyBindingFn:function(e){return m.keyBindingFn&&m.keyBindingFn(e)},handleReturn:function(e){return m.handleReturn&&m.handleReturn(e)},onChange:function(e){return m.onChange?m.onChange(e):e}}}({entityMutability:"IMMUTABLE",mentionPrefix:"@",mentionTrigger:"@",supportWhitespace:!0,mentionComponent:function(e){return l.createElement("span",{className:u()(e.className,"douyin_mention_word")},e.children)}})}),[]),F=(j||{}).MentionSuggestions,W=[];W.unshift(j);var V=(0,l.useCallback)((function(e){var t=function(e,t){return ue(e,t,"@","@","IMMUTABLE")}(L,e);R(t),null==r||r(fe(t)),m.emit(m.EVENT.videoStopPlayNext)}),[L,r]);(0,l.useImperativeHandle)(t,(function(){return{addUserMention:function(e){var t=function(e,t){var n=e.getCurrentContent(),o=n.createEntity("mention","IMMUTABLE",{mention:t}).getLastCreatedEntityKey(),r=e.getSelection(),a=i.Modifier.removeRange(n,r,"backward"),l=i.Modifier.insertText(a,a.getSelectionAfter()," "),c=i.Modifier.insertText(l,l.getSelectionAfter(),"".concat("@").concat(t.name),undefined,o);c=i.Modifier.insertText(c,c.getSelectionAfter()," ");var s=i.EditorState.push(e,c,"insert-fragment");return i.EditorState.forceSelection(s,c.getSelectionAfter())}(L,e);R(t),null==r||r(fe(t)),m.emit(m.EVENT.videoStopPlayNext)},addEmoji:function(e){var t=function(e,t){var n=e.getCurrentContent(),o=n.createEntity("emoji","IMMUTABLE",{emojiInfo:t}).getLastCreatedEntityKey(),r=e.getSelection(),a=i.Modifier.removeRange(n,r,"backward"),l=i.Modifier.insertText(a,a.getSelectionAfter()," "),c=i.Modifier.insertText(l,l.getSelectionAfter(),"".concat(t.text),undefined,o);c=i.Modifier.insertText(c,c.getSelectionAfter()," ");var s=i.EditorState.push(e,c,"insert-fragment");return i.EditorState.forceSelection(s,c.getSelectionAfter())}(L,{text:"".concat((null==e?void 0:e.text)||"[\u5fae\u7b11]")});R(t),null==r||r(fe(t)),m.emit(m.EVENT.videoStopPlayNext)},getCommentInfo:function(){var e=function(e){var t;return{text:fe(e),textExtra:J()(t=de(e)).call(t,(function(e){return null==e?void 0:e.user_id}))}}(L);return e},getCommentText:function(){return fe(L)},clearInput:function(){R(i.EditorState.createEmpty()),null==r||r("")},focus:function(){a()((function(){var e,t;null===(e=I.current)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e)}),200)},blur:function(){a()((function(){var e,t;null===(e=I.current)||void 0===e||null===(t=e.blur)||void 0===t||t.call(e)}),200)},addAtIcon:function(){var e=function(e){var t=e.getCurrentContent(),n=t.createEntity("mention","IMMUTABLE",{}).getLastCreatedEntityKey(),o=i.Modifier.insertText(t,t.getSelectionAfter(),"@",null,n);return i.EditorState.push(e,o,"insert-fragment")}(L),t=i.EditorState.moveFocusToEnd(e);R(t),null==r||r(fe(t))},setContent:function(e,t){var n=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[],o=0,r=e.getCurrentContent();if(0===n.length)return r=i.Modifier.insertText(r,r.getSelectionAfter(),t),i.EditorState.push(e,r,"insert-fragment");for(var a=ee()(n).call(n,(function(e,t){return e.start-t.start}));t.length>o;)if(a.length>0&&a[0].start===o){var l=a[0],c=(0,z.Z)((0,z.Z)({},l),{},{uid:l.userId,name:Q()(t).call(t,l.start,l.end)}),s=r.createEntity("mention","IMMUTABLE",{mention:c}),u=s.getLastCreatedEntityKey();r=i.Modifier.insertText(s,s.getSelectionAfter(),"".concat(c.name),undefined,u),a.shift(),o=l.end}else{var m=a.length>0?a[0]:{start:t.length},d=Q()(t).call(t,o,m.start);r=i.Modifier.insertText(r,r.getSelectionAfter(),d),o=m.start}return i.EditorState.push(e,r,"insert-fragment")}(L,e,t);R(n),null==r||r(fe(n))}}}),[L,r]);var H=(0,l.useCallback)((function(e){var t=e.keyCode,n=e.ctrlKey||e.metaKey;return t!==pe||n?(0,i.getDefaultKeyBinding)(e):(E(),"noop")}),[E]);return(0,l.useEffect)((function(){U(!0)}),[]),(0,l.useEffect)((function(){if(P){var e=I.current.editor.editorContainer,t=e.parentNode,n=null==e?void 0:e.previousElementSibling;t.style.height=n&&t&&!(0,d.vU)()?"".concat(n.offsetHeight,"px"):"100%",t.style.maxHeight="300px",t.style.overflowY="scroll",t.style.paddingRight="2px"}}),[P,L,r]),l.createElement("div",{className:u()("richtext-container",T),ref:Z},P?l.createElement(l.Fragment,null,l.createElement(c.ZP,{readOnly:N,editorState:L,onChange:function(e){R(e),null==r||r(fe(e))},stripPastedStyles:!0,keyBindingFn:H,plugins:W,placeholder:l.createElement(f.Z,{text:n}),ref:I,onFocus:function(){var e;null==h||h(),m.emit(m.EVENT.videoStopPlayNext),b&&(null==g||null===(e=g.data)||void 0===e?void 0:e.length)>0&&x(!0)},onBlur:function(){null==y||y(),m.emit(m.EVENT.videoRemoveStopPlayNext)},isAtIconSelected:_}),l.createElement(G,{SuggestionComponent:_?ct:F,loadSearchAtData:s,loadMoreDefaultAtData:p,atUserDefaultData:v,atUserSearchData:g,awemeInfo:C,editorState:L,addUserMention:V,isAtIconSelected:_,setIsAtIconSelected:x,refOuterContainer:k,setIsAtIconPoint:S})):l.createElement("div",{className:"placeholder-default"},l.createElement("span",null,n)))}var ut=l.forwardRef(st)},33120:function(e,t,n){var o=n(13795);t.Z=new o.hD({inputText:{eventName:"input_text",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",click_position:""}},commentAtShow:{eventName:"comment_at_show",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",to_user_id:""}},commentAtClick:{eventName:"comment_at_click",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",to_user_id:""}},emojiTabShow:{eventName:"emoji_tab_show",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",tab_name:""}},clickEmoji:{eventName:"click_emoji",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",tab_name:""}},postComment:{eventName:"post_comment",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",reply_comment_id:"",tab_name:"",is_full_webscreen:"",from_follow_list:"0",relation:"",clarity:"",aweme_type:"",reply_to_comment_id:"",is_auto:1,interact_type:"",item_duration_ms:0}},xiguaPostCommentClick:{eventName:"xigua_post_comment_click",params:{author_id:"",group_id:""}},atPanelClick:{eventName:"at_panel_click",params:{enter_from:"",group_id:""}}})},15272:function(e,t,n){n.d(t,{eD:function(){return D}});var o,r=n(65146),a=n(64408),l=n(32781),i=n(85792),c=n.n(i),s=n(5594),u=n.n(s),m=n(53864),d=n(79705),f=n.n(d),p=n(83411),v=n(5611),g=n(36543),h="oWZT1rhs",y="sAAZwTku",C="kAque5Va",E="MrXQvXYf",_="Kk3jGfc7",w="HhLu1U0d",x="hjc3V9XD",k="wdgWdzI8",S="uDeRqsHt";function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},b.apply(this,arguments)}var T=function(e){return m.createElement("svg",b({width:14,height:15,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),o||(o=m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.646 7.146L8 9.793V2.5H7v7.293L4.354 7.146l-.708.708 3.5 3.5.354.353.354-.353 3.5-3.5-.708-.708zM3 12.5v1h9v-1H3z",fill:"#fff",stroke:"#fff",strokeWidth:.5})))},N=n(46930),I=n(9909),Z=n(21720),M=n(96164),D=(0,m.memo)((function(e){var t,n=e.className,o=e.hintText,i=e.log,s=e.isLogin,d=e.defaultHeighlight,b=void 0===d||d,D=e.isShow,L=e.style,R=e.textContainerClassName,B=e.showDivider,A=void 0!==B&&B,O=e.defaultShow,P=void 0===O||O,U=e.showAnimation,j=void 0!==U&&U,F=e.downloadHintClassName,W=e.downloadButtonClassNmae,V=(0,Z.o)(),H=V.downloadHref,K=V.downloadAttr,G=(0,p.C)({value:D,defaultValue:P}),q=(0,l.Z)(G,2),z=q[0],X=q[1],Q=(0,m.useState)(b),Y=(0,l.Z)(Q,2),J=Y[0],$=Y[1],ee=(0,m.useRef)(null);return(0,m.useEffect)((function(){(0,a.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,v.DT)()||!(0,M.D5)()||z){e.next=6;break}if(!s){e.next=6;break}return e.next=4,(0,g.Y)(!0);case 4:e.sent||(X(!0),N.Z.sendLog("addToDesktopShow",{enter_from:null==i?void 0:i.enterFrom,type:null==i?void 0:i.type}));case 6:case"end":return e.stop()}}),e)})))()}),[z,s,i]),(0,m.useEffect)((function(){return J&&!ee.current&&z&&(ee.current=c()((function(){$(!1),clearTimeout(ee.current),ee.current=null}),5e3)),function(){clearTimeout(ee.current),ee.current=null}}),[J,z]),j||z?m.createElement("div",{className:f()(h,n,(t={},(0,r.Z)(t,y,A),(0,r.Z)(t,S,!z),t)),style:L},m.createElement("div",{className:f()(C,F)},m.createElement("div",{className:f()(E,R)},null!=o?o:"\u4e0b\u8f7d\u7535\u8111\u5ba2\u6237\u7aef\uff0c\u968f\u65f6\u8bbf\u95ee\u6296\u97f3"),m.createElement("a",{href:globalThis.xssNamespace.douyin_web.filterUrl(H,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),download:K,className:f()(_,W,(0,r.Z)({},x,J)),onClick:function(){N.Z.sendLog("addToDesktopClick",{enter_from:null==i?void 0:i.enterFrom,type:null==i?void 0:i.type})}},m.createElement(I.Z,{className:w,src:globalThis.xssNamespace.douyin_web.filterUrl(T,null,{logType:"js.href/src",mode:"black",reportOnly:!1}),width:14,height:14,viewBox:"0 0 14 14"}),m.createElement("span",null,"\u4e0b\u8f7d"))),m.createElement("div",{className:k})):m.createElement(m.Fragment,null)}))},82569:function(e,t,n){n.d(t,{E:function(){return N},w:function(){return T}});var o=n(65146),r=n(30906),a=n(64408),l=n(32781),i=n(5594),c=n.n(i),s=n(85792),u=n.n(s),m=n(53864),d=n(77386),f=n.n(d),p=n(50182),v=n(79705),g=n.n(v),h=n(9191),y=n(5277),C=n(72603),E=new(n(13795).hD)({loginGuideShow:{eventName:"login_guide_show",params:{enter_from:"",enter_method:"",params_for_special:""}},loginGuideClick:{eventName:"login_guide_click",params:{enter_from:"",enter_method:"",params_for_special:""}}}),_="nkwM6ivM",w="tsXciClg",x="BdFcbuBq",k="cUvW2hZA",S=n(4836),b=n(95138),T=function(e){var t=e.success,n=void 0===t?null:t,o=e.host,i=void 0===o?null:o,s=e.next,d=void 0===s?null:s,v=e.enterMethod,C=void 0===v?"author_card_login_guide":v,E=e.destroy,_=void 0===E?null:E,w=e.change,x=void 0===w?function(){return null}:w,k=e.close,b=e.className,T=e.blockNum,N=e.onShow,I=e.text,Z=e.transition,M=e.notAnimate,D=(0,m.useRef)(null),L=(0,m.useState)(!0),R=(0,l.Z)(L,2),B=R[0],A=R[1],O=(0,m.useRef)(null),P=(0,p.Z)(),U=(0,l.Z)(P,2),j=U[0],F=U[1];(0,m.useEffect)((function(){F&&N()}),[F]);var W=function(){var e;null===(e=D.current)||void 0===e||e.call(D),null==_||_()},V=function(){var e=(0,a.Z)(c().mark((function e(){var t,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),e.next=3,(0,S.gE)({success:n,host:i,next:d,enterMethod:C,refreshNumber:0});case 3:return o=e.sent,e.next=6,(0,S.j1)();case 6:a=e.sent,O.current=new a((0,r.Z)((0,r.Z)({},o),{},{success:function(e){null!=e&&e.redirect_url?f().get(null==e?void 0:e.redirect_url).then((function(){var t;u()(W,0),null==o||null===(t=o.success)||void 0===t||t.call(o,e),null==x||x()})).catch((function(){W()})):W()}})),null===(t=O.current)||void 0===t||t.setTeaConfig({ug_source:(0,h.Rs)("ug_source"),sem_keyword:(0,h.Rs)("sem_keyword"),browser_is_360:(0,y.a2)()?"1":"0"}),A(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,m.useEffect)((function(){V()}),[]);var H=(0,m.useCallback)((function(){var e,t;return null!==(e=O.current)&&void 0!==e&&e.LoginContainer?null===(t=O.current)||void 0===t?void 0:t.LoginContainer({}):m.createElement("div",null)}),[]);return m.createElement("div",{className:g()("related-video-card-login-guide-block",b,{showBlockBtn:2===T,animate__fadeInUpBig:Z,notAnimate:M}),ref:j},B?null:m.createElement(m.Fragment,null,m.createElement("div",{className:"related-video-card-login-guide-block__content"},m.createElement(H,null),m.createElement("div",{className:"related-video-card-login-guide-block__desc"},m.createElement("p",null,I),m.createElement("p",{className:"related-video-card-login-guide-block__text"},"\u6253\u5f00\u3010\u6296\u97f3\u3011\u626b\u7801\u767b\u5f55"),2===T&&m.createElement("div",{className:"related-video-card-login-guide-block__close",onClick:function(){k()}},m.createElement("span",null,"\u8df3\u8fc7\u767b\u5f55"))))))},N=function(e){var t=e.blockNum,n=e.isDetail,r=e.handleUnLogin,a=e.handleJumpBlock,i=e.onShow,c=e.text,s=e.blockText,u=e.enterMethod,d=(0,p.Z)(),f=(0,l.Z)(d,2),v=f[0],h=f[1];return(0,m.useEffect)((function(){h&&(E.sendLog("loginGuideShow",{enter_from:(0,C.vM)(),enter_method:u,params_for_special:"uc_login"}),null==i||i())}),[h]),m.createElement("div",{ref:v,className:g()(_,(0,o.Z)({},k,n))},2===t?m.createElement("div",{className:x,onClick:a},m.createElement("span",null,s)):m.createElement("div",null,c),m.createElement(b.zx,{className:w,onClick:function(){E.sendLog("loginGuideClick",{enter_from:(0,C.vM)(),enter_method:u,params_for_special:"uc_login"}),r()}},"\u7acb\u5373\u767b\u5f55"))}},28402:function(e,t,n){n.d(t,{B:function(){return m}});var o=n(65902),r=n(67161),a=n(53864),l=n(79705),i=n.n(l),c={aLink:"z0gcQEju"},s=n(77060),u=["isUseALink","children","className"];function m(e){var t=e.isUseALink,n=void 0===t||t,l=e.children,m=e.className,d=(0,r.Z)(e,u);if(!n){var f=d.onClick;return a.createElement("div",(0,o.Z)({className:i()(c.aLink,m),onClick:f},d),l)}return a.createElement(s.a,(0,o.Z)({className:m},d),l)}},40107:function(e,t,n){n.d(t,{jb:function(){return y},A_:function(){return C},_g:function(){return E},_0:function(){return _}});var o=n(32781),r=n(19478),a=n.n(r),l=n(26447),i=n.n(l),c=n(11227),s=n.n(c),u=n(85792),m=n.n(u),d=n(53864),f=n(22541),p=n.n(f),v=n(353),g=n(13971),h=n(71116),y=function(e){var t=(0,g.$o)(e)||{},n=t.lastTimes,o=t.total,r=void 0===o?0:o,a=t.actionClose,l=void 0!==a&&a;return p()(new Date).isSame(p()(n),"day")?{total:r,actionClose:l}:{total:0,actionClose:!1}},C=function(e){var t=e.effectiveTime,n=e.type,o=e.abtestData;if(!(n>0)||null!=o&&o.pcCommentLoadLimit||null!=o&&o.pcAwePostLoadLimit||null!=o&&o.pcAweFavLoadLimit||null!=o&&o.pcCommentRepLoadLimit)return!1;var r=(h.Le.getConfig(h.gI.FirstInstallTime)||{}).time,a=void 0===r?0:r;return i()()>1e3*(a+t)},E=function(e){var t=e.effectiveTime,n=e.type,r=e.abtestData,l=e.isLogin,c=(0,d.useState)(0),u=(0,o.Z)(c,2),f=u[0],p=u[1],h=(0,d.useState)(!1),E=(0,o.Z)(h,2),_=E[0],w=E[1],x=(0,d.useRef)(!1),k=(0,d.useState)(!1),S=(0,o.Z)(k,2),b=S[0],T=S[1],N=(0,d.useRef)(C({effectiveTime:t,type:n,abtestData:r}));(0,d.useEffect)((function(){N.current=C({effectiveTime:t,type:n,abtestData:r})}),[t,n,r]),(0,d.useEffect)((function(){var e,t;if(s()(e=[3,4]).call(e,null==r||null===(t=r.authorBlock)||void 0===t?void 0:t.type)&&N.current&&!l){var n=y(v.LocalStorageKeys.AuthorBlock),o=n.total,a=n.actionClose;o&&p(o),w(a)}}),[r,l]),(0,d.useEffect)((function(){var e,t;s()(e=[3,4]).call(e,null==r||null===(t=r.authorBlock)||void 0===t?void 0:t.type)&&N.current&&!l&&_&&(x.current=!1)}),[r,l,_]);var I=a()((function(){T(!0)}),200),Z=a()((function(){T(!1)}),200);return{blockNum:f,setBlockNum:p,actionCloseBlock:_,setActionCloseBlock:w,refBlockShowMore:x,handleJumpBlock:function(){var e,t;s()(e=[3,4]).call(e,null==r||null===(t=r.authorBlock)||void 0===t?void 0:t.type)&&N.current&&x.current&&(w(!0),m()((function(){(0,g.qQ)(v.LocalStorageKeys.AuthorBlock,{lastTimes:i()(),actionClose:!0})}),200))},refLoginBlock:N,getBlockNum:y,transition:b,isShowDebounce:I,isHideDebounce:Z}},_=function(e){var t=e.effectiveTime,n=e.type,r=e.abtestData,l=e.isLogin,c=(0,d.useState)(0),u=(0,o.Z)(c,2),f=u[0],p=u[1],h=(0,d.useState)(!1),E=(0,o.Z)(h,2),_=E[0],w=E[1],x=(0,d.useRef)(!1),k=(0,d.useState)(!1),S=(0,o.Z)(k,2),b=S[0],T=S[1],N=(0,d.useRef)(C({effectiveTime:t,type:n,abtestData:r}));(0,d.useEffect)((function(){N.current=C({effectiveTime:t,type:n,abtestData:r})}),[t,n,r]),(0,d.useEffect)((function(){var e,t;if(s()(e=[2,3,4]).call(e,null==r||null===(t=r.commentBlock)||void 0===t?void 0:t.type)&&N.current&&!l){var n=y(v.LocalStorageKeys.CommentBlock),o=n.total,a=n.actionClose;o&&p(o),w(a)}}),[r,l]),(0,d.useEffect)((function(){var e,t;s()(e=[2,3,4]).call(e,null==r||null===(t=r.commentBlock)||void 0===t?void 0:t.type)&&N.current&&!l&&_&&(x.current=!1)}),[r,l,_]);var I=a()((function(){T(!0)}),200),Z=a()((function(){T(!1)}),200);return{blockNum:f,setBlockNum:p,actionCloseBlock:_,setActionCloseBlock:w,refBlockShowMore:x,handleJumpBlock:function(){var e,t;s()(e=[2,3,4]).call(e,null==r||null===(t=r.commentBlock)||void 0===t?void 0:t.type)&&N.current&&x.current&&(w(!0),m()((function(){(0,g.qQ)(v.LocalStorageKeys.CommentBlock,{lastTimes:i()(),actionClose:!0})}),200))},refLoginBlock:N,getBlockNum:y,transition:b,isShowDebounce:I,isHideDebounce:Z}}},18193:function(e,t){t.Z={linearBG:"VFMR0HAe",swiperInput:"qdcce5kG",seoSearchText:"A2AQJW3c",noMoreText:"BbQpYS5o",noText:"fG3IwjiA",isDetail:"HO1_ywVX",isSwiper:"yRZc4tUN",opBtn:"HM0IcWG0",detailDividWrap:"qnIcTxJU",title:"k_GzrwDi",divider:"HvCRK2Fu",detailCommentHeader:"Rv0Mxeid",searchTip:"aZ6bykdO",commentInputContainer:"vEQWBqtF",avatar:"DKqSg6ct",commentInput:"pPVXAof8",searchInfoTip:"u9_w6_E3",hitText:"gSPMJwp5",actionableTextWrapper:"TW484_k_",actionableText:"SmBodbmV",searchText:"BevGlQnk",text:"snWo4aV8",commentHeaderWithSearch:"Gacm1K1M",otherDividWrap:"ERMtYq2U",searchDividWrap:"kvni3YO1",closeSvg:"xv39yrQA",relatedDivider:"CaOUqsWl",mainContent:"MR0IFMr1",emptyComment:"CarCDF89",firstReqBtnWrapper:"im3jAYLD",loginBtnWrapper:"VWqzpxPF",loginBtn:"NOSfKCxT",jumpBlock:"VNVGyW4w",flex:"FZWXbjdO",smallInput:"jR7G4Vtu",commentContainer:"mQjJJImN",inSmallCard:"fdBRHnGp",commentToastContainer:"G0Xmb63L",commentToast:"SQZJT7Ba",textDivider:"wJqa2kmA",commentMainContent:"sX7gMtFl",oneDividWrap:"O0lwVSKn",relatedCommentHeader:"zypiWaom",hide:"MrpAQiRd",enhanceDownloadBar:"udkaCsa0",enhanceDownloadHint:"Hy8veWvU",videoPageComment:"d8JQfT1t",transition:"NLeuKQyx",animate__fadeInUpBig:"cLoo0Dod",fadeInUpBig:"dZVY_BoO"}}}]);