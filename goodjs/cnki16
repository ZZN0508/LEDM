var waitingTip=" ";var ISIE=navigator.userAgent.indexOf("MSIE")!=-1&&!window.opera;var isFirefox_KNS=typeof InstallTrigger!=="undefined";var isOpera_KNS=(!!window.opr&&!!opr.addons)||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;var isSafari_KNS=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;var isIE_KNS=
/*@cc_on!@*/
false||!!document.documentMode;var isEdge_KNS=!isIE_KNS&&!!window.StyleMedia;var isChrome_KNS=!!window.chrome&&!!window.chrome.webstore;var isBlink_KNS=(isChrome_KNS||isOpera_KNS)&&!!window.CSS;var userAgent_KNS=navigator.userAgent.toLowerCase();var browser_KNS={ieQuirks:null,msie:/msie/.test(userAgent_KNS)&&!/opera/.test(userAgent_KNS),opera:/opera/.test(userAgent_KNS)};var browser_ie6=browser_KNS.msie&&/msie 6./.test(userAgent_KNS)&&typeof window.XMLHttpRequest!=="object";var browser_ie7=browser_KNS.msie&&/msie 7.0/.test(userAgent_KNS);try{if(window.HTMLElement){var outerHTMLFun1=function(c){var a=this.ownerDocument.createRange();a.setStartBefore(this);var b=a.createContextualFragment(c);this.parentNode.replaceChild(b,this);return c};var outerHTMLFun2=function(){var d;var a=this.attributes;var b="<"+this.tagName.toLowerCase();for(var c=0;c<a.length;c++){d=a[c];if(d.specified){b+=" "+d.name+'="'+d.value+'"'}}if(!this.canHaveChildren){return b+">"}return b+">"+this.innerHTML+"</"+this.tagName.toLowerCase()+">"};var outerHTMLFun3=function(){switch(this.tagName.toLowerCase()){case"area":case"base":case"basefont":case"col":case"frame":case"hr":case"img":case"br":case"input":case"isindex":case"link":case"meta":case"param":return false}return true};if(HTMLElement.prototype.__defineSetter__){HTMLElement.prototype.__defineSetter__("outerHTML",outerHTMLFun1);HTMLElement.prototype.__defineGetter__("outerHTML",outerHTMLFun2);HTMLElement.prototype.__defineGetter__("canHaveChildren",outerHTMLFun3)}else{Object.defineProperty(HTMLElement,"outerHTML",outerHTMLFun1);Object.defineProperty(HTMLElement,"outerHTML",outerHTMLFun2);Object.defineProperty(HTMLElement,"canHaveChildren",outerHTMLFun3)}}}catch(e){}function getBasePath(){var f=window.document.location.href;var c=window.document.location.pathname;var d=f.indexOf(c);var a=f.substring(0,d);var b=c.substring(0,c.substr(1).indexOf("/")+1);return(a+b)}String.prototype.format=function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return a[c]})};String.prototype.Trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.LTrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.RTrim=function(){return this.replace(/(\s*$)/g,"")};function OpenWindow(c,a,b){if(c==undefined||c==null||c==""){return}if(b==undefined||b==null||b==""){if(a==undefined||a==null||a==""){window.open(c)}else{window.open(c,a)}}else{try{window.open(c,a,b)}catch(d){window.open(c,a)}}}function ge(a){return document.getElementById(a)}function GetQueryStringByName(c,a){if("[object String]"==Object.prototype.toString.call(c)&&"[object String]"==Object.prototype.toString.call(a)){var b=c.match(new RegExp("[?&]"+a+"=([^&]+)","i"));if(b==null||b.length<1){return""}return b[1]}return""}function SetQueryStringByName(f,a,b){if("[object String]"==Object.prototype.toString.call(f)){var c=f.match(new RegExp("([?&]+)"+a+"=[^&]*","i"));var d=f;if(c!=null){d=f.replace(c[0],c[1]+a+"="+encodeURI(b))}else{d=f+"&"+a+"="+b}return d}return""}function getElementsByClassName(g,h,k,j){h=h||"*";if(!j){if(k){k=document.getElementById(k)}else{k=k||document}}if(!k){return false}var f=(h=="*"&&k.all)?k.all:k.getElementsByTagName(h);var d=new Array();g=g.replace(/\-/g,"\\-");var m=new RegExp("(^|\\s)"+g+"(\\s|$)");var b;for(var a=0,c=f.length;a<c;a++){b=f[a];if(m.test(b.className)){d.push(b)}}return d}function SetDisplayValue(b,a){var c=ge(b);if(c){if(c.style){c.style.display=a}}}function FillValue(c,a){var b=ge(c);if(b){b.value=a}}function getEmValue(b){var a=ge(b);if(a){return a.value}return""}function GetInputValue(a){return getEmValue(a)}function LoadScript(a,c){var b=document.createElement("script");b.type="text/javascript";b.src=a;document.getElementsByTagName("head")[0].appendChild(b);if(b.readyState){b.onreadystatechange=function(){if(b.readyState=="loaded"||b.readyState=="complete"){b.onreadystatechange=null;if(c){c()}}}}else{b.onload=function(){if(c){c()}}}}function J(a){return document.createElement(a)}function O(a,b,c){if(ISIE){if(b=="load"){a.onreadystatechange=function(){if(this.readyState=="loaded"){c()}}}else{a.attachEvent("on"+b,(function(d){return function(){c.call(d)}})(a))}}else{a.addEventListener(b,c,false)}}function CoreDomainLoadJson(){this.C;this.J=J;this.O=O;this.Load=function(d,a,b){var c=document.getElementById(b);if(c){document.body.removeChild(c)}this.C=J("SCRIPT");this.C.type="text/javascript";if(typeof b=="string"&&b.length>0){this.C.id=b}else{this.C.id="callScriptE"}this.C.src=d+"&td="+(new Date()).getTime();this.C.charset="utf-8";document.body.appendChild(this.C);O(this.C,"load",a)}}function GetLoginStatus(c){var d=document.getElementById("divlogin");if(d!=null&&d!=undefined&&d!="undefined"){var b="/kns/Request/login.aspx?";if(c){b+=c}var a=new CoreDomainLoadJson();a.Load(b,function(){if(typeof oJson!="undefined"){try{var f=oJson.LoginUserHTML;if(typeof f!="undefined"&&f!=""){d.innerHTML=f}}catch(g){}}GetUserCenter($("#hid_uid").val())},"loginstatus_JS")}}function SubScription(h,b,a,d){var g=getCookie("cnkiUserKey");var c="../Request/SubScription.aspx";var f=ge("subScriptionForm");if(f){document.body.removeChild(f)}f=document.createElement("form");f.id="subScriptionForm";f.name="subScriptionForm";f.method="post";f.setAttribute("target","_blank");f.action=c;AppendElement(f,GetIntpuElement("SubT",h));AppendElement(f,GetIntpuElement("SubC",b));AppendElement(f,GetIntpuElement("SubD",a));AppendElement(f,GetIntpuElement("cnkiuserkey",g));AppendElement(f,GetIntpuElement("SubP",d));document.body.appendChild(f);f.submit();document.body.removeChild(f)}function AppendElement(b,a){if(b&&a){b.appendChild(a)}}function GetIntpuElement(a,c){var b=document.createElement("input");b.setAttribute("name",a);b.setAttribute("value",c);return b}function AddFavorites(d,b){var f={};var g=navigator.userAgent.toLowerCase();var a;(a=g.match(/msie ([\d.]+)/))?f.ie=a[1]:(a=g.match(/firefox\/([\d.]+)/))?f.firefox=a[1]:(a=g.match(/chrome\/([\d.]+)/))?f.chrome=a[1]:(a=g.match(/opera.([\d.]+)/))?f.opera=a[1]:(a=g.match(/version\/([\d.]+).*safari/))?f.safari=a[1]:0;var c=d;if(document.getElementsByName(d)[0]){c=document.getElementsByName(d)[0].href}if(f.chrome){window.open("http://www.google.com/bookmarks/mark?op=edit&bkmk="+c+"&title="+b,"谷歌书签");return}if(f.firefox){window.sidebar.addPanel(b,c,"")}if(f.ie){window.external.addFavorite(c,b)}}function SetFrameHeight(){function b(j){var i=300;if(j<i){return i}return j}function c(i){if((i.contentWindow.document==document)||(i.contentWindow.document.frames.name==document.frames.name)){i.style.height=b(document.body.scrollHeight)+"px"}}function f(i){if(i.contentWindow.document==document){if(document.body.offsetHeight==0&&document.body.scrollHeight!=0){i.style.height=b(document.body.scrollHeight)+"px"}else{i.style.height=b(document.body.offsetHeight)+"px"}}}function a(i){if(document.all){a=c}else{a=f}a(i)}if(parent){var d=new Array();d=parent.document.getElementsByTagName("iframe");var h=d.length;for(var g=0;g<h;g++){a(d[g])}}}function getCookie(a,c){if(window.localStorage||window.sessionStorage){if(c=="2"){return window.sessionStorage.getItem(a)}return window.localStorage.getItem(a)}var b=a+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(b);if(offset!=-1){offset+=b.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length}return unescape(document.cookie.substring(offset,end))}}}function GetWebUserIP(){var g=window.sessionStorage?window.sessionStorage.getItem("curUserIP"):"";var f=function(h){var d=ge("footerrightdiv");if(d){if(d.innerHTML.indexOf("您当前IP")<0){d.innerHTML+="<br/>您当前IP："+h}}};if(!g||g.length<=0){var c=new Date;var b="/kns/Request/getuserip.ashx?t="+c.getTime();var a=new CoreDomainLoadJson();a.Load(b,function(){if(typeof ipinfo!="undefined"){try{if(ipinfo.ip&&ipinfo.ip.length>0){if(window.sessionStorage){window.sessionStorage.setItem("curUserIP",ipinfo.ip)}f(ipinfo.ip)}}catch(d){}}},"getuserip_JS")}else{f(g)}}function IsWideScreen(){if(window.screen.width>=1280){return true}else{return false}}function getFocusElementId(){if(!document.activeElement){document.activeElement=null;var b=document.getElementsByTagName("*");var c=b.length;for(var a=0;a<c;a++){b[a].onfocus=function(){document.activeElement=this;return this.id}}}else{return document.activeElement.id}}function OnclickForHideMoredo(){var b=$("#flagShowHide").val();var a=getFocusElementId();if(a!="moredo"){if(b!="true"){$("#dbother_div").hide()}}}function setflag(a){$("#flagShowHide").val(a)}function modifyEcpHeader(a){$("#Ecp_header_Help").before("<a  class='ecp_tn-tab' href='https://kns.cnki.net/kns/subPage/map.aspx'><i>网站地图</i></a>");$("#Ecp_header_ChargeCenter").before(mycnkihtml());if(a){$(".ecp_top-nav").append(logohtml())}}function mycnkihtml(){var b="";if(getCookie("LID")){b="uid="+getCookie("LID")}var a="<span class='mycnki topItem' id='spanmycnki'>";a+="<a id='link_mycnki' href='javascript:void(0);' onclick='setmycnkiclass()'>我的记录<i class='ecp_tn-arrow'></i></a>";a+="<div id='pop_mycnki' class='topItemPop mycnkipop' style='display:none;'>";a+="<a class='close' href='javascript:void(0)' onclick='$(this).parent().hide()'>x</a>";a+="<div class='klogin_fr'>";a+="<ul class='mlist'>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"' target='_blank'>进入 <b>我的记录</b> &gt;&gt;</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=keyWord' target='_parent'>我的检索词</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=recArticle' target='_parent'>我的推荐</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=downLoad' target='_parent'>我的下载</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=view' target='_parent'>我的浏览</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=read' target='_parent'>我的阅读</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=share' target='_parent'>我的分享</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=export' target='_parent'>我的导出</a></li>";a+="<li><a href='https://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=analysis' target='_parent'>我的分析</a></li>";a+=" <li><a href='https://kns.cnki.net/knsdelivery/mycnki.aspx?"+b+"' target='_parent'>我的关注</a></li>";a+="</ul></div>";a+="<div class='klogin_fl'>";a+="<ul class='mlist'>";a+="<li class='prompt'><span>您好，登录可以查看更多信息</span></li>";a+="</ul></div></div></span>";return a}function logohtml(){var a="<div class='Logo'>";a+="<a href='https://nvsm.cnki.net/kns'>";a+="<img src='https://kns.cnki.net/kns/images/gb/logo.gif' alt='中国知网'>";a+="<img class='logohome' src='https://kns.cnki.net/kns/images/gb/home.gif'>";a+="</a></div>";return a}function setmycnkiclass(){$("#spanmycnki").toggleClass("topItemCur");$("#pop_mycnki").toggle()}function LoginSucess(a){}function Ecp_LogoutOptr(b){};